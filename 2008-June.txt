From gruntster at mail.berlios.de  Sun Jun  1 10:50:01 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 1 Jun 2008 10:50:01 +0200
Subject: [Avidemux-svn-commit] r4079 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806010850.m518o15c004195@sheep.berlios.de>

Author: gruntster
Date: 2008-06-01 10:49:32 +0200 (Sun, 01 Jun 2008)
New Revision: 4079

Modified:
   branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
Log:
[iPod] set mixer if audio channels aren't stereo

Modified: branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2008-05-30 17:54:15 UTC (rev 4078)
+++ branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2008-06-01 08:49:32 UTC (rev 4079)
@@ -82,6 +82,9 @@
 					{
 						audioCodecSetcodec(AUDIOENC_FAAC);
 						audioFilter_SetBitrate(128);
+
+						if (currentaudiostream->getInfo()->channels != 2)
+							setCurrentMixerFromString("STEREO");
 					}
 #endif
                       break;



From gruntster at mail.berlios.de  Sun Jun  1 16:50:43 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 1 Jun 2008 16:50:43 +0200
Subject: [Avidemux-svn-commit] r4080 -
	branches/avidemux_2.4_branch/avidemux/ADM_editor
Message-ID: <200806011450.m51Eoh0T023506@sheep.berlios.de>

Author: gruntster
Date: 2008-06-01 16:50:37 +0200 (Sun, 01 Jun 2008)
New Revision: 4080

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
Log:
[I18N] make string translatable

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-01 08:49:32 UTC (rev 4079)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-01 14:50:37 UTC (rev 4080)
@@ -79,7 +79,7 @@
 extern uint8_t loadVideoCodecConf( char *name);
 extern uint8_t parseScript(char *name);
 uint8_t UI_SetCurrentFormat( ADM_OUT_FORMAT fmt );
-const char *VBR_MSG="Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".";
+const char *VBR_MSG = QT_TR_NOOP("Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".");
 //
 //
 



From gruntster at mail.berlios.de  Sun Jun  1 17:12:47 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 1 Jun 2008 17:12:47 +0200
Subject: [Avidemux-svn-commit] r4081 -
	branches/avidemux_2.4_branch/avidemux/winInstaller
Message-ID: <200806011512.m51FClMh025176@sheep.berlios.de>

Author: gruntster
Date: 2008-06-01 17:12:39 +0200 (Sun, 01 Jun 2008)
New Revision: 4081

Modified:
   branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
Log:
[Win32] update installer script for new libpng

Modified: branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
===================================================================
--- branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2008-06-01 14:50:37 UTC (rev 4080)
+++ branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2008-06-01 15:12:39 UTC (rev 4081)
@@ -177,7 +177,7 @@
     File ..\..\..\avidemux_2.4_build\libfontconfig-1.dll
     File ..\..\..\avidemux_2.4_build\libglib-2.0-0.dll
     File ..\..\..\avidemux_2.4_build\libmp3lame-0.dll
-    File ..\..\..\avidemux_2.4_build\libpng13.dll
+    File ..\..\..\avidemux_2.4_build\libpng12-0.dll
     File ..\..\..\avidemux_2.4_build\libx264.dll
     File ..\..\..\avidemux_2.4_build\libxml2.dll
     File ..\..\..\avidemux_2.4_build\ogg.dll



From mean at mail.berlios.de  Fri Jun  6 21:27:44 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 6 Jun 2008 21:27:44 +0200
Subject: [Avidemux-svn-commit] r4083 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs
	ADM_libraries/ADM_lavformat ADM_libraries/ADM_utilities
	ADM_outputs/oplug_flv
Message-ID: <200806061927.m56JRi9p003281@sheep.berlios.de>

Author: mean
Date: 2008-06-06 21:27:42 +0200 (Fri, 06 Jun 2008)
New Revision: 4083

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.h
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
Log:
[Codec] Accept more VP6 flavors

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-04 17:00:03 UTC (rev 4082)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-06 19:27:42 UTC (rev 4083)
@@ -157,6 +157,23 @@
 
 #undef CHECK
 }
+uint8_t isVP6Compatible (uint32_t fourcc)
+{
+
+#define CHECK(x) if(fourCC::check(fourcc,(uint8_t *)x)) \
+						{divx3=1; }
+
+  uint8_t divx3 = 0;
+
+  CHECK ("VP6F");
+  CHECK ("VP6 ");
+  CHECK ("VP61");
+  CHECK ("VP62");
+
+  return divx3;
+
+#undef CHECK
+}
 uint8_t
 isDVCompatible (uint32_t fourcc)
 {
@@ -231,8 +248,8 @@
     {
       return (decoders *) (new decoderFFFLV1 (w, h,extraLen, extraData));
     }
-  
-    
+
+
 #ifdef USE_FFMPEG
   if (fourCC::check (fcc, (uint8_t *) "H263"))
     {
@@ -287,7 +304,7 @@
 
       return (decoders *) (new decoderFFWMV1 (w, h, extraLen, extraData));
     }
-  
+
   if (fourCC::check (fcc, (uint8_t *) "WMV3"))
     {
 
@@ -370,8 +387,8 @@
       return (decoders *) (new decoderFFAMV (w, h,extraLen,extraData));
     }
 
-    
-  if (fourCC::check (fcc, (uint8_t *) "VP6F"))
+
+  if (isVP6Compatible(fcc))
     {
       printf ("\n using VP6F codec\n");
       return (decoders *) (new decoderFFVP6F (w, h,extraLen,extraData));
@@ -409,7 +426,7 @@
 	{
 	  return (decoders *) (new decoderMpeg (w, h, extraLen, extraData));
 	}
-      //  
+      //
     }
 
   // default : null decoder

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2008-06-04 17:00:03 UTC (rev 4082)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2008-06-06 19:27:42 UTC (rev 4083)
@@ -1,7 +1,7 @@
 //
 // C++ Implementation: ADM_lavformat
 //
-// Description: 
+// Description:
 //
 //
 // Author: mean <fixounet at free.fr>, (C) 2004
@@ -25,9 +25,9 @@
 #include <math.h>
 #include <string.h>
 
-extern "C" 
+extern "C"
 {
-	
+
 	#include "avformat.h"
 };
 
@@ -63,6 +63,9 @@
 
 static uint8_t ADM_4cc_to_lavcodec(const char *fcc, CodecID *outlavid);
 static uint8_t ADM_WaveTag_to_lavcodec(uint32_t tag, CodecID *outlavid);
+
+extern uint8_t isVP6Compatible (uint32_t fourcc);
+
 // convert in in us to out in 90Khz tick
 int64_t adm_90k( double in)
 {
@@ -96,7 +99,7 @@
 	close();
 }
 //___________________________________________________________________________
-uint8_t lavMuxer::open(const char *filename, uint32_t inbitrate,ADM_MUXER_TYPE type, aviInfo *info, WAVHeader *audioheader) 
+uint8_t lavMuxer::open(const char *filename, uint32_t inbitrate,ADM_MUXER_TYPE type, aviInfo *info, WAVHeader *audioheader)
 {
         return open(filename,inbitrate,type,info,0,NULL,audioheader,0,NULL);
 }
@@ -131,22 +134,22 @@
 		break;
 	case MUXER_FLV:
 		fmt = guess_format("flv", NULL, NULL);
-		break;          
+		break;
 	case MUXER_MATROSKA:
 		fmt = guess_format("matroska", NULL, NULL);
-		break;          
+		break;
 
 	default:
 		fmt=NULL;
 	}
-	if (!fmt) 
+	if (!fmt)
 	{
         	printf("Lav:Cannot guess format\n");
                 ADM_assert(0);
 		return 0;
 	}
 	oc = av_alloc_format_context();
-	if (!oc) 
+	if (!oc)
 	{
        		printf("Lav:Cannot allocate context\n");
 		return 0;
@@ -155,14 +158,14 @@
 	snprintf(oc->filename,1000,"file://%s",filename);
 	// Video
 	//________
-	
+
 	video_st = av_new_stream(oc, 0);
-	if (!video_st) 
+	if (!video_st)
 	{
 		printf("Lav: new stream failed\n");
 		return 0;
-	}	
-	
+	}
+
 	c = video_st->codec;
 	switch(_type)
 	{
@@ -175,16 +178,16 @@
 					 	 c->codec->name=ADM_strdup("FLV1");
 					 }else
 					 {
-						 if(fourCC::check(info->fcc,(uint8_t *)"VP6F"))
+						 if(isVP6Compatible(info->fcc))
 						 			{
 							 		 c->codec_id=CODEC_ID_VP6F;
 					 				 c->codec->name=ADM_strdup("VP6F");
 						 			}
 						 else
 							 ADM_assert(0);
-					 
+
 					 }
-					 
+
 					 break;
                 case MUXER_MATROSKA:
                         strcpy(oc->title,"Avidemux");
@@ -212,7 +215,7 @@
                                       printf("[lavFormat] Cannot map  this\n");
                                       return 0;
                                    }
-                                  
+
                                 }
                         }
                         if(videoExtraDataSize)
@@ -226,7 +229,7 @@
                 {
                         // probably a memeleak here
                         char *foo=ADM_strdup(filename);
-                        
+
                         strcpy(oc->title,GetFileName(foo));
                         strcpy(oc->author,"Avidemux");
                         c->sample_aspect_ratio.num=1;
@@ -297,7 +300,7 @@
                                 c->bit_rate=9000*1000;
                         else
                                 c->bit_rate=inbitrate;
-        
+
                         break;
 		case MUXER_DVD:
 			c->codec_id = CODEC_ID_MPEG2VIDEO;
@@ -308,7 +311,7 @@
 				c->bit_rate=9000*1000;
 			else
 				c->bit_rate=inbitrate;
-	
+
 			break;
 		case MUXER_VCD:
 			c->codec_id = CODEC_ID_MPEG1VIDEO;
@@ -316,10 +319,10 @@
 			c->rc_buffer_size=8*1024*40;
 			c->rc_max_rate=1152*1000;
 			c->rc_min_rate=1152*1000;
-			
+
 			c->bit_rate=1152*1000;
-			
 
+
 			break;
 		case MUXER_SVCD:
 			c->codec_id = CODEC_ID_MPEG2VIDEO;
@@ -336,23 +339,23 @@
 		default:
 			ADM_assert(0);
 	}
-	
+
 	c->codec_type = CODEC_TYPE_VIDEO;
-	c->flags=CODEC_FLAG_QSCALE;   
-	c->width = info->width;  
-	c->height = info->height; 
+	c->flags=CODEC_FLAG_QSCALE;
+	c->width = info->width;
+	c->height = info->height;
 
        AVRational fps25=(AVRational){1001,25025};
        AVRational fps24=(AVRational){1001,24000};
        AVRational fps30= (AVRational){1001,30000};
        AVRational fpsfree= (AVRational){1000,_fps1000};
 
-        
+
     	switch(_fps1000)
 	{
 		case 25000:
                 {
-			 c->time_base= fps25; 
+			 c->time_base= fps25;
 			 break;
                 }
 		case 23976:
@@ -380,24 +383,24 @@
                         break;
 	}
 
-			
+
 	c->gop_size=15;
 	c->max_b_frames=2;
 	c->has_b_frames=1;
 
-	
+
 	// Audio
 	//________
         if(audioheader)
         {
           audio_st = av_new_stream(oc, 1);
-          if (!audio_st) 
+          if (!audio_st)
           {
                   printf("Lav: new stream failed\n");
                   return 0;
           }
-  
-                  
+
+
           c = audio_st->codec;
           c->frame_size=1024; //For AAC mainly, sample per frame
           printf("[LavFormat] Bitrate %u\n",(audioheader->byterate*8)/1000);
@@ -408,7 +411,7 @@
                     _audioFq=c->sample_rate = audioheader->frequency/2;                 //_audioFq*=2; // SBR
              }
 #endif
-          
+
           switch(audioheader->encoding)
           {
                   case WAV_AC3: c->codec_id = CODEC_ID_AC3;break;
@@ -418,11 +421,11 @@
                               c->frame_size=1152;
                               c->codec_id = CODEC_ID_MP3;
                               break;
-                  case WAV_PCM: 
+                  case WAV_PCM:
                                   // One chunk is 10 ms (1/100 of fq)
                                   c->frame_size=4;
                                   c->codec_id = CODEC_ID_PCM_S16LE;break;
-                  case WAV_AAC: 
+                  case WAV_AAC:
                                   c->extradata=audioextraData;
                                   c->extradata_size= audioextraSize;
                                   c->codec_id = CODEC_ID_AAC;
@@ -442,25 +445,25 @@
                              break;
                            }
                           }
-                            
-                          printf("Cant mux that ! audio\n"); 
+
                           printf("Cant mux that ! audio\n");
+                          printf("Cant mux that ! audio\n");
                           c->codec_id = CODEC_ID_MP2;
                           return 0;
                           break;
           }
           c->codec_type = CODEC_TYPE_AUDIO;
-          
+
           c->bit_rate = audioheader->byterate*8;
           c->rc_buffer_size=(c->bit_rate/(2*8)); // 500 ms worth
-          
+
           c->channels = audioheader->channels;
           _audioByterate=audioheader->byterate;
-          
+
         }
         // /audio
-	
-	
+
+
 //----------------------
 	switch(_type)
 	{
@@ -481,26 +484,26 @@
 		case MUXER_VCD:
 			oc->packet_size=2324;
 			oc->mux_rate=2352 * 75 * 8;
-			
+
 			break;
 		case MUXER_SVCD:
-			
+
 			oc->packet_size=2324;
 			oc->mux_rate=2*2352 * 75 * 8; // ?
-			
+
 			break;
 		default:
 			ADM_assert(0);
 	}
 	oc->preload=AV_TIME_BASE/10; // 100 ms preloading
 	oc->max_delay=200*1000; // 500 ms
-	
-	if (av_set_parameters(oc, NULL) < 0) 
+
+	if (av_set_parameters(oc, NULL) < 0)
 	{
 		printf("Lav: set param failed \n");
 		return 0;
 	}
-	 if (url_fopen(&(oc->pb), filename, URL_WRONLY) < 0) 
+	 if (url_fopen(&(oc->pb), filename, URL_WRONLY) < 0)
 	 {
 	 	printf("Lav: Failed to open file :%s\n",filename);
 		return 0;
@@ -511,10 +514,10 @@
 
 
 	printf("lavformat mpeg muxer initialized\n");
-	
+
 	_running=1;
 
-	one=(1000*1000*1000)/_fps1000; 
+	one=(1000*1000*1000)/_fps1000;
 	_curDTS=one;
 
 	return 1;
@@ -522,14 +525,14 @@
 //___________________________________________________________________________
 uint8_t lavMuxer::writeAudioPacket(uint32_t len, uint8_t *buf,uint32_t sample)
 {
-        
+
         int ret;
         AVPacket pkt;
         double f;
         int64_t timeInUs;
 
             //printf("Audio paclet : size %u, sample %u\n",len,sample);
-        
+
            if(!audio_st) return 0;
            if(!len) return 1;
             av_init_packet(&pkt);
@@ -544,24 +547,24 @@
             else
             {
             	f=timeInUs;
-            	f/=1000000.; // In ms seconds 
+            	f/=1000000.; // In ms seconds
             	f*=_audioFq;
             	f=floor(f+0.4);
             }
             pkt.dts=pkt.pts=(int)(f);
 
             //printf("F:%f Q:%u D=%u\n",f,pkt.pts,timeInUs-_lastAudioDts);
-            
-            pkt.flags |= PKT_FLAG_KEY; 
+
+            pkt.flags |= PKT_FLAG_KEY;
             pkt.data= buf;
             pkt.size= len;
             pkt.stream_index=1;
             //pkt.duration=pkt.dts-_lastAudioDts; // Duration
-            aprintf("A: sample: %d frame_pts: %d fq: %d\n",(int32_t )sample,(int32_t )pkt.dts,audio_st->codec->sample_rate); 
+            aprintf("A: sample: %d frame_pts: %d fq: %d\n",(int32_t )sample,(int32_t )pkt.dts,audio_st->codec->sample_rate);
 
             ret = av_write_frame(oc, &pkt);
             _lastAudioDts=timeInUs;
-            if(ret) 
+            if(ret)
             {
                         printf("Error writing audio packet\n");
                         printf("pts %llu dts %llu\n",pkt.pts,pkt.dts);
@@ -577,20 +580,20 @@
                 f=sample;
                 f*=1000.*1000.;
                 f/=_audioFq;              // Sample / Frequency = time in seconds *10E6 to get in in us
-                
+
                 return (uint64_t)floor(f);
 
 }
 //___________________________________________________________________________
 uint8_t lavMuxer::needAudio( void )
 {
-	
+
         if(!audio_st) return 0;
 
 	double f;
 	uint64_t dts=_lastAudioDts;  // Last audio dts
 
-		
+
 		aprintf("Need audio  ?: %llu / %llu : %llu\n ",dts,_curDTS,_curDTS+one);
 		if((dts+5000>=_curDTS) && (dts<=_curDTS+one)) return 1;
 		if(dts<=_curDTS)
@@ -608,28 +611,28 @@
 double p,d;
   	AVPacket pkt;
             av_init_packet(&pkt);
-	    
+
         p=bitstream->ptsFrame+1;      // Pts           // Time p/fps1000=out/den  out=p*den*1000/fps1000
         p=(p*1000*1000*1000);
         p=p/_fps1000;                  // in us
-	
+
         d=bitstream->dtsFrame;		// dts
 	d=(d*1000*1000*1000);
 	d=d/_fps1000;
-	
-	
-	_curDTS=(int64_t)floor(d);	
-        
+
+
+	_curDTS=(int64_t)floor(d);
+
         // Rescale
 #define RESCALE(x) x=x*video_st->codec->time_base.den*1000.;\
                    x=x/_fps1000;
-        
+
         p=bitstream->ptsFrame+1;
         RESCALE(p);
-        
+
         d=bitstream->dtsFrame;
         RESCALE(d);
-        
+
         if(_type==MUXER_FLV || _type==MUXER_MATROSKA) /* The FLV muxer expects packets dated in ms, there is something i did not get... WTF */
         {
         			p=p*1000/_fps1000;
@@ -641,30 +644,30 @@
        // printf("Lavformat : Pts :%u dts:%u",displayframe,frameno);
 	aprintf("Lavformat : Pts :%llu dts:%llu",pkt.pts,pkt.dts);
 	pkt.stream_index=0;
-           
+
         pkt.data= bitstream->data;
         pkt.size= bitstream->len;
 	// Look if it is a gop start or seq start
         if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV || _type==MUXER_MATROSKA)
         {
-            if(bitstream->flags & AVI_KEY_FRAME) 
+            if(bitstream->flags & AVI_KEY_FRAME)
                         pkt.flags |= PKT_FLAG_KEY;
         }else
             if(!bitstream->data[0] &&  !bitstream->data[1] && bitstream->data[2]==1)
 	{
             if(bitstream->data[3]==0xb3 || bitstream->data[3]==0xb8 ) // Seq start or gop start
 		pkt.flags |= PKT_FLAG_KEY;
-		//printf("Intra\n"); 
+		//printf("Intra\n");
 	}
-           
+
 	ret =av_write_frame(oc, &pkt);
-	if(ret) 
+	if(ret)
 	{
 		printf("Error writing video packet\n");
 		return 0;
 	}
         aprintf("V: frame %lu pts%d\n",bitstream->dtsFrame,pkt.pts);
-	
+
 	return 1;
 }
 //___________________________________________________________________________
@@ -721,7 +724,7 @@
 }
 extern "C"
 {
-/** 
+/**
     \fn ADM_useAlternateTagging
     \brief returns 1 if using haali compatible tagging, 0 if normal. For mp3 in mp4ff.
 */
@@ -730,8 +733,8 @@
   uint32_t v=1;
   prefs->get(FEATURE_ALTERNATE_MP3_TAG,&v);
   return v;
-} 
 }
+}
 
 typedef struct
 {
@@ -760,12 +763,12 @@
       if(!strncmp(lavFCC[i].name,fcc,4))
       {
         *outlavid=(CodecID)lavFCC[i].id;
-        return 1; 
+        return 1;
       }
-      
+
     }
     return 0;
-  
+
 }
 //*****************
 typedef struct
@@ -795,12 +798,12 @@
       if(lavWaveTag[i].tag==tag)
       {
         *outlavid=(CodecID)lavWaveTag[i].id;
-        return 1; 
+        return 1;
       }
-      
+
     }
     return 0;
-  
+
 }
 
 //___________________________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp	2008-06-04 17:00:03 UTC (rev 4082)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp	2008-06-06 19:27:42 UTC (rev 4083)
@@ -82,7 +82,7 @@
 #if defined( ADM_BIG_ENDIAN)
     if (*inb == (uint32_t) mmioFOURCC(*(cc+3), *(cc + 2), *(cc + 1), *(cc + 0)))
 #else
-    if (*inb == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))	
+    if (*inb == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))
 #endif
       {
 	  return 1;
@@ -102,7 +102,7 @@
     return inb;
 }
 
-int fourCC::check(uint8_t * cc, uint32_t in)
+int fourCC::check(const uint8_t * cc, uint32_t in)
 {
 
     if (in == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))
@@ -113,7 +113,7 @@
     return 0;
 }
 
-int fourCC::check(uint32_t in, uint8_t * cc)
+int fourCC::check(uint32_t in, const uint8_t * cc)
 {
     return check(cc, in);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.h	2008-06-04 17:00:03 UTC (rev 4082)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/fourcc.h	2008-06-06 19:27:42 UTC (rev 4083)
@@ -20,14 +20,14 @@
 class fourCC
 {
 public:
-  static int  			check(uint8_t *,uint8_t *);
+    static int  		    check(uint8_t *,uint8_t *);
 	static void 			print(uint32_t four);
 	static void 			printBE(uint32_t four);
-	static int  			check(uint32_t in,uint8_t *cc);
-	static int  			check(uint8_t *cc,uint32_t in);
-	static  uint32_t 	get(uint8_t *in)   ;
-	static char 		  *tostring(uint32_t fourcc);
-        static char               *tostringBE(uint32_t fourcc);
+	static int  			check(uint32_t in,const uint8_t *cc);
+	static int  			check(const uint8_t *cc,uint32_t in);
+	static  uint32_t 	    get(uint8_t *in)   ;
+	static char 		    *tostring(uint32_t fourcc);
+    static char            *tostringBE(uint32_t fourcc);
 
 };
 void mixDump(uint8_t *ptr, uint32_t len);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-04 17:00:03 UTC (rev 4082)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-06 19:27:42 UTC (rev 4083)
@@ -1,10 +1,10 @@
 /***************************************************************************
                           oplug_flv.cpp  -  I/f to lavformat flash encoder
                              -------------------
-    
+
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr
-        
+
  ***************************************************************************/
 
 /***************************************************************************
@@ -71,12 +71,12 @@
 extern SelectCodecType  		current_codec;
 
 
-
+extern uint8_t isVP6Compatible (uint32_t fourcc);
 static 				uint8_t *_buffer=NULL,*_outbuffer=NULL;
 
 /*
  * 		\fn    Oplug_flv
-		\brief Main function to save in flv format. 
+		\brief Main function to save in flv format.
 		It is very close to oplug_mp4 but somehow simplified as the following assumptions are made :
 				* No b frame
 				* No 2 pass encoding
@@ -121,7 +121,7 @@
 uint32_t sent=0;
 
         // Setup video
-        
+
         if(videoProcessMode())
         {
              _incoming = getLastVideoFilter (frameStart,frameEnd-frameStart);
@@ -137,15 +137,9 @@
 
            info.fcc=*(uint32_t *)_encode->getCodecName(); //FIXME
            //
-           char *supportedVideo[3]={"FLV1","VP6F","VP6 "};
            int supported=0;
-           for(int i=0;i<3;i++)
-           {
-        	   if(fourCC::check(info.fcc,(uint8_t *)supportedVideo[i]))
-        	   {
-        		   	supported=1;
-        	   }
-           }
+           if(isVP6Compatible(info.fcc)) supported=1;
+           if(fourCC::check(info.fcc,(const uint8_t *)"FLV1")) supported=1;
            if(!supported)
            {
         	   GUI_Error_HIG(QT_TR_NOOP("Unsupported video"),QT_TR_NOOP("Only FLV1 and VP6 video are supported"));
@@ -158,12 +152,12 @@
            {
         	   uint32_t audioCodec=0;
         	   uint32_t fq=currentaudiostream->getInfo()->frequency;
-        	   
+
         	   	if(audioProcessMode())
         	   	{
         	   		audioCodec=audioFilter_getOuputCodec();
         	   		fq=audioFilter_getOuputFrequency(fq);
-        	   		
+
         	   	}else
         	   	{	// copy
         	   		audioCodec=currentaudiostream->getInfo()->encoding;
@@ -177,11 +171,11 @@
         	   	{
     	   			GUI_Error_HIG(QT_TR_NOOP("Unsupported audio"),QT_TR_NOOP("Frequency must be 44100, 22050 or 11025 Hz."));
     	   			goto stopit;
-        	   		
+
         	   	}
            }
-           
-           
+
+
            encoding_gui=new DIA_encoding(_incoming->getInfo()->fps1000);
            bitstream.bufferSize=_incoming->getInfo()->width*_incoming->getInfo()->height*3;
            if (!_encode)
@@ -197,7 +191,7 @@
                         encoding_gui->setCodec(QT_TR_NOOP("Copy"));
                 else
                         encoding_gui->setCodec(_encode->getDisplayName());
-                
+
                 if (!_encode->configure (_incoming))
                 {
                       GUI_Error_HIG (QT_TR_NOOP("Filter init failed"), NULL);
@@ -205,13 +199,13 @@
                 };
 
                 encoding_gui->setPhasis (QT_TR_NOOP("Encoding"));
-                
-                
+
+
                 info.width=_incoming->getInfo()->width;
                 info.height=_incoming->getInfo()->height;
                 info.nb_frames=_incoming->getInfo()->nb_frames;
                 info.fps1000=_incoming->getInfo()->fps1000;
-                
+
                 _encode->hasExtraHeaderData( &videoExtraDataSize,&dummy);
                 if(videoExtraDataSize)
                 {
@@ -221,10 +215,10 @@
                 }
         // _________________Setup video (cont) _______________
         // ___________ Read 1st frame _________________
-             
+
              ADM_assert(_encode);
              bitstream.data=videoBuffer;
-             
+
 preFilling:
              bitstream.cleanup(0);
              if(!(err=_encode->encode ( prefill, &bitstream)))// FIXME: We should never execute it more than once
@@ -242,9 +236,9 @@
               if(!bitstream.flags & AVI_KEY_FRAME)
               {
                 GUI_Error_HIG (QT_TR_NOOP("KeyFrame error"),QT_TR_NOOP( "The beginning frame is not a key frame.\nPlease move the A marker."));
-                  goto  stopit; 
+                  goto  stopit;
               }
-          
+
 // ____________Setup audio__________________
           if(currentaudiostream)
           {
@@ -254,7 +248,7 @@
                         GUI_Error_HIG ("[FLV]",QT_TR_NOOP("Cannot initialize the audio stream"));
                         goto  stopit;
                 }
-          } 
+          }
           if(audio)
           {
                 audioinfo=audio->getInfo();
@@ -270,7 +264,7 @@
            }
 // ____________Setup Muxer _____________________
            muxer= new lavMuxer;
-           
+
            if(!muxer->open(
                 name,
                 2000000, // Muxrate
@@ -279,9 +273,9 @@
                 audioinfo,extraDataSize,extraData))
                          goto stopit;
 //_____________ Loop _____________________
-          
+
           encoding_gui->setContainer(QT_TR_NOOP("FLV"));
-         
+
           if(!videoProcessMode())
                 encoding_gui->setCodec(QT_TR_NOOP("Copy"));
           else
@@ -295,14 +289,14 @@
           }
 //_____________ Start Audio thread _____________________
           if(audio)
-          {          
+          {
             pq=new PacketQueue("[FLV] audioQ",5000,2*1024*1024);
             memset(&context,0,sizeof(context));
             context.audioEncoder=audio;
             context.audioTargetSample=0xFFFF0000; ; //FIXME
             context.packetQueue=pq;
             // start audio thread
-            ADM_assert(!pthread_create(&audioThread,NULL,(THRINP)defaultAudioQueueSlave,&context)); 
+            ADM_assert(!pthread_create(&audioThread,NULL,(THRINP)defaultAudioQueueSlave,&context));
             ADM_usleep(4000);
           }
 //_____________GO !___________________
@@ -323,9 +317,9 @@
                }
                ADM_assert(_encode);
                bitstream.cleanup(frameWrite);
-              
+
                r=_encode->encode ( prefill+frame, &bitstream);
-              
+
                if(!r && frame<total-2)
                {
                         printf("[FLV]:Frame %u error\n",frame);
@@ -345,15 +339,15 @@
                 encoding_gui->setFrame(frame,bitstream.len,bitstream.out_quantizer,total);
                if(!encoding_gui->isAlive())
                 {
-                    
+
                     goto stopit;
                 }
-               
+
            }
            ret=1;
-           
+
 stopit:
-    
+
     // Flush slave Q
     if(audio&& pq)
     {
@@ -363,7 +357,7 @@
         while(!context.audioDone)
         {
           printf("[FLV]Waiting Audio thread\n");
-          ADM_usleep(500000); 
+          ADM_usleep(500000);
         }
         delete pq;
     }
@@ -372,12 +366,12 @@
            if(encoding_gui) delete encoding_gui;
            if(videoBuffer) delete [] videoBuffer;
            if(muxer) delete muxer;
-           if(_encode) delete _encode;	
+           if(_encode) delete _encode;
            if(videoExtraData) delete [] videoExtraData;
            // Cleanup
            deleteAudioFilter (audio);
            return ret;
 }
 
-	
+
 // EOF



From mean at mail.berlios.de  Sat Jun  7 22:23:12 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jun 2008 22:23:12 +0200
Subject: [Avidemux-svn-commit] r4084 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806072023.m57KNCi7019845@sheep.berlios.de>

Author: mean
Date: 2008-06-07 22:23:12 +0200 (Sat, 07 Jun 2008)
New Revision: 4084

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
Log:
[MKV] Fix audio duration computation for vorbis, maybe aac too

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-06 19:27:42 UTC (rev 4083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-07 20:23:12 UTC (rev 4084)
@@ -36,19 +36,19 @@
 
 uint8_t mkvHeader::open(char *name)
 {
- 
+
   ADM_ebml_file ebml;
   uint64_t id,len;
   uint64_t alen;
   ADM_MKV_TYPE type;
   const char *ss;
-  
-  
+
+
   _isvideopresent=0;
-  if(!ebml.open(name)) 
+  if(!ebml.open(name))
   {
     printf("[MKV]Failed to open file\n");
-    return 0; 
+    return 0;
   }
   if(!ebml.find(ADM_MKV_PRIMARY,EBML_HEADER,(MKV_ELEM_ID)0,&alen))
   {
@@ -89,30 +89,49 @@
     if(!videoIndexer(&ebml))
     {
       printf("[MKV] Video indexing failed\n");
-      return 0; 
+      return 0;
     }
   // update some infos
-  _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0]._nbIndex; 
-  
+  _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0]._nbIndex;
+
   _parser=new ADM_ebml_file();
   ADM_assert(_parser->open(name));
   _filename=ADM_strdup(name);
-  
+
   // Finaly update index with queue
+  float duration=_videostream.dwLength*_tracks[0]._defaultFrameDuration;
+  duration/=1000;
+  uint32_t duration32=(uint32_t)duration;
+  printf("[MKV] Video Track duration %u ms\n",_videostream.dwLength);
   // Useless.....readCue(&ebml);
   for(int i=0;i<_nbAudioTrack;i++)
   {
+    rescaleTrack(&(_tracks[1+i]),duration32);
     if(_tracks[1+i].wavHeader.encoding==WAV_OGG)
     {
         printf("[MKV] Reformatting vorbis header for track %u\n",i);
-        reformatVorbisHeader(&(_tracks[1+i]));  
+        reformatVorbisHeader(&(_tracks[1+i]));
     }
   }
   printf("[MKV]Matroska successfully read\n");
-  
+
   return 1;
 }
 /**
+    \fn rescaleTrack
+    \brief Compute the average duration of one audio frame if the info is not present in the stream
+
+*/
+uint8_t mkvHeader::rescaleTrack(mkvTrak *track,uint32_t durationMs)
+{
+        float samples=1000.;
+        samples*=durationMs;
+        samples/=track->nbPackets;  // 1000 * sample per packet
+        track->_defaultFrameDuration=(uint32_t)samples;
+        return 1;
+
+}
+/**
     \fn checkHeader
     \brief Check that we are compatible with that version of matroska. At the moment, just dump some infos.
 */
@@ -122,8 +141,8 @@
  ADM_ebml_file father( (ADM_ebml_file *)head,headlen);
  walk(&father);
  printf("[MKV] *** End of Header dump ***\n");
- return 1; 
-  
+ return 1;
+
 }
 /**
     \fn analyzeTracks
@@ -145,15 +164,15 @@
         continue;
       }
       ADM_assert(ss);
-      if(id!=MKV_TRACK_ENTRY) 
+      if(id!=MKV_TRACK_ENTRY)
       {
         printf("[MKV] skipping %s\n",ss);
         father.skip(len);
-        continue; 
+        continue;
       }
       if(!analyzeOneTrack(&father,len)) return 0;
  }
- return 1; 
+ return 1;
 }
 
 /**
@@ -165,7 +184,7 @@
   uint64_t id,len;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
    ADM_ebml_file *father=(ADM_ebml_file *)seed;
     while(!father->finished())
    {
@@ -215,7 +234,7 @@
 {
   if(_nbAudioTrack)
   {
-    return &(_tracks[1+_currentAudioTrack].wavHeader); 
+    return &(_tracks[1+_currentAudioTrack].wavHeader);
   }
   return NULL;
 }
@@ -231,7 +250,7 @@
       return 1;
   }
   *audio=NULL;
-  return 0; 
+  return 0;
 }
 /*
     __________________________________________________________
@@ -239,7 +258,7 @@
 
 void mkvHeader::Dump(void)
 {
- 
+
 }
 
 /*
@@ -251,21 +270,21 @@
   if(_clusters)
   {
     delete [] _clusters;
-    _clusters=NULL; 
+    _clusters=NULL;
   }
   // CLEANUP!!
   if(_parser) delete _parser;
   _parser=NULL;
-  
-  
+
+
 #define FREEIF(i) { if(_tracks[i].extraData) delete [] _tracks[i].extraData; _tracks[i].extraData=0;}
   if(_isvideopresent)
   {
-      FREEIF(0); 
+      FREEIF(0);
   }
   for(int i=0;i<_nbAudioTrack;i++)
   {
-    FREEIF(1+i); 
+    FREEIF(1+i);
   }
   // Delete index
   if(_isvideopresent && _tracks[0]._index)
@@ -288,13 +307,13 @@
 */
 
  mkvHeader::mkvHeader( void ) : vidHeader()
-{ 
+{
   _parser=NULL;
   _nbAudioTrack=0;
   _filename=NULL;
   memset(_tracks,0,sizeof(_tracks));
   _reordered=0;
-  
+
   _clusters=NULL;
   _clustersCeil=0;
   _nbClusters=0;
@@ -321,7 +340,7 @@
 {
   if(frame>=_tracks[0]._nbIndex) return 0;
   _tracks[0]._index[frame].flags=flags;
-  return 1; 
+  return 1;
 }
 /*
     __________________________________________________________
@@ -332,7 +351,7 @@
   if(frame>=_tracks[0]._nbIndex) return 0;
   *flags=_tracks[0]._index[frame].flags;
   if(!frame) *flags=AVI_KEY_FRAME;
-  return 1; 
+  return 1;
 }
 /*
     __________________________________________________________
@@ -342,19 +361,19 @@
 {
   ADM_assert(_parser);
   if(framenum>=_tracks[0]._nbIndex) return 0;
-  
+
   mkvIndex *dx=&(_tracks[0]._index[framenum]);
-  
+
   _parser->seek(dx->pos);
   _parser->readBin(img->data,dx->size);
   img->dataLength=dx->size;
-  
+
   img->flags=dx->flags;
-  
+
   if(!framenum) img->flags=AVI_KEY_FRAME;
-  
-  
-  return 1; 
+
+
+  return 1;
 }
 /*
     __________________________________________________________
@@ -364,13 +383,13 @@
 {
                 *len=_tracks[0].extraDataLen;
                 *data=_tracks[0].extraData;
-                return 1;            
+                return 1;
 }
 /*
     __________________________________________________________
 */
 uint8_t			mkvHeader::isReordered( void )
-{ 
+{
  	return _reordered;
 }
 /*
@@ -378,16 +397,16 @@
 */
 uint8_t mkvHeader::reorder( void )
 {
-  
+
 #define INDEX_TMPL        mkvIndex
 #define INDEX_ARRAY_TMPL  (_tracks[0]._index)
 #define FRAMETYPE_TMPL    flags
-  
+
 #include "ADM_video/ADM_reorderTemplate.cpp"
 
-#undef INDEX_TMPL       
-#undef INDEX_ARRAY_TMPL 
-#undef FRAMETYPE_TMPL   
+#undef INDEX_TMPL
+#undef INDEX_ARRAY_TMPL
+#undef FRAMETYPE_TMPL
      _tracks[0]._nbIndex=_videostream.dwLength;
          return 1;
 }
@@ -462,14 +481,14 @@
         head++; \
       } \
       x+=*head++;
-  
+
       READ_LEN(len1);
       READ_LEN(len2);
       len3=oldata+oldlen-head;
       if(len3<=len1+len2)
       {
         printf("Error in vorbis header, len3 too small %u %u / %u\n",len1,len2,len3);
-        return 0; 
+        return 0;
       }
       len3-=(len1+len2);
       printf("Found packet len : %u %u %u, total size %u\n",len1,len2,len3,oldlen);
@@ -480,7 +499,7 @@
       memcpy(cp,head,len1);
       memcpy(cp+len1,head+len1,len2);
       memcpy(cp+len1+len2,head+len1+len2,len3);
-      
+
       uint32_t *h=(uint32_t *)nwdata;
       h[0]=len1;
       h[1]=len2;
@@ -489,7 +508,7 @@
       delete [] oldata;
       trk->extraData=nwdata;
       trk->extraDataLen=nwlen;
-  return 1; 
+  return 1;
 }
 //****************************************
 /**



From mean at mail.berlios.de  Sat Jun  7 22:23:26 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jun 2008 22:23:26 +0200
Subject: [Avidemux-svn-commit] r4085 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806072023.m57KNQgp019880@sheep.berlios.de>

Author: mean
Date: 2008-06-07 22:23:26 +0200 (Sat, 07 Jun 2008)
New Revision: 4085

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
Log:
[MKV] Fix audio duration computation for vorbis, maybe aac too

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-07 20:23:12 UTC (rev 4084)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-07 20:23:26 UTC (rev 4085)
@@ -14,9 +14,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
- 
 
 
+
 #ifndef ADM_MKV_H
 #define ADM_MKV_H
 
@@ -25,7 +25,7 @@
 #include "ADM_inputs/ADM_matroska/ADM_ebml.h"
 
 
-typedef struct 
+typedef struct
 {
     uint64_t pos;
     uint32_t size;
@@ -33,11 +33,11 @@
     uint32_t timeCode;  // In fact it is delta between DTS and PTS for audio...
 }mkvIndex;
 //**********************************************
-typedef struct 
+typedef struct
 {
   /* Index in mkv */
   uint32_t  streamIndex;
-  
+
   /* Used for audio */
   WAVHeader wavHeader;
   uint32_t  nbPackets;
@@ -49,7 +49,7 @@
   uint32_t  _nbIndex;  // current size of the index
   uint32_t  _indexMax; // Max size of the index
   uint32_t  _sizeInBytes; // Approximate size in bytes of that stream
-  uint32_t  _defaultFrameDuration; // in us!
+  uint32_t  _defaultFrameDuration; // Duration of ONE frame in us!
 }mkvTrak;
 
 #define MKV_MAX_LACES 20 // ?
@@ -63,9 +63,8 @@
     mkvIndex                    *_clusters;
     uint32_t                    _nbClusters;
     uint32_t                    _currentCluster;
-    
+
     uint32_t                    _frameDurationInSample; // Nb Samples per frame
-    
     uint32_t                    _currentLace;
     uint32_t                    _maxLace;
     uint32_t                    _Laces[MKV_MAX_LACES];
@@ -75,8 +74,8 @@
     uint32_t                    _curTimeCode;
   public:
                                 mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters);
-                                
-                                
+
+
     virtual                     ~mkvAudio();
     virtual uint32_t            read(uint32_t len,uint8_t *buffer);
     virtual uint8_t             goTo(uint32_t newoffset);
@@ -92,7 +91,7 @@
 class mkvHeader         :public vidHeader
 {
   protected:
-                                
+
     ADM_ebml_file           *_parser;
     char                    *_filename;
     mkvTrak                 _tracks[ADM_MKV_MAX_TRACKS+1];
@@ -100,31 +99,31 @@
     mkvIndex                    *_clusters;
     uint32_t                    _nbClusters;
     uint32_t                    _clustersCeil;
- 
+
     uint32_t                _nbAudioTrack;
     uint32_t                _currentAudioTrack;
     uint32_t                _reordered;
-    
+
     uint8_t                 checkHeader(void *head,uint32_t headlen);
     uint8_t                 analyzeTracks(void *head,uint32_t headlen);
     uint8_t                 analyzeOneTrack(void *head,uint32_t headlen);
     uint8_t                 walk(void *seed);
     int                     searchTrackFromTid(uint32_t tid);
     //
-    uint8_t                 reformatVorbisHeader(mkvTrak *trk);  
+    uint8_t                 reformatVorbisHeader(mkvTrak *trk);
     // Indexers
-    
+
     uint8_t                 addIndexEntry(uint32_t track,uint64_t where, uint32_t size,uint32_t flags,
                                             uint32_t timecodeMS);
     uint8_t                 videoIndexer(ADM_ebml_file *parser);
     uint8_t                 readCue(ADM_ebml_file *parser);
     uint8_t                 indexClusters(ADM_ebml_file *parser);
     uint8_t                 indexBlock(ADM_ebml_file *parser,uint32_t count,uint32_t timecodeMS);
-    
+
     uint8_t                 changeAudioStream(uint32_t newstream);
     uint32_t                getCurrentAudioStreamNumber(void);
     uint8_t                 getAudioStreamsInfo(uint32_t *nbStreams, audioInfo **infos);
-    
+    uint8_t                 rescaleTrack(mkvTrak *track,uint32_t durationMs);
   public:
 
       uint8_t               hasPtsDts(void) {return 1;} // Return 1 if the container gives PTS & DTS info



From mean at mail.berlios.de  Sat Jun  7 22:24:16 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jun 2008 22:24:16 +0200
Subject: [Avidemux-svn-commit] r4086 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806072024.m57KOG20019919@sheep.berlios.de>

Author: mean
Date: 2008-06-07 22:24:16 +0200 (Sat, 07 Jun 2008)
New Revision: 4086

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
Log:
[MKV] Keep track of the # of audio packets

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-07 20:23:26 UTC (rev 4085)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-07 20:24:16 UTC (rev 4086)
@@ -44,7 +44,7 @@
   uint64_t id;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
    parser->seek(0);
    DIA_working *work=new DIA_working("Matroska Images");
    // Start with a small index, it will grow automatically afterward
@@ -73,8 +73,8 @@
       //printf("\t\tFound %s\n",ss);
       switch(id)
       {
-                default: 
-                case MKV_TIMECODE: 
+                default:
+                case MKV_TIMECODE:
                   //printf("Skipping %s\n",ss);
                   cluster.skip(len);
                   break;
@@ -101,7 +101,7 @@
                                 switch(id)
                                 {
                                   default: blockGroup.skip(len);
-                                  case MKV_BLOCK : 
+                                  case MKV_BLOCK :
                                   case MKV_SIMPLE_BLOCK:
                                   {
                                     indexBlock(&blockGroup,len,_clusters[clusters].timeCode);
@@ -111,7 +111,7 @@
                           }
                           thiscluster++;
             }
-            
+
             break; // Block Group
        }
      }
@@ -130,19 +130,19 @@
   int lacing,nbLaces,entryFlags=0;
   //
   uint64_t tail=parser->tell()+len;
-  // Read Track id 
+  // Read Track id
   uint32_t tid=parser->readEBMCode();
   int track=searchTrackFromTid(tid);
-  
+
       //printf("Wanted %u got %u\n",_tracks[0].streamIndex,tid);
       if(track==-1) //dont care track
       {
-        
+
         parser->seek(tail);
         return 1; // we do only video here...
       }
       // Skip timecode
-      int16_t timecode=parser->readSignedInt(2); 
+      int16_t timecode=parser->readSignedInt(2);
       //if(!track) printf("TC: %d\n",timecode);
       uint8_t flags=parser->readu8();
       uint32_t remaining=tail-parser->tell();
@@ -153,12 +153,13 @@
       {
         case 0: // No lacing
               if(!track) // Video
-              {    
+              {
                   addIndexEntry(track,parser->tell(),remaining,entryFlags,clusterTimeCodeMs+timecode);
               }
               else
               {
-                _tracks[track]._sizeInBytes+=remaining; // keep some stat, useful for audio 
+                _tracks[track]._sizeInBytes+=remaining; // keep some stat, useful for audio
+                _tracks[track].nbPackets++;
               }
               break;
         case 2 : // Constant size lacing
@@ -166,14 +167,14 @@
                     nbLaces=parser->readu8()+1;
                     remaining--;
                     // Only mp3/Ac3 supported, ignore lacing FIXME : Vorbis or AAC will not work
-                    
-                    
+
+
                     int bsize=remaining/nbLaces;
                     if(bsize*nbLaces!=remaining)
                     {
                       printf("Warning not multiple bsize=%d total=%u  nbLaces=%u\n",bsize,remaining,nbLaces);
                     }
-                    if(!track) 
+                    if(!track)
                     {
                       addIndexEntry(track,parser->tell(),remaining,0,clusterTimeCodeMs+timecode);
                       printf("Warning lacing on video track\n");
@@ -181,6 +182,7 @@
                     else
                     {
                        _tracks[track]._sizeInBytes+=remaining;
+                       _tracks[track].nbPackets++;
                     }
                     //printf("tid:%u track %u Remaining : %llu laces %u blksize %d er%d\n",tid,track,remaining,nbLaces,remaining/nbLaces,remaining-(remaining/nbLaces)*nbLaces);
             }
@@ -188,7 +190,7 @@
 #if 1
         case 3: // Ebml lacing
           {
-                                
+
                                 int nbLaces=parser->readu8();
                                 for(int i=1;i<nbLaces;i++)
                                 {
@@ -197,13 +199,14 @@
                                 ADM_assert(track); // Not video!
                                 if(parser->tell()>=tail)
                                 {
-                                  printf("[MKVINDEXER]OOps overflow for EBML(track %u tid%u) at 0x%llx\n",track,tid,parser->tell()); 
+                                  printf("[MKVINDEXER]OOps overflow for EBML(track %u tid%u) at 0x%llx\n",track,tid,parser->tell());
                                   break;
                                 }else
                                 {
                                     _tracks[track]._sizeInBytes+=tail-parser->tell();
+                                    _tracks[track].nbPackets++;
                                 }
-                                
+
                               }
             break;
 #endif
@@ -217,16 +220,17 @@
                                 }
                                 if(parser->tell()>=tail)
                                 {
-                                  printf("[MKVINDEXER]OOps overflow for XIPH(track %u tid%u) at 0x%llx\n",track,tid,parser->tell()); 
+                                  printf("[MKVINDEXER]OOps overflow for XIPH(track %u tid%u) at 0x%llx\n",track,tid,parser->tell());
                                   break;
                                 }
                                 ADM_assert(track); // Not video!
                                 _tracks[track]._sizeInBytes+=(tail-parser->tell());
+                                _tracks[track].nbPackets++;
                                 //printf("This round %lld total:%lld\n",tail-parser->tell(),    _tracks[track]._sizeInBytes);
                                 break;
-          
+
         }
-        default: 
+        default:
             printf("unsupported lacing Track:%d (%d)\n",track,lacing);
             break;
       }
@@ -246,21 +250,21 @@
   // Need to grow index ?
   if(Track->_nbIndex==Track->_indexMax-1)
   {
-    // Realloc 
+    // Realloc
     mkvIndex *dx=new mkvIndex[Track->_indexMax*2];
     memcpy(dx, Track->_index,sizeof(mkvIndex)*Track->_nbIndex);
     Track->_indexMax*=2;
     delete [] Track->_index;
     Track->_index=dx;
   }
-  
+
   mkvIndex *index=Track->_index;
   int x=Track->_nbIndex;
   index[x].pos=where;
   index[x].size=size;
   index[x].flags=AVI_KEY_FRAME;
   index[x].timeCode=0;
-  
+
   float f=timecodeMS;
   uint32_t delta;
   f*=_videostream.dwRate;
@@ -270,14 +274,14 @@
   //printf("Frame :%u rawTimeCode:%u convertedtoframe:%u \n",Track->_nbIndex,timecodeMS,delta);
   if(delta+2<Track->_nbIndex)
   {
-    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u, raw value %u,dwrate=%u)\n",Track->_nbIndex,delta,timecodeMS,_videostream.dwRate); 
+    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u, raw value %u,dwrate=%u)\n",Track->_nbIndex,delta,timecodeMS,_videostream.dwRate);
     index[x].timeCode=0;
   }else
   {
     index[x].timeCode=delta+1-Track->_nbIndex;
   }
   Track->_nbIndex++;
-  
+
  // printf("++\n");
   return 1;
 }
@@ -310,9 +314,9 @@
   const char *ss;
   uint64_t time;
   uint64_t segmentPos;
-  
+
    parser->seek(0);
-   
+
    if(!parser->simplefind(MKV_SEGMENT,&vlen,1))
    {
      printf("[MKV] Cannot find CLUSTER atom\n");
@@ -320,7 +324,7 @@
    }
    ADM_ebml_file segment(parser,vlen);
    segmentPos=segment.tell();
-   
+
    while(segment.simplefind(MKV_CUES,&alen,0))
   {
    ADM_ebml_file cues(&segment,alen);
@@ -335,7 +339,7 @@
       }
       if(id!=MKV_CUE_POINT)
       {
-        printf("Found %s in CUES, ignored \n",ss); 
+        printf("Found %s in CUES, ignored \n",ss);
         cues.skip(len);
         continue;
       }
@@ -350,8 +354,8 @@
           continue;
        }
        time=cue.readUnsignedInt(len);
-       
-       
+
+
        cue.readElemId(&id,&len);
        if(id!=MKV_CUE_TRACK_POSITION)
        {
@@ -370,7 +374,7 @@
          {
            case MKV_CUE_TRACK: tid=trackPos.readUnsignedInt(len);break;
            case MKV_CUE_CLUSTER_POSITION: cluster_position=trackPos.readUnsignedInt(len);break;
-           default: 
+           default:
                  ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type);
                  printf("[MKV] in cluster position found tag %s (0x%x)\n",ss,id);
                  trackPos.skip(len);
@@ -382,7 +386,7 @@
      }
    }
    printf("[MKV] Cues updated\n");
-   return 1;  
+   return 1;
 }
 /**
         \fn indexClusters
@@ -403,7 +407,7 @@
   _clusters=new mkvIndex[NB_DEFAULT_CLUSTERS];
   _clustersCeil=NB_DEFAULT_CLUSTERS;
   _nbClusters=0;
-  
+
   // Search segment
    fileSize=parser->getFileSize();
    if(!parser->simplefind(MKV_SEGMENT,&vlen,1))
@@ -413,9 +417,9 @@
    }
    ADM_ebml_file segment(parser,vlen);
    DIA_working *work=new DIA_working("Matroska clusters");
-   while(segment.simplefind(MKV_CLUSTER,&alen,0)) 
+   while(segment.simplefind(MKV_CLUSTER,&alen,0))
    {
-     
+
      // UI update
      work->update(segment.tell()>>10,fileSize>>10);
      // Grow clusters index if needed
@@ -429,8 +433,8 @@
      }
      _clusters[_nbClusters].pos=segment.tell();
      _clusters[_nbClusters].size=alen;
-     
-     // Normally the timecode is the 1st one following 
+
+     // Normally the timecode is the 1st one following
        segment.readElemId(&id,&len);
        int seekme=_nbClusters;
        if(id!=MKV_TIMECODE)
@@ -438,7 +442,7 @@
           ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type);
           printf("[MKV] Cluster : no time code Found %s(0x%x), expected MKV_TIMECODE  (0x%x)\n",
                   ss,id,MKV_TIMECODE);
-       } 
+       }
        else
        {
            uint64_t timecode=segment.readUnsignedInt(len);



From mean at mail.berlios.de  Sat Jun  7 22:25:47 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jun 2008 22:25:47 +0200
Subject: [Avidemux-svn-commit] r4087 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806072025.m57KPllW020023@sheep.berlios.de>

Author: mean
Date: 2008-06-07 22:25:47 +0200 (Sat, 07 Jun 2008)
New Revision: 4087

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
Log:
[MKV] Display # of audio packets

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-07 20:24:16 UTC (rev 4086)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-07 20:25:47 UTC (rev 4087)
@@ -33,14 +33,14 @@
 
 /**
     \fn ~mkvAudio
-    
+
 */
  mkvAudio ::~mkvAudio()
 {
   if(_clusterParser)  delete _clusterParser;
   _clusterParser=NULL;
     if(_parser) delete _parser;
-  _parser=NULL; 
+  _parser=NULL;
 
 }
 
@@ -65,7 +65,7 @@
 uint8_t             mkvAudio::extraData(uint32_t *l,uint8_t **d)
 {
   *l=_track->extraDataLen;
-  *d=_track->extraData; 
+  *d=_track->extraData;
 }
 /**
     \fn getPacket
@@ -89,10 +89,25 @@
       _clusterParser->readBin(dest,_Laces[_currentLace]);
       *packlen= _Laces[_currentLace];
       vprintf("Continuing lacing : %u bytes, lacing %u/%u\n",*packlen,_currentLace,_maxLace);
+
+      if(_currentLace==_maxLace-1)
+      {
+          float f;
+          f=_frameDurationInSample;
+          f/=_maxLace;
+          uint32_t total=(uint32_t)floor(f);
+          total*=(_maxLace-1);
+          *samples=_frameDurationInSample-total;
+          ADM_assert(_frameDurationInSample>=total);
+      }else
+      {
+          float f;
+          f=_frameDurationInSample;
+          f/=_maxLace;
+          *samples=(uint32_t )floor(f);
+      }
+      *timecode=_curTimeCode;
       _currentLace++;
-      *samples=_frameDurationInSample;
-      *timecode=_curTimeCode;
-      
       return 1;
     }
     while(1)
@@ -104,14 +119,14 @@
           if(!goToCluster(_currentCluster+1))
           {
             printf("[MKVAUDIO] cannot go to next cluster\n");
-            return 0; 
+            return 0;
           }
           _currentCluster++;
         }
         // Ok read a new block
         while(!_clusterParser->finished())
         {
-          
+
             _clusterParser->readElemId(&id,&len);
             pos=_clusterParser->tell();
             if(!ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type))
@@ -120,23 +135,23 @@
               _clusterParser->skip(len);
               continue;
             }
-            
+
             vprintf("[MKVAudio]Found tag %x (%s) at 0x%llx len %u\n",id,ss,_clusterParser->tell(),len);
-            
+
             switch(id)
             {
               default:
               case MKV_TIMECODE:     _clusterParser->skip(len);  break;
               case MKV_BLOCK_GROUP:    break;
-              case MKV_SIMPLE_BLOCK: 
-              case MKV_BLOCK: 
+              case MKV_SIMPLE_BLOCK:
+              case MKV_BLOCK:
               {
                   uint32_t tid=_clusterParser->readEBMCode();
                   uint64_t tail=pos+len;
                   uint64_t head=pos;
-                  
+
                   // FIXME WARNING ASSUME TRACK FITS ON 1 BYTE!
-                  len--; 
+                  len--;
                   vprintf("Tid = %u, my tid=%u\n",tid,_track->streamIndex);
                   if(tid!=_track->streamIndex)
                     {
@@ -155,19 +170,19 @@
                     uint32_t lacing=((flags>>1)&3);
                     switch(lacing)
                     {
-                      case 0 : // no lacing 
-                          
+                      case 0 : // no lacing
+
                               vprintf("No lacing :%d bytes\n",remaining);
                               _clusterParser->readBin(dest,remaining);
-                              *packlen=remaining; 
+                              *packlen=remaining;
                               *samples=_frameDurationInSample;
                               _currentLace=_maxLace=0;
-                              
+
                               return 1;
                       case 1: //Xiph lacing
                         {
                                 int nbLaces=_clusterParser->readu8()+1;
-                                
+
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
@@ -178,40 +193,40 @@
                                   _Laces[i]=lce;
                                 }
                                 int64_t d=_clusterParser->tell();
-                                
+
                                 d=tail-d;
                                 /* We have the remaining size after laces, substract the already known lace size */
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
-                                  d-=_Laces[i]; 
+                                  d-=_Laces[i];
                                 }
                                 // What is left is the sift of the last lace
                                 if(d>0)
-                                  _Laces[nbLaces-1]=(uint32_t)d; 
+                                  _Laces[nbLaces-1]=(uint32_t)d;
                                 else
                                 {
                                   printf("[MKVAUDIO] OOps overflow on Xiph\n");
-                                  nbLaces--; 
+                                  nbLaces--;
                                 }
 
-                                
+
                                 _currentLace=0;
                                 _maxLace=nbLaces;
                                 return getPacket(dest, packlen, samples);
                               }
-                              
+
                               break;
                       case 2 : // constant size lacing
                               {
                                 int nbLaces=_clusterParser->readu8()+1;
-                                
+
                                 remaining--;
                                 int bsize=remaining/nbLaces;
                                 vprintf("NbLaces :%u lacesize:%u\n",nbLaces,bsize);
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=0;i<nbLaces;i++)
                                 {
-                                  _Laces[i]=bsize; 
+                                  _Laces[i]=bsize;
                                 }
                                 _currentLace=0;
                                 _maxLace=nbLaces;
@@ -220,13 +235,13 @@
                               break;
                       case 3: // Ebml lacing
                         {
-                                
+
                                 int nbLaces=_clusterParser->readu8()+1;
                                 int32_t curSize=_clusterParser->readEBMCode();
                                 int32_t delta;
-                                
+
                                 vprintf("Ebml nbLaces :%u lacesize(0):%u\n",nbLaces,curSize);
-                                
+
                                 _Laces[0]=curSize;
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=1;i<nbLaces-1;i++)
@@ -235,24 +250,24 @@
                                   vprintf("Ebml delta :%d lacesize[%d]->:%d\n",delta,i,curSize+delta);
                                   curSize+=delta;
                                   ADM_assert(curSize>0);
-                                  _Laces[i]=curSize; 
-                                 
+                                  _Laces[i]=curSize;
+
                                 }
                                 int64_t d=_clusterParser->tell();
-                                
+
                                 d=tail-d;
                                 /* We have the remaining size after laces, substract the already known lace size */
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
-                                  d-=_Laces[i]; 
+                                  d-=_Laces[i];
                                 }
                                 // What is left is the sift of the last lace
                                 if(d>0)
-                                  _Laces[nbLaces-1]=(uint32_t)d; 
+                                  _Laces[nbLaces-1]=(uint32_t)d;
                                 else
                                 {
                                   printf("[MKVAUDIO] OOps overflow on ebml\n");
-                                  nbLaces--; 
+                                  nbLaces--;
                                 }
                                 _currentLace=0;
                                 _maxLace=nbLaces;
@@ -263,7 +278,7 @@
                             printf("Unsupported lacing %u\n",lacing);
                             _clusterParser->seek(pos+len);
                     }
-                
+
               }
               break;
             }
@@ -272,33 +287,35 @@
   return 0;
 }
 /**
-      \fn mkvAudio 
+      \fn mkvAudio
 */
- mkvAudio::mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters) 
+ mkvAudio::mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters)
   : AVDMGenericAudioStream()
 {
   _nbClusters=nbClusters;
   _clusters=clust;
   ADM_assert(_clusters);
   _destroyable = 1;
-  
+
    _parser=new ADM_ebml_file();
    ADM_assert(_parser->open(name));
-  _track=track; 
+  _track=track;
   ADM_assert(_track);
-  
-  
+
+
   // Compute total length in byte
   _length=_track->_sizeInBytes; // FIXME
-  
+
   float f=_track->wavHeader.frequency;
   f*=_track->_defaultFrameDuration;
   f=f/1000000.;
-  
+
   _frameDurationInSample=(uint32_t)floor(f+0.5);
-  
+
   _wavheader=new WAVHeader;
   memcpy(_wavheader,&(_track->wavHeader),sizeof(WAVHeader));
+  printf("[MKVAUDIO] found %lu packets\n",track->nbPackets);
+  printf("[MKVAUDIO] Default duration %u us\n",_track->_defaultFrameDuration);
   printf("[MKVAUDIO] found %lu bytes, %u samples per frame\n",_length,_frameDurationInSample);
   _currentLace=_maxLace=0;
   _clusterParser=NULL;
@@ -328,20 +345,21 @@
 uint8_t mkvAudio::goToCluster(uint32_t x)
 {
   ADM_assert(_nbClusters);
-  
+
   if(x>=_nbClusters)
   {
-    printf("Exceeding max cluster : asked: %u max :%u\n",x,_nbClusters); 
+    printf("Exceeding max cluster : asked: %u max :%u\n",x,_nbClusters);
     return 0;  // FIXME
   }
-  
+
   if( _clusterParser) delete _clusterParser;
   _clusterParser=NULL;
-  
+
   //************/
   _parser->seek(_clusters[x].pos);
   _clusterParser=new ADM_ebml_file(_parser,_clusters[x].size);
   _currentLace=_maxLace=0;
+
   printf("switching to cluster :%u/%u\n",x,_nbClusters);
   return 1;
 }
@@ -360,16 +378,16 @@
               if(target>=_clusters[i].timeCode && target<_clusters[i+1].timeCode)
               {
                 clus=i;
-                i=_nbClusters; 
+                i=_nbClusters;
               }
             }
             if(clus==-1) clus=_nbClusters-1; // Hopefully in the last one
-            
+
             target-=_clusters[clus].timeCode; // now the time is relative
             goToCluster(clus);
             _currentCluster=clus;
             _curTimeCode=_clusters[clus].timeCode;
-            
+
             printf("[MKVAUDIO] Asked for %u ms, go to cluster %u which starts at %u\n",mstime,clus,_curTimeCode);
             if(clus<_nbClusters-1)
               printf("[MKVAUDIO] next cluster starts at %u\n",_clusters[clus+1].timeCode);
@@ -383,9 +401,9 @@
             {
               uint32_t curTime=_clusters[_currentCluster].timeCode;
               vprintf("Wanted: %u clus : %u Timecode:%u=> %u\n",mstime,curTime,timecode,timecode+curTime);
-              ADM_assert(len<MAX_SEEK_BUFFER); 
-              
-              if(timecode+curTime>=mstime) 
+              ADM_assert(len<MAX_SEEK_BUFFER);
+
+              if(timecode+curTime>=mstime)
               {
                 printf("[MKV audio] fine seek to %u (clu)+%u=%u\n",curTime,timecode,timecode+curTime);
                 return 1;



From mean at mail.berlios.de  Sat Jun  7 22:32:22 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jun 2008 22:32:22 +0200
Subject: [Avidemux-svn-commit] r4088 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806072032.m57KWMh8020427@sheep.berlios.de>

Author: mean
Date: 2008-06-07 22:32:22 +0200 (Sat, 07 Jun 2008)
New Revision: 4088

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
Log:
[MKV] Mitigate error on the duration of audio track, final part

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-07 20:25:47 UTC (rev 4087)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-07 20:32:22 UTC (rev 4088)
@@ -124,6 +124,7 @@
 */
 uint8_t mkvHeader::rescaleTrack(mkvTrak *track,uint32_t durationMs)
 {
+        if(track->_defaultFrameDuration) return 1; // No need to change
         float samples=1000.;
         samples*=durationMs;
         samples/=track->nbPackets;  // 1000 * sample per packet

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-06-07 20:25:47 UTC (rev 4087)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-06-07 20:32:22 UTC (rev 4088)
@@ -37,14 +37,14 @@
           uint32_t     trackNo;
           uint32_t     trackType;
           uint32_t     extraDataLen;
-          
+
           uint32_t fcc;
           uint32_t w,h,fps;
           uint32_t fq,chan,bpp;
           uint32_t defaultDuration;
           float    trackScale;
           uint8_t *extraData;
-          
+
           void dump(void);
 };
 /* Prototypes */
@@ -86,7 +86,7 @@
 /**
       \fn analyzeOneTrack
       \brief Grab info about the track (it is a recursive function !)
-              
+
 */
 uint8_t mkvHeader::analyzeOneTrack(void *head,uint32_t headlen)
 {
@@ -96,12 +96,12 @@
       /* Set some defaults value */
 
       entry.chan=2;
-      
+
       entryWalk(  (ADM_ebml_file *)head,headlen,&entry);
       entry.dump();
       if(entry.trackType==1 &&  !_isvideopresent)
       {
-        _isvideopresent=1; 
+        _isvideopresent=1;
         if(entry.defaultDuration)
         {
             _tracks[0]._defaultFrameDuration=entry.defaultDuration;
@@ -114,13 +114,13 @@
             _videostream.dwRate=(uint32_t)inv;
         }else
         {
-          printf("[MKV] No duration, assuming 25 fps\n"); 
+          printf("[MKV] No duration, assuming 25 fps\n");
           _videostream.dwScale=1000;
           _videostream.dwRate=25000;
 
         }
-    
-        _mainaviheader.dwMicroSecPerFrame=(uint32_t)floor(50);;     
+
+        _mainaviheader.dwMicroSecPerFrame=(uint32_t)floor(50);;
         _videostream.fccType=fourCC::get((uint8_t *)"vids");
         _video_bih.biBitCount=24;
         _videostream.dwInitialFrames= 0;
@@ -128,7 +128,7 @@
         _video_bih.biWidth=_mainaviheader.dwWidth=entry.w;
         _video_bih.biHeight=_mainaviheader.dwHeight=entry.h;
         _videostream.fccHandler=_video_bih.biCompression=entry.fcc;
-        
+
         // if it is vfw...
         if(fourCC::check(entry.fcc,(uint8_t *)"VFWX") && entry.extraData && entry.extraDataLen>=sizeof(BITMAPINFOHEADER))
         {
@@ -136,24 +136,24 @@
           delete [] _tracks[0].extraData;
           entry.extraData=NULL;
           entry.extraDataLen=0;
-          
+
           _videostream.fccHandler=_video_bih.biCompression;
           _mainaviheader.dwWidth=  _video_bih.biWidth;
-          _mainaviheader.dwHeight= _video_bih.biHeight;    
-          
+          _mainaviheader.dwHeight= _video_bih.biHeight;
+
         } // FIXME there can be real extradata after bitmapinfoheader
-        
-        _tracks[0].extraData=entry.extraData; 
-        _tracks[0].extraDataLen=entry.extraDataLen;       
+
+        _tracks[0].extraData=entry.extraData;
+        _tracks[0].extraDataLen=entry.extraDataLen;
         _tracks[0].streamIndex=entry.trackNo;
-        
+
         return 1;
       }
       if(entry.trackType==2 && _nbAudioTrack<ADM_MKV_MAX_TRACKS)
       {
          uint32_t  streamIndex;
          mkvTrak *t=&(_tracks[1+_nbAudioTrack]);
-         
+
          t->wavHeader.encoding=entry.fcc;
          t->wavHeader.channels=entry.chan;
          t->wavHeader.frequency=entry.fq;
@@ -165,15 +165,15 @@
          if(entry.defaultDuration)
           t->_defaultFrameDuration=entry.defaultDuration;
          else
-           t->_defaultFrameDuration=24000;
+           t->_defaultFrameDuration=0;
         _nbAudioTrack++;
         return 1;
       }
       if(entry.extraData) delete [] entry.extraData;
       return 1;
-  
+
 }
-  
+
 /**
     \fn entryWalk
     \brief walk a trackEntry atom and grabs all infos. Store them in entry
@@ -184,7 +184,7 @@
    uint64_t id,len;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
   while(!father.finished())
   {
       father.readElemId(&id,&len);
@@ -196,7 +196,7 @@
       }
       switch(id)
       {
-        
+
         case  MKV_TRACK_NUMBER: entry->trackNo=father.readUnsignedInt(len);break;
         case  MKV_TRACK_TYPE: entry->trackType=father.readUnsignedInt(len);break;
 
@@ -225,13 +225,13 @@
                   father.readBin(codec,len);
                   codec[len]=0;
                   entry->fcc=ADM_mkvCodecToFourcc((char *)codec);
-                  
+
             }
                   break;
         default: printf("[MKV]not handled %s\n",ss);
-                  father.skip(len);  
+                  father.skip(len);
         }
-        
+
       }
   return 1;
 }//EOF



From mean at mail.berlios.de  Sun Jun  8 09:16:46 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jun 2008 09:16:46 +0200
Subject: [Avidemux-svn-commit] r4089 - in
	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_codecs
	avidemux/ADM_inputs/ADM_matroska
	avidemux/ADM_libraries/ADM_utilities avidemux/ADM_outputs
	avidemux/ADM_outputs/oplug_flv plugins/ADM_videoFilters/Ass
Message-ID: <200806080716.m587GkM0012339@sheep.berlios.de>

Author: mean
Date: 2008-06-08 09:16:45 +0200 (Sun, 08 Jun 2008)
New Revision: 4089

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt
Log:
[MKV] Merge


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -150,6 +150,23 @@
 
 #undef CHECK
 }
+uint8_t isVP6Compatible (uint32_t fourcc)
+{
+
+#define CHECK(x) if(fourCC::check(fourcc,(uint8_t *)x)) \
+						{divx3=1; }
+
+  uint8_t divx3 = 0;
+
+  CHECK ("VP6F");
+  CHECK ("VP6 ");
+  CHECK ("VP61");
+  CHECK ("VP62");
+
+  return divx3;
+
+#undef CHECK
+}
 uint8_t
 isDVCompatible (uint32_t fourcc)
 {
@@ -363,8 +380,7 @@
       return (decoders *) (new decoderFFAMV (w, h,extraLen,extraData));
     }
 
-    
-  if (fourCC::check (fcc, (uint8_t *) "VP6F"))
+    if (isVP6Compatible(fcc))
     {
       printf ("\n using VP6F codec\n");
       return (decoders *) (new decoderFFVP6F (w, h,extraLen,extraData));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -31,19 +31,19 @@
 
 uint8_t mkvHeader::open(char *name)
 {
- 
+
   ADM_ebml_file ebml;
   uint64_t id,len;
   uint64_t alen;
   ADM_MKV_TYPE type;
   const char *ss;
-  
-  
+
+
   _isvideopresent=0;
-  if(!ebml.open(name)) 
+  if(!ebml.open(name))
   {
     printf("[MKV]Failed to open file\n");
-    return 0; 
+    return 0;
   }
   if(!ebml.find(ADM_MKV_PRIMARY,EBML_HEADER,(MKV_ELEM_ID)0,&alen))
   {
@@ -84,30 +84,50 @@
     if(!videoIndexer(&ebml))
     {
       printf("[MKV] Video indexing failed\n");
-      return 0; 
+      return 0;
     }
   // update some infos
-  _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0]._nbIndex; 
-  
+  _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0]._nbIndex;
+
   _parser=new ADM_ebml_file();
   ADM_assert(_parser->open(name));
   _filename=ADM_strdup(name);
-  
+
   // Finaly update index with queue
+  float duration=_videostream.dwLength*_tracks[0]._defaultFrameDuration;
+  duration/=1000;
+  uint32_t duration32=(uint32_t)duration;
+  printf("[MKV] Video Track duration %u ms\n",_videostream.dwLength);
   // Useless.....readCue(&ebml);
   for(int i=0;i<_nbAudioTrack;i++)
   {
+    rescaleTrack(&(_tracks[1+i]),duration32);
     if(_tracks[1+i].wavHeader.encoding==WAV_OGG)
     {
         printf("[MKV] Reformatting vorbis header for track %u\n",i);
-        reformatVorbisHeader(&(_tracks[1+i]));  
+        reformatVorbisHeader(&(_tracks[1+i]));
     }
   }
   printf("[MKV]Matroska successfully read\n");
-  
+
   return 1;
 }
 /**
+    \fn rescaleTrack
+    \brief Compute the average duration of one audio frame if the info is not present in the stream
+
+*/
+uint8_t mkvHeader::rescaleTrack(mkvTrak *track,uint32_t durationMs)
+{
+        if(track->_defaultFrameDuration) return 1; // No need to change
+        float samples=1000.;
+        samples*=durationMs;
+        samples/=track->nbPackets;  // 1000 * sample per packet
+        track->_defaultFrameDuration=(uint32_t)samples;
+        return 1;
+
+}
+/**
     \fn checkHeader
     \brief Check that we are compatible with that version of matroska. At the moment, just dump some infos.
 */
@@ -117,8 +137,8 @@
  ADM_ebml_file father( (ADM_ebml_file *)head,headlen);
  walk(&father);
  printf("[MKV] *** End of Header dump ***\n");
- return 1; 
-  
+ return 1;
+
 }
 /**
     \fn analyzeTracks
@@ -140,15 +160,15 @@
         continue;
       }
       ADM_assert(ss);
-      if(id!=MKV_TRACK_ENTRY) 
+      if(id!=MKV_TRACK_ENTRY)
       {
         printf("[MKV] skipping %s\n",ss);
         father.skip(len);
-        continue; 
+        continue;
       }
       if(!analyzeOneTrack(&father,len)) return 0;
  }
- return 1; 
+ return 1;
 }
 
 /**
@@ -160,7 +180,7 @@
   uint64_t id,len;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
    ADM_ebml_file *father=(ADM_ebml_file *)seed;
     while(!father->finished())
    {
@@ -210,7 +230,7 @@
 {
   if(_nbAudioTrack)
   {
-    return &(_tracks[1+_currentAudioTrack].wavHeader); 
+    return &(_tracks[1+_currentAudioTrack].wavHeader);
   }
   return NULL;
 }
@@ -226,7 +246,7 @@
       return 1;
   }
   *audio=NULL;
-  return 0; 
+  return 0;
 }
 /*
     __________________________________________________________
@@ -234,7 +254,7 @@
 
 void mkvHeader::Dump(void)
 {
- 
+
 }
 
 /*
@@ -246,21 +266,21 @@
   if(_clusters)
   {
     delete [] _clusters;
-    _clusters=NULL; 
+    _clusters=NULL;
   }
   // CLEANUP!!
   if(_parser) delete _parser;
   _parser=NULL;
-  
-  
+
+
 #define FREEIF(i) { if(_tracks[i].extraData) delete [] _tracks[i].extraData; _tracks[i].extraData=0;}
   if(_isvideopresent)
   {
-      FREEIF(0); 
+      FREEIF(0);
   }
   for(int i=0;i<_nbAudioTrack;i++)
   {
-    FREEIF(1+i); 
+    FREEIF(1+i);
   }
   // Delete index
   if(_isvideopresent && _tracks[0]._index)
@@ -283,13 +303,13 @@
 */
 
  mkvHeader::mkvHeader( void ) : vidHeader()
-{ 
+{
   _parser=NULL;
   _nbAudioTrack=0;
   _filename=NULL;
   memset(_tracks,0,sizeof(_tracks));
   _reordered=0;
-  
+
   _clusters=NULL;
   _clustersCeil=0;
   _nbClusters=0;
@@ -316,7 +336,7 @@
 {
   if(frame>=_tracks[0]._nbIndex) return 0;
   _tracks[0]._index[frame].flags=flags;
-  return 1; 
+  return 1;
 }
 /*
     __________________________________________________________
@@ -327,7 +347,7 @@
   if(frame>=_tracks[0]._nbIndex) return 0;
   *flags=_tracks[0]._index[frame].flags;
   if(!frame) *flags=AVI_KEY_FRAME;
-  return 1; 
+  return 1;
 }
 /*
     __________________________________________________________
@@ -337,19 +357,19 @@
 {
   ADM_assert(_parser);
   if(framenum>=_tracks[0]._nbIndex) return 0;
-  
+
   mkvIndex *dx=&(_tracks[0]._index[framenum]);
-  
+
   _parser->seek(dx->pos);
   _parser->readBin(img->data,dx->size);
   img->dataLength=dx->size;
-  
+
   img->flags=dx->flags;
-  
+
   if(!framenum) img->flags=AVI_KEY_FRAME;
-  
-  
-  return 1; 
+
+
+  return 1;
 }
 /*
     __________________________________________________________
@@ -359,13 +379,13 @@
 {
                 *len=_tracks[0].extraDataLen;
                 *data=_tracks[0].extraData;
-                return 1;            
+                return 1;
 }
 /*
     __________________________________________________________
 */
 uint8_t			mkvHeader::isReordered( void )
-{ 
+{
  	return _reordered;
 }
 /*
@@ -373,16 +393,16 @@
 */
 uint8_t mkvHeader::reorder( void )
 {
-  
+
 #define INDEX_TMPL        mkvIndex
 #define INDEX_ARRAY_TMPL  (_tracks[0]._index)
 #define FRAMETYPE_TMPL    flags
-  
+
 #include "ADM_video/ADM_reorderTemplate.cpp"
 
-#undef INDEX_TMPL       
-#undef INDEX_ARRAY_TMPL 
-#undef FRAMETYPE_TMPL   
+#undef INDEX_TMPL
+#undef INDEX_ARRAY_TMPL
+#undef FRAMETYPE_TMPL
      _tracks[0]._nbIndex=_videostream.dwLength;
          return 1;
 }
@@ -457,14 +477,14 @@
         head++; \
       } \
       x+=*head++;
-  
+
       READ_LEN(len1);
       READ_LEN(len2);
       len3=oldata+oldlen-head;
       if(len3<=len1+len2)
       {
         printf("Error in vorbis header, len3 too small %u %u / %u\n",len1,len2,len3);
-        return 0; 
+        return 0;
       }
       len3-=(len1+len2);
       printf("Found packet len : %u %u %u, total size %u\n",len1,len2,len3,oldlen);
@@ -475,7 +495,7 @@
       memcpy(cp,head,len1);
       memcpy(cp+len1,head+len1,len2);
       memcpy(cp+len1+len2,head+len1+len2,len3);
-      
+
       uint32_t *h=(uint32_t *)nwdata;
       h[0]=len1;
       h[1]=len2;
@@ -484,7 +504,7 @@
       delete [] oldata;
       trk->extraData=nwdata;
       trk->extraDataLen=nwlen;
-  return 1; 
+  return 1;
 }
 //****************************************
 /**

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-08 07:16:45 UTC (rev 4089)
@@ -14,9 +14,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
- 
 
 
+
 #ifndef ADM_MKV_H
 #define ADM_MKV_H
 
@@ -25,7 +25,7 @@
 #include "ADM_inputs/ADM_matroska/ADM_ebml.h"
 
 
-typedef struct 
+typedef struct
 {
     uint64_t pos;
     uint32_t size;
@@ -33,11 +33,11 @@
     uint32_t timeCode;  // In fact it is delta between DTS and PTS for audio...
 }mkvIndex;
 //**********************************************
-typedef struct 
+typedef struct
 {
   /* Index in mkv */
   uint32_t  streamIndex;
-  
+
   /* Used for audio */
   WAVHeader wavHeader;
   uint32_t  nbPackets;
@@ -49,7 +49,7 @@
   uint32_t  _nbIndex;  // current size of the index
   uint32_t  _indexMax; // Max size of the index
   uint32_t  _sizeInBytes; // Approximate size in bytes of that stream
-  uint32_t  _defaultFrameDuration; // in us!
+  uint32_t  _defaultFrameDuration; // Duration of ONE frame in us!
 }mkvTrak;
 
 #define MKV_MAX_LACES 20 // ?
@@ -63,9 +63,8 @@
     mkvIndex                    *_clusters;
     uint32_t                    _nbClusters;
     uint32_t                    _currentCluster;
-    
+
     uint32_t                    _frameDurationInSample; // Nb Samples per frame
-    
     uint32_t                    _currentLace;
     uint32_t                    _maxLace;
     uint32_t                    _Laces[MKV_MAX_LACES];
@@ -75,8 +74,8 @@
     uint32_t                    _curTimeCode;
   public:
                                 mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters);
-                                
-                                
+
+
     virtual                     ~mkvAudio();
     virtual uint32_t            read(uint32_t len,uint8_t *buffer);
     virtual uint8_t             goTo(uint32_t newoffset);
@@ -92,7 +91,7 @@
 class mkvHeader         :public vidHeader
 {
   protected:
-                                
+
     ADM_ebml_file           *_parser;
     char                    *_filename;
     mkvTrak                 _tracks[ADM_MKV_MAX_TRACKS+1];
@@ -100,31 +99,31 @@
     mkvIndex                    *_clusters;
     uint32_t                    _nbClusters;
     uint32_t                    _clustersCeil;
- 
+
     uint32_t                _nbAudioTrack;
     uint32_t                _currentAudioTrack;
     uint32_t                _reordered;
-    
+
     uint8_t                 checkHeader(void *head,uint32_t headlen);
     uint8_t                 analyzeTracks(void *head,uint32_t headlen);
     uint8_t                 analyzeOneTrack(void *head,uint32_t headlen);
     uint8_t                 walk(void *seed);
     int                     searchTrackFromTid(uint32_t tid);
     //
-    uint8_t                 reformatVorbisHeader(mkvTrak *trk);  
+    uint8_t                 reformatVorbisHeader(mkvTrak *trk);
     // Indexers
-    
+
     uint8_t                 addIndexEntry(uint32_t track,uint64_t where, uint32_t size,uint32_t flags,
                                             uint32_t timecodeMS);
     uint8_t                 videoIndexer(ADM_ebml_file *parser);
     uint8_t                 readCue(ADM_ebml_file *parser);
     uint8_t                 indexClusters(ADM_ebml_file *parser);
     uint8_t                 indexBlock(ADM_ebml_file *parser,uint32_t count,uint32_t timecodeMS);
-    
+
     uint8_t                 changeAudioStream(uint32_t newstream);
     uint32_t                getCurrentAudioStreamNumber(void);
     uint8_t                 getAudioStreamsInfo(uint32_t *nbStreams, audioInfo **infos);
-    
+    uint8_t                 rescaleTrack(mkvTrak *track,uint32_t durationMs);
   public:
 
       uint8_t               hasPtsDts(void) {return 1;} // Return 1 if the container gives PTS & DTS info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -37,14 +37,14 @@
           uint32_t     trackNo;
           uint32_t     trackType;
           uint32_t     extraDataLen;
-          
+
           uint32_t fcc;
           uint32_t w,h,fps;
           uint32_t fq,chan,bpp;
           uint32_t defaultDuration;
           float    trackScale;
           uint8_t *extraData;
-          
+
           void dump(void);
 };
 /* Prototypes */
@@ -86,7 +86,7 @@
 /**
       \fn analyzeOneTrack
       \brief Grab info about the track (it is a recursive function !)
-              
+
 */
 uint8_t mkvHeader::analyzeOneTrack(void *head,uint32_t headlen)
 {
@@ -96,12 +96,12 @@
       /* Set some defaults value */
 
       entry.chan=2;
-      
+
       entryWalk(  (ADM_ebml_file *)head,headlen,&entry);
       entry.dump();
       if(entry.trackType==1 &&  !_isvideopresent)
       {
-        _isvideopresent=1; 
+        _isvideopresent=1;
         if(entry.defaultDuration)
         {
             _tracks[0]._defaultFrameDuration=entry.defaultDuration;
@@ -114,13 +114,13 @@
             _videostream.dwRate=(uint32_t)inv;
         }else
         {
-          printf("[MKV] No duration, assuming 25 fps\n"); 
+          printf("[MKV] No duration, assuming 25 fps\n");
           _videostream.dwScale=1000;
           _videostream.dwRate=25000;
 
         }
-    
-        _mainaviheader.dwMicroSecPerFrame=(uint32_t)floor(50);;     
+
+        _mainaviheader.dwMicroSecPerFrame=(uint32_t)floor(50);;
         _videostream.fccType=fourCC::get((uint8_t *)"vids");
         _video_bih.biBitCount=24;
         _videostream.dwInitialFrames= 0;
@@ -128,7 +128,7 @@
         _video_bih.biWidth=_mainaviheader.dwWidth=entry.w;
         _video_bih.biHeight=_mainaviheader.dwHeight=entry.h;
         _videostream.fccHandler=_video_bih.biCompression=entry.fcc;
-        
+
         // if it is vfw...
         if(fourCC::check(entry.fcc,(uint8_t *)"VFWX") && entry.extraData && entry.extraDataLen>=sizeof(ADM_BITMAPINFOHEADER))
         {
@@ -136,24 +136,24 @@
           delete [] _tracks[0].extraData;
           entry.extraData=NULL;
           entry.extraDataLen=0;
-          
+
           _videostream.fccHandler=_video_bih.biCompression;
           _mainaviheader.dwWidth=  _video_bih.biWidth;
-          _mainaviheader.dwHeight= _video_bih.biHeight;    
-          
+          _mainaviheader.dwHeight= _video_bih.biHeight;
+
         } // FIXME there can be real extradata after bitmapinfoheader
-        
-        _tracks[0].extraData=entry.extraData; 
-        _tracks[0].extraDataLen=entry.extraDataLen;       
+
+        _tracks[0].extraData=entry.extraData;
+        _tracks[0].extraDataLen=entry.extraDataLen;
         _tracks[0].streamIndex=entry.trackNo;
-        
+
         return 1;
       }
       if(entry.trackType==2 && _nbAudioTrack<ADM_MKV_MAX_TRACKS)
       {
          uint32_t  streamIndex;
          mkvTrak *t=&(_tracks[1+_nbAudioTrack]);
-         
+
          t->wavHeader.encoding=entry.fcc;
          t->wavHeader.channels=entry.chan;
          t->wavHeader.frequency=entry.fq;
@@ -165,15 +165,15 @@
          if(entry.defaultDuration)
           t->_defaultFrameDuration=entry.defaultDuration;
          else
-           t->_defaultFrameDuration=24000;
+           t->_defaultFrameDuration=0;
         _nbAudioTrack++;
         return 1;
       }
       if(entry.extraData) delete [] entry.extraData;
       return 1;
-  
+
 }
-  
+
 /**
     \fn entryWalk
     \brief walk a trackEntry atom and grabs all infos. Store them in entry
@@ -184,7 +184,7 @@
    uint64_t id,len;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
   while(!father.finished())
   {
       father.readElemId(&id,&len);
@@ -196,7 +196,7 @@
       }
       switch(id)
       {
-        
+
         case  MKV_TRACK_NUMBER: entry->trackNo=father.readUnsignedInt(len);break;
         case  MKV_TRACK_TYPE: entry->trackType=father.readUnsignedInt(len);break;
 
@@ -225,13 +225,13 @@
                   father.readBin(codec,len);
                   codec[len]=0;
                   entry->fcc=ADM_mkvCodecToFourcc((char *)codec);
-                  
+
             }
                   break;
         default: printf("[MKV]not handled %s\n",ss);
-                  father.skip(len);  
+                  father.skip(len);
         }
-        
+
       }
   return 1;
 }//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -44,7 +44,7 @@
   uint64_t id;
   ADM_MKV_TYPE type;
   const char *ss;
-  
+
    parser->seek(0);
    DIA_working *work=new DIA_working("Matroska Images");
    // Start with a small index, it will grow automatically afterward
@@ -73,8 +73,8 @@
       //printf("\t\tFound %s\n",ss);
       switch(id)
       {
-                default: 
-                case MKV_TIMECODE: 
+                default:
+                case MKV_TIMECODE:
                   //printf("Skipping %s\n",ss);
                   cluster.skip(len);
                   break;
@@ -101,7 +101,7 @@
                                 switch(id)
                                 {
                                   default: blockGroup.skip(len);
-                                  case MKV_BLOCK : 
+                                  case MKV_BLOCK :
                                   case MKV_SIMPLE_BLOCK:
                                   {
                                     indexBlock(&blockGroup,len,_clusters[clusters].timeCode);
@@ -111,7 +111,7 @@
                           }
                           thiscluster++;
             }
-            
+
             break; // Block Group
        }
      }
@@ -130,19 +130,19 @@
   int lacing,nbLaces,entryFlags=0;
   //
   uint64_t tail=parser->tell()+len;
-  // Read Track id 
+  // Read Track id
   uint32_t tid=parser->readEBMCode();
   int track=searchTrackFromTid(tid);
-  
+
       //printf("Wanted %u got %u\n",_tracks[0].streamIndex,tid);
       if(track==-1) //dont care track
       {
-        
+
         parser->seek(tail);
         return 1; // we do only video here...
       }
       // Skip timecode
-      int16_t timecode=parser->readSignedInt(2); 
+      int16_t timecode=parser->readSignedInt(2);
       //if(!track) printf("TC: %d\n",timecode);
       uint8_t flags=parser->readu8();
       uint32_t remaining=tail-parser->tell();
@@ -153,12 +153,13 @@
       {
         case 0: // No lacing
               if(!track) // Video
-              {    
+              {
                   addIndexEntry(track,parser->tell(),remaining,entryFlags,clusterTimeCodeMs+timecode);
               }
               else
               {
-                _tracks[track]._sizeInBytes+=remaining; // keep some stat, useful for audio 
+                _tracks[track]._sizeInBytes+=remaining; // keep some stat, useful for audio
+                _tracks[track].nbPackets++;
               }
               break;
         case 2 : // Constant size lacing
@@ -166,14 +167,14 @@
                     nbLaces=parser->readu8()+1;
                     remaining--;
                     // Only mp3/Ac3 supported, ignore lacing FIXME : Vorbis or AAC will not work
-                    
-                    
+
+
                     int bsize=remaining/nbLaces;
                     if(bsize*nbLaces!=remaining)
                     {
                       printf("Warning not multiple bsize=%d total=%u  nbLaces=%u\n",bsize,remaining,nbLaces);
                     }
-                    if(!track) 
+                    if(!track)
                     {
                       addIndexEntry(track,parser->tell(),remaining,0,clusterTimeCodeMs+timecode);
                       printf("Warning lacing on video track\n");
@@ -181,6 +182,7 @@
                     else
                     {
                        _tracks[track]._sizeInBytes+=remaining;
+                       _tracks[track].nbPackets++;
                     }
                     //printf("tid:%u track %u Remaining : %llu laces %u blksize %d er%d\n",tid,track,remaining,nbLaces,remaining/nbLaces,remaining-(remaining/nbLaces)*nbLaces);
             }
@@ -188,7 +190,7 @@
 #if 1
         case 3: // Ebml lacing
           {
-                                
+
                                 int nbLaces=parser->readu8();
                                 for(int i=1;i<nbLaces;i++)
                                 {
@@ -197,13 +199,14 @@
                                 ADM_assert(track); // Not video!
                                 if(parser->tell()>=tail)
                                 {
-                                  printf("[MKVINDEXER]OOps overflow for EBML(track %u tid%u) at 0x%llx\n",track,tid,parser->tell()); 
+                                  printf("[MKVINDEXER]OOps overflow for EBML(track %u tid%u) at 0x%llx\n",track,tid,parser->tell());
                                   break;
                                 }else
                                 {
                                     _tracks[track]._sizeInBytes+=tail-parser->tell();
+                                    _tracks[track].nbPackets++;
                                 }
-                                
+
                               }
             break;
 #endif
@@ -217,16 +220,17 @@
                                 }
                                 if(parser->tell()>=tail)
                                 {
-                                  printf("[MKVINDEXER]OOps overflow for XIPH(track %u tid%u) at 0x%llx\n",track,tid,parser->tell()); 
+                                  printf("[MKVINDEXER]OOps overflow for XIPH(track %u tid%u) at 0x%llx\n",track,tid,parser->tell());
                                   break;
                                 }
                                 ADM_assert(track); // Not video!
                                 _tracks[track]._sizeInBytes+=(tail-parser->tell());
+                                _tracks[track].nbPackets++;
                                 //printf("This round %lld total:%lld\n",tail-parser->tell(),    _tracks[track]._sizeInBytes);
                                 break;
-          
+
         }
-        default: 
+        default:
             printf("unsupported lacing Track:%d (%d)\n",track,lacing);
             break;
       }
@@ -246,21 +250,21 @@
   // Need to grow index ?
   if(Track->_nbIndex==Track->_indexMax-1)
   {
-    // Realloc 
+    // Realloc
     mkvIndex *dx=new mkvIndex[Track->_indexMax*2];
     memcpy(dx, Track->_index,sizeof(mkvIndex)*Track->_nbIndex);
     Track->_indexMax*=2;
     delete [] Track->_index;
     Track->_index=dx;
   }
-  
+
   mkvIndex *index=Track->_index;
   int x=Track->_nbIndex;
   index[x].pos=where;
   index[x].size=size;
   index[x].flags=AVI_KEY_FRAME;
   index[x].timeCode=0;
-  
+
   float f=timecodeMS;
   uint32_t delta;
   f*=_videostream.dwRate;
@@ -270,14 +274,14 @@
   //printf("Frame :%u rawTimeCode:%u convertedtoframe:%u \n",Track->_nbIndex,timecodeMS,delta);
   if(delta+2<Track->_nbIndex)
   {
-    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u, raw value %u,dwrate=%u)\n",Track->_nbIndex,delta,timecodeMS,_videostream.dwRate); 
+    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u, raw value %u,dwrate=%u)\n",Track->_nbIndex,delta,timecodeMS,_videostream.dwRate);
     index[x].timeCode=0;
   }else
   {
     index[x].timeCode=delta+1-Track->_nbIndex;
   }
   Track->_nbIndex++;
-  
+
  // printf("++\n");
   return 1;
 }
@@ -310,9 +314,9 @@
   const char *ss;
   uint64_t time;
   uint64_t segmentPos;
-  
+
    parser->seek(0);
-   
+
    if(!parser->simplefind(MKV_SEGMENT,&vlen,1))
    {
      printf("[MKV] Cannot find CLUSTER atom\n");
@@ -320,7 +324,7 @@
    }
    ADM_ebml_file segment(parser,vlen);
    segmentPos=segment.tell();
-   
+
    while(segment.simplefind(MKV_CUES,&alen,0))
   {
    ADM_ebml_file cues(&segment,alen);
@@ -335,7 +339,7 @@
       }
       if(id!=MKV_CUE_POINT)
       {
-        printf("Found %s in CUES, ignored \n",ss); 
+        printf("Found %s in CUES, ignored \n",ss);
         cues.skip(len);
         continue;
       }
@@ -350,8 +354,8 @@
           continue;
        }
        time=cue.readUnsignedInt(len);
-       
-       
+
+
        cue.readElemId(&id,&len);
        if(id!=MKV_CUE_TRACK_POSITION)
        {
@@ -370,7 +374,7 @@
          {
            case MKV_CUE_TRACK: tid=trackPos.readUnsignedInt(len);break;
            case MKV_CUE_CLUSTER_POSITION: cluster_position=trackPos.readUnsignedInt(len);break;
-           default: 
+           default:
                  ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type);
                  printf("[MKV] in cluster position found tag %s (0x%x)\n",ss,id);
                  trackPos.skip(len);
@@ -382,7 +386,7 @@
      }
    }
    printf("[MKV] Cues updated\n");
-   return 1;  
+   return 1;
 }
 /**
         \fn indexClusters
@@ -403,7 +407,7 @@
   _clusters=new mkvIndex[NB_DEFAULT_CLUSTERS];
   _clustersCeil=NB_DEFAULT_CLUSTERS;
   _nbClusters=0;
-  
+
   // Search segment
    fileSize=parser->getFileSize();
    if(!parser->simplefind(MKV_SEGMENT,&vlen,1))
@@ -413,9 +417,9 @@
    }
    ADM_ebml_file segment(parser,vlen);
    DIA_working *work=new DIA_working("Matroska clusters");
-   while(segment.simplefind(MKV_CLUSTER,&alen,0)) 
+   while(segment.simplefind(MKV_CLUSTER,&alen,0))
    {
-     
+
      // UI update
      work->update(segment.tell()>>10,fileSize>>10);
      // Grow clusters index if needed
@@ -429,8 +433,8 @@
      }
      _clusters[_nbClusters].pos=segment.tell();
      _clusters[_nbClusters].size=alen;
-     
-     // Normally the timecode is the 1st one following 
+
+     // Normally the timecode is the 1st one following
        segment.readElemId(&id,&len);
        int seekme=_nbClusters;
        if(id!=MKV_TIMECODE)
@@ -438,7 +442,7 @@
           ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type);
           printf("[MKV] Cluster : no time code Found %s(0x%x), expected MKV_TIMECODE  (0x%x)\n",
                   ss,id,MKV_TIMECODE);
-       } 
+       }
        else
        {
            uint64_t timecode=segment.readUnsignedInt(len);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -33,14 +33,14 @@
 
 /**
     \fn ~mkvAudio
-    
+
 */
  mkvAudio ::~mkvAudio()
 {
   if(_clusterParser)  delete _clusterParser;
   _clusterParser=NULL;
     if(_parser) delete _parser;
-  _parser=NULL; 
+  _parser=NULL;
 
 }
 
@@ -65,7 +65,7 @@
 uint8_t             mkvAudio::extraData(uint32_t *l,uint8_t **d)
 {
   *l=_track->extraDataLen;
-  *d=_track->extraData; 
+  *d=_track->extraData;
 }
 /**
     \fn getPacket
@@ -89,10 +89,25 @@
       _clusterParser->readBin(dest,_Laces[_currentLace]);
       *packlen= _Laces[_currentLace];
       vprintf("Continuing lacing : %u bytes, lacing %u/%u\n",*packlen,_currentLace,_maxLace);
+
+      if(_currentLace==_maxLace-1)
+      {
+          float f;
+          f=_frameDurationInSample;
+          f/=_maxLace;
+          uint32_t total=(uint32_t)floor(f);
+          total*=(_maxLace-1);
+          *samples=_frameDurationInSample-total;
+          ADM_assert(_frameDurationInSample>=total);
+      }else
+      {
+          float f;
+          f=_frameDurationInSample;
+          f/=_maxLace;
+          *samples=(uint32_t )floor(f);
+      }
+      *timecode=_curTimeCode;
       _currentLace++;
-      *samples=_frameDurationInSample;
-      *timecode=_curTimeCode;
-      
       return 1;
     }
     while(1)
@@ -104,14 +119,14 @@
           if(!goToCluster(_currentCluster+1))
           {
             printf("[MKVAUDIO] cannot go to next cluster\n");
-            return 0; 
+            return 0;
           }
           _currentCluster++;
         }
         // Ok read a new block
         while(!_clusterParser->finished())
         {
-          
+
             _clusterParser->readElemId(&id,&len);
             pos=_clusterParser->tell();
             if(!ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type))
@@ -120,23 +135,23 @@
               _clusterParser->skip(len);
               continue;
             }
-            
+
             vprintf("[MKVAudio]Found tag %x (%s) at 0x%llx len %u\n",id,ss,_clusterParser->tell(),len);
-            
+
             switch(id)
             {
               default:
               case MKV_TIMECODE:     _clusterParser->skip(len);  break;
               case MKV_BLOCK_GROUP:    break;
-              case MKV_SIMPLE_BLOCK: 
-              case MKV_BLOCK: 
+              case MKV_SIMPLE_BLOCK:
+              case MKV_BLOCK:
               {
                   uint32_t tid=_clusterParser->readEBMCode();
                   uint64_t tail=pos+len;
                   uint64_t head=pos;
-                  
+
                   // FIXME WARNING ASSUME TRACK FITS ON 1 BYTE!
-                  len--; 
+                  len--;
                   vprintf("Tid = %u, my tid=%u\n",tid,_track->streamIndex);
                   if(tid!=_track->streamIndex)
                     {
@@ -155,19 +170,19 @@
                     uint32_t lacing=((flags>>1)&3);
                     switch(lacing)
                     {
-                      case 0 : // no lacing 
-                          
+                      case 0 : // no lacing
+
                               vprintf("No lacing :%d bytes\n",remaining);
                               _clusterParser->readBin(dest,remaining);
-                              *packlen=remaining; 
+                              *packlen=remaining;
                               *samples=_frameDurationInSample;
                               _currentLace=_maxLace=0;
-                              
+
                               return 1;
                       case 1: //Xiph lacing
                         {
                                 int nbLaces=_clusterParser->readu8()+1;
-                                
+
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
@@ -178,40 +193,40 @@
                                   _Laces[i]=lce;
                                 }
                                 int64_t d=_clusterParser->tell();
-                                
+
                                 d=tail-d;
                                 /* We have the remaining size after laces, substract the already known lace size */
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
-                                  d-=_Laces[i]; 
+                                  d-=_Laces[i];
                                 }
                                 // What is left is the sift of the last lace
                                 if(d>0)
-                                  _Laces[nbLaces-1]=(uint32_t)d; 
+                                  _Laces[nbLaces-1]=(uint32_t)d;
                                 else
                                 {
                                   printf("[MKVAUDIO] OOps overflow on Xiph\n");
-                                  nbLaces--; 
+                                  nbLaces--;
                                 }
 
-                                
+
                                 _currentLace=0;
                                 _maxLace=nbLaces;
                                 return getPacket(dest, packlen, samples);
                               }
-                              
+
                               break;
                       case 2 : // constant size lacing
                               {
                                 int nbLaces=_clusterParser->readu8()+1;
-                                
+
                                 remaining--;
                                 int bsize=remaining/nbLaces;
                                 vprintf("NbLaces :%u lacesize:%u\n",nbLaces,bsize);
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=0;i<nbLaces;i++)
                                 {
-                                  _Laces[i]=bsize; 
+                                  _Laces[i]=bsize;
                                 }
                                 _currentLace=0;
                                 _maxLace=nbLaces;
@@ -220,13 +235,13 @@
                               break;
                       case 3: // Ebml lacing
                         {
-                                
+
                                 int nbLaces=_clusterParser->readu8()+1;
                                 int32_t curSize=_clusterParser->readEBMCode();
                                 int32_t delta;
-                                
+
                                 vprintf("Ebml nbLaces :%u lacesize(0):%u\n",nbLaces,curSize);
-                                
+
                                 _Laces[0]=curSize;
                                 ADM_assert(nbLaces<MKV_MAX_LACES);
                                 for(int i=1;i<nbLaces-1;i++)
@@ -235,24 +250,24 @@
                                   vprintf("Ebml delta :%d lacesize[%d]->:%d\n",delta,i,curSize+delta);
                                   curSize+=delta;
                                   ADM_assert(curSize>0);
-                                  _Laces[i]=curSize; 
-                                 
+                                  _Laces[i]=curSize;
+
                                 }
                                 int64_t d=_clusterParser->tell();
-                                
+
                                 d=tail-d;
                                 /* We have the remaining size after laces, substract the already known lace size */
                                 for(int i=0;i<nbLaces-1;i++)
                                 {
-                                  d-=_Laces[i]; 
+                                  d-=_Laces[i];
                                 }
                                 // What is left is the sift of the last lace
                                 if(d>0)
-                                  _Laces[nbLaces-1]=(uint32_t)d; 
+                                  _Laces[nbLaces-1]=(uint32_t)d;
                                 else
                                 {
                                   printf("[MKVAUDIO] OOps overflow on ebml\n");
-                                  nbLaces--; 
+                                  nbLaces--;
                                 }
                                 _currentLace=0;
                                 _maxLace=nbLaces;
@@ -263,7 +278,7 @@
                             printf("Unsupported lacing %u\n",lacing);
                             _clusterParser->seek(pos+len);
                     }
-                
+
               }
               break;
             }
@@ -272,33 +287,35 @@
   return 0;
 }
 /**
-      \fn mkvAudio 
+      \fn mkvAudio
 */
- mkvAudio::mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters) 
+ mkvAudio::mkvAudio(const char *name,mkvTrak *track,mkvIndex *clust,uint32_t nbClusters)
   : AVDMGenericAudioStream()
 {
   _nbClusters=nbClusters;
   _clusters=clust;
   ADM_assert(_clusters);
   _destroyable = 1;
-  
+
    _parser=new ADM_ebml_file();
    ADM_assert(_parser->open(name));
-  _track=track; 
+  _track=track;
   ADM_assert(_track);
-  
-  
+
+
   // Compute total length in byte
   _length=_track->_sizeInBytes; // FIXME
-  
+
   float f=_track->wavHeader.frequency;
   f*=_track->_defaultFrameDuration;
   f=f/1000000.;
-  
+
   _frameDurationInSample=(uint32_t)floor(f+0.5);
-  
+
   _wavheader=new WAVHeader;
   memcpy(_wavheader,&(_track->wavHeader),sizeof(WAVHeader));
+  printf("[MKVAUDIO] found %lu packets\n",track->nbPackets);
+  printf("[MKVAUDIO] Default duration %u us\n",_track->_defaultFrameDuration);
   printf("[MKVAUDIO] found %lu bytes, %u samples per frame\n",_length,_frameDurationInSample);
   _currentLace=_maxLace=0;
   _clusterParser=NULL;
@@ -328,20 +345,21 @@
 uint8_t mkvAudio::goToCluster(uint32_t x)
 {
   ADM_assert(_nbClusters);
-  
+
   if(x>=_nbClusters)
   {
-    printf("Exceeding max cluster : asked: %u max :%u\n",x,_nbClusters); 
+    printf("Exceeding max cluster : asked: %u max :%u\n",x,_nbClusters);
     return 0;  // FIXME
   }
-  
+
   if( _clusterParser) delete _clusterParser;
   _clusterParser=NULL;
-  
+
   //************/
   _parser->seek(_clusters[x].pos);
   _clusterParser=new ADM_ebml_file(_parser,_clusters[x].size);
   _currentLace=_maxLace=0;
+
   printf("switching to cluster :%u/%u\n",x,_nbClusters);
   return 1;
 }
@@ -360,16 +378,16 @@
               if(target>=_clusters[i].timeCode && target<_clusters[i+1].timeCode)
               {
                 clus=i;
-                i=_nbClusters; 
+                i=_nbClusters;
               }
             }
             if(clus==-1) clus=_nbClusters-1; // Hopefully in the last one
-            
+
             target-=_clusters[clus].timeCode; // now the time is relative
             goToCluster(clus);
             _currentCluster=clus;
             _curTimeCode=_clusters[clus].timeCode;
-            
+
             printf("[MKVAUDIO] Asked for %u ms, go to cluster %u which starts at %u\n",mstime,clus,_curTimeCode);
             if(clus<_nbClusters-1)
               printf("[MKVAUDIO] next cluster starts at %u\n",_clusters[clus+1].timeCode);
@@ -383,9 +401,9 @@
             {
               uint32_t curTime=_clusters[_currentCluster].timeCode;
               vprintf("Wanted: %u clus : %u Timecode:%u=> %u\n",mstime,curTime,timecode,timecode+curTime);
-              ADM_assert(len<MAX_SEEK_BUFFER); 
-              
-              if(timecode+curTime>=mstime) 
+              ADM_assert(len<MAX_SEEK_BUFFER);
+
+              if(timecode+curTime>=mstime)
               {
                 printf("[MKV audio] fine seek to %u (clu)+%u=%u\n",curTime,timecode,timecode+curTime);
                 return 1;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -82,7 +82,7 @@
 #if defined( ADM_BIG_ENDIAN)
     if (*inb == (uint32_t) mmioFOURCC(*(cc+3), *(cc + 2), *(cc + 1), *(cc + 0)))
 #else
-    if (*inb == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))	
+    if (*inb == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))
 #endif
       {
 	  return 1;
@@ -102,7 +102,7 @@
     return inb;
 }
 
-int fourCC::check(uint8_t * cc, uint32_t in)
+int fourCC::check(const uint8_t * cc, uint32_t in)
 {
 
     if (in == (uint32_t) mmioFOURCC(*cc, *(cc + 1), *(cc + 2), *(cc + 3)))
@@ -113,7 +113,7 @@
     return 0;
 }
 
-int fourCC::check(uint32_t in, uint8_t * cc)
+int fourCC::check(uint32_t in, const uint8_t * cc)
 {
     return check(cc, in);
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.h	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/fourcc.h	2008-06-08 07:16:45 UTC (rev 4089)
@@ -20,14 +20,14 @@
 class fourCC
 {
 public:
-  static int  			check(uint8_t *,uint8_t *);
+    static int  		    check(uint8_t *,uint8_t *);
 	static void 			print(uint32_t four);
 	static void 			printBE(uint32_t four);
-	static int  			check(uint32_t in,uint8_t *cc);
-	static int  			check(uint8_t *cc,uint32_t in);
-	static  uint32_t 	get(uint8_t *in)   ;
-	static char 		  *tostring(uint32_t fourcc);
-        static char               *tostringBE(uint32_t fourcc);
+	static int  			check(uint32_t in,const uint8_t *cc);
+	static int  			check(const uint8_t *cc,uint32_t in);
+	static  uint32_t 	    get(uint8_t *in)   ;
+	static char 		    *tostring(uint32_t fourcc);
+    static char            *tostringBE(uint32_t fourcc);
 
 };
 void mixDump(uint8_t *ptr, uint32_t len);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -62,6 +62,9 @@
 
 static uint8_t ADM_4cc_to_lavcodec(const char *fcc, CodecID *outlavid);
 static uint8_t ADM_WaveTag_to_lavcodec(uint32_t tag, CodecID *outlavid);
+
+extern uint8_t isVP6Compatible (uint32_t fourcc);
+
 // convert in in us to out in 90Khz tick
 int64_t adm_90k( double in)
 {
@@ -174,14 +177,14 @@
 					 	 c->codec->name=ADM_strdup("FLV1");
 					 }else
 					 {
-						 if(fourCC::check(info->fcc,(uint8_t *)"VP6F"))
+					         if(isVP6Compatible(info->fcc))
 						 			{
 							 		 c->codec_id=CODEC_ID_VP6F;
 					 				 c->codec->name=ADM_strdup("VP6F");
 						 			}
 						 else
 							 ADM_assert(0);
-					 
+ 
 					 }
 					 
 					 break;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-08 07:16:45 UTC (rev 4089)
@@ -65,6 +65,7 @@
 extern AVDMGenericAudioStream 	*currentaudiostream;;
 
 static 				uint8_t *_buffer=NULL,*_outbuffer=NULL;
+extern uint8_t isVP6Compatible (uint32_t fourcc);
 
 /*
  * 		\fn    Oplug_flv
@@ -129,15 +130,10 @@
 
            info.fcc=*(uint32_t *)_encode->getCodecName(); //FIXME
            //
-           const char *supportedVideo[3]={"FLV1","VP6F","VP6 "};
            int supported=0;
-           for(int i=0;i<3;i++)
-           {
-        	   if(fourCC::check(info.fcc,(uint8_t *)supportedVideo[i]))
-        	   {
-        		   	supported=1;
-        	   }
-           }
+           if(isVP6Compatible(info.fcc)) supported=1;
+           if(fourCC::check(info.fcc,(const uint8_t *)"FLV1")) supported=1;
+
            if(!supported)
            {
         	   GUI_Error_HIG(QT_TR_NOOP("Unsupported video"),QT_TR_NOOP("Only FLV1 and VP6 video are supported"));

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt	2008-06-07 20:32:22 UTC (rev 4088)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt	2008-06-08 07:16:45 UTC (rev 4089)
@@ -8,8 +8,7 @@
 
         ADD_LIBRARY(ADM_vf_ssa SHARED ${ADM_vf_ssa_SRCS})
         TARGET_LINK_LIBRARIES(ADM_vf_ssa ADM_libass)
-        ADD_TARGET_LDFLAGS(ADM_vf_ssa  "${FONTCONFIG_LDFLAGS}")
-        ADD_TARGET_LDFLAGS(ADM_vf_ssa  "${FREETYPE2_LDFLAGS}")
+        ADD_TARGET_LDFLAGS(ADM_vf_ssa  "${FONTCONFIG_LDFLAGS} ${FREETYPE2_LDFLAGS}")
         INIT_VIDEOFILTER_PLUGIN(ADM_vf_ssa)
         INSTALL_VIDEOFILTER(ADM_vf_ssa)
 ENDIF(USE_FREETYPE)



From mean at mail.berlios.de  Sun Jun  8 20:01:10 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jun 2008 20:01:10 +0200
Subject: [Avidemux-svn-commit] r4090 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200806081801.m58I1A6E029094@sheep.berlios.de>

Author: mean
Date: 2008-06-08 20:01:09 +0200 (Sun, 08 Jun 2008)
New Revision: 4090

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp
Log:
[GTK] Fedora jog fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp	2008-06-08 07:16:45 UTC (rev 4089)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp	2008-06-08 18:01:09 UTC (rev 4090)
@@ -41,6 +41,9 @@
 #include "config.h"
 
 #ifdef USE_JOG
+#include <stdlib.h>
+#include <sys/time.h>
+#include <string.h>
 #include <string>
 using std::string;
 #include <iostream>



From mean at mail.berlios.de  Sun Jun  8 20:03:18 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jun 2008 20:03:18 +0200
Subject: [Avidemux-svn-commit] r4091 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200806081803.m58I3IFc030336@sheep.berlios.de>

Author: mean
Date: 2008-06-08 20:03:18 +0200 (Sun, 08 Jun 2008)
New Revision: 4091

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp
Log:
[Fedora] Jog fix


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp	2008-06-08 18:01:09 UTC (rev 4090)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_jogshuttle.cpp	2008-06-08 18:03:18 UTC (rev 4091)
@@ -41,6 +41,9 @@
 #include "config.h"
 
 #ifdef USE_JOG
+#include <stdlib.h>
+#include <sys/time.h>
+#include <string.h>
 #include <string>
 using std::string;
 #include <iostream>



From gruntster at mail.berlios.de  Tue Jun 10 21:09:35 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 10 Jun 2008 21:09:35 +0200
Subject: [Avidemux-svn-commit] r4092 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200806101909.m5AJ9Zvd023599@sheep.berlios.de>

Author: gruntster
Date: 2008-06-10 21:08:52 +0200 (Tue, 10 Jun 2008)
New Revision: 4092

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/FindThreads.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
Log:
[CMake] pthread tweak

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-06-08 18:03:18 UTC (rev 4091)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
@@ -329,6 +329,11 @@
 	ENDIF (ADM_UI_GTK)
 ENDIF (GETTEXT_FOUND)
 
+# pthreads
+IF (UNIX AND PTHREAD_FOUND)
+	ADD_LIB_ALL_TARGETS("${PTHREAD_LIBRARIES}")
+ENDIF (UNIX AND PTHREAD_FOUND)
+
 # PNG
 IF (USE_PNG)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${PNG_LIBRARIES})

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindThreads.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindThreads.cmake	2008-06-08 18:03:18 UTC (rev 4091)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindThreads.cmake	2008-06-10 19:08:52 UTC (rev 4092)
@@ -25,10 +25,6 @@
 
 	IF (NOT PTHREAD_LIBRARIES AND WIN32)
 		FIND_LIBRARY(PTHREAD_LIBRARIES "pthreadGC2")
-		
-		IF (NOT PTHREAD_LIBRARIES)
-			FIND_LIBRARY(PTHREAD_LIBRARIES "pthreadVC2")
-		ENDIF (NOT PTHREAD_LIBRARIES)
 	ENDIF (NOT PTHREAD_LIBRARIES AND WIN32)
 
 	IF (NOT PTHREAD_LIBRARIES)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2008-06-08 18:03:18 UTC (rev 4091)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2008-06-10 19:08:52 UTC (rev 4092)
@@ -51,12 +51,10 @@
 ########################################
 # pthreads
 ########################################
-IF (WIN32)
-	MESSAGE(STATUS "Checking for pthreads")
-	MESSAGE(STATUS "*********************")
+MESSAGE(STATUS "Checking for pthreads")
+MESSAGE(STATUS "*********************")
 
-	FIND_PACKAGE(Threads)
-	PRINT_LIBRARY_INFO("pthreads" PTHREAD_FOUND "${PTHREAD_INCLUDE_DIR}" "${PTHREAD_LIBRARIES}" FATAL_ERROR)
+FIND_PACKAGE(Threads)
+PRINT_LIBRARY_INFO("pthreads" PTHREAD_FOUND "${PTHREAD_INCLUDE_DIR}" "${PTHREAD_LIBRARIES}" FATAL_ERROR)
 
-	MESSAGE("")
-ENDIF (WIN32)
\ No newline at end of file
+MESSAGE("")
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2008-06-08 18:03:18 UTC (rev 4091)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2008-06-10 19:08:52 UTC (rev 4092)
@@ -97,6 +97,10 @@
 		MESSAGE(STATUS "Found ${_function} in ${_lib}")
 	ELSE (${_varToSet})
 		MESSAGE(STATUS "Could not find ${_function} in ${_lib}")
+		
+		IF (VERBOSE)
+			MESSAGE(${OUTPUT})
+		ENDIF (VERBOSE)
 	ENDIF (${_varToSet})	
 ENDMACRO (ADM_CHECK_FUNCTION_EXISTS)
 
@@ -139,13 +143,11 @@
 		SET(${_flags} "${${_flags}} ${_flag}")
 	ENDFOREACH (_flag ${ARGN})
 
-	STRING(SUBSTRING "${${_flags}}" 0 1 firstChar)
-
-	IF (${firstChar} STREQUAL " ")
+	IF (${firstChar} AND ${firstChar} STREQUAL " ")
 		STRING(LENGTH "${${_flags}}" stringLength)
 		MATH(EXPR stringLength "${stringLength} - 1")
 		STRING(SUBSTRING "${${_flags}}" 1 ${stringLength} ${_flags})
-	ENDIF (${firstChar} STREQUAL " ")
+	ENDIF (${firstChar} AND ${firstChar} STREQUAL " ")
 ENDMACRO (APPEND_FLAGS)
 
 



From gruntster at mail.berlios.de  Wed Jun 11 02:33:36 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 11 Jun 2008 02:33:36 +0200
Subject: [Avidemux-svn-commit] r4093 - in
	branches/avidemux_2.5_branch_gruntster: .
	avidemux/ADM_UIs/ADM_CLI/src avidemux/ADM_UIs/ADM_GTK/src
	avidemux/ADM_UIs/ADM_QT4/src avidemux/ADM_core/src
	avidemux/ADM_coreImage/src avidemux/ADM_coreUI/src
	avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavcodec
	avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavformat
	avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavutil
	avidemux/ADM_libraries/ADM_ffmpeg/ADM_libpostproc
	avidemux/ADM_libraries/ADM_ffmpeg/ADM_libswscale
	avidemux/ADM_libraries/ADM_smjs
	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_render cmake plugins
	plugins/ADM_videoFilters/Ass plugins/ADM_videoFilters/Ass/ADM_libass
	plugins/ADM_videoFilters/ForcedPP plugins/ADM_videoFilters/Srt
	plugins/ADM_videoFilters/lavDeinterlace
Message-ID: <200806110033.m5B0XaCF015167@sheep.berlios.de>

Author: gruntster
Date: 2008-06-11 02:33:07 +0200 (Wed, 11 Jun 2008)
New Revision: 4093

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckFontConfig.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavformat/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavutil/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libpostproc/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libswscale/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_libass/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
Log:
[CMake] fixes for Win32

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,5 +1,3 @@
-
-PROJECT("Avidemux_2.5")
 MESSAGE("#####################################")
 MESSAGE("Configure Started")
 MESSAGE("#####################################")
@@ -7,9 +5,6 @@
 
 CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
 
-#need for shared cmake script between avidemux & plugins
-SET(AVIDEMUX_SOURCE_DIR ${CMAKE_SOURCE_DIR})
-MESSAGE(STATUS "Source dir is ${AVIDEMUX_SOURCE_DIR}")
 if (COMMAND cmake_policy)
 	cmake_policy(VERSION 2.4)
 	cmake_policy(SET CMP0003 NEW)
@@ -21,7 +16,13 @@
 	SET(FRESH_BUILD 1)
 ENDIF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES "^${CMAKE_CXX_COMPILER_WORKS}$")
 
+# need for shared cmake script between avidemux & plugins
+SET(AVIDEMUX_SOURCE_DIR ${CMAKE_SOURCE_DIR})
+MESSAGE(STATUS "Source dir is ${AVIDEMUX_SOURCE_DIR}")
+MESSAGE("")
 
+PROJECT(Avidemux)
+
 IF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
 	MESSAGE("Please do an out-of-tree build:")
 	MESSAGE("rm CMakeCache.txt; mkdir build; cd build; cmake ..; make")

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,11 +1,12 @@
 SET(ADM_LIB ADM_UICli)
 
 SET(${ADM_LIB}_SRCS 
-	DIA_dialogFactory.cpp  
-        FAC_toggle.cpp
-        DIA_flyDialogCli.cpp
+	DIA_dialogFactory.cpp
+	FAC_toggle.cpp
+	DIA_flyDialogCli.cpp
+	DIA_none.cpp
 )
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../include)
 ADD_LIBRARY(${ADM_LIB}  SHARED ${${ADM_LIB}_SRCS})
 ADD_SOURCE_CFLAGS(DIA_flyDialogCli.cpp " -DADM_UI_TYPE_BUILD=1")
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/DIA_none.cpp	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/DIA_none.cpp	2008-06-11 00:33:07 UTC (rev 4093)
@@ -0,0 +1,3 @@
+#include "ADM_inttype.h"
+
+int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -29,4 +29,4 @@
 TARGET_LINK_LIBRARIES(${ADM_LIB} ${GTK_LDFLAGS} ADM_core ADM_coreUI ADM_render_gtk)
 ADD_TARGET_CFLAGS(${ADM_LIB} ${GTK_CFLAGS})
 ADD_SOURCE_CFLAGS(DIA_flyDialogGtk.cpp " -DADM_UI_TYPE_BUILD=2")
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -13,7 +13,7 @@
 SET(${ADM_LIB}_SRCS
 	FAC_bar.cpp    FAC_frame.cpp  FAC_integer.cpp  FAC_notch.cpp
 	FAC_float.cpp  FAC_hex.cpp    FAC_readOnlyText.cpp
-	FAC_matrix.cpp  ${${ADM_LIB}_source}  ${${ADM_LIB}_T})
+	FAC_matrix.cpp  DIA_none.cpp  ${${ADM_LIB}_source}  ${${ADM_LIB}_T})
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${QT_INCLUDE_DIR})
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../include)
@@ -21,4 +21,4 @@
 ADD_SOURCE_CFLAGS(T_flyDialogQt4.cpp " -DADM_UI_TYPE_BUILD=4")
 ADD_SOURCE_CFLAGS(T_QCanvas.cpp " -DADM_UI_TYPE_BUILD=4")
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_coreUI ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY} ADM_render_qt4)
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/DIA_none.cpp	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/DIA_none.cpp	2008-06-11 00:33:07 UTC (rev 4093)
@@ -0,0 +1,3 @@
+#include "ADM_inttype.h"
+
+int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -14,4 +14,4 @@
 
 REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)
 
-INSTALL(TARGETS ADM_core RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
\ No newline at end of file
+INSTALL(TARGETS ADM_core RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -26,4 +26,4 @@
 ENDIF (APPLE)
 
 TARGET_LINK_LIBRARIES(ADM_coreImage ADM_core ADM_coreUI ADM_libswscale ADM_libpostproc)
-INSTALL(TARGETS ADM_coreImage RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ADM_coreImage RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -7,4 +7,4 @@
 ADD_LIBRARY(ADM_coreUI SHARED ${ADM_coreUI_SRCS})
 TARGET_LINK_LIBRARIES(ADM_coreUI ADM_core)
 
-INSTALL(TARGETS ADM_coreUI RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ADM_coreUI RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavcodec/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavcodec/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -48,4 +48,4 @@
 
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_libavutil ${ZLIB_LIBRARY})
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavformat/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavformat/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavformat/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -9,4 +9,4 @@
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_libavutil ADM_libavcodec)
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavutil/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavutil/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_lavutil/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -25,4 +25,4 @@
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core)
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libpostproc/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libpostproc/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libpostproc/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -10,4 +10,4 @@
 
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_libavutil)
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libswscale/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libswscale/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_ffmpeg/ADM_libswscale/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -13,4 +13,4 @@
 
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_libavutil)
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -21,4 +21,4 @@
 
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core)
 
-INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
\ No newline at end of file
+INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-06-11 00:33:07 UTC (rev 4093)
@@ -87,7 +87,6 @@
 uint8_t DIA_audioCodec( AUDIOENCODER *codec ) {return 0;}
 uint8_t DIA_dnr(uint32_t *llock,uint32_t *lthresh, uint32_t *clock,
 			uint32_t *cthresh, uint32_t *scene) {return 0;}
-int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}			
 uint8_t DIA_glyphEdit(void) {return 0;}
 struct THRESHOLD_PARAM;
 struct ADMVideoThreshold;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-11 00:33:07 UTC (rev 4093)
@@ -39,7 +39,6 @@
 void    DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate ){}
 uint8_t initGUI( void ) {return 1;}
 void destroyGUI(void) {}
-int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}
 uint8_t DIA_glyphEdit(void){ return 0;};
 int32_t UI_readJog(void) {return 0;}
 struct THRESHOLD_PARAM;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,41 +1,41 @@
-SET(ADM_LIB ADM_render)
-
-SET(${ADM_LIB}_SRCS
-GUI_render.cpp
-GUI_sdlRender.cpp
-GUI_xvRender.cpp
-)
-
-IF (APPLE)
-	SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} GUI_sdlRenderHelper.m)
-ENDIF (APPLE)
-
-ADD_ADM_SHARED_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
-SDLify(GUI_sdlRender.cpp)
-ADM_TARGET_LINK_LIBARIES_ALL_TARGET(${ADM_LIB} ADM_core ADM_coreUI ADM_coreImage)
-
-IF (ADM_UI_GTK)
-	IF (GETTEXT_FOUND)
-		TARGET_LINK_LIBRARIES(${ADM_LIB}_gtk ${GETTEXT_LIBRARY_DIR})
-	ENDIF (GETTEXT_FOUND)
-
+SET(ADM_LIB ADM_render)
+
+SET(${ADM_LIB}_SRCS
+GUI_render.cpp
+GUI_sdlRender.cpp
+GUI_xvRender.cpp
+)
+
+IF (APPLE)
+	SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} GUI_sdlRenderHelper.m)
+ENDIF (APPLE)
+
+ADD_ADM_SHARED_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
+SDLify(GUI_sdlRender.cpp)
+ADM_TARGET_LINK_LIBARIES_ALL_TARGET(${ADM_LIB} ADM_core ADM_coreUI ADM_coreImage)
+
+IF (ADM_UI_GTK)
+	IF (GETTEXT_FOUND)
+		TARGET_LINK_LIBRARIES(${ADM_LIB}_gtk ${GETTEXT_LIBRARY_DIR})
+	ENDIF (GETTEXT_FOUND)
+
 	IF (USE_SDL)
 		TARGET_LINK_LIBRARIES(${ADM_LIB}_gtk ${SDL_LIBRARY})
-	ENDIF (USE_SDL)
-
-	INSTALL(TARGETS ${ADM_LIB}_gtk RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
-ENDIF (ADM_UI_GTK)
-
-IF (ADM_UI_QT4)
+	ENDIF (USE_SDL)
+
+	INSTALL(TARGETS ${ADM_LIB}_gtk RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
+ENDIF (ADM_UI_GTK)
+
+IF (ADM_UI_QT4)
 	IF (USE_SDL)
 		TARGET_LINK_LIBRARIES(${ADM_LIB}_qt4 ${SDL_LIBRARY})
-	ENDIF (USE_SDL)
-
-	INSTALL(TARGETS ${ADM_LIB}_qt4 RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
-ENDIF (ADM_UI_QT4)
-
-IF (GETTEXT_FOUND)
-	TARGET_LINK_LIBRARIES(${ADM_LIB}_cli ${GETTEXT_LIBRARY_DIR})
-ENDIF (GETTEXT_FOUND)
-
-INSTALL(TARGETS ${ADM_LIB}_cli RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
\ No newline at end of file
+	ENDIF (USE_SDL)
+
+	INSTALL(TARGETS ${ADM_LIB}_qt4 RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
+ENDIF (ADM_UI_QT4)
+
+IF (GETTEXT_FOUND)
+	TARGET_LINK_LIBRARIES(${ADM_LIB}_cli ${GETTEXT_LIBRARY_DIR})
+ENDIF (GETTEXT_FOUND)
+
+INSTALL(TARGETS ${ADM_LIB}_cli RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckFontConfig.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckFontConfig.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckFontConfig.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -0,0 +1,24 @@
+MACRO(checkFontConfig)
+	IF (NOT FONTCONFIG_CHECKED)
+		OPTION(FONTCONFIG "" ON)
+
+		MESSAGE(STATUS "Checking for FontConfig")
+		MESSAGE(STATUS "***********************")
+
+		IF (FONTCONFIG)
+			PKG_CHECK_MODULES(FONTCONFIG fontconfig)
+			PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_CFLAGS}" "${FONTCONFIG_LDFLAGS}")
+
+			IF (FONTCONFIG_FOUND)
+				SET(HAVE_FONTCONFIG 1)
+			ENDIF (FONTCONFIG_FOUND)
+		ELSE (FONTCONFIG)
+			MESSAGE("${MSG_DISABLE_OPTION}")
+		ENDIF (FONTCONFIG)
+
+		SET(ENV{ADM_HAVE_FONTCONFIG} ${FONTCONFIG_FOUND})
+		SET(FONTCONFIG_CHECKED 1)
+
+		MESSAGE("")
+	ENDIF (NOT FONTCONFIG_CHECKED)
+ENDMACRO(checkFontConfig)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,27 +1,4 @@
 ########################################
-# FontConfig
-########################################
-#OPTION(FONTCONFIG "" ON)
-
-#MESSAGE(STATUS "Checking for FontConfig")
-#MESSAGE(STATUS "***********************")
-
-#IF (FONTCONFIG)
-	#PKG_CHECK_MODULES(FONTCONFIG fontconfig)
-	#PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_CFLAGS}" "${FONTCONFIG_LDFLAGS}")
-
-	#IF (FONTCONFIG_FOUND)
-		#SET(HAVE_FONTCONFIG 1)
-		#SET(USE_FONTCONFIG 1)
-	#ENDIF (FONTCONFIG_FOUND)
-#ELSE (FONTCONFIG)
-	#MESSAGE("${MSG_DISABLE_OPTION}")
-#ENDIF (FONTCONFIG)
-
-MESSAGE("")
-
-
-########################################
 # gettext
 ########################################
 INCLUDE(admCheckGettext)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -13,10 +13,10 @@
 				FILE(READ ${X264_INCLUDE_DIR}/x264.h X264_H)
 				STRING(REGEX MATCH "#define[ ]+X264_BUILD[ ]+([0-9]+)" X264_H "${X264_H}")
 				STRING(REGEX REPLACE ".*[ ]([0-9]+).*" "\\1" x264_version "${X264_H}")
-				MESSAGE(STATUS "  build version: ${x264_version}")
+				MESSAGE(STATUS "  core version: ${x264_version}")
 				
 				IF (x264_version LESS 54)
-					MESSAGE("WARNING: x264 build version too old.  At least version 54 is required.")
+					MESSAGE("WARNING: x264 core version is too old.  At least version 54 is required.")
 					SET(X264_FOUND 0)
 				ENDIF (x264_version LESS 54)
 			ENDIF (X264_FOUND)
@@ -29,4 +29,4 @@
 
 		MESSAGE("")
 	ENDIF (NOT X264_CHECKED)
-ENDMACRO(checkX264)
\ No newline at end of file
+ENDMACRO(checkX264)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -24,16 +24,12 @@
 ADM_DISPLAY("Qt 4      " "${ADM_UI_QT4}")
 
 MESSAGE("***  Video Codec  ***")
-ADM_DISPLAY("x264      " "$ENV{ADM_HAVE_X264}")
 ADM_DISPLAY("Xvid      " "${USE_XVID_4}")
 
 MESSAGE("***  Audio Codec  ***")
 ADM_DISPLAY("Aften     " "${USE_AFTEN}")
-ADM_DISPLAY("amrnb     " "$ENV{ADM_HAVE_AMRNB}")
 ADM_DISPLAY("LAME      " "${HAVE_LIBMP3LAME}")
 ADM_DISPLAY("FAAC      " "${USE_FAAC}")
-ADM_DISPLAY("FAAD      " "$ENV{ADM_HAVE_FAAD}")
-ADM_DISPLAY("libdca    " "$ENV{ADM_HAVE_LIBDCA}")
 ADM_DISPLAY("Vorbis    " "${USE_VORBIS}")
 
 MESSAGE("*** Audio Device  ***")
@@ -44,9 +40,11 @@
 ADM_DISPLAY("OSS       " "${OSS_SUPPORT}" "${OSS_CAPABLE}")
 ADM_DISPLAY("SRC       " "${USE_SRC}" "${JACK_CAPABLE}")
 
+IF (WIN32)
+	ADM_DISPLAY("Win32     " 1)
+ENDIF (WIN32)
+
 MESSAGE("*** Miscellaneous ***")
-ADM_DISPLAY("FontConfig" "${USE_FONTCONFIG}")
-ADM_DISPLAY("FreeType2 " "${FREETYPE2_FOUND}")
 ADM_DISPLAY("gettext   " "${HAVE_GETTEXT}")
 ADM_DISPLAY("SDL       " "${USE_SDL}")
 ADM_DISPLAY("XVideo    " "${USE_XV}" "${XVIDEO_CAPABLE}")

Added: branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -0,0 +1,44 @@
+# ARGV2 - capable flag
+MACRO(ADM_DISPLAY _name)
+	SET(PROCEED 1)
+
+	IF (NOT ${ARGV2})
+		SET(PROCEED 0)
+	ENDIF (NOT ${ARGV2})
+
+	IF (${PROCEED})
+		IF (${ARGV1})
+			SET(s "Yes")
+		ELSE (${ARGV1})
+			SET(s "No")
+		ENDIF (${ARGV1})
+
+		MESSAGE("   ${_name}  ${s}")
+	ENDIF (${PROCEED})
+ENDMACRO(ADM_DISPLAY)
+
+MESSAGE("*********************")
+MESSAGE("***    SUMMARY    ***")
+MESSAGE("*********************")
+MESSAGE("***  Video Codec  ***")
+ADM_DISPLAY("x264      " "$ENV{ADM_HAVE_X264}")
+
+MESSAGE("***  Audio Codec  ***")
+ADM_DISPLAY("amrnb     " "$ENV{ADM_HAVE_AMRNB}")
+ADM_DISPLAY("FAAD      " "$ENV{ADM_HAVE_FAAD}")
+ADM_DISPLAY("libdca    " "$ENV{ADM_HAVE_LIBDCA}")
+
+MESSAGE("*** Miscellaneous ***")
+ADM_DISPLAY("FontConfig" "$ENV{ADM_HAVE_FONTCONFIG}")
+ADM_DISPLAY("FreeType2 " "${FREETYPE2_FOUND}")
+ADM_DISPLAY("gettext   " "${HAVE_GETTEXT}")
+
+MESSAGE("*********************")
+
+IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	MESSAGE("***  Debug Build  ***")
+ELSE (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	MESSAGE("*** Release Build ***")
+ENDIF(CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+MESSAGE("*********************")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,8 +1,8 @@
 MACRO(INIT_VIDEO_ENCODER_PLUGIN _lib)
 	INCLUDE_DIRECTORIES("${CMAKE_BINARY_DIR}/config")
-	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/avidemux/ADM_core/include")
-	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/avidemux/ADM_coreUI/include")
-	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/avidemux/ADM_plugin")
+	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_core/include")
+	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_coreUI/include")
+	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_plugin")
 ENDMACRO(INIT_VIDEO_ENCODER_PLUGIN)
 
 MACRO(INSTALL_VIDEO_ENCODER _lib)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -18,9 +18,6 @@
 #cmakedefine ALSA_SUPPORT
 #endif
 
-/* FontConfig detected */
-#cmakedefine HAVE_FONTCONFIG
-
 #if ${CONFIG_HEADER_TYPE} == ADM_BUILD_CLI || ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK
 /* Define if the GNU gettext() function is already present or preinstalled. */
 #cmakedefine HAVE_GETTEXT
@@ -62,9 +59,6 @@
 /* FFmpeg */
 #define USE_FFMPEG
 
-/* FontConfig detected */
-#cmakedefine USE_FONTCONFIG
-
 /* FreeType2 detected */
 #cmakedefine USE_FREETYPE
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake	2008-06-11 00:33:07 UTC (rev 4093)
@@ -10,7 +10,6 @@
 
 		QT4_WRAP_UI(qt4_ui ${_srcQt_ui}.ui)
 		QT4_WRAP_CPP(qt4_cpp ${_headersQt})
-		#${_srcQt_ui}.h)
 
 		ADD_LIBRARY(${lib} SHARED ${ARGN} ${_srcsQt} ${qt4_cpp} ${qt4_ui})
 		ADD_TARGET_CFLAGS(${lib} "-DADM_UI_TYPE_BUILD=4")

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_libass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_libass/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_libass/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,18 +1,19 @@
+INCLUDE(admCheckFontConfig)
+checkFontConfig()
+
 SET(ADM_LIB ADM_libass)
 
-	SET(${ADM_LIB}_SRCS 
-		ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
-		ass_font.c)
+SET(${ADM_LIB}_SRCS 
+ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
+ass_font.c)
 
-        ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
-	ADD_DEFINITIONS(${FREETYPE2_CFLAGS} "-I${LIBICONV_INCLUDE_DIR}")
+ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+ADD_DEFINITIONS(${FREETYPE2_CFLAGS} "-I${LIBICONV_INCLUDE_DIR}")
 
+IF (FONTCONFIG_FOUND)
+	ADD_DEFINITIONS(${FONTCONFIG_CFLAGS} "-DHAVE_FONTCONFIG=1")
+ENDIF (FONTCONFIG_FOUND)
 
-	IF (USE_FONTCONFIG)
-		ADD_DEFINITIONS(${FONTCONFIG_CFLAGS})
-	ENDIF (USE_FONTCONFIG)
-	
 IF (UNIX)
 	ADD_TARGET_CFLAGS(${ADM_LIB} -fPIC)
-ENDIF (UNIX)
-	
+ENDIF (UNIX)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,14 +1,20 @@
 INCLUDE(admCheckFreeType)
 checkFreeType()
-IF(USE_FREETYPE)
-        ADD_SUBDIRECTORY(ADM_libass)
-        
-        INCLUDE(vf_plugin)
-        SET(ADM_vf_ssa_SRCS ADM_vidASS.cpp)
 
-        ADD_LIBRARY(ADM_vf_ssa SHARED ${ADM_vf_ssa_SRCS})
-        TARGET_LINK_LIBRARIES(ADM_vf_ssa ADM_libass)
-        ADD_TARGET_LDFLAGS(ADM_vf_ssa  "${FONTCONFIG_LDFLAGS} ${FREETYPE2_LDFLAGS}")
-        INIT_VIDEOFILTER_PLUGIN(ADM_vf_ssa)
-        INSTALL_VIDEOFILTER(ADM_vf_ssa)
-ENDIF(USE_FREETYPE)
+IF (USE_FREETYPE)
+	ADD_SUBDIRECTORY(ADM_libass)
+
+	INCLUDE(vf_plugin)
+	SET(ADM_vf_ssa_SRCS ADM_vidASS.cpp)
+
+	ADD_LIBRARY(ADM_vf_ssa SHARED ${ADM_vf_ssa_SRCS})
+	TARGET_LINK_LIBRARIES(ADM_vf_ssa ADM_libass)
+	ADD_TARGET_LDFLAGS(ADM_vf_ssa "${FREETYPE2_LDFLAGS}")
+
+	IF (FONTCONFIG_FOUND)
+		ADD_TARGET_LDFLAGS(ADM_vf_ssa "${FONTCONFIG_LDFLAGS}")
+	ENDIF (FONTCONFIG_FOUND)
+
+	INIT_VIDEOFILTER_PLUGIN(ADM_vf_ssa)
+	INSTALL_VIDEOFILTER(ADM_vf_ssa)
+ENDIF (USE_FREETYPE)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -4,6 +4,7 @@
 SET(ADM_vf_forcedPP_SRCS ADM_vidForcedPP.cpp)
 
 ADD_LIBRARY(ADM_vf_forcedPP SHARED ${ADM_vf_forcedPP_SRCS})
+TARGET_LINK_LIBRARIES(ADM_vf_forcedPP ADM_libpostproc)
 
 INIT_VIDEOFILTER_PLUGIN(ADM_vf_forcedPP)
 INSTALL_VIDEOFILTER(ADM_vf_forcedPP)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,46 +1,38 @@
 INCLUDE(admCheckFreeType)
 checkFreeType()
+
 IF(USE_FREETYPE)
-        INCLUDE(vf_plugin)
+	INCLUDE(vf_plugin)
 
-        SET(srtCommon_SRCS 
-          ADM_vidFont.cpp  ADM_vidSRT.cpp  ADM_vidSRTload.cpp  ADM_vidSRTRender.cpp  DIA_srt.cpp DIA_flySrtPos.cpp
-        )
+	SET(srtCommon_SRCS 
+	  ADM_vidFont.cpp  ADM_vidSRT.cpp  ADM_vidSRTload.cpp  ADM_vidSRTRender.cpp  DIA_srt.cpp DIA_flySrtPos.cpp
+	)
 
-        INCLUDE(vf_plugin_gtk)
-        INCLUDE(vf_plugin_qt4)
+	INCLUDE(vf_plugin_gtk)
+	INCLUDE(vf_plugin_qt4)
 
-        SET(srtGtk_SRCS gtk/DIA_srt.cpp)
-        SET(srtQT_SRCS  qt4/Q_srt.cpp)
-        SET(srtQT_HEADERS  qt4/Q_srt.h)
-        SET(srtQT_UI    qt4/srt)
+	SET(srtGtk_SRCS gtk/DIA_srt.cpp)
+	SET(srtQT_SRCS  qt4/Q_srt.cpp)
+	SET(srtQT_HEADERS  qt4/Q_srt.h)
+	SET(srtQT_UI    qt4/srt)
 
+	INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_sub_qt4 
+					${srtQT_SRCS} ${srtQT_HEADERS} ${srtQT_UI} ${srtCommon_SRCS})
+	INIT_VIDEOFILTER_PLUGIN_GTK(  ADM_vf_sub_gtk 
+					${srtGtk_SRCS} ${srtCommon_SRCS})
 
-INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_sub_qt4 
-                ${srtQT_SRCS} ${srtQT_HEADERS} ${srtQT_UI} ${srtCommon_SRCS})
-INIT_VIDEOFILTER_PLUGIN_GTK(  ADM_vf_sub_gtk 
-                ${srtGtk_SRCS} ${srtCommon_SRCS})
+	ADD_DEFINITIONS(${LIBICONV_DEFINITIONS})
+	ADD_SOURCE_CFLAGS(DIA_srt.cpp           "${FREETYPE2_CFLAGS}" )
+	ADD_SOURCE_CFLAGS(ADM_vidSRT.cpp        "${FREETYPE2_CFLAGS}" )
+	ADD_SOURCE_CFLAGS(ADM_vidFont.cpp       "${FREETYPE2_CFLAGS}" )
+	ADD_SOURCE_CFLAGS(ADM_vidSRTload.cpp    "${FREETYPE2_CFLAGS}   -I${LIBICONV_INCLUDE_DIR} ")
+	ADD_SOURCE_CFLAGS(ADM_vidSRTRender.cpp  "${FREETYPE2_CFLAGS}" )
+	
+	IF (GTK_FOUND AND GTHREAD_FOUND)
+		ADD_TARGET_LDFLAGS(ADM_vf_sub_gtk "${FREETYPE2_LDFLAGS} ${LIBICONV_LIBRARY_DIR}")
+	ENDIF (GTK_FOUND AND GTHREAD_FOUND)
 
-        ADD_DEFINITIONS(${LIBICONV_DEFINITIONS})
-        ADD_SOURCE_CFLAGS(DIA_srt.cpp           "${FREETYPE2_CFLAGS}" )
-        ADD_SOURCE_CFLAGS(ADM_vidSRT.cpp        "${FREETYPE2_CFLAGS}" )
-        ADD_SOURCE_CFLAGS(ADM_vidFont.cpp       "${FREETYPE2_CFLAGS}" )
-        ADD_SOURCE_CFLAGS(ADM_vidSRTload.cpp    "${FREETYPE2_CFLAGS}   -I${LIBICONV_INCLUDE_DIR} ")
-        ADD_SOURCE_CFLAGS(ADM_vidSRTRender.cpp  "${FREETYPE2_CFLAGS}" )
-IF (GTK_FOUND AND GTHREAD_FOUND)
-	ADD_TARGET_LDFLAGS(ADM_vf_sub_gtk           "${FREETYPE2_LDFLAGS} ${LIBICONV_LIBRARY_DIR}")
-        IF (USE_FONTCONFIG)
-	        ADD_TARGET_LDFLAGS(ADM_vf_sub_gtk "${FONTCONFIG_LDFLAGS}")
-        ENDIF (USE_FONTCONFIG)
-ENDIF (GTK_FOUND AND GTHREAD_FOUND)
-
-
-IF (QT4_FOUND)
-	ADD_TARGET_LDFLAGS(ADM_vf_sub_qt4           "${FREETYPE2_LDFLAGS} ${LIBICONV_LIBRARY_DIR}")
-        IF (USE_FONTCONFIG)
-	        ADD_TARGET_LDFLAGS(ADM_vf_sub_qt4 "${FONTCONFIG_LDFLAGS}")
-        ENDIF (USE_FONTCONFIG)
-ENDIF (QT4_FOUND)
-
-ENDIF(USE_FREETYPE)
-
+	IF (QT4_FOUND)
+		ADD_TARGET_LDFLAGS(ADM_vf_sub_qt4 "${FREETYPE2_LDFLAGS} ${LIBICONV_LIBRARY_DIR}")
+	ENDIF (QT4_FOUND)
+ENDIF(USE_FREETYPE)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -4,7 +4,7 @@
 SET(ADM_vf_lavDeinterlace_SRCS ADM_lavpp_deint.cpp)
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/")
 ADD_LIBRARY(ADM_vf_lavDeinterlace SHARED ${ADM_vf_lavDeinterlace_SRCS})
-TARGET_LINK_LIBRARIES(ADM_vf_lavDeinterlace ADM_libswscale)
+TARGET_LINK_LIBRARIES(ADM_vf_lavDeinterlace ADM_libswscale ADM_libpostproc)
 
 INIT_VIDEOFILTER_PLUGIN(ADM_vf_lavDeinterlace)
 INSTALL_VIDEOFILTER(ADM_vf_lavDeinterlace)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2008-06-10 19:08:52 UTC (rev 4092)
+++ branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2008-06-11 00:33:07 UTC (rev 4093)
@@ -1,114 +1,137 @@
-####################################
-#
-#
-#
-#
-####################################
-PROJECT(AdmPlugins)
-
-MESSAGE("#####################################")
-MESSAGE("Plugins Configure Started")
-MESSAGE("#####################################")
-MESSAGE("")
-
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
-
-if (COMMAND cmake_policy)
-	cmake_policy(VERSION 2.4)
-	cmake_policy(SET CMP0003 NEW)
-endif (COMMAND cmake_policy)
-
-SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/../cmake" "${CMAKE_MODULE_PATH}")
-
-IF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES "^${CMAKE_CXX_COMPILER_WORKS}$")
-	SET(FRESH_BUILD 1)
-ENDIF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES "^${CMAKE_CXX_COMPILER_WORKS}$")
-
-
-IF (${AdmPlugins_SOURCE_DIR} MATCHES ${AdmPlugins_BINARY_DIR})
-	MESSAGE("Please do an out-of-tree build:")
-	MESSAGE("rm CMakeCache.txt; mkdir build; cd build; cmake ../plugins; make")
-	MESSAGE(FATAL_ERROR "in-tree-build detected")
-ENDIF (${AdmPlugins_SOURCE_DIR} MATCHES ${AdmPlugins_BINARY_DIR})
-
-include(admConfigHelper)
-
-IF (FRESH_BUILD)
-	MESSAGE("")
-ENDIF (FRESH_BUILD)
-
-########################################
-# Where is the top dir
-########################################
-IF(NOT AVIDEMUX_SOURCE_DIR)
-	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_SOURCE_DIR=path_to_avidemux_source")
-ENDIF(NOT AVIDEMUX_SOURCE_DIR)
-INCLUDE_DIRECTORIES(${AVIDEMUX_SOURCE_DIR})
-########################################
-# Where is coreConfig ?
-########################################
-IF(NOT AVIDEMUX_CORECONFIG_DIR)
-	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_CORECONFIG_DIR=path_to_ADM_coreConfig.h")
-ENDIF(NOT AVIDEMUX_CORECONFIG_DIR)
-INCLUDE_DIRECTORIES(${AVIDEMUX_CORECONFIG_DIR})
-########################################
-# Global options
-########################################
-OPTION(VERBOSE "" OFF)
-
-IF (NOT CMAKE_BUILD_TYPE)
-	SET(CMAKE_BUILD_TYPE "Release")
-ENDIF (NOT CMAKE_BUILD_TYPE)
-########################################
-# Avidemux system specific tweaks
-########################################
-INCLUDE(admDetermineSystem)
-
-IF (CYGWIN)
-	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -mwin32")
-	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -mwin32")
-ENDIF (CYGWIN)
-
-IF (ADM_CPU_ALTIVEC)
-	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${ADM_ALTIVEC_FLAGS}")
-	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${ADM_ALTIVEC_FLAGS}")
-ENDIF (ADM_CPU_ALTIVEC)
-IF (WIN32)
-	SET(BIN_DIR .)
-	SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import")
-	SET(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -Wl,-enable-auto-import")
-
-	IF (CMAKE_BUILD_TYPE STREQUAL "Release")
-		SET(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -Wl,-s")
-		SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,-s")
-	ENDIF (CMAKE_BUILD_TYPE STREQUAL "Release")
-ELSE (WIN32)
-	SET(BIN_DIR bin)
-ENDIF (WIN32)
-
-########################################
-# Standard Avidemux defines
-########################################
-SET(VERSION 2.5.0)
-
-SET(ADM_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}")
-
-IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
-	SET(ADM_DEBUG 1)
-ENDIF (CMAKE_BUILD_TYPE STREQUAL "Debug")
-
-INCLUDE(admCheckRequiredLibs)
-
-INCLUDE(admCheckMiscLibs)
-
-########################################
-# Actual work to do..
-########################################
-
-ADD_SUBDIRECTORY(ADM_audiodecoder)
-ADD_SUBDIRECTORY(ADM_videoEncoder)
-ADD_SUBDIRECTORY(ADM_videoFilters)
-#
-# End of file
-#
-
+MESSAGE("#####################################")
+MESSAGE("Plugins Configure Started")
+MESSAGE("#####################################")
+MESSAGE("")
+
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
+
+if (COMMAND cmake_policy)
+	cmake_policy(VERSION 2.4)
+	cmake_policy(SET CMP0003 NEW)
+endif (COMMAND cmake_policy)
+
+IF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES "^${CMAKE_CXX_COMPILER_WORKS}$")
+	SET(FRESH_BUILD 1)
+ENDIF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES "^${CMAKE_CXX_COMPILER_WORKS}$")
+
+PROJECT(AdmPlugins)
+
+IF (${AdmPlugins_SOURCE_DIR} MATCHES ${AdmPlugins_BINARY_DIR})
+	MESSAGE("Please do an out-of-tree build:")
+	MESSAGE("rm CMakeCache.txt; mkdir build; cd build; cmake ..; make")
+	MESSAGE(FATAL_ERROR "in-tree-build detected")
+ENDIF (${AdmPlugins_SOURCE_DIR} MATCHES ${AdmPlugins_BINARY_DIR})
+
+########################################
+# Where is the top dir
+########################################
+IF (NOT AVIDEMUX_SOURCE_DIR)
+	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_SOURCE_DIR=path_to_avidemux_source")
+ELSE (NOT AVIDEMUX_SOURCE_DIR)
+	SET(AVIDEMUX_SOURCE_DIR "${AVIDEMUX_SOURCE_DIR}" CACHE STRING "")
+ENDIF (NOT AVIDEMUX_SOURCE_DIR)
+
+INCLUDE_DIRECTORIES(${AVIDEMUX_SOURCE_DIR})
+
+########################################
+# Where are the libraries
+########################################
+IF(NOT AVIDEMUX_LIB_DIR)
+	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_LIB_DIR=path_to_avidemux_libs")
+ELSE (NOT AVIDEMUX_LIB_DIR)
+	SET(AVIDEMUX_LIB_DIR "${AVIDEMUX_LIB_DIR}" CACHE STRING "")
+ENDIF(NOT AVIDEMUX_LIB_DIR)
+
+LINK_DIRECTORIES(${AVIDEMUX_LIB_DIR})
+
+########################################
+# Where is coreConfig ?
+########################################
+IF(NOT AVIDEMUX_CORECONFIG_DIR)
+	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_CORECONFIG_DIR=path_to_ADM_coreConfig.h")
+ELSE (NOT AVIDEMUX_CORECONFIG_DIR)
+	SET(AVIDEMUX_CORECONFIG_DIR "${AVIDEMUX_CORECONFIG_DIR}" CACHE STRING "")
+ENDIF(NOT AVIDEMUX_CORECONFIG_DIR)
+
+INCLUDE_DIRECTORIES(${AVIDEMUX_CORECONFIG_DIR})
+
+SET(CMAKE_MODULE_PATH "${AVIDEMUX_SOURCE_DIR}/cmake" "${CMAKE_MODULE_PATH}")
+
+include(admConfigHelper)
+
+IF (FRESH_BUILD)
+	MESSAGE("")
+ENDIF (FRESH_BUILD)
+
+########################################
+# Global options
+########################################
+OPTION(VERBOSE "" OFF)
+
+IF (NOT CMAKE_BUILD_TYPE)
+	SET(CMAKE_BUILD_TYPE "Release")
+ENDIF (NOT CMAKE_BUILD_TYPE)
+
+########################################
+# Avidemux system specific tweaks
+########################################
+INCLUDE(admDetermineSystem)
+
+IF (CYGWIN)
+	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -mwin32")
+	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -mwin32")
+ENDIF (CYGWIN)
+
+IF (ADM_CPU_ALTIVEC)
+	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${ADM_ALTIVEC_FLAGS}")
+	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${ADM_ALTIVEC_FLAGS}")
+ENDIF (ADM_CPU_ALTIVEC)
+
+IF (WIN32)
+	SET(BIN_DIR .)
+	SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import")
+
+	IF (CMAKE_BUILD_TYPE STREQUAL "Release")
+		SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,-s")
+	ENDIF (CMAKE_BUILD_TYPE STREQUAL "Release")
+ELSE (WIN32)
+	SET(BIN_DIR bin)
+ENDIF (WIN32)
+
+########################################
+# Standard Avidemux defines
+########################################
+SET(VERSION 2.5.0)
+SET(ADM_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}")
+
+IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	SET(ADM_DEBUG 1)
+ENDIF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+########################################
+# Check for libraries
+########################################
+SET(MSG_DISABLE_OPTION "Disabled per request")
+
+INCLUDE(admCheckRequiredLibs)
+
+INCLUDE(admCheckGtk)
+checkGtk()
+
+INCLUDE(admCheckQt4)
+checkQt4()
+
+INCLUDE(admCheckMiscLibs)
+
+########################################
+# Actual work to do..
+########################################
+ADD_SUBDIRECTORY(ADM_audiodecoder)
+ADD_SUBDIRECTORY(ADM_videoEncoder)
+ADD_SUBDIRECTORY(ADM_videoFilters)
+
+########################################
+# Config Summary
+########################################
+INCLUDE(admPluginConfigSummary)
+MESSAGE("")
\ No newline at end of file



From gruntster at mail.berlios.de  Wed Jun 11 13:40:50 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 11 Jun 2008 13:40:50 +0200
Subject: [Avidemux-svn-commit] r4094 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_codecs avidemux/ADM_editor avidemux/ADM_ocr
	avidemux/ADM_outputs avidemux/ADM_outputs/oplug_flv
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/winInstaller po
Message-ID: <200806111140.m5BBeoYm029069@sheep.berlios.de>

Author: gruntster
Date: 2008-06-11 13:40:29 +0200 (Wed, 11 Jun 2008)
New Revision: 4094

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_ocr/ADM_ocrEngine.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_autodrive.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/winInstaller/avidemux.nsi
   branches/avidemux_2.5_branch_gruntster/po/de.po
Log:
[Merge] integrate changes from 2.4 branch (r4090)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -241,8 +241,8 @@
     {
       return (decoders *) (new decoderFFFLV1 (w, h,extraLen, extraData));
     }
-  
-    
+
+
 #ifdef USE_FFMPEG
   if (fourCC::check (fcc, (uint8_t *) "H263"))
     {
@@ -297,7 +297,7 @@
 
       return (decoders *) (new decoderFFWMV1 (w, h, extraLen, extraData));
     }
-  
+
   if (fourCC::check (fcc, (uint8_t *) "WMV3"))
     {
 
@@ -380,7 +380,8 @@
       return (decoders *) (new decoderFFAMV (w, h,extraLen,extraData));
     }
 
-    if (isVP6Compatible(fcc))
+
+  if (isVP6Compatible(fcc))
     {
       printf ("\n using VP6F codec\n");
       return (decoders *) (new decoderFFVP6F (w, h,extraLen,extraData));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -69,7 +69,7 @@
 extern uint8_t loadVideoCodecConf( char *name);
 extern uint8_t parseScript(char *name);
 uint8_t UI_SetCurrentFormat( ADM_OUT_FORMAT fmt );
-const char *VBR_MSG="Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".";
+const char *VBR_MSG = QT_TR_NOOP("Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".");
 //
 //
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_ocr/ADM_ocrEngine.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_ocr/ADM_ocrEngine.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_ocr/ADM_ocrEngine.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -41,9 +41,8 @@
  * 		\fn 		ADM_ocr_engine
  * 		\brief 		Common part of the OCR engine
  */
-uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
+uint8_t ADM_ocr_engine(ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
 {
-// 
     uint32_t nbSub=0;
     FILE *out=NULL;
     vobSubBitmap *bitmap=NULL;
@@ -63,45 +62,42 @@
     
     ui=ADM_ocrUiSetup();
     
+    int success = 1;
 
 _again:    
     
-    printf("Go go go\n");
-    
-    // Everything ready go go go 
-         
-   
     UI_purge();
-//  Time to go
-    
-    //gtk_widget_set_sensitive(WID(frameBitmap),1);
  
     out=fopen(labelSrt,"wb");
     if(!out)
     {
+        success = 0;
        GUI_Error_HIG(QT_TR_NOOP("Output file error"), QT_TR_NOOP("Could not open \"%s\" for writing."), labelSrt);
        goto endIt;
     }
+
     bitmapSource=ADM_buildBitmapSource(&source);
     if(!bitmapSource)
     {
-    	goto _again;
+        success = 0;
+        GUI_Error_HIG(QT_TR_NOOP("Input file error"), QT_TR_NOOP("Unknown source type"));
+        goto endIt;
     }
     if(!bitmapSource->init(&source))
     {
-    		printf("[OCR] Bitmap source failed\n");
-    		goto _again;
+        success = 0;
+        GUI_Error_HIG(QT_TR_NOOP("Input file error"), QT_TR_NOOP("Bitmap source failed"));
+        goto endIt;
     }
     
     nbSub=bitmapSource->getNbImages();
-   
     if(!nbSub)
     {
-      GUI_Error_HIG(QT_TR_NOOP("Problem loading sub"), NULL);
-        delete bitmapSource;
-        bitmapSource=NULL;
-        goto _again;
+        success = 0;
+        GUI_Error_HIG(QT_TR_NOOP("Problem loading sub"),QT_TR_NOOP("No subs"));
+        goto endIt;
      }
+
     seqNum=1;   // Sub number in srt file
     oldw=oldh=0;
     uint32_t eos;
@@ -115,7 +111,6 @@
             if(eos) break;
             ADM_assert(last>=first);
             
-            // something ?
             if(!bitmap) continue;
             if(first==last) continue;
 
@@ -133,12 +128,11 @@
             }
             oldbitmaph=bitmap->_height;
             oldbitmapw=bitmap->_width;
-           // 
+
            w=bitmap->_width;
            h=last-first+1;
            
            ADM_ocrSetRedrawSize(ui,w,h);
-           //**
            
            // Build
 againPlease:
@@ -154,15 +148,10 @@
               if(reply==ReplyClose) goto endIt;
               if(reply==ReplyCalibrate)
                 {
-                        //
-                        //printf("TADA!!!!\n");
                         ocrUpdateMinThreshold();
                         goto againPlease;
                 }
              
-             //
-             
-             
              fprintf(out,"%d\n",seqNum++);
              uint16_t hh,mm,ss,ms;
              ms2time(startTime, &hh, &mm, &ss, &ms);
@@ -176,7 +165,7 @@
              ms2time(endTime, &hh, &mm, &ss, &ms);
              fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
              fprintf(out,"%s\n\n",decodedString);
-             //             
+
              oldw=w;
              oldh=h;
              // Update infos
@@ -196,9 +185,7 @@
     	        delete bitmapSource;
     	    bitmapSource=NULL;
       
-    return 1;
-
+    return success;
 }
 
-
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -1,7 +1,7 @@
-
+//
 // C++ Implementation: ADM_lavformat
 //
-// Description: 
+// Description:
 //
 //
 // Author: mean <fixounet at free.fr>, (C) 2004
@@ -25,7 +25,7 @@
 #include <math.h>
 #include <string.h>
 
-extern "C" 
+extern "C"
 {
 	#include "ADM_libraries/ADM_ffmpeg/ADM_lavformat/avformat.h"
 };
@@ -98,7 +98,7 @@
 	close();
 }
 //___________________________________________________________________________
-uint8_t lavMuxer::open(const char *filename, uint32_t inbitrate,ADM_MUXER_TYPE type, aviInfo *info, WAVHeader *audioheader) 
+uint8_t lavMuxer::open(const char *filename, uint32_t inbitrate,ADM_MUXER_TYPE type, aviInfo *info, WAVHeader *audioheader)
 {
         return open(filename,inbitrate,type,info,0,NULL,audioheader,0,NULL);
 }
@@ -133,22 +133,22 @@
 		break;
 	case MUXER_FLV:
 		fmt = guess_format("flv", NULL, NULL);
-		break;          
+		break;
 	case MUXER_MATROSKA:
 		fmt = guess_format("matroska", NULL, NULL);
-		break;          
+		break;
 
 	default:
 		fmt=NULL;
 	}
-	if (!fmt) 
+	if (!fmt)
 	{
         	printf("Lav:Cannot guess format\n");
                 ADM_assert(0);
 		return 0;
 	}
 	oc = av_alloc_format_context();
-	if (!oc) 
+	if (!oc)
 	{
        		printf("Lav:Cannot allocate context\n");
 		return 0;
@@ -157,14 +157,14 @@
 	snprintf(oc->filename,1000,"file://%s",filename);
 	// Video
 	//________
-	
+
 	video_st = av_new_stream(oc, 0);
-	if (!video_st) 
+	if (!video_st)
 	{
 		printf("Lav: new stream failed\n");
 		return 0;
-	}	
-	
+	}
+
 	c = video_st->codec;
 	switch(_type)
 	{
@@ -177,16 +177,16 @@
 					 	 c->codec->name=ADM_strdup("FLV1");
 					 }else
 					 {
-					         if(isVP6Compatible(info->fcc))
+						 if(isVP6Compatible(info->fcc))
 						 			{
 							 		 c->codec_id=CODEC_ID_VP6F;
 					 				 c->codec->name=ADM_strdup("VP6F");
 						 			}
 						 else
 							 ADM_assert(0);
- 
+
 					 }
-					 
+
 					 break;
                 case MUXER_MATROSKA:
                         strcpy(oc->title,"Avidemux");
@@ -214,7 +214,7 @@
                                       printf("[lavFormat] Cannot map  this\n");
                                       return 0;
                                    }
-                                  
+
                                 }
                         }
                         if(videoExtraDataSize)
@@ -299,7 +299,7 @@
                                 c->bit_rate=9000*1000;
                         else
                                 c->bit_rate=inbitrate;
-        
+
                         break;
 		case MUXER_DVD:
 			c->codec_id = CODEC_ID_MPEG2VIDEO;
@@ -310,7 +310,7 @@
 				c->bit_rate=9000*1000;
 			else
 				c->bit_rate=inbitrate;
-	
+
 			break;
 		case MUXER_VCD:
 			c->codec_id = CODEC_ID_MPEG1VIDEO;
@@ -318,10 +318,10 @@
 			c->rc_buffer_size=8*1024*40;
 			c->rc_max_rate=1152*1000;
 			c->rc_min_rate=1152*1000;
-			
+
 			c->bit_rate=1152*1000;
-			
 
+
 			break;
 		case MUXER_SVCD:
 			c->codec_id = CODEC_ID_MPEG2VIDEO;
@@ -338,23 +338,23 @@
 		default:
 			ADM_assert(0);
 	}
-	
+
 	c->codec_type = CODEC_TYPE_VIDEO;
-	c->flags=CODEC_FLAG_QSCALE;   
-	c->width = info->width;  
-	c->height = info->height; 
+	c->flags=CODEC_FLAG_QSCALE;
+	c->width = info->width;
+	c->height = info->height;
 
        AVRational fps25=(AVRational){1001,25025};
        AVRational fps24=(AVRational){1001,24000};
        AVRational fps30= (AVRational){1001,30000};
        AVRational fpsfree= (AVRational){1000,_fps1000};
 
-        
+
     	switch(_fps1000)
 	{
 		case 25000:
                 {
-			 c->time_base= fps25; 
+			 c->time_base= fps25;
 			 break;
                 }
 		case 23976:
@@ -382,24 +382,24 @@
                         break;
 	}
 
-			
+
 	c->gop_size=15;
 	c->max_b_frames=2;
 	c->has_b_frames=1;
 
-	
+
 	// Audio
 	//________
         if(audioheader)
         {
           audio_st = av_new_stream(oc, 1);
-          if (!audio_st) 
+          if (!audio_st)
           {
                   printf("Lav: new stream failed\n");
                   return 0;
           }
-  
-                  
+
+
           c = audio_st->codec;
           c->frame_size=1024; //For AAC mainly, sample per frame
           printf("[LavFormat] Bitrate %u\n",(audioheader->byterate*8)/1000);
@@ -410,7 +410,7 @@
                     _audioFq=c->sample_rate = audioheader->frequency/2;                 //_audioFq*=2; // SBR
              }
 #endif
-          
+
           switch(audioheader->encoding)
           {
                   case WAV_AC3: c->codec_id = CODEC_ID_AC3;break;
@@ -420,11 +420,11 @@
                               c->frame_size=1152;
                               c->codec_id = CODEC_ID_MP3;
                               break;
-                  case WAV_PCM: 
+                  case WAV_PCM:
                                   // One chunk is 10 ms (1/100 of fq)
                                   c->frame_size=4;
                                   c->codec_id = CODEC_ID_PCM_S16LE;break;
-                  case WAV_AAC: 
+                  case WAV_AAC:
                                   c->extradata=audioextraData;
                                   c->extradata_size= audioextraSize;
                                   c->codec_id = CODEC_ID_AAC;
@@ -444,25 +444,24 @@
                              break;
                            }
                           }
-                            
-                          printf("Cant mux that ! audio\n"); 
+
                           printf("Cant mux that ! audio\n");
                           c->codec_id = CODEC_ID_MP2;
                           return 0;
                           break;
           }
           c->codec_type = CODEC_TYPE_AUDIO;
-          
+
           c->bit_rate = audioheader->byterate*8;
           c->rc_buffer_size=(c->bit_rate/(2*8)); // 500 ms worth
-          
+
           c->channels = audioheader->channels;
           _audioByterate=audioheader->byterate;
-          
+
         }
         // /audio
-	
-	
+
+
 //----------------------
 	switch(_type)
 	{
@@ -483,26 +482,26 @@
 		case MUXER_VCD:
 			oc->packet_size=2324;
 			oc->mux_rate=2352 * 75 * 8;
-			
+
 			break;
 		case MUXER_SVCD:
-			
+
 			oc->packet_size=2324;
 			oc->mux_rate=2*2352 * 75 * 8; // ?
-			
+
 			break;
 		default:
 			ADM_assert(0);
 	}
 	oc->preload=AV_TIME_BASE/10; // 100 ms preloading
 	oc->max_delay=200*1000; // 500 ms
-	
-	if (av_set_parameters(oc, NULL) < 0) 
+
+	if (av_set_parameters(oc, NULL) < 0)
 	{
 		printf("Lav: set param failed \n");
 		return 0;
 	}
-	 if (url_fopen(&(oc->pb), filename, URL_WRONLY) < 0) 
+	 if (url_fopen(&(oc->pb), filename, URL_WRONLY) < 0)
 	 {
 	 	printf("Lav: Failed to open file :%s\n",filename);
 		return 0;
@@ -513,10 +512,10 @@
 
 
 	printf("lavformat mpeg muxer initialized\n");
-	
+
 	_running=1;
 
-	one=(1000*1000*1000)/_fps1000; 
+	one=(1000*1000*1000)/_fps1000;
 	_curDTS=one;
 
 	return 1;
@@ -524,14 +523,14 @@
 //___________________________________________________________________________
 uint8_t lavMuxer::writeAudioPacket(uint32_t len, uint8_t *buf,uint32_t sample)
 {
-        
+
         int ret;
         AVPacket pkt;
         double f;
         int64_t timeInUs;
 
             //printf("Audio paclet : size %u, sample %u\n",len,sample);
-        
+
            if(!audio_st) return 0;
            if(!len) return 1;
             av_init_packet(&pkt);
@@ -546,24 +545,24 @@
             else
             {
             	f=timeInUs;
-            	f/=1000000.; // In ms seconds 
+            	f/=1000000.; // In ms seconds
             	f*=_audioFq;
             	f=floor(f+0.4);
             }
             pkt.dts=pkt.pts=(int)(f);
 
             //printf("F:%f Q:%u D=%u\n",f,pkt.pts,timeInUs-_lastAudioDts);
-            
-            pkt.flags |= PKT_FLAG_KEY; 
+
+            pkt.flags |= PKT_FLAG_KEY;
             pkt.data= buf;
             pkt.size= len;
             pkt.stream_index=1;
             //pkt.duration=pkt.dts-_lastAudioDts; // Duration
-            aprintf("A: sample: %d frame_pts: %d fq: %d\n",(int32_t )sample,(int32_t )pkt.dts,audio_st->codec->sample_rate); 
+            aprintf("A: sample: %d frame_pts: %d fq: %d\n",(int32_t )sample,(int32_t )pkt.dts,audio_st->codec->sample_rate);
 
             ret = av_write_frame(oc, &pkt);
             _lastAudioDts=timeInUs;
-            if(ret) 
+            if(ret)
             {
                         printf("Error writing audio packet\n");
                         printf("pts %llu dts %llu\n",pkt.pts,pkt.dts);
@@ -579,20 +578,20 @@
                 f=sample;
                 f*=1000.*1000.;
                 f/=_audioFq;              // Sample / Frequency = time in seconds *10E6 to get in in us
-                
+
                 return (uint64_t)floor(f);
 
 }
 //___________________________________________________________________________
 uint8_t lavMuxer::needAudio( void )
 {
-	
+
         if(!audio_st) return 0;
 
 	double f;
 	uint64_t dts=_lastAudioDts;  // Last audio dts
 
-		
+
 		aprintf("Need audio  ?: %llu / %llu : %llu\n ",dts,_curDTS,_curDTS+one);
 		if((dts+5000>=_curDTS) && (dts<=_curDTS+one)) return 1;
 		if(dts<=_curDTS)
@@ -610,28 +609,28 @@
 double p,d;
   	AVPacket pkt;
             av_init_packet(&pkt);
-	    
+
         p=bitstream->ptsFrame+1;      // Pts           // Time p/fps1000=out/den  out=p*den*1000/fps1000
         p=(p*1000*1000*1000);
         p=p/_fps1000;                  // in us
-	
+
         d=bitstream->dtsFrame;		// dts
 	d=(d*1000*1000*1000);
 	d=d/_fps1000;
-	
-	
-	_curDTS=(int64_t)floor(d);	
-        
+
+
+	_curDTS=(int64_t)floor(d);
+
         // Rescale
 #define RESCALE(x) x=x*video_st->codec->time_base.den*1000.;\
                    x=x/_fps1000;
-        
+
         p=bitstream->ptsFrame+1;
         RESCALE(p);
-        
+
         d=bitstream->dtsFrame;
         RESCALE(d);
-        
+
         if(_type==MUXER_FLV || _type==MUXER_MATROSKA) /* The FLV muxer expects packets dated in ms, there is something i did not get... WTF */
         {
         			p=p*1000/_fps1000;
@@ -643,30 +642,30 @@
        // printf("Lavformat : Pts :%u dts:%u",displayframe,frameno);
 	aprintf("Lavformat : Pts :%llu dts:%llu",pkt.pts,pkt.dts);
 	pkt.stream_index=0;
-           
+
         pkt.data= bitstream->data;
         pkt.size= bitstream->len;
 	// Look if it is a gop start or seq start
         if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV || _type==MUXER_MATROSKA)
         {
-            if(bitstream->flags & AVI_KEY_FRAME) 
+            if(bitstream->flags & AVI_KEY_FRAME)
                         pkt.flags |= PKT_FLAG_KEY;
         }else
             if(!bitstream->data[0] &&  !bitstream->data[1] && bitstream->data[2]==1)
 	{
             if(bitstream->data[3]==0xb3 || bitstream->data[3]==0xb8 ) // Seq start or gop start
 		pkt.flags |= PKT_FLAG_KEY;
-		//printf("Intra\n"); 
+		//printf("Intra\n");
 	}
-           
+
 	ret =av_write_frame(oc, &pkt);
-	if(ret) 
+	if(ret)
 	{
 		printf("Error writing video packet\n");
 		return 0;
 	}
         aprintf("V: frame %lu pts%d\n",bitstream->dtsFrame,pkt.pts);
-	
+
 	return 1;
 }
 //___________________________________________________________________________
@@ -723,7 +722,7 @@
 }
 extern "C"
 {
-/** 
+/**
     \fn ADM_useAlternateTagging
     \brief returns 1 if using haali compatible tagging, 0 if normal. For mp3 in mp4ff.
 */
@@ -732,8 +731,8 @@
   uint32_t v=1;
   prefs->get(FEATURE_ALTERNATE_MP3_TAG,&v);
   return v;
-} 
 }
+}
 
 typedef struct
 {
@@ -762,12 +761,12 @@
       if(!strncmp(lavFCC[i].name,fcc,4))
       {
         *outlavid=(CodecID)lavFCC[i].id;
-        return 1; 
+        return 1;
       }
-      
+
     }
     return 0;
-  
+
 }
 //*****************
 typedef struct
@@ -797,12 +796,12 @@
       if(lavWaveTag[i].tag==tag)
       {
         *outlavid=(CodecID)lavWaveTag[i].id;
-        return 1; 
+        return 1;
       }
-      
+
     }
     return 0;
-  
+
 }
 
 //___________________________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -133,7 +133,6 @@
            int supported=0;
            if(isVP6Compatible(info.fcc)) supported=1;
            if(fourCC::check(info.fcc,(const uint8_t *)"FLV1")) supported=1;
-
            if(!supported)
            {
         	   GUI_Error_HIG(QT_TR_NOOP("Unsupported video"),QT_TR_NOOP("Only FLV1 and VP6 video are supported"));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -1,10 +1,14 @@
+/***************************************************************************
+                          DIA_vobsub.cpp  -  description
+                             -------------------
+    begin                : Thu Apr 21 2003
+    copyright            : (C) 2003 by mean
+    email                : fixounet at free.fr
 
-//
-// Author: mean , fixounet at free.fr, GPL (C) 2005
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
+  This class deals with the working window
+
+ ***************************************************************************/
+
 /***************************************************************************
  *                                                                         *
  *   This program is free software; you can redistribute it and/or modify  *
@@ -15,6 +19,7 @@
  ***************************************************************************/
 #include "ADM_toolkitGtk.h"
 
+#include "DIA_coreToolkit.h"
 #include "DIA_fileSel.h"
 
 #define CHECK_GET(x,y) {*y=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(x)));}
@@ -34,87 +39,88 @@
 static int              indeces[MAX_INDECES];
 static void update(char *name,int i);
 
+/* Dialog for update vobsub parameters :
+ * - File name
+ * - Shift
+ * - Selected language
+ */
 uint8_t DIA_vobsub(vobSubParam *param);
 uint8_t DIA_vobsub(vobSubParam *param)
 {
-  char *name=NULL; 
+  char *name;
   int32_t shift;     
-  int ret,ext,r;
+  int ret,ext;
         
-  ret=0;
-  ext=0;
+  ret = 0;
+  ext = 0;
+  name = param->subname;
+  shift = param->subShift;
   
-  if(param->subname)
-    name=ADM_strdup(param->subname);
-  shift=param->subShift;
-  
   while(!ext)
   {
-    dialog=create_dialog1();
+    dialog = create_dialog1();
     gtk_register_dialog(dialog);
-    //gtk_transient(dialog);
-    gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonSelect), GTK_RESPONSE_APPLY);
+    gtk_dialog_add_action_widget(GTK_DIALOG(dialog),WID(buttonSelect),GTK_RESPONSE_APPLY);
     
+    fq = new GtkWidget*[ADM_MAX_LANGUAGE];
     
-    fq=new GtkWidget*[ADM_MAX_LANGUAGE];
-  
-        // Upload if any
+    // update if any
         if(name)
         {
                 update(name,param->index);
+      gtk_label_set_text(GTK_LABEL(WID(labelVobsub)),name);
         }
         else
         {
                 gtk_label_set_text(GTK_LABEL(WID(labelVobsub)),QT_TR_NOOP("none"));     
         }
+
         gtk_write_entry(WID(entryShift),shift);
-        r=gtk_dialog_run(GTK_DIALOG(dialog));
-        shift=gtk_read_entry(WID(entryShift));
-        switch(r)
+
+    switch(gtk_dialog_run(GTK_DIALOG(dialog)))
         {
               case GTK_RESPONSE_APPLY:
-              {
                 char *file;
                         GUI_FileSelRead(QT_TR_NOOP("Select .idx file"),&file); 
                         if(file)
                         {
-                          if(name) ADM_dealloc(name);
-                          name=NULL;
-                          name=ADM_strdup(file); // Leak ?                      
-                        }                                
+          ADM_dealloc(name);
+          name = file;
               }
+        shift = gtk_read_entry(WID(entryShift));
                 break;
               case GTK_RESPONSE_OK:
-                ret=1;
-                ext=1;
-                if(name)
+        if(!name)
                 {
-                        ADM_dealloc(name);
+          GUI_Error_HIG(QT_TR_NOOP("Wrong VobSub parametering"),QT_TR_NOOP("The idx/sub file does not set."));
+        }
+        else
+        {
+          param->subname = name;
+          param->index = indeces[getRangeInMenu(WID(optionmenu1))];
+          param->subShift = gtk_read_entry(WID(entryShift));
+          ret = 1;
+          ext = 1;
                 }
-                name=ADM_strdup(gtk_label_get_text(GTK_LABEL(WID(labelVobsub))));
-                if(param->subname)      
-                        ADM_dealloc(param->subname);
-                param->subname=name;                                        
-                //
-                
-                param->index=indeces[getRangeInMenu(WID(optionmenu1))];
-                param->subShift=shift;
                 break;
               case GTK_RESPONSE_CANCEL:
+      default:
+        if(name != param->subname)
+        {
+          ADM_dealloc(name);
+        }
                 ret=0;
                 ext=1;
                 break;
-              default:
-                break;
         }
         delete [] fq;          
         gtk_unregister_dialog(dialog);
         gtk_widget_destroy(dialog);
-  
   }
      
   return ret;
 }    
+
 //*****************************************************   
 void update(char *name,int idx)
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -13,6 +13,8 @@
  ***************************************************************************/
 #include "config.h"
 
+#include <QtCore/QFileInfo>
+#include <QtCore/QUrl>
 #include <QtGui/QKeyEvent>
 #include <QtGui/QGraphicsView>
 
@@ -43,6 +45,7 @@
 extern void initTranslator(void);
 extern void destroyTranslator(void);
 extern ADM_RENDER_TYPE UI_getPreferredRender(void);
+extern int A_openAvi2(char *name, uint8_t mode);
 
 int SliderIsShifted=0;
 static void setupMenus(void);
@@ -428,6 +431,35 @@
 	this->setFocus(Qt::OtherFocusReason);
 }
 
+void MainWindow::dragEnterEvent(QDragEnterEvent *event)
+{
+	if (event->mimeData()->hasFormat("text/uri-list"))
+		event->acceptProposedAction();
+}
+
+void MainWindow::dropEvent(QDropEvent *event)
+{
+	QList<QUrl> urlList;
+	QString fileName;
+	QFileInfo info;
+
+	if (event->mimeData()->hasUrls())
+	{
+		urlList = event->mimeData()->urls();
+
+		if (urlList.size() > 0)
+		{
+			fileName = urlList[0].toLocalFile();
+			info.setFile(fileName);
+
+			if (info.isFile())
+				A_openAvi2(fileName.toUtf8().data(), 0);
+		}
+	}
+
+	event->acceptProposedAction();
+}
+
 void MainWindow::previousIntraFrame(void)
 {
 	if (ui.spinBox_TimeValue->hasFocus())

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.h	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.h	2008-06-11 11:40:29 UTC (rev 4094)
@@ -41,5 +41,7 @@
 	void clearCustomMenu(void);
 	bool eventFilter(QObject* watched, QEvent* event);
 	void mousePressEvent(QMouseEvent* event);
+	void dragEnterEvent(QDragEnterEvent *event);
+	void dropEvent(QDropEvent *event);
 };
 #endif	// Q_gui2_h

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -1,10 +1,8 @@
-/**/
 /***************************************************************************
-                          DIA_hue
+                          DIA_ocr
                              -------------------
+                        Ui for OCR
 
-                           Ui for hue & sat
-
     begin                : 08 Apr 2005
     copyright            : (C) 2004/5 by mean
     email                : fixounet at free.fr
@@ -19,15 +17,12 @@
  *                                                                         *
  ***************************************************************************/
 
-
-
 #include "config.h"
 
 #include <math.h>
 
 #include "ADM_default.h"
 
-
 #include "DIA_factory.h"
 #include "ADM_editor/ADM_edit.hxx"
 #include "ADM_videoFilter.h"
@@ -66,7 +61,6 @@
   source.type=ADM_OCR_TYPE_VOBSUB;
   source.subparam=&subparam;
   
-  
   prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&globalGlyphOn);
   if(globalGlyphOn)
   {
@@ -90,14 +84,13 @@
   
   diaElem *elems[]={&selectIdx,&selectSrt,&selectGlyph};
   
-  
    uint32_t n=3;
    if(globalGlyph)
    {
      n--; // Remove glyph from dialog
    }
   
-        if( !diaFactoryRun(QT_TR_NOOP("Select input and ouput files"),n,elems))
+    if(!diaFactoryRun(QT_TR_NOOP("Select input and ouput files"),n,elems))
         {
           cleanupSub(&source);
           if(srtFileName )ADM_dezalloc(srtFileName);
@@ -135,27 +128,27 @@
          }
         // We have our SRT and our idx/sub files : Go go go
          
-         
-         
-        ADM_ocr_engine(source,srtFileName,&head);
-        
+    if(ADM_ocr_engine(source,srtFileName,&head))
+    {
         // Save glyph set 
         if(globalGlyph)
         {
           uint32_t nb=1;
            saveGlyph(globalGlyph,&head,nb);
-        }else
+        }
+        else
         {
             char *save=NULL;
             uint32_t nb=1;
               diaElemFile     selectSave(1,&save,QT_TR_NOOP("GlyphSet filename"), NULL, QT_TR_NOOP("Save GlyphSet file"));
               diaElem *elems2[]={&selectSave};
-            if( diaFactoryRun(QT_TR_NOOP("Save Glyph"),1,elems2))
+            if(diaFactoryRun(QT_TR_NOOP("Save Glyph"),1,elems2))
             {
               saveGlyph(save,&head,nb);
             }
             if(save) ADM_dezalloc(save);
         }
+    }
 
   cleanupSub(&source);
   if(srtFileName )ADM_dezalloc(srtFileName);
@@ -317,11 +310,6 @@
 void cb_idx(void *foo)
 {
    vobSubParam *bar=(vobSubParam *)foo;
-   if(bar->subname)
-   	  {
-   		  ADM_dezalloc(bar->subname);
-   		  bar->subname=NULL;
-   	  }
     DIA_vobsub(bar);
 }
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_autodrive.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_autodrive.cpp	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_autodrive.cpp	2008-06-11 11:40:29 UTC (rev 4094)
@@ -54,42 +54,35 @@
         switch(action)
         {
                 case ACT_AUTO_IPOD:
-#if  !defined(USE_XVID_4) || (!defined(USE_FAAC) && !defined(HAVE_MP3LAME))
-                  GUI_Error_HIG(QT_TR_NOOP("Codec Error"),
-                                        QT_TR_NOOP( "You need Xvid4 and either LAME or FAAC support for the iPod profile"));
+#if !defined(USE_XVID_4) || !defined(USE_FAAC)
+					GUI_Error_HIG(QT_TR_NOOP("Codec Error"),
+						QT_TR_NOOP( "Xvid4 and FAAC support is required for the iPod profile."));
 #else
-                    if(!setIPOD())
-                    {
-                        return 0;
-                    }
-                
-                    // Video codec
+					if(!setIPOD())
+						return 0;
 
-                    if(!videoCodecSelectByName("XVID4")) 
-                    {
-                      GUI_Error_HIG(QT_TR_NOOP("Codec Error"),QT_TR_NOOP( "Cannot select the MPEG-4 SP codec."));
-                        return 0;
-                    }
-                    setIpod_Xvid4Preset();
-                    // Set mode & bitrate 
-                    setVideoEncoderSettings(COMPRESS_CBR,400,0,NULL);
-                    // Audio Codec
-                    if(   (currentaudiostream->getInfo()->channels==2)&&
-                        (currentaudiostream->getInfo()->encoding==WAV_AAC ||
-                         currentaudiostream->getInfo()->encoding==WAV_MP3))
-                    {
-                        audioCodecSetcodec(AUDIOENC_COPY);
-                    }
-                    else
-                    {
-#if defined(USE_FAAC)
-                          audioCodecSetcodec(AUDIOENC_FAAC);
-#elif defined(HAVE_MP3LAME)
-                          audioCodecSetcodec(AUDIOENC_MP3);
+					// Video codec
+
+					if(!videoCodecSelectByName("XVID4")) 
+					{
+						GUI_Error_HIG(QT_TR_NOOP("Codec Error"),QT_TR_NOOP( "Cannot select the MPEG-4 SP codec."));
+						return 0;
+					}
+					setIpod_Xvid4Preset();
+					// Set mode & bitrate
+					setVideoEncoderSettings(COMPRESS_CBR,400,0,NULL);
+					// Audio Codec
+					if((currentaudiostream->getInfo()->channels == 2)&& currentaudiostream->getInfo()->encoding == WAV_AAC)
+						audioCodecSetcodec(AUDIOENC_COPY);
+					else
+					{
+						audioCodecSetcodec(AUDIOENC_FAAC);
+						audioFilter_SetBitrate(128);
+
+						if (currentaudiostream->getInfo()->channels != 2)
+							setCurrentMixerFromString("STEREO");
+					}
 #endif
-                          audioFilter_SetBitrate(128);
-                      }
-#endif
                       break;
 //******************************** IPOD *******************************
                           

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/winInstaller/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/winInstaller/avidemux.nsi	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/winInstaller/avidemux.nsi	2008-06-11 11:40:29 UTC (rev 4094)
@@ -177,7 +177,7 @@
     File ..\..\..\avidemux_2.4_build\libfontconfig-1.dll
     File ..\..\..\avidemux_2.4_build\libglib-2.0-0.dll
     File ..\..\..\avidemux_2.4_build\libmp3lame-0.dll
-    File ..\..\..\avidemux_2.4_build\libpng13.dll
+    File ..\..\..\avidemux_2.4_build\libpng12-0.dll
     File ..\..\..\avidemux_2.4_build\libx264.dll
     File ..\..\..\avidemux_2.4_build\libxml2.dll
     File ..\..\..\avidemux_2.4_build\ogg.dll

Modified: branches/avidemux_2.5_branch_gruntster/po/de.po
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/de.po	2008-06-11 00:33:07 UTC (rev 4093)
+++ branches/avidemux_2.5_branch_gruntster/po/de.po	2008-06-11 11:40:29 UTC (rev 4094)
@@ -7,8 +7,8 @@
 msgstr ""
 "Project-Id-Version: de\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2008-01-24 18:59+0100\n"
-"PO-Revision-Date: 2008-01-26 11:57+0100\n"
+"POT-Creation-Date: 2008-05-15 19:44+0200\n"
+"PO-Revision-Date: 2008-05-15 21:43+0100\n"
 "Last-Translator: Joo Martin <ad_debian at joonet.de>\n"
 "Language-Team: German\n"
 "MIME-Version: 1.0\n"
@@ -18,6 +18,7 @@
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:42
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:369
 msgid "AVI"
 msgstr "AVI"
 
@@ -46,23 +47,30 @@
 msgstr "MPEG Video"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:49
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:493
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:131
 msgid "MP4"
 msgstr "MP4"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:50
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:119
 msgid "OGM"
 msgstr "OGM"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:51
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:130
 msgid "PSP"
 msgstr "PSP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:194
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:283
 msgid "FLV"
 msgstr "FLV"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:53
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:132
 msgid "MKV"
 msgstr "MKV"
 
@@ -70,6 +78,148 @@
 msgid "DUMMY"
 msgstr "DUMMY"
 
+#: avidemux/ADM_encoder/adm_encmpeg2enc.h:57
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
+msgid "MPEG"
+msgstr "MPEG"
+
+#: avidemux/ADM_encoder/adm_encyv12.h:69
+msgid "YV12"
+msgstr "YV12"
+
+#: avidemux/ADM_encoder/adm_encmjpeg.h:60
+msgid "MJPEG"
+msgstr "MJPEG"
+
+#: avidemux/ADM_encoder/adm_encx264.h:65
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
+msgid "x264"
+msgstr "x264"
+
+#: avidemux/ADM_encoder/adm_encxvid.h:61
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
+msgid "Xvid"
+msgstr "Xvid"
+
+#: avidemux/ADM_encoder/adm_encXvid4.h:62
+msgid "Xvid4"
+msgstr "Xvid4"
+
+#: avidemux/ADM_encoder/adm_encffmpeg.h:47
+msgid "LavCodec"
+msgstr "LavCodec"
+
+#: avidemux/ADM_encoder/adm_encdivx.h:52
+msgid "DivX"
+msgstr "DivX"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:13
+msgid "YV12 (raw)"
+msgstr "YV12 (raw)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:111
+msgid "H.263 (lavc)"
+msgstr "H.263 (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:127
+msgid "H.263+ (lavc)"
+msgstr "H.263+ (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:143
+msgid "MPEG-4 ASP (lavc)"
+msgstr "MPEG-4 ASP (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:159
+msgid "DV (lavc)"
+msgstr "DV (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:175
+msgid "FLV1 (lavc)"
+msgstr "FLV1 (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:191
+msgid "Snow (lavc)"
+msgstr "Snow (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:207
+msgid "FF Huffyuv (lavc)"
+msgstr "FF Huffyuv (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:223
+msgid "Huffyuv (lavc)"
+msgstr "Huffyuv (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:239
+msgid "FFV1 (lavc)"
+msgstr "FFV1 (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:257
+msgid "MJPEG (lavc)"
+msgstr "MJPEG (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:314
+msgid "VCD (lavc)"
+msgstr "VCD (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:374
+msgid "DVD (lavc)"
+msgstr "DVD (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:434
+msgid "SVCD (lavc)"
+msgstr "SVCD (lavc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:461
+msgid "VCD (mpeg2enc)"
+msgstr "VCD (mpeg2enc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:493
+msgid "SVCD (mpeg2enc)"
+msgstr "SVCD (mpeg2enc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:512
+msgid "MPEG-2 requant"
+msgstr "MPEG-2 requant"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:539
+msgid "DVD (mpeg2enc)"
+msgstr "DVD (mpeg2enc)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:671
+msgid "MPEG-4 ASP (Xvid4)"
+msgstr "MPEG-4 ASP (Xvid4)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:812
+msgid "MPEG-4 AVC (x264)"
+msgstr "MPEG-4 AVC (x264)"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:829
+msgid "dummy"
+msgstr "dummy"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1081
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1121
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:271
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
+#: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:90
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:69
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:379
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:221
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:225
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:265
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:286
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
+#: avidemux/ADM_encoder/adm_encCopy.cpp:91
+msgid "Copy"
+msgstr "Kopie"
+
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:88
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:200
 msgid "Internal error"
@@ -159,6 +309,14 @@
 "Die Anzahl Kan?le ist gr??er als vom gew?hlten Audio Codec verarbeiten kann.\n"
 "?ndere entweder den Codec oder benutze den Mixer-Filter, um weniger Kan?le zu haben."
 
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
+msgid "Encoder initialization failed"
+msgstr "Fehler beim Initialisieren des Encoders"
+
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
+msgid "Not activated."
+msgstr "Nicht aktiviert."
+
 #: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
 msgid "VBR"
 msgstr "VBR"
@@ -300,9 +458,7 @@
 msgstr "<b>S?ttigung:</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:180
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:418
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1382
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:625
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:542
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:336
 msgid "Preview"
@@ -369,12 +525,19 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:553
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:568
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:583
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1143
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1185
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:327
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:51
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
+#: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:195
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:269
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
@@ -791,7 +954,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:756
 msgid "Select 1-pass or 2-pass encoding"
-msgstr "1- oder 2-Durchlauf-Kodierung ausw?hlen"
+msgstr "EInfach- oder Zweifach-Durchlauf beim Kodieren ausw?hlen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:760
 msgid "Single Pass - Bitrate"
@@ -802,12 +965,12 @@
 msgstr "Einfach-Durchlauf - Quantizer"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:768
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:636
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:663
 msgid "Two Pass - Video Size"
 msgstr "Zweifach-Durchlauf - Videogr??e"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:772
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:637
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:664
 msgid "Two Pass - Average Bitrate"
 msgstr "Zweifach-Durchlauf - Durchschnittsbitrate"
 
@@ -1026,8 +1189,8 @@
 msgstr "ASP Profil"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1040
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:841
-msgid "As input"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:874
+msgid "As Input"
 msgstr "Wie Eingang"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1043
@@ -1039,7 +1202,7 @@
 msgstr "Pixel Breite"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1051
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:810
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:844
 msgid ":"
 msgstr ":"
 
@@ -1052,7 +1215,7 @@
 msgstr "Pixel Seitenverh?ltnis (PAR)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:979
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1015
 msgid "Motion & Misc"
 msgstr "Bewegung & Sonstiges"
 
@@ -1085,13 +1248,13 @@
 msgstr "Individuelle Matrix laden:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1128
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1610
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1684
 msgid "Open CQM file"
 msgstr "?ffne CQM Datei"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1136
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1568
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1633
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1692
 msgid "Edit Custom Matrix"
 msgstr "Individuelle Matrix bearbeiten"
 
@@ -1193,7 +1356,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
 msgid "Two pass tuning"
-msgstr "Zweifach-Durchlauf"
+msgstr "Zweifach-Durchlauf Feinabstimmung"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1340
 msgid "High bitrate scenes (%):"
@@ -1235,572 +1398,570 @@
 msgid "<b>Inter Matrix</b>"
 msgstr "<b>Interblock Matrix</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:565
-msgid "x264 configuration"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:110
+msgid "Hadamard Exhaustive Search"
+msgstr "\"Hadamard\" vollst?ndige Suche"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:596
+msgid "x264 Configuration"
 msgstr "x264 Konfiguration"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:584
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:617
 msgid "Encoding Mode"
 msgstr "Kodier-Modus"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:596
-msgid "Target bitrate or file size"
-msgstr "Ziel-Bitrate oder Dateigr??e (kb/s):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:598
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:480
 msgid "Quantizer"
 msgstr "Quantizer"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:611
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:631
+msgid "Target Size"
+msgstr "Zielgr??e"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:644
 msgid "Constant Quantizer - Each frame will have the same compression. Low numbers equal higher quality while high numbers equal lower quality."
 msgstr "Konstanter Quantizer - Jedes Bild mit der gleichen Kompression. Niedrigere Zahlen entsprechen h?herer Qualit?t, hohe Zahlen entsprechen niedrigerer Qualit?t."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:621
-msgid "Target Size"
-msgstr "Zielgr??e"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:652
+msgid "Target bitrate or file size"
+msgstr "Ziel-Bitrate oder Dateigr??e (kb/s):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:633
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:660
 msgid "Single Pass - Quality Quantizer (Average)"
-msgstr "Einmal-Durchlauf - Qualit?ts-Quantizer (Durchschnitt)"
+msgstr "Einfach-Durchlauf - Qualit?ts-Quantizer (Durchschnitt)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:634
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:661
 msgid "Single Pass - Quality Quantizer (Constant)"
-msgstr "Einmal-Durchlauf - Qualit?ts-Quantizer (Konstante)"
+msgstr "Einfach-Durchlauf - Qualit?ts-Quantizer (Konstante)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:635
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:662
 msgid "Single Pass - Bitrate (Average)"
-msgstr "Einmal-Durchlauf - Bitrate (Durchschnitt)"
+msgstr "Einfach-Durchlauf - Bitrate (Durchschnitt)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:639
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:666
 msgid "Bitrate"
 msgstr "Bitrate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:670
-msgid "Partition decision"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:699
+msgid "Partition Decision"
 msgstr "Aufteilungsentscheidung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:706
 msgid "Method"
 msgstr "Methode"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:689
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:718
 msgid "1  - Extremely Low (Fastest)"
 msgstr "1  - Besonders niedrig (am Schnellsten)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:719
 msgid "2  - Very Low"
 msgstr "2  - Sehr niedrig"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:691
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:720
 msgid "3  - Low"
 msgstr "3  - Niedrig"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:692
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:721
 msgid "4  - Medium"
 msgstr "4  - Mittel"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:693
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:722
 msgid "5  - High (Default)"
 msgstr "5  - Hoch (Voreinstellung)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:694
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:723
 msgid "6  - Very High"
 msgstr "6  - Sehr hoch"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:724
 msgid "6B - Very High (RDO on B-frames)"
 msgstr "6B - Sehr hoch (RDO bei B-Bildern)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:696
-msgid "7 - Ultra High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:725
+msgid "7  - Ultra High"
 msgstr "7  - Besonders hoch"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:697
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:726
 msgid "7B - Ultra High (RDO on B-frames)"
 msgstr "7B  - Besonders hoch (RDO bei B-Bildern)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:704
-msgid "Diamond search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:733
+msgid "Diamond Search"
 msgstr "Sternf?rmig suchen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
-msgid "Hexagonal search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:734
+msgid "Hexagonal Search"
 msgstr "Hexagonal suchen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:706
-msgid "Uneven multi-hexagon"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:735
+msgid "Uneven Multi-hexagon"
 msgstr "Ungerades Multi-Hexagon"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:707
-msgid "Exhaustive search"
-msgstr "Vollst?ndig suchen"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:736
+msgid "Exhaustive Search"
+msgstr "Vollst?ndige Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:719
-msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers 3 to 5 are recommended."
-msgstr "Setzt die Anzahl von voraus gegangenen Bildern die von P/B-Bildern referenziert werden k?nnen. Zahlen ?ber 5 verbessern die Qualit?t kaum mehr. Zahlen zwischen 3 und 5 werden empfohlen."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:722
-msgid "Max. Ref. frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
+msgid "Max. Ref. Frames"
 msgstr "Max. Referenzbilder"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:729
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:751
 msgid "Range"
 msgstr "Bereich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:742
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:764
 msgid "Define how many pixels are analysed for motion estimation. The higher the range the more accurate the analysis but the slower the encoding time."
 msgstr "Anzahl der zu analysierenden Pixel festlegen. Je h?her dieser Bereich, desto sorgf?ltiger die Analyse, aber umso langsamer die Kodierungszeit."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:745
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:773
+msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers 3 to 5 are recommended."
+msgstr "Setzt die Anzahl von voraus gegangenen Bildern die von P/B-Bildern referenziert werden k?nnen. Zahlen ?ber 5 verbessern die Qualit?t kaum mehr. Zahlen zwischen 3 und 5 werden empfohlen."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:776
 msgid "Chroma ME"
 msgstr "Farbintensit?t ME"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:781
 msgid "Use color information for detecting motion to improve quality"
 msgstr "Informationen ?ber die Farbintensit?t zur Absch?tzung der Bewegung verwenden"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:753
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:784
 msgid "Mixed Refs"
 msgstr "Gemischte Referenzbilder"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:758
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:789
 msgid "Calculate referencing individually based on each partition"
 msgstr "Berechnet die Referenzierung individuell, abh?ngig vom jeweiligen Teilbereich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:795
 msgid "Fast P-Skip"
 msgstr "Schnelles P-Skip"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:767
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:798
 msgid "Early skip detection on P-frames to speedup encoding. Quality will be slightly reduced."
 msgstr "Fr?hes ?berspringen der P-Bild-Erkennung zur Kodierbeschleunigung. Die Qualit?t wird geringf?gig reduziert."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:770
-msgid "DCT decimate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:801
+msgid "DCT Decimate"
 msgstr "DCT abschw?chen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:774
-msgid "Interlace"
-msgstr "Halbbildmodus (interlace)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:806
+msgid "Interlaced"
+msgstr "Halbbildmodus"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:777
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:809
 msgid "Input video is interlaced"
 msgstr "Eingangsvideo ist im Halbbildmodus"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:811
 msgid "<b>Motion Estimation</b>"
 msgstr "<b>Bewegungsabsch?tzung</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:806
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:818
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:840
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:851
 msgid "Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."
 msgstr "Erzwingt die Gr??e eines dekodierten Pixels, die zu einem bestimmten Wert dekodiert wurden. 1:1 wird f?r nicht-anamorphe Videos empfohlen."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:807
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:819
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:841
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:852
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:83
 msgid "1"
 msgstr "1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:822
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:855
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp:87
 msgid "Custom"
 msgstr "Individuell"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:827
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:860
 msgid "Set a custom aspect ratio. The default 1:1 is recommended for most video."
 msgstr "Individuelles Seitenverh?ltnis festlegen. Die Vorgabe 1:1 wird f?r die meisten Videos empfohlen."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:832
-msgid "Predefined Aspect Ratios"
-msgstr "Vordefiniert"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:865
+msgid "Predefined Aspect Ratio"
+msgstr "Vordefiniertes Seitenverh?ltnis"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:837
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:870
 msgid "Set a common predefined aspect ratio"
 msgstr "Vordefiniertes Seitenverh?ltnis festlegen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:846
-msgid "Get Pixel Aspect Ratio from input video file"
-msgstr "PAR (\"Pixel Aspect Ratio\") der Eingangs-Videodatei ?bernehmen"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:895
+msgid "<b>Sample Aspect Ratio</b>"
+msgstr "<b>Abfrage Seitenverh?ltnis (A/R)</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:870
-msgid "<b>Sample Aspect Ratio (A/R)</b>"
-msgstr "<b>Seitenverh?ltnisse (A/R)</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:892
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:922
 msgid "CABAC"
 msgstr "CABAC"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:895
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:925
 msgid "Lossless compression technique that reduces bitrate by approximately 10%. Increases encoding and decoding time."
 msgstr "Verlustlose Kompressionstechnik, die die Bitrate etwa um 10% reduziert. Vergr??ert den Kodier- und Dekodierzeitbedarf."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:898
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:932
 msgid "Trellis"
 msgstr "Trellis"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:907
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:941
 msgid "Use Trellis Rate Distortion Optimisation to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high."
 msgstr "Verzerrungsabh?ngige Quantization verwenden, um die optimale Kodierung f?r jeden Block zu finden. Wert 0 = deaktiviert, Wert 1 = normal, Wert 2 = hoch."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:914
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:948
 msgid "Noise Reduction"
 msgstr "Rauschreduktion"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:923
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:957
 msgid "Set the amount of noise reduction"
 msgstr "Betrag der Rauschreduktion setzen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:930
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:964
 msgid "Deblocking Filter"
 msgstr "Deblocking Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:933
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:967
 msgid "Enable in-loop deblocking to filter the video"
 msgstr "Aktiviert die 'in-loop' Deblockierung als Videofilter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:946
-msgid "Positive values will soften the video, negative values will sharpen."
-msgstr "Positive Werte zeichnen das Video weicher, negative Werte zeichnen es sch?rfer."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:976
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:401
+#: avidemux/ADM_filter/filter_declaration.cpp:189
+msgid "Threshold"
+msgstr "Schwelle"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:955
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:984
+msgid "Strength"
+msgstr "St?rke"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:998
 msgid "Threshold for block detection. Positive values will detect more blocks, negative values will detect less."
 msgstr "Schwellwert f?r Block-Erkennung. Positive Werte erkennen mehr Bl?cke, negative Werte erkennen weniger."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:958
-msgid "<i>Threshold</i>"
-msgstr "<i>Schwelle</i>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1007
+msgid "Positive values will soften the video, negative values will sharpen"
+msgstr "Positive Werte zeichnen das Video weicher, negative Werte zeichnen es sch?rfer"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:966
-msgid "<i>Strength</i>"
-msgstr "<i>St?rke</i>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:974
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1010
 msgid "<b>Misc. Options</b>"
 msgstr "<b>Sonstige Optionen</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1005
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1041
 msgid "8x8 Transform"
 msgstr "8x8 Transformation"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1008
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1044
 msgid "General block breakdown transformation"
 msgstr "Transformation von allgemeinen Blockunterteilungen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1011
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1047
 msgid "8x8, 8x16 and 16x8 P-frame search"
 msgstr "8x8, 8x16 und 16x8 P-Bild Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1014
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1050
 msgid "Improve the P-frame quality"
 msgstr "P-Bild Qualit?t verbessern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1017
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1053
 msgid "8x8, 8x16 and 16x8 B-frame search"
 msgstr "8x8, 8x16 und 16x8 B-Bild Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1020
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
 msgid "Improve the B-frame quality"
 msgstr "B-Bild Qualit?t verbessern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1023
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1059
 msgid "4x4, 4x8 and 8x4 P-frame search"
 msgstr "4x4, 4x8 und 8x4 P-Bild Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1026
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1062
 msgid "Further improve the P-frame quality"
 msgstr "P-Bild Qualit?t zus?tzlich verbessern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1028
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1064
 msgid "8x8 Intra search"
 msgstr "8x8 Intrablock Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1031
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1067
 msgid "Enable DCT Intra block search to improve quality"
 msgstr "Aktiviert DCT Intrablock-Suche, um die Qualit?t zu verbessern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1034
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1070
 msgid "4x4 Intra search"
 msgstr "4x4 Intrablock Suche"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1037
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1073
 msgid "Further enable DCT Intra block search to improve quality"
 msgstr "Aktiviert zus?tzliche DCT Intrablock-Suche, um die Qualit?t zu verbessern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1040
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1076
 msgid "<b>Partition Macroblocks</b>"
 msgstr "<b>Aufteilung Makrobl?cke</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1062
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1100
 msgid "Bias"
 msgstr "Tendenz (Bias)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1075
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1107
+msgid "Max Consecutive"
+msgstr "Max. Aufeinanderfolge"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1120
 msgid "Increase / decrease probability for how often B-frames are used. It will not violate the maximum consecutive frame limit."
 msgstr "Vergr??ern oder verkleinert die M?glichkeit, wie oft B-Bilder verwendet werden sollen. Dies verletzt nicht das Limit f?r die maximale Anzahl aufeinander folgender B-Bilder."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1129
 msgid "Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be dropped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality."
 msgstr "Die maximale Anzahl aufeinander folgender B-Bilder festlegen. Damit wird definiert, wieviele doppelte Bilder verworfen werden k?nnen. Zahlen 2 bis 5 werden empfohlen. Dies verbessert vor allem die Ausnutzung der Bitrate und die Qualit?t."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1087
-msgid "Max Consecutive"
-msgstr "Max. Aufeinanderfolge"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1098
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1143
 msgid "Bidirectional ME"
 msgstr "Bidirektionale ME"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1103
-msgid "Optimize both motion vectors in B-frames. This will improve quality but take more time for encoding."
-msgstr "Verbundene Optimierung beider Bewegungsvektoren in B-Bildern. Dadurch wird die Qualit?t verbessert, das Kodieren kostet aber mehr Zeit."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1148
+msgid "Optimise both motion vectors in B-frames. This will improve quality but take more time for encoding."
+msgstr "Optimierung beider Bewegungsvektoren in B-Bildern. Dadurch wird die Qualit?t verbessert, das Kodieren kostet aber mehr Zeit."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1105
-msgid "Weighted biprediction"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1150
+msgid "Weighted Biprediction"
 msgstr "Gewichtete Doppelvorhersage (Biprediction)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1110
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1155
 msgid "Enables weighting of B-frames to help fades"
 msgstr "Aktiviert die Gewichtung von B-Bildern als Hilfe f?r ?berblendungen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1158
 msgid "Adaptative DCT"
 msgstr "anpassungsf?higes DCT"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1118
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1163
 msgid "Use fewer B-frames if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames."
 msgstr "Weniger B-Bilder verwenden, wenn m?glich. Dies ist immer empfehlenswert. Andernfalls benutzt der Kodierer immer die maximale Anzahl aufeinander folgender B-Bilder."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1121
-msgid "Use as reference"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1166
+msgid "Use as Reference"
 msgstr "Als Referenz benutzen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1126
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1171
 msgid "Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"
 msgstr "Nichtlineare Referenzen von B-Bildern  zu anderen B-Bildern erlauben (anstatt doppelte Kopie zu erstellen)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1132
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1177
 msgid "B-Frame Direct Mode"
 msgstr "B-Bild Direktmodus"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1140
-msgid "Auto"
-msgstr "Auto"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1186
+msgid "Spatial"
+msgstr "r?umlich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1141
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1187
 msgid "Temporal"
 msgstr "zeitlich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1142
-msgid "Spatial"
-msgstr "r?umlich"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1188
+msgid "Auto"
+msgstr "Auto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1145
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1190
 msgid "<b>B-Frames</b>"
 msgstr "<b>B-Bilder</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1150
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1195
 msgid "Partitions & Frames"
 msgstr "Aufteilungen & Bilder"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1230
 msgid "Set how much \"bitrate bonus\" a keyframe can get"
 msgstr "Legt fest, wieviel \"Bitratenbonus\" ein Keyframe bekommen kann"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1186
-msgid "Keyframe boost (%)"
-msgstr "I-Bild (keyframe) Erh?hung (%)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1193
-msgid "B-frame reduction (%)"
-msgstr "B-frame Reduktion (%)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1200
-msgid "Bitrate variability (%)"
-msgstr "Bitrate Variablit?t (%)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1213
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1239
 msgid "Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"
 msgstr "Legt fest, wieviel von der Bitrate eines B-Bildes abgezogen wird im Vergleich zum vorherigen P-Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1222
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1248
 msgid "Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream."
 msgstr "Legt fest, wie stark die Bitrate ?ber das gesamte Video schwanken kann. 0% ergibt einen konstanten Bitratenstrom, w?hrend 100% einen richtigen qualit?tsbasierten Bitratenstrom ergibt."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1225
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1251
+msgid "Keyframe Boost (%)"
+msgstr "I-Bild (keyframe) Erh?hung (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1258
+msgid "B-frame Reduction (%)"
+msgstr "B-Bild Reduktion (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
+msgid "Bitrate Variability (%)"
+msgstr "Bitrate Variablit?t (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1272
 msgid "<b>Bitrate</b>"
 msgstr "<b>Bitrate</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1243
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1292
 msgid "Min QP"
 msgstr "Min QP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1250
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1299
 msgid "Max QP"
 msgstr "Max QP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1257
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1306
 msgid "Max QP Step"
 msgstr "Max QP Schritt"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1271
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1320
 msgid "Enforce a minimum quantizer level"
 msgstr "Minimale Quantizer-Ebene erzwingen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1280
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1329
 msgid "Enforce a maximum quantizer level"
 msgstr "Maximale Quantizer-Ebene erzwingen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1289
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1338
 msgid "Define how much the quantizer rate can change between two consecutive frames"
 msgstr "Legt fest, wie stark sich der Quantizer zwischen zwei aufeinander folgenden Bildern ?ndern darf."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1341
 msgid "<b>Quantization Limits</b>"
 msgstr "<b>Quantization Grenzen</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1310
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1368
+msgid "Increase / decrease sensitivity for detecting scene changes. Improves I-frame usage and quality."
+msgstr "Erh?ht / reduziert Empfindlichkeit, um Szenenwechsel festzustellen, die zu kompensieren sind. Verbessert die Verwendung von I-Bildern und hilft der Qualit?t."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1371
 msgid "Scene Cut Threshold"
 msgstr "Schwelle f?r Szenenschnitt"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1324
-msgid "Increase / decrease sensitivity for detecting scene changes. Improves I-frame usage and quality."
-msgstr "Erh?ht / reduziert Empfindlichkeit, um Szenenwechsel festzustellen, die zu kompensieren sind. Verbessert die Verwendung von I-Bildern und hilft der Qualit?t."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1327
-msgid "Min IDR frame interval"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1378
+msgid "Min IDR Frame Interval"
 msgstr "Min. IDR-Bild Intervall"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1340
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1391
 msgid "Set minimum frame interval between IDR frames. Defines the minimum amount a frame can be reused and referenced by other frames before a new IDR frame is established."
 msgstr "Setzt das kleinste Bildintervall zwischen IDR-Bildern. Definiert den kleinsten Betrag, den ein Bild durch andere Bilder wieder verwenden und referenzieren kann, bevor ein komplettes Bild kommt."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1349
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1400
 msgid "Set maximum frame interval between IDR frames. Defines the maximum amount a frame can be reused and referenced by other frames before a new IDR frame is established."
 msgstr "Setzt das gr??te Bildintervall zwischen IDR-Bildern. Definiert den gr??ten Betrag, den ein Bild durch andere Bilder wieder verwenden und referenzieren kann, bevor ein komplettes Bild kommt."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1352
-msgid "Max IDR frame interval"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1403
+msgid "Max IDR Frame Interval"
 msgstr "Max. IDR-Bild Intervall"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1359
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1410
 msgid "<b>More Rate Settings</b>"
 msgstr "<b>Mehr Bitraten-Einstellungen</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1377
-msgid "VBV buffer size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1430
+msgid "VBV Buffer Size"
 msgstr "VBV Puffergr??e"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1384
-msgid "Initial VBV buffer (%)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1437
+msgid "Initial VBV Buffer (%)"
 msgstr "Anf?nglicher VBV Puffer (%)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1391
-msgid "Maximum local bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1444
+msgid "Maximum Local Bitrate"
 msgstr "Maximale lokale Bitrate (kbit/s)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1422
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1475
 msgid "<b>Video Buffer Verifier</b>"
 msgstr "<b>Video Puffer Pr?fung</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1427
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1480
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:117
 msgid "Rate Control"
 msgstr "Bitraten-Kontrolle"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1459
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1508
+msgid "Bitrate Variance"
+msgstr "Bitrate Varianz"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1521
 msgid "Allowed variance of average bitrate. Lower values mean less variance. Higher values mean more variance."
 msgstr "Erlaubte Varianz der durchschnittl. Bitrate. Niedrigere Werte bedeuten weniger Varianz. H?here Werte bedeuten mehr Varianz."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1462
-msgid "Bitrate Variance"
-msgstr "Bitrate Varianz"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1475
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1530
 msgid "Allowed variance of average quantizer or quality. Lower values mean less variance. Higher values mean more variance. Note that 0 means constant quality while 1 means constant fluctuation. Recommended 0.6."
 msgstr "Erlaubte Varianz des durchschnittl. Quantizers. Niedrigere Werte bedeuten weniger Varianz. H?here Werte bedeuten mehr Varianz. Hierbei bedeutet 0 konstanter Quantizer, w?hrend 1 konstante Schwankungen bedeutet. Empfohlener Wert ist 0.6"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1539
 msgid "Reduced fluctuations in Quantizer (before curve compression)"
 msgstr "Schwankungen des Quantizer reduzieren (vor der Kurvenkompression)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1493
-msgid "Reduce fluctuations in Quantizer (after curve compression)"
-msgstr "Schwankungen des Quantizer reduzieren (nach der Kurvenkompression)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1496
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1550
 msgid "Quantizer Compression"
 msgstr "Quantizer Kompression"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1503
-msgid "Temp. Blur of est Frame Complexity"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1557
+msgid "Temp. Blur of Est. Frame Complexity"
 msgstr "Temp. Weichzeichnen der gesch?tzten Bildkomplexit?t"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1510
-msgid "Temp. Blur of Quant after CC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1564
+msgid "Temp. Blur of Quant. after CC"
 msgstr "Temp. Weichzeichnen der Quant. nach CC"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1517
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1571
 msgid "<b>Misc</b>"
 msgstr "<b>Verschiedenes</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1541
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1597
 msgid "Quantization factors used between I and P-frames"
 msgstr "Diese Quantization-Faktoren zwischen I- und P-Bildern verwenden"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1550
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1606
 msgid "Quantization used between P and B-frames"
 msgstr "Diese Quantization-Faktoren zwischen P- und B-Bildern verwenden"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1559
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1615
 msgid "Quantization difference between chroma (color) and luma (brightness)"
 msgstr "Quantization-Unterschied zwischen Farbintensit?t (Farbe) and Brillianz (Helligkeit)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1562
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1618
 msgid "Factor between I and P-frame Quants"
 msgstr "Faktor zwischen I- und P-Bild Quantization"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1569
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1625
 msgid "Factor between P and B-frame Quants"
 msgstr "Faktor zwischen P- und B-Bild Quantization"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1576
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1632
 msgid "Chroma QP Offset"
 msgstr "Farbintensit?t QP Offset"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1639
 msgid "<b>Quantizers</b>"
 msgstr "<b>Quantizer</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1601
-msgid "Custom matrix"
-msgstr "Individuelle Matrix"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1657
+msgid "Flat Matrix"
+msgstr "breite Matrix"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1616
-msgid "JVT matrix"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1664
+msgid "JVT Matrix"
 msgstr "JVT Matrix"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1624
-msgid "Flat matrix"
-msgstr "breite Matrix"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1674
+msgid "Custom Matrix"
+msgstr "Individuelle Matrix"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1638
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1695
 msgid "Edit loaded custom quantization matrix file"
 msgstr "Geladene individuelle Quantization-Matrixdatei bearbeiten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1646
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1697
 msgid "<b>Quantization Matrices</b>"
 msgstr "<b>Quantization Matrizen</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1651
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1702
 msgid "More"
 msgstr "Mehr"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1659
-msgid "Defaults"
-msgstr "Voreinstellungen"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1710
+msgid "_Defaults"
+msgstr "Vor_einstellungen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
 msgid "Chroma Noise Reduction 2"
@@ -1871,9 +2032,8 @@
 msgstr "Band"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:67
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:71
-msgid "ASHARP"
-msgstr "ASHARP"
+msgid "Chroma Shift"
+msgstr "Farbintensit?ts-Verschiebung"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:184
 msgid "ChromaShift"
@@ -2396,6 +2556,10 @@
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr "Parameter eingeben (z.B. -b 192 -m -s ...)"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:71
+msgid "ASHARP"
+msgstr "ASHARP"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:183
 msgid "ASharp by MarcFD"
 msgstr "ASharp von MarcFD"
@@ -2466,11 +2630,6 @@
 msgid "Output container format"
 msgstr "Ausgabe-Container-Format"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
-msgid "MPEG"
-msgstr "MPEG"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
 msgid "Total size"
 msgstr "Gesamtgr??e"
@@ -2930,57 +3089,6 @@
 msgid "Font Size:"
 msgstr "Schriftgr??e:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-msgid "Select Video to Write"
-msgstr "Zu schreibendes Video ausw?hlen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Invalid filename"
-msgstr "Ung?ltiger Dateiname"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename."
-msgstr "Bitte g?ltigen Dateinamen ausw?hlen oder eingeben."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Invalid jobname"
-msgstr "Ung?ltiger Job-Name"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname."
-msgstr "Bitte g?ltigen Jobnamen ausw?hlen oder eingeben."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
-msgid "Save Job"
-msgstr "Job speichern"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
-msgid "Select the output file"
-msgstr "Ausgabe-Datei ausw?hlen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:553
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
-msgid "_Browse..."
-msgstr "_Auflisten..."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
-msgid "Job name displayed in the job list and used as the script filename"
-msgstr "Jobname, der in der Job-Liste angezeigt und als Script-Dateiname verwendet wird "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
-msgid "Filename of the audio/video output"
-msgstr "Dateiname f?r die Audio/Video Ausgabe"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
-msgid "_Job name:"
-msgstr "_Job Name:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
-msgid "Output _file:"
-msgstr "Ausgabe _Datei:"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:93
 msgid "Paused"
 msgstr "Pausierend"
@@ -3011,246 +3119,60 @@
 msgid "Configure codec"
 msgstr "Konfiguriere Codec"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:200
 #: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:163
 msgid "Threshold Configuration"
 msgstr "Schwellen-Konfiguration"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:272
-#: avidemux/ADM_filter/filter_declaration.cpp:189
-msgid "Threshold"
-msgstr "Schwelle"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:294
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:423
 msgid "Minimum value to be in-range:"
 msgstr "Minimaler Wert f?r den Innenbereich:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:327
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:456
 msgid "Maximum value to be in-range:"
 msgstr "Maximale Wert f?r den Innenbereich:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:358
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:487
 msgid "Output values:   "
 msgstr "Ausgabewerte:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:365
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:494
 msgid "In-range values go black, out-of-range values go white"
 msgstr "Werte im Innenbereich werden schwarz, Werte au?erhalb werden wei?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:366
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:495
 msgid "In-range values go white, out-of-range values go black"
 msgstr "Werte im Innenbereich werden wei?, Werte au?erhalb werden schwarz"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:372
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:501
 msgid "Debugging settings (bits):   "
 msgstr "Fehlersuche Einstellungen (bits):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:404
-msgid "Threshold output"
-msgstr "Schwelle f?r Augabe"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:405
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1366
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:609
-msgid "Final output"
-msgstr "Endg?ltige Ausgabe"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:405
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:380
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:505
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:388
 msgid "Swiss Army Knife Configuration"
 msgstr "\"Swiss Army Knife\" Konfiguration"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:898
-#: avidemux/ADM_filter/filter_declaration.cpp:188
-msgid "Swiss Army Knife"
-msgstr "Swiss Army Knife"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:925
-msgid "Select _Operation on each pixel P and input A:   "
-msgstr "_Operation f?r jedes Pixel P und Eingang A ausw?hlen:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:937
-msgid "Input _Type:   "
-msgstr "Eingangs_typ:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:956
-msgid "Input _File (convolution kernel):   "
-msgstr "Eingangs_datei (Faltungsfilter):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:960
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:975
-msgid "Select Convolution Kernel File"
-msgstr "Faltungsfilter-Datei ausw?hlen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:971
-msgid "Input _File (image file):   "
-msgstr "Eingangs_datei (Bilddatei):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:997
-msgid "First, _add to each float pixel value:   "
-msgstr "Zuerst, _addiere jeden flie?enden Pixelwert:  "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1011
-msgid "Then, _multiply each float pixel value by:   "
-msgstr "Dann, _vervielf?ltige jeden flie?enden Pixelwert um:  "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1025
-msgid "Mi_nimum loaded pixel value (will be scaled to 0):"
-msgstr "Mi_nimaler Wert f?r geladene Pixel (voreingestellt auf 0):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1051
-msgid "Ma_ximum loaded pixel value (will be scaled to 255):"
-msgstr "Ma_ximaler Wert f?r geladene Pixel (voreingestellt auf 255):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1073
-msgid "Pixel Value Scaling as Image File is Loaded"
-msgstr "Pixelwert-Einstellung so wie die Bilddatei geladen wurde"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1085
-msgid "Input _Constant:      "
-msgstr "Eingangs_konstante:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1102
-msgid "Memory constant _alpha:   "
-msgstr "Speicherkonstante _Alpha:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1112
-msgid " = 1 / "
-msgstr " = 1 / "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1130
-msgid "_Initial average (\"head start\") is "
-msgstr "Anfangsdurchschnitt (\"head start\") ist "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1137
-msgid "straight"
-msgstr "gerade / original"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1138
-msgid "rolling"
-msgstr "Rollen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1140
-msgid " average"
-msgstr " Durchschnitt"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1148
-msgid "      of frames "
-msgstr "      Bilder"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1158
-msgid " through "
-msgstr " durch "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1176
-msgid "Integer _Bias (will be added to result of selected operation):"
-msgstr "Ganzzahlige Tendenz (_Bias) (wird zum Ergebnis addiert):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1216
-msgid "First, _add to each pixel result value:   "
-msgstr "Zuerst, _addiere jeden Pixel-Ergebniswert:   "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1230
-msgid "Then, _multiply each pixel result value by:   "
-msgstr "Dann, _vervielf?ltige jeden Pixel-Ergebniswert um:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1244
-msgid "Mi_nimum result value (will be scaled to 0):"
-msgstr "Mi_nimaler Ergebniswert (voreingestellt auf 0):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1270
-msgid "Ma_ximum result value (will be scaled to 255):"
-msgstr "Ma_ximaler Ergebniswert (voreingestellt auf 255):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1292
-msgid "Pixel Value Scaling on Result of Selected Operation"
-msgstr "Pixelwert-Einstellung als Ergebnis der ausgew?hlten Operation"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1301
-msgid "(description of current config will go here)"
-msgstr "(Beschreibung der aktuellen Konfiguration kommt hierher)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1318
-msgid "_Histogram every N frames (0 to disable):   "
-msgstr "_Histogramm alle N Bilder (0 zum Deaktivieren):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1332
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:575
-msgid "_Debugging settings (bits):   "
-msgstr "_Fehlersuche Einstellungen (bits):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1365
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:608
-msgid "Swiss Army Knife output"
-msgstr "\"Swiss Army Knife\" Ausgabe"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1390
-msgid "Enable Preview"
-msgstr "Vorschau aktivieren"
-
 # Teile = Gruppe von Pixeln
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:197
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:269
 msgid "Particle Analysis Configuration"
 msgstr "Konfiguration der Teileanalyse"
 
-# Teile = Gruppe von Pixeln
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:412
-msgid "Particle Detection"
-msgstr "Teile-Erkennung"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:439
-msgid "Mi_nimum area for a particle to be detected:    "
-msgstr "Mi_nimaler Bereich f?r ein Teil, um es zu erkennen:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:453
-msgid "Ma_ximum area for a particle to be detected:   "
-msgstr "Ma_ximaler Bereich f?r ein Teil, um es zu erkennen:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:471
-msgid "_Left side crop (ignore this many pixels on the left):        "
-msgstr "_Linksseitiges Zuschneiden (ignoriert weiter links liegende Pixel):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:485
-msgid "_Right side crop (ignore this many pixels on the right):     "
-msgstr "_Rechtsseitiges Zuschneiden (ignoriert weiter rechts liegende Pixel):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:499
-msgid "_Top crop (ignore this many pixels on the top):                  "
-msgstr "_Oberes Zuschneiden (ignoriert diese Anzahl Pixel am oberen Rand):     "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:513
-msgid "_Bottom crop (ignore this many pixels on the bottom):   "
-msgstr "_Unteres Zuschneiden (ignoriert weiter unten liegende Pixel):"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:531
-msgid "Output _Format:   "
-msgstr "Ausgabe_format:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:543
-#: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:191
-msgid "_Output File:"
-msgstr "_Ausgabedatei:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:561
-msgid "_Camera Number for output file:      "
-msgstr "_Kamera Nummer f?r die Ausgabedatei:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:438
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:543
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:380
 msgid "Input"
 msgstr "Eingang"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:439
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:544
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:384
 msgid "Output"
 msgstr "Ausgabe"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:440
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:545
 msgid "Side"
 msgstr "Seitlich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:441
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:546
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
@@ -3258,11 +3180,11 @@
 msgid "Top"
 msgstr "Oben"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:442
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:547
 msgid "Separate"
 msgstr "Trennen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:621
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:721
 #, c-format
 msgid "Frame:%c(%02d)"
 msgstr "Bild:%c(%02d)"
@@ -3620,11 +3542,6 @@
 msgid "Bitrate/size calculator"
 msgstr "Bitrate/Gr??e berechnen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1081
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1121
-msgid "Copy"
-msgstr "Kopie"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1086
 msgid "Configure video encoder"
 msgstr "Video Kodierer konfigurieren"
@@ -3767,6 +3684,11 @@
 msgid " 0000000"
 msgstr " 0000000"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
+msgid "_Browse..."
+msgstr "_Auflisten..."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:99
 msgid "_Encoding mode:"
 msgstr "Kodi_er-Modus:"
@@ -3779,27 +3701,27 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:123
 msgid "Single pass - bitrate"
-msgstr "Einmaliger Lauf - Bitrate"
+msgstr "Einfach-Durchlauf - Bitrate"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:125
 msgid "Single pass - constant quality"
-msgstr "Einmaliger Lauf - konstanter Quantizer"
+msgstr "Einfach-Durchlauf - konstanter Quantizer"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:127
 msgid "Single pass - same qz as input"
-msgstr "Einmaliger Lauf - gleicher Quantizer wie Eingang"
+msgstr "Einfach-Durchlauf - gleicher Quantizer wie Eingang"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:129
 msgid "Single pass - Average quantizer"
-msgstr "Einmaliger Lauf - durchschnittl. Quantizer"
+msgstr "Einfach-Durchlauf - durchschnittl. Quantizer"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:132
 msgid "Two pass - video size"
-msgstr "Zwei Durchl?ufe - Videogr??e"
+msgstr "Zweifach-Durchlauf - Videogr??e"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:134
 msgid "Two pass - average bitrate"
-msgstr "Zwei Durchl?ufe - durchschnittl. Bitrate"
+msgstr "Zweifach-Durchlauf - durchschnittl. Bitrate"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:273
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:61
@@ -4185,6 +4107,18 @@
 msgid "Interlaced BFF"
 msgstr "BBF-Halbbildmodus (interlaced)"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:63
+msgid "VCD 40 kB"
+msgstr "VCD 40 kB"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:64
+msgid "SVCD 112 kB"
+msgstr "SVCD 112 kB"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:65
+msgid "DVD 224 kB"
+msgstr "DVD 224 kB"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:70
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:60
 msgid "Ma_x. bitrate:"
@@ -4309,14 +4243,6 @@
 msgid "Video Codecs"
 msgstr "Video Kodierer"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
-msgid "Xvid"
-msgstr "Xvid"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
-msgid "x264"
-msgstr "x264"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
 msgid "Audio Codecs"
 msgstr "Audio Kodierer"
@@ -4629,6 +4555,7 @@
 msgstr "Anzeigestufe f?r Meldungen:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:486
 msgid "PCM"
 msgstr "PCM"
 
@@ -4861,12 +4788,12 @@
 msgstr "libavcodec MPEG-4 Konfiguration"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:37
-msgid "_Swap U&V:"
-msgstr "U&V tau_schen:"
+msgid "_Swap U&V"
+msgstr "U&V tau_schen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:39
-msgid "Mjpeg Configuration"
-msgstr "Mjpeg Konfiguration"
+msgid "MJPEG Configuration"
+msgstr "MJPEG Konfiguration"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_requant.cpp:48
 msgid "_Shrink Factor:"
@@ -5316,6 +5243,26 @@
 msgid "FLV1 Configuration"
 msgstr "FLV1 Konfiguration"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:6
+msgid "_Job name:"
+msgstr "_Job Name:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+msgid "Output _File:"
+msgstr "Ausgabe_datei:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+msgid "Select Video To Write"
+msgstr "Zu schreibendes Video ausw?hlen"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:10
+msgid "Save Job"
+msgstr "Job speichern"
+
+#: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
+msgid "Smart Copy"
+msgstr "Sanftes Kopieren"
+
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:121
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:96
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:98
@@ -5323,6 +5270,13 @@
 msgid "Cannot initiate save"
 msgstr "Kann das Speichern nicht beginnen"
 
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:134
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:109
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:111
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:223
+msgid "Saving"
+msgstr "Speichern"
+
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
 msgid ""
 "Width is not a multiple of 8\n"
@@ -5349,11 +5303,30 @@
 "\n"
 " Vorhandene Log-Datei wieder verwenden ?"
 
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:136
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:410
+msgid "1st Pass"
+msgstr "1. Durchlauf"
+
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:152
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:437
 msgid "Aborting"
 msgstr "Abbruch"
 
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:207
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
+msgid "Encoding"
+msgstr "Kodieren"
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:250
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:467
+msgid "2nd Pass"
+msgstr "2. Durchlauf"
+
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:75
 msgid "Mux every N video frames"
 msgstr "Multiplexe jedes n-te Video-Bild"
@@ -5390,6 +5363,66 @@
 msgid "Error initalizing video filters"
 msgstr "Fehler beim Initialisieren der Videofilter"
 
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:485
+msgid "DTS"
+msgstr "DTS"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:487
+msgid "MP2"
+msgstr "MP2"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:488
+msgid "MP3"
+msgstr "MP3"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:489
+msgid "WMA"
+msgstr "WMA"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:490
+msgid "LPCM"
+msgstr "LPCM"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:491
+msgid "AC3"
+msgstr "AC3"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:492
+msgid "Ogg Vorbis"
+msgstr "Ogg Vorbis"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:494
+msgid "AAC"
+msgstr "AAC"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:495
+msgid "QDM2"
+msgstr "QDM2"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:496
+msgid "AMR-NB"
+msgstr "AMR-NB"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:497
+msgid "MSADPCM"
+msgstr "MSADPCM"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:498
+msgid "ULAW"
+msgstr "ULAW"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:499
+msgid "IMA ADPCM"
+msgstr "IMA ADPCM"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:500
+msgid "8-bit PCM"
+msgstr "8-bit PCM"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:502
+msgid "Unknown codec"
+msgstr "Unbekannter Codec"
+
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
@@ -5428,6 +5461,14 @@
 msgid "Cannot initialize the audio stream"
 msgstr "Konnte Audio-Stream nicht initialisieren"
 
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:111
+msgid "Pass one"
+msgstr "Durchlauf 1"
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:139
+msgid "Pass 2"
+msgstr "Durchlauf 2"
+
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:126
 msgid "Could not initialize video"
 msgstr "Kann Video nicht initialisieren"
@@ -5436,6 +5477,10 @@
 msgid "Could not initialize audio"
 msgstr "Kann Audio nicht initialisieren"
 
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:70
+msgid "Saving..."
+msgstr "Speichern..."
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:142
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:153
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:94
@@ -5456,14 +5501,74 @@
 msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
 msgstr "F?r DVD muss Audio 48 kHz MP2, AC3 oder LPCM sein."
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:260
+msgid "libmpeg2enc VCD"
+msgstr "libmpeg2enc VCD"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:263
+msgid "libmpeg2enc SVCD"
+msgstr "libmpeg2enc SVCD"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:266
+msgid "libmpeg2enc DVD"
+msgstr "libmpeg2enc DVD"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:269
+msgid "FFmpeg MPEG-1 VBR"
+msgstr "FFmpeg MPEG-1 VBR"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:272
+msgid "FFmpeg MPEG-2 SVCD VBR"
+msgstr "FFmpeg MPEG-2 SVCD VBR"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:275
+msgid "FFmpeg MPEG-2 DVD VBR"
+msgstr "FFmpeg MPEG-2 DVD VBR"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:278
+msgid "MPEG Requantizer"
+msgstr "MPEG Requantizer"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:286
+msgid "MPEG ES"
+msgstr "MPEG ES"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:287
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:230
+msgid "MPEG TS"
+msgstr "MPEG TS"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:288
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:231
+msgid "MPEG VCD"
+msgstr "MPEG VCD"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:289
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:232
+msgid "MPEG SVCD"
+msgstr "MPEG SVCD"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:290
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:233
+msgid "MPEG DVD"
+msgstr "MPEG DVD"
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:305
 msgid "Reuse log file ?"
 msgstr "Log-Datei wieder verwenden?"
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:311
+msgid "Pass 1/2"
+msgstr "Durchlauf 1/2"
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:320
 msgid "Error in pass 1"
 msgstr "Fehler beim 1. Durchlauf"
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:371
+msgid "Pass 2/2"
+msgstr "Durchlauf 2/2"
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:463
 msgid "Error in pass 2"
 msgstr "Fehler beim 2. Durchlauf"
@@ -5488,6 +5593,10 @@
 msgid "For DVD, audio must be 48 kHz MP2(stereo), AC3, DTS or LPCM (stereo)."
 msgstr "F?r DVD muss Audio 48 kHz MP2 (stereo), AC3, DTS or LPCM (stereo) sein."
 
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:222
+msgid "---"
+msgstr "---"
+
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
 msgid "Unsupported video"
 msgstr "Nicht unterst?tztes Video"
@@ -5509,6 +5618,10 @@
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
 msgstr "Frequenz muss 44100, 22050 oder 11025 Hz sein."
 
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:140
+msgid "Dummy"
+msgstr "Dummy"
+
 #: avidemux/ADM_filter/filter_saveload.cpp:155
 msgid "Problem reading XML filters"
 msgstr "Problem beim Lesen von XML Filter"
@@ -5766,7 +5879,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:99
 msgid "Put botj fields side by side."
-msgstr ""
+msgstr "botj Felder nebeneinander setzen."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:102
 msgid "Stack fields"
@@ -5774,7 +5887,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:102
 msgid "Put two fields on top of one another."
-msgstr ""
+msgstr "Zwei Felder ?ber ein ein anderes."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:103
 msgid "Unstack fields"
@@ -5782,7 +5895,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:103
 msgid "Interleave top and bottom part of the picture."
-msgstr ""
+msgstr "Oberen und unteren Teil des Bildes ?berlappen."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:107
 msgid "Adjust contrast, brightness, saturation and gamma."
@@ -5822,7 +5935,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:113
 msgid "Shift chroma U/V to fix badly synced luma/chroma."
-msgstr ""
+msgstr "Farbintensit?t U/V verschieben bei schlecht synchronisierter Intensit?t/Brillianz."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:115
 msgid "Luma only"
@@ -5862,7 +5975,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:120
 msgid "Alter colors (auto white balance etc...). Ported from Avisynth."
-msgstr ""
+msgstr "Farben ?ndern (autom. Wei?-Abgleich usw...). Von Avisynth ?bernommen."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:130
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:80
@@ -5883,13 +5996,13 @@
 msgstr "Qualitativ hochwertige Version des \"denoise3d\" Rauschfilter. Langsamer, aber pr?ziser."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr "FluxSmooth"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
 msgid "Spatio-temporal cleaner by Ross Thomas."
-msgstr ""
+msgstr "R?umlich-zeitliches S?ubern von Ross Thomas."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:134
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:106
@@ -5919,7 +6032,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:139
 msgid "Chroma noise reduction filter by MarcFD/Tritical."
-msgstr ""
+msgstr "Farbintensit?ts-Rauschreduktionsfilter von MarcFD/Tritical."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:141
 msgid "MSmooth by Donald Graft"
@@ -6038,7 +6151,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:177
 msgid "Remove blend between previous and next picture."
-msgstr ""
+msgstr "?berblendung zwischen vorherigem und n?chstem Bild entfernen."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:178
 msgid "Hard pulldown removal"
@@ -6071,7 +6184,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:181
 msgid "Blend a logo by interpolating its surrounding box."
-msgstr ""
+msgstr "Logo einblenden durch Interpolieren der Surrounding Box."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:182
 #: avidemux/ADM_videoFilter/ADM_vidLogo.cpp:95
@@ -6107,6 +6220,10 @@
 msgstr "Entfernen beliebiger Bereiche in jedem Bild"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:188
+msgid "Swiss Army Knife"
+msgstr "Swiss Army Knife"
+
+#: avidemux/ADM_filter/filter_declaration.cpp:188
 msgid "Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant"
 msgstr ""
 
@@ -6155,18 +6272,18 @@
 msgstr "VBR Zeitkarte erstellen?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
-msgstr "Benutze diesen Modus"
+msgid "Use safe mode"
+msgstr "Sicheren Modus benutzen"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
-msgstr "H264 gefunden"
+msgid "H.264 detected"
+msgstr "H.264 gefunden"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
 "Wenn die Datei B-Bilder als Referenz verwendet, kann das zum Absturz oder Stottern \n"
 "f?hren. Avidemux kann einen anderen Modus verwenden, der sicher ist, aber \n"
@@ -6213,7 +6330,7 @@
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "Werkzeuge -> Bilder neu erstellen sollte verwendet werden. Starten ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1510
+#: avidemux/ADM_editor/ADM_edit.cpp:1517
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -6221,7 +6338,7 @@
 "Dies schaut wie Mpeg aus\n"
 "Soll ein Index erstellt werden ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1562
+#: avidemux/ADM_editor/ADM_edit.cpp:1569
 msgid "Indexing failed"
 msgstr "Indizierung gescheitert"
 
@@ -6780,11 +6897,11 @@
 msgid "Show _frame"
 msgstr "_Bild anzeigen"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 msgid "_Temporal threshold:"
 msgstr "Zei_tliche Schwelle:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 msgid "_Spatial threshold:"
 msgstr "R?umliche _Schwelle:"
 
@@ -6981,6 +7098,11 @@
 msgstr "_Endbild (Letztes Bild # im Durchschnitt zu ber?cksichtigen), -1=letztes:"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:191
+msgid "_Output File:"
+msgstr "_Ausgabedatei:"
+
+#: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
 msgid "Select output file"
 msgstr "Ausgabe-Datei ausw?hlen"
 
@@ -7053,7 +7175,7 @@
 msgstr "_Unteres Abschneiden (ignoriert innenliegende Teile):"
 
 #: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:191
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:321
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
 #: avidemux/gtk_gui.cpp:2016
 #: avidemux/gtk_gui.cpp:2113
 msgid "Select file"
@@ -7064,87 +7186,87 @@
 msgstr "_Kamera Nummer:"
 
 #: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:196
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:371
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:378
 #: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:159
 #: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:255
 msgid "_Debugging settings (bits):"
 msgstr "_Fehlersuche Einstellungen (bits):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:258
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
 msgid "P' = A"
 msgstr "P' = A"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:259
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:262
 msgid "P' = P"
 msgstr "P' = P"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:260
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:263
 msgid "P' = P - A"
 msgstr "P' = P - A"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:264
 msgid "P' = A - P"
 msgstr "P' = A - P"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:262
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:265
 msgid "P' = P + A"
 msgstr "P' = P + A"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:263
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:266
 msgid "P' = P * A"
 msgstr "P' = P * A"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:264
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:267
 msgid "P' = P / A"
 msgstr "P' = P / A"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:265
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:268
 msgid "P' = A / P"
 msgstr "P' = A / P"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:266
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:269
 msgid "P' = min (P, A)"
 msgstr "P' = min (P, A)"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:267
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:270
 msgid "P' = max (P, A)"
 msgstr "P' = max (P, A)"
 
 # Convolution, im folgenden nur noch Faltung genannt, ist eine zweistellige Operation auf Funktionen. Sie bildet zwei Funktionen f und g auf eine neue Funktion, bezeichnet f*g, ab.
 # Hier ist f die Bildinformation (= image) und g den Bildfilter (= kernel).
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:272
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:275
 msgid "A = convolve(P); Load convolution kernel from file"
 msgstr "A = falten(P); L?dt den Faltungsfilter aus einer Datei"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:274
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:277
 msgid "A = pixel from image file as float; Load image from file"
 msgstr "A = Pixel der Bilderdatei im Fluss; L?dt Bild aus Datei"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:276
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:279
 msgid "A = pixel from image file as integer; Load image from file"
 msgstr "A = Pixel der Bilderdatei als Ganzes; L?dt das Bild aus der Datei"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:278
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:281
 msgid "A = floating point constant value"
 msgstr "A = Flie?kommazahl mit konstantem Wert"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:280
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:283
 msgid "A = rolling average of pixel: A = A*(1-alpha)+(P*alpha)"
 msgstr "A = gleitender Pixel-Durchschnitt: A = A*(1-alpha)+(P*alpha)"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:285
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:288
 msgid "Select _Operation on each pixel P and input A:"
 msgstr "_Operation ausw?hlen f?r jedes Pixel P und Eingang A:"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:290
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:293
 msgid "Input _Type:"
 msgstr "Eingangs_typ:"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:321
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
 msgid "Input _File (image or convolution kernel):"
 msgstr "Eingangs_datei (Bild oder Faltungsfilter):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:327
 msgid ""
 "_Load Bias (added to each pixel\n"
 "in file image when loaded):"
@@ -7152,7 +7274,7 @@
 "Tendenz (Bias) _laden (wird zu jedem Pixel eines Bildes\n"
 "in der Datei beim Laden addiert):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:329
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:332
 msgid ""
 "Load _Multiplier (each pixel in\n"
 "file image mult. by this when loaded):"
@@ -7160,39 +7282,43 @@
 "_Multiplikator laden (jedes Pixel in der\n"
 "Bilddatei wird damit beim Laden multipliziert):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:335
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:338
 msgid "Input _Constant:"
 msgstr "Eingangs_kontrast:"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:339
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:342
 msgid ""
 "Memory constant _alpha\n"
-"(where A = (1-alpha)*A + alpha*curr_frame):"
+"(where A = (1-alpha)*A + alpha*(curr_frame + lookahead)):"
 msgstr ""
 "Speicherkonstante _alpha\n"
-"(mit A = (1-alpha)*A + alpha*curr_frame):"
+"(mit A = (1-alpha)*A + alpha*(curr_frame + lookahead)):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:344
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:347
+msgid "Look ahead _N frames:"
+msgstr "Vorausschauen _N Bilder:"
+
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:351
 msgid "Init _Start Frame (first frame # to use for head start):"
 msgstr "Init _Start-Bild (erstes Bild # f?r Kopfstart verwenden):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:348
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:355
 msgid "Init _End Frame (last frame # to use for head start):"
 msgstr "Init _Ende-Bild (letztes Bild # f?r Kopfstart verwenden):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:352
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:359
 msgid "Init By _Rolling (compute head start using a rolling average rather than a straight average)"
 msgstr "Init _Gleitend (Kopfstart wird besser durch gleitender Durchschnitt als durch linearen Durchschnitt berechnet)"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:357
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:364
 msgid "_Bias (will be added to result):"
 msgstr "Tendenz (_Bias) (wird zum Ergebnis addiert):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:360
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:367
 msgid "_Result Bias (added to each result pixel):"
 msgstr "E_rgebnis Bias (wird zu jedem Ergebnispixel addiert):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:364
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:371
 msgid ""
 "Result _Multiplier (each result pixel\n"
 "multiplied by this):"
@@ -7200,7 +7326,7 @@
 "Entg?ltiger Multiplikator (jedes Ergebnis-Pixel\n"
 "wird damit multipliziert):"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:369
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:376
 msgid "_Histogram every N frames (0 to disable):"
 msgstr "_Histogramm alle N Bilder (0 zum Deaktivieren):"
 
@@ -7381,6 +7507,10 @@
 msgid "At the moment, the DV codec only accepts 720*576 at 25"
 msgstr "Derzeit akzeptiert der DV Codec nur 720*576 at 25"
 
+#: avidemux/ADM_encoder/adm_encRequant.cpp:98
+msgid "Requant"
+msgstr "Requantisieren"
+
 #: avidemux/ADM_encoder/adm_encConfig.cpp:192
 msgid "Wrong output format"
 msgstr "Falsches Ausgabeformat"
@@ -7484,7 +7614,7 @@
 msgid "No stts table"
 msgstr "Keine stts Tabelle"
 
-#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:589
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:594
 msgid "Problem reading SVQ3 headers"
 msgstr "Problem beim Lesen der SVQ3 Kopfzeilen"
 
@@ -8116,6 +8246,124 @@
 "Eventuell ist sanftes Kopieren erforderlich.\n"
 " Aktivieren?"
 
+#~ msgid "Invalid filename"
+#~ msgstr "Ung?ltiger Dateiname"
+#~ msgid "Please select or enter a valid filename."
+#~ msgstr "Bitte g?ltigen Dateinamen ausw?hlen oder eingeben."
+#~ msgid "Invalid jobname"
+#~ msgstr "Ung?ltiger Job-Name"
+#~ msgid "Please select or enter a valid jobname."
+#~ msgstr "Bitte g?ltigen Jobnamen ausw?hlen oder eingeben."
+#~ msgid "Select the output file"
+#~ msgstr "Ausgabe-Datei ausw?hlen"
+#~ msgid "Job name displayed in the job list and used as the script filename"
+#~ msgstr ""
+#~ "Jobname, der in der Job-Liste angezeigt und als Script-Dateiname "
+#~ "verwendet wird "
+#~ msgid "Filename of the audio/video output"
+#~ msgstr "Dateiname f?r die Audio/Video Ausgabe"
+#~ msgid "As input"
+#~ msgstr "Wie Eingang"
+#~ msgid "Mjpeg Configuration"
+#~ msgstr "Mjpeg Konfiguration"
+#~ msgid "Threshold output"
+#~ msgstr "Schwelle f?r Augabe"
+#~ msgid "Final output"
+#~ msgstr "Endg?ltige Ausgabe"
+#~ msgid "Select _Operation on each pixel P and input A:   "
+#~ msgstr "_Operation f?r jedes Pixel P und Eingang A ausw?hlen:"
+#~ msgid "Input _Type:   "
+#~ msgstr "Eingangs_typ:"
+#~ msgid "Input _File (convolution kernel):   "
+#~ msgstr "Eingangs_datei (Faltungsfilter):"
+#~ msgid "Select Convolution Kernel File"
+#~ msgstr "Faltungsfilter-Datei ausw?hlen"
+#~ msgid "Input _File (image file):   "
+#~ msgstr "Eingangs_datei (Bilddatei):"
+#~ msgid "First, _add to each float pixel value:   "
+#~ msgstr "Zuerst, _addiere jeden flie?enden Pixelwert:  "
+#~ msgid "Then, _multiply each float pixel value by:   "
+#~ msgstr "Dann, _vervielf?ltige jeden flie?enden Pixelwert um:  "
+#~ msgid "Mi_nimum loaded pixel value (will be scaled to 0):"
+#~ msgstr "Mi_nimaler Wert f?r geladene Pixel (voreingestellt auf 0):"
+#~ msgid "Ma_ximum loaded pixel value (will be scaled to 255):"
+#~ msgstr "Ma_ximaler Wert f?r geladene Pixel (voreingestellt auf 255):"
+#~ msgid "Pixel Value Scaling as Image File is Loaded"
+#~ msgstr "Pixelwert-Einstellung so wie die Bilddatei geladen wurde"
+#~ msgid "Input _Constant:      "
+#~ msgstr "Eingangs_konstante:"
+#~ msgid "Memory constant _alpha:   "
+#~ msgstr "Speicherkonstante _Alpha:"
+#~ msgid " = 1 / "
+#~ msgstr " = 1 / "
+#~ msgid "_Initial average (\"head start\") is "
+#~ msgstr "Anfangsdurchschnitt (\"head start\") ist "
+#~ msgid "straight"
+#~ msgstr "gerade / original"
+#~ msgid "rolling"
+#~ msgstr "Rollen"
+#~ msgid " average"
+#~ msgstr " Durchschnitt"
+#~ msgid "      of frames "
+#~ msgstr "      Bilder"
+#~ msgid " through "
+#~ msgstr " durch "
+#~ msgid "Integer _Bias (will be added to result of selected operation):"
+#~ msgstr "Ganzzahlige Tendenz (_Bias) (wird zum Ergebnis addiert):"
+#~ msgid "First, _add to each pixel result value:   "
+#~ msgstr "Zuerst, _addiere jeden Pixel-Ergebniswert:   "
+#~ msgid "Then, _multiply each pixel result value by:   "
+#~ msgstr "Dann, _vervielf?ltige jeden Pixel-Ergebniswert um:"
+#~ msgid "Mi_nimum result value (will be scaled to 0):"
+#~ msgstr "Mi_nimaler Ergebniswert (voreingestellt auf 0):"
+#~ msgid "Ma_ximum result value (will be scaled to 255):"
+#~ msgstr "Ma_ximaler Ergebniswert (voreingestellt auf 255):"
+#~ msgid "Pixel Value Scaling on Result of Selected Operation"
+#~ msgstr "Pixelwert-Einstellung als Ergebnis der ausgew?hlten Operation"
+#~ msgid "(description of current config will go here)"
+#~ msgstr "(Beschreibung der aktuellen Konfiguration kommt hierher)"
+#~ msgid "_Histogram every N frames (0 to disable):   "
+#~ msgstr "_Histogramm alle N Bilder (0 zum Deaktivieren):"
+#~ msgid "_Debugging settings (bits):   "
+#~ msgstr "_Fehlersuche Einstellungen (bits):"
+#~ msgid "Swiss Army Knife output"
+#~ msgstr "\"Swiss Army Knife\" Ausgabe"
+#~ msgid "Enable Preview"
+#~ msgstr "Vorschau aktivieren"
+
+# Teile = Gruppe von Pixeln
+#~ msgid "Particle Detection"
+#~ msgstr "Teile-Erkennung"
+#~ msgid "Mi_nimum area for a particle to be detected:    "
+#~ msgstr "Mi_nimaler Bereich f?r ein Teil, um es zu erkennen:"
+#~ msgid "Ma_ximum area for a particle to be detected:   "
+#~ msgstr "Ma_ximaler Bereich f?r ein Teil, um es zu erkennen:"
+#~ msgid "_Left side crop (ignore this many pixels on the left):        "
+#~ msgstr "_Linksseitiges Zuschneiden (ignoriert weiter links liegende Pixel):"
+#~ msgid "_Right side crop (ignore this many pixels on the right):     "
+#~ msgstr ""
+#~ "_Rechtsseitiges Zuschneiden (ignoriert weiter rechts liegende Pixel):"
+#~ msgid "_Top crop (ignore this many pixels on the top):                  "
+#~ msgstr ""
+#~ "_Oberes Zuschneiden (ignoriert diese Anzahl Pixel am oberen Rand):     "
+#~ msgid "_Bottom crop (ignore this many pixels on the bottom):   "
+#~ msgstr "_Unteres Zuschneiden (ignoriert weiter unten liegende Pixel):"
+#~ msgid "Output _Format:   "
+#~ msgstr "Ausgabe_format:"
+#~ msgid "_Camera Number for output file:      "
+#~ msgstr "_Kamera Nummer f?r die Ausgabedatei:"
+#~ msgid "Interlace"
+#~ msgstr "Halbbildmodus (interlace)"
+#~ msgid "Get Pixel Aspect Ratio from input video file"
+#~ msgstr "PAR (\"Pixel Aspect Ratio\") der Eingangs-Videodatei ?bernehmen"
+#~ msgid "<i>Threshold</i>"
+#~ msgstr "<i>Schwelle</i>"
+#~ msgid "<i>Strength</i>"
+#~ msgstr "<i>St?rke</i>"
+#~ msgid "Reduce fluctuations in Quantizer (after curve compression)"
+#~ msgstr "Schwankungen des Quantizer reduzieren (nach der Kurvenkompression)"
+#~ msgid "Custom matrix"
+#~ msgstr "Individuelle Matrix"
 #~ msgid "Two pass, final size"
 #~ msgstr "Zwei Durchl?ufe, endg?ltige Gr??e"
 #~ msgid "Two pass, average bitrate"
@@ -8210,12 +8458,8 @@
 #~ msgstr "Max. Ref. Bilder"
 #~ msgid "Fast P Skip"
 #~ msgstr "Schneller P-Skip"
-#~ msgid "Interlaced"
-#~ msgstr "Halbbildmodus"
 #~ msgid "Disabled"
 #~ msgstr "Deaktiviert"
-#~ msgid "Strength"
-#~ msgstr "St?rke"
 #~ msgid "8x8P Transform"
 #~ msgstr "8x8P Transformation"
 #~ msgid "8x8B Transform"
@@ -8484,7 +8728,6 @@
 #~ msgstr "Int. BFF"
 #~ msgid "Aspect Ratio"
 #~ msgstr "Seitenverh?ltnis"
-
 #, fuzzy
 #~ msgid "Horizontal deblocking"
 #~ msgstr "_Horizontal entblockieren"
@@ -8554,8 +8797,6 @@
 #~ msgstr "Informationen"
 #~ msgid "Video Duration  "
 #~ msgstr "Video Verz?gerung  "
-#~ msgid "-/-"
-#~ msgstr "-/-"
 #~ msgid "GMC "
 #~ msgstr "GMC "
 #~ msgid "Bitrate "



From gruntster at mail.berlios.de  Fri Jun 13 14:18:53 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 13 Jun 2008 14:18:53 +0200
Subject: [Avidemux-svn-commit] r4095 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux/ADM_codecs
	cmake plugins/ADM_videoEncoder
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4
Message-ID: <200806131218.m5DCIrfH014058@sheep.berlios.de>

Author: gruntster
Date: 2008-06-13 14:18:36 +0200 (Fri, 13 Jun 2008)
New Revision: 4095

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckXvid.cmake
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/config.h.cmake
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/interface.c
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h
Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvidcvs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.h
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt
Log:
[xvid] plugin skeleton

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -141,7 +141,6 @@
 	SET(ADM_UI_QT4 0)
 ENDIF (NOT QT4_FOUND)
 
-INCLUDE(admCheckVideoCodecLibs)
 INCLUDE(admCheckAudioCodecLibs)
 INCLUDE(admCheckAudioDeviceLibs)
 INCLUDE(admCheckMiscLibs)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -42,7 +42,6 @@
 #include "ADM_codecs/ADM_codecNull.h"
 #include "ADM_codecs/ADM_rgb16.h"
 #include "ADM_codecs/ADM_uyvy.h"
-#include "ADM_codecs/ADM_xvideco.h"
 
 #include "fourcc.h"
 

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvidcvs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvidcvs.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvidcvs.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1 +0,0 @@
-// Old

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1,17 +0,0 @@
-/***************************************************************************
-                          ADM_xvideco.cpp  -  description
-                             -------------------
-    begin                : Fri Aug 23 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
- //RMED

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_xvideco.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1,32 +0,0 @@
-/***************************************************************************
-                          ADM_xvideco.h  -  description
-                             -------------------
-    begin                : Fri Aug 23 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifdef USE_XX_XVID
-class decoderXvid:decoders
-{
-protected:
-  void *_handle;
-
-
-public:
-    decoderXvid (uint32_t w, uint32_t h);
-    virtual ~ decoderXvid ();
-  virtual uint8_t uncompress (uint8_t * in, uint8_t * out, uint32_t len,
-			      uint32_t * flag = NULL);
-  virtual void setParam (void);
-};
-
-#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1,6 +1,6 @@
 SET(ADM_codecs_SRCS 
-	ADM_codecs.cpp  ADM_ffmpeg.cpp  ADM_mjpegEncode.cpp  ADM_png.cpp    ADM_theora_dec.cpp   ADM_xvid.cpp     ADM_xvideco.cpp
-	ADM_ffmp43.cpp  ADM_mjpeg.cpp   ADM_rgb16.cpp  ADM_uyvy.cpp        ADM_xvid4.cpp  ADM_xvidcvs.cpp)
+	ADM_codecs.cpp  ADM_ffmpeg.cpp  ADM_mjpegEncode.cpp  ADM_png.cpp    ADM_theora_dec.cpp   ADM_xvid.cpp
+	ADM_ffmp43.cpp  ADM_mjpeg.cpp   ADM_rgb16.cpp  ADM_uyvy.cpp        ADM_xvid4.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_codecs ${ADM_codecs_SRCS})
 

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1,20 +0,0 @@
-########################################
-# Xvid
-########################################
-OPTION(XVID "" ON)
-
-MESSAGE(STATUS "Checking for Xvid")
-MESSAGE(STATUS "*****************")
-
-IF (XVID)
-	FIND_HEADER_AND_LIB(XVID xvid.h xvidcore xvid_plugin_single)
-	PRINT_LIBRARY_INFO("Xvid" XVID_FOUND "${XVID_INCLUDE_DIR}" "${XVID_LIBRARY_DIR}")
-	
-	IF (XVID_FOUND)
-		SET(USE_XVID_4 1)
-	ENDIF (XVID_FOUND)
-ELSE (XVID)
-	MESSAGE("${MSG_DISABLE_OPTION}")
-ENDIF (XVID)
-
-MESSAGE("")
\ No newline at end of file

Copied: branches/avidemux_2.5_branch_gruntster/cmake/admCheckXvid.cmake (from rev 4091, branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2008-06-08 18:03:18 UTC (rev 4091)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckXvid.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,20 @@
+MACRO(checkXvid)
+	IF (NOT XVID_CHECKED)
+		OPTION(XVID "" ON)
+
+		MESSAGE(STATUS "Checking for Xvid")
+		MESSAGE(STATUS "*****************")
+
+		IF (XVID)
+			FIND_HEADER_AND_LIB(XVID xvid.h xvidcore xvid_plugin_single)
+			PRINT_LIBRARY_INFO("Xvid" XVID_FOUND "${XVID_INCLUDE_DIR}" "${XVID_LIBRARY_DIR}")
+		ELSE (XVID)
+			MESSAGE("${MSG_DISABLE_OPTION}")
+		ENDIF (XVID)
+
+		SET(ENV{ADM_HAVE_XVID} ${XVID_FOUND})
+		SET(XVID_CHECKED 1)
+
+		MESSAGE("")
+	ENDIF (NOT XVID_CHECKED)
+ENDMACRO(checkXvid)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -23,9 +23,6 @@
 ADM_DISPLAY("GTK+      " "${ADM_UI_GTK}")
 ADM_DISPLAY("Qt 4      " "${ADM_UI_QT4}")
 
-MESSAGE("***  Video Codec  ***")
-ADM_DISPLAY("Xvid      " "${USE_XVID_4}")
-
 MESSAGE("***  Audio Codec  ***")
 ADM_DISPLAY("Aften     " "${USE_AFTEN}")
 ADM_DISPLAY("LAME      " "${HAVE_LIBMP3LAME}")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admPluginConfigSummary.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -22,6 +22,7 @@
 MESSAGE("*********************")
 MESSAGE("***  Video Codec  ***")
 ADM_DISPLAY("x264      " "$ENV{ADM_HAVE_X264}")
+ADM_DISPLAY("Xvid      " "$ENV{ADM_HAVE_XVID}")
 
 MESSAGE("***  Audio Codec  ***")
 ADM_DISPLAY("amrnb     " "$ENV{ADM_HAVE_AMRNB}")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -86,12 +86,6 @@
 #cmakedefine USE_XV
 #endif
 
-/* use Xvid 1.x API */
-#cmakedefine USE_XVID_4
-
-/* use Xvid 0.9 API */
-#cmakedefine USE_XX_XVID
-
 /* Version number of package */
 #define VERSION "${VERSION}"
 

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,23 @@
+INCLUDE(admCheckXvid)
+INCLUDE(admPluginVideoEncoder)
+
+checkXvid()
+
+IF (XVID_FOUND)
+	INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
+
+	SET(QT_PLUGIN_NAME "ADM_vidEnc_xvid_Qt")
+	SET(GTK_PLUGIN_NAME "ADM_vidEnc_xvid_Gtk")
+	SET(PLUGIN_SUBDIR "xvid")
+	SET(ADM_vidEnc_xvid_SRCS interface.c  encoder.cpp  options.cpp  configGuiLoader.cpp)
+
+	CONFIGURE_FILE("${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config.h")
+
+	ADD_SUBDIRECTORY(gtk)
+	ADD_SUBDIRECTORY(qt4)
+	ADD_LIBRARY(ADM_vidEnc_xvid SHARED ${ADM_vidEnc_xvid_SRCS})
+	TARGET_LINK_LIBRARIES(ADM_vidEnc_xvid ADM_core)
+
+	INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid)
+	INSTALL_VIDEO_ENCODER(ADM_vidEnc_xvid)
+ENDIF (XVID_FOUND)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/config.h.cmake	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/config.h.cmake	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,11 @@
+#ifndef config_h
+#define config_h
+
+#define QT_PLUGIN_NAME "${QT_PLUGIN_NAME}"
+#define GTK_PLUGIN_NAME "${GTK_PLUGIN_NAME}"
+#define PLUGIN_SUBDIR "${PLUGIN_SUBDIR}"
+
+#define PLUGIN_PREFIX "${CMAKE_SHARED_LIBRARY_PREFIX}"
+#define PLUGIN_SUFFIX "${CMAKE_SHARED_LIBRARY_SUFFIX}"
+
+#endif	// config_h
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,7 @@
+#include "ADM_inttype.h"
+#include "configGuiLoader.h"
+
+configGuiLoader::configGuiLoader(const char *file) : ADM_LibWrapper()
+{
+	initialised = (loadLibrary(file) && getSymbols(1, &showXvidConfigDialog, "showXvidConfigDialog"));
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/configGuiLoader.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,22 @@
+#ifndef configGuiLoader_h
+#define configGuiLoader_h
+
+#include "ADM_dynamicLoading.h"
+#include "options.h"
+
+extern "C"
+{
+#include "ADM_vidEnc_plugin.h"
+}
+
+typedef bool _showXvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, xvidOptions *options);
+
+class configGuiLoader : public ADM_LibWrapper
+{
+	public:
+		_showXvidConfigDialog *showXvidConfigDialog;
+
+		configGuiLoader(const char *file);
+};
+
+#endif	// configGuiLoader_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,139 @@
+/***************************************************************************
+                               xvidEncoder.cpp
+
+    begin                : Wed Jun 11 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include <math.h>
+
+#include "config.h"
+#include "ADM_inttype.h"
+#include "ADM_files.h"
+#include "encoder.h"
+
+static xvidEncoder encoder;
+static void* encoders = { &encoder };
+
+extern "C"
+{
+	void *encoders_getPointer(int uiType) { encoder.setUiType(uiType); return &encoders; } 
+	int xvidEncoder_isConfigurable(void) { return encoder.isConfigurable(); }
+	int xvidEncoder_configure(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties) { return encoder.configure(configParameters, properties); }
+	int xvidEncoder_getOptions(vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize) { return encoder.getOptions(encodeOptions, pluginOptions, bufferSize); };
+	int xvidEncoder_setOptions(vidEncOptions *encodeOptions, char *pluginOptions) { return encoder.setOptions(encodeOptions, pluginOptions); };
+	int xvidEncoder_getPassCount(void) { return encoder.getPassCount(); }
+	int xvidEncoder_getCurrentPass(void) { return encoder.getCurrentPass(); }
+	int xvidEncoder_open(vidEncVideoProperties *properties) { return encoder.open(properties); }
+	int xvidEncoder_beginPass(vidEncPassParameters *passParameters) { return encoder.beginPass(passParameters); }
+	int xvidEncoder_encodeFrame(vidEncEncodeParameters *encodeParams) { return encoder.encodeFrame(encodeParams); }
+	int xvidEncoder_finishPass(void) { return encoder.finishPass(); }
+	void xvidEncoder_close(void) { encoder.close(); }
+}
+
+xvidEncoder::xvidEncoder(void)
+{
+
+}
+
+xvidEncoder::~xvidEncoder(void)
+{
+
+}
+
+void xvidEncoder::setUiType(int uiType)
+{
+	_uiType = uiType;
+}
+
+int xvidEncoder::isConfigurable(void)
+{
+	return (_uiType == ADM_UI_GTK || _uiType == ADM_UI_QT4);
+}
+
+int xvidEncoder::configure(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties)
+{
+	if (_loader == NULL)
+	{
+		char* pluginPath = ADM_getPluginPath();
+		const char* configGuiLibName;
+
+		if (_uiType == ADM_UI_GTK)
+			configGuiLibName = GTK_PLUGIN_NAME;
+		else
+			configGuiLibName = QT_PLUGIN_NAME;
+
+		char* configGuiPath = new char[strlen(pluginPath) + 1 + strlen(PLUGIN_SUBDIR) + 1 + strlen(PLUGIN_PREFIX) + strlen(configGuiLibName) + strlen(PLUGIN_SUFFIX) + 1];
+
+		strcpy(configGuiPath, pluginPath);
+		strcat(configGuiPath, PLUGIN_SUBDIR);
+		strcat(configGuiPath, "/");
+		strcat(configGuiPath, PLUGIN_PREFIX);
+		strcat(configGuiPath, configGuiLibName);
+		strcat(configGuiPath, PLUGIN_SUFFIX);
+
+		_loader = new configGuiLoader(configGuiPath);
+
+		delete [] pluginPath;
+		delete [] configGuiPath;
+	}
+
+	if (_loader->isAvailable())
+		return _loader->showXvidConfigDialog(configParameters, properties, &_encodeOptions, &_options);
+	else
+		return 0;
+}
+
+int xvidEncoder::getOptions(vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize)
+{
+
+}
+
+int xvidEncoder::setOptions(vidEncOptions *encodeOptions, char *pluginOptions)
+{
+
+}
+
+int xvidEncoder::getCurrentPass(void)
+{
+	return _currentPass;
+}
+
+int xvidEncoder::getPassCount(void)
+{
+	return _passCount;
+}
+
+int xvidEncoder::open(vidEncVideoProperties *properties)
+{
+
+}
+
+int xvidEncoder::beginPass(vidEncPassParameters *passParameters)
+{
+
+}
+
+int xvidEncoder::encodeFrame(vidEncEncodeParameters *encodeParams)
+{
+
+}
+
+int xvidEncoder::finishPass(void)
+{
+
+}
+
+void xvidEncoder::close(void)
+{
+
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,67 @@
+/***************************************************************************
+                                  encoder.h
+
+    begin                : Wed Jun 11 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef encoder_h
+#define encoder_h
+
+#ifdef __cplusplus
+	#include "configGuiLoader.h"
+
+	extern "C"
+	{
+	#include "ADM_vidEnc_plugin.h"
+	}
+
+	class xvidEncoder
+	{
+	private:
+		int _uiType;
+
+		configGuiLoader *_loader;
+		xvidOptions _options;
+		vidEncOptions _encodeOptions;
+
+		int _currentPass, _passCount;
+
+	public:
+		xvidEncoder(void);
+		~xvidEncoder(void);
+		void setUiType(int uiType);
+		int isConfigurable(void);
+		int configure(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties);
+		int getOptions(vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize);
+		int setOptions(vidEncOptions *encodeOptions, char *pluginOptions);
+		int getCurrentPass(void);
+		int getPassCount(void);
+		int open(vidEncVideoProperties *properties);
+		int beginPass(vidEncPassParameters *passParameters);
+		int encodeFrame(vidEncEncodeParameters *encodeParams);
+		int finishPass(void);
+		void close(void);
+	};
+#else
+	void *encoders_getPointer(int uiType);
+	int xvidEncoder_isConfigurable(void);
+	int xvidEncoder_configure(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties);
+	int xvidEncoder_getOptions(vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize);
+	int xvidEncoder_setOptions(vidEncOptions *encodeOptions, char *pluginOptions);
+	int xvidEncoder_getPassCount(void);
+	int xvidEncoder_getCurrentPass(void);
+	int xvidEncoder_open(vidEncVideoProperties *properties);
+	void xvidEncoder_close(void);
+	int xvidEncoder_encodeFrame(vidEncEncodeParameters *encodeParams);
+#endif	// __cplusplus
+#endif	// encoder_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,27 @@
+INCLUDE(admCheckGtk)
+INCLUDE(admCheckGettext)
+INCLUDE(admPluginVideoEncoder)
+
+checkGtk()
+
+IF (GTK_FOUND AND GTHREAD_FOUND)
+	checkGettext()
+
+	IF (GETTEXT_FOUND)
+		ADD_DEFINITIONS("-DHAVE_GETTEXT")
+		INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
+	ENDIF (GETTEXT_FOUND)
+
+	SET(ADM_vidEnc_xvid_Gtk_SRCS gtkSupport.cpp  xvidConfigDialog.cpp)
+
+	ADD_DEFINITIONS(${GTK_CFLAGS})
+	ADD_LIBRARY(${GTK_PLUGIN_NAME} SHARED ${ADM_vidEnc_xvid_Gtk_SRCS})
+	TARGET_LINK_LIBRARIES(${GTK_PLUGIN_NAME} ADM_vidEnc_xvid ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
+	
+	IF (GETTEXT_FOUND)
+		TARGET_LINK_LIBRARIES(${GTK_PLUGIN_NAME} ${GETTEXT_LIBRARY_DIR})
+	ENDIF(GETTEXT_FOUND)
+
+	INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid_Gtk)
+	INSTALL(TARGETS ADM_vidEnc_xvid_Gtk DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+ENDIF (GTK_FOUND AND GTHREAD_FOUND)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,26 @@
+#include "gtkSupport.h"
+
+GtkWidget *lookup_widget(GtkWidget *widget, const gchar *widget_name)
+{
+	GtkWidget *parent, *found_widget;
+
+	for (;;)
+	{
+		if (GTK_IS_MENU (widget))
+			parent = gtk_menu_get_attach_widget (GTK_MENU (widget));
+		else
+			parent = widget->parent;
+		if (!parent)
+			parent = (GtkWidget *)g_object_get_data (G_OBJECT (widget), "GladeParentKey");
+		if (parent == NULL)
+			break;
+		widget = parent;
+	}
+
+	found_widget = (GtkWidget*) g_object_get_data (G_OBJECT (widget), widget_name);
+
+	if (!found_widget)
+		g_warning ("Widget not found: %s", widget_name);
+
+	return found_widget;
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/gtkSupport.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,15 @@
+#ifndef gtkSupport_h
+#define gtkSupport_h
+
+#include <gtk/gtk.h>
+
+GtkWidget *lookup_widget(GtkWidget *widget, const gchar *widget_name);
+
+#define GLADE_HOOKUP_OBJECT(component,widget,name) \
+  g_object_set_data_full (G_OBJECT (component), name, \
+    gtk_widget_ref (widget), (GDestroyNotify) gtk_widget_unref)
+
+#define GLADE_HOOKUP_OBJECT_NO_REF(component,widget,name) \
+  g_object_set_data (G_OBJECT (component), name, widget)
+
+#endif	// gtkSupport_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,1652 @@
+/***************************************************************************
+                    xvidConfigDialog.cpp  -  description
+                    ------------------------------------
+
+                          GUI for configuring Xvid
+
+    begin                : Fri Jun 13 2008
+    copyright            : (C) 2008 by mean/gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifdef HAVE_GETTEXT
+#include <libintl.h>
+#define _(x) gettext(x)
+#else
+#define _(x) x
+#endif
+
+#include "ADM_inttype.h"
+#include "DIA_coreToolkit.h"
+#include "DIA_fileSel.h"
+
+#include "../options.h"
+
+#include "gtkSupport.h"
+#include "xvidConfigDialog.h"
+
+#define WID(x) lookup_widget(dialog, #x)
+
+//static xvid4EncParam localParam;
+static uint32_t mQ,mB,mS,mA;
+static GtkWidget *dialog=NULL;
+//static COMPRESSION_MODE mMode;
+
+static GtkWidget *create_dialog1 (void);
+static GtkWidget *create_dialog3 (void);
+
+static void xvid4otherUpload(GtkWidget *dialog);
+static void xvid4otherDownload(GtkWidget *dialog);
+static uint8_t editMatrix(uint8_t *inter, uint8_t *intra, GtkWindow *parent);
+static void updateMode( void );
+
+static int cb_mod(GtkObject * object, gpointer user_data);
+static int ch_par_asinput(GtkObject * object, gpointer user_data);
+
+#define CALL_Z(x,y)  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),XVID4_RESPONSE_##y);
+
+typedef enum 
+{
+    XVID4_RESPONSE_MODE_CHANGED,
+    XVID4_RESPONSE_EDIT_MATRIX,
+    XVID4_RESPONSE_LOAD_MATRIX,
+    XVID4_RESPONSE_SAVE_MATRIX,
+    XVID4_RESPONSE_LAST,
+}XVID4_CODE;
+
+extern "C" int showXvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, xvidOptions *options)
+{
+	int b;
+	int ret=0;
+	int code;
+	//ADM_assert(incoming->extraSettingsLen==sizeof(localParam));
+	//memcpy(&localParam,incoming->extraSettings,sizeof(localParam));
+	dialog=create_dialog1();
+
+	gtk_window_set_modal(GTK_WINDOW(dialog), 1);
+	gtk_window_set_transient_for(GTK_WINDOW(dialog), GTK_WINDOW(configParameters->parent));
+
+#define HIST_SET(x) gtk_option_menu_set_history(GTK_OPTION_MENU(WID(optionmenuType)), x)
+#define VAL_SET(x) gtk_write_entry(WID(entryEntry), x)
+
+/*	mQ=incoming->qz;
+	mB=incoming->bitrate; // in kbits
+	mS=incoming->finalsize;	
+	mA=incoming->avg_bitrate;
+	mMode=incoming->mode;
+	updateMode();
+
+	xvid4otherUpload(dialog); */
+	gtk_signal_connect(GTK_OBJECT(WID(optionmenuType)), "changed",
+		GTK_SIGNAL_FUNC(cb_mod),                   (void *) 0);
+
+	gtk_signal_connect(GTK_OBJECT(WID(checkbutton_par_asinput)), "clicked",
+		GTK_SIGNAL_FUNC(ch_par_asinput),                   (void *) 0);
+
+	CALL_Z(buttonCreateCustomMatrix,EDIT_MATRIX);
+	CALL_Z(buttonLoadMatrix,LOAD_MATRIX);
+
+_again:
+	code=gtk_dialog_run(GTK_DIALOG(dialog));
+/*	if(code==XVID4_RESPONSE_EDIT_MATRIX)
+	{
+		uint8_t intra[64],inter[64];
+		memcpy(intra,localParam.intraMatrix,64);
+		memcpy(inter,localParam.interMatrix,64);
+		if(editMatrix(intra,inter))
+		{
+			memcpy(localParam.intraMatrix,intra,64);
+			memcpy(localParam.interMatrix,inter,64);
+		}
+		goto _again;
+	}
+	if(code==XVID4_RESPONSE_LOAD_MATRIX)
+	{
+		uint8_t intra[64],inter[64];
+		char name[1024];
+		FILE *file=NULL;
+
+		if (!FileSel_SelectRead(_("Select Xvid matrix file to load"), name, 1023, NULL))
+			goto _again;
+
+		printf("Loading Matrix\n");
+		file=fopen(name,"rb");
+		if(!file)
+		{
+_erLoad:
+			if(file) fclose(file);
+			GUI_Error_HIG(_("Error Loading"),_("Error loadind the custom matrix file."));
+			goto _again;
+		}
+		// Read it
+		if(64!=fread(intra,1,64,file))
+		{
+			printf("Error reading intra\n");
+			goto _erLoad;
+		}
+		if(64!=fread(inter,1,64,file))
+		{
+			printf("Error reading inter\n");
+			goto _erLoad;
+		}
+		// Ok
+		fclose(file);
+		memcpy(localParam.intraMatrix,intra,64);
+		memcpy(localParam.interMatrix,inter,64);
+		GUI_Info_HIG(ADM_LOG_INFO,_("Matrix Loaded"),_("The custom matrix file has been successfully loaded."));
+		goto _again;
+	}
+*/
+	if(code==GTK_RESPONSE_OK)
+	{
+/*		int r,value=0;
+		ret=1;
+		r=getRangeInMenu(WID(optionmenuType));
+		xvid4otherDownload(dialog);
+		memcpy(incoming->extraSettings,&localParam,sizeof(localParam));
+
+		switch(r)
+		{
+			case 0:
+				incoming->mode = COMPRESS_CBR;				      
+				value = (uint32_t) gtk_read_entry(WID(entryEntry));
+				incoming->bitrate = value;
+				ret = 1;
+				gtk_label_set_text(GTK_LABEL(WID(label11)),"Bitrate (kbps):");
+				break;
+			case 1:
+				incoming->mode = COMPRESS_CQ;		      			
+				value = (uint32_t) gtk_spin_button_get_value_as_int(
+					GTK_SPIN_BUTTON(WID(spinbuttonQuant)));
+				if (value >= 2 && value <= 32)
+				{
+					incoming->qz = value;
+				}
+				break;
+
+			case 2:
+				incoming->mode = COMPRESS_2PASS;		       				
+				value = (uint32_t) gtk_read_entry(WID(entryEntry));
+				if((value>0)&&(value<4000))
+				{
+					incoming->finalsize=value;
+
+				}
+				gtk_label_set_text(GTK_LABEL(WID(label11)),_("Size (MBytes):"));
+				break;
+			case 3:
+				incoming->mode = COMPRESS_2PASS_BITRATE;	
+				value = (uint32_t) gtk_read_entry(WID(entryEntry));
+				incoming->avg_bitrate=value;
+				gtk_label_set_text(GTK_LABEL(WID(label11)),_("Average bitrate (kb/s):"));
+				break;
+
+			case 4:
+				incoming->mode=COMPRESS_SAME;
+				break;
+			default:
+				ADM_assert(0);
+		} */
+	}
+
+	gtk_widget_destroy(dialog);
+
+	return ret;
+}
+
+// Read the localParam struct and set the ui fields
+// accordingly
+#define SPIN_GET(x,y) {localParam.y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(x))) ;\
+	printf(#x":%d\n",localParam.y);}
+
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(x)),(gfloat)localParam.y) ; \
+	printf(#x":%d\n",localParam.y);}
+
+#define MENU_SET(x,y) { gtk_option_menu_set_history (GTK_OPTION_MENU(WID(x)),localParam.y);}
+#define MENU_GET(x,y) { localParam.y	= getRangeInMenu(WID(x));}
+#define TOGGLE_SET(x,y) {gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(WID(x)),localParam.y);}
+#define TOGGLE_GET(x,y) {localParam.y=gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(WID(x)));\
+	printf(#y":%d\n",localParam.y);}
+
+#define ENTRY_SET(x,y) {gtk_write_entry(WID(x),(int)localParam.y);}
+#define ENTRY_GET(x,y) {localParam.y=gtk_read_entry(WID(x));\
+	printf(#y":%d\n",localParam.y);}
+
+#define CHECK_GET(x,y) {localParam.y=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(x)));}
+#define CHECK_SET(x,y) {gtk_toggle_button_set_active( GTK_TOGGLE_BUTTON(WID(x)),localParam.y);}
+
+void xvid4otherUpload(GtkWidget *dialog)
+{
+/*	MENU_SET(optionmenuMS,guiLevel);
+	MENU_SET(optionmenuVHQ,vhqmode);
+	if(localParam.useCustomIntra || localParam.useCustomInter)
+	{
+		RADIO_SET(radiobuttonCustomMatrix,		1);
+	}else
+		if(localParam.mpegQuantizer)
+			RADIO_SET(radiobuttonMpeg,		1);
+		else
+			RADIO_SET(radiobuttonH263,		1);		
+	CHECK_SET(checkbuttonInterlaced,	interlaced);
+	CHECK_SET(checkbutton4MV,		inter4mv);
+	CHECK_SET(checkbuttonTrellis,		trellis);
+	CHECK_SET(checkbuttonCartoon,		cartoon);
+	CHECK_SET(checkbuttonGreyScale,		greyscale);
+	CHECK_SET(checkbuttonChroma,		chroma_opt);
+	CHECK_SET(checkbuttonChromaMotion,	chroma_me);
+	CHECK_SET(checkbuttonGMC,		gmc);
+	CHECK_SET(checkbuttonBVHQ,		bvhq);
+	CHECK_SET(checkbutton_par_asinput,	par_as_input);
+	CHECK_SET(checkbuttonQPel,		qpel);
+	CHECK_SET(checkbuttonHQAC,		hqac);
+
+	CHECK_SET(checkbuttonTurbo,		turbo);
+	CHECK_SET(checkbuttonPacked,		packed);
+
+	SPIN_SET(spinbuttonIMaxPeriod,  max_key_interval);
+	ENTRY_SET(entryIInterv,		min_key_interval);
+	SPIN_SET(spinbuttonBFrame,	bframes);
+	ch_par_asinput(NULL, NULL);
+
+	SPIN_SET(spinbuttonIMax,	qmax[0]);
+	SPIN_SET(spinbuttonPMax,	qmax[1]);
+	SPIN_SET(spinbuttonBMax,	qmax[2]);
+
+	SPIN_SET(spinbuttonIMin,	qmin[0]);
+	SPIN_SET(spinbuttonPMin,	qmin[1]);
+	SPIN_SET(spinbuttonBMin,	qmin[2]);
+
+
+	ENTRY_SET(entryIBoost		,	keyframe_boost		);
+
+	ENTRY_SET(entryHiPass		,	curve_compression_high	);
+	ENTRY_SET(entryLowPass		,	curve_compression_low	);
+	ENTRY_SET(entryOvrControl,		overflow_control_strength	);
+
+	ENTRY_SET(entryMaxOvrImp	,	max_overflow_improvement	);
+	ENTRY_SET(entryMaxOvrDeg	,	max_overflow_degradation	);
+
+	ENTRY_SET(entryIreduction	,	kfreduction			);
+	ENTRY_SET(entryIInterv	,		kfthreshold			);
+	//TOGGLE_SET(toggleHPEL,			halfpel);
+*/
+}
+
+// Read the ui fields and set localParam
+// accordingly
+void xvid4otherDownload(GtkWidget *dialog)
+{
+/*	MENU_GET(optionmenuMS,guiLevel);
+	MENU_GET(optionmenuVHQ,vhqmode);
+
+	localParam.mpegQuantizer=RADIO_GET(radiobuttonMpeg);
+	if(RADIO_GET(radiobuttonCustomMatrix))
+	{
+		localParam.useCustomIntra=1;
+		localParam.useCustomInter=1;
+	}else
+	{
+		localParam.useCustomIntra=0;
+		localParam.useCustomInter=0;
+	}
+	CHECK_GET(checkbuttonInterlaced,	interlaced);
+	CHECK_GET(checkbutton4MV,		inter4mv);
+	CHECK_GET(checkbuttonTrellis,		trellis);
+	CHECK_GET(checkbuttonCartoon,		cartoon);
+	CHECK_GET(checkbuttonGreyScale,		greyscale);
+	CHECK_GET(checkbuttonChroma,		chroma_opt);
+	CHECK_GET(checkbuttonChromaMotion,	chroma_me);
+	CHECK_GET(checkbuttonGMC,		gmc);
+	CHECK_GET(checkbuttonBVHQ,		bvhq);
+	CHECK_GET(checkbutton_par_asinput,	par_as_input);
+	CHECK_GET(checkbuttonQPel,		qpel);
+	CHECK_GET(checkbuttonHQAC,		hqac);
+	CHECK_GET(checkbuttonTurbo,		turbo);
+	CHECK_GET(checkbuttonPacked,		packed);
+
+
+	SPIN_GET(spinbuttonIMaxPeriod,  max_key_interval);	
+	ENTRY_GET(entryIInterv,			kfthreshold);
+	SPIN_GET(spinbuttonBFrame,		bframes);
+
+	SPIN_GET(spinbutton_par_width,	par_width);
+	SPIN_GET(spinbutton_par_height,	par_height);
+
+
+	ENTRY_GET(entryIBoost		,	keyframe_boost		);
+
+	ENTRY_GET(entryHiPass		,	curve_compression_high	);
+	ENTRY_GET(entryLowPass		,	curve_compression_low	);
+	ENTRY_GET(entryOvrControl,		overflow_control_strength	);
+
+	ENTRY_GET(entryMaxOvrImp	,	max_overflow_improvement	);
+	ENTRY_GET(entryMaxOvrDeg	,	max_overflow_degradation	);
+
+	ENTRY_GET(entryIreduction	,	kfreduction			);
+	ENTRY_GET(entryIInterv	,	kfthreshold			);
+	//TOGGLE_SET(toggleHPEL,			halfpel);
+	SPIN_GET(spinbuttonIMax,	qmax[0]);
+	SPIN_GET(spinbuttonPMax,	qmax[1]);
+	SPIN_GET(spinbuttonBMax,	qmax[2]);
+
+	SPIN_GET(spinbuttonIMin,	qmin[0]);
+	SPIN_GET(spinbuttonPMin,	qmin[1]);
+	SPIN_GET(spinbuttonBMin,	qmin[2]);
+*/
+
+}
+
+void updateMode( void )
+{
+/*	uint32_t b;
+	// set the right select button
+	switch (mMode)
+	{
+	case COMPRESS_CBR:
+		HIST_SET(0);			
+		b=mB;
+		VAL_SET(b);
+		gtk_widget_set_sensitive(WID(spinbuttonQuant),0);
+		gtk_widget_set_sensitive(WID(entryEntry),1);
+		gtk_label_set_text(GTK_LABEL(WID(label11)),_("Target bitrate (kb/s):"));
+		break;
+
+	case COMPRESS_2PASS:
+		HIST_SET(2);
+		VAL_SET(mS);
+		gtk_widget_set_sensitive(WID(spinbuttonQuant),0);
+		gtk_widget_set_sensitive(WID(entryEntry),1);
+		gtk_label_set_text(GTK_LABEL(WID(label11)),_("Target video size (MB):"));
+		break;
+	case COMPRESS_2PASS_BITRATE:
+		HIST_SET(3);
+		VAL_SET(mA);
+		gtk_widget_set_sensitive(WID(spinbuttonQuant),0);
+		gtk_widget_set_sensitive(WID(entryEntry),1);
+		gtk_label_set_text(GTK_LABEL(WID(label11)),_("Average bitrate (kb/s):"));
+		break;
+
+	case COMPRESS_CQ:
+		HIST_SET(1);
+		gtk_widget_set_sensitive(WID(entryEntry),0);
+		gtk_widget_set_sensitive(WID(spinbuttonQuant),1);
+		gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbuttonQuant)),(gfloat)mQ);
+		break;
+	case COMPRESS_SAME:
+		HIST_SET(4);
+		gtk_widget_set_sensitive(WID(entryEntry),0);
+		gtk_widget_set_sensitive(WID(spinbuttonQuant),0);
+
+		break;
+
+	} */
+}
+
+int cb_mod(GtkObject * object, gpointer user_data)
+{
+/*	int r;
+	r=getRangeInMenu(WID(optionmenuType));
+	switch(r)
+	{
+	case 0: mMode=COMPRESS_CBR ;break;
+	case 1: mMode=COMPRESS_CQ ;break;
+	case 2: mMode=COMPRESS_2PASS ;break;
+	case 3: mMode=COMPRESS_2PASS_BITRATE ;break;
+	case 4: mMode=COMPRESS_SAME;break;
+
+	}
+	updateMode();
+	printf("Changed!!!\n");
+	return 0;
+*/
+}
+
+int ch_par_asinput(GtkObject * object, gpointer user_data)
+{
+/*	int on = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(WID(checkbutton_par_asinput)));
+	gtk_widget_set_sensitive(WID(spinbutton_par_width), on^1);
+	gtk_widget_set_sensitive(WID(spinbutton_par_height), on^1);
+
+	if (on) {
+		SPIN_GET(spinbutton_par_width,	par_width);
+		SPIN_GET(spinbutton_par_height,	par_height);
+		gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton_par_width)), video_body->getPARWidth());
+		gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton_par_height)), video_body->getPARHeight());
+	}else{
+		SPIN_SET(spinbutton_par_width,	par_width);
+		SPIN_SET(spinbutton_par_height,	par_height);
+	}
+
+	return 0; */
+}
+
+uint8_t editMatrix(uint8_t *intra, uint8_t *inter, GtkWindow *parent)
+{
+	GtkWidget *dialog=NULL;
+	GtkWidget *spinbutton1;
+	GtkObject *spinbutton1_adj;
+	GtkWidget *intraCell[64],*interCell[64];
+	uint8_t ret=0;
+	int code;
+	int col, row;
+
+	dialog=create_dialog3();
+	gtk_window_set_modal(GTK_WINDOW(dialog), 1);
+	gtk_window_set_transient_for(GTK_WINDOW(dialog), parent);
+
+	for(int i=0;i<64;i++)
+	{  //Intra
+		col=i%8;
+		row=i>>3;
+		spinbutton1_adj = gtk_adjustment_new (intra[i], 8, 255, 1, 10, 10);
+		intraCell[i]=spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 0);
+		//     gtk_widget_show (spinbutton1);
+		gtk_table_attach (GTK_TABLE (WID(tableIntra)), spinbutton1, col, col+1, row, row+1,
+			(GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+			(GtkAttachOptions) (0), 0, 0);
+
+
+	}
+
+	for(int i=0;i<64;i++)
+	{  //Inter
+		col=i%8;
+		row=i>>3;
+		spinbutton1_adj = gtk_adjustment_new (inter[i], 1, 255, 1, 10, 10);
+		interCell[i]=spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 0);
+		//    gtk_widget_show (spinbutton1);
+		gtk_table_attach (GTK_TABLE (WID(tableInter)), spinbutton1, col, col+1, row, row+1,
+			(GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+			(GtkAttachOptions) (0), 0, 0);
+	}
+
+	for(int i=0;i<64;i++)
+	{
+		gtk_widget_show (intraCell[i]);
+		gtk_widget_show (interCell[i]);
+	}
+	//
+
+	CALL_Z(button12,SAVE_MATRIX)
+_loop:
+	code=gtk_dialog_run(GTK_DIALOG(dialog));
+
+	if(code==XVID4_RESPONSE_SAVE_MATRIX)
+	{
+		printf("Save\n");
+		char name[1024];
+		FILE *fd;
+
+		if (!FileSel_SelectWrite(_("Select Custom Matrix File to write"), name, 1023, NULL))
+			goto _loop;
+
+		fd=fopen(name,"wb");
+		if(!fd)
+		{
+			GUI_Error_HIG(_("Error Writing"),_("Error writing the custom matrix file."));
+			goto _loop;
+		}
+
+		for(int i=0;i<64;i++)
+		{
+			inter[i]=gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(interCell[i]));
+			intra[i]=gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(intraCell[i]));
+		}
+
+		fwrite(intra,1,64,fd);
+		fwrite(inter,1,64,fd);
+		fclose(fd);
+		goto _loop;
+	}
+
+	if(code==GTK_RESPONSE_OK)
+	{
+		printf("Accept\n");
+		ret=1;
+		for(int i=0;i<64;i++)
+		{
+			intra[i]=gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(intraCell[i]));
+			inter[i]=gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(interCell[i]));
+		}
+	}
+	else
+		printf("refused\n");
+
+	gtk_widget_destroy(dialog);
+
+	return ret;
+}
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *notebook1;
+  GtkWidget *vbox2;
+  GtkWidget *frame1;
+  GtkWidget *vbox3;
+  GtkWidget *hbox19;
+  GtkWidget *vbox21;
+  GtkWidget *label10;
+  GtkWidget *label11;
+  GtkWidget *label12;
+  GtkWidget *vbox22;
+  GtkWidget *optionmenuType;
+  GtkWidget *menu1;
+  GtkWidget *one_pass_cbr1;
+  GtkWidget *one_pass_quantizer1;
+  GtkWidget *two_pass1;
+  GtkWidget *two_pass__average_bitrate1;
+  GtkWidget *same_qz_as_input1;
+  GtkWidget *entryEntry;
+  GtkObject *spinbuttonQuant_adj;
+  GtkWidget *spinbuttonQuant;
+  GtkWidget *label9;
+  GtkWidget *hbox7;
+  GtkWidget *vbox4;
+  GtkWidget *checkbuttonInterlaced;
+  GtkWidget *checkbuttonGreyScale;
+  GtkWidget *vbox5;
+  GtkWidget *checkbuttonCartoon;
+  GtkWidget *checkbuttonChroma;
+  GtkWidget *vbox23;
+  GtkWidget *checkbuttonTurbo;
+  GtkWidget *checkbuttonPacked;
+  GtkWidget *labelMain;
+  GtkWidget *vbox6;
+  GtkWidget *hbox8;
+  GtkWidget *vbox8;
+  GtkWidget *labelMotionSearchPrecision;
+  GtkWidget *labelVHQMode;
+  GtkWidget *vbox7;
+  GtkWidget *optionmenuMS;
+  GtkWidget *menu2;
+  GtkWidget *_0___none1;
+  GtkWidget *_1___very_low1;
+  GtkWidget *_2___low2;
+  GtkWidget *_3___medium1;
+  GtkWidget *_4___high1;
+  GtkWidget *_5___very_high1;
+  GtkWidget *_6___ultra_high1;
+  GtkWidget *optionmenuVHQ;
+  GtkWidget *menu3;
+  GtkWidget *_0___off1;
+  GtkWidget *_1___mode_decision1;
+  GtkWidget *_2___limited_search1;
+  GtkWidget *_3___medium_search1;
+  GtkWidget *_4___wide_search1;
+  GtkWidget *hbox10;
+  GtkWidget *checkbuttonChromaMotion;
+  GtkWidget *checkbutton4MV;
+  GtkWidget *checkbuttonHQAC;
+  GtkWidget *hbox9;
+  GtkWidget *labelIFrameIntervalMin;
+  GtkObject *spinbuttonIMinPeriod_adj;
+  GtkWidget *spinbuttonIMinPeriod;
+  GtkWidget *labelIFrameIntervalMax;
+  GtkObject *spinbuttonIMaxPeriod_adj;
+  GtkWidget *spinbuttonIMaxPeriod;
+  GtkWidget *frameAdvancedSimpleProfile;
+  GtkWidget *vbox9;
+  GtkWidget *hbox11;
+  GtkWidget *labelNumberOfBFrames;
+  GtkObject *spinbuttonBFrame_adj;
+  GtkWidget *spinbuttonBFrame;
+  GtkWidget *hbox12;
+  GtkWidget *checkbuttonQPel;
+  GtkWidget *checkbuttonGMC;
+  GtkWidget *checkbuttonBVHQ;
+  GtkWidget *labelAdvancedSimpleProfile;
+  GtkWidget *labelMotionEstimation;
+  GtkWidget *vbox10;
+  GtkWidget *hbox13;
+  GtkWidget *labelQuantizationType;
+  GtkWidget *radiobuttonH263;
+  GSList *radiobuttonH263_group = NULL;
+  GtkWidget *radiobuttonMpeg;
+  GtkWidget *radiobuttonCustomMatrix;
+  GtkWidget *hbox20;
+  GtkWidget *labelLoadCustomMatrix;
+  GtkWidget *buttonLoadMatrix;
+  GtkWidget *alignment6;
+  GtkWidget *hbox21;
+  GtkWidget *image1;
+  GtkWidget *label13;
+  GtkWidget *vseparator1;
+  GtkWidget *buttonCreateCustomMatrix;
+  GtkWidget *frameQuantizationRestrictions;
+  GtkWidget *hbox14;
+  GtkWidget *vbox11;
+  GtkWidget *labelIFrameQuantizerMin;
+  GtkWidget *labelPFrameQuantizerMin;
+  GtkWidget *labelBFrameQuantizaterMin;
+  GtkWidget *vbox12;
+  GtkObject *spinbuttonIMin_adj;
+  GtkWidget *spinbuttonIMin;
+  GtkObject *spinbuttonPMin_adj;
+  GtkWidget *spinbuttonPMin;
+  GtkObject *spinbuttonBMin_adj;
+  GtkWidget *spinbuttonBMin;
+  GtkWidget *vbox13;
+  GtkWidget *labelIFrameQuantizerMax;
+  GtkWidget *labelPFrameQuantizerMax;
+  GtkWidget *labelBFrameQuantizerMax;
+  GtkWidget *vbox14;
+  GtkObject *spinbuttonIMax_adj;
+  GtkWidget *spinbuttonIMax;
+  GtkObject *spinbuttonPMax_adj;
+  GtkWidget *spinbuttonPMax;
+  GtkObject *spinbuttonBMax_adj;
+  GtkWidget *spinbuttonBMax;
+  GtkWidget *labelQuantizerRestrictions;
+  GtkWidget *checkbuttonTrellis;
+  GtkWidget *labelQuantization;
+  GtkWidget *vbox15;
+  GtkWidget *frameTwoPassTuning;
+  GtkWidget *vbox16;
+  GtkWidget *hbox;
+  GtkWidget *vbox17;
+  GtkWidget *labelIFrameBoost;
+  GtkWidget *labelIFrameCloserThan;
+  GtkWidget *labelAreReducedBy;
+  GtkWidget *labelMaxOverflowImprovement;
+  GtkWidget *labelMaxOverflowDegradation;
+  GtkWidget *vbox18;
+  GtkWidget *entryIBoost;
+  GtkWidget *entryIInterv;
+  GtkWidget *entryIreduction;
+  GtkWidget *entryMaxOvrImp;
+  GtkWidget *entryMaxOvrDeg;
+  GtkWidget *labelTwoPassTuning;
+  GtkWidget *frameCurveCompression;
+  GtkWidget *hbox18;
+  GtkWidget *vbox19;
+  GtkWidget *labelHighBitrateScenes;
+  GtkWidget *labelLowBitrateScenes;
+  GtkWidget *labelOverflowControlStrength;
+  GtkWidget *vbox20;
+  GtkWidget *entryHiPass;
+  GtkWidget *entryLowPass;
+  GtkWidget *entryOvrControl;
+  GtkWidget *labelCurveCompression;
+  GtkWidget *labelSecondPass;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+  GtkTooltips *tooltips;
+
+  GtkWidget *frame_par1;
+  GtkWidget *hbox_par1;
+  GtkWidget *label_par1;
+  GtkWidget *label_par2;
+  GtkWidget *checkbutton_par_asinput;
+  GtkObject *spinbutton_par_width_adj;
+  GtkWidget *spinbutton_par_width;
+  GtkObject *spinbutton_par_height_adj;
+  GtkWidget *spinbutton_par_height;
+
+
+  tooltips = gtk_tooltips_new ();
+
+  dialog1 = gtk_dialog_new ();
+  gtk_container_set_border_width (GTK_CONTAINER (dialog1), 2);
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("XviD encoding options"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  notebook1 = gtk_notebook_new ();
+  gtk_widget_show (notebook1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), notebook1, TRUE, TRUE, 0);
+
+  vbox2 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox2);
+  gtk_container_add (GTK_CONTAINER (notebook1), vbox2);
+  gtk_notebook_set_tab_label_packing (GTK_NOTEBOOK (notebook1), vbox2,
+                                      FALSE, FALSE, GTK_PACK_START);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox2), 5);
+
+  frame1 = gtk_frame_new (NULL);
+  gtk_widget_show (frame1);
+  gtk_box_pack_start (GTK_BOX (vbox2), frame1, FALSE, FALSE, 0);
+
+  vbox3 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox3);
+  gtk_container_add (GTK_CONTAINER (frame1), vbox3);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox3), 5);
+
+  hbox19 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox19);
+  gtk_box_pack_start (GTK_BOX (vbox3), hbox19, TRUE, TRUE, 0);
+
+  vbox21 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox21);
+  gtk_box_pack_start (GTK_BOX (hbox19), vbox21, FALSE, FALSE, 0);
+
+  label10 = gtk_label_new (_("Encoding type:"));
+  gtk_widget_show (label10);
+  gtk_box_pack_start (GTK_BOX (vbox21), label10, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (label10), 0, 0.5);
+
+  label11 = gtk_label_new (_("Bitrate (kb/s):"));
+  gtk_widget_show (label11);
+  gtk_box_pack_start (GTK_BOX (vbox21), label11, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (label11), 0, 0.5);
+
+  label12 = gtk_label_new (_("Quantizer:"));
+  gtk_widget_show (label12);
+  gtk_box_pack_start (GTK_BOX (vbox21), label12, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (label12), 0, 0.5);
+
+  vbox22 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox22);
+  gtk_box_pack_start (GTK_BOX (hbox19), vbox22, FALSE, FALSE, 0);
+
+  optionmenuType = gtk_option_menu_new ();
+  gtk_widget_show (optionmenuType);
+  gtk_box_pack_start (GTK_BOX (vbox22), optionmenuType, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, optionmenuType, _("Select 1-pass or 2-pass encoding"), NULL);
+
+  menu1 = gtk_menu_new ();
+
+  one_pass_cbr1 = gtk_menu_item_new_with_mnemonic (_("Single Pass - Bitrate"));
+  gtk_widget_show (one_pass_cbr1);
+  gtk_container_add (GTK_CONTAINER (menu1), one_pass_cbr1);
+
+  one_pass_quantizer1 = gtk_menu_item_new_with_mnemonic (_("Single Pass - Quantizer"));
+  gtk_widget_show (one_pass_quantizer1);
+  gtk_container_add (GTK_CONTAINER (menu1), one_pass_quantizer1);
+
+  two_pass1 = gtk_menu_item_new_with_mnemonic (_("Two Pass - Video Size"));
+  gtk_widget_show (two_pass1);
+  gtk_container_add (GTK_CONTAINER (menu1), two_pass1);
+
+  two_pass__average_bitrate1 = gtk_menu_item_new_with_mnemonic (_("Two Pass - Average Bitrate"));
+  gtk_widget_show (two_pass__average_bitrate1);
+  gtk_container_add (GTK_CONTAINER (menu1), two_pass__average_bitrate1);
+
+  same_qz_as_input1 = gtk_menu_item_new_with_mnemonic (_("Same Quantizer as Input"));
+  gtk_widget_show (same_qz_as_input1);
+  gtk_container_add (GTK_CONTAINER (menu1), same_qz_as_input1);
+
+  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenuType), menu1);
+
+  entryEntry = gtk_entry_new ();
+  gtk_widget_show (entryEntry);
+  gtk_box_pack_start (GTK_BOX (vbox22), entryEntry, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryEntry, _("Target video bitrate"), NULL);
+  gtk_entry_set_width_chars (GTK_ENTRY (entryEntry), 10);
+
+  spinbuttonQuant_adj = gtk_adjustment_new (4, 1, 31, 0.1, 10, 10);
+  spinbuttonQuant = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuant_adj), 1, 1);
+  gtk_widget_show (spinbuttonQuant);
+  gtk_box_pack_start (GTK_BOX (vbox22), spinbuttonQuant, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonQuant, _("Constant quantizer - each frame will get the same compression"), NULL);
+
+  label9 = gtk_label_new (_("Variable bitrate mode"));
+  gtk_widget_show (label9);
+  gtk_frame_set_label_widget (GTK_FRAME (frame1), label9);
+
+  hbox7 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox7);
+  gtk_box_pack_start (GTK_BOX (vbox2), hbox7, FALSE, FALSE, 0);
+
+  vbox4 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox4);
+  gtk_box_pack_start (GTK_BOX (hbox7), vbox4, FALSE, FALSE, 0);
+
+  checkbuttonInterlaced = gtk_check_button_new_with_mnemonic (_("_Interlaced"));
+  gtk_widget_show (checkbuttonInterlaced);
+  gtk_box_pack_start (GTK_BOX (vbox4), checkbuttonInterlaced, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonInterlaced, _("Enables interlaced frame support - use only if your source contains interlacing artifacts (i.e. fields instead of progressive frames)"), NULL);
+
+  checkbuttonGreyScale = gtk_check_button_new_with_mnemonic (_("_Greyscale"));
+  gtk_widget_show (checkbuttonGreyScale);
+  gtk_box_pack_start (GTK_BOX (vbox4), checkbuttonGreyScale, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonGreyScale, _("Encode in black & white"), NULL);
+
+  vbox5 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox5);
+  gtk_box_pack_start (GTK_BOX (hbox7), vbox5, FALSE, FALSE, 0);
+
+  checkbuttonCartoon = gtk_check_button_new_with_mnemonic (_("Ca_rtoon mode"));
+  gtk_widget_show (checkbuttonCartoon);
+  gtk_box_pack_start (GTK_BOX (vbox5), checkbuttonCartoon, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonCartoon, _("Enables special motion estimation features for cartoons/anime"), NULL);
+
+  checkbuttonChroma = gtk_check_button_new_with_mnemonic (_("C_hroma optimizer"));
+  gtk_widget_show (checkbuttonChroma);
+  gtk_box_pack_start (GTK_BOX (vbox5), checkbuttonChroma, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonChroma, _("Enables a chroma optimizer prefilter"), NULL);
+
+  vbox23 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox23);
+  gtk_box_pack_start (GTK_BOX (hbox7), vbox23, TRUE, TRUE, 0);
+
+  checkbuttonTurbo = gtk_check_button_new_with_mnemonic (_("Turbo Mode"));
+  gtk_widget_show (checkbuttonTurbo);
+  gtk_box_pack_start (GTK_BOX (vbox23), checkbuttonTurbo, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonTurbo, _("Enables fast 1st pass encoding"), NULL);
+
+  checkbuttonPacked = gtk_check_button_new_with_mnemonic (_("Packed bitstream"));
+  gtk_widget_show (checkbuttonPacked);
+  gtk_box_pack_start (GTK_BOX (vbox23), checkbuttonPacked, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonPacked, _("Enables Divx like packed vop, DO NOT SET, it is ugly"), NULL);
+
+  labelMain = gtk_label_new (_("Main"));
+  gtk_widget_show (labelMain);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 0), labelMain);
+
+  vbox6 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox6);
+  gtk_container_add (GTK_CONTAINER (notebook1), vbox6);
+  gtk_notebook_set_tab_label_packing (GTK_NOTEBOOK (notebook1), vbox6,
+                                      FALSE, FALSE, GTK_PACK_START);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox6), 5);
+
+  hbox8 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox8);
+  gtk_box_pack_start (GTK_BOX (vbox6), hbox8, FALSE, FALSE, 0);
+
+  vbox8 = gtk_vbox_new (FALSE, 10);
+  gtk_widget_show (vbox8);
+  gtk_box_pack_start (GTK_BOX (hbox8), vbox8, FALSE, FALSE, 0);
+
+  labelMotionSearchPrecision = gtk_label_new (_("Motion search precision:"));
+  gtk_widget_show (labelMotionSearchPrecision);
+  gtk_box_pack_start (GTK_BOX (vbox8), labelMotionSearchPrecision, TRUE, TRUE, 0);
+
+  labelVHQMode = gtk_label_new (_("VHQ mode:"));
+  gtk_widget_show (labelVHQMode);
+  gtk_box_pack_start (GTK_BOX (vbox8), labelVHQMode, TRUE, TRUE, 0);
+  gtk_label_set_justify (GTK_LABEL (labelVHQMode), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (labelVHQMode), 0, 0.5);
+
+  vbox7 = gtk_vbox_new (FALSE, 10);
+  gtk_widget_show (vbox7);
+  gtk_box_pack_start (GTK_BOX (hbox8), vbox7, FALSE, FALSE, 0);
+
+  optionmenuMS = gtk_option_menu_new ();
+  gtk_widget_show (optionmenuMS);
+  gtk_box_pack_start (GTK_BOX (vbox7), optionmenuMS, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, optionmenuMS, _("Higher settings give higher quality results, at the cost of slower encoding"), NULL);
+
+  menu2 = gtk_menu_new ();
+
+  _0___none1 = gtk_menu_item_new_with_mnemonic (_("0 - None"));
+  gtk_widget_show (_0___none1);
+  gtk_container_add (GTK_CONTAINER (menu2), _0___none1);
+
+  _1___very_low1 = gtk_menu_item_new_with_mnemonic (_("1 - Very low"));
+  gtk_widget_show (_1___very_low1);
+  gtk_container_add (GTK_CONTAINER (menu2), _1___very_low1);
+
+  _2___low2 = gtk_menu_item_new_with_mnemonic (_("2 - Low"));
+  gtk_widget_show (_2___low2);
+  gtk_container_add (GTK_CONTAINER (menu2), _2___low2);
+
+  _3___medium1 = gtk_menu_item_new_with_mnemonic (_("3 - Medium"));
+  gtk_widget_show (_3___medium1);
+  gtk_container_add (GTK_CONTAINER (menu2), _3___medium1);
+
+  _4___high1 = gtk_menu_item_new_with_mnemonic (_("4 - High"));
+  gtk_widget_show (_4___high1);
+  gtk_container_add (GTK_CONTAINER (menu2), _4___high1);
+
+  _5___very_high1 = gtk_menu_item_new_with_mnemonic (_("5 - Very high"));
+  gtk_widget_show (_5___very_high1);
+  gtk_container_add (GTK_CONTAINER (menu2), _5___very_high1);
+
+  _6___ultra_high1 = gtk_menu_item_new_with_mnemonic (_("6 - Ultra high"));
+  gtk_widget_show (_6___ultra_high1);
+  gtk_container_add (GTK_CONTAINER (menu2), _6___ultra_high1);
+
+  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenuMS), menu2);
+
+  optionmenuVHQ = gtk_option_menu_new ();
+  gtk_widget_show (optionmenuVHQ);
+  gtk_box_pack_start (GTK_BOX (vbox7), optionmenuVHQ, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, optionmenuVHQ, _("VHQ enables an additional search process to increase quality"), NULL);
+
+  menu3 = gtk_menu_new ();
+
+  _0___off1 = gtk_menu_item_new_with_mnemonic (_("0 - Off"));
+  gtk_widget_show (_0___off1);
+  gtk_container_add (GTK_CONTAINER (menu3), _0___off1);
+
+  _1___mode_decision1 = gtk_menu_item_new_with_mnemonic (_("1 - Mode decision"));
+  gtk_widget_show (_1___mode_decision1);
+  gtk_container_add (GTK_CONTAINER (menu3), _1___mode_decision1);
+
+  _2___limited_search1 = gtk_menu_item_new_with_mnemonic (_("2 - Limited search"));
+  gtk_widget_show (_2___limited_search1);
+  gtk_container_add (GTK_CONTAINER (menu3), _2___limited_search1);
+
+  _3___medium_search1 = gtk_menu_item_new_with_mnemonic (_("3 - Medium search"));
+  gtk_widget_show (_3___medium_search1);
+  gtk_container_add (GTK_CONTAINER (menu3), _3___medium_search1);
+
+  _4___wide_search1 = gtk_menu_item_new_with_mnemonic (_("4 - Wide search"));
+  gtk_widget_show (_4___wide_search1);
+  gtk_container_add (GTK_CONTAINER (menu3), _4___wide_search1);
+
+  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenuVHQ), menu3);
+
+  hbox10 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox10);
+  gtk_box_pack_start (GTK_BOX (vbox6), hbox10, FALSE, FALSE, 0);
+
+  checkbuttonChromaMotion = gtk_check_button_new_with_mnemonic (_("C_hroma motion"));
+  gtk_widget_show (checkbuttonChromaMotion);
+  gtk_box_pack_start (GTK_BOX (hbox10), checkbuttonChromaMotion, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonChromaMotion, _("Use chroma information to estimate motion"), NULL);
+
+  checkbutton4MV = gtk_check_button_new_with_mnemonic (_("_4MV"));
+  gtk_widget_show (checkbutton4MV);
+  gtk_box_pack_start (GTK_BOX (hbox10), checkbutton4MV, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton4MV, _("Use 4 motion vectors per macroblock, might give better compression"), NULL);
+
+  checkbuttonHQAC = gtk_check_button_new_with_mnemonic (_("HQ _AC"));
+  gtk_widget_show (checkbuttonHQAC);
+  gtk_box_pack_start (GTK_BOX (hbox10), checkbuttonHQAC, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonHQAC, _("Enable a better prediction of AC component. Turns on Lumi masking - applies more compression to dark/light areas that the eye cannot notice easily"), NULL);
+
+  hbox9 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox9);
+  gtk_box_pack_start (GTK_BOX (vbox6), hbox9, FALSE, FALSE, 0);
+
+  labelIFrameIntervalMin = gtk_label_new (_("I-frame interval - Min:"));
+  gtk_widget_show (labelIFrameIntervalMin);
+  gtk_box_pack_start (GTK_BOX (hbox9), labelIFrameIntervalMin, FALSE, FALSE, 0);
+
+  spinbuttonIMinPeriod_adj = gtk_adjustment_new (1, 1, 9, 1, 10, 10);
+  spinbuttonIMinPeriod = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonIMinPeriod_adj), 1, 0);
+  gtk_widget_show (spinbuttonIMinPeriod);
+  gtk_box_pack_start (GTK_BOX (hbox9), spinbuttonIMinPeriod, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonIMinPeriod, _("Minimum space between I-frames, 1 will disable forced I-frame spacing"), NULL);
+
+  labelIFrameIntervalMax = gtk_label_new (_("Max:"));
+  gtk_widget_show (labelIFrameIntervalMax);
+  gtk_box_pack_start (GTK_BOX (hbox9), labelIFrameIntervalMax, FALSE, FALSE, 0);
+
+  spinbuttonIMaxPeriod_adj = gtk_adjustment_new (250, 1, 500, 1, 10, 10);
+  spinbuttonIMaxPeriod = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonIMaxPeriod_adj), 1, 0);
+  gtk_widget_show (spinbuttonIMaxPeriod);
+  gtk_box_pack_start (GTK_BOX (hbox9), spinbuttonIMaxPeriod, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonIMaxPeriod, _("Maximum number of frames allowed between I-frames"), NULL);
+
+  frameAdvancedSimpleProfile = gtk_frame_new (NULL);
+  gtk_widget_show (frameAdvancedSimpleProfile);
+  gtk_box_pack_start (GTK_BOX (vbox6), frameAdvancedSimpleProfile, FALSE, FALSE, 0);
+
+  vbox9 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox9);
+  gtk_container_add (GTK_CONTAINER (frameAdvancedSimpleProfile), vbox9);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox9), 5);
+
+  hbox11 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox11);
+  gtk_box_pack_start (GTK_BOX (vbox9), hbox11, FALSE, FALSE, 0);
+
+  labelNumberOfBFrames = gtk_label_new (_("Number of B-frames:"));
+  gtk_widget_show (labelNumberOfBFrames);
+  gtk_box_pack_start (GTK_BOX (hbox11), labelNumberOfBFrames, FALSE, FALSE, 0);
+
+  spinbuttonBFrame_adj = gtk_adjustment_new (1, 0, 3, 1, 1, 1);
+  spinbuttonBFrame = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBFrame_adj), 1, 0);
+  gtk_widget_show (spinbuttonBFrame);
+  gtk_box_pack_start (GTK_BOX (hbox11), spinbuttonBFrame, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBFrame, _("Maximum number of sequential B-frames (when set to 0, the original I/P encoder is used)"), NULL);
+
+  hbox12 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox12);
+  gtk_box_pack_start (GTK_BOX (vbox9), hbox12, FALSE, FALSE, 0);
+
+  checkbuttonQPel = gtk_check_button_new_with_mnemonic (_("_Qpel"));
+  gtk_widget_show (checkbuttonQPel);
+  gtk_box_pack_start (GTK_BOX (hbox12), checkbuttonQPel, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonQPel, _("Use Quarter pixel resolution for a more precise motion estimation"), NULL);
+
+  checkbuttonGMC = gtk_check_button_new_with_mnemonic (_("_GMC"));
+  gtk_widget_show (checkbuttonGMC);
+  gtk_box_pack_start (GTK_BOX (hbox12), checkbuttonGMC, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonGMC, _("Global Motion Compensation can save bits on camera pans, zooming and rotation"), NULL);
+
+  checkbuttonBVHQ = gtk_check_button_new_with_mnemonic (_("_BVHQ"));
+  gtk_widget_show (checkbuttonBVHQ);
+  gtk_box_pack_start (GTK_BOX (hbox12), checkbuttonBVHQ, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonBVHQ, _("Produces nicer-looking B-frames"), NULL);
+
+  labelAdvancedSimpleProfile = gtk_label_new (_("Advanced Simple Profile"));
+  gtk_widget_show (labelAdvancedSimpleProfile);
+  gtk_frame_set_label_widget (GTK_FRAME (frameAdvancedSimpleProfile), labelAdvancedSimpleProfile);
+
+  frame_par1 = gtk_frame_new (NULL);
+  gtk_widget_show (frame_par1);
+  gtk_box_pack_start (GTK_BOX (vbox6), frame_par1, TRUE, TRUE, 1);
+  hbox_par1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox_par1);
+  gtk_container_add (GTK_CONTAINER (frame_par1), hbox_par1);
+  gtk_container_set_border_width (GTK_CONTAINER (hbox_par1), 5);
+
+  checkbutton_par_asinput = gtk_check_button_new_with_mnemonic (_("As Input"));
+  gtk_widget_show (checkbutton_par_asinput);
+  gtk_box_pack_start (GTK_BOX (hbox_par1), checkbutton_par_asinput, FALSE, FALSE, 10);
+  gtk_tooltips_set_tip (tooltips, checkbutton_par_asinput, _("Get PAR from input video file"), NULL);
+
+  spinbutton_par_width_adj = gtk_adjustment_new (1, 1, 255, 1, 1, 1);
+  spinbutton_par_width = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_par_width_adj), 1, 0);
+  gtk_widget_show (spinbutton_par_width);
+  gtk_box_pack_start (GTK_BOX (hbox_par1), spinbutton_par_width, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbutton_par_width, _("Pixel Width"), NULL);
+
+  label_par1 = gtk_label_new (_(":"));
+  gtk_widget_show (label_par1);
+  gtk_box_pack_start (GTK_BOX (hbox_par1), label_par1, FALSE, FALSE, 2);
+  gtk_label_set_justify (GTK_LABEL (label_par1), GTK_JUSTIFY_CENTER);
+
+  spinbutton_par_height_adj = gtk_adjustment_new (1, 1, 255, 1, 1, 1);
+  spinbutton_par_height = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_par_height_adj), 1, 0);
+  gtk_widget_show (spinbutton_par_height);
+  gtk_box_pack_start (GTK_BOX (hbox_par1), spinbutton_par_height, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbutton_par_height, _("Pixel Height"), NULL);
+  label_par2 = gtk_label_new (_("Pixel Aspect Ratio"));
+  gtk_widget_show (label_par2);
+  gtk_frame_set_label_widget (GTK_FRAME (frame_par1), label_par2);
+  gtk_label_set_use_markup (GTK_LABEL (label_par2), TRUE);
+
+  labelMotionEstimation = gtk_label_new (_("Motion & Misc"));
+  gtk_widget_show (labelMotionEstimation);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 1), labelMotionEstimation);
+
+  vbox10 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox10);
+  gtk_container_add (GTK_CONTAINER (notebook1), vbox10);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox10), 5);
+
+  hbox13 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox13);
+  gtk_box_pack_start (GTK_BOX (vbox10), hbox13, FALSE, FALSE, 0);
+
+  labelQuantizationType = gtk_label_new (_("Quantization type:"));
+  gtk_widget_show (labelQuantizationType);
+  gtk_box_pack_start (GTK_BOX (hbox13), labelQuantizationType, FALSE, FALSE, 0);
+
+  radiobuttonH263 = gtk_radio_button_new_with_mnemonic (NULL, _("_H.263"));
+  gtk_widget_show (radiobuttonH263);
+  gtk_box_pack_start (GTK_BOX (hbox13), radiobuttonH263, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, radiobuttonH263, _("H.263 quantizers smooth the picture (useful at lower bitrates)"), NULL);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonH263), radiobuttonH263_group);
+  radiobuttonH263_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonH263));
+
+  radiobuttonMpeg = gtk_radio_button_new_with_mnemonic (NULL, _("_MPEG"));
+  gtk_widget_show (radiobuttonMpeg);
+  gtk_box_pack_start (GTK_BOX (hbox13), radiobuttonMpeg, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, radiobuttonMpeg, _("MPEG quantizers (slightly slower) produce sharper picture (useful at higher bitrates)"), NULL);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonMpeg), radiobuttonH263_group);
+  radiobuttonH263_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonMpeg));
+
+  radiobuttonCustomMatrix = gtk_radio_button_new_with_mnemonic (NULL, _("_Custom Matrix"));
+  gtk_widget_show (radiobuttonCustomMatrix);
+  gtk_box_pack_start (GTK_BOX (hbox13), radiobuttonCustomMatrix, FALSE, FALSE, 0);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonCustomMatrix), radiobuttonH263_group);
+  radiobuttonH263_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonCustomMatrix));
+
+  hbox20 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox20);
+  gtk_box_pack_start (GTK_BOX (vbox10), hbox20, FALSE, TRUE, 0);
+
+  labelLoadCustomMatrix = gtk_label_new (_("Load Custom Matrix:  "));
+  gtk_widget_show (labelLoadCustomMatrix);
+  gtk_box_pack_start (GTK_BOX (hbox20), labelLoadCustomMatrix, FALSE, FALSE, 0);
+  gtk_label_set_justify (GTK_LABEL (labelLoadCustomMatrix), GTK_JUSTIFY_RIGHT);
+
+  buttonLoadMatrix = gtk_button_new ();
+  gtk_widget_show (buttonLoadMatrix);
+  gtk_box_pack_start (GTK_BOX (hbox20), buttonLoadMatrix, FALSE, FALSE, 0);
+
+  alignment6 = gtk_alignment_new (0.5, 0.5, 0, 0);
+  gtk_widget_show (alignment6);
+  gtk_container_add (GTK_CONTAINER (buttonLoadMatrix), alignment6);
+
+  hbox21 = gtk_hbox_new (FALSE, 2);
+  gtk_widget_show (hbox21);
+  gtk_container_add (GTK_CONTAINER (alignment6), hbox21);
+
+  image1 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_BUTTON);
+  gtk_widget_show (image1);
+  gtk_box_pack_start (GTK_BOX (hbox21), image1, FALSE, FALSE, 0);
+
+  label13 = gtk_label_new_with_mnemonic (_("Open CQM file"));
+  gtk_widget_show (label13);
+  gtk_box_pack_start (GTK_BOX (hbox21), label13, FALSE, FALSE, 0);
+
+  vseparator1 = gtk_vseparator_new ();
+  gtk_widget_show (vseparator1);
+  gtk_box_pack_start (GTK_BOX (hbox20), vseparator1, FALSE, TRUE, 0);
+
+  buttonCreateCustomMatrix = gtk_button_new_with_mnemonic (_("Edit Custom Matrix"));
+  gtk_widget_show (buttonCreateCustomMatrix);
+  gtk_box_pack_start (GTK_BOX (hbox20), buttonCreateCustomMatrix, FALSE, FALSE, 0);
+
+  frameQuantizationRestrictions = gtk_frame_new (NULL);
+  gtk_widget_show (frameQuantizationRestrictions);
+  gtk_box_pack_start (GTK_BOX (vbox10), frameQuantizationRestrictions, FALSE, FALSE, 0);
+
+  hbox14 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox14);
+  gtk_container_add (GTK_CONTAINER (frameQuantizationRestrictions), hbox14);
+  gtk_container_set_border_width (GTK_CONTAINER (hbox14), 5);
+
+  vbox11 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox11);
+  gtk_box_pack_start (GTK_BOX (hbox14), vbox11, FALSE, FALSE, 0);
+
+  labelIFrameQuantizerMin = gtk_label_new (_("I-frame quantizer - Min:"));
+  gtk_widget_show (labelIFrameQuantizerMin);
+  gtk_box_pack_start (GTK_BOX (vbox11), labelIFrameQuantizerMin, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelIFrameQuantizerMin), 0, 0.5);
+
+  labelPFrameQuantizerMin = gtk_label_new (_("P-frame quantizer - Min:"));
+  gtk_widget_show (labelPFrameQuantizerMin);
+  gtk_box_pack_start (GTK_BOX (vbox11), labelPFrameQuantizerMin, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelPFrameQuantizerMin), 0, 0.5);
+
+  labelBFrameQuantizaterMin = gtk_label_new (_("B-frame quantizer - Min:"));
+  gtk_widget_show (labelBFrameQuantizaterMin);
+  gtk_box_pack_start (GTK_BOX (vbox11), labelBFrameQuantizaterMin, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelBFrameQuantizaterMin), 0, 0.5);
+
+  vbox12 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox12);
+  gtk_box_pack_start (GTK_BOX (hbox14), vbox12, FALSE, FALSE, 0);
+
+  spinbuttonIMin_adj = gtk_adjustment_new (2, 1, 31, 1, 10, 10);
+  spinbuttonIMin = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonIMin_adj), 1, 0);
+  gtk_widget_show (spinbuttonIMin);
+  gtk_box_pack_start (GTK_BOX (vbox12), spinbuttonIMin, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonIMin, _("Minimum quantizer allowed for I-frames"), NULL);
+
+  spinbuttonPMin_adj = gtk_adjustment_new (2, 1, 31, 1, 10, 10);
+  spinbuttonPMin = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonPMin_adj), 1, 0);
+  gtk_widget_show (spinbuttonPMin);
+  gtk_box_pack_start (GTK_BOX (vbox12), spinbuttonPMin, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonPMin, _("Minimum quantizer allowed for P-frames"), NULL);
+
+  spinbuttonBMin_adj = gtk_adjustment_new (2, 1, 31, 1, 10, 10);
+  spinbuttonBMin = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBMin_adj), 1, 0);
+  gtk_widget_show (spinbuttonBMin);
+  gtk_box_pack_start (GTK_BOX (vbox12), spinbuttonBMin, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBMin, _("Minimum quantizer allowed for B-frames"), NULL);
+
+  vbox13 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox13);
+  gtk_box_pack_start (GTK_BOX (hbox14), vbox13, FALSE, FALSE, 0);
+
+  labelIFrameQuantizerMax = gtk_label_new (_("Max:"));
+  gtk_widget_show (labelIFrameQuantizerMax);
+  gtk_box_pack_start (GTK_BOX (vbox13), labelIFrameQuantizerMax, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelIFrameQuantizerMax), 0, 0.5);
+
+  labelPFrameQuantizerMax = gtk_label_new (_("Max:"));
+  gtk_widget_show (labelPFrameQuantizerMax);
+  gtk_box_pack_start (GTK_BOX (vbox13), labelPFrameQuantizerMax, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelPFrameQuantizerMax), 0, 0.5);
+
+  labelBFrameQuantizerMax = gtk_label_new (_("Max:"));
+  gtk_widget_show (labelBFrameQuantizerMax);
+  gtk_box_pack_start (GTK_BOX (vbox13), labelBFrameQuantizerMax, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelBFrameQuantizerMax), 0, 0.5);
+
+  vbox14 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox14);
+  gtk_box_pack_start (GTK_BOX (hbox14), vbox14, FALSE, FALSE, 0);
+
+  spinbuttonIMax_adj = gtk_adjustment_new (31, 1, 31, 1, 10, 10);
+  spinbuttonIMax = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonIMax_adj), 1, 0);
+  gtk_widget_show (spinbuttonIMax);
+  gtk_box_pack_start (GTK_BOX (vbox14), spinbuttonIMax, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonIMax, _("Maximum quantizer allowed for I-frames"), NULL);
+
+  spinbuttonPMax_adj = gtk_adjustment_new (31, 1, 31, 1, 10, 10);
+  spinbuttonPMax = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonPMax_adj), 1, 0);
+  gtk_widget_show (spinbuttonPMax);
+  gtk_box_pack_start (GTK_BOX (vbox14), spinbuttonPMax, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonPMax, _("Maximum quantizer allowed for P-frames"), NULL);
+
+  spinbuttonBMax_adj = gtk_adjustment_new (31, 1, 31, 1, 10, 10);
+  spinbuttonBMax = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBMax_adj), 1, 0);
+  gtk_widget_show (spinbuttonBMax);
+  gtk_box_pack_start (GTK_BOX (vbox14), spinbuttonBMax, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBMax, _("Maximum quantizer allowed for B-frames"), NULL);
+
+  labelQuantizerRestrictions = gtk_label_new (_("Quantizer restrictions"));
+  gtk_widget_show (labelQuantizerRestrictions);
+  gtk_frame_set_label_widget (GTK_FRAME (frameQuantizationRestrictions), labelQuantizerRestrictions);
+
+  checkbuttonTrellis = gtk_check_button_new_with_mnemonic (_("_Trellis quantization"));
+  gtk_widget_show (checkbuttonTrellis);
+  gtk_box_pack_start (GTK_BOX (vbox10), checkbuttonTrellis, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonTrellis, _("Rate distortion quantization, will find optimal encoding for each block"), NULL);
+
+  labelQuantization = gtk_label_new (_("Quantization"));
+  gtk_widget_show (labelQuantization);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 2), labelQuantization);
+
+  vbox15 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox15);
+  gtk_container_add (GTK_CONTAINER (notebook1), vbox15);
+  gtk_notebook_set_tab_label_packing (GTK_NOTEBOOK (notebook1), vbox15,
+                                      FALSE, FALSE, GTK_PACK_START);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox15), 5);
+
+  frameTwoPassTuning = gtk_frame_new (NULL);
+  gtk_widget_show (frameTwoPassTuning);
+  gtk_box_pack_start (GTK_BOX (vbox15), frameTwoPassTuning, FALSE, FALSE, 0);
+
+  vbox16 = gtk_vbox_new (FALSE, 10);
+  gtk_widget_show (vbox16);
+  gtk_container_add (GTK_CONTAINER (frameTwoPassTuning), vbox16);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox16), 5);
+
+  hbox = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox);
+  gtk_box_pack_start (GTK_BOX (vbox16), hbox, FALSE, FALSE, 0);
+
+  vbox17 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox17);
+  gtk_box_pack_start (GTK_BOX (hbox), vbox17, TRUE, TRUE, 0);
+
+  labelIFrameBoost = gtk_label_new (_("I-frame boost (%):"));
+  gtk_widget_show (labelIFrameBoost);
+  gtk_box_pack_start (GTK_BOX (vbox17), labelIFrameBoost, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelIFrameBoost), 0, 0.5);
+
+  labelIFrameCloserThan = gtk_label_new (_("I-frames closer than ... frames..."));
+  gtk_widget_show (labelIFrameCloserThan);
+  gtk_box_pack_start (GTK_BOX (vbox17), labelIFrameCloserThan, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelIFrameCloserThan), 0, 0.5);
+
+  labelAreReducedBy = gtk_label_new (_("...are reduced by (%):"));
+  gtk_widget_show (labelAreReducedBy);
+  gtk_box_pack_start (GTK_BOX (vbox17), labelAreReducedBy, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelAreReducedBy), 0, 0.5);
+
+  labelMaxOverflowImprovement = gtk_label_new (_("Max overflow improvement (%):"));
+  gtk_widget_show (labelMaxOverflowImprovement);
+  gtk_box_pack_start (GTK_BOX (vbox17), labelMaxOverflowImprovement, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelMaxOverflowImprovement), 0, 0.5);
+
+  labelMaxOverflowDegradation = gtk_label_new (_("Max overflow degradation (%):"));
+  gtk_widget_show (labelMaxOverflowDegradation);
+  gtk_box_pack_start (GTK_BOX (vbox17), labelMaxOverflowDegradation, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelMaxOverflowDegradation), 0, 0.5);
+
+  vbox18 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox18);
+  gtk_box_pack_start (GTK_BOX (hbox), vbox18, FALSE, FALSE, 0);
+
+  entryIBoost = gtk_entry_new ();
+  gtk_widget_show (entryIBoost);
+  gtk_box_pack_start (GTK_BOX (vbox18), entryIBoost, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryIBoost, _("A value of 20 will give 20% more bits to every I-frame"), NULL);
+
+  entryIInterv = gtk_entry_new ();
+  gtk_widget_show (entryIInterv);
+  gtk_box_pack_start (GTK_BOX (vbox18), entryIInterv, FALSE, FALSE, 0);
+  gtk_widget_set_size_request (entryIInterv, 158, -1);
+  gtk_tooltips_set_tip (tooltips, entryIInterv, _("I-frames appearing in the range below this value will be treated as consecutive keyframes"), NULL);
+
+  entryIreduction = gtk_entry_new ();
+  gtk_widget_show (entryIreduction);
+  gtk_box_pack_start (GTK_BOX (vbox18), entryIreduction, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryIreduction, _("Reduction of bitrate for the first consecutive I-frames. The last I-frame will get treated normally"), NULL);
+
+  entryMaxOvrImp = gtk_entry_new ();
+  gtk_widget_show (entryMaxOvrImp);
+  gtk_box_pack_start (GTK_BOX (vbox18), entryMaxOvrImp, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryMaxOvrImp, _("How much of the overflow the codec can eat into during undersized sections - larger values will bridge the gap faster"), NULL);
+
+  entryMaxOvrDeg = gtk_entry_new ();
+  gtk_widget_show (entryMaxOvrDeg);
+  gtk_box_pack_start (GTK_BOX (vbox18), entryMaxOvrDeg, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryMaxOvrDeg, _("How much of the overflow the codec can eat into during oversized sections - larger values will bridge the gap faster"), NULL);
+
+  labelTwoPassTuning = gtk_label_new (_("Two pass tuning"));
+  gtk_widget_show (labelTwoPassTuning);
+  gtk_frame_set_label_widget (GTK_FRAME (frameTwoPassTuning), labelTwoPassTuning);
+
+  frameCurveCompression = gtk_frame_new (NULL);
+  gtk_widget_show (frameCurveCompression);
+  gtk_box_pack_start (GTK_BOX (vbox15), frameCurveCompression, FALSE, FALSE, 0);
+
+  hbox18 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox18);
+  gtk_container_add (GTK_CONTAINER (frameCurveCompression), hbox18);
+  gtk_container_set_border_width (GTK_CONTAINER (hbox18), 5);
+
+  vbox19 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox19);
+  gtk_box_pack_start (GTK_BOX (hbox18), vbox19, TRUE, TRUE, 0);
+
+  labelHighBitrateScenes = gtk_label_new (_("High bitrate scenes (%):"));
+  gtk_widget_show (labelHighBitrateScenes);
+  gtk_box_pack_start (GTK_BOX (vbox19), labelHighBitrateScenes, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelHighBitrateScenes), 0, 0.5);
+
+  labelLowBitrateScenes = gtk_label_new (_("Low bitrate scenes (%):"));
+  gtk_widget_show (labelLowBitrateScenes);
+  gtk_box_pack_start (GTK_BOX (vbox19), labelLowBitrateScenes, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelLowBitrateScenes), 0, 0.5);
+
+  labelOverflowControlStrength = gtk_label_new (_("Overflow control strength (%):"));
+  gtk_widget_show (labelOverflowControlStrength);
+  gtk_box_pack_start (GTK_BOX (vbox19), labelOverflowControlStrength, TRUE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelOverflowControlStrength), 0, 0.5);
+
+  vbox20 = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (vbox20);
+  gtk_box_pack_start (GTK_BOX (hbox18), vbox20, FALSE, FALSE, 0);
+
+  entryHiPass = gtk_entry_new ();
+  gtk_widget_show (entryHiPass);
+  gtk_box_pack_start (GTK_BOX (vbox20), entryHiPass, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryHiPass, _("The higher this value, the more bits get taken from frames larger than the average size, and redistributed to others"), NULL);
+
+  entryLowPass = gtk_entry_new ();
+  gtk_widget_show (entryLowPass);
+  gtk_box_pack_start (GTK_BOX (vbox20), entryLowPass, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryLowPass, _("The higher this value, the more bits get assigned to frames below the average frame size"), NULL);
+
+  entryOvrControl = gtk_entry_new ();
+  gtk_widget_show (entryOvrControl);
+  gtk_box_pack_start (GTK_BOX (vbox20), entryOvrControl, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, entryOvrControl, _("0 = default from core (let XviD decide), else overflow payback percent per frame"), NULL);
+
+  labelCurveCompression = gtk_label_new (_("Curve compression"));
+  gtk_widget_show (labelCurveCompression);
+  gtk_frame_set_label_widget (GTK_FRAME (frameCurveCompression), labelCurveCompression);
+
+  labelSecondPass = gtk_label_new (_("Second Pass"));
+  gtk_widget_show (labelSecondPass);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 3), labelSecondPass);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, notebook1, "notebook1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, frame1, "frame1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox19, "hbox19");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox21, "vbox21");
+  GLADE_HOOKUP_OBJECT (dialog1, label10, "label10");
+  GLADE_HOOKUP_OBJECT (dialog1, label11, "label11");
+  GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox22, "vbox22");
+  GLADE_HOOKUP_OBJECT (dialog1, optionmenuType, "optionmenuType");
+  GLADE_HOOKUP_OBJECT (dialog1, menu1, "menu1");
+  GLADE_HOOKUP_OBJECT (dialog1, one_pass_cbr1, "one_pass_cbr1");
+  GLADE_HOOKUP_OBJECT (dialog1, one_pass_quantizer1, "one_pass_quantizer1");
+  GLADE_HOOKUP_OBJECT (dialog1, two_pass1, "two_pass1");
+  GLADE_HOOKUP_OBJECT (dialog1, two_pass__average_bitrate1, "two_pass__average_bitrate1");
+  GLADE_HOOKUP_OBJECT (dialog1, same_qz_as_input1, "same_qz_as_input1");
+  GLADE_HOOKUP_OBJECT (dialog1, entryEntry, "entryEntry");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQuant, "spinbuttonQuant");
+  GLADE_HOOKUP_OBJECT (dialog1, label9, "label9");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox7, "hbox7");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox4, "vbox4");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonInterlaced, "checkbuttonInterlaced");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonGreyScale, "checkbuttonGreyScale");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox5, "vbox5");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonCartoon, "checkbuttonCartoon");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonChroma, "checkbuttonChroma");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox23, "vbox23");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonTurbo, "checkbuttonTurbo");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonPacked, "checkbuttonPacked");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMain, "labelMain");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox6, "vbox6");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox8, "hbox8");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox8, "vbox8");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMotionSearchPrecision, "labelMotionSearchPrecision");
+  GLADE_HOOKUP_OBJECT (dialog1, labelVHQMode, "labelVHQMode");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
+  GLADE_HOOKUP_OBJECT (dialog1, optionmenuMS, "optionmenuMS");
+  GLADE_HOOKUP_OBJECT (dialog1, menu2, "menu2");
+  GLADE_HOOKUP_OBJECT (dialog1, _0___none1, "_0___none1");
+  GLADE_HOOKUP_OBJECT (dialog1, _1___very_low1, "_1___very_low1");
+  GLADE_HOOKUP_OBJECT (dialog1, _2___low2, "_2___low2");
+  GLADE_HOOKUP_OBJECT (dialog1, _3___medium1, "_3___medium1");
+  GLADE_HOOKUP_OBJECT (dialog1, _4___high1, "_4___high1");
+  GLADE_HOOKUP_OBJECT (dialog1, _5___very_high1, "_5___very_high1");
+  GLADE_HOOKUP_OBJECT (dialog1, _6___ultra_high1, "_6___ultra_high1");
+  GLADE_HOOKUP_OBJECT (dialog1, optionmenuVHQ, "optionmenuVHQ");
+  GLADE_HOOKUP_OBJECT (dialog1, menu3, "menu3");
+  GLADE_HOOKUP_OBJECT (dialog1, _0___off1, "_0___off1");
+  GLADE_HOOKUP_OBJECT (dialog1, _1___mode_decision1, "_1___mode_decision1");
+  GLADE_HOOKUP_OBJECT (dialog1, _2___limited_search1, "_2___limited_search1");
+  GLADE_HOOKUP_OBJECT (dialog1, _3___medium_search1, "_3___medium_search1");
+  GLADE_HOOKUP_OBJECT (dialog1, _4___wide_search1, "_4___wide_search1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox10, "hbox10");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonChromaMotion, "checkbuttonChromaMotion");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton4MV, "checkbutton4MV");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonHQAC, "checkbuttonHQAC");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox9, "hbox9");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameIntervalMin, "labelIFrameIntervalMin");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonIMinPeriod, "spinbuttonIMinPeriod");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameIntervalMax, "labelIFrameIntervalMax");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonIMaxPeriod, "spinbuttonIMaxPeriod");
+  GLADE_HOOKUP_OBJECT (dialog1, frameAdvancedSimpleProfile, "frameAdvancedSimpleProfile");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox9, "vbox9");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox11, "hbox11");
+  GLADE_HOOKUP_OBJECT (dialog1, labelNumberOfBFrames, "labelNumberOfBFrames");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBFrame, "spinbuttonBFrame");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox12, "hbox12");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonQPel, "checkbuttonQPel");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonGMC, "checkbuttonGMC");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBVHQ, "checkbuttonBVHQ");
+  GLADE_HOOKUP_OBJECT (dialog1, labelAdvancedSimpleProfile, "labelAdvancedSimpleProfile");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton_par_asinput, "checkbutton_par_asinput");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton_par_width, "spinbutton_par_width");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton_par_height, "spinbutton_par_height");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMotionEstimation, "labelMotionEstimation");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox10, "vbox10");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox13, "hbox13");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizationType, "labelQuantizationType");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonH263, "radiobuttonH263");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonMpeg, "radiobuttonMpeg");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonCustomMatrix, "radiobuttonCustomMatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox20, "hbox20");
+  GLADE_HOOKUP_OBJECT (dialog1, labelLoadCustomMatrix, "labelLoadCustomMatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonLoadMatrix, "buttonLoadMatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment6, "alignment6");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox21, "hbox21");
+  GLADE_HOOKUP_OBJECT (dialog1, image1, "image1");
+  GLADE_HOOKUP_OBJECT (dialog1, label13, "label13");
+  GLADE_HOOKUP_OBJECT (dialog1, vseparator1, "vseparator1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonCreateCustomMatrix, "buttonCreateCustomMatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, frameQuantizationRestrictions, "frameQuantizationRestrictions");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox14, "hbox14");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox11, "vbox11");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameQuantizerMin, "labelIFrameQuantizerMin");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPFrameQuantizerMin, "labelPFrameQuantizerMin");
+  GLADE_HOOKUP_OBJECT (dialog1, labelBFrameQuantizaterMin, "labelBFrameQuantizaterMin");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox12, "vbox12");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonIMin, "spinbuttonIMin");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonPMin, "spinbuttonPMin");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBMin, "spinbuttonBMin");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox13, "vbox13");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameQuantizerMax, "labelIFrameQuantizerMax");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPFrameQuantizerMax, "labelPFrameQuantizerMax");
+  GLADE_HOOKUP_OBJECT (dialog1, labelBFrameQuantizerMax, "labelBFrameQuantizerMax");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox14, "vbox14");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonIMax, "spinbuttonIMax");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonPMax, "spinbuttonPMax");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBMax, "spinbuttonBMax");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizerRestrictions, "labelQuantizerRestrictions");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonTrellis, "checkbuttonTrellis");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantization, "labelQuantization");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox15, "vbox15");
+  GLADE_HOOKUP_OBJECT (dialog1, frameTwoPassTuning, "frameTwoPassTuning");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox16, "vbox16");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox, "hbox");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox17, "vbox17");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameBoost, "labelIFrameBoost");
+  GLADE_HOOKUP_OBJECT (dialog1, labelIFrameCloserThan, "labelIFrameCloserThan");
+  GLADE_HOOKUP_OBJECT (dialog1, labelAreReducedBy, "labelAreReducedBy");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMaxOverflowImprovement, "labelMaxOverflowImprovement");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMaxOverflowDegradation, "labelMaxOverflowDegradation");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox18, "vbox18");
+  GLADE_HOOKUP_OBJECT (dialog1, entryIBoost, "entryIBoost");
+  GLADE_HOOKUP_OBJECT (dialog1, entryIInterv, "entryIInterv");
+  GLADE_HOOKUP_OBJECT (dialog1, entryIreduction, "entryIreduction");
+  GLADE_HOOKUP_OBJECT (dialog1, entryMaxOvrImp, "entryMaxOvrImp");
+  GLADE_HOOKUP_OBJECT (dialog1, entryMaxOvrDeg, "entryMaxOvrDeg");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTwoPassTuning, "labelTwoPassTuning");
+  GLADE_HOOKUP_OBJECT (dialog1, frameCurveCompression, "frameCurveCompression");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox18, "hbox18");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox19, "vbox19");
+  GLADE_HOOKUP_OBJECT (dialog1, labelHighBitrateScenes, "labelHighBitrateScenes");
+  GLADE_HOOKUP_OBJECT (dialog1, labelLowBitrateScenes, "labelLowBitrateScenes");
+  GLADE_HOOKUP_OBJECT (dialog1, labelOverflowControlStrength, "labelOverflowControlStrength");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox20, "vbox20");
+  GLADE_HOOKUP_OBJECT (dialog1, entryHiPass, "entryHiPass");
+  GLADE_HOOKUP_OBJECT (dialog1, entryLowPass, "entryLowPass");
+  GLADE_HOOKUP_OBJECT (dialog1, entryOvrControl, "entryOvrControl");
+  GLADE_HOOKUP_OBJECT (dialog1, labelCurveCompression, "labelCurveCompression");
+  GLADE_HOOKUP_OBJECT (dialog1, labelSecondPass, "labelSecondPass");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, tooltips, "tooltips");
+
+  return dialog1;
+}
+
+GtkWidget*
+create_dialog3 (void)
+{
+  GtkWidget *dialog3;
+  GtkWidget *dialog_vbox3;
+  GtkWidget *vbox26;
+  GtkWidget *frame7;
+  GtkWidget *alignment12;
+  GtkWidget *tableIntra;
+  GtkWidget *label19;
+  GtkWidget *frame6;
+  GtkWidget *alignment11;
+  GtkWidget *tableInter;
+  GtkWidget *label18;
+  GtkWidget *dialog_action_area4;
+  GtkWidget *button12;
+  GtkWidget *button13;
+  GtkWidget *button14;
+
+  dialog3 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog3), _("Edit Custom Matrix"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog3), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox3 = GTK_DIALOG (dialog3)->vbox;
+  gtk_widget_show (dialog_vbox3);
+
+  vbox26 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox26);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox3), vbox26, TRUE, TRUE, 0);
+
+  frame7 = gtk_frame_new (NULL);
+  gtk_widget_show (frame7);
+  gtk_box_pack_start (GTK_BOX (vbox26), frame7, TRUE, TRUE, 0);
+
+  alignment12 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment12);
+  gtk_container_add (GTK_CONTAINER (frame7), alignment12);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment12), 0, 0, 12, 0);
+
+  tableIntra = gtk_table_new (8, 8, FALSE);
+  gtk_widget_show (tableIntra);
+  gtk_container_add (GTK_CONTAINER (alignment12), tableIntra);
+
+  label19 = gtk_label_new (_("<b>Intra Matrix</b>"));
+  gtk_widget_show (label19);
+  gtk_frame_set_label_widget (GTK_FRAME (frame7), label19);
+  gtk_label_set_use_markup (GTK_LABEL (label19), TRUE);
+
+  frame6 = gtk_frame_new (NULL);
+  gtk_widget_show (frame6);
+  gtk_box_pack_start (GTK_BOX (vbox26), frame6, TRUE, TRUE, 0);
+
+  alignment11 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment11);
+  gtk_container_add (GTK_CONTAINER (frame6), alignment11);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment11), 0, 0, 12, 0);
+
+  tableInter = gtk_table_new (8, 8, FALSE);
+  gtk_widget_show (tableInter);
+  gtk_container_add (GTK_CONTAINER (alignment11), tableInter);
+
+  label18 = gtk_label_new (_("<b>Inter Matrix</b>"));
+  gtk_widget_show (label18);
+  gtk_frame_set_label_widget (GTK_FRAME (frame6), label18);
+  gtk_label_set_use_markup (GTK_LABEL (label18), TRUE);
+
+  dialog_action_area4 = GTK_DIALOG (dialog3)->action_area;
+  gtk_widget_show (dialog_action_area4);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area4), GTK_BUTTONBOX_END);
+
+  button12 = gtk_button_new_from_stock ("gtk-save");
+  gtk_widget_show (button12);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog3), button12, 0);
+  GTK_WIDGET_SET_FLAGS (button12, GTK_CAN_DEFAULT);
+
+  button13 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (button13);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog3), button13, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (button13, GTK_CAN_DEFAULT);
+
+  button14 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (button14);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog3), button14, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (button14, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog3, dialog3, "dialog3");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog3, dialog_vbox3, "dialog_vbox3");
+  GLADE_HOOKUP_OBJECT (dialog3, vbox26, "vbox26");
+  GLADE_HOOKUP_OBJECT (dialog3, frame7, "frame7");
+  GLADE_HOOKUP_OBJECT (dialog3, alignment12, "alignment12");
+  GLADE_HOOKUP_OBJECT (dialog3, tableIntra, "tableIntra");
+  GLADE_HOOKUP_OBJECT (dialog3, label19, "label19");
+  GLADE_HOOKUP_OBJECT (dialog3, frame6, "frame6");
+  GLADE_HOOKUP_OBJECT (dialog3, alignment11, "alignment11");
+  GLADE_HOOKUP_OBJECT (dialog3, tableInter, "tableInter");
+  GLADE_HOOKUP_OBJECT (dialog3, label18, "label18");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog3, dialog_action_area4, "dialog_action_area4");
+  GLADE_HOOKUP_OBJECT (dialog3, button12, "button12");
+  GLADE_HOOKUP_OBJECT (dialog3, button13, "button13");
+  GLADE_HOOKUP_OBJECT (dialog3, button14, "button14");
+
+  return dialog3;
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/xvidConfigDialog.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,9 @@
+#ifndef xvidConfigDialog_h
+#define xvidConfigDialog_h
+
+extern "C"
+{
+#include "ADM_vidEnc_plugin.h"
+}
+
+#endif	// xvidConfigDialog_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/interface.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/interface.c	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/interface.c	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,127 @@
+/***************************************************************************
+                                 interface.c
+
+    begin                : Wed Jun 11 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_inttype.h"
+#include "ADM_vidEnc_plugin.h"
+#include "encoder.h"
+
+int vidEncGetEncoders(int uiType, int** encoderIds)
+{
+	if (uiType == ADM_UI_CLI || uiType == ADM_UI_GTK || uiType == ADM_UI_QT4)
+	{
+		*encoderIds = encoders_getPointer(uiType);
+		return ADM_VIDENC_ERR_SUCCESS;
+	}
+	else
+	{
+		*encoderIds = NULL;
+		return ADM_VIDENC_ERR_FAILED;
+	}
+}
+
+const char* vidEncGetEncoderName(int encoderId)
+{
+	return "Xvid";
+}
+
+const char* vidEncGetEncoderType(int encoderId)
+{
+	return "MPEG-4 ASP";
+}
+
+const char* vidEncGetEncoderDescription(int encoderId)
+{
+	return "Xvid video encoder plugin for Avidemux (c) Mean/Gruntster";
+}
+
+const char* vidEncGetFourCC(int encoderId)
+{
+	return "xvid";
+}
+
+int vidEncGetEncoderApiVersion(int encoderId)
+{
+	return ADM_VIDENC_API_VERSION;
+}
+
+void vidEncGetEncoderVersion(int encoderId, int* major, int* minor, int* patch)
+{
+	*major = 1;
+	*minor = 0;
+	*patch = 0;
+}
+
+const char* vidEncGetEncoderGuid(int encoderId)
+{
+	return "92B544BE-59A3-4720-86F0-6AD5A2526FD2";
+}
+
+int vidEncIsConfigurable(int encoderId)
+{
+	return xvidEncoder_isConfigurable();
+}
+
+int vidEncConfigure(int encoderId, vidEncConfigParameters *configParameters, vidEncVideoProperties *properties)
+{
+	return xvidEncoder_configure(configParameters, properties);
+}
+
+int vidEncGetOptions(int encoderId, vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize)
+{
+	return xvidEncoder_getOptions(encodeOptions, pluginOptions, bufferSize);
+}
+
+int vidEncSetOptions(int encoderId, vidEncOptions *encodeOptions, char *pluginOptions)
+{
+	return xvidEncoder_setOptions(encodeOptions, pluginOptions);
+}
+
+int vidEncGetPassCount(int encoderId)
+{
+	return xvidEncoder_getPassCount();
+}
+
+int vidEncGetCurrentPass(int encoderId)
+{
+	return xvidEncoder_getCurrentPass();
+}
+
+int vidEncOpen(int encoderId, vidEncVideoProperties *properties)
+{
+	return xvidEncoder_open(properties);
+}
+
+int vidEncBeginPass(int encoderId, vidEncPassParameters *passParameters)
+{
+	return xvidEncoder_beginPass(passParameters);
+}
+
+int vidEncEncodeFrame(int encoderId, vidEncEncodeParameters *encodeParams)
+{
+	return xvidEncoder_encodeFrame(encodeParams);
+}
+
+int vidEncFinishPass(int encoderId)
+{
+	return xvidEncoder_finishPass();
+}
+
+int vidEncClose(int encoderId)
+{
+	xvidEncoder_close();
+
+	return ADM_VIDENC_ERR_SUCCESS;
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,34 @@
+ /***************************************************************************
+                               xvidOptions.cpp
+
+	These settings are intended for scripting and can contain a Preset 
+	Configuration block.  If this block exists then "internal" settings are
+	ignored and an external configuration file should be read instead, 
+	e.g. PlayStation Portable profile.  However, if the external file is 
+	missing, internal settings have to be used and will reflect a snapshot
+	of the external configuration file at the time the script was generated.
+
+    begin                : Fri Jun 13 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "options.h"
+
+xvidOptions::xvidOptions(void)
+{
+
+}
+
+xvidOptions::~xvidOptions(void)
+{
+
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,27 @@
+/***************************************************************************
+                                xvidOptions.h
+
+    begin                : Fri Jun 13 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef options_h
+#define options_h
+
+class xvidOptions
+{
+public:
+	xvidOptions(void);
+	~xvidOptions(void);
+};
+
+#endif	// options_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,15 @@
+INCLUDE(admCheckQt4)
+INCLUDE(admPluginVideoEncoder)
+
+checkQt4()
+
+IF (QT4_FOUND)
+	SET(ADM_vidEnc_xvid_Qt_SRCS xvidConfigDialog.cpp)
+
+	INCLUDE_DIRECTORIES(${QT_INCLUDE_DIR} ${AVIDEMUX_SOURCE_DIR}/avidemux)
+	ADD_LIBRARY(${QT_PLUGIN_NAME} SHARED ${ADM_vidEnc_xvid_Qt_SRCS})
+	TARGET_LINK_LIBRARIES(${QT_PLUGIN_NAME} ADM_vidEnc_xvid ADM_coreUI ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
+
+	INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid_Qt)
+	INSTALL(TARGETS ADM_vidEnc_xvid_Qt DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+ENDIF (QT4_FOUND)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,141 @@
+/***************************************************************************
+                    xvidConfigDialog.cpp  -  description
+                    ------------------------------------
+
+                          GUI for configuring Xvid
+
+    begin                : Fri Jun 13 2008
+    copyright            : (C) 2008 by mean/gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include <QtCore/QtGlobal>
+
+#include "ADM_inttype.h"
+#include "DIA_factory.h"
+
+#include "../options.h"
+
+#include "xvidConfigDialog.h"
+
+extern "C" int showXvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, xvidOptions *options)
+{
+	int b;
+	int ret=0;
+	int code;
+	uint32_t dummy;
+//	xvid4EncParam localParam;
+//	ADM_assert(incoming->extraSettingsLen==sizeof(localParam));
+//	memcpy(&localParam,incoming->extraSettings,sizeof(localParam));
+#define PX(x) &dummy
+	// Our tabs
+	/* Tab 1 main */
+	//diaElemBitrate bitrate(NULL,NULL);
+#define MKTOGGLE(y,x)           diaElemToggle  t_##x(PX(x),y)
+	MKTOGGLE(QT_TR_NOOP("_Interlaced"),	    interlaced);
+	MKTOGGLE(QT_TR_NOOP("Ca_rtoon mode"),      cartoon);
+	MKTOGGLE(QT_TR_NOOP("_Greyscale"),         greyscale);
+	MKTOGGLE(QT_TR_NOOP("Turbo mode"),      turbo);
+	MKTOGGLE(QT_TR_NOOP("C_hroma optimizer"),         chroma_opt);
+	//diaElem *main[]={&bitrate,&t_interlaced,&t_cartoon,&t_greyscale,&t_turbo,&t_chroma_opt};
+	diaElem *main[]={&t_interlaced,&t_cartoon,&t_greyscale,&t_turbo,&t_chroma_opt};
+	diaElemTabs tabMain(QT_TR_NOOP("Main"),5,main);
+	/* Tab 2 motion */
+	diaMenuEntry motionMenu[] = {
+		{0,       QT_TR_NOOP("None"),NULL}
+		,{1,      QT_TR_NOOP("Very Low"),NULL}
+		,{2,      QT_TR_NOOP("Low"),NULL}
+		,{3,      QT_TR_NOOP("Medium"),NULL}
+		,{4,      QT_TR_NOOP("High"),NULL}
+		,{5,      QT_TR_NOOP("Very High"),NULL}
+		,{6,      QT_TR_NOOP("Ultra High"),NULL}};
+
+	diaElemMenu motion(PX(guiLevel),QT_TR_NOOP("Motion Search Precision"),7,motionMenu);
+
+	diaMenuEntry vhqMenu[] = {
+		{0,       QT_TR_NOOP("Off"),NULL}
+		,{1,      QT_TR_NOOP("Mode Decision"),NULL}
+		,{2,      QT_TR_NOOP("Limited Search"),NULL}
+		,{3,      QT_TR_NOOP("Medium Search"),NULL}
+		,{4,      QT_TR_NOOP("Wide Search"),NULL} };
+
+	diaElemMenu vhq(PX(vhqmode),QT_TR_NOOP("VHQ Mode"),5,vhqMenu);
+
+	/* Tab2-ASP */
+	diaElemUInteger  bframe(PX(bframes),QT_TR_NOOP("Max B Frames"),0,3);
+	diaElemToggle    qpel(PX(qpel),QT_TR_NOOP("Quarter Pixel"));
+	diaElemToggle    gmc(PX(gmc),QT_TR_NOOP("GMC"));
+	diaElemToggle    bvhq(PX(bvhq),QT_TR_NOOP("BVHQ"));
+	diaElemFrame  frameASP(QT_TR_NOOP("Advanced Simple Profile"));
+	frameASP.swallow(&bframe);
+	frameASP.swallow(&qpel);
+	frameASP.swallow(&gmc);
+	frameASP.swallow(&bvhq);
+
+	/* Tab 2 motion extra */
+	diaElemToggle    inter4mv(PX(inter4mv),QT_TR_NOOP("4MV"));
+	diaElemToggle    chroma_me(PX(chroma_me),QT_TR_NOOP("Chroma ME"));
+	diaElemToggle    hqac(PX(chroma_me),QT_TR_NOOP("HQ AC"));
+	diaElemFrame  frameMore(QT_TR_NOOP("More Search"));
+	frameMore.swallow(&inter4mv);
+	frameMore.swallow(&chroma_me);
+	frameMore.swallow(&hqac);
+	/* Tab 2 gop size */
+	diaElemUInteger  min_key_interval(PX(min_key_interval),QT_TR_NOOP("Min Gop Size"),1,900);
+	diaElemUInteger  max_key_interval(PX(max_key_interval),QT_TR_NOOP("Max Gop Size"),1,900);
+	diaElemFrame  frameGop(QT_TR_NOOP("GOP Size"));
+	frameGop.swallow(&min_key_interval);
+	frameGop.swallow(&max_key_interval);
+
+	diaElem *motions[]={&motion,&vhq,&frameMore,&frameGop,&frameASP};
+	diaElemTabs tabMotion(QT_TR_NOOP("Motion"),5,motions);
+
+	/* Tab 3 Qz*/
+	diaMenuEntry qzMenu[] = {
+		{0,       QT_TR_NOOP("H263"),NULL}
+		,{1,      QT_TR_NOOP("Mpeg"),NULL}}                            ;
+	diaElemMenu h263(PX(mpegQuantizer),QT_TR_NOOP("Quantization Matrix"),2,qzMenu);
+	diaElemToggle    trellis(PX(trellis),QT_TR_NOOP("Trellis Quantization"));
+
+	diaElem *qz[]={&h263,&trellis};
+	diaElemTabs tabQz(QT_TR_NOOP("Quantization"),2,qz);
+
+		/* Tab 4 : 2nd pass */
+#define MKENTRY(y,x) diaElemUInteger x(PX(x),y,0,100); frameOne.swallow(&x);
+	diaElemFrame  frameOne(QT_TR_NOOP("Two Pass Tuning")); 
+
+	MKENTRY(QT_TR_NOOP("Key Frame Boost(%)"), keyframe_boost);
+
+	MKENTRY(QT_TR_NOOP("I-frames closer than..."), kfthreshold);
+	MKENTRY(QT_TR_NOOP(".. are reduced by(%)"), kfreduction);
+	MKENTRY(QT_TR_NOOP("Max Overflow Improvement(%)"), max_overflow_improvement);
+	MKENTRY(QT_TR_NOOP("Max Overglow Degradation(%)"), max_overflow_degradation);
+
+#undef MKENTRY
+#define MKENTRY(y,x) diaElemUInteger  x(PX(x),y,0,100);frameTwo.swallow(&x);
+	diaElemFrame  frameTwo(QT_TR_NOOP("Curve Compression"));
+
+	MKENTRY(QT_TR_NOOP("High Bitrate Scenes (%)"), curve_compression_high);
+	MKENTRY(QT_TR_NOOP("Low Bitrate Scenes (%)"), curve_compression_low);
+	MKENTRY(QT_TR_NOOP("Overflow Control Strength"), overflow_control_strength);
+
+	diaElem *twopass[]={&frameOne,&frameTwo};
+	diaElemTabs tabPass(QT_TR_NOOP("Two Pass"),2,twopass);
+
+	/* End of tabs */
+	diaElemTabs *tabs[4]={&tabMain,&tabMotion,&tabQz,&tabPass};
+	if( diaFactoryRunTabs(QT_TR_NOOP("Xvid4 Configuration"),4,tabs))
+	{
+		//memcpy(incoming->extraSettings,&localParam,sizeof(localParam));
+		return 1;
+	}
+
+	return 0;
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h	2008-06-13 12:18:36 UTC (rev 4095)
@@ -0,0 +1,9 @@
+#ifndef xvidConfigDialog_h
+#define xvidConfigDialog_h
+
+extern "C"
+{
+#include "ADM_vidEnc_plugin.h"
+}
+
+#endif	// xvidConfigDialog_h

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt	2008-06-11 11:40:29 UTC (rev 4094)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt	2008-06-13 12:18:36 UTC (rev 4095)
@@ -1 +1,2 @@
-ADD_SUBDIRECTORY(ADM_vidEnc_x264)
\ No newline at end of file
+ADD_SUBDIRECTORY(ADM_vidEnc_x264)
+ADD_SUBDIRECTORY(ADM_vidEnc_xvid)
\ No newline at end of file



From gruntster at mail.berlios.de  Sat Jun 14 17:25:04 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Jun 2008 17:25:04 +0200
Subject: [Avidemux-svn-commit] r4096 - branches/avidemux_2.4_branch/po
Message-ID: <200806141525.m5EFP464003981@sheep.berlios.de>

Author: gruntster
Date: 2008-06-14 17:24:47 +0200 (Sat, 14 Jun 2008)
New Revision: 4096

Modified:
   branches/avidemux_2.4_branch/po/avidemux_it.ts
   branches/avidemux_2.4_branch/po/it.po
Log:
[I18N] Italian update by zoppo

Modified: branches/avidemux_2.4_branch/po/avidemux_it.ts
===================================================================
--- branches/avidemux_2.4_branch/po/avidemux_it.ts	2008-06-13 12:18:36 UTC (rev 4095)
+++ branches/avidemux_2.4_branch/po/avidemux_it.ts	2008-06-14 15:24:47 UTC (rev 4096)
@@ -1,6 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE TS><TS version="1.1" language="it">
-<defaultcodec></defaultcodec>
 <context>
     <name></name>
     <message>
@@ -846,7 +845,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="60"/>
         <source>Kernel interpolation</source>
-        <translation>Interpolazione Kernel</translation>
+        <translation>Interpolazione kernel</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="61"/>
@@ -951,7 +950,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="102"/>
         <source>_Denoise</source>
-        <translation>_Rimuovi interferenza</translation>
+        <translation>_Rimuovi rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="103"/>
@@ -1332,7 +1331,7 @@
         <translation>_Modalit?:</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="196"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="189"/>
         <source>Codec Error</source>
         <translation>Errore codec</translation>
     </message>
@@ -1410,7 +1409,7 @@
         <translation>PSP</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="283"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="277"/>
         <source>FLV</source>
         <translation>FLV</translation>
     </message>
@@ -1530,17 +1529,17 @@
         <translation>Sconosciuto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="87"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="78"/>
         <source>Output file error</source>
         <translation>Errore file di uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="87"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="78"/>
         <source>Could not open &quot;%s&quot; for writing.</source>
         <translation>Impossibile aprire &quot;%s&quot; per la scrittura.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="105"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="100"/>
         <source>Problem loading sub</source>
         <translation>Problema di caricamento sottotitoli</translation>
     </message>
@@ -1740,27 +1739,27 @@
 Spostare il segnalibro A.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="151"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="145"/>
         <source>Unsupported video</source>
         <translation>Video non supportato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="151"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="145"/>
         <source>Only FLV1 and VP6 video are supported</source>
         <translation>Sono supportati solo i video FLV1 e VP6</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="178"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="172"/>
         <source>Unsupported audio</source>
         <translation>Audio non supportato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="173"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="167"/>
         <source>Audio must be mp3 for flv output.</source>
         <translation>L&apos;audio di un video flv deve essere mp3.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="178"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="172"/>
         <source>Frequency must be 44100, 22050 or 11025 Hz.</source>
         <translation>La frequenza deve essere 44100, 22050 o 11025 Hz.</translation>
     </message>
@@ -2038,7 +2037,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp" line="120"/>
         <source>Noise Reduction</source>
-        <translation>Riduzione interferenza</translation>
+        <translation>Riduzione rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp" line="121"/>
@@ -2166,62 +2165,62 @@
         <translation>Filtro video parziale</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp" line="822"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp" line="851"/>
         <source>%c (%02d)</source>
         <translation>%c (%02d)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="92"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="85"/>
         <source>Select idx file:</source>
         <translation>Seleziona un file idx:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="210"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="202"/>
         <source>Use glyphset (optional):</source>
         <translation>Usa set di glifi (opzionale):</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="203"/>
         <source>Output SRT file</source>
         <translation>File SRT in uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="222"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="214"/>
         <source>Select input and ouput files</source>
         <translation>Seleziona file di ingresso e di uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="246"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="238"/>
         <source>The idx/sub file does not exist.</source>
         <translation>Il file idx/sub non esiste.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="239"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="231"/>
         <source>Please Select a valid output SRT file.</source>
         <translation>Seleziona un file SRT in uscita valido.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="255"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="247"/>
         <source>Cannot load the glyphset file.</source>
         <translation>Impossibile caricare il set di glifi.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="158"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="149"/>
         <source>Save Glyph</source>
         <translation>Salva glifo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="200"/>
         <source>Input TS:</source>
         <translation>TS in ingresso:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="209"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="201"/>
         <source>Subtitle PID:</source>
         <translation>PID sottotitoli:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="233"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="225"/>
         <source>Please Select a valid TS file.</source>
         <translation>Seleziona un file TS valido.</translation>
     </message>
@@ -2238,7 +2237,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp" line="189"/>
         <source>_Use libavcodec MPEG-2 decoder</source>
-        <translation>_Usa decodificatore libavcodec MPEG-2</translation>
+        <translation>_Usa libavcodec come decodificatore MPEG-2</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp" line="190"/>
@@ -3177,24 +3176,24 @@
         <translation>? necessaria una traccia audio per creare questo tipo di file</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="121"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="114"/>
         <source>You don&apos;t have LAME!.
 It is needed to create FLV  video.</source>
         <translation>Non disponi di LAME!
 ? necessario per creare video FLV.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="135"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="128"/>
         <source>Cannot select FLV1  codec.</source>
         <translation>Impossibile selezionare il codec FLV1.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="162"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="155"/>
         <source>Cannot select mpeg4 sp codec.</source>
         <translation>Impossibile selezionare il codec mpeg4 sp.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="197"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="190"/>
         <source>You don&apos;t have FAAC!.
 It is needed to create PSP compatible video.</source>
         <translation>Non disponi di FAAC.
@@ -3298,7 +3297,7 @@
         <translation>Prova uinteger</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="93"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="86"/>
         <source>Use GlyphSet (optional):</source>
         <translation>Usa set di glifi (opzionale):</translation>
     </message>
@@ -3308,27 +3307,27 @@
         <translation>Seleziona il set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="203"/>
         <source>Save SRT file</source>
         <translation>Salva il file SRT</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="276"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="268"/>
         <source>GlyphSet filename</source>
         <translation>Nome file del set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="276"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="268"/>
         <source>Save GlyphSet file</source>
         <translation>Salva il set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="200"/>
         <source>Select TS file</source>
         <translation>Seleziona un file TS</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="278"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="270"/>
         <source>Save GlyphSet</source>
         <translation>Salva il set di glifi</translation>
     </message>
@@ -3820,7 +3819,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="130"/>
         <source>Reduce noise, smooth image, increase compressibility.</source>
-        <translation>Riduce l&apos;interferenza, leviga le immagini, aumenta la comprimibilit?.</translation>
+        <translation>Riduce il rumore, leviga le immagini, aumenta la comprimibilit?.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="131"/>
@@ -3850,12 +3849,12 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="134"/>
         <source>Vlad59&apos;s Avisynth port of Jim Casaburi&apos;s denoiser.</source>
-        <translation>Port Avisynth di Vlad59 del filtro di rimozione di interferenza di Jim Casaburi.</translation>
+        <translation>Port Avisynth di Vlad59 del filtro di rimozione del rumore di Jim Casaburi.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="136"/>
         <source>Denoise</source>
-        <translation>Rimozione interferenza</translation>
+        <translation>Rimozione rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="136"/>
@@ -3870,7 +3869,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="137"/>
         <source>Light denoiser.</source>
-        <translation>Rimozione interferenza leggera.</translation>
+        <translation>Rimozione rumore leggera.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="139"/>
@@ -3880,7 +3879,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="139"/>
         <source>Chroma noise reduction filter by MarcFD/Tritical.</source>
-        <translation>Filtro di riduzione interferenza croma di MarcFD/Tritical.</translation>
+        <translation>Filtro di riduzione rumore croma di MarcFD/Tritical.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="141"/>
@@ -3920,7 +3919,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="148"/>
         <source>Sharpen edges without amplifying noise. By Donald Graft.</source>
-        <translation>Rende nitidi i margini senza amplificare l&apos;interferenza. Di Donald Graft.</translation>
+        <translation>Rende nitidi i margini senza amplificare il rumore. Di Donald Graft.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="149"/>
@@ -3950,7 +3949,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="152"/>
         <source>Mean (blur) kernel.</source>
-        <translation>Media (sfocatura) kernel.</translation>
+        <translation>Kernel media (sfocatura).</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="153"/>
@@ -3960,7 +3959,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="153"/>
         <source>Median kernel 3x3. Remove high frequency noise.</source>
-        <translation>Mediana kernel 3x3. Rimuove l&apos;interferenza ad alta frequenza.</translation>
+        <translation>Kernel mediana 3x3. Rimuove il rumore ad alta frequenza.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="154"/>
@@ -3970,7 +3969,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="154"/>
         <source>Median kernel 5x5. Good for reducing chroma noise.</source>
-        <translation>Mediana kernel 5x5. Riduce interferenza croma.</translation>
+        <translation>Kernel mediana 5x5. Riduce rumore croma.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="155"/>
@@ -4105,7 +4104,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="188"/>
         <source>Apply operation like P&apos;=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant</source>
-        <translation>Applica operazioni come P&apos;=P*A, P-A, P+A, ecc. usando avvolgimento, media mobile, immagine da file, o costante.</translation>
+        <translation>Applica operazioni come P&apos;=P*A, P-A, P+A, ecc. usando convoluzione, media mobile, immagine da file, o costante.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="189"/>
@@ -4168,12 +4167,7 @@
         <translation>Win32</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="63"/>
-        <source>You need Xvid4 and either LAME or FAAC support for the iPod profile</source>
-        <translation>Hai bisogno del supporto di Xvid4 e di LAME o FAAC per il profilo Ipod</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="74"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="72"/>
         <source>Cannot select the MPEG-4 SP codec.</source>
         <translation>Impossibile selezionare il codec MPEG-4 SP.</translation>
     </message>
@@ -4240,7 +4234,7 @@
     <message>
         <location filename="../avidemux/ADM_audiofilter/audiofilter_buildchain.cpp" line="417"/>
         <source>Not activated.</source>
-        <translation>Non attivo.</translation>
+        <translation>Non attivato.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_encoder/ADM_encCodecDesc.h" line="13"/>
@@ -4527,6 +4521,40 @@
         <source>DVD (mpeg2enc)</source>
         <translation>DVD (mpeg2enc)</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="92"/>
+        <source>Input file error</source>
+        <translation>Errore file di ingresso</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="86"/>
+        <source>Unknown source type</source>
+        <translation>Tipo di sorgente sconosciuto</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="92"/>
+        <source>Bitmap source failed</source>
+        <translation>Sorgente bitmap fallita</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="100"/>
+        <source>No subs</source>
+        <translation>Nessun sottotitolo</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_autodrive.cpp" line="63"/>
+        <source>Xvid4 and FAAC support is required for the iPod profile.</source>
+        <translation>Il supporto di Xvid4 e FAAC ? richiesto per il profilo iPod.</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="82"/>
+        <source>Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?
+
+You can do it later with &quot;Audio -&gt; Build VBR Time Map&quot;.</source>
+        <translation>Avidemux ha rilevato un audio MP3 VBR in questo file. Per mantenere la sincronizzazione audio/video, ? necessaria la time map. Crearla ora?
+
+Puoi farlo successivamente con \&quot;Audio -&gt; Crea time map VBR\&quot;.</translation>
+    </message>
 </context>
 <context>
     <name>ADMImage</name>
@@ -4644,7 +4672,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidDenoise.cpp" line="397"/>
         <source>Denoise</source>
-        <translation>Rimuovi interferenza</translation>
+        <translation>Rimuovi rumore</translation>
     </message>
 </context>
 <context>
@@ -4676,17 +4704,17 @@
 <context>
     <name>ADMVideoFlux</name>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="133"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="134"/>
         <source>_Temporal threshold:</source>
         <translation>Soglia _temporale:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="134"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="135"/>
         <source>_Spatial threshold:</source>
         <translation>Soglia _spaziale:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="138"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="139"/>
         <source>FluxSmooth</source>
         <translation>FluxSmooth</translation>
     </message>
@@ -4807,7 +4835,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp" line="309"/>
         <source>Large Median 5x5</source>
-        <translation>Large Median 5x5</translation>
+        <translation>Mediana grande 5x5</translation>
     </message>
 </context>
 <context>
@@ -5150,7 +5178,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidStabilize.cpp" line="63"/>
         <source>Stabilize Threshold</source>
-        <translation>Stabilizza soglia</translation>
+        <translation>Soglia di stabilizzazione</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidStabilize.cpp" line="66"/>
@@ -5264,7 +5292,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="275"/>
         <source>A = convolve(P); Load convolution kernel from file</source>
-        <translation>A = avvolgi(P); carica nucleo di avvolgimento da file</translation>
+        <translation>A = avvolgi(P); carica nucleo di convoluzione da file</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="277"/>
@@ -5299,7 +5327,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="324"/>
         <source>Input _File (image or convolution kernel):</source>
-        <translation>_File di ingresso (immagine o nucleo di avvolgimento):</translation>
+        <translation>_File di ingresso (immagine o nucleo di convoluzione):</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="328"/>
@@ -5335,7 +5363,8 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="360"/>
         <source>Init By _Rolling (compute head start using a rolling average rather than a straight average)</source>
-        <translation>Inizializza con media mobile (elabora partenza facilitata usando una media mobile invece di una media diretta)</translation>
+        <translation>Inizializza con media mobile (elabora partenza facilitata
+usando una media mobile invece di una media diretta)</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="364"/>
@@ -5483,7 +5512,7 @@
     <message>
         <location filename="../avidemux/ADM_audiocodec/ADM_codecwma.cpp" line="200"/>
         <source>Cannot open AMR codec.</source>
-        <translation>Impossibile aprire i codec AMR.</translation>
+        <translation>Impossibile aprire il codec AMR.</translation>
     </message>
 </context>
 <context>
@@ -5496,7 +5525,7 @@
     <message>
         <location filename="../avidemux/ADM_audiocodec/ADM_codecwma.cpp" line="88"/>
         <source>Cannot open WMA2 codec.</source>
-        <translation>Impossibile aprire i codec WMA2.</translation>
+        <translation>Impossibile aprire il codec WMA2.</translation>
     </message>
 </context>
 <context>
@@ -5514,7 +5543,7 @@
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edFrameType.cpp" line="63"/>
         <source>DivX 5 + packed?</source>
-        <translation>DivX 5 + compresso?</translation>
+        <translation>Compresso con DivX5+?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edFrameType.cpp" line="93"/>
@@ -5549,7 +5578,7 @@
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="408"/>
         <source>May be related to an old index file.</source>
-        <translation>Potrebbe essere relativo a un vecchio file di indice.</translation>
+        <translation>Potrebbe essere correlato a un vecchio file di indice.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="415"/>
@@ -5576,25 +5605,6 @@
         <translation>Creare la time map VBR?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>Use that mode</source>
-        <translation>Utilizza questa modalit?</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>H264 detected</source>
-        <translation>H264 rilevato</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>If the file is using bframe as reference, it can lead to crash or stutteting.
-Avidemux can use another mode which is safed but &lt;b&gt;YOU WILL LOOSE FRAME ACCURACY&lt;/b&gt;.
-Do you want to use that mode ?</source>
-        <translation>Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash.
-Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura ma &lt;b&gt;PERDERAI LA PRECISIONE DEI FOTOGRAMMI&lt;/b&gt;.
-Vuoi usare quella modalit??</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="712"/>
         <source>Packed Bitstream detected</source>
         <translation>Flusso di bit compresso rilevato</translation>
@@ -5656,6 +5666,25 @@
         <source>Indexing failed</source>
         <translation>Indicizzazione fallita</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>Use safe mode</source>
+        <translation>Usa modalit? sicura</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>H.264 detected</source>
+        <translation>H.264 rilevato</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>If the file is using B-frames as reference it can lead to a crash or stuttering.
+Avidemux can use another mode which is safe but &lt;b&gt;YOU WILL LOSE FRAME ACCURACY&lt;/b&gt;.
+Do you want to use that mode?</source>
+        <translation>Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash o una riproduzione a scatti.
+Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura ma &lt;b&gt;PERDERAI PRECISIONE NEI FOTOGRAMMI&lt;/b&gt;.
+Vuoi usare questa modalit??</translation>
+    </message>
 </context>
 <context>
     <name>ADM_Qbitrate</name>
@@ -5844,7 +5873,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp" line="472"/>
         <source>Fast Convolution</source>
-        <translation>Avvolgimento veloce</translation>
+        <translation>Convoluzione veloce</translation>
     </message>
 </context>
 <context>
@@ -6262,7 +6291,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui" line="111"/>
         <source>Block Adaptative</source>
-        <translation>Blocco adattativo</translation>
+        <translation>Adattativo a blocchi</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui" line="118"/>
@@ -6793,7 +6822,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="268"/>
         <source>Noise</source>
-        <translation>Interferenza</translation>
+        <translation>Rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="276"/>
@@ -8485,7 +8514,7 @@
 <context>
     <name>lavMuxer</name>
     <message>
-        <location filename="../avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp" line="376"/>
+        <location filename="../avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp" line="379"/>
         <source>Incompatible frame rate</source>
         <translation>Frame rate incompatibile</translation>
     </message>
@@ -8612,12 +8641,12 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="85"/>
         <source>_Noise:</source>
-        <translation>_Interferenza:</translation>
+        <translation>_Rumore:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="85"/>
         <source>If pixels are closer than noise, they are considered to be the same</source>
-        <translation>Se i pixel sono pi? vicini dell&apos;interferenza, sono considerati identici</translation>
+        <translation>Se i pixel sono pi? vicini del rumore, sono considerati identici</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="86"/>
@@ -8655,7 +8684,7 @@
     <message>
         <location filename="../avidemux/ADM_video/ADM_vidFieldUnblend.cpp" line="81"/>
         <source>Do you want to print metrics on screen ?</source>
-        <translation>Vuoi mostrare le misure sullo schermo?</translation>
+        <translation>Vuoi stampare le misure sullo schermo?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="87"/>
@@ -8670,12 +8699,12 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="90"/>
         <source>_Noise:</source>
-        <translation>_Interferenza:</translation>
+        <translation>_Rumore:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="90"/>
         <source>If pixels are closer than noise, they are considered to be the same</source>
-        <translation>Se i pixel sono pi? vicini dell&apos;interferenza, sono considerati identici</translation>
+        <translation>Se i pixel sono pi? vicini del rumore, sono considerati identici</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="91"/>
@@ -8690,7 +8719,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="92"/>
         <source>_Show metrics</source>
-        <translation>_Mostra misure</translation>
+        <translation>_Mostra metrica</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="92"/>

Modified: branches/avidemux_2.4_branch/po/it.po
===================================================================
--- branches/avidemux_2.4_branch/po/it.po	2008-06-13 12:18:36 UTC (rev 4095)
+++ branches/avidemux_2.4_branch/po/it.po	2008-06-14 15:24:47 UTC (rev 4096)
@@ -3,7 +3,7 @@
 "Project-Id-Version: avidemux\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-10-04 22:09+0300\n"
-"PO-Revision-Date: 2008-05-03 15:18+0100\n"
+"PO-Revision-Date: 2008-06-13 00:28+0100\n"
 "Last-Translator: \n"
 "Language-Team: it\n"
 "MIME-Version: 1.0\n"
@@ -59,8 +59,8 @@
 msgstr "PSP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:194
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:283
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:277
 msgid "FLV"
 msgstr "FLV"
 
@@ -163,9 +163,9 @@
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:265
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:286
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:191
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:259
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:280
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
@@ -227,11 +227,11 @@
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:88
 msgid "Cannot open WMA2 codec."
-msgstr "Impossibile aprire i codec WMA2."
+msgstr "Impossibile aprire il codec WMA2."
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:200
 msgid "Cannot open AMR codec."
-msgstr "Impossibile aprire i codec AMR."
+msgstr "Impossibile aprire il codec AMR."
 
 #: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
 msgid "Could not open OSS audio device"
@@ -321,11 +321,11 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 #: avidemux/gui_autodrive.cpp:62
-#: avidemux/gui_autodrive.cpp:74
-#: avidemux/gui_autodrive.cpp:120
-#: avidemux/gui_autodrive.cpp:135
-#: avidemux/gui_autodrive.cpp:162
-#: avidemux/gui_autodrive.cpp:196
+#: avidemux/gui_autodrive.cpp:72
+#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:128
+#: avidemux/gui_autodrive.cpp:155
+#: avidemux/gui_autodrive.cpp:189
 msgid "Codec Error"
 msgstr "Errore codec"
 
@@ -343,7 +343,7 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
 msgid "Not activated."
-msgstr "Non attivo."
+msgstr "Non attivato."
 
 #: avidemux/ADM_codecs/ADM_ffmp43.cpp:45
 msgid "Internal error finding codec"
@@ -367,7 +367,7 @@
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:63
 msgid "DivX 5 + packed?"
-msgstr "DivX 5 + compresso?"
+msgstr "Compresso con DivX5+?"
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:93
 msgid "Rebuilding Frames"
@@ -377,13 +377,23 @@
 msgid "Aborted"
 msgstr "Annullato"
 
+#: avidemux/ADM_editor/ADM_edit.cpp:82
+msgid ""
+"Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n"
+"\n"
+"You can do it later with \"Audio -> Build VBR Time Map\"."
+msgstr ""
+"Avidemux ha rilevato un audio MP3 VBR in questo file. Per mantenere la sincronizzazione audio/video, ? necessaria la time map. Crearla ora?\n"
+"\n"
+"Puoi farlo successivamente con \"Audio -> Crea time map VBR\"."
+
 #: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Formato file identificato ma non supportato..."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:408
 msgid "May be related to an old index file."
-msgstr "Potrebbe essere relativo a un vecchio file di indice."
+msgstr "Potrebbe essere correlato a un vecchio file di indice."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:415
 #, c-format
@@ -409,22 +419,22 @@
 msgstr "Creare la time map VBR?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
-msgstr "Utilizza questa modalit?"
+msgid "Use safe mode"
+msgstr "Usa modalit? sicura"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
-msgstr "H264 rilevato"
+msgid "H.264 detected"
+msgstr "H.264 rilevato"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
-"Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash.\n"
-"Avidemux pu? utilizzare un'altra modalit? pi? sicura ma <b>PERDERAI LA PRECISIONE DEI FOTOGRAMMI</b>.\n"
-"Vuoi usare quella modalit??"
+"Se il file sta utilizzando un fotogramma-B come riferimento pu? causare un crash o una riproduzione a scatti.\n"
+"Avidemux pu? utilizzare un'altra modalit? pi? sicura ma <b>PERDERAI PRECISIONE NEI FOTOGRAMMI</b>.\n"
+"Vuoi usare questa modalit??"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:712
 msgid "Packed Bitstream detected"
@@ -889,7 +899,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:130
 msgid "Reduce noise, smooth image, increase compressibility."
-msgstr "Riduce l'interferenza, leviga le immagini, aumenta la comprimibilit?."
+msgstr "Riduce il rumore, leviga le immagini, aumenta la comprimibilit?."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:80
@@ -901,7 +911,7 @@
 msgstr "Versione ad alta qualit? di denoise3d. Pi? lenta ma pi? precisa."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr "FluxSmooth"
 
@@ -916,13 +926,13 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:134
 msgid "Vlad59's Avisynth port of Jim Casaburi's denoiser."
-msgstr "Port Avisynth di Vlad59 del filtro di rimozione di interferenza di Jim Casaburi."
+msgstr "Port Avisynth di Vlad59 del filtro di rimozione del rumore di Jim Casaburi."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:136
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
 #: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:397
 msgid "Denoise"
-msgstr "Rimozione interferenza"
+msgstr "Rimozione rumore"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:136
 msgid "Port of Transcode DNR."
@@ -935,7 +945,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:137
 msgid "Light denoiser."
-msgstr "Rimozione interferenza leggera."
+msgstr "Rimozione rumore leggera."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:139
 msgid "Cnr2"
@@ -943,7 +953,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:139
 msgid "Chroma noise reduction filter by MarcFD/Tritical."
-msgstr "Filtro di riduzione interferenza croma di MarcFD/Tritical."
+msgstr "Filtro di riduzione rumore croma di MarcFD/Tritical."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:141
 msgid "MSmooth by Donald Graft"
@@ -977,7 +987,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:148
 msgid "Sharpen edges without amplifying noise. By Donald Graft."
-msgstr "Rende nitidi i margini senza amplificare l'interferenza. Di Donald Graft."
+msgstr "Rende nitidi i margini senza amplificare il rumore. Di Donald Graft."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:149
 msgid "asharp"
@@ -1001,7 +1011,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:152
 msgid "Mean (blur) kernel."
-msgstr "Media (sfocatura) kernel."
+msgstr "Kernel media (sfocatura)."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median"
@@ -1009,7 +1019,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median kernel 3x3. Remove high frequency noise."
-msgstr "Mediana kernel 3x3. Rimuove l'interferenza ad alta frequenza."
+msgstr "Kernel mediana 3x3. Rimuove rumore ad alta frequenza."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Median (5x5)"
@@ -1017,7 +1027,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Median kernel 5x5. Good for reducing chroma noise."
-msgstr "Mediana kernel 5x5. Riduce interferenza croma."
+msgstr "Kernel mediana 5x5. Riduce rumore croma."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:155
 msgid "Forced postprocessing"
@@ -1141,7 +1151,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:188
 msgid "Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant"
-msgstr "Applica operazioni come P'=P*A, P-A, P+A, ecc. usando avvolgimento, media mobile, immagine da file, o costante."
+msgstr "Applica operazioni come P'=P*A, P-A, P+A, ecc. usando convoluzione, media mobile, immagine da file, o costante."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:189
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:401
@@ -1262,7 +1272,7 @@
 msgid "Indexing"
 msgstr "Indicizzazione"
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:376
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:379
 msgid "Incompatible frame rate"
 msgstr "Frame rate incompatibile"
 
@@ -1314,14 +1324,14 @@
 #: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
 #: avidemux/gtk_gui.cpp:903
 #: avidemux/gtk_gui.cpp:1505
@@ -1375,19 +1385,36 @@
 msgid "Could not read \"%s\"."
 msgstr "Impossibile leggere \"%s\"."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 msgid "Output file error"
 msgstr "Errore file di uscita"
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "Impossibile aprire \"%s\" per la scrittura."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:105
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Input file error"
+msgstr "Errore file di ingresso"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+msgid "Unknown source type"
+msgstr "Tipo di sorgente sconosciuto"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Bitmap source failed"
+msgstr "Sorgente bitmap fallita"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
 msgid "Problem loading sub"
 msgstr "Problema di caricamento sottotitoli"
 
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
+msgid "No subs"
+msgstr "Nessun sottotitolo"
+
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "Errore file ifo"
@@ -1541,8 +1568,8 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:269
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:263
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
@@ -1655,7 +1682,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:149
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:203
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:176
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
 msgid "Filter init failed"
@@ -1683,7 +1710,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:207
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:201
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
@@ -1700,7 +1727,7 @@
 msgstr "Copia intelligente"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:183
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
 msgid "Cannot initialize the video stream"
 msgstr "Impossibile inizializzare il flusso video"
@@ -1711,8 +1738,8 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:179
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:215
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:233
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:332
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:227
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:326
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:214
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:337
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:421
@@ -1721,13 +1748,13 @@
 msgstr "Errore durante la codifica"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid "KeyFrame error"
 msgstr "Errore fotogramma chiave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid ""
 "The beginning frame is not a key frame.\n"
@@ -1736,28 +1763,28 @@
 "Il fotogramma iniziale non ? un fotogramma chiave.\n"
 "Spostare il segnalibro A."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Unsupported video"
 msgstr "Video non supportato"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Only FLV1 and VP6 video are supported"
 msgstr "Sono supportati solo i video FLV1 e VP6"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Unsupported audio"
 msgstr "Audio non supportato"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
 msgid "Audio must be mp3 for flv output."
 msgstr "L'audio di un video flv deve essere mp3."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
 msgstr "La frequenza deve essere 44100, 22050 o 11025 Hz."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:248
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:253
 msgid "Cannot initialize the audio stream"
 msgstr "Impossibile inizializzare il flusso audio"
@@ -2515,86 +2542,86 @@
 msgid "MJPEG Configuration"
 msgstr "Configurazione Mjpeg"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:85
 msgid "Select idx file:"
 msgstr "Seleziona un file idx:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
 msgid "Use GlyphSet (optional):"
 msgstr "Usa set di glifi (opzionale):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 msgid "Select GlyphSet file"
 msgstr "Seleziona il set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Output SRT file"
 msgstr "File SRT in uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Save SRT file"
 msgstr "Salva il file SRT"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:214
 msgid "Select input and ouput files"
 msgstr "Seleziona file di ingresso e di uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
 msgid "The idx/sub file does not exist."
 msgstr "Il file idx/sub non esiste."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
 msgid "Please Select a valid output SRT file."
 msgstr "Seleziona un file SRT in uscita valido."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 msgid "Cannot load the glyphset file."
 msgstr "Impossibile caricare il set di glifi."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "GlyphSet filename"
 msgstr "Nome file del set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "Save GlyphSet file"
 msgstr "Salva il set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:149
 msgid "Save Glyph"
 msgstr "Salva glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Input TS:"
 msgstr "TS in ingresso:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Select TS file"
 msgstr "Seleziona un file TS"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:201
 msgid "Subtitle PID:"
 msgstr "PID sottotitoli:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 msgid "Use glyphset (optional):"
 msgstr "Usa set di glifi (opzionale):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
 msgid "Please Select a valid TS file."
 msgstr "Seleziona un file TS valido."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:270
 msgid "Save GlyphSet"
 msgstr "Salva set di glifi"
 
@@ -2630,7 +2657,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "_Use libavcodec MPEG-2 decoder"
-msgstr "_Usa decodificatore libavcodec MPEG-2"
+msgstr "_Usa libavcodec come decodificatore MPEG-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 msgid "Create _OpenDML files"
@@ -3139,7 +3166,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
 msgid "_Denoise"
-msgstr "_Rimuovi interferenza"
+msgstr "_Rimuovi rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
@@ -3950,7 +3977,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
 msgid "Block Adaptative :"
-msgstr "Blocco adattativo: "
+msgstr "Adattativo a blocchi: "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
 msgid "Unknown flag :"
@@ -4107,7 +4134,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
 msgid "Chroma Noise Reduction 2"
-msgstr "Riduzione interferenza croma 2"
+msgstr "Riduzione rumore croma 2"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
 msgid "<b>Scene change Treshold</b>"
@@ -4233,7 +4260,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
 msgid "<b>frame2</b>"
-msgstr "<b>fotogramma2</b>"
+msgstr "<b>frame2</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:235
 msgid "Luma"
@@ -4958,7 +4985,7 @@
 msgid "Configure"
 msgstr "Configura"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:89
 msgid "none"
 msgstr "nessuno"
 
@@ -4966,6 +4993,14 @@
 msgid "Select .idx file"
 msgstr "Seleziona un file .idx"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+msgid "Wrong VobSub parametering"
+msgstr "Parametrizzazione VobSub errata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+msgid "The idx/sub file does not set."
+msgstr "Il file idx/sub non ? impostato."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
 msgid "VobSub Settings"
 msgstr "Impostazioni VobSub"
@@ -4976,7 +5011,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:227
 msgid "Select Language :"
-msgstr "Seleziona Lingua: "
+msgstr "Seleziona lingua: "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:241
 msgid "Select Sub"
@@ -5224,11 +5259,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:948
 msgid "Noise Reduction"
-msgstr "Riduzione interferenza"
+msgstr "Riduzione rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:957
 msgid "Set the amount of noise reduction"
-msgstr "Imposta il livello di riduzione interferenza"
+msgstr "Imposta il livello di riduzione rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:964
 msgid "Deblocking Filter"
@@ -5421,7 +5456,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1306
 msgid "Max QP Step"
-msgstr "Max Qp Step"
+msgstr "Max QP Step"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1320
 msgid "Enforce a minimum quantizer level"
@@ -5529,11 +5564,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1618
 msgid "Factor between I and P-frame Quants"
-msgstr "Fattore tra quantizzazione fotogrammi I e P"
+msgstr "Fattore tra quantizzatori fotogrammi I e P"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1625
 msgid "Factor between P and B-frame Quants"
-msgstr "Fattore tra quantizzazione fotogrammi P e B"
+msgstr "Fattore tra quantizzatori fotogrammi P e B"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1632
 msgid "Chroma QP Offset"
@@ -5572,7 +5607,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1697
 msgid "<b>Quantization Matrices</b>"
-msgstr "<b>Quantizzazione matrici</b>"
+msgstr "<b>Matrici quantizzazione</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1702
 msgid "More"
@@ -5621,27 +5656,27 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
 msgid "1- Very low"
-msgstr "1- Molto bassa"
+msgstr "1 - Molto bassa"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
 msgid "2- Low"
-msgstr "2- Bassa"
+msgstr "2 - Bassa"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
 msgid "3- Medium"
-msgstr "3- Media"
+msgstr "3 - Media"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
 msgid "4- High"
-msgstr "4- Alta"
+msgstr "4 - Alta"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
 msgid "5- Very High"
-msgstr "5- Molto alta"
+msgstr "5 - Molto alta"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
 msgid "6- Ultra High"
-msgstr "6- Ultra"
+msgstr "6 - Ultra"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
 msgid "H263 Quantizer"
@@ -6311,7 +6346,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:333
 msgid "Noise"
-msgstr "Interferenza"
+msgstr "Rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:357
 msgid "Sharpness"
@@ -7021,7 +7056,7 @@
 
 #: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
 msgid "Do you want to print metrics on screen ?"
-msgstr "Vuoi mostrare le misure sullo schermo?"
+msgstr "Vuoi stampare le misure sullo schermo?"
 
 #: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
 #: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
@@ -7131,12 +7166,12 @@
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
 msgid "_Noise:"
-msgstr "_Interferenza:"
+msgstr "_Rumore:"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
 msgid "If pixels are closer than noise, they are considered to be the same"
-msgstr "Se i pixel sono pi? vicini dell'interferenza, sono considerati identici"
+msgstr "Se i pixel sono pi? vicini del rumore, sono considerati identici"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
 msgid "I_dentical:"
@@ -7525,7 +7560,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp:472
 msgid "Fast Convolution"
-msgstr "Avvolgimento veloce"
+msgstr "Convoluzione veloce"
 
 #: avidemux/ADM_videoFilter/ADM_vidFields.cpp:229
 msgid "Motion Threshold"
@@ -7535,11 +7570,11 @@
 msgid "Blend Threshold"
 msgstr "Soglia miscela"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 msgid "_Temporal threshold:"
 msgstr "Soglia _temporale:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 msgid "_Spatial threshold:"
 msgstr "Soglia _spaziale:"
 
@@ -7585,7 +7620,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp:309
 msgid "Large Median 5x5"
-msgstr "Large Median 5x5"
+msgstr "Mediana grande 5x5"
 
 #: avidemux/ADM_videoFilter/ADM_vidLogo.cpp:88
 msgid "_Logo (jpg file):"
@@ -7803,7 +7838,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:63
 msgid "Stabilize Threshold"
-msgstr "Stabilizza soglia"
+msgstr "Soglia di stabilizzazione"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
 msgid "P' = A"
@@ -7847,7 +7882,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:275
 msgid "A = convolve(P); Load convolution kernel from file"
-msgstr "A = avvolgi(P); carica nucleo di avvolgimento da file"
+msgstr "A = avvolgi(P); carica nucleo di convoluzione da file"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:277
 msgid "A = pixel from image file as float; Load image from file"
@@ -7875,7 +7910,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
 msgid "Input _File (image or convolution kernel):"
-msgstr "_File di ingresso (immagine o nucleo di avvolgimento):"
+msgstr "_File di ingresso (immagine o nucleo di convoluzione):"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:327
 msgid ""
@@ -8463,14 +8498,14 @@
 msgstr "? necessaria una traccia audio per creare questo tipo di file"
 
 #: avidemux/gui_autodrive.cpp:63
-msgid "You need Xvid4 and either LAME or FAAC support for the iPod profile"
-msgstr "Hai bisogno del supporto di Xvid4 e di LAME o FAAC per il profilo Ipod"
+msgid "Xvid4 and FAAC support is required for the iPod profile."
+msgstr "Il supporto di Xvid4 e FAAC ? richiesto per il profilo iPod."
 
-#: avidemux/gui_autodrive.cpp:74
+#: avidemux/gui_autodrive.cpp:72
 msgid "Cannot select the MPEG-4 SP codec."
 msgstr "Impossibile selezionare il codec MPEG-4 SP."
 
-#: avidemux/gui_autodrive.cpp:121
+#: avidemux/gui_autodrive.cpp:114
 msgid ""
 "You don't have LAME!.\n"
 "It is needed to create FLV  video."
@@ -8478,15 +8513,15 @@
 "Non disponi di LAME!\n"
 "? necessario per creare video FLV."
 
-#: avidemux/gui_autodrive.cpp:135
+#: avidemux/gui_autodrive.cpp:128
 msgid "Cannot select FLV1  codec."
 msgstr "Impossibile selezionare il codec FLV1."
 
-#: avidemux/gui_autodrive.cpp:162
+#: avidemux/gui_autodrive.cpp:155
 msgid "Cannot select mpeg4 sp codec."
 msgstr "Impossibile selezionare il codec mpeg4 sp."
 
-#: avidemux/gui_autodrive.cpp:197
+#: avidemux/gui_autodrive.cpp:190
 msgid ""
 "You don't have FAAC!.\n"
 "It is needed to create PSP compatible video."



From gruntster at mail.berlios.de  Sat Jun 14 17:28:24 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Jun 2008 17:28:24 +0200
Subject: [Avidemux-svn-commit] r4097 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog ADM_QT4/ADM_gui
Message-ID: <200806141528.m5EFSO5l004322@sheep.berlios.de>

Author: gruntster
Date: 2008-06-14 17:28:09 +0200 (Sat, 14 Jun 2008)
New Revision: 4097

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
Log:
[Qt4] calculator

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-14 15:28:09 UTC (rev 4097)
@@ -57,7 +57,7 @@
 static uint32_t videoDuration;
 static uint32_t track1, track2;
 
-uint32_t numberOfVideoFrames;
+static uint32_t numberOfVideoFrames;
 
 static uint32_t videoSize,videoBitrate;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-06-14 15:28:09 UTC (rev 4097)
@@ -6,6 +6,7 @@
 SET(${ADM_LIB}_Q
 about
 asharp
+calculator
 chromashift
 contrast
 eq2

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-14 15:28:09 UTC (rev 4097)
@@ -45,7 +45,6 @@
 uint8_t DIA_audioCodec( AUDIOENCODER *codec ) {return 0;}
 uint8_t DIA_quota(char *) {return 0;}
 uint8_t DIA_RecentFiles( char **name ){return 0;}
-void    DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate ){}
 uint8_t initFileSelector(void){return 0;}
 uint8_t initGUI( void ) {return 1;}
 void destroyGUI(void) {}

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-14 15:28:09 UTC (rev 4097)
@@ -0,0 +1,286 @@
+/***************************************************************************
+                             Bitrate calculator
+                             ------------------
+
+    begin                : Sat Jun 14 2008
+    copyright            : (C) 2008 by gruntster/mean
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include <math.h>
+
+#include "ui_calculator.h"
+#include "default.h"
+#include "ADM_misc.h"
+
+#include "avi_vars.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_audiofilter/audioeng_buildfilters.h"
+#include "ADM_filter/video_filters.h"
+#include "ADM_encoder/adm_encConfig.h"
+
+class calculatorDialog : public QDialog
+{
+	Q_OBJECT
+
+private:
+	Ui_CalculatorDialog ui;
+	unsigned int _videoFrameCount;
+	unsigned int _videoDuration;
+
+	void update(void);
+	unsigned int getPictureSize(void);
+
+public:
+	calculatorDialog();
+	~calculatorDialog();
+
+	unsigned int videoSize(void);
+	unsigned int videoBitrate(void);
+
+private slots:
+	void comboBox_currentIndexChanged(int index);
+	void mediumComboBox_currentIndexChanged(int index);
+	void spinBox_valueChanged(int value);
+};
+
+calculatorDialog::calculatorDialog()
+{
+	ui.setupUi(this);
+
+	connect(ui.formatComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(comboBox_currentIndexChanged(int)));
+	connect(ui.mediumComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(mediumComboBox_currentIndexChanged(int)));
+	connect(ui.customSizeSpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+	connect(ui.audioTrack1SpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+	connect(ui.audioTrack2SpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+
+	float duration = 0;
+	aviInfo info;
+	uint16_t mm, hh, ss, ms;
+	unsigned int track1 = 0;
+
+	if (frameStart < frameEnd)
+		_videoFrameCount = frameEnd - frameStart;
+	else
+		_videoFrameCount = frameStart - frameEnd;
+
+	duration = ((float)video_body->getTime(_videoFrameCount) / 1000.);
+
+	if (duration < 0)
+		duration = -duration;
+
+	_videoDuration = (uint32_t)ceil(duration);
+
+	video_body->getVideoInfo(&info);
+	frame2time(_videoFrameCount, info.fps1000, &hh, &mm, &ss, &ms);
+
+	ui.durationLabel->setText(QString("%1:%2:%3").arg(hh, 2, 10, QLatin1Char('0')).arg(mm, 2, 10, QLatin1Char('0')).arg(ss, 2, 10, QLatin1Char('0')));
+
+	if (audioProcessMode() && currentaudiostream)
+	{
+		AVDMGenericAudioStream *stream = buildAudioFilter(currentaudiostream, 0);
+
+		if (stream)
+			track1 = (stream->getInfo()->byterate * 8) / 1000;
+
+		deleteAudioFilter(stream);
+	}
+	else if(currentaudiostream)
+		track1 = (currentaudiostream->getInfo()->byterate * 8) / 1000;
+
+	ui.audioTrack1SpinBox->setValue(track1);
+
+	update();
+}
+
+calculatorDialog::~calculatorDialog()
+{
+}
+
+void calculatorDialog::comboBox_currentIndexChanged(int index)
+{
+	update();
+}
+
+void calculatorDialog::mediumComboBox_currentIndexChanged(int value)
+{
+	ui.customSizeLabel->setEnabled(value == 5);
+	ui.customSizeSpinBox->setEnabled(value == 5);
+	ui.customSizeMbLabel->setEnabled(value == 5);
+
+	update();
+}
+
+void calculatorDialog::spinBox_valueChanged(int value)
+{
+	update();
+}
+
+void calculatorDialog::update(void)
+{
+	unsigned int track1, track2;
+	uint32_t audioSize;
+	uint32_t totalSize;
+	aviInfo info;
+
+	video_body->getVideoInfo(&info);
+
+	track1 = ui.audioTrack1SpinBox->value();
+	track2 = ui.audioTrack2SpinBox->value();
+
+	// kb->Byte
+	audioSize = ((((track1 + track2) * 1000) / 8) * _videoDuration) >> 20;
+
+	ui.audioSizeLabel->setText(QString("%1").arg(audioSize));
+
+	// Compute total size
+	unsigned int s74, s80, dvd;
+	int formatIndex = ui.formatComboBox->currentIndex();
+
+	if (formatIndex == 2)
+	{ 
+		// Mpeg
+		s74 = 730;
+		s80 = 790;
+		dvd = 4300;
+	}
+	else
+	{
+		//AVI or OGM
+		s74 = 650;
+		s80 = 700;
+		dvd = 4300;
+	}
+
+	int mediumIndex = ui.mediumComboBox->currentIndex();
+
+	switch(mediumIndex)
+	{
+		case 0:
+			totalSize = s80;
+			break;
+		case 1:
+			totalSize = 2 * s80;
+			break;
+		case 2:
+			totalSize = s74;
+			break;
+		case 3:
+			totalSize= 2 * s74;
+			break;
+		case 4:
+			totalSize = dvd;
+			break;
+		case 5:
+			totalSize = ui.customSizeSpinBox->value();
+			break;
+	}
+
+	ui.totalSizeLabel->setText(QString("%1").arg(totalSize));
+
+	// Compute muxing overhead size
+	unsigned int muxingOverheadSize;
+	int numberOfAudioTracks = 0;
+	int numberOfChunks;
+
+	switch (formatIndex)
+	{ 
+		case 0:
+			// AVI
+			// Muxing overhead is 8 + 32 = 40 bytes per chunk.
+			// More or less: numberOfChunks = (x + 1) * _videoFrameCount,
+			// where x - the number of audio tracks
+			if (track1 != 0)
+				numberOfAudioTracks++;
+
+			if (track2 != 0)
+				numberOfAudioTracks++;
+
+			numberOfChunks = (numberOfAudioTracks + 1) * _videoFrameCount;
+			muxingOverheadSize = (unsigned int)ceil((numberOfChunks * 40) / 1048576.0);
+			break;
+		case 1:
+			// OGM
+			// Muxing overhead is 1.1% to 1.2% of (videoSize + audioSize)
+			muxingOverheadSize = (unsigned int)ceil(totalSize - totalSize / 1.012);
+			break;
+		case 2:
+			// MPEG
+			// Muxing overhead is 1% to 2% of (videoSize + audioSize)
+			muxingOverheadSize = (unsigned int)ceil(totalSize - totalSize / 1.02);
+			break;
+	}
+
+	unsigned int videoSize = 0;
+
+	// and compute
+	if (audioSize + muxingOverheadSize >= totalSize)
+		videoSize = 0;
+	else
+		videoSize = totalSize - audioSize - muxingOverheadSize;
+
+	unsigned int picSize;
+
+	// Compute average bps
+	float avg;
+	float bpp;
+
+	avg = (videoSize * 1024. * 1024.) / _videoDuration;
+
+	// now we have byte /sec, convert to kb per sec
+	avg = (avg * 8) / 1000;
+	ui.videoBitrateLabel->setText(QString("%1").arg((unsigned int)avg));
+	ui.videoSizeLabel->setText(QString("%1").arg(videoSize));
+
+	// Bpp
+	bpp = avg * 1000000.;  // kbit->bit + compensate for fps1000
+
+	// Fetch info from filter
+	if(videoProcessMode())
+		picSize = getPictureSize();
+	else
+		picSize = info.width * info.height;
+
+	bpp = (bpp / picSize) / info.fps1000;
+
+	ui.bppLabel->setText(QString("%1").arg(bpp, 0, 'g', 3));
+}
+
+unsigned int calculatorDialog::getPictureSize(void)
+{
+	AVDMGenericVideoStream *last = getLastVideoFilter();
+
+	return last->getInfo()->width * last->getInfo()->height;
+}
+
+unsigned int calculatorDialog::videoSize(void)
+{
+	return atoi(ui.videoSizeLabel->text().toUtf8().constData());
+}
+
+unsigned int calculatorDialog::videoBitrate(void)
+{
+	return atoi(ui.videoBitrateLabel->text().toUtf8().constData());
+}
+
+void DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate)
+{
+	if (!avifileinfo)
+		return;
+
+	calculatorDialog dialog;
+
+	if (dialog.exec() == QDialog::Accepted)
+		videoCodecSetFinalSize(dialog.videoSize());
+
+	*sizeInMeg = dialog.videoSize();
+	*avgBitrate = dialog.videoBitrate();
+}

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui	2008-06-14 15:28:09 UTC (rev 4097)
@@ -0,0 +1,683 @@
+<ui version="4.0" >
+ <author></author>
+ <comment></comment>
+ <exportmacro></exportmacro>
+ <class>CalculatorDialog</class>
+ <widget class="QDialog" name="CalculatorDialog" >
+  <property name="geometry" >
+   <rect>
+    <x>0</x>
+    <y>0</y>
+    <width>353</width>
+    <height>299</height>
+   </rect>
+  </property>
+  <property name="windowTitle" >
+   <string>Calculator</string>
+  </property>
+  <layout class="QVBoxLayout" >
+   <property name="margin" >
+    <number>9</number>
+   </property>
+   <property name="spacing" >
+    <number>6</number>
+   </property>
+   <item>
+    <widget class="QGroupBox" name="groupBox_3" >
+     <property name="title" >
+      <string>Target</string>
+     </property>
+     <layout class="QVBoxLayout" >
+      <property name="margin" >
+       <number>9</number>
+      </property>
+      <property name="spacing" >
+       <number>6</number>
+      </property>
+      <item>
+       <layout class="QHBoxLayout" >
+        <property name="margin" >
+         <number>0</number>
+        </property>
+        <property name="spacing" >
+         <number>6</number>
+        </property>
+        <item>
+         <layout class="QGridLayout" >
+          <property name="margin" >
+           <number>0</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item row="0" column="1" >
+           <widget class="QLabel" name="durationLabel" >
+            <property name="text" >
+             <string>00:00:00</string>
+            </property>
+           </widget>
+          </item>
+          <item row="1" column="1" >
+           <widget class="QComboBox" name="formatComboBox" >
+            <item>
+             <property name="text" >
+              <string>AVI</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>OGM</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>MPEG</string>
+             </property>
+            </item>
+           </widget>
+          </item>
+          <item row="2" column="0" >
+           <widget class="QLabel" name="label_4" >
+            <property name="text" >
+             <string>Medium:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="1" column="0" >
+           <widget class="QLabel" name="label_3" >
+            <property name="text" >
+             <string>Format:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="0" column="0" >
+           <widget class="QLabel" name="label" >
+            <property name="text" >
+             <string>Duration:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="2" column="1" >
+           <widget class="QComboBox" name="mediumComboBox" >
+            <item>
+             <property name="text" >
+              <string>1 x 80 minute CD</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>2 x 80 minute CD</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>1 x 74 minute CD</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>2 x 74 minute CD</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>DVD-5</string>
+             </property>
+            </item>
+            <item>
+             <property name="text" >
+              <string>Custom</string>
+             </property>
+            </item>
+           </widget>
+          </item>
+         </layout>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Horizontal</enum>
+          </property>
+          <property name="sizeType" >
+           <enum>QSizePolicy::Fixed</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>30</width>
+            <height>20</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+        <item>
+         <layout class="QVBoxLayout" >
+          <property name="margin" >
+           <number>0</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item>
+           <spacer>
+            <property name="orientation" >
+             <enum>Qt::Vertical</enum>
+            </property>
+            <property name="sizeHint" >
+             <size>
+              <width>20</width>
+              <height>40</height>
+             </size>
+            </property>
+           </spacer>
+          </item>
+          <item>
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QLabel" name="customSizeLabel" >
+              <property name="enabled" >
+               <bool>false</bool>
+              </property>
+              <property name="text" >
+               <string>Custom Size:</string>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="customSizeSpinBox" >
+              <property name="enabled" >
+               <bool>false</bool>
+              </property>
+              <property name="maximum" >
+               <number>999999</number>
+              </property>
+              <property name="minimum" >
+               <number>1</number>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QLabel" name="customSizeMbLabel" >
+              <property name="enabled" >
+               <bool>false</bool>
+              </property>
+              <property name="text" >
+               <string>MB</string>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+         </layout>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Horizontal</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>16</width>
+            <height>56</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+       </layout>
+      </item>
+      <item>
+       <spacer>
+        <property name="orientation" >
+         <enum>Qt::Vertical</enum>
+        </property>
+        <property name="sizeHint" >
+         <size>
+          <width>20</width>
+          <height>16</height>
+         </size>
+        </property>
+       </spacer>
+      </item>
+     </layout>
+    </widget>
+   </item>
+   <item>
+    <widget class="QGroupBox" name="groupBox_2" >
+     <property name="title" >
+      <string>Audio Bitrate</string>
+     </property>
+     <layout class="QHBoxLayout" >
+      <property name="margin" >
+       <number>9</number>
+      </property>
+      <property name="spacing" >
+       <number>6</number>
+      </property>
+      <item>
+       <layout class="QHBoxLayout" >
+        <property name="margin" >
+         <number>0</number>
+        </property>
+        <property name="spacing" >
+         <number>6</number>
+        </property>
+        <item>
+         <widget class="QLabel" name="label_6" >
+          <property name="text" >
+           <string>Track 1:</string>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <widget class="QSpinBox" name="audioTrack1SpinBox" >
+          <property name="maximum" >
+           <number>99999</number>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <widget class="QLabel" name="label_23" >
+          <property name="text" >
+           <string>kbps</string>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Horizontal</enum>
+          </property>
+          <property name="sizeType" >
+           <enum>QSizePolicy::Fixed</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>30</width>
+            <height>20</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+        <item>
+         <widget class="QLabel" name="label_7" >
+          <property name="text" >
+           <string>Track 2:</string>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <widget class="QSpinBox" name="audioTrack2SpinBox" >
+          <property name="maximum" >
+           <number>99999</number>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <widget class="QLabel" name="label_24" >
+          <property name="text" >
+           <string>kbps</string>
+          </property>
+         </widget>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Horizontal</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>93</width>
+            <height>20</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+       </layout>
+      </item>
+     </layout>
+    </widget>
+   </item>
+   <item>
+    <widget class="QGroupBox" name="groupBox" >
+     <property name="title" >
+      <string>Result</string>
+     </property>
+     <layout class="QHBoxLayout" >
+      <property name="margin" >
+       <number>9</number>
+      </property>
+      <property name="spacing" >
+       <number>6</number>
+      </property>
+      <item>
+       <layout class="QVBoxLayout" >
+        <property name="margin" >
+         <number>0</number>
+        </property>
+        <property name="spacing" >
+         <number>6</number>
+        </property>
+        <item>
+         <layout class="QGridLayout" >
+          <property name="margin" >
+           <number>0</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item row="2" column="0" >
+           <widget class="QLabel" name="label_16" >
+            <property name="text" >
+             <string>Audio Size:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="1" column="0" >
+           <widget class="QLabel" name="label_12" >
+            <property name="text" >
+             <string>Video Size:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="2" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QLabel" name="audioSizeLabel" >
+              <property name="text" >
+               <string>0</string>
+              </property>
+              <property name="alignment" >
+               <set>Qt::AlignRight|Qt::AlignTrailing|Qt::AlignVCenter</set>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QLabel" name="label_21" >
+              <property name="text" >
+               <string>MB</string>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="0" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QLabel" name="totalSizeLabel" >
+              <property name="text" >
+               <string>0</string>
+              </property>
+              <property name="alignment" >
+               <set>Qt::AlignRight|Qt::AlignTrailing|Qt::AlignVCenter</set>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QLabel" name="label_19" >
+              <property name="text" >
+               <string>MB</string>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="0" column="0" >
+           <widget class="QLabel" name="label_8" >
+            <property name="text" >
+             <string>Total Size:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="1" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QLabel" name="videoSizeLabel" >
+              <property name="text" >
+               <string>0</string>
+              </property>
+              <property name="alignment" >
+               <set>Qt::AlignRight|Qt::AlignTrailing|Qt::AlignVCenter</set>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QLabel" name="label_20" >
+              <property name="text" >
+               <string>MB</string>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+         </layout>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Vertical</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>20</width>
+            <height>40</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+       </layout>
+      </item>
+      <item>
+       <spacer>
+        <property name="orientation" >
+         <enum>Qt::Horizontal</enum>
+        </property>
+        <property name="sizeType" >
+         <enum>QSizePolicy::Fixed</enum>
+        </property>
+        <property name="sizeHint" >
+         <size>
+          <width>30</width>
+          <height>20</height>
+         </size>
+        </property>
+       </spacer>
+      </item>
+      <item>
+       <layout class="QVBoxLayout" >
+        <property name="margin" >
+         <number>0</number>
+        </property>
+        <property name="spacing" >
+         <number>6</number>
+        </property>
+        <item>
+         <layout class="QGridLayout" >
+          <property name="margin" >
+           <number>0</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item row="1" column="1" >
+           <widget class="QLabel" name="bppLabel" >
+            <property name="text" >
+             <string>0</string>
+            </property>
+            <property name="alignment" >
+             <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
+            </property>
+           </widget>
+          </item>
+          <item row="0" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QLabel" name="videoBitrateLabel" >
+              <property name="text" >
+               <string>0</string>
+              </property>
+              <property name="alignment" >
+               <set>Qt::AlignRight|Qt::AlignTrailing|Qt::AlignVCenter</set>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <widget class="QLabel" name="label_22" >
+              <property name="text" >
+               <string>kbps</string>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="1" column="0" >
+           <widget class="QLabel" name="label_14" >
+            <property name="text" >
+             <string>Bits Per Pixel:</string>
+            </property>
+           </widget>
+          </item>
+          <item row="0" column="0" >
+           <widget class="QLabel" name="label_10" >
+            <property name="text" >
+             <string>Video Bitrate:</string>
+            </property>
+           </widget>
+          </item>
+         </layout>
+        </item>
+        <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Vertical</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>20</width>
+            <height>40</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+       </layout>
+      </item>
+      <item>
+       <spacer>
+        <property name="orientation" >
+         <enum>Qt::Horizontal</enum>
+        </property>
+        <property name="sizeHint" >
+         <size>
+          <width>40</width>
+          <height>20</height>
+         </size>
+        </property>
+       </spacer>
+      </item>
+     </layout>
+    </widget>
+   </item>
+   <item>
+    <layout class="QHBoxLayout" >
+     <property name="margin" >
+      <number>0</number>
+     </property>
+     <property name="spacing" >
+      <number>6</number>
+     </property>
+     <item>
+      <spacer>
+       <property name="orientation" >
+        <enum>Qt::Horizontal</enum>
+       </property>
+       <property name="sizeHint" >
+        <size>
+         <width>131</width>
+         <height>31</height>
+        </size>
+       </property>
+      </spacer>
+     </item>
+     <item>
+      <widget class="QPushButton" name="okButton" >
+       <property name="text" >
+        <string>OK</string>
+       </property>
+      </widget>
+     </item>
+     <item>
+      <widget class="QPushButton" name="cancelButton" >
+       <property name="text" >
+        <string>Cancel</string>
+       </property>
+      </widget>
+     </item>
+    </layout>
+   </item>
+  </layout>
+ </widget>
+ <pixmapfunction></pixmapfunction>
+ <resources/>
+ <connections>
+  <connection>
+   <sender>okButton</sender>
+   <signal>clicked()</signal>
+   <receiver>CalculatorDialog</receiver>
+   <slot>accept()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>278</x>
+     <y>253</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>96</x>
+     <y>254</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>cancelButton</sender>
+   <signal>clicked()</signal>
+   <receiver>CalculatorDialog</receiver>
+   <slot>reject()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>369</x>
+     <y>253</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>179</x>
+     <y>282</y>
+    </hint>
+   </hints>
+  </connection>
+ </connections>
+</ui>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-14 15:24:47 UTC (rev 4096)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-14 15:28:09 UTC (rev 4097)
@@ -35,7 +35,7 @@
 PROCESS(actionSave_2,ACT_SaveWave) \
 PROCESS(actionEncoder_2,ACT_SelectEncoder) \
 PROCESS(actionFilters_2,ACT_AudioFilters) \
-PROCESS(actionCalculator,ACT_DUMMY) \
+PROCESS(actionCalculator,ACT_Bitrate) \
 PROCESS(actionRebuild_I_B_Frames,ACT_RebuildKF) \
 PROCESS(actionBitrate_histogram,ACT_BitRate) \
 PROCESS(actionScan_for_black_frames,ACT_AllBlackFrames) \



From gruntster at mail.berlios.de  Sun Jun 15 14:16:37 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jun 2008 14:16:37 +0200
Subject: [Avidemux-svn-commit] r4098 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics
Message-ID: <200806151216.m5FCGb1D004937@sheep.berlios.de>

Author: gruntster
Date: 2008-06-15 14:16:29 +0200 (Sun, 15 Jun 2008)
New Revision: 4098

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
Log:
[Pics] open image files on demand rather than keeping an array of file handles

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-14 15:28:09 UTC (rev 4097)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-15 12:16:29 UTC (rev 4098)
@@ -47,34 +47,48 @@
 static uint32_t s32;
 #define MAX_ACCEPTED_OPEN_FILE 99999
 
+picHeader::picHeader(void)
+{
+	_nb_file = 0;
+	_imgSize = NULL;
+	_fileMask = NULL;
+}
+
 //****************************************************************
-//****************************************************************
-uint8_t
-    picHeader::getFrameNoAlloc(uint32_t framenum, ADMCompressedImage *img)
+uint8_t picHeader::getFrameNoAlloc(uint32_t framenum, ADMCompressedImage *img)
 {
-    if(framenum>= (uint32_t)_videostream.dwLength) return 0;
-    img->flags = AVI_KEY_FRAME;
-    fseek(_fd[framenum], _offset, SEEK_SET);
-    fread(img->data, _imgSize[framenum] - _offset, 1, _fd[framenum]);
-    img->dataLength = _imgSize[framenum] - _offset;;
-    return 1;
+	if (framenum >= (uint32_t)_videostream.dwLength)
+		return 0;
+
+	img->flags = AVI_KEY_FRAME;
+
+	FILE* fd = openFrameFile(framenum);
+
+	fread(img->data, _imgSize[framenum] - _offset, 1, fd);
+	img->dataLength = _imgSize[framenum] - _offset;
+
+	fclose(fd);
+
+	return 1;
 }
 //****************************************************************
 uint8_t picHeader::close(void)
 {
-    if (_fd) {
-	for (uint32_t i = 0; i < _nb_file; i++) {
-	    fclose(_fd[i]);
+	_nb_file = 0;
+
+	if (_fileMask)
+	{
+		delete [] _fileMask;
+		_fileMask = NULL;
 	}
-	ADM_dealloc(_fd);
-	_fd = NULL;
 
-    }
-    if (_imgSize) {
-	delete[]_imgSize;
-	_imgSize = NULL;
-    }
-    return 0;
+	if (_imgSize)
+	{
+		delete [] _imgSize;
+		_imgSize = NULL;
+	}
+
+	return 0;
 }
 //****************************************************************
 /*
@@ -116,7 +130,6 @@
 //****************************************************************
 uint8_t picHeader::open(char *inname)
 {
-
     uint32_t nnum;
     uint32_t *fcc;
     uint8_t fcc_tab[4];
@@ -177,55 +190,59 @@
     if (nnum == 1) {
 	printf("\n only one file!");
         _nb_file=1;
-         sprintf(realstring, "%%s.%s",extension);
+		 _fileMask = ADM_strdup(inname);
     }
     else
     {
     nnum--;
     end++;
     _first = atoi(end);
-    printf("\n First : %lu, num digit :%lu", _first, nnum);
+	printf("\n First: %lu, Digit count: %lu\n", _first, nnum);
     *(end) = 0;
-    printf("\n Path : %s\n", name);
+	printf(" Path: %s\n", name);
 
-    
-    sprintf(realstring, "%%s%%0%lud.%s", nnum, extension);
-    printf("\n string : %s", realstring);
+	sprintf(realstring, "%s%%0%lud.%s", name, nnum, extension);
+	_fileMask = ADM_strdup(realstring);
+	printf(" File Mask: %s\n\n", _fileMask);
 
     _nb_file = 0;
 
-    for (uint32_t i = 0; i < MAX_ACCEPTED_OPEN_FILE; i++) {
-	sprintf(realname, realstring, name, i + _first);
-	printf("\n %lu : %s\n", i, realname);
-	fd = fopen(realname, "rb");
-	if (fd == NULL)
-	    break;
-	fclose(fd);
-	_nb_file++;
-    }
-    }
+	for (uint32_t i = 0; i < MAX_ACCEPTED_OPEN_FILE; i++)
+	{
+		sprintf(realname, realstring, i + _first);
+		printf(" %lu : %s\n", i, realname);
+
+		fd = fopen(realname, "rb");
+
+		if (fd == NULL)
+			break;
+
+		fclose(fd);
+		_nb_file++;
+	}
+	}
     printf("\n found %lu images\n", _nb_file);
 
-
-    _fd = (FILE **) ADM_alloc(_nb_file * sizeof(FILE *));
     _imgSize = new uint32_t[_nb_file];
     //_________________________________
-    // now open them and assign fd && imgSize
+    // now open them and assign imgSize
     //__________________________________
-    for (uint32_t i = 0; i < _nb_file; i++) {
-	sprintf(realname, realstring, name, i + _first);
-	printf("\n %lu : %s", i, realname);
-	_fd[i] = fopen(realname, "rb");
-	fseek(_fd[i], 0, SEEK_END);
-	_imgSize[i] = ftell(_fd[i]);
-	fseek(_fd[i], 0, SEEK_SET);
-	ADM_assert(_fd[i] != NULL);
-    }
+	for (uint32_t i = 0; i < _nb_file; i++)
+	{
+		fd = openFrameFile(i);
+		ADM_assert(fd != NULL);
 
-    delete[]name;
-    delete[]extension;
+		fseek(fd, 0, SEEK_END);
+		_imgSize[i] = ftell(fd);
 
+		fclose(fd);
+	}
 
+	fd = openFrameFile(0);
+
+	delete [] name;
+	delete [] extension;
+
     //
     //      Image is bmp type
     //________________________
@@ -234,17 +251,19 @@
 	{
 	    BITMAPHEADER bmph;
 
-	    fread(&s16, 2, 1, _fd[0]);
+		fread(&s16, 2, 1, fd);
 	    if (s16 != 0x4D42) {
 		printf("\n incorrect bmp sig.\n");
+		fclose(fd);
 		return 0;
 	    }
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&bmph, sizeof(bmph), 1, _fd[0]);
+		fread(&s32, 4, 1, fd);
+		fread(&s32, 4, 1, fd);
+		fread(&s32, 4, 1, fd);
+		fread(&bmph, sizeof(bmph), 1, fd);
 	    if (bmph.compressionScheme != 0) {
 		printf("\ncannot handle compressed bmp\n");
+		fclose(fd);
 		return 0;
 	    }
 	    _offset = bmph.size + 14;
@@ -262,36 +281,38 @@
 	    uint16_t tag = 0, count = 0, off;
 
 	    _offset = 0;
-	    fseek(_fd[0], 0, SEEK_SET);
-	    read16(_fd[0]);	// skip jpeg ffd8
+	    fseek(fd, 0, SEEK_SET);
+	    read16(fd);	// skip jpeg ffd8
 	    while (count < 10 && tag != 0xFFC0) {
 
-		tag = read16(_fd[0]);
+		tag = read16(fd);
 		if ((tag >> 8) != 0xff) {
 		    printf("invalid jpeg tag found (%x)\n", tag);
 		}
 		if (tag == 0xFFC0) {
-		    read16(_fd[0]);	// size
-		    read8(_fd[0]);	// precision
-		    h = read16(_fd[0]);
-		    w = read16(_fd[0]);
+		    read16(fd);	// size
+		    read8(fd);	// precision
+		    h = read16(fd);
+		    w = read16(fd);
                     if(w&1) w++;
                     if(h&1) h++;
 		} else {
 
-		    off = read16(_fd[0]);
+		    off = read16(fd);
 		    if (off < 2) {
 			printf("Offset too short!\n");
+			fclose(fd);
 			return 0;
 		    }
 		    aprintf("Found tag : %x , jumping %d bytes\n", tag,
 			    off);
-		    fseek(_fd[0], off - 2, SEEK_CUR);
+		    fseek(fd, off - 2, SEEK_CUR);
 		}
 		count++;
 	    }
 	    if (tag != 0xffc0) {
 		printf("Cannot fint start of frame\n");
+		fclose(fd);
 		return 0;
 	    }
 	    printf("\n %lu x %lu..\n", w, h);
@@ -302,20 +323,21 @@
 	{
 	    BITMAPINFOHEADER bmph;
 
-	    fseek(_fd[0], 10, SEEK_SET);
+	    fseek(fd, 10, SEEK_SET);
 
 #define MK32() (fcc_tab[0]+(fcc_tab[1]<<8)+(fcc_tab[2]<<16)+ \
 						(fcc_tab[3]<<24))
 
-	    fread(fcc_tab, 4, 1, _fd[0]);
+	    fread(fcc_tab, 4, 1, fd);
 	    _offset = MK32();
 	    // size, width height follow as int32 
-	    fread(&bmph, sizeof(bmph), 1, _fd[0]);
+	    fread(&bmph, sizeof(bmph), 1, fd);
 #ifdef ADM_BIG_ENDIAN
 	    Endian_BitMapInfo(&bmph);
 #endif
 	    if (bmph.biCompression != 0) {
 		printf("\ncannot handle compressed bmp\n");
+		fclose(fd);
 		return 0;
 	    }
 	    w = bmph.biWidth;
@@ -329,22 +351,23 @@
 	case PIC_PNG:
 	    {
     	     _offset = 0;
-	         fseek(_fd[0], 0, SEEK_SET);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-    	     w=read32(_fd[0]);;
-    	     h=read32(_fd[0]);;
+			 fseek(fd, 0, SEEK_SET);
+			 read32(fd);
+			 read32(fd);
+			 read32(fd);
+			 read32(fd);
+			 w=read32(fd);
+			 h=read32(fd);
     	     // It is big endian
     	     printf("Png seems to be %d x %d \n",w,h);
-    	     break;
 	    }
 	    break;
     default:
 	ADM_assert(0);
     }
 
+	fclose(fd);
+
 //_______________________________________
 //              Now build header info
 //_______________________________________
@@ -409,5 +432,12 @@
     *flags = AVI_KEY_FRAME;
     return 1;
 }
-//****************************************************************
-//EOF
+
+FILE* picHeader::openFrameFile(uint32_t frameNum)
+{
+	char filename[250];
+
+	sprintf(filename, _fileMask, frameNum + _first);
+
+	return fopen(filename, "rb");
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-14 15:28:09 UTC (rev 4097)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-15 12:16:29 UTC (rev 4098)
@@ -36,24 +36,25 @@
 class picHeader         :public vidHeader
 {
 protected:
+	char *_fileMask;
+
 					uint32_t 		_nb_file;
        					uint32_t 		_first,_offset,_w,_h;
 
-            				FILE 		**_fd;
 					uint32_t		*_imgSize;
-
 					uint32_t 		_type;
 
 					uint32_t    read32(FILE *fd);
 					uint16_t    read16(FILE *fd);
 					uint8_t     read8(FILE *fd);
+					FILE* openFrameFile(uint32_t frameNum);
 
 public:
 //  static int checkFourCC(uint8_t *in, uint8_t *fourcc);
 
 virtual   void 				Dump(void) {};
 
-			picHeader( void ) {_nb_file=0;_fd=NULL;_imgSize=NULL;};
+			picHeader( void );
        		    ~picHeader(  ) { };
 // AVI io
 virtual 	uint8_t			open(char *name);



From gruntster at mail.berlios.de  Sun Jun 15 14:51:17 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jun 2008 14:51:17 +0200
Subject: [Avidemux-svn-commit] r4099 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264:
	. gtk qt4 xml
Message-ID: <200806151251.m5FCpHCc007555@sheep.berlios.de>

Author: gruntster
Date: 2008-06-15 14:50:52 +0200 (Sun, 15 Jun 2008)
New Revision: 4099

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.glade
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml
Log:
[x264] tweaks

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2008-06-15 12:50:52 UTC (rev 4099)
@@ -626,8 +626,6 @@
 	printf("[x264] i_sps_id = %d\n", x264Param->i_sps_id);
 	printf("[x264] b_deterministic = %d\n", x264Param->b_deterministic);
 	printf("[x264] b_aud = %d\n", x264Param->b_aud);
-	printf("[x264] analyse.b_psnr = %d\n", x264Param->analyse.b_psnr);
-	printf("[x264] analyse.b_ssim = %d\n", x264Param->analyse.b_ssim);
 	printf("[x264] vui.i_overscan = %d\n", x264Param->vui.i_overscan);
 	printf("[x264] vui.i_vidformat = %d\n", x264Param->vui.i_vidformat);
 	printf("[x264] vui.i_colorprim = %d\n", x264Param->vui.i_colorprim);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp	2008-06-15 12:50:52 UTC (rev 4099)
@@ -417,1540 +417,1540 @@
 	}
 }
 
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *notebook1;
-  GtkWidget *alignment14;
-  GtkWidget *tableBitrate;
-  GtkWidget *labelEncodingMode;
-  GtkWidget *labelQuantizer;
-  GtkWidget *labelTarget;
-  GtkObject *spinbuttonQuantizer_adj;
-  GtkWidget *spinbuttonQuantizer;
-  GtkWidget *entryTarget;
-  GtkWidget *comboboxMode;
-  GtkWidget *labelPageBitrate;
-  GtkWidget *alignment15;
-  GtkWidget *vbox5;
-  GtkWidget *frame6;
-  GtkWidget *alignment6;
-  GtkWidget *vbox6;
-  GtkWidget *table7;
-  GtkWidget *labelPartitionDecision;
-  GtkWidget *labelMethod;
-  GtkWidget *comboboxPartitionDecision;
-  GtkWidget *comboboxMethod;
-  GtkWidget *table11;
-  GtkWidget *labelMaxRefFrames;
-  GtkWidget *labelRange;
-  GtkObject *spinbuttonRange_adj;
-  GtkWidget *spinbuttonRange;
-  GtkObject *spinbuttonMaxRefFrames_adj;
-  GtkWidget *spinbuttonMaxRefFrames;
-  GtkWidget *checkbuttonChromaME;
-  GtkWidget *checkbuttonMixedRefs;
-  GtkWidget *hbox8;
-  GtkWidget *checkbuttonfastPSkip;
-  GtkWidget *checkbuttonDCTDecimate;
-  GtkWidget *checkbuttoninterlaced;
-  GtkWidget *label24;
-  GtkWidget *frameSampleAR;
-  GtkWidget *alignment12;
-  GtkWidget *table35;
-  GtkWidget *hbox12;
-  GtkWidget *entryAR_Num;
-  GtkWidget *label53;
-  GtkWidget *entryAR_Den;
-  GtkWidget *radiobuttonCustomAR;
-  GSList *radiobuttonCustomAR_group = NULL;
-  GtkWidget *radiobuttonPredefinedAR;
-  GtkWidget *radiobuttonAsInputAR;
-  GtkWidget *label40;
-  GtkWidget *comboboxentry1;
-  GtkWidget *label39;
-  GtkWidget *frame7;
-  GtkWidget *alignment7;
-  GtkWidget *vbox7;
-  GtkWidget *alignment21;
-  GtkWidget *hbox2;
-  GtkWidget *checkbuttonCABAC;
-  GtkWidget *hbox7;
-  GtkWidget *labelTrellis;
-  GtkObject *spinbuttonTrellis_adj;
-  GtkWidget *spinbuttonTrellis;
-  GtkWidget *hbox11;
-  GtkWidget *labelNoiseReduction;
-  GtkObject *spinbuttonNoiseReduction_adj;
-  GtkWidget *spinbuttonNoiseReduction;
-  GtkWidget *hbox3;
-  GtkWidget *checkbuttonDeblockingFilter;
-  GtkWidget *table8;
-  GtkWidget *labelThreshold;
-  GtkWidget *labelStrength;
-  GtkObject *spinbuttonThreshold_adj;
-  GtkWidget *spinbuttonThreshold;
-  GtkObject *spinbuttonStrength_adj;
-  GtkWidget *spinbuttonStrength;
-  GtkWidget *label25;
-  GtkWidget *labelPageMotion_More;
-  GtkWidget *alignment16;
-  GtkWidget *vbox2;
-  GtkWidget *frame4;
-  GtkWidget *alignment4;
-  GtkWidget *vbox3;
-  GtkWidget *checkbutton8x8;
-  GtkWidget *checkbutton8x8P;
-  GtkWidget *checkbutton8x8B;
-  GtkWidget *checkbutton4x4;
-  GtkWidget *checkbutton8x8I;
-  GtkWidget *checkbutton4x4I;
-  GtkWidget *label19;
-  GtkWidget *frame5;
-  GtkWidget *alignment5;
-  GtkWidget *vbox4;
-  GtkWidget *table5;
-  GtkWidget *labelBias;
-  GtkWidget *labelMaxConsecutive;
-  GtkObject *spinbuttonBias_adj;
-  GtkWidget *spinbuttonBias;
-  GtkObject *spinbuttonMaxBFrame_adj;
-  GtkWidget *spinbuttonMaxBFrame;
-  GtkWidget *alignment20;
-  GtkWidget *table6;
-  GtkWidget *checkbuttonBidirME;
-  GtkWidget *checkbuttonWeighted;
-  GtkWidget *checkbuttonAdaptative;
-  GtkWidget *checkbuttonBasReference;
-  GtkWidget *hbox1;
-  GtkWidget *labelBFrameDirectMode;
-  GtkWidget *comboboxDirectMode;
-  GtkWidget *label20;
-  GtkWidget *labelPagePartion_Frame;
-  GtkWidget *alignment17;
-  GtkWidget *vbox1;
-  GtkWidget *frame1;
-  GtkWidget *alignment1;
-  GtkWidget *table2;
-  GtkObject *spinbuttonKeyframeBoost_adj;
-  GtkWidget *spinbuttonKeyframeBoost;
-  GtkObject *spinbuttonBframeReduction_adj;
-  GtkWidget *spinbuttonBframeReduction;
-  GtkObject *spinbuttonBitrateVariability_adj;
-  GtkWidget *spinbuttonBitrateVariability;
-  GtkWidget *labelKeyframeboost;
-  GtkWidget *label11;
-  GtkWidget *label12;
-  GtkWidget *label7;
-  GtkWidget *frame2;
-  GtkWidget *alignment2;
-  GtkWidget *table3;
-  GtkWidget *label13;
-  GtkWidget *label14;
-  GtkWidget *label15;
-  GtkObject *spinbuttonMinQp_adj;
-  GtkWidget *spinbuttonMinQp;
-  GtkObject *spinbuttonMaxQp_adj;
-  GtkWidget *spinbuttonMaxQp;
-  GtkObject *spinbuttonQpStep_adj;
-  GtkWidget *spinbuttonQpStep;
-  GtkWidget *label8;
-  GtkWidget *frame3;
-  GtkWidget *alignment3;
-  GtkWidget *table4;
-  GtkObject *spinbuttonSceneCut_adj;
-  GtkWidget *spinbuttonSceneCut;
-  GtkWidget *label16;
-  GtkWidget *label17;
-  GtkObject *spinbuttonMinIdr_adj;
-  GtkWidget *spinbuttonMinIdr;
-  GtkObject *spinbuttonMaxIdr_adj;
-  GtkWidget *spinbuttonMaxIdr;
-  GtkWidget *label18;
-  GtkWidget *labelMoreEncodingSettings;
-  GtkWidget *frameVideoBufferVerifier;
-  GtkWidget *alignment11;
-  GtkWidget *table12;
-  GtkWidget *labelVBVBufferSize;
-  GtkWidget *labelVBVInitialbuffer;
-  GtkWidget *labelVBVMaximumBitrate;
-  GtkObject *spinbuttonvbv_max_bitrate_adj;
-  GtkWidget *spinbuttonvbv_max_bitrate;
-  GtkObject *spinbuttonvbv_buffer_size_adj;
-  GtkWidget *spinbuttonvbv_buffer_size;
-  GtkObject *spinbuttonvbv_buffer_init_adj;
-  GtkWidget *spinbuttonvbv_buffer_init;
-  GtkWidget *labelVideoBufferVerifier;
-  GtkWidget *labelPageRateControl;
-  GtkWidget *alignment18;
-  GtkWidget *vbox8;
-  GtkWidget *frame10;
-  GtkWidget *alignment10;
-  GtkWidget *table15;
-  GtkWidget *labelBitrateVariance;
-  GtkObject *spinbuttonBitrateVariance_adj;
-  GtkWidget *spinbuttonBitrateVariance;
-  GtkObject *spinbuttonQuantizerCompression_adj;
-  GtkWidget *spinbuttonQuantizerCompression;
-  GtkObject *spinbuttonTempBlurFrame_adj;
-  GtkWidget *spinbuttonTempBlurFrame;
-  GtkObject *spinbuttonTempBlurQuant_adj;
-  GtkWidget *spinbuttonTempBlurQuant;
-  GtkWidget *labelQuantizerCompression;
-  GtkWidget *labelTempBlurEstFrame;
-  GtkWidget *labelTempBlueQuant;
-  GtkWidget *labelMisc;
-  GtkWidget *frame11;
-  GtkWidget *alignment13;
-  GtkWidget *table16;
-  GtkObject *spinbutton8_adj;
-  GtkWidget *spinbutton8;
-  GtkObject *spinbutton9_adj;
-  GtkWidget *spinbutton9;
-  GtkObject *spinbuttonChromaQPOffset_adj;
-  GtkWidget *spinbuttonChromaQPOffset;
-  GtkWidget *labelFactorbetweenIandP;
-  GtkWidget *labelFactorbetweenPandB;
-  GtkWidget *labelChromaQPOffset;
-  GtkWidget *labelQuantizers;
-  GtkWidget *frame9;
-  GtkWidget *alignment9;
-  GtkWidget *vbox9;
-  GtkWidget *radiobuttonFlatmatrix;
-  GSList *radiobuttonFlatmatrix_group = NULL;
-  GtkWidget *radiobuttonJVTmatrix;
-  GtkWidget *hbox13;
-  GtkWidget *radiobuttonCustommatrix;
-  GtkWidget *hbox14;
-  GtkWidget *filechooserbuttonOpenCQMFile;
-  GtkWidget *vseparator1;
-  GtkWidget *buttonEditCustomMatrix;
-  GtkWidget *labelFrameQuantizationMatrices;
-  GtkWidget *labelMore;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *buttonResetDaults;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-  GtkTooltips *tooltips;
-
-  tooltips = gtk_tooltips_new ();
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("x264 Configuration"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  notebook1 = gtk_notebook_new ();
-  gtk_widget_show (notebook1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), notebook1, TRUE, TRUE, 0);
-
-  alignment14 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment14);
-  gtk_container_add (GTK_CONTAINER (notebook1), alignment14);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment14), 7, 7, 7, 7);
-
-  tableBitrate = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (tableBitrate);
-  gtk_container_add (GTK_CONTAINER (alignment14), tableBitrate);
-  gtk_table_set_row_spacings (GTK_TABLE (tableBitrate), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (tableBitrate), 10);
-
-  labelEncodingMode = gtk_label_new (_("Encoding Mode"));
-  gtk_widget_show (labelEncodingMode);
-  gtk_table_attach (GTK_TABLE (tableBitrate), labelEncodingMode, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelEncodingMode), 0, 0.5);
-
-  labelQuantizer = gtk_label_new (_("Quantizer"));
-  gtk_widget_show (labelQuantizer);
-  gtk_table_attach (GTK_TABLE (tableBitrate), labelQuantizer, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelQuantizer), 0, 0.5);
-
-  labelTarget = gtk_label_new (_("Target Size"));
-  gtk_widget_show (labelTarget);
-  gtk_table_attach (GTK_TABLE (tableBitrate), labelTarget, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelTarget), 0, 0.5);
-
-  spinbuttonQuantizer_adj = gtk_adjustment_new (4, 0, 51, 1, 10, 10);
-  spinbuttonQuantizer = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuantizer_adj), 1, 0);
-  gtk_widget_show (spinbuttonQuantizer);
-  gtk_table_attach (GTK_TABLE (tableBitrate), spinbuttonQuantizer, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonQuantizer, _("Constant Quantizer - Each frame will have the same compression. Low numbers equal higher quality while high numbers equal lower quality."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQuantizer), TRUE);
-
-  entryTarget = gtk_entry_new ();
-  gtk_widget_show (entryTarget);
-  gtk_table_attach (GTK_TABLE (tableBitrate), entryTarget, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, entryTarget, _("Target bitrate or file size"), NULL);
-  gtk_entry_set_width_chars (GTK_ENTRY (entryTarget), 4);
-
-  comboboxMode = gtk_combo_box_new_text ();
-  gtk_widget_show (comboboxMode);
-  gtk_table_attach (GTK_TABLE (tableBitrate), comboboxMode, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Quality Quantizer (Average)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Quality Quantizer (Constant)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Bitrate (Average)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Two Pass - Video Size"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Two Pass - Average Bitrate"));
-
-  labelPageBitrate = gtk_label_new (_("Bitrate"));
-  gtk_widget_show (labelPageBitrate);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 0), labelPageBitrate);
-  gtk_misc_set_alignment (GTK_MISC (labelPageBitrate), 0, 0.5);
-
-  alignment15 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment15);
-  gtk_container_add (GTK_CONTAINER (notebook1), alignment15);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment15), 7, 7, 7, 7);
-
-  vbox5 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox5);
-  gtk_container_add (GTK_CONTAINER (alignment15), vbox5);
-
-  frame6 = gtk_frame_new (NULL);
-  gtk_widget_show (frame6);
-  gtk_box_pack_start (GTK_BOX (vbox5), frame6, FALSE, TRUE, 0);
-
-  alignment6 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment6);
-  gtk_container_add (GTK_CONTAINER (frame6), alignment6);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment6), 7, 4, 7, 7);
-
-  vbox6 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox6);
-  gtk_container_add (GTK_CONTAINER (alignment6), vbox6);
-
-  table7 = gtk_table_new (2, 3, FALSE);
-  gtk_widget_show (table7);
-  gtk_box_pack_start (GTK_BOX (vbox6), table7, FALSE, TRUE, 0);
-  gtk_table_set_row_spacings (GTK_TABLE (table7), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table7), 10);
-
-  labelPartitionDecision = gtk_label_new (_("Partition Decision"));
-  gtk_widget_show (labelPartitionDecision);
-  gtk_table_attach (GTK_TABLE (table7), labelPartitionDecision, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelPartitionDecision), 0, 0.5);
-
-  labelMethod = gtk_label_new (_("Method"));
-  gtk_widget_show (labelMethod);
-  gtk_table_attach (GTK_TABLE (table7), labelMethod, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelMethod), 0, 0.5);
-
-  comboboxPartitionDecision = gtk_combo_box_new_text ();
-  gtk_widget_show (comboboxPartitionDecision);
-  gtk_table_attach (GTK_TABLE (table7), comboboxPartitionDecision, 1, 3, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("1  - Extremely Low (Fastest)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("2  - Very Low"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("3  - Low"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("4  - Medium"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("5  - High (Default)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6  - Very High"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6B - Very High (RDO on B-frames)"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7  - Ultra High"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7B - Ultra High (RDO on B-frames)"));
-
-  comboboxMethod = gtk_combo_box_new_text ();
-  gtk_widget_show (comboboxMethod);
-  gtk_table_attach (GTK_TABLE (table7), comboboxMethod, 1, 3, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Diamond Search"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Hexagonal Search"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Uneven Multi-hexagon"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Exhaustive Search"));
-
-  table11 = gtk_table_new (2, 3, FALSE);
-  gtk_widget_show (table11);
-  gtk_box_pack_start (GTK_BOX (vbox6), table11, TRUE, FALSE, 0);
-  gtk_table_set_row_spacings (GTK_TABLE (table11), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table11), 10);
-
-  labelMaxRefFrames = gtk_label_new (_("Max. Ref. Frames"));
-  gtk_widget_show (labelMaxRefFrames);
-  gtk_table_attach (GTK_TABLE (table11), labelMaxRefFrames, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelMaxRefFrames), 0, 0.5);
-
-  labelRange = gtk_label_new (_("Range"));
-  gtk_widget_show (labelRange);
-  gtk_table_attach (GTK_TABLE (table11), labelRange, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelRange), 0, 0.5);
-
-  spinbuttonRange_adj = gtk_adjustment_new (17, 0, 64, 1, 10, 10);
-  spinbuttonRange = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRange_adj), 1, 0);
-  gtk_widget_show (spinbuttonRange);
-  gtk_table_attach (GTK_TABLE (table11), spinbuttonRange, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonRange, _("Define how many pixels are analysed for motion estimation. The higher the range the more accurate the analysis but the slower the encoding time."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRange), TRUE);
-
-  spinbuttonMaxRefFrames_adj = gtk_adjustment_new (1, 0, 16, 1, 10, 10);
-  spinbuttonMaxRefFrames = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxRefFrames_adj), 1, 0);
-  gtk_widget_show (spinbuttonMaxRefFrames);
-  gtk_table_attach (GTK_TABLE (table11), spinbuttonMaxRefFrames, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMaxRefFrames, _("Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers 3 to 5 are recommended."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxRefFrames), TRUE);
-
-  checkbuttonChromaME = gtk_check_button_new_with_mnemonic (_("Chroma ME"));
-  gtk_widget_show (checkbuttonChromaME);
-  gtk_table_attach (GTK_TABLE (table11), checkbuttonChromaME, 2, 3, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 30, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonChromaME, _("Use color information for detecting motion to improve quality"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonChromaME), TRUE);
-
-  checkbuttonMixedRefs = gtk_check_button_new_with_mnemonic (_("Mixed Refs"));
-  gtk_widget_show (checkbuttonMixedRefs);
-  gtk_table_attach (GTK_TABLE (table11), checkbuttonMixedRefs, 2, 3, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 30, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonMixedRefs, _("Calculate referencing individually based on each partition"), NULL);
-
-  hbox8 = gtk_hbox_new (TRUE, 0);
-  gtk_widget_show (hbox8);
-  gtk_box_pack_start (GTK_BOX (vbox6), hbox8, TRUE, TRUE, 0);
-
-  checkbuttonfastPSkip = gtk_check_button_new_with_mnemonic (_("Fast P-Skip"));
-  gtk_widget_show (checkbuttonfastPSkip);
-  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttonfastPSkip, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonfastPSkip, _("Early skip detection on P-frames to speedup encoding. Quality will be slightly reduced."), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonfastPSkip), TRUE);
-
-  checkbuttonDCTDecimate = gtk_check_button_new_with_mnemonic (_("DCT Decimate"));
-  gtk_widget_show (checkbuttonDCTDecimate);
-  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttonDCTDecimate, FALSE, FALSE, 0);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonDCTDecimate), TRUE);
-
-  checkbuttoninterlaced = gtk_check_button_new_with_mnemonic (_("Interlaced"));
-  gtk_widget_show (checkbuttoninterlaced);
-  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttoninterlaced, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttoninterlaced, _("Input video is interlaced"), NULL);
-
-  label24 = gtk_label_new (_("<b>Motion Estimation</b>"));
-  gtk_widget_show (label24);
-  gtk_frame_set_label_widget (GTK_FRAME (frame6), label24);
-  gtk_label_set_use_markup (GTK_LABEL (label24), TRUE);
-
-  frameSampleAR = gtk_frame_new (NULL);
-  gtk_widget_show (frameSampleAR);
-  gtk_box_pack_start (GTK_BOX (vbox5), frameSampleAR, FALSE, TRUE, 0);
-
-  alignment12 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment12);
-  gtk_container_add (GTK_CONTAINER (frameSampleAR), alignment12);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment12), 7, 7, 7, 7);
-
-  table35 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table35);
-  gtk_container_add (GTK_CONTAINER (alignment12), table35);
-  gtk_table_set_row_spacings (GTK_TABLE (table35), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table35), 10);
-
-  hbox12 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox12);
-  gtk_table_attach (GTK_TABLE (table35), hbox12, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  entryAR_Num = gtk_entry_new ();
-  gtk_widget_show (entryAR_Num);
-  gtk_box_pack_start (GTK_BOX (hbox12), entryAR_Num, TRUE, TRUE, 0);
-  gtk_tooltips_set_tip (tooltips, entryAR_Num, _("Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."), NULL);
-  gtk_entry_set_text (GTK_ENTRY (entryAR_Num), _("1"));
-  gtk_entry_set_width_chars (GTK_ENTRY (entryAR_Num), 4);
-
-  label53 = gtk_label_new (_(":"));
-  gtk_widget_show (label53);
-  gtk_box_pack_start (GTK_BOX (hbox12), label53, FALSE, FALSE, 3);
-
-  entryAR_Den = gtk_entry_new ();
-  gtk_widget_show (entryAR_Den);
-  gtk_box_pack_start (GTK_BOX (hbox12), entryAR_Den, TRUE, TRUE, 0);
-  gtk_tooltips_set_tip (tooltips, entryAR_Den, _("Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."), NULL);
-  gtk_entry_set_text (GTK_ENTRY (entryAR_Den), _("1"));
-  gtk_entry_set_width_chars (GTK_ENTRY (entryAR_Den), 4);
-
-  radiobuttonCustomAR = gtk_radio_button_new_with_mnemonic (NULL, _("Custom"));
-  gtk_widget_show (radiobuttonCustomAR);
-  gtk_table_attach (GTK_TABLE (table35), radiobuttonCustomAR, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, radiobuttonCustomAR, _("Set a custom aspect ratio. The default 1:1 is recommended for most video."), NULL);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonCustomAR), radiobuttonCustomAR_group);
-  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonCustomAR));
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (radiobuttonCustomAR), TRUE);
-
-  radiobuttonPredefinedAR = gtk_radio_button_new_with_mnemonic (NULL, _("Predefined Aspect Ratio"));
-  gtk_widget_show (radiobuttonPredefinedAR);
-  gtk_table_attach (GTK_TABLE (table35), radiobuttonPredefinedAR, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, radiobuttonPredefinedAR, _("Set a common predefined aspect ratio"), NULL);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonPredefinedAR), radiobuttonCustomAR_group);
-  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonPredefinedAR));
-
-  radiobuttonAsInputAR = gtk_radio_button_new_with_mnemonic (NULL, _("As Input"));
-  gtk_widget_show (radiobuttonAsInputAR);
-  gtk_table_attach (GTK_TABLE (table35), radiobuttonAsInputAR, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonAsInputAR), radiobuttonCustomAR_group);
-  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonAsInputAR));
-
-  label40 = gtk_label_new ("1:1 (1:1)");
-  gtk_widget_show (label40);
-  gtk_table_attach (GTK_TABLE (table35), label40, 1, 2, 2, 3,
-                    (GtkAttachOptions) (0),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label40), 0, 0.5);
-
-  comboboxentry1 = gtk_combo_box_new_text ();
-  gtk_widget_show (comboboxentry1);
-  gtk_table_attach (GTK_TABLE (table35), comboboxentry1, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  label39 = gtk_label_new (_("<b>Sample Aspect Ratio</b>"));
-  gtk_widget_show (label39);
-  gtk_frame_set_label_widget (GTK_FRAME (frameSampleAR), label39);
-  gtk_label_set_use_markup (GTK_LABEL (label39), TRUE);
-
-  frame7 = gtk_frame_new (NULL);
-  gtk_widget_show (frame7);
-  gtk_box_pack_start (GTK_BOX (vbox5), frame7, FALSE, TRUE, 0);
-
-  alignment7 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment7);
-  gtk_container_add (GTK_CONTAINER (frame7), alignment7);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment7), 7, 7, 7, 7);
-
-  vbox7 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox7);
-  gtk_container_add (GTK_CONTAINER (alignment7), vbox7);
-
-  alignment21 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment21);
-  gtk_box_pack_start (GTK_BOX (vbox7), alignment21, TRUE, TRUE, 0);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment21), 0, 3, 0, 0);
-
-  hbox2 = gtk_hbox_new (FALSE, 17);
-  gtk_widget_show (hbox2);
-  gtk_container_add (GTK_CONTAINER (alignment21), hbox2);
-
-  checkbuttonCABAC = gtk_check_button_new_with_mnemonic (_("CABAC"));
-  gtk_widget_show (checkbuttonCABAC);
-  gtk_box_pack_start (GTK_BOX (hbox2), checkbuttonCABAC, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonCABAC, _("Lossless compression technique that reduces bitrate by approximately 10%. Increases encoding and decoding time."), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonCABAC), TRUE);
-
-  hbox7 = gtk_hbox_new (FALSE, 10);
-  gtk_widget_show (hbox7);
-  gtk_box_pack_start (GTK_BOX (hbox2), hbox7, FALSE, FALSE, 0);
-
-  labelTrellis = gtk_label_new (_("Trellis"));
-  gtk_widget_show (labelTrellis);
-  gtk_box_pack_start (GTK_BOX (hbox7), labelTrellis, FALSE, FALSE, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelTrellis), 0, 0.5);
-
-  spinbuttonTrellis_adj = gtk_adjustment_new (0, 0, 2, 1, 10, 10);
-  spinbuttonTrellis = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTrellis_adj), 1, 0);
-  gtk_widget_show (spinbuttonTrellis);
-  gtk_box_pack_start (GTK_BOX (hbox7), spinbuttonTrellis, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTrellis, _("Use Trellis Rate Distortion Optimisation to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTrellis), TRUE);
-
-  hbox11 = gtk_hbox_new (FALSE, 10);
-  gtk_widget_show (hbox11);
-  gtk_box_pack_start (GTK_BOX (hbox2), hbox11, FALSE, FALSE, 2);
-
-  labelNoiseReduction = gtk_label_new (_("Noise Reduction"));
-  gtk_widget_show (labelNoiseReduction);
-  gtk_box_pack_start (GTK_BOX (hbox11), labelNoiseReduction, FALSE, FALSE, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelNoiseReduction), 0, 0.5);
-
-  spinbuttonNoiseReduction_adj = gtk_adjustment_new (0, 0, 1000000000, 1, 10, 10);
-  spinbuttonNoiseReduction = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonNoiseReduction_adj), 1, 0);
-  gtk_widget_show (spinbuttonNoiseReduction);
-  gtk_box_pack_start (GTK_BOX (hbox11), spinbuttonNoiseReduction, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonNoiseReduction, _("Set the amount of noise reduction"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonNoiseReduction), TRUE);
-
-  hbox3 = gtk_hbox_new (FALSE, 10);
-  gtk_widget_show (hbox3);
-  gtk_box_pack_start (GTK_BOX (vbox7), hbox3, TRUE, TRUE, 0);
-
-  checkbuttonDeblockingFilter = gtk_check_button_new_with_mnemonic (_("Deblocking Filter"));
-  gtk_widget_show (checkbuttonDeblockingFilter);
-  gtk_box_pack_start (GTK_BOX (hbox3), checkbuttonDeblockingFilter, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonDeblockingFilter, _("Enable in-loop deblocking to filter the video"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonDeblockingFilter), TRUE);
-
-  table8 = gtk_table_new (2, 2, FALSE);
-  gtk_widget_show (table8);
-  gtk_box_pack_start (GTK_BOX (hbox3), table8, TRUE, TRUE, 0);
-  gtk_table_set_row_spacings (GTK_TABLE (table8), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table8), 10);
-
-  labelThreshold = gtk_label_new (_("Threshold"));
-  gtk_widget_show (labelThreshold);
-  gtk_table_attach (GTK_TABLE (table8), labelThreshold, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_use_markup (GTK_LABEL (labelThreshold), TRUE);
-  gtk_misc_set_alignment (GTK_MISC (labelThreshold), 0, 0.5);
-
-  labelStrength = gtk_label_new (_("Strength"));
-  gtk_widget_show (labelStrength);
-  gtk_table_attach (GTK_TABLE (table8), labelStrength, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_use_markup (GTK_LABEL (labelStrength), TRUE);
-  gtk_misc_set_alignment (GTK_MISC (labelStrength), 0, 0.5);
-
-  spinbuttonThreshold_adj = gtk_adjustment_new (0, -6, 6, 1, 10, 10);
-  spinbuttonThreshold = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonThreshold_adj), 1, 0);
-  gtk_widget_show (spinbuttonThreshold);
-  gtk_table_attach (GTK_TABLE (table8), spinbuttonThreshold, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonThreshold, _("Threshold for block detection. Positive values will detect more blocks, negative values will detect less."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonThreshold), TRUE);
-
-  spinbuttonStrength_adj = gtk_adjustment_new (0, -6, 6, 1, 10, 10);
-  spinbuttonStrength = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonStrength_adj), 1, 0);
-  gtk_widget_show (spinbuttonStrength);
-  gtk_table_attach (GTK_TABLE (table8), spinbuttonStrength, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonStrength, _("Positive values will soften the video, negative values will sharpen"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonStrength), TRUE);
-
-  label25 = gtk_label_new (_("<b>Misc. Options</b>"));
-  gtk_widget_show (label25);
-  gtk_frame_set_label_widget (GTK_FRAME (frame7), label25);
-  gtk_label_set_use_markup (GTK_LABEL (label25), TRUE);
-
-  labelPageMotion_More = gtk_label_new (_("Motion & Misc"));
-  gtk_widget_show (labelPageMotion_More);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 1), labelPageMotion_More);
-
-  alignment16 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment16);
-  gtk_container_add (GTK_CONTAINER (notebook1), alignment16);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment16), 7, 7, 7, 7);
-
-  vbox2 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox2);
-  gtk_container_add (GTK_CONTAINER (alignment16), vbox2);
-
-  frame4 = gtk_frame_new (NULL);
-  gtk_widget_show (frame4);
-  gtk_box_pack_start (GTK_BOX (vbox2), frame4, FALSE, TRUE, 0);
-
-  alignment4 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment4);
-  gtk_container_add (GTK_CONTAINER (frame4), alignment4);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment4), 7, 7, 7, 7);
-
-  vbox3 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox3);
-  gtk_container_add (GTK_CONTAINER (alignment4), vbox3);
-
-  checkbutton8x8 = gtk_check_button_new_with_mnemonic (_("8x8 Transform"));
-  gtk_widget_show (checkbutton8x8);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton8x8, _("General block breakdown transformation"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8), TRUE);
-
-  checkbutton8x8P = gtk_check_button_new_with_mnemonic (_("8x8, 8x16 and 16x8 P-frame search"));
-  gtk_widget_show (checkbutton8x8P);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8P, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton8x8P, _("Improve the P-frame quality"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8P), TRUE);
-
-  checkbutton8x8B = gtk_check_button_new_with_mnemonic (_("8x8, 8x16 and 16x8 B-frame search"));
-  gtk_widget_show (checkbutton8x8B);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8B, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton8x8B, _("Improve the B-frame quality"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8B), TRUE);
-
-  checkbutton4x4 = gtk_check_button_new_with_mnemonic (_("4x4, 4x8 and 8x4 P-frame search"));
-  gtk_widget_show (checkbutton4x4);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton4x4, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton4x4, _("Further improve the P-frame quality"), NULL);
-
-  checkbutton8x8I = gtk_check_button_new_with_mnemonic (_("8x8 Intra search"));
-  gtk_widget_show (checkbutton8x8I);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8I, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton8x8I, _("Enable DCT Intra block search to improve quality"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8I), TRUE);
-
-  checkbutton4x4I = gtk_check_button_new_with_mnemonic (_("4x4 Intra search"));
-  gtk_widget_show (checkbutton4x4I);
-  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton4x4I, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, checkbutton4x4I, _("Further enable DCT Intra block search to improve quality"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton4x4I), TRUE);
-
-  label19 = gtk_label_new (_("<b>Partition Macroblocks</b>"));
-  gtk_widget_show (label19);
-  gtk_frame_set_label_widget (GTK_FRAME (frame4), label19);
-  gtk_label_set_use_markup (GTK_LABEL (label19), TRUE);
-
-  frame5 = gtk_frame_new (NULL);
-  gtk_widget_show (frame5);
-  gtk_box_pack_start (GTK_BOX (vbox2), frame5, FALSE, TRUE, 0);
-
-  alignment5 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment5);
-  gtk_container_add (GTK_CONTAINER (frame5), alignment5);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment5), 7, 7, 7, 7);
-
-  vbox4 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox4);
-  gtk_container_add (GTK_CONTAINER (alignment5), vbox4);
-
-  table5 = gtk_table_new (2, 2, FALSE);
-  gtk_widget_show (table5);
-  gtk_box_pack_start (GTK_BOX (vbox4), table5, TRUE, TRUE, 0);
-  gtk_table_set_row_spacings (GTK_TABLE (table5), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table5), 10);
-
-  labelBias = gtk_label_new (_("Bias"));
-  gtk_widget_show (labelBias);
-  gtk_table_attach (GTK_TABLE (table5), labelBias, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelBias), 0, 0.5);
-
-  labelMaxConsecutive = gtk_label_new (_("Max Consecutive"));
-  gtk_widget_show (labelMaxConsecutive);
-  gtk_table_attach (GTK_TABLE (table5), labelMaxConsecutive, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelMaxConsecutive), 0, 0.5);
-
-  spinbuttonBias_adj = gtk_adjustment_new (0, -100, 100, 1, 10, 10);
-  spinbuttonBias = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBias_adj), 1, 0);
-  gtk_widget_show (spinbuttonBias);
-  gtk_table_attach (GTK_TABLE (table5), spinbuttonBias, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonBias, _("Increase / decrease probability for how often B-frames are used. It will not violate the maximum consecutive frame limit."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBias), TRUE);
-
-  spinbuttonMaxBFrame_adj = gtk_adjustment_new (3, 0, 15, 1, 10, 10);
-  spinbuttonMaxBFrame = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxBFrame_adj), 1, 0);
-  gtk_widget_show (spinbuttonMaxBFrame);
-  gtk_table_attach (GTK_TABLE (table5), spinbuttonMaxBFrame, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMaxBFrame, _("Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be dropped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxBFrame), TRUE);
-
-  alignment20 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment20);
-  gtk_box_pack_start (GTK_BOX (vbox4), alignment20, TRUE, TRUE, 0);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment20), 3, 3, 0, 0);
-
-  table6 = gtk_table_new (2, 2, FALSE);
-  gtk_widget_show (table6);
-  gtk_container_add (GTK_CONTAINER (alignment20), table6);
-  gtk_table_set_row_spacings (GTK_TABLE (table6), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table6), 10);
-
-  checkbuttonBidirME = gtk_check_button_new_with_mnemonic (_("Bidirectional ME"));
-  gtk_widget_show (checkbuttonBidirME);
-  gtk_table_attach (GTK_TABLE (table6), checkbuttonBidirME, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonBidirME, _("Optimise both motion vectors in B-frames. This will improve quality but take more time for encoding."), NULL);
-
-  checkbuttonWeighted = gtk_check_button_new_with_mnemonic (_("Weighted Biprediction"));
-  gtk_widget_show (checkbuttonWeighted);
-  gtk_table_attach (GTK_TABLE (table6), checkbuttonWeighted, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonWeighted, _("Enables weighting of B-frames to help fades"), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonWeighted), TRUE);
-
-  checkbuttonAdaptative = gtk_check_button_new_with_mnemonic (_("Adaptative DCT"));
-  gtk_widget_show (checkbuttonAdaptative);
-  gtk_table_attach (GTK_TABLE (table6), checkbuttonAdaptative, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonAdaptative, _("Use fewer B-frames if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames."), NULL);
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonAdaptative), TRUE);
-
-  checkbuttonBasReference = gtk_check_button_new_with_mnemonic (_("Use as Reference"));
-  gtk_widget_show (checkbuttonBasReference);
-  gtk_table_attach (GTK_TABLE (table6), checkbuttonBasReference, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, checkbuttonBasReference, _("Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"), NULL);
-
-  hbox1 = gtk_hbox_new (FALSE, 10);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox4), hbox1, TRUE, TRUE, 0);
-
-  labelBFrameDirectMode = gtk_label_new (_("B-Frame Direct Mode"));
-  gtk_widget_show (labelBFrameDirectMode);
-  gtk_box_pack_start (GTK_BOX (hbox1), labelBFrameDirectMode, FALSE, TRUE, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelBFrameDirectMode), 0, 0.5);
-
-  comboboxDirectMode = gtk_combo_box_new_text ();
-  gtk_widget_show (comboboxDirectMode);
-  gtk_box_pack_start (GTK_BOX (hbox1), comboboxDirectMode, FALSE, TRUE, 0);
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("None"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Spatial"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Temporal"));
-  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Auto"));
-
-  label20 = gtk_label_new (_("<b>B-Frames</b>"));
-  gtk_widget_show (label20);
-  gtk_frame_set_label_widget (GTK_FRAME (frame5), label20);
-  gtk_label_set_use_markup (GTK_LABEL (label20), TRUE);
-
-  labelPagePartion_Frame = gtk_label_new (_("Partitions & Frames"));
-  gtk_widget_show (labelPagePartion_Frame);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 2), labelPagePartion_Frame);
-
-  alignment17 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment17);
-  gtk_container_add (GTK_CONTAINER (notebook1), alignment17);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment17), 7, 7, 7, 7);
-
-  vbox1 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox1);
-  gtk_container_add (GTK_CONTAINER (alignment17), vbox1);
-
-  frame1 = gtk_frame_new (NULL);
-  gtk_widget_show (frame1);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame1, FALSE, TRUE, 1);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (frame1), alignment1);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment1), 7, 7, 7, 7);
-
-  table2 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table2);
-  gtk_container_add (GTK_CONTAINER (alignment1), table2);
-  gtk_table_set_row_spacings (GTK_TABLE (table2), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table2), 10);
-
-  spinbuttonKeyframeBoost_adj = gtk_adjustment_new (40, 0, 100, 1, 10, 10);
-  spinbuttonKeyframeBoost = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonKeyframeBoost_adj), 1, 0);
-  gtk_widget_show (spinbuttonKeyframeBoost);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonKeyframeBoost, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_widget_set_size_request (spinbuttonKeyframeBoost, 115, -1);
-  gtk_tooltips_set_tip (tooltips, spinbuttonKeyframeBoost, _("Set how much \"bitrate bonus\" a keyframe can get"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonKeyframeBoost), TRUE);
-
-  spinbuttonBframeReduction_adj = gtk_adjustment_new (30, 0, 100, 1, 10, 10);
-  spinbuttonBframeReduction = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBframeReduction_adj), 1, 0);
-  gtk_widget_show (spinbuttonBframeReduction);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonBframeReduction, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonBframeReduction, _("Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBframeReduction), TRUE);
-
-  spinbuttonBitrateVariability_adj = gtk_adjustment_new (60, 0, 100, 1, 10, 10);
-  spinbuttonBitrateVariability = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBitrateVariability_adj), 1, 0);
-  gtk_widget_show (spinbuttonBitrateVariability);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonBitrateVariability, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonBitrateVariability, _("Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBitrateVariability), TRUE);
-
-  labelKeyframeboost = gtk_label_new (_("Keyframe Boost (%)"));
-  gtk_widget_show (labelKeyframeboost);
-  gtk_table_attach (GTK_TABLE (table2), labelKeyframeboost, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelKeyframeboost), 0, 0.5);
-
-  label11 = gtk_label_new (_("B-frame Reduction (%)"));
-  gtk_widget_show (label11);
-  gtk_table_attach (GTK_TABLE (table2), label11, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label11), 0, 0.5);
-
-  label12 = gtk_label_new (_("Bitrate Variability (%)"));
-  gtk_widget_show (label12);
-  gtk_table_attach (GTK_TABLE (table2), label12, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label12), 0, 0.5);
-
-  label7 = gtk_label_new (_("<b>Bitrate</b>"));
-  gtk_widget_show (label7);
-  gtk_frame_set_label_widget (GTK_FRAME (frame1), label7);
-  gtk_label_set_use_markup (GTK_LABEL (label7), TRUE);
-
-  frame2 = gtk_frame_new (NULL);
-  gtk_widget_show (frame2);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame2, FALSE, TRUE, 1);
-
-  alignment2 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment2);
-  gtk_container_add (GTK_CONTAINER (frame2), alignment2);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment2), 7, 7, 7, 7);
-
-  table3 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table3);
-  gtk_container_add (GTK_CONTAINER (alignment2), table3);
-  gtk_table_set_row_spacings (GTK_TABLE (table3), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table3), 20);
-
-  label13 = gtk_label_new (_("Min QP"));
-  gtk_widget_show (label13);
-  gtk_table_attach (GTK_TABLE (table3), label13, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label13), 0, 0.5);
-
-  label14 = gtk_label_new (_("Max QP"));
-  gtk_widget_show (label14);
-  gtk_table_attach (GTK_TABLE (table3), label14, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label14), 0, 0.5);
-
-  label15 = gtk_label_new (_("Max QP Step"));
-  gtk_widget_show (label15);
-  gtk_table_attach (GTK_TABLE (table3), label15, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label15), 0, 0.5);
-
-  spinbuttonMinQp_adj = gtk_adjustment_new (10, 10, 51, 1, 10, 10);
-  spinbuttonMinQp = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMinQp_adj), 1, 0);
-  gtk_widget_show (spinbuttonMinQp);
-  gtk_table_attach (GTK_TABLE (table3), spinbuttonMinQp, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_widget_set_size_request (spinbuttonMinQp, 54, -1);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMinQp, _("Enforce a minimum quantizer level"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMinQp), TRUE);
-
-  spinbuttonMaxQp_adj = gtk_adjustment_new (51, 10, 51, 1, 10, 10);
-  spinbuttonMaxQp = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxQp_adj), 1, 0);
-  gtk_widget_show (spinbuttonMaxQp);
-  gtk_table_attach (GTK_TABLE (table3), spinbuttonMaxQp, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMaxQp, _("Enforce a maximum quantizer level"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxQp), TRUE);
-
-  spinbuttonQpStep_adj = gtk_adjustment_new (4, 0, 10, 1, 10, 10);
-  spinbuttonQpStep = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQpStep_adj), 1, 0);
-  gtk_widget_show (spinbuttonQpStep);
-  gtk_table_attach (GTK_TABLE (table3), spinbuttonQpStep, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonQpStep, _("Define how much the quantizer rate can change between two consecutive frames"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQpStep), TRUE);
-
-  label8 = gtk_label_new (_("<b>Quantization Limits</b>"));
-  gtk_widget_show (label8);
-  gtk_frame_set_label_widget (GTK_FRAME (frame2), label8);
-  gtk_label_set_use_markup (GTK_LABEL (label8), TRUE);
-
-  frame3 = gtk_frame_new (NULL);
-  gtk_widget_show (frame3);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame3, FALSE, TRUE, 1);
-
-  alignment3 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment3);
-  gtk_container_add (GTK_CONTAINER (frame3), alignment3);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment3), 7, 7, 7, 7);
-
-  table4 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table4);
-  gtk_container_add (GTK_CONTAINER (alignment3), table4);
-  gtk_table_set_row_spacings (GTK_TABLE (table4), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table4), 10);
-
-  spinbuttonSceneCut_adj = gtk_adjustment_new (40, 0, 100, 1, 10, 10);
-  spinbuttonSceneCut = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonSceneCut_adj), 1, 0);
-  gtk_widget_show (spinbuttonSceneCut);
-  gtk_table_attach (GTK_TABLE (table4), spinbuttonSceneCut, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_widget_set_size_request (spinbuttonSceneCut, 115, -1);
-  gtk_tooltips_set_tip (tooltips, spinbuttonSceneCut, _("Increase / decrease sensitivity for detecting scene changes. Improves I-frame usage and quality."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonSceneCut), TRUE);
-
-  label16 = gtk_label_new (_("Scene Cut Threshold"));
-  gtk_widget_show (label16);
-  gtk_table_attach (GTK_TABLE (table4), label16, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label16), 0, 0.5);
-
-  label17 = gtk_label_new (_("Min IDR Frame Interval"));
-  gtk_widget_show (label17);
-  gtk_table_attach (GTK_TABLE (table4), label17, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label17), 0, 0.5);
-
-  spinbuttonMinIdr_adj = gtk_adjustment_new (25, 0, 100, 1, 10, 10);
-  spinbuttonMinIdr = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMinIdr_adj), 1, 0);
-  gtk_widget_show (spinbuttonMinIdr);
-  gtk_table_attach (GTK_TABLE (table4), spinbuttonMinIdr, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMinIdr, _("Set minimum frame interval between IDR frames. Defines the minimum amount a frame can be reused and referenced by other frames before a new IDR frame is established."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMinIdr), TRUE);
-
-  spinbuttonMaxIdr_adj = gtk_adjustment_new (250, 1, 1000, 1, 10, 10);
-  spinbuttonMaxIdr = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxIdr_adj), 1, 0);
-  gtk_widget_show (spinbuttonMaxIdr);
-  gtk_table_attach (GTK_TABLE (table4), spinbuttonMaxIdr, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonMaxIdr, _("Set maximum frame interval between IDR frames. Defines the maximum amount a frame can be reused and referenced by other frames before a new IDR frame is established."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxIdr), TRUE);
-
-  label18 = gtk_label_new (_("Max IDR Frame Interval"));
-  gtk_widget_show (label18);
-  gtk_table_attach (GTK_TABLE (table4), label18, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label18), 0, 0.5);
-
-  labelMoreEncodingSettings = gtk_label_new (_("<b>More Rate Settings</b>"));
-  gtk_widget_show (labelMoreEncodingSettings);
-  gtk_frame_set_label_widget (GTK_FRAME (frame3), labelMoreEncodingSettings);
-  gtk_label_set_use_markup (GTK_LABEL (labelMoreEncodingSettings), TRUE);
-
-  frameVideoBufferVerifier = gtk_frame_new (NULL);
-  gtk_widget_show (frameVideoBufferVerifier);
-  gtk_box_pack_start (GTK_BOX (vbox1), frameVideoBufferVerifier, FALSE, TRUE, 0);
-
-  alignment11 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment11);
-  gtk_container_add (GTK_CONTAINER (frameVideoBufferVerifier), alignment11);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment11), 7, 7, 7, 7);
-
-  table12 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table12);
-  gtk_container_add (GTK_CONTAINER (alignment11), table12);
-  gtk_table_set_row_spacings (GTK_TABLE (table12), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table12), 10);
-
-  labelVBVBufferSize = gtk_label_new (_("VBV Buffer Size"));
-  gtk_widget_show (labelVBVBufferSize);
-  gtk_table_attach (GTK_TABLE (table12), labelVBVBufferSize, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelVBVBufferSize), 0, 0.5);
-
-  labelVBVInitialbuffer = gtk_label_new (_("Initial VBV Buffer (%)"));
-  gtk_widget_show (labelVBVInitialbuffer);
-  gtk_table_attach (GTK_TABLE (table12), labelVBVInitialbuffer, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelVBVInitialbuffer), 0, 0.5);
-
-  labelVBVMaximumBitrate = gtk_label_new (_("Maximum Local Bitrate"));
-  gtk_widget_show (labelVBVMaximumBitrate);
-  gtk_table_attach (GTK_TABLE (table12), labelVBVMaximumBitrate, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelVBVMaximumBitrate), 0, 0.5);
-
-  spinbuttonvbv_max_bitrate_adj = gtk_adjustment_new (0, 0, 99999, 1, 10, 10);
-  spinbuttonvbv_max_bitrate = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_max_bitrate_adj), 1, 0);
-  gtk_widget_show (spinbuttonvbv_max_bitrate);
-  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_max_bitrate, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_max_bitrate), TRUE);
-
-  spinbuttonvbv_buffer_size_adj = gtk_adjustment_new (0, 0, 99999, 1, 10, 10);
-  spinbuttonvbv_buffer_size = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_buffer_size_adj), 1, 0);
-  gtk_widget_show (spinbuttonvbv_buffer_size);
-  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_buffer_size, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_buffer_size), TRUE);
-
-  spinbuttonvbv_buffer_init_adj = gtk_adjustment_new (90, 0, 100, 1, 10, 10);
-  spinbuttonvbv_buffer_init = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_buffer_init_adj), 1, 0);
-  gtk_widget_show (spinbuttonvbv_buffer_init);
-  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_buffer_init, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_buffer_init), TRUE);
-
-  labelVideoBufferVerifier = gtk_label_new (_("<b>Video Buffer Verifier</b>"));
-  gtk_widget_show (labelVideoBufferVerifier);
-  gtk_frame_set_label_widget (GTK_FRAME (frameVideoBufferVerifier), labelVideoBufferVerifier);
-  gtk_label_set_use_markup (GTK_LABEL (labelVideoBufferVerifier), TRUE);
-
-  labelPageRateControl = gtk_label_new (_("Rate Control"));
-  gtk_widget_show (labelPageRateControl);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 3), labelPageRateControl);
-
-  alignment18 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment18);
-  gtk_container_add (GTK_CONTAINER (notebook1), alignment18);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment18), 7, 7, 7, 7);
-
-  vbox8 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox8);
-  gtk_container_add (GTK_CONTAINER (alignment18), vbox8);
-
-  frame10 = gtk_frame_new (NULL);
-  gtk_widget_show (frame10);
-  gtk_box_pack_start (GTK_BOX (vbox8), frame10, FALSE, TRUE, 0);
-
-  alignment10 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment10);
-  gtk_container_add (GTK_CONTAINER (frame10), alignment10);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment10), 7, 7, 7, 7);
-
-  table15 = gtk_table_new (4, 2, FALSE);
-  gtk_widget_show (table15);
-  gtk_container_add (GTK_CONTAINER (alignment10), table15);
-  gtk_table_set_row_spacings (GTK_TABLE (table15), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table15), 10);
-
-  labelBitrateVariance = gtk_label_new (_("Bitrate Variance"));
-  gtk_widget_show (labelBitrateVariance);
-  gtk_table_attach (GTK_TABLE (table15), labelBitrateVariance, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelBitrateVariance), 0, 0.5);
-
-  spinbuttonBitrateVariance_adj = gtk_adjustment_new (1, 0, 1, 0.10000000149, 10, 10);
-  spinbuttonBitrateVariance = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBitrateVariance_adj), 0.10000000149, 1);
-  gtk_widget_show (spinbuttonBitrateVariance);
-  gtk_table_attach (GTK_TABLE (table15), spinbuttonBitrateVariance, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonBitrateVariance, _("Allowed variance of average bitrate. Lower values mean less variance. Higher values mean more variance."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBitrateVariance), TRUE);
-
-  spinbuttonQuantizerCompression_adj = gtk_adjustment_new (0.600000023842, 0, 1, 0.10000000149, 10, 10);
-  spinbuttonQuantizerCompression = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuantizerCompression_adj), 0.10000000149, 1);
-  gtk_widget_show (spinbuttonQuantizerCompression);
-  gtk_table_attach (GTK_TABLE (table15), spinbuttonQuantizerCompression, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonQuantizerCompression, _("Allowed variance of average quantizer or quality. Lower values mean less variance. Higher values mean more variance. Note that 0 means constant quality while 1 means constant fluctuation. Recommended 0.6."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQuantizerCompression), TRUE);
-
-  spinbuttonTempBlurFrame_adj = gtk_adjustment_new (20, 0, 999, 1, 10, 10);
-  spinbuttonTempBlurFrame = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTempBlurFrame_adj), 1, 0);
-  gtk_widget_show (spinbuttonTempBlurFrame);
-  gtk_table_attach (GTK_TABLE (table15), spinbuttonTempBlurFrame, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTempBlurFrame, _("Reduced fluctuations in Quantizer (before curve compression)"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTempBlurFrame), TRUE);
-
-  spinbuttonTempBlurQuant_adj = gtk_adjustment_new (0.5, 0, 1, 0.5, 10, 10);
-  spinbuttonTempBlurQuant = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTempBlurQuant_adj), 0.5, 1);
-  gtk_widget_show (spinbuttonTempBlurQuant);
-  gtk_table_attach (GTK_TABLE (table15), spinbuttonTempBlurQuant, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTempBlurQuant), TRUE);
-
-  labelQuantizerCompression = gtk_label_new (_("Quantizer Compression"));
-  gtk_widget_show (labelQuantizerCompression);
-  gtk_table_attach (GTK_TABLE (table15), labelQuantizerCompression, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelQuantizerCompression), 0, 0.5);
-
-  labelTempBlurEstFrame = gtk_label_new (_("Temp. Blur of Est. Frame Complexity"));
-  gtk_widget_show (labelTempBlurEstFrame);
-  gtk_table_attach (GTK_TABLE (table15), labelTempBlurEstFrame, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelTempBlurEstFrame), 0, 0.5);
-
-  labelTempBlueQuant = gtk_label_new (_("Temp. Blur of Quant. after CC"));
-  gtk_widget_show (labelTempBlueQuant);
-  gtk_table_attach (GTK_TABLE (table15), labelTempBlueQuant, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelTempBlueQuant), 0, 0.5);
-
-  labelMisc = gtk_label_new (_("<b>Misc</b>"));
-  gtk_widget_show (labelMisc);
-  gtk_frame_set_label_widget (GTK_FRAME (frame10), labelMisc);
-  gtk_label_set_use_markup (GTK_LABEL (labelMisc), TRUE);
-
-  frame11 = gtk_frame_new (NULL);
-  gtk_widget_show (frame11);
-  gtk_box_pack_start (GTK_BOX (vbox8), frame11, FALSE, TRUE, 0);
-
-  alignment13 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment13);
-  gtk_container_add (GTK_CONTAINER (frame11), alignment13);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment13), 7, 7, 7, 7);
-
-  table16 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table16);
-  gtk_container_add (GTK_CONTAINER (alignment13), table16);
-  gtk_table_set_row_spacings (GTK_TABLE (table16), 3);
-  gtk_table_set_col_spacings (GTK_TABLE (table16), 10);
-
-  spinbutton8_adj = gtk_adjustment_new (1.39999997616, 1, 10, 0.10000000149, 10, 10);
-  spinbutton8 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton8_adj), 0.10000000149, 1);
-  gtk_widget_show (spinbutton8);
-  gtk_table_attach (GTK_TABLE (table16), spinbutton8, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbutton8, _("Quantization factors used between I and P-frames"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton8), TRUE);
-
-  spinbutton9_adj = gtk_adjustment_new (1.29999995232, 1, 10, 0.10000000149, 10, 10);
-  spinbutton9 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton9_adj), 0.10000000149, 1);
-  gtk_widget_show (spinbutton9);
-  gtk_table_attach (GTK_TABLE (table16), spinbutton9, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbutton9, _("Quantization used between P and B-frames"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton9), TRUE);
-
-  spinbuttonChromaQPOffset_adj = gtk_adjustment_new (0, -12, 12, 1, 10, 10);
-  spinbuttonChromaQPOffset = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonChromaQPOffset_adj), 1, 0);
-  gtk_widget_show (spinbuttonChromaQPOffset);
-  gtk_table_attach (GTK_TABLE (table16), spinbuttonChromaQPOffset, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonChromaQPOffset, _("Quantization difference between chroma (color) and luma (brightness)"), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonChromaQPOffset), TRUE);
-
-  labelFactorbetweenIandP = gtk_label_new (_("Factor between I and P-frame Quants"));
-  gtk_widget_show (labelFactorbetweenIandP);
-  gtk_table_attach (GTK_TABLE (table16), labelFactorbetweenIandP, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelFactorbetweenIandP), 0, 0.5);
-
-  labelFactorbetweenPandB = gtk_label_new (_("Factor between P and B-frame Quants"));
-  gtk_widget_show (labelFactorbetweenPandB);
-  gtk_table_attach (GTK_TABLE (table16), labelFactorbetweenPandB, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelFactorbetweenPandB), 0, 0.5);
-
-  labelChromaQPOffset = gtk_label_new (_("Chroma QP Offset"));
-  gtk_widget_show (labelChromaQPOffset);
-  gtk_table_attach (GTK_TABLE (table16), labelChromaQPOffset, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelChromaQPOffset), 0, 0.5);
-
-  labelQuantizers = gtk_label_new (_("<b>Quantizers</b>"));
-  gtk_widget_show (labelQuantizers);
-  gtk_frame_set_label_widget (GTK_FRAME (frame11), labelQuantizers);
-  gtk_label_set_use_markup (GTK_LABEL (labelQuantizers), TRUE);
-
-  frame9 = gtk_frame_new (NULL);
-  gtk_widget_show (frame9);
-  gtk_box_pack_start (GTK_BOX (vbox8), frame9, FALSE, TRUE, 0);
-
-  alignment9 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment9);
-  gtk_container_add (GTK_CONTAINER (frame9), alignment9);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment9), 7, 7, 7, 7);
-
-  vbox9 = gtk_vbox_new (FALSE, 3);
-  gtk_widget_show (vbox9);
-  gtk_container_add (GTK_CONTAINER (alignment9), vbox9);
-
-  radiobuttonFlatmatrix = gtk_radio_button_new_with_mnemonic (NULL, _("Flat Matrix"));
-  gtk_widget_show (radiobuttonFlatmatrix);
-  gtk_box_pack_start (GTK_BOX (vbox9), radiobuttonFlatmatrix, FALSE, FALSE, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonFlatmatrix), radiobuttonFlatmatrix_group);
-  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonFlatmatrix));
-  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (radiobuttonFlatmatrix), TRUE);
-
-  radiobuttonJVTmatrix = gtk_radio_button_new_with_mnemonic (NULL, _("JVT Matrix"));
-  gtk_widget_show (radiobuttonJVTmatrix);
-  gtk_box_pack_start (GTK_BOX (vbox9), radiobuttonJVTmatrix, FALSE, FALSE, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonJVTmatrix), radiobuttonFlatmatrix_group);
-  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonJVTmatrix));
-
-  hbox13 = gtk_hbox_new (FALSE, 10);
-  gtk_widget_show (hbox13);
-  gtk_box_pack_start (GTK_BOX (vbox9), hbox13, FALSE, FALSE, 0);
-
-  radiobuttonCustommatrix = gtk_radio_button_new_with_mnemonic (NULL, _("Custom Matrix"));
-  gtk_widget_show (radiobuttonCustommatrix);
-  gtk_box_pack_start (GTK_BOX (hbox13), radiobuttonCustommatrix, TRUE, TRUE, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonCustommatrix), radiobuttonFlatmatrix_group);
-  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonCustommatrix));
-
-  hbox14 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox14);
-  gtk_box_pack_start (GTK_BOX (hbox13), hbox14, TRUE, TRUE, 0);
-
-  filechooserbuttonOpenCQMFile = gtk_file_chooser_button_new (_("Open CQM file"), GTK_FILE_CHOOSER_ACTION_OPEN);
-  gtk_widget_show (filechooserbuttonOpenCQMFile);
-  gtk_box_pack_start (GTK_BOX (hbox14), filechooserbuttonOpenCQMFile, TRUE, TRUE, 0);
-
-  vseparator1 = gtk_vseparator_new ();
-  gtk_widget_show (vseparator1);
-  gtk_box_pack_start (GTK_BOX (hbox14), vseparator1, TRUE, TRUE, 0);
-
-  buttonEditCustomMatrix = gtk_button_new_with_mnemonic (_("Edit Custom Matrix"));
-  gtk_widget_show (buttonEditCustomMatrix);
-  gtk_box_pack_start (GTK_BOX (hbox14), buttonEditCustomMatrix, FALSE, FALSE, 0);
-  gtk_tooltips_set_tip (tooltips, buttonEditCustomMatrix, _("Edit loaded custom quantization matrix file"), NULL);
-
-  labelFrameQuantizationMatrices = gtk_label_new (_("<b>Quantization Matrices</b>"));
-  gtk_widget_show (labelFrameQuantizationMatrices);
-  gtk_frame_set_label_widget (GTK_FRAME (frame9), labelFrameQuantizationMatrices);
-  gtk_label_set_use_markup (GTK_LABEL (labelFrameQuantizationMatrices), TRUE);
-
-  labelMore = gtk_label_new (_("More"));
-  gtk_widget_show (labelMore);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 4), labelMore);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  buttonResetDaults = gtk_button_new_with_mnemonic (_("_Defaults"));
-  gtk_widget_show (buttonResetDaults);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), buttonResetDaults, 0);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, notebook1, "notebook1");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment14, "alignment14");
-  GLADE_HOOKUP_OBJECT (dialog1, tableBitrate, "tableBitrate");
-  GLADE_HOOKUP_OBJECT (dialog1, labelEncodingMode, "labelEncodingMode");
-  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizer, "labelQuantizer");
-  GLADE_HOOKUP_OBJECT (dialog1, labelTarget, "labelTarget");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQuantizer, "spinbuttonQuantizer");
-  GLADE_HOOKUP_OBJECT (dialog1, entryTarget, "entryTarget");
-  GLADE_HOOKUP_OBJECT (dialog1, comboboxMode, "comboboxMode");
-  GLADE_HOOKUP_OBJECT (dialog1, labelPageBitrate, "labelPageBitrate");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment15, "alignment15");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox5, "vbox5");
-  GLADE_HOOKUP_OBJECT (dialog1, frame6, "frame6");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment6, "alignment6");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox6, "vbox6");
-  GLADE_HOOKUP_OBJECT (dialog1, table7, "table7");
-  GLADE_HOOKUP_OBJECT (dialog1, labelPartitionDecision, "labelPartitionDecision");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMethod, "labelMethod");
-  GLADE_HOOKUP_OBJECT (dialog1, comboboxPartitionDecision, "comboboxPartitionDecision");
-  GLADE_HOOKUP_OBJECT (dialog1, comboboxMethod, "comboboxMethod");
-  GLADE_HOOKUP_OBJECT (dialog1, table11, "table11");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMaxRefFrames, "labelMaxRefFrames");
-  GLADE_HOOKUP_OBJECT (dialog1, labelRange, "labelRange");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRange, "spinbuttonRange");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxRefFrames, "spinbuttonMaxRefFrames");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonChromaME, "checkbuttonChromaME");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonMixedRefs, "checkbuttonMixedRefs");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox8, "hbox8");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonfastPSkip, "checkbuttonfastPSkip");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonDCTDecimate, "checkbuttonDCTDecimate");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttoninterlaced, "checkbuttoninterlaced");
-  GLADE_HOOKUP_OBJECT (dialog1, label24, "label24");
-  GLADE_HOOKUP_OBJECT (dialog1, frameSampleAR, "frameSampleAR");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment12, "alignment12");
-  GLADE_HOOKUP_OBJECT (dialog1, table35, "table35");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox12, "hbox12");
-  GLADE_HOOKUP_OBJECT (dialog1, entryAR_Num, "entryAR_Num");
-  GLADE_HOOKUP_OBJECT (dialog1, label53, "label53");
-  GLADE_HOOKUP_OBJECT (dialog1, entryAR_Den, "entryAR_Den");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonCustomAR, "radiobuttonCustomAR");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonPredefinedAR, "radiobuttonPredefinedAR");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonAsInputAR, "radiobuttonAsInputAR");
-  GLADE_HOOKUP_OBJECT (dialog1, label40, "label40");
-  GLADE_HOOKUP_OBJECT (dialog1, comboboxentry1, "comboboxentry1");
-  GLADE_HOOKUP_OBJECT (dialog1, label39, "label39");
-  GLADE_HOOKUP_OBJECT (dialog1, frame7, "frame7");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment7, "alignment7");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment21, "alignment21");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonCABAC, "checkbuttonCABAC");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox7, "hbox7");
-  GLADE_HOOKUP_OBJECT (dialog1, labelTrellis, "labelTrellis");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTrellis, "spinbuttonTrellis");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox11, "hbox11");
-  GLADE_HOOKUP_OBJECT (dialog1, labelNoiseReduction, "labelNoiseReduction");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonNoiseReduction, "spinbuttonNoiseReduction");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox3, "hbox3");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonDeblockingFilter, "checkbuttonDeblockingFilter");
-  GLADE_HOOKUP_OBJECT (dialog1, table8, "table8");
-  GLADE_HOOKUP_OBJECT (dialog1, labelThreshold, "labelThreshold");
-  GLADE_HOOKUP_OBJECT (dialog1, labelStrength, "labelStrength");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonThreshold, "spinbuttonThreshold");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonStrength, "spinbuttonStrength");
-  GLADE_HOOKUP_OBJECT (dialog1, label25, "label25");
-  GLADE_HOOKUP_OBJECT (dialog1, labelPageMotion_More, "labelPageMotion_More");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment16, "alignment16");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, frame4, "frame4");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment4, "alignment4");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8, "checkbutton8x8");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8P, "checkbutton8x8P");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8B, "checkbutton8x8B");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton4x4, "checkbutton4x4");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8I, "checkbutton8x8I");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton4x4I, "checkbutton4x4I");
-  GLADE_HOOKUP_OBJECT (dialog1, label19, "label19");
-  GLADE_HOOKUP_OBJECT (dialog1, frame5, "frame5");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment5, "alignment5");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox4, "vbox4");
-  GLADE_HOOKUP_OBJECT (dialog1, table5, "table5");
-  GLADE_HOOKUP_OBJECT (dialog1, labelBias, "labelBias");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMaxConsecutive, "labelMaxConsecutive");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBias, "spinbuttonBias");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxBFrame, "spinbuttonMaxBFrame");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment20, "alignment20");
-  GLADE_HOOKUP_OBJECT (dialog1, table6, "table6");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBidirME, "checkbuttonBidirME");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonWeighted, "checkbuttonWeighted");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonAdaptative, "checkbuttonAdaptative");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBasReference, "checkbuttonBasReference");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, labelBFrameDirectMode, "labelBFrameDirectMode");
-  GLADE_HOOKUP_OBJECT (dialog1, comboboxDirectMode, "comboboxDirectMode");
-  GLADE_HOOKUP_OBJECT (dialog1, label20, "label20");
-  GLADE_HOOKUP_OBJECT (dialog1, labelPagePartion_Frame, "labelPagePartion_Frame");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment17, "alignment17");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, frame1, "frame1");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment1, "alignment1");
-  GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonKeyframeBoost, "spinbuttonKeyframeBoost");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBframeReduction, "spinbuttonBframeReduction");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBitrateVariability, "spinbuttonBitrateVariability");
-  GLADE_HOOKUP_OBJECT (dialog1, labelKeyframeboost, "labelKeyframeboost");
-  GLADE_HOOKUP_OBJECT (dialog1, label11, "label11");
-  GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
-  GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
-  GLADE_HOOKUP_OBJECT (dialog1, frame2, "frame2");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment2, "alignment2");
-  GLADE_HOOKUP_OBJECT (dialog1, table3, "table3");
-  GLADE_HOOKUP_OBJECT (dialog1, label13, "label13");
-  GLADE_HOOKUP_OBJECT (dialog1, label14, "label14");
-  GLADE_HOOKUP_OBJECT (dialog1, label15, "label15");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMinQp, "spinbuttonMinQp");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxQp, "spinbuttonMaxQp");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQpStep, "spinbuttonQpStep");
-  GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
-  GLADE_HOOKUP_OBJECT (dialog1, frame3, "frame3");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment3, "alignment3");
-  GLADE_HOOKUP_OBJECT (dialog1, table4, "table4");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonSceneCut, "spinbuttonSceneCut");
-  GLADE_HOOKUP_OBJECT (dialog1, label16, "label16");
-  GLADE_HOOKUP_OBJECT (dialog1, label17, "label17");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMinIdr, "spinbuttonMinIdr");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxIdr, "spinbuttonMaxIdr");
-  GLADE_HOOKUP_OBJECT (dialog1, label18, "label18");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMoreEncodingSettings, "labelMoreEncodingSettings");
-  GLADE_HOOKUP_OBJECT (dialog1, frameVideoBufferVerifier, "frameVideoBufferVerifier");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment11, "alignment11");
-  GLADE_HOOKUP_OBJECT (dialog1, table12, "table12");
-  GLADE_HOOKUP_OBJECT (dialog1, labelVBVBufferSize, "labelVBVBufferSize");
-  GLADE_HOOKUP_OBJECT (dialog1, labelVBVInitialbuffer, "labelVBVInitialbuffer");
-  GLADE_HOOKUP_OBJECT (dialog1, labelVBVMaximumBitrate, "labelVBVMaximumBitrate");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_max_bitrate, "spinbuttonvbv_max_bitrate");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_buffer_size, "spinbuttonvbv_buffer_size");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_buffer_init, "spinbuttonvbv_buffer_init");
-  GLADE_HOOKUP_OBJECT (dialog1, labelVideoBufferVerifier, "labelVideoBufferVerifier");
-  GLADE_HOOKUP_OBJECT (dialog1, labelPageRateControl, "labelPageRateControl");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment18, "alignment18");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox8, "vbox8");
-  GLADE_HOOKUP_OBJECT (dialog1, frame10, "frame10");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment10, "alignment10");
-  GLADE_HOOKUP_OBJECT (dialog1, table15, "table15");
-  GLADE_HOOKUP_OBJECT (dialog1, labelBitrateVariance, "labelBitrateVariance");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBitrateVariance, "spinbuttonBitrateVariance");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQuantizerCompression, "spinbuttonQuantizerCompression");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTempBlurFrame, "spinbuttonTempBlurFrame");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTempBlurQuant, "spinbuttonTempBlurQuant");
-  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizerCompression, "labelQuantizerCompression");
-  GLADE_HOOKUP_OBJECT (dialog1, labelTempBlurEstFrame, "labelTempBlurEstFrame");
-  GLADE_HOOKUP_OBJECT (dialog1, labelTempBlueQuant, "labelTempBlueQuant");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMisc, "labelMisc");
-  GLADE_HOOKUP_OBJECT (dialog1, frame11, "frame11");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment13, "alignment13");
-  GLADE_HOOKUP_OBJECT (dialog1, table16, "table16");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbutton8, "spinbutton8");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbutton9, "spinbutton9");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonChromaQPOffset, "spinbuttonChromaQPOffset");
-  GLADE_HOOKUP_OBJECT (dialog1, labelFactorbetweenIandP, "labelFactorbetweenIandP");
-  GLADE_HOOKUP_OBJECT (dialog1, labelFactorbetweenPandB, "labelFactorbetweenPandB");
-  GLADE_HOOKUP_OBJECT (dialog1, labelChromaQPOffset, "labelChromaQPOffset");
-  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizers, "labelQuantizers");
-  GLADE_HOOKUP_OBJECT (dialog1, frame9, "frame9");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment9, "alignment9");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox9, "vbox9");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonFlatmatrix, "radiobuttonFlatmatrix");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonJVTmatrix, "radiobuttonJVTmatrix");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox13, "hbox13");
-  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonCustommatrix, "radiobuttonCustommatrix");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox14, "hbox14");
-  GLADE_HOOKUP_OBJECT (dialog1, filechooserbuttonOpenCQMFile, "filechooserbuttonOpenCQMFile");
-  GLADE_HOOKUP_OBJECT (dialog1, vseparator1, "vseparator1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonEditCustomMatrix, "buttonEditCustomMatrix");
-  GLADE_HOOKUP_OBJECT (dialog1, labelFrameQuantizationMatrices, "labelFrameQuantizationMatrices");
-  GLADE_HOOKUP_OBJECT (dialog1, labelMore, "labelMore");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonResetDaults, "buttonResetDaults");
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, tooltips, "tooltips");
-
-  gtk_widget_grab_default (okbutton1);
-  return dialog1;
-}
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *notebook1;
+  GtkWidget *alignment14;
+  GtkWidget *tableBitrate;
+  GtkWidget *labelEncodingMode;
+  GtkWidget *labelQuantizer;
+  GtkWidget *labelTarget;
+  GtkObject *spinbuttonQuantizer_adj;
+  GtkWidget *spinbuttonQuantizer;
+  GtkWidget *entryTarget;
+  GtkWidget *comboboxMode;
+  GtkWidget *labelPageBitrate;
+  GtkWidget *alignment15;
+  GtkWidget *vbox5;
+  GtkWidget *frame6;
+  GtkWidget *alignment6;
+  GtkWidget *vbox6;
+  GtkWidget *table7;
+  GtkWidget *labelPartitionDecision;
+  GtkWidget *labelMethod;
+  GtkWidget *comboboxPartitionDecision;
+  GtkWidget *comboboxMethod;
+  GtkWidget *table11;
+  GtkWidget *labelMaxRefFrames;
+  GtkWidget *labelRange;
+  GtkObject *spinbuttonRange_adj;
+  GtkWidget *spinbuttonRange;
+  GtkObject *spinbuttonMaxRefFrames_adj;
+  GtkWidget *spinbuttonMaxRefFrames;
+  GtkWidget *checkbuttonChromaME;
+  GtkWidget *checkbuttonMixedRefs;
+  GtkWidget *hbox8;
+  GtkWidget *checkbuttonfastPSkip;
+  GtkWidget *checkbuttonDCTDecimate;
+  GtkWidget *checkbuttoninterlaced;
+  GtkWidget *label24;
+  GtkWidget *frameSampleAR;
+  GtkWidget *alignment12;
+  GtkWidget *table35;
+  GtkWidget *hbox12;
+  GtkWidget *entryAR_Num;
+  GtkWidget *label53;
+  GtkWidget *entryAR_Den;
+  GtkWidget *radiobuttonCustomAR;
+  GSList *radiobuttonCustomAR_group = NULL;
+  GtkWidget *radiobuttonPredefinedAR;
+  GtkWidget *radiobuttonAsInputAR;
+  GtkWidget *label40;
+  GtkWidget *comboboxentry1;
+  GtkWidget *label39;
+  GtkWidget *frame7;
+  GtkWidget *alignment7;
+  GtkWidget *vbox7;
+  GtkWidget *alignment21;
+  GtkWidget *hbox2;
+  GtkWidget *checkbuttonCABAC;
+  GtkWidget *hbox7;
+  GtkWidget *labelTrellis;
+  GtkObject *spinbuttonTrellis_adj;
+  GtkWidget *spinbuttonTrellis;
+  GtkWidget *hbox11;
+  GtkWidget *labelNoiseReduction;
+  GtkObject *spinbuttonNoiseReduction_adj;
+  GtkWidget *spinbuttonNoiseReduction;
+  GtkWidget *hbox3;
+  GtkWidget *checkbuttonDeblockingFilter;
+  GtkWidget *table8;
+  GtkWidget *labelThreshold;
+  GtkWidget *labelStrength;
+  GtkObject *spinbuttonThreshold_adj;
+  GtkWidget *spinbuttonThreshold;
+  GtkObject *spinbuttonStrength_adj;
+  GtkWidget *spinbuttonStrength;
+  GtkWidget *label25;
+  GtkWidget *labelPageMotion_More;
+  GtkWidget *alignment16;
+  GtkWidget *vbox2;
+  GtkWidget *frame4;
+  GtkWidget *alignment4;
+  GtkWidget *vbox3;
+  GtkWidget *checkbutton8x8;
+  GtkWidget *checkbutton8x8P;
+  GtkWidget *checkbutton8x8B;
+  GtkWidget *checkbutton4x4;
+  GtkWidget *checkbutton8x8I;
+  GtkWidget *checkbutton4x4I;
+  GtkWidget *label19;
+  GtkWidget *frame5;
+  GtkWidget *alignment5;
+  GtkWidget *vbox4;
+  GtkWidget *table5;
+  GtkWidget *labelBias;
+  GtkWidget *labelMaxConsecutive;
+  GtkObject *spinbuttonBias_adj;
+  GtkWidget *spinbuttonBias;
+  GtkObject *spinbuttonMaxBFrame_adj;
+  GtkWidget *spinbuttonMaxBFrame;
+  GtkWidget *alignment20;
+  GtkWidget *table6;
+  GtkWidget *checkbuttonBidirME;
+  GtkWidget *checkbuttonWeighted;
+  GtkWidget *checkbuttonAdaptative;
+  GtkWidget *checkbuttonBasReference;
+  GtkWidget *hbox1;
+  GtkWidget *labelBFrameDirectMode;
+  GtkWidget *comboboxDirectMode;
+  GtkWidget *label20;
+  GtkWidget *labelPagePartion_Frame;
+  GtkWidget *alignment17;
+  GtkWidget *vbox1;
+  GtkWidget *frame1;
+  GtkWidget *alignment1;
+  GtkWidget *table2;
+  GtkObject *spinbuttonKeyframeBoost_adj;
+  GtkWidget *spinbuttonKeyframeBoost;
+  GtkObject *spinbuttonBframeReduction_adj;
+  GtkWidget *spinbuttonBframeReduction;
+  GtkObject *spinbuttonBitrateVariability_adj;
+  GtkWidget *spinbuttonBitrateVariability;
+  GtkWidget *labelKeyframeboost;
+  GtkWidget *label11;
+  GtkWidget *label12;
+  GtkWidget *label7;
+  GtkWidget *frame2;
+  GtkWidget *alignment2;
+  GtkWidget *table3;
+  GtkWidget *label13;
+  GtkWidget *label14;
+  GtkWidget *label15;
+  GtkObject *spinbuttonMinQp_adj;
+  GtkWidget *spinbuttonMinQp;
+  GtkObject *spinbuttonMaxQp_adj;
+  GtkWidget *spinbuttonMaxQp;
+  GtkObject *spinbuttonQpStep_adj;
+  GtkWidget *spinbuttonQpStep;
+  GtkWidget *label8;
+  GtkWidget *frame3;
+  GtkWidget *alignment3;
+  GtkWidget *table4;
+  GtkObject *spinbuttonSceneCut_adj;
+  GtkWidget *spinbuttonSceneCut;
+  GtkWidget *label16;
+  GtkWidget *label17;
+  GtkObject *spinbuttonMinIdr_adj;
+  GtkWidget *spinbuttonMinIdr;
+  GtkObject *spinbuttonMaxIdr_adj;
+  GtkWidget *spinbuttonMaxIdr;
+  GtkWidget *label18;
+  GtkWidget *labelMoreEncodingSettings;
+  GtkWidget *frameVideoBufferVerifier;
+  GtkWidget *alignment11;
+  GtkWidget *table12;
+  GtkWidget *labelVBVBufferSize;
+  GtkWidget *labelVBVInitialbuffer;
+  GtkWidget *labelVBVMaximumBitrate;
+  GtkObject *spinbuttonvbv_max_bitrate_adj;
+  GtkWidget *spinbuttonvbv_max_bitrate;
+  GtkObject *spinbuttonvbv_buffer_size_adj;
+  GtkWidget *spinbuttonvbv_buffer_size;
+  GtkObject *spinbuttonvbv_buffer_init_adj;
+  GtkWidget *spinbuttonvbv_buffer_init;
+  GtkWidget *labelVideoBufferVerifier;
+  GtkWidget *labelPageRateControl;
+  GtkWidget *alignment18;
+  GtkWidget *vbox8;
+  GtkWidget *frame10;
+  GtkWidget *alignment10;
+  GtkWidget *table15;
+  GtkWidget *labelBitrateVariance;
+  GtkObject *spinbuttonBitrateVariance_adj;
+  GtkWidget *spinbuttonBitrateVariance;
+  GtkObject *spinbuttonQuantizerCompression_adj;
+  GtkWidget *spinbuttonQuantizerCompression;
+  GtkObject *spinbuttonTempBlurFrame_adj;
+  GtkWidget *spinbuttonTempBlurFrame;
+  GtkObject *spinbuttonTempBlurQuant_adj;
+  GtkWidget *spinbuttonTempBlurQuant;
+  GtkWidget *labelQuantizerCompression;
+  GtkWidget *labelTempBlurEstFrame;
+  GtkWidget *labelTempBlueQuant;
+  GtkWidget *labelMisc;
+  GtkWidget *frame11;
+  GtkWidget *alignment13;
+  GtkWidget *table16;
+  GtkObject *spinbutton8_adj;
+  GtkWidget *spinbutton8;
+  GtkObject *spinbutton9_adj;
+  GtkWidget *spinbutton9;
+  GtkObject *spinbuttonChromaQPOffset_adj;
+  GtkWidget *spinbuttonChromaQPOffset;
+  GtkWidget *labelFactorbetweenIandP;
+  GtkWidget *labelFactorbetweenPandB;
+  GtkWidget *labelChromaQPOffset;
+  GtkWidget *labelQuantizers;
+  GtkWidget *frame9;
+  GtkWidget *alignment9;
+  GtkWidget *vbox9;
+  GtkWidget *radiobuttonFlatmatrix;
+  GSList *radiobuttonFlatmatrix_group = NULL;
+  GtkWidget *radiobuttonJVTmatrix;
+  GtkWidget *hbox13;
+  GtkWidget *radiobuttonCustommatrix;
+  GtkWidget *hbox14;
+  GtkWidget *filechooserbuttonOpenCQMFile;
+  GtkWidget *vseparator1;
+  GtkWidget *buttonEditCustomMatrix;
+  GtkWidget *labelFrameQuantizationMatrices;
+  GtkWidget *labelMore;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *buttonResetDaults;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+  GtkTooltips *tooltips;
+
+  tooltips = gtk_tooltips_new ();
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("x264 Configuration"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  notebook1 = gtk_notebook_new ();
+  gtk_widget_show (notebook1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), notebook1, TRUE, TRUE, 0);
+
+  alignment14 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment14);
+  gtk_container_add (GTK_CONTAINER (notebook1), alignment14);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment14), 7, 7, 7, 7);
+
+  tableBitrate = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (tableBitrate);
+  gtk_container_add (GTK_CONTAINER (alignment14), tableBitrate);
+  gtk_table_set_row_spacings (GTK_TABLE (tableBitrate), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (tableBitrate), 10);
+
+  labelEncodingMode = gtk_label_new (_("Encoding Mode"));
+  gtk_widget_show (labelEncodingMode);
+  gtk_table_attach (GTK_TABLE (tableBitrate), labelEncodingMode, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelEncodingMode), 0, 0.5);
+
+  labelQuantizer = gtk_label_new (_("Quantizer"));
+  gtk_widget_show (labelQuantizer);
+  gtk_table_attach (GTK_TABLE (tableBitrate), labelQuantizer, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelQuantizer), 0, 0.5);
+
+  labelTarget = gtk_label_new (_("Target Size"));
+  gtk_widget_show (labelTarget);
+  gtk_table_attach (GTK_TABLE (tableBitrate), labelTarget, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTarget), 0, 0.5);
+
+  spinbuttonQuantizer_adj = gtk_adjustment_new (4, 0, 51, 1, 10, 10);
+  spinbuttonQuantizer = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuantizer_adj), 1, 0);
+  gtk_widget_show (spinbuttonQuantizer);
+  gtk_table_attach (GTK_TABLE (tableBitrate), spinbuttonQuantizer, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonQuantizer, _("Constant Quantizer - Each frame will have the same compression. Low numbers equal higher quality while high numbers equal lower quality."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQuantizer), TRUE);
+
+  entryTarget = gtk_entry_new ();
+  gtk_widget_show (entryTarget);
+  gtk_table_attach (GTK_TABLE (tableBitrate), entryTarget, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, entryTarget, _("Target bitrate or file size"), NULL);
+  gtk_entry_set_width_chars (GTK_ENTRY (entryTarget), 4);
+
+  comboboxMode = gtk_combo_box_new_text ();
+  gtk_widget_show (comboboxMode);
+  gtk_table_attach (GTK_TABLE (tableBitrate), comboboxMode, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Quality Quantizer (Average)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Quality Quantizer (Constant)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Single Pass - Bitrate (Average)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Two Pass - Video Size"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMode), _("Two Pass - Average Bitrate"));
+
+  labelPageBitrate = gtk_label_new (_("Bitrate"));
+  gtk_widget_show (labelPageBitrate);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 0), labelPageBitrate);
+  gtk_misc_set_alignment (GTK_MISC (labelPageBitrate), 0, 0.5);
+
+  alignment15 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment15);
+  gtk_container_add (GTK_CONTAINER (notebook1), alignment15);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment15), 7, 7, 7, 7);
+
+  vbox5 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox5);
+  gtk_container_add (GTK_CONTAINER (alignment15), vbox5);
+
+  frame6 = gtk_frame_new (NULL);
+  gtk_widget_show (frame6);
+  gtk_box_pack_start (GTK_BOX (vbox5), frame6, FALSE, TRUE, 0);
+
+  alignment6 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment6);
+  gtk_container_add (GTK_CONTAINER (frame6), alignment6);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment6), 7, 4, 7, 7);
+
+  vbox6 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox6);
+  gtk_container_add (GTK_CONTAINER (alignment6), vbox6);
+
+  table7 = gtk_table_new (2, 3, FALSE);
+  gtk_widget_show (table7);
+  gtk_box_pack_start (GTK_BOX (vbox6), table7, FALSE, TRUE, 0);
+  gtk_table_set_row_spacings (GTK_TABLE (table7), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table7), 10);
+
+  labelPartitionDecision = gtk_label_new (_("Partition Decision"));
+  gtk_widget_show (labelPartitionDecision);
+  gtk_table_attach (GTK_TABLE (table7), labelPartitionDecision, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelPartitionDecision), 0, 0.5);
+
+  labelMethod = gtk_label_new (_("Method"));
+  gtk_widget_show (labelMethod);
+  gtk_table_attach (GTK_TABLE (table7), labelMethod, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelMethod), 0, 0.5);
+
+  comboboxPartitionDecision = gtk_combo_box_new_text ();
+  gtk_widget_show (comboboxPartitionDecision);
+  gtk_table_attach (GTK_TABLE (table7), comboboxPartitionDecision, 1, 3, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("1  - Extremely Low (Fastest)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("2  - Very Low"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("3  - Low"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("4  - Medium"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("5  - High (Default)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6  - Very High"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6B - Very High (RDO on B-frames)"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7  - Ultra High"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7B - Ultra High (RDO on B-frames)"));
+
+  comboboxMethod = gtk_combo_box_new_text ();
+  gtk_widget_show (comboboxMethod);
+  gtk_table_attach (GTK_TABLE (table7), comboboxMethod, 1, 3, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Diamond Search"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Hexagonal Search"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Uneven Multi-hexagon"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxMethod), _("Exhaustive Search"));
+
+  table11 = gtk_table_new (2, 3, FALSE);
+  gtk_widget_show (table11);
+  gtk_box_pack_start (GTK_BOX (vbox6), table11, TRUE, FALSE, 0);
+  gtk_table_set_row_spacings (GTK_TABLE (table11), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table11), 10);
+
+  labelMaxRefFrames = gtk_label_new (_("Max. Ref. Frames"));
+  gtk_widget_show (labelMaxRefFrames);
+  gtk_table_attach (GTK_TABLE (table11), labelMaxRefFrames, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelMaxRefFrames), 0, 0.5);
+
+  labelRange = gtk_label_new (_("Range"));
+  gtk_widget_show (labelRange);
+  gtk_table_attach (GTK_TABLE (table11), labelRange, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelRange), 0, 0.5);
+
+  spinbuttonRange_adj = gtk_adjustment_new (17, 0, 64, 1, 10, 10);
+  spinbuttonRange = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRange_adj), 1, 0);
+  gtk_widget_show (spinbuttonRange);
+  gtk_table_attach (GTK_TABLE (table11), spinbuttonRange, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonRange, _("Define how many pixels are analysed for motion estimation. The higher the range the more accurate the analysis but the slower the encoding time."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRange), TRUE);
+
+  spinbuttonMaxRefFrames_adj = gtk_adjustment_new (1, 1, 16, 1, 10, 10);
+  spinbuttonMaxRefFrames = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxRefFrames_adj), 1, 0);
+  gtk_widget_show (spinbuttonMaxRefFrames);
+  gtk_table_attach (GTK_TABLE (table11), spinbuttonMaxRefFrames, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMaxRefFrames, _("Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers 3 to 5 are recommended."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxRefFrames), TRUE);
+
+  checkbuttonChromaME = gtk_check_button_new_with_mnemonic (_("Chroma ME"));
+  gtk_widget_show (checkbuttonChromaME);
+  gtk_table_attach (GTK_TABLE (table11), checkbuttonChromaME, 2, 3, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 30, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonChromaME, _("Use color information for detecting motion to improve quality"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonChromaME), TRUE);
+
+  checkbuttonMixedRefs = gtk_check_button_new_with_mnemonic (_("Mixed Refs"));
+  gtk_widget_show (checkbuttonMixedRefs);
+  gtk_table_attach (GTK_TABLE (table11), checkbuttonMixedRefs, 2, 3, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 30, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonMixedRefs, _("Calculate referencing individually based on each partition"), NULL);
+
+  hbox8 = gtk_hbox_new (TRUE, 0);
+  gtk_widget_show (hbox8);
+  gtk_box_pack_start (GTK_BOX (vbox6), hbox8, TRUE, TRUE, 0);
+
+  checkbuttonfastPSkip = gtk_check_button_new_with_mnemonic (_("Fast P-Skip"));
+  gtk_widget_show (checkbuttonfastPSkip);
+  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttonfastPSkip, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonfastPSkip, _("Early skip detection on P-frames to speedup encoding. Quality will be slightly reduced."), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonfastPSkip), TRUE);
+
+  checkbuttonDCTDecimate = gtk_check_button_new_with_mnemonic (_("DCT Decimate"));
+  gtk_widget_show (checkbuttonDCTDecimate);
+  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttonDCTDecimate, FALSE, FALSE, 0);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonDCTDecimate), TRUE);
+
+  checkbuttoninterlaced = gtk_check_button_new_with_mnemonic (_("Interlaced"));
+  gtk_widget_show (checkbuttoninterlaced);
+  gtk_box_pack_start (GTK_BOX (hbox8), checkbuttoninterlaced, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttoninterlaced, _("Input video is interlaced"), NULL);
+
+  label24 = gtk_label_new (_("<b>Motion Estimation</b>"));
+  gtk_widget_show (label24);
+  gtk_frame_set_label_widget (GTK_FRAME (frame6), label24);
+  gtk_label_set_use_markup (GTK_LABEL (label24), TRUE);
+
+  frameSampleAR = gtk_frame_new (NULL);
+  gtk_widget_show (frameSampleAR);
+  gtk_box_pack_start (GTK_BOX (vbox5), frameSampleAR, FALSE, TRUE, 0);
+
+  alignment12 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment12);
+  gtk_container_add (GTK_CONTAINER (frameSampleAR), alignment12);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment12), 7, 7, 7, 7);
+
+  table35 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table35);
+  gtk_container_add (GTK_CONTAINER (alignment12), table35);
+  gtk_table_set_row_spacings (GTK_TABLE (table35), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table35), 10);
+
+  hbox12 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox12);
+  gtk_table_attach (GTK_TABLE (table35), hbox12, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  entryAR_Num = gtk_entry_new ();
+  gtk_widget_show (entryAR_Num);
+  gtk_box_pack_start (GTK_BOX (hbox12), entryAR_Num, TRUE, TRUE, 0);
+  gtk_tooltips_set_tip (tooltips, entryAR_Num, _("Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."), NULL);
+  gtk_entry_set_text (GTK_ENTRY (entryAR_Num), _("1"));
+  gtk_entry_set_width_chars (GTK_ENTRY (entryAR_Num), 4);
+
+  label53 = gtk_label_new (_(":"));
+  gtk_widget_show (label53);
+  gtk_box_pack_start (GTK_BOX (hbox12), label53, FALSE, FALSE, 3);
+
+  entryAR_Den = gtk_entry_new ();
+  gtk_widget_show (entryAR_Den);
+  gtk_box_pack_start (GTK_BOX (hbox12), entryAR_Den, TRUE, TRUE, 0);
+  gtk_tooltips_set_tip (tooltips, entryAR_Den, _("Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."), NULL);
+  gtk_entry_set_text (GTK_ENTRY (entryAR_Den), _("1"));
+  gtk_entry_set_width_chars (GTK_ENTRY (entryAR_Den), 4);
+
+  radiobuttonCustomAR = gtk_radio_button_new_with_mnemonic (NULL, _("Custom"));
+  gtk_widget_show (radiobuttonCustomAR);
+  gtk_table_attach (GTK_TABLE (table35), radiobuttonCustomAR, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, radiobuttonCustomAR, _("Set a custom aspect ratio. The default 1:1 is recommended for most video."), NULL);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonCustomAR), radiobuttonCustomAR_group);
+  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonCustomAR));
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (radiobuttonCustomAR), TRUE);
+
+  radiobuttonPredefinedAR = gtk_radio_button_new_with_mnemonic (NULL, _("Predefined Aspect Ratio"));
+  gtk_widget_show (radiobuttonPredefinedAR);
+  gtk_table_attach (GTK_TABLE (table35), radiobuttonPredefinedAR, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, radiobuttonPredefinedAR, _("Set a common predefined aspect ratio"), NULL);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonPredefinedAR), radiobuttonCustomAR_group);
+  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonPredefinedAR));
+
+  radiobuttonAsInputAR = gtk_radio_button_new_with_mnemonic (NULL, _("As Input"));
+  gtk_widget_show (radiobuttonAsInputAR);
+  gtk_table_attach (GTK_TABLE (table35), radiobuttonAsInputAR, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonAsInputAR), radiobuttonCustomAR_group);
+  radiobuttonCustomAR_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonAsInputAR));
+
+  label40 = gtk_label_new ("1:1 (1:1)");
+  gtk_widget_show (label40);
+  gtk_table_attach (GTK_TABLE (table35), label40, 1, 2, 2, 3,
+                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label40), 0, 0.5);
+
+  comboboxentry1 = gtk_combo_box_new_text ();
+  gtk_widget_show (comboboxentry1);
+  gtk_table_attach (GTK_TABLE (table35), comboboxentry1, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  label39 = gtk_label_new (_("<b>Sample Aspect Ratio</b>"));
+  gtk_widget_show (label39);
+  gtk_frame_set_label_widget (GTK_FRAME (frameSampleAR), label39);
+  gtk_label_set_use_markup (GTK_LABEL (label39), TRUE);
+
+  frame7 = gtk_frame_new (NULL);
+  gtk_widget_show (frame7);
+  gtk_box_pack_start (GTK_BOX (vbox5), frame7, FALSE, TRUE, 0);
+
+  alignment7 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment7);
+  gtk_container_add (GTK_CONTAINER (frame7), alignment7);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment7), 7, 7, 7, 7);
+
+  vbox7 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox7);
+  gtk_container_add (GTK_CONTAINER (alignment7), vbox7);
+
+  alignment21 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment21);
+  gtk_box_pack_start (GTK_BOX (vbox7), alignment21, TRUE, TRUE, 0);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment21), 0, 3, 0, 0);
+
+  hbox2 = gtk_hbox_new (FALSE, 17);
+  gtk_widget_show (hbox2);
+  gtk_container_add (GTK_CONTAINER (alignment21), hbox2);
+
+  checkbuttonCABAC = gtk_check_button_new_with_mnemonic (_("CABAC"));
+  gtk_widget_show (checkbuttonCABAC);
+  gtk_box_pack_start (GTK_BOX (hbox2), checkbuttonCABAC, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonCABAC, _("Lossless compression technique that reduces bitrate by approximately 10%. Increases encoding and decoding time."), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonCABAC), TRUE);
+
+  hbox7 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox7);
+  gtk_box_pack_start (GTK_BOX (hbox2), hbox7, FALSE, FALSE, 0);
+
+  labelTrellis = gtk_label_new (_("Trellis"));
+  gtk_widget_show (labelTrellis);
+  gtk_box_pack_start (GTK_BOX (hbox7), labelTrellis, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTrellis), 0, 0.5);
+
+  spinbuttonTrellis_adj = gtk_adjustment_new (0, 0, 2, 1, 10, 10);
+  spinbuttonTrellis = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTrellis_adj), 1, 0);
+  gtk_widget_show (spinbuttonTrellis);
+  gtk_box_pack_start (GTK_BOX (hbox7), spinbuttonTrellis, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonTrellis, _("Use Trellis Rate Distortion Optimisation to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTrellis), TRUE);
+
+  hbox11 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox11);
+  gtk_box_pack_start (GTK_BOX (hbox2), hbox11, FALSE, FALSE, 2);
+
+  labelNoiseReduction = gtk_label_new (_("Noise Reduction"));
+  gtk_widget_show (labelNoiseReduction);
+  gtk_box_pack_start (GTK_BOX (hbox11), labelNoiseReduction, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelNoiseReduction), 0, 0.5);
+
+  spinbuttonNoiseReduction_adj = gtk_adjustment_new (0, 0, 1000000000, 1, 10, 10);
+  spinbuttonNoiseReduction = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonNoiseReduction_adj), 1, 0);
+  gtk_widget_show (spinbuttonNoiseReduction);
+  gtk_box_pack_start (GTK_BOX (hbox11), spinbuttonNoiseReduction, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonNoiseReduction, _("Set the amount of noise reduction"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonNoiseReduction), TRUE);
+
+  hbox3 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox3);
+  gtk_box_pack_start (GTK_BOX (vbox7), hbox3, TRUE, TRUE, 0);
+
+  checkbuttonDeblockingFilter = gtk_check_button_new_with_mnemonic (_("Deblocking Filter"));
+  gtk_widget_show (checkbuttonDeblockingFilter);
+  gtk_box_pack_start (GTK_BOX (hbox3), checkbuttonDeblockingFilter, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonDeblockingFilter, _("Enable in-loop deblocking to filter the video"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonDeblockingFilter), TRUE);
+
+  table8 = gtk_table_new (2, 2, FALSE);
+  gtk_widget_show (table8);
+  gtk_box_pack_start (GTK_BOX (hbox3), table8, TRUE, TRUE, 0);
+  gtk_table_set_row_spacings (GTK_TABLE (table8), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table8), 10);
+
+  labelThreshold = gtk_label_new (_("Threshold"));
+  gtk_widget_show (labelThreshold);
+  gtk_table_attach (GTK_TABLE (table8), labelThreshold, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_use_markup (GTK_LABEL (labelThreshold), TRUE);
+  gtk_misc_set_alignment (GTK_MISC (labelThreshold), 0, 0.5);
+
+  labelStrength = gtk_label_new (_("Strength"));
+  gtk_widget_show (labelStrength);
+  gtk_table_attach (GTK_TABLE (table8), labelStrength, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_use_markup (GTK_LABEL (labelStrength), TRUE);
+  gtk_misc_set_alignment (GTK_MISC (labelStrength), 0, 0.5);
+
+  spinbuttonThreshold_adj = gtk_adjustment_new (0, -6, 6, 1, 10, 10);
+  spinbuttonThreshold = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonThreshold_adj), 1, 0);
+  gtk_widget_show (spinbuttonThreshold);
+  gtk_table_attach (GTK_TABLE (table8), spinbuttonThreshold, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonThreshold, _("Threshold for block detection. Positive values will detect more blocks, negative values will detect less."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonThreshold), TRUE);
+
+  spinbuttonStrength_adj = gtk_adjustment_new (0, -6, 6, 1, 10, 10);
+  spinbuttonStrength = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonStrength_adj), 1, 0);
+  gtk_widget_show (spinbuttonStrength);
+  gtk_table_attach (GTK_TABLE (table8), spinbuttonStrength, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonStrength, _("Positive values will soften the video, negative values will sharpen"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonStrength), TRUE);
+
+  label25 = gtk_label_new (_("<b>Misc. Options</b>"));
+  gtk_widget_show (label25);
+  gtk_frame_set_label_widget (GTK_FRAME (frame7), label25);
+  gtk_label_set_use_markup (GTK_LABEL (label25), TRUE);
+
+  labelPageMotion_More = gtk_label_new (_("Motion & Misc"));
+  gtk_widget_show (labelPageMotion_More);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 1), labelPageMotion_More);
+
+  alignment16 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment16);
+  gtk_container_add (GTK_CONTAINER (notebook1), alignment16);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment16), 7, 7, 7, 7);
+
+  vbox2 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox2);
+  gtk_container_add (GTK_CONTAINER (alignment16), vbox2);
+
+  frame4 = gtk_frame_new (NULL);
+  gtk_widget_show (frame4);
+  gtk_box_pack_start (GTK_BOX (vbox2), frame4, FALSE, TRUE, 0);
+
+  alignment4 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment4);
+  gtk_container_add (GTK_CONTAINER (frame4), alignment4);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment4), 7, 7, 7, 7);
+
+  vbox3 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox3);
+  gtk_container_add (GTK_CONTAINER (alignment4), vbox3);
+
+  checkbutton8x8 = gtk_check_button_new_with_mnemonic (_("8x8 Transform"));
+  gtk_widget_show (checkbutton8x8);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton8x8, _("General block breakdown transformation"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8), TRUE);
+
+  checkbutton8x8P = gtk_check_button_new_with_mnemonic (_("8x8, 8x16 and 16x8 P-frame search"));
+  gtk_widget_show (checkbutton8x8P);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8P, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton8x8P, _("Improve the P-frame quality"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8P), TRUE);
+
+  checkbutton8x8B = gtk_check_button_new_with_mnemonic (_("8x8, 8x16 and 16x8 B-frame search"));
+  gtk_widget_show (checkbutton8x8B);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8B, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton8x8B, _("Improve the B-frame quality"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8B), TRUE);
+
+  checkbutton4x4 = gtk_check_button_new_with_mnemonic (_("4x4, 4x8 and 8x4 P-frame search"));
+  gtk_widget_show (checkbutton4x4);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton4x4, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton4x4, _("Further improve the P-frame quality"), NULL);
+
+  checkbutton8x8I = gtk_check_button_new_with_mnemonic (_("8x8 Intra search"));
+  gtk_widget_show (checkbutton8x8I);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton8x8I, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton8x8I, _("Enable DCT Intra block search to improve quality"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton8x8I), TRUE);
+
+  checkbutton4x4I = gtk_check_button_new_with_mnemonic (_("4x4 Intra search"));
+  gtk_widget_show (checkbutton4x4I);
+  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton4x4I, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, checkbutton4x4I, _("Further enable DCT Intra block search to improve quality"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton4x4I), TRUE);
+
+  label19 = gtk_label_new (_("<b>Partition Macroblocks</b>"));
+  gtk_widget_show (label19);
+  gtk_frame_set_label_widget (GTK_FRAME (frame4), label19);
+  gtk_label_set_use_markup (GTK_LABEL (label19), TRUE);
+
+  frame5 = gtk_frame_new (NULL);
+  gtk_widget_show (frame5);
+  gtk_box_pack_start (GTK_BOX (vbox2), frame5, FALSE, TRUE, 0);
+
+  alignment5 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment5);
+  gtk_container_add (GTK_CONTAINER (frame5), alignment5);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment5), 7, 7, 7, 7);
+
+  vbox4 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox4);
+  gtk_container_add (GTK_CONTAINER (alignment5), vbox4);
+
+  table5 = gtk_table_new (2, 2, FALSE);
+  gtk_widget_show (table5);
+  gtk_box_pack_start (GTK_BOX (vbox4), table5, TRUE, TRUE, 0);
+  gtk_table_set_row_spacings (GTK_TABLE (table5), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table5), 10);
+
+  labelBias = gtk_label_new (_("Bias"));
+  gtk_widget_show (labelBias);
+  gtk_table_attach (GTK_TABLE (table5), labelBias, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelBias), 0, 0.5);
+
+  labelMaxConsecutive = gtk_label_new (_("Max Consecutive"));
+  gtk_widget_show (labelMaxConsecutive);
+  gtk_table_attach (GTK_TABLE (table5), labelMaxConsecutive, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelMaxConsecutive), 0, 0.5);
+
+  spinbuttonBias_adj = gtk_adjustment_new (0, -100, 100, 1, 10, 10);
+  spinbuttonBias = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBias_adj), 1, 0);
+  gtk_widget_show (spinbuttonBias);
+  gtk_table_attach (GTK_TABLE (table5), spinbuttonBias, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBias, _("Increase / decrease probability for how often B-frames are used. It will not violate the maximum consecutive frame limit."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBias), TRUE);
+
+  spinbuttonMaxBFrame_adj = gtk_adjustment_new (3, 0, 16, 1, 10, 10);
+  spinbuttonMaxBFrame = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxBFrame_adj), 1, 0);
+  gtk_widget_show (spinbuttonMaxBFrame);
+  gtk_table_attach (GTK_TABLE (table5), spinbuttonMaxBFrame, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMaxBFrame, _("Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be dropped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxBFrame), TRUE);
+
+  alignment20 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment20);
+  gtk_box_pack_start (GTK_BOX (vbox4), alignment20, TRUE, TRUE, 0);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment20), 3, 3, 0, 0);
+
+  table6 = gtk_table_new (2, 2, FALSE);
+  gtk_widget_show (table6);
+  gtk_container_add (GTK_CONTAINER (alignment20), table6);
+  gtk_table_set_row_spacings (GTK_TABLE (table6), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table6), 10);
+
+  checkbuttonBidirME = gtk_check_button_new_with_mnemonic (_("Bidirectional ME"));
+  gtk_widget_show (checkbuttonBidirME);
+  gtk_table_attach (GTK_TABLE (table6), checkbuttonBidirME, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonBidirME, _("Optimise both motion vectors in B-frames. This will improve quality but take more time for encoding."), NULL);
+
+  checkbuttonWeighted = gtk_check_button_new_with_mnemonic (_("Weighted Biprediction"));
+  gtk_widget_show (checkbuttonWeighted);
+  gtk_table_attach (GTK_TABLE (table6), checkbuttonWeighted, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonWeighted, _("Enables weighting of B-frames to help fades"), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonWeighted), TRUE);
+
+  checkbuttonAdaptative = gtk_check_button_new_with_mnemonic (_("Adaptative DCT"));
+  gtk_widget_show (checkbuttonAdaptative);
+  gtk_table_attach (GTK_TABLE (table6), checkbuttonAdaptative, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonAdaptative, _("Use fewer B-frames if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames."), NULL);
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbuttonAdaptative), TRUE);
+
+  checkbuttonBasReference = gtk_check_button_new_with_mnemonic (_("Use as Reference"));
+  gtk_widget_show (checkbuttonBasReference);
+  gtk_table_attach (GTK_TABLE (table6), checkbuttonBasReference, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, checkbuttonBasReference, _("Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"), NULL);
+
+  hbox1 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox4), hbox1, TRUE, TRUE, 0);
+
+  labelBFrameDirectMode = gtk_label_new (_("B-Frame Direct Mode"));
+  gtk_widget_show (labelBFrameDirectMode);
+  gtk_box_pack_start (GTK_BOX (hbox1), labelBFrameDirectMode, FALSE, TRUE, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelBFrameDirectMode), 0, 0.5);
+
+  comboboxDirectMode = gtk_combo_box_new_text ();
+  gtk_widget_show (comboboxDirectMode);
+  gtk_box_pack_start (GTK_BOX (hbox1), comboboxDirectMode, FALSE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("None"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Spatial"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Temporal"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxDirectMode), _("Auto"));
+
+  label20 = gtk_label_new (_("<b>B-Frames</b>"));
+  gtk_widget_show (label20);
+  gtk_frame_set_label_widget (GTK_FRAME (frame5), label20);
+  gtk_label_set_use_markup (GTK_LABEL (label20), TRUE);
+
+  labelPagePartion_Frame = gtk_label_new (_("Partitions & Frames"));
+  gtk_widget_show (labelPagePartion_Frame);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 2), labelPagePartion_Frame);
+
+  alignment17 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment17);
+  gtk_container_add (GTK_CONTAINER (notebook1), alignment17);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment17), 7, 7, 7, 7);
+
+  vbox1 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox1);
+  gtk_container_add (GTK_CONTAINER (alignment17), vbox1);
+
+  frame1 = gtk_frame_new (NULL);
+  gtk_widget_show (frame1);
+  gtk_box_pack_start (GTK_BOX (vbox1), frame1, FALSE, TRUE, 1);
+
+  alignment1 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment1);
+  gtk_container_add (GTK_CONTAINER (frame1), alignment1);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment1), 7, 7, 7, 7);
+
+  table2 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table2);
+  gtk_container_add (GTK_CONTAINER (alignment1), table2);
+  gtk_table_set_row_spacings (GTK_TABLE (table2), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table2), 10);
+
+  spinbuttonKeyframeBoost_adj = gtk_adjustment_new (40, 0, 100, 1, 10, 10);
+  spinbuttonKeyframeBoost = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonKeyframeBoost_adj), 1, 0);
+  gtk_widget_show (spinbuttonKeyframeBoost);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonKeyframeBoost, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_widget_set_size_request (spinbuttonKeyframeBoost, 115, -1);
+  gtk_tooltips_set_tip (tooltips, spinbuttonKeyframeBoost, _("Set how much \"bitrate bonus\" a keyframe can get"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonKeyframeBoost), TRUE);
+
+  spinbuttonBframeReduction_adj = gtk_adjustment_new (30, 0, 100, 1, 10, 10);
+  spinbuttonBframeReduction = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBframeReduction_adj), 1, 0);
+  gtk_widget_show (spinbuttonBframeReduction);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonBframeReduction, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBframeReduction, _("Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBframeReduction), TRUE);
+
+  spinbuttonBitrateVariability_adj = gtk_adjustment_new (60, 0, 100, 1, 10, 10);
+  spinbuttonBitrateVariability = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBitrateVariability_adj), 1, 0);
+  gtk_widget_show (spinbuttonBitrateVariability);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonBitrateVariability, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBitrateVariability, _("Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBitrateVariability), TRUE);
+
+  labelKeyframeboost = gtk_label_new (_("Keyframe Boost (%)"));
+  gtk_widget_show (labelKeyframeboost);
+  gtk_table_attach (GTK_TABLE (table2), labelKeyframeboost, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelKeyframeboost), 0, 0.5);
+
+  label11 = gtk_label_new (_("B-frame Reduction (%)"));
+  gtk_widget_show (label11);
+  gtk_table_attach (GTK_TABLE (table2), label11, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label11), 0, 0.5);
+
+  label12 = gtk_label_new (_("Bitrate Variability (%)"));
+  gtk_widget_show (label12);
+  gtk_table_attach (GTK_TABLE (table2), label12, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label12), 0, 0.5);
+
+  label7 = gtk_label_new (_("<b>Bitrate</b>"));
+  gtk_widget_show (label7);
+  gtk_frame_set_label_widget (GTK_FRAME (frame1), label7);
+  gtk_label_set_use_markup (GTK_LABEL (label7), TRUE);
+
+  frame2 = gtk_frame_new (NULL);
+  gtk_widget_show (frame2);
+  gtk_box_pack_start (GTK_BOX (vbox1), frame2, FALSE, TRUE, 1);
+
+  alignment2 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment2);
+  gtk_container_add (GTK_CONTAINER (frame2), alignment2);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment2), 7, 7, 7, 7);
+
+  table3 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table3);
+  gtk_container_add (GTK_CONTAINER (alignment2), table3);
+  gtk_table_set_row_spacings (GTK_TABLE (table3), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table3), 20);
+
+  label13 = gtk_label_new (_("Min QP"));
+  gtk_widget_show (label13);
+  gtk_table_attach (GTK_TABLE (table3), label13, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label13), 0, 0.5);
+
+  label14 = gtk_label_new (_("Max QP"));
+  gtk_widget_show (label14);
+  gtk_table_attach (GTK_TABLE (table3), label14, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label14), 0, 0.5);
+
+  label15 = gtk_label_new (_("Max QP Step"));
+  gtk_widget_show (label15);
+  gtk_table_attach (GTK_TABLE (table3), label15, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label15), 0, 0.5);
+
+  spinbuttonMinQp_adj = gtk_adjustment_new (10, 10, 51, 1, 10, 10);
+  spinbuttonMinQp = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMinQp_adj), 1, 0);
+  gtk_widget_show (spinbuttonMinQp);
+  gtk_table_attach (GTK_TABLE (table3), spinbuttonMinQp, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_widget_set_size_request (spinbuttonMinQp, 54, -1);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMinQp, _("Enforce a minimum quantizer level"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMinQp), TRUE);
+
+  spinbuttonMaxQp_adj = gtk_adjustment_new (51, 10, 51, 1, 10, 10);
+  spinbuttonMaxQp = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxQp_adj), 1, 0);
+  gtk_widget_show (spinbuttonMaxQp);
+  gtk_table_attach (GTK_TABLE (table3), spinbuttonMaxQp, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMaxQp, _("Enforce a maximum quantizer level"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxQp), TRUE);
+
+  spinbuttonQpStep_adj = gtk_adjustment_new (4, 0, 10, 1, 10, 10);
+  spinbuttonQpStep = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQpStep_adj), 1, 0);
+  gtk_widget_show (spinbuttonQpStep);
+  gtk_table_attach (GTK_TABLE (table3), spinbuttonQpStep, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonQpStep, _("Define how much the quantizer rate can change between two consecutive frames"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQpStep), TRUE);
+
+  label8 = gtk_label_new (_("<b>Quantization Limits</b>"));
+  gtk_widget_show (label8);
+  gtk_frame_set_label_widget (GTK_FRAME (frame2), label8);
+  gtk_label_set_use_markup (GTK_LABEL (label8), TRUE);
+
+  frame3 = gtk_frame_new (NULL);
+  gtk_widget_show (frame3);
+  gtk_box_pack_start (GTK_BOX (vbox1), frame3, FALSE, TRUE, 1);
+
+  alignment3 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment3);
+  gtk_container_add (GTK_CONTAINER (frame3), alignment3);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment3), 7, 7, 7, 7);
+
+  table4 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table4);
+  gtk_container_add (GTK_CONTAINER (alignment3), table4);
+  gtk_table_set_row_spacings (GTK_TABLE (table4), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table4), 10);
+
+  spinbuttonSceneCut_adj = gtk_adjustment_new (40, 0, 100, 1, 10, 10);
+  spinbuttonSceneCut = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonSceneCut_adj), 1, 0);
+  gtk_widget_show (spinbuttonSceneCut);
+  gtk_table_attach (GTK_TABLE (table4), spinbuttonSceneCut, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_widget_set_size_request (spinbuttonSceneCut, 115, -1);
+  gtk_tooltips_set_tip (tooltips, spinbuttonSceneCut, _("Increase / decrease sensitivity for detecting scene changes. Improves I-frame usage and quality."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonSceneCut), TRUE);
+
+  label16 = gtk_label_new (_("Scene Cut Threshold"));
+  gtk_widget_show (label16);
+  gtk_table_attach (GTK_TABLE (table4), label16, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label16), 0, 0.5);
+
+  label17 = gtk_label_new (_("Min IDR Frame Interval"));
+  gtk_widget_show (label17);
+  gtk_table_attach (GTK_TABLE (table4), label17, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label17), 0, 0.5);
+
+  spinbuttonMinIdr_adj = gtk_adjustment_new (25, 0, 100, 1, 10, 10);
+  spinbuttonMinIdr = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMinIdr_adj), 1, 0);
+  gtk_widget_show (spinbuttonMinIdr);
+  gtk_table_attach (GTK_TABLE (table4), spinbuttonMinIdr, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMinIdr, _("Set minimum frame interval between IDR frames. Defines the minimum amount a frame can be reused and referenced by other frames before a new IDR frame is established."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMinIdr), TRUE);
+
+  spinbuttonMaxIdr_adj = gtk_adjustment_new (250, 1, 1000, 1, 10, 10);
+  spinbuttonMaxIdr = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonMaxIdr_adj), 1, 0);
+  gtk_widget_show (spinbuttonMaxIdr);
+  gtk_table_attach (GTK_TABLE (table4), spinbuttonMaxIdr, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonMaxIdr, _("Set maximum frame interval between IDR frames. Defines the maximum amount a frame can be reused and referenced by other frames before a new IDR frame is established."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonMaxIdr), TRUE);
+
+  label18 = gtk_label_new (_("Max IDR Frame Interval"));
+  gtk_widget_show (label18);
+  gtk_table_attach (GTK_TABLE (table4), label18, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label18), 0, 0.5);
+
+  labelMoreEncodingSettings = gtk_label_new (_("<b>More Rate Settings</b>"));
+  gtk_widget_show (labelMoreEncodingSettings);
+  gtk_frame_set_label_widget (GTK_FRAME (frame3), labelMoreEncodingSettings);
+  gtk_label_set_use_markup (GTK_LABEL (labelMoreEncodingSettings), TRUE);
+
+  frameVideoBufferVerifier = gtk_frame_new (NULL);
+  gtk_widget_show (frameVideoBufferVerifier);
+  gtk_box_pack_start (GTK_BOX (vbox1), frameVideoBufferVerifier, FALSE, TRUE, 0);
+
+  alignment11 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment11);
+  gtk_container_add (GTK_CONTAINER (frameVideoBufferVerifier), alignment11);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment11), 7, 7, 7, 7);
+
+  table12 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table12);
+  gtk_container_add (GTK_CONTAINER (alignment11), table12);
+  gtk_table_set_row_spacings (GTK_TABLE (table12), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table12), 10);
+
+  labelVBVBufferSize = gtk_label_new (_("VBV Buffer Size"));
+  gtk_widget_show (labelVBVBufferSize);
+  gtk_table_attach (GTK_TABLE (table12), labelVBVBufferSize, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelVBVBufferSize), 0, 0.5);
+
+  labelVBVInitialbuffer = gtk_label_new (_("Initial VBV Buffer (%)"));
+  gtk_widget_show (labelVBVInitialbuffer);
+  gtk_table_attach (GTK_TABLE (table12), labelVBVInitialbuffer, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelVBVInitialbuffer), 0, 0.5);
+
+  labelVBVMaximumBitrate = gtk_label_new (_("Maximum Local Bitrate"));
+  gtk_widget_show (labelVBVMaximumBitrate);
+  gtk_table_attach (GTK_TABLE (table12), labelVBVMaximumBitrate, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelVBVMaximumBitrate), 0, 0.5);
+
+  spinbuttonvbv_max_bitrate_adj = gtk_adjustment_new (0, 0, 99999, 1, 10, 10);
+  spinbuttonvbv_max_bitrate = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_max_bitrate_adj), 1, 0);
+  gtk_widget_show (spinbuttonvbv_max_bitrate);
+  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_max_bitrate, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_max_bitrate), TRUE);
+
+  spinbuttonvbv_buffer_size_adj = gtk_adjustment_new (0, 0, 99999, 1, 10, 10);
+  spinbuttonvbv_buffer_size = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_buffer_size_adj), 1, 0);
+  gtk_widget_show (spinbuttonvbv_buffer_size);
+  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_buffer_size, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_buffer_size), TRUE);
+
+  spinbuttonvbv_buffer_init_adj = gtk_adjustment_new (90, 0, 100, 1, 10, 10);
+  spinbuttonvbv_buffer_init = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvbv_buffer_init_adj), 1, 0);
+  gtk_widget_show (spinbuttonvbv_buffer_init);
+  gtk_table_attach (GTK_TABLE (table12), spinbuttonvbv_buffer_init, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvbv_buffer_init), TRUE);
+
+  labelVideoBufferVerifier = gtk_label_new (_("<b>Video Buffer Verifier</b>"));
+  gtk_widget_show (labelVideoBufferVerifier);
+  gtk_frame_set_label_widget (GTK_FRAME (frameVideoBufferVerifier), labelVideoBufferVerifier);
+  gtk_label_set_use_markup (GTK_LABEL (labelVideoBufferVerifier), TRUE);
+
+  labelPageRateControl = gtk_label_new (_("Rate Control"));
+  gtk_widget_show (labelPageRateControl);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 3), labelPageRateControl);
+
+  alignment18 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment18);
+  gtk_container_add (GTK_CONTAINER (notebook1), alignment18);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment18), 7, 7, 7, 7);
+
+  vbox8 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox8);
+  gtk_container_add (GTK_CONTAINER (alignment18), vbox8);
+
+  frame10 = gtk_frame_new (NULL);
+  gtk_widget_show (frame10);
+  gtk_box_pack_start (GTK_BOX (vbox8), frame10, FALSE, TRUE, 0);
+
+  alignment10 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment10);
+  gtk_container_add (GTK_CONTAINER (frame10), alignment10);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment10), 7, 7, 7, 7);
+
+  table15 = gtk_table_new (4, 2, FALSE);
+  gtk_widget_show (table15);
+  gtk_container_add (GTK_CONTAINER (alignment10), table15);
+  gtk_table_set_row_spacings (GTK_TABLE (table15), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table15), 10);
+
+  labelBitrateVariance = gtk_label_new (_("Bitrate Variance"));
+  gtk_widget_show (labelBitrateVariance);
+  gtk_table_attach (GTK_TABLE (table15), labelBitrateVariance, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelBitrateVariance), 0, 0.5);
+
+  spinbuttonBitrateVariance_adj = gtk_adjustment_new (1, 0, 1, 0.10000000149, 10, 10);
+  spinbuttonBitrateVariance = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBitrateVariance_adj), 0.10000000149, 1);
+  gtk_widget_show (spinbuttonBitrateVariance);
+  gtk_table_attach (GTK_TABLE (table15), spinbuttonBitrateVariance, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonBitrateVariance, _("Allowed variance of average bitrate. Lower values mean less variance. Higher values mean more variance."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBitrateVariance), TRUE);
+
+  spinbuttonQuantizerCompression_adj = gtk_adjustment_new (0.600000023842, 0, 1, 0.10000000149, 10, 10);
+  spinbuttonQuantizerCompression = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuantizerCompression_adj), 0.10000000149, 1);
+  gtk_widget_show (spinbuttonQuantizerCompression);
+  gtk_table_attach (GTK_TABLE (table15), spinbuttonQuantizerCompression, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonQuantizerCompression, _("Allowed variance of average quantizer or quality. Lower values mean less variance. Higher values mean more variance. Note that 0 means constant quality while 1 means constant fluctuation. Recommended 0.6."), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonQuantizerCompression), TRUE);
+
+  spinbuttonTempBlurFrame_adj = gtk_adjustment_new (20, 0, 999, 1, 10, 10);
+  spinbuttonTempBlurFrame = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTempBlurFrame_adj), 1, 0);
+  gtk_widget_show (spinbuttonTempBlurFrame);
+  gtk_table_attach (GTK_TABLE (table15), spinbuttonTempBlurFrame, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonTempBlurFrame, _("Reduced fluctuations in Quantizer (before curve compression)"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTempBlurFrame), TRUE);
+
+  spinbuttonTempBlurQuant_adj = gtk_adjustment_new (0.5, 0, 1, 0.5, 10, 10);
+  spinbuttonTempBlurQuant = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTempBlurQuant_adj), 0.5, 1);
+  gtk_widget_show (spinbuttonTempBlurQuant);
+  gtk_table_attach (GTK_TABLE (table15), spinbuttonTempBlurQuant, 1, 2, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTempBlurQuant), TRUE);
+
+  labelQuantizerCompression = gtk_label_new (_("Quantizer Compression"));
+  gtk_widget_show (labelQuantizerCompression);
+  gtk_table_attach (GTK_TABLE (table15), labelQuantizerCompression, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelQuantizerCompression), 0, 0.5);
+
+  labelTempBlurEstFrame = gtk_label_new (_("Temp. Blur of Est. Frame Complexity"));
+  gtk_widget_show (labelTempBlurEstFrame);
+  gtk_table_attach (GTK_TABLE (table15), labelTempBlurEstFrame, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTempBlurEstFrame), 0, 0.5);
+
+  labelTempBlueQuant = gtk_label_new (_("Temp. Blur of Quant. after CC"));
+  gtk_widget_show (labelTempBlueQuant);
+  gtk_table_attach (GTK_TABLE (table15), labelTempBlueQuant, 0, 1, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTempBlueQuant), 0, 0.5);
+
+  labelMisc = gtk_label_new (_("<b>Misc</b>"));
+  gtk_widget_show (labelMisc);
+  gtk_frame_set_label_widget (GTK_FRAME (frame10), labelMisc);
+  gtk_label_set_use_markup (GTK_LABEL (labelMisc), TRUE);
+
+  frame11 = gtk_frame_new (NULL);
+  gtk_widget_show (frame11);
+  gtk_box_pack_start (GTK_BOX (vbox8), frame11, FALSE, TRUE, 0);
+
+  alignment13 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment13);
+  gtk_container_add (GTK_CONTAINER (frame11), alignment13);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment13), 7, 7, 7, 7);
+
+  table16 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table16);
+  gtk_container_add (GTK_CONTAINER (alignment13), table16);
+  gtk_table_set_row_spacings (GTK_TABLE (table16), 3);
+  gtk_table_set_col_spacings (GTK_TABLE (table16), 10);
+
+  spinbutton8_adj = gtk_adjustment_new (1.39999997616, 1, 10, 0.10000000149, 10, 10);
+  spinbutton8 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton8_adj), 0.10000000149, 1);
+  gtk_widget_show (spinbutton8);
+  gtk_table_attach (GTK_TABLE (table16), spinbutton8, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbutton8, _("Quantization factors used between I and P-frames"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton8), TRUE);
+
+  spinbutton9_adj = gtk_adjustment_new (1.29999995232, 1, 10, 0.10000000149, 10, 10);
+  spinbutton9 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton9_adj), 0.10000000149, 1);
+  gtk_widget_show (spinbutton9);
+  gtk_table_attach (GTK_TABLE (table16), spinbutton9, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbutton9, _("Quantization used between P and B-frames"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton9), TRUE);
+
+  spinbuttonChromaQPOffset_adj = gtk_adjustment_new (0, -12, 12, 1, 10, 10);
+  spinbuttonChromaQPOffset = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonChromaQPOffset_adj), 1, 0);
+  gtk_widget_show (spinbuttonChromaQPOffset);
+  gtk_table_attach (GTK_TABLE (table16), spinbuttonChromaQPOffset, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_tooltips_set_tip (tooltips, spinbuttonChromaQPOffset, _("Quantization difference between chroma (color) and luma (brightness)"), NULL);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonChromaQPOffset), TRUE);
+
+  labelFactorbetweenIandP = gtk_label_new (_("Factor between I and P-frame Quants"));
+  gtk_widget_show (labelFactorbetweenIandP);
+  gtk_table_attach (GTK_TABLE (table16), labelFactorbetweenIandP, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelFactorbetweenIandP), 0, 0.5);
+
+  labelFactorbetweenPandB = gtk_label_new (_("Factor between P and B-frame Quants"));
+  gtk_widget_show (labelFactorbetweenPandB);
+  gtk_table_attach (GTK_TABLE (table16), labelFactorbetweenPandB, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelFactorbetweenPandB), 0, 0.5);
+
+  labelChromaQPOffset = gtk_label_new (_("Chroma QP Offset"));
+  gtk_widget_show (labelChromaQPOffset);
+  gtk_table_attach (GTK_TABLE (table16), labelChromaQPOffset, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelChromaQPOffset), 0, 0.5);
+
+  labelQuantizers = gtk_label_new (_("<b>Quantizers</b>"));
+  gtk_widget_show (labelQuantizers);
+  gtk_frame_set_label_widget (GTK_FRAME (frame11), labelQuantizers);
+  gtk_label_set_use_markup (GTK_LABEL (labelQuantizers), TRUE);
+
+  frame9 = gtk_frame_new (NULL);
+  gtk_widget_show (frame9);
+  gtk_box_pack_start (GTK_BOX (vbox8), frame9, FALSE, TRUE, 0);
+
+  alignment9 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment9);
+  gtk_container_add (GTK_CONTAINER (frame9), alignment9);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment9), 7, 7, 7, 7);
+
+  vbox9 = gtk_vbox_new (FALSE, 3);
+  gtk_widget_show (vbox9);
+  gtk_container_add (GTK_CONTAINER (alignment9), vbox9);
+
+  radiobuttonFlatmatrix = gtk_radio_button_new_with_mnemonic (NULL, _("Flat Matrix"));
+  gtk_widget_show (radiobuttonFlatmatrix);
+  gtk_box_pack_start (GTK_BOX (vbox9), radiobuttonFlatmatrix, FALSE, FALSE, 0);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonFlatmatrix), radiobuttonFlatmatrix_group);
+  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonFlatmatrix));
+  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (radiobuttonFlatmatrix), TRUE);
+
+  radiobuttonJVTmatrix = gtk_radio_button_new_with_mnemonic (NULL, _("JVT Matrix"));
+  gtk_widget_show (radiobuttonJVTmatrix);
+  gtk_box_pack_start (GTK_BOX (vbox9), radiobuttonJVTmatrix, FALSE, FALSE, 0);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonJVTmatrix), radiobuttonFlatmatrix_group);
+  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonJVTmatrix));
+
+  hbox13 = gtk_hbox_new (FALSE, 10);
+  gtk_widget_show (hbox13);
+  gtk_box_pack_start (GTK_BOX (vbox9), hbox13, FALSE, FALSE, 0);
+
+  radiobuttonCustommatrix = gtk_radio_button_new_with_mnemonic (NULL, _("Custom Matrix"));
+  gtk_widget_show (radiobuttonCustommatrix);
+  gtk_box_pack_start (GTK_BOX (hbox13), radiobuttonCustommatrix, TRUE, TRUE, 0);
+  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobuttonCustommatrix), radiobuttonFlatmatrix_group);
+  radiobuttonFlatmatrix_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobuttonCustommatrix));
+
+  hbox14 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox14);
+  gtk_box_pack_start (GTK_BOX (hbox13), hbox14, TRUE, TRUE, 0);
+
+  filechooserbuttonOpenCQMFile = gtk_file_chooser_button_new (_("Open CQM file"), GTK_FILE_CHOOSER_ACTION_OPEN);
+  gtk_widget_show (filechooserbuttonOpenCQMFile);
+  gtk_box_pack_start (GTK_BOX (hbox14), filechooserbuttonOpenCQMFile, TRUE, TRUE, 0);
+
+  vseparator1 = gtk_vseparator_new ();
+  gtk_widget_show (vseparator1);
+  gtk_box_pack_start (GTK_BOX (hbox14), vseparator1, TRUE, TRUE, 0);
+
+  buttonEditCustomMatrix = gtk_button_new_with_mnemonic (_("Edit Custom Matrix"));
+  gtk_widget_show (buttonEditCustomMatrix);
+  gtk_box_pack_start (GTK_BOX (hbox14), buttonEditCustomMatrix, FALSE, FALSE, 0);
+  gtk_tooltips_set_tip (tooltips, buttonEditCustomMatrix, _("Edit loaded custom quantization matrix file"), NULL);
+
+  labelFrameQuantizationMatrices = gtk_label_new (_("<b>Quantization Matrices</b>"));
+  gtk_widget_show (labelFrameQuantizationMatrices);
+  gtk_frame_set_label_widget (GTK_FRAME (frame9), labelFrameQuantizationMatrices);
+  gtk_label_set_use_markup (GTK_LABEL (labelFrameQuantizationMatrices), TRUE);
+
+  labelMore = gtk_label_new (_("More"));
+  gtk_widget_show (labelMore);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook1), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook1), 4), labelMore);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  buttonResetDaults = gtk_button_new_with_mnemonic (_("_Defaults"));
+  gtk_widget_show (buttonResetDaults);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), buttonResetDaults, 0);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, notebook1, "notebook1");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment14, "alignment14");
+  GLADE_HOOKUP_OBJECT (dialog1, tableBitrate, "tableBitrate");
+  GLADE_HOOKUP_OBJECT (dialog1, labelEncodingMode, "labelEncodingMode");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizer, "labelQuantizer");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTarget, "labelTarget");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQuantizer, "spinbuttonQuantizer");
+  GLADE_HOOKUP_OBJECT (dialog1, entryTarget, "entryTarget");
+  GLADE_HOOKUP_OBJECT (dialog1, comboboxMode, "comboboxMode");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPageBitrate, "labelPageBitrate");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment15, "alignment15");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox5, "vbox5");
+  GLADE_HOOKUP_OBJECT (dialog1, frame6, "frame6");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment6, "alignment6");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox6, "vbox6");
+  GLADE_HOOKUP_OBJECT (dialog1, table7, "table7");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPartitionDecision, "labelPartitionDecision");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMethod, "labelMethod");
+  GLADE_HOOKUP_OBJECT (dialog1, comboboxPartitionDecision, "comboboxPartitionDecision");
+  GLADE_HOOKUP_OBJECT (dialog1, comboboxMethod, "comboboxMethod");
+  GLADE_HOOKUP_OBJECT (dialog1, table11, "table11");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMaxRefFrames, "labelMaxRefFrames");
+  GLADE_HOOKUP_OBJECT (dialog1, labelRange, "labelRange");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRange, "spinbuttonRange");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxRefFrames, "spinbuttonMaxRefFrames");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonChromaME, "checkbuttonChromaME");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonMixedRefs, "checkbuttonMixedRefs");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox8, "hbox8");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonfastPSkip, "checkbuttonfastPSkip");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonDCTDecimate, "checkbuttonDCTDecimate");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttoninterlaced, "checkbuttoninterlaced");
+  GLADE_HOOKUP_OBJECT (dialog1, label24, "label24");
+  GLADE_HOOKUP_OBJECT (dialog1, frameSampleAR, "frameSampleAR");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment12, "alignment12");
+  GLADE_HOOKUP_OBJECT (dialog1, table35, "table35");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox12, "hbox12");
+  GLADE_HOOKUP_OBJECT (dialog1, entryAR_Num, "entryAR_Num");
+  GLADE_HOOKUP_OBJECT (dialog1, label53, "label53");
+  GLADE_HOOKUP_OBJECT (dialog1, entryAR_Den, "entryAR_Den");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonCustomAR, "radiobuttonCustomAR");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonPredefinedAR, "radiobuttonPredefinedAR");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonAsInputAR, "radiobuttonAsInputAR");
+  GLADE_HOOKUP_OBJECT (dialog1, label40, "label40");
+  GLADE_HOOKUP_OBJECT (dialog1, comboboxentry1, "comboboxentry1");
+  GLADE_HOOKUP_OBJECT (dialog1, label39, "label39");
+  GLADE_HOOKUP_OBJECT (dialog1, frame7, "frame7");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment7, "alignment7");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment21, "alignment21");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonCABAC, "checkbuttonCABAC");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox7, "hbox7");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTrellis, "labelTrellis");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTrellis, "spinbuttonTrellis");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox11, "hbox11");
+  GLADE_HOOKUP_OBJECT (dialog1, labelNoiseReduction, "labelNoiseReduction");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonNoiseReduction, "spinbuttonNoiseReduction");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox3, "hbox3");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonDeblockingFilter, "checkbuttonDeblockingFilter");
+  GLADE_HOOKUP_OBJECT (dialog1, table8, "table8");
+  GLADE_HOOKUP_OBJECT (dialog1, labelThreshold, "labelThreshold");
+  GLADE_HOOKUP_OBJECT (dialog1, labelStrength, "labelStrength");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonThreshold, "spinbuttonThreshold");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonStrength, "spinbuttonStrength");
+  GLADE_HOOKUP_OBJECT (dialog1, label25, "label25");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPageMotion_More, "labelPageMotion_More");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment16, "alignment16");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, frame4, "frame4");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment4, "alignment4");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8, "checkbutton8x8");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8P, "checkbutton8x8P");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8B, "checkbutton8x8B");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton4x4, "checkbutton4x4");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton8x8I, "checkbutton8x8I");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbutton4x4I, "checkbutton4x4I");
+  GLADE_HOOKUP_OBJECT (dialog1, label19, "label19");
+  GLADE_HOOKUP_OBJECT (dialog1, frame5, "frame5");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment5, "alignment5");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox4, "vbox4");
+  GLADE_HOOKUP_OBJECT (dialog1, table5, "table5");
+  GLADE_HOOKUP_OBJECT (dialog1, labelBias, "labelBias");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMaxConsecutive, "labelMaxConsecutive");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBias, "spinbuttonBias");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxBFrame, "spinbuttonMaxBFrame");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment20, "alignment20");
+  GLADE_HOOKUP_OBJECT (dialog1, table6, "table6");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBidirME, "checkbuttonBidirME");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonWeighted, "checkbuttonWeighted");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonAdaptative, "checkbuttonAdaptative");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBasReference, "checkbuttonBasReference");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, labelBFrameDirectMode, "labelBFrameDirectMode");
+  GLADE_HOOKUP_OBJECT (dialog1, comboboxDirectMode, "comboboxDirectMode");
+  GLADE_HOOKUP_OBJECT (dialog1, label20, "label20");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPagePartion_Frame, "labelPagePartion_Frame");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment17, "alignment17");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, frame1, "frame1");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment1, "alignment1");
+  GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonKeyframeBoost, "spinbuttonKeyframeBoost");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBframeReduction, "spinbuttonBframeReduction");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBitrateVariability, "spinbuttonBitrateVariability");
+  GLADE_HOOKUP_OBJECT (dialog1, labelKeyframeboost, "labelKeyframeboost");
+  GLADE_HOOKUP_OBJECT (dialog1, label11, "label11");
+  GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
+  GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
+  GLADE_HOOKUP_OBJECT (dialog1, frame2, "frame2");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment2, "alignment2");
+  GLADE_HOOKUP_OBJECT (dialog1, table3, "table3");
+  GLADE_HOOKUP_OBJECT (dialog1, label13, "label13");
+  GLADE_HOOKUP_OBJECT (dialog1, label14, "label14");
+  GLADE_HOOKUP_OBJECT (dialog1, label15, "label15");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMinQp, "spinbuttonMinQp");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxQp, "spinbuttonMaxQp");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQpStep, "spinbuttonQpStep");
+  GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
+  GLADE_HOOKUP_OBJECT (dialog1, frame3, "frame3");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment3, "alignment3");
+  GLADE_HOOKUP_OBJECT (dialog1, table4, "table4");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonSceneCut, "spinbuttonSceneCut");
+  GLADE_HOOKUP_OBJECT (dialog1, label16, "label16");
+  GLADE_HOOKUP_OBJECT (dialog1, label17, "label17");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMinIdr, "spinbuttonMinIdr");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonMaxIdr, "spinbuttonMaxIdr");
+  GLADE_HOOKUP_OBJECT (dialog1, label18, "label18");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMoreEncodingSettings, "labelMoreEncodingSettings");
+  GLADE_HOOKUP_OBJECT (dialog1, frameVideoBufferVerifier, "frameVideoBufferVerifier");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment11, "alignment11");
+  GLADE_HOOKUP_OBJECT (dialog1, table12, "table12");
+  GLADE_HOOKUP_OBJECT (dialog1, labelVBVBufferSize, "labelVBVBufferSize");
+  GLADE_HOOKUP_OBJECT (dialog1, labelVBVInitialbuffer, "labelVBVInitialbuffer");
+  GLADE_HOOKUP_OBJECT (dialog1, labelVBVMaximumBitrate, "labelVBVMaximumBitrate");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_max_bitrate, "spinbuttonvbv_max_bitrate");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_buffer_size, "spinbuttonvbv_buffer_size");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvbv_buffer_init, "spinbuttonvbv_buffer_init");
+  GLADE_HOOKUP_OBJECT (dialog1, labelVideoBufferVerifier, "labelVideoBufferVerifier");
+  GLADE_HOOKUP_OBJECT (dialog1, labelPageRateControl, "labelPageRateControl");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment18, "alignment18");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox8, "vbox8");
+  GLADE_HOOKUP_OBJECT (dialog1, frame10, "frame10");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment10, "alignment10");
+  GLADE_HOOKUP_OBJECT (dialog1, table15, "table15");
+  GLADE_HOOKUP_OBJECT (dialog1, labelBitrateVariance, "labelBitrateVariance");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBitrateVariance, "spinbuttonBitrateVariance");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonQuantizerCompression, "spinbuttonQuantizerCompression");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTempBlurFrame, "spinbuttonTempBlurFrame");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTempBlurQuant, "spinbuttonTempBlurQuant");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizerCompression, "labelQuantizerCompression");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTempBlurEstFrame, "labelTempBlurEstFrame");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTempBlueQuant, "labelTempBlueQuant");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMisc, "labelMisc");
+  GLADE_HOOKUP_OBJECT (dialog1, frame11, "frame11");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment13, "alignment13");
+  GLADE_HOOKUP_OBJECT (dialog1, table16, "table16");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton8, "spinbutton8");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton9, "spinbutton9");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonChromaQPOffset, "spinbuttonChromaQPOffset");
+  GLADE_HOOKUP_OBJECT (dialog1, labelFactorbetweenIandP, "labelFactorbetweenIandP");
+  GLADE_HOOKUP_OBJECT (dialog1, labelFactorbetweenPandB, "labelFactorbetweenPandB");
+  GLADE_HOOKUP_OBJECT (dialog1, labelChromaQPOffset, "labelChromaQPOffset");
+  GLADE_HOOKUP_OBJECT (dialog1, labelQuantizers, "labelQuantizers");
+  GLADE_HOOKUP_OBJECT (dialog1, frame9, "frame9");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment9, "alignment9");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox9, "vbox9");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonFlatmatrix, "radiobuttonFlatmatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonJVTmatrix, "radiobuttonJVTmatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox13, "hbox13");
+  GLADE_HOOKUP_OBJECT (dialog1, radiobuttonCustommatrix, "radiobuttonCustommatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox14, "hbox14");
+  GLADE_HOOKUP_OBJECT (dialog1, filechooserbuttonOpenCQMFile, "filechooserbuttonOpenCQMFile");
+  GLADE_HOOKUP_OBJECT (dialog1, vseparator1, "vseparator1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonEditCustomMatrix, "buttonEditCustomMatrix");
+  GLADE_HOOKUP_OBJECT (dialog1, labelFrameQuantizationMatrices, "labelFrameQuantizationMatrices");
+  GLADE_HOOKUP_OBJECT (dialog1, labelMore, "labelMore");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonResetDaults, "buttonResetDaults");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, tooltips, "tooltips");
+
+  gtk_widget_grab_default (okbutton1);
+  return dialog1;
+}

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.glade
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.glade	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.glade	2008-06-15 12:50:52 UTC (rev 4099)
@@ -550,7 +550,7 @@
 				      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
 				      <property name="snap_to_ticks">False</property>
 				      <property name="wrap">False</property>
-				      <property name="adjustment">1 0 16 1 10 10</property>
+				      <property name="adjustment">1 1 16 1 10 10</property>
 				    </widget>
 				    <packing>
 				      <property name="left_attach">1</property>
@@ -1707,7 +1707,7 @@
 				      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
 				      <property name="snap_to_ticks">False</property>
 				      <property name="wrap">False</property>
-				      <property name="adjustment">3 0 15 1 10 10</property>
+				      <property name="adjustment">3 0 16 1 10 10</property>
 				    </widget>
 				    <packing>
 				      <property name="left_attach">1</property>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2008-06-15 12:50:52 UTC (rev 4099)
@@ -771,26 +771,6 @@
 		_param.analyse.i_luma_deadzone[1] = intraLumaDeadzone;
 }
 
-bool x264Options::getComputePsnr(void)
-{
-	return _param.analyse.b_psnr;
-}
-
-void x264Options::setComputePsnr(bool computePsnr)
-{
-	_param.analyse.b_psnr = computePsnr;
-}
-
-bool x264Options::getComputeSsim(void)
-{
-	return _param.analyse.b_ssim;
-}
-
-void x264Options::setComputeSsim(bool computeSsim)
-{
-	_param.analyse.b_ssim = computeSsim;
-}
-
 unsigned int x264Options::getQuantiserMinimum(void)
 {
 	return _param.rc.i_qp_min;
@@ -1403,8 +1383,6 @@
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"noiseReduction", number2String(xmlBuffer, bufferSize, getNoiseReduction()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"interLumaDeadzone", number2String(xmlBuffer, bufferSize, getInterLumaDeadzone()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"intraLumaDeadzone", number2String(xmlBuffer, bufferSize, getIntraLumaDeadzone()));
-	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"computePsnr", boolean2String(xmlBuffer, bufferSize, getComputePsnr()));
-	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"computeSsim", boolean2String(xmlBuffer, bufferSize, getComputeSsim()));
 
 	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"rateControl", NULL);
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"quantiserMinimum", number2String(xmlBuffer, bufferSize, getQuantiserMinimum()));
@@ -1931,10 +1909,6 @@
 				setInterLumaDeadzone(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "intraLumaDeadzone") == 0)
 				setIntraLumaDeadzone(atoi(content));
-			else if (strcmp((char*)xmlChild->name, "computePsnr") == 0)
-				setComputePsnr(string2Boolean(content));
-			else if (strcmp((char*)xmlChild->name, "computeSsim") == 0)
-				setComputeSsim(string2Boolean(content));
 
 			xmlFree(content);
 		}

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2008-06-15 12:50:52 UTC (rev 4099)
@@ -71,7 +71,7 @@
 	connect(ui.quantiserSpinBox, SIGNAL(valueChanged(int)), this, SLOT(quantiserSpinBox_valueChanged(int)));
 	connect(ui.targetRateControlSpinBox, SIGNAL(valueChanged(int)), this, SLOT(targetRateControlSpinBox_valueChanged(int)));
 
-	ui.sarAsInputLabel->setText(QString("%2:%3").arg(properties->parWidth).arg(properties->parHeight));
+	ui.sarAsInputLabel->setText(QString("%1:%2").arg(properties->parWidth).arg(properties->parHeight));
 
 	// Motion Estimation tab
 	connect(ui.meSlider, SIGNAL(valueChanged(int)), this, SLOT(meSlider_valueChanged(int)));
@@ -737,8 +737,6 @@
 	ui.spsiComboBox->setCurrentIndex(ui.spsiComboBox->findText(strSpsId));
 	ui.repeatabilityCheckBox->setChecked(options->getDeterministic());
 	ui.accessUnitCheckBox->setChecked(options->getAccessUnitDelimiters());
-	ui.psnrCheckBox->setChecked(options->getComputePsnr());
-	ui.ssimCheckBox->setChecked(options->getComputeSsim());
 	ui.overscanComboBox->setCurrentIndex(options->getOverscan());
 	ui.videoFormatComboBox->setCurrentIndex(getValueIndexInArray(options->getVideoFormat(), videoFormat, videoFormatCount));
 	ui.colourPrimariesComboBox->setCurrentIndex(getValueIndexInArray(options->getColorPrimaries(), colourPrimaries, colourPrimariesCount));
@@ -935,8 +933,6 @@
 	options->setSpsIdentifier(ui.spsiComboBox->currentText().toInt());
 	options->setDeterministic(ui.repeatabilityCheckBox->isChecked());
 	options->setAccessUnitDelimiters(ui.accessUnitCheckBox->isChecked());
-	options->setComputePsnr(ui.psnrCheckBox->isChecked());
-	options->setComputeSsim(ui.ssimCheckBox->isChecked());
 	options->setOverscan(ui.overscanComboBox->currentIndex());
 	options->setVideoFormat(videoFormat[ui.videoFormatComboBox->currentIndex()]);
 	options->setColorPrimaries(colourPrimaries[ui.colourPrimariesComboBox->currentIndex()]);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2008-06-15 12:50:52 UTC (rev 4099)
@@ -9,7 +9,7 @@
     <x>0</x>
     <y>0</y>
     <width>509</width>
-    <height>556</height>
+    <height>530</height>
    </rect>
   </property>
   <property name="windowTitle" >
@@ -193,12 +193,12 @@
                 </item>
                 <item>
                  <property name="text" >
-                  <string>Constant Quality (Single Pass)</string>
+                  <string>Constant Quantiser (Single Pass)</string>
                  </property>
                 </item>
                 <item>
                  <property name="text" >
-                  <string>Average Quantizer (Single Pass)</string>
+                  <string>Constant Rate Factor (Single Pass)</string>
                  </property>
                 </item>
                 <item>
@@ -673,7 +673,7 @@
        <item>
         <widget class="QGroupBox" name="groupBox_17" >
          <property name="title" >
-          <string>Threading</string>
+          <string>Multithreading</string>
          </property>
          <layout class="QVBoxLayout" >
           <property name="margin" >
@@ -1535,7 +1535,7 @@
                 <item>
                  <widget class="QLabel" name="alphaC0Label" >
                   <property name="text" >
-                   <string>AlphaC0:</string>
+                   <string>Strength:</string>
                   </property>
                  </widget>
                 </item>
@@ -1568,7 +1568,7 @@
                 <item>
                  <widget class="QLabel" name="betaLabel" >
                   <property name="text" >
-                   <string>Beta:</string>
+                   <string>Threshold:</string>
                   </property>
                  </widget>
                 </item>
@@ -1604,30 +1604,38 @@
             </item>
            </layout>
           </item>
-         </layout>
-        </widget>
-       </item>
-       <item>
-        <widget class="QGroupBox" name="groupBox_9" >
-         <property name="title" >
-          <string>B-frames</string>
-         </property>
-         <layout class="QVBoxLayout" >
-          <property name="margin" >
-           <number>9</number>
-          </property>
-          <property name="spacing" >
-           <number>6</number>
-          </property>
           <item>
-           <layout class="QGridLayout" >
+           <spacer>
+            <property name="orientation" >
+             <enum>Qt::Vertical</enum>
+            </property>
+            <property name="sizeType" >
+             <enum>QSizePolicy::Fixed</enum>
+            </property>
+            <property name="sizeHint" >
+             <size>
+              <width>20</width>
+              <height>2</height>
+             </size>
+            </property>
+           </spacer>
+          </item>
+          <item>
+           <layout class="QHBoxLayout" >
             <property name="margin" >
              <number>0</number>
             </property>
             <property name="spacing" >
              <number>6</number>
             </property>
-            <item row="0" column="1" >
+            <item>
+             <widget class="QLabel" name="label_30" >
+              <property name="text" >
+               <string>Maximum Reference Frames:</string>
+              </property>
+             </widget>
+            </item>
+            <item>
              <layout class="QHBoxLayout" >
               <property name="margin" >
                <number>0</number>
@@ -1636,10 +1644,13 @@
                <number>6</number>
               </property>
               <item>
-               <widget class="QSpinBox" name="maxBFramesSpinBox" >
+               <widget class="QSpinBox" name="refFramesSpinBox" >
                 <property name="maximum" >
-                 <number>15</number>
+                 <number>16</number>
                 </property>
+                <property name="minimum" >
+                 <number>1</number>
+                </property>
                </widget>
               </item>
               <item>
@@ -1660,6 +1671,45 @@
               </item>
              </layout>
             </item>
+           </layout>
+          </item>
+         </layout>
+        </widget>
+       </item>
+       <item>
+        <widget class="QGroupBox" name="groupBox_9" >
+         <property name="title" >
+          <string>B-frames</string>
+         </property>
+         <layout class="QVBoxLayout" >
+          <property name="margin" >
+           <number>9</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item>
+           <layout class="QGridLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item row="0" column="0" >
+             <widget class="QLabel" name="label_31" >
+              <property name="text" >
+               <string>Maximum Consecutive B-frames:</string>
+              </property>
+             </widget>
+            </item>
+            <item row="1" column="0" >
+             <widget class="QLabel" name="label_29" >
+              <property name="text" >
+               <string>B-frame Bias:</string>
+              </property>
+             </widget>
+            </item>
             <item row="1" column="1" >
              <layout class="QHBoxLayout" >
               <property name="margin" >
@@ -1696,28 +1746,7 @@
               </item>
              </layout>
             </item>
-            <item row="1" column="0" >
-             <widget class="QLabel" name="label_29" >
-              <property name="text" >
-               <string>B-frame Bias:</string>
-              </property>
-             </widget>
-            </item>
-            <item row="2" column="0" >
-             <widget class="QLabel" name="label_30" >
-              <property name="text" >
-               <string>Reference Frames:</string>
-              </property>
-             </widget>
-            </item>
-            <item row="0" column="0" >
-             <widget class="QLabel" name="label_31" >
-              <property name="text" >
-               <string>Maximum B-frames between I and P:</string>
-              </property>
-             </widget>
-            </item>
-            <item row="2" column="1" >
+            <item row="0" column="1" >
              <layout class="QHBoxLayout" >
               <property name="margin" >
                <number>0</number>
@@ -1726,13 +1755,10 @@
                <number>6</number>
               </property>
               <item>
-               <widget class="QSpinBox" name="refFramesSpinBox" >
+               <widget class="QSpinBox" name="maxBFramesSpinBox" >
                 <property name="maximum" >
                  <number>16</number>
                 </property>
-                <property name="value" >
-                 <number>1</number>
-                </property>
                </widget>
               </item>
               <item>
@@ -3633,20 +3659,6 @@
                 </property>
                </widget>
               </item>
-              <item>
-               <widget class="QCheckBox" name="psnrCheckBox" >
-                <property name="text" >
-                 <string>PSNR Computation</string>
-                </property>
-               </widget>
-              </item>
-              <item>
-               <widget class="QCheckBox" name="ssimCheckBox" >
-                <property name="text" >
-                 <string>SSIM Computation</string>
-                </property>
-               </widget>
-              </item>
              </layout>
             </item>
            </layout>
@@ -4226,8 +4238,6 @@
   <tabstop>spsiComboBox</tabstop>
   <tabstop>repeatabilityCheckBox</tabstop>
   <tabstop>accessUnitCheckBox</tabstop>
-  <tabstop>psnrCheckBox</tabstop>
-  <tabstop>ssimCheckBox</tabstop>
   <tabstop>overscanComboBox</tabstop>
   <tabstop>videoFormatComboBox</tabstop>
   <tabstop>colourPrimariesComboBox</tabstop>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2008-06-15 12:50:52 UTC (rev 4099)
@@ -147,7 +147,7 @@
               <xs:element name="referenceFrames">
                 <xs:simpleType>
                   <xs:restriction base="xs:integer">
-                    <xs:minInclusive value="0"/>
+                    <xs:minInclusive value="1"/>
                     <xs:maxInclusive value="16"/>
                   </xs:restriction>
                 </xs:simpleType>
@@ -181,7 +181,7 @@
                 <xs:simpleType>
                   <xs:restriction base="xs:integer">
                     <xs:minInclusive value="0"/>
-                    <xs:maxInclusive value="15"/>
+                    <xs:maxInclusive value="16"/>
                   </xs:restriction>
                 </xs:simpleType>
               </xs:element>
@@ -377,8 +377,6 @@
                         </xs:restriction>
                       </xs:simpleType>
                     </xs:element>
-                    <xs:element name="computePsnr" type="xs:boolean"/>
-                    <xs:element name="computeSsim" type="xs:boolean"/>
                   </xs:sequence>
                 </xs:complexType>
               </xs:element>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml	2008-06-15 12:16:29 UTC (rev 4098)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml	2008-06-15 12:50:52 UTC (rev 4099)
@@ -265,8 +265,6 @@
       <noiseReduction>0</noiseReduction>
       <interLumaDeadzone>21</interLumaDeadzone>
       <intraLumaDeadzone>11</intraLumaDeadzone>
-      <computePsnr>true</computePsnr>
-      <computeSsim>true</computeSsim>
     </analyse>
     <rateControl>
       <quantiserMinimum>10</quantiserMinimum>



From gruntster at mail.berlios.de  Sun Jun 15 15:50:30 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jun 2008 15:50:30 +0200
Subject: [Avidemux-svn-commit] r4100 - in
	branches/avidemux_2.5_branch_gruntster:
	avidemux/ADM_inputs/ADM_inpics
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui po
Message-ID: <200806151350.m5FDoU0C011878@sheep.berlios.de>

Author: gruntster
Date: 2008-06-15 15:50:12 +0200 (Sun, 15 Jun 2008)
New Revision: 4100

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
   branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts
   branches/avidemux_2.5_branch_gruntster/po/it.po
Log:
[Merge] integrate changes from 2.4 branch (r4098)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-15 13:50:12 UTC (rev 4100)
@@ -43,34 +43,48 @@
 static uint32_t s32;
 #define MAX_ACCEPTED_OPEN_FILE 99999
 
+picHeader::picHeader(void)
+{
+	_nb_file = 0;
+	_imgSize = NULL;
+	_fileMask = NULL;
+}
+
 //****************************************************************
-//****************************************************************
-uint8_t
-    picHeader::getFrameNoAlloc(uint32_t framenum, ADMCompressedImage *img)
+uint8_t picHeader::getFrameNoAlloc(uint32_t framenum, ADMCompressedImage *img)
 {
-    if(framenum>= (uint32_t)_videostream.dwLength) return 0;
-    img->flags = AVI_KEY_FRAME;
-    fseek(_fd[framenum], _offset, SEEK_SET);
-    fread(img->data, _imgSize[framenum] - _offset, 1, _fd[framenum]);
-    img->dataLength = _imgSize[framenum] - _offset;;
-    return 1;
+	if (framenum >= (uint32_t)_videostream.dwLength)
+		return 0;
+
+	img->flags = AVI_KEY_FRAME;
+
+	FILE* fd = openFrameFile(framenum);
+
+	fread(img->data, _imgSize[framenum] - _offset, 1, fd);
+	img->dataLength = _imgSize[framenum] - _offset;
+
+	fclose(fd);
+
+	return 1;
 }
 //****************************************************************
 uint8_t picHeader::close(void)
 {
-    if (_fd) {
-	for (uint32_t i = 0; i < _nb_file; i++) {
-	    fclose(_fd[i]);
+	_nb_file = 0;
+
+	if (_fileMask)
+	{
+		delete [] _fileMask;
+		_fileMask = NULL;
 	}
-	ADM_dealloc(_fd);
-	_fd = NULL;
 
-    }
-    if (_imgSize) {
-	delete[]_imgSize;
-	_imgSize = NULL;
-    }
-    return 0;
+	if (_imgSize)
+	{
+		delete [] _imgSize;
+		_imgSize = NULL;
+	}
+
+	return 0;
 }
 //****************************************************************
 /*
@@ -112,7 +126,6 @@
 //****************************************************************
 uint8_t picHeader::open(char *inname)
 {
-
     uint32_t nnum;
     uint32_t *fcc;
     uint8_t fcc_tab[4];
@@ -173,55 +186,59 @@
     if (nnum == 1) {
 	printf("\n only one file!");
         _nb_file=1;
-         sprintf(realstring, "%%s.%s",extension);
+		 _fileMask = ADM_strdup(inname);
     }
     else
     {
     nnum--;
     end++;
     _first = atoi(end);
-    printf("\n First : %lu, num digit :%lu", _first, nnum);
+	printf("\n First: %lu, Digit count: %lu\n", _first, nnum);
     *(end) = 0;
-    printf("\n Path : %s\n", name);
+	printf(" Path: %s\n", name);
 
-    
-    sprintf(realstring, "%%s%%0%lud.%s", nnum, extension);
-    printf("\n string : %s", realstring);
+	sprintf(realstring, "%s%%0%lud.%s", name, nnum, extension);
+	_fileMask = ADM_strdup(realstring);
+	printf(" File Mask: %s\n\n", _fileMask);
 
     _nb_file = 0;
 
-    for (uint32_t i = 0; i < MAX_ACCEPTED_OPEN_FILE; i++) {
-	sprintf(realname, realstring, name, i + _first);
-	printf("\n %lu : %s\n", i, realname);
-	fd = fopen(realname, "rb");
-	if (fd == NULL)
-	    break;
-	fclose(fd);
-	_nb_file++;
-    }
-    }
+	for (uint32_t i = 0; i < MAX_ACCEPTED_OPEN_FILE; i++)
+	{
+		sprintf(realname, realstring, i + _first);
+		printf(" %lu : %s\n", i, realname);
+
+		fd = fopen(realname, "rb");
+
+		if (fd == NULL)
+			break;
+
+		fclose(fd);
+		_nb_file++;
+	}
+	}
     printf("\n found %lu images\n", _nb_file);
 
-
-    _fd = (FILE **) ADM_alloc(_nb_file * sizeof(FILE *));
     _imgSize = new uint32_t[_nb_file];
     //_________________________________
-    // now open them and assign fd && imgSize
+    // now open them and assign imgSize
     //__________________________________
-    for (uint32_t i = 0; i < _nb_file; i++) {
-	sprintf(realname, realstring, name, i + _first);
-	printf("\n %lu : %s", i, realname);
-	_fd[i] = fopen(realname, "rb");
-	fseek(_fd[i], 0, SEEK_END);
-	_imgSize[i] = ftell(_fd[i]);
-	fseek(_fd[i], 0, SEEK_SET);
-	ADM_assert(_fd[i] != NULL);
-    }
+	for (uint32_t i = 0; i < _nb_file; i++)
+	{
+		fd = openFrameFile(i);
+		ADM_assert(fd != NULL);
 
-    delete[]name;
-    delete[]extension;
+		fseek(fd, 0, SEEK_END);
+		_imgSize[i] = ftell(fd);
 
+		fclose(fd);
+	}
 
+	fd = openFrameFile(0);
+
+	delete [] name;
+	delete [] extension;
+
     //
     //      Image is bmp type
     //________________________
@@ -230,17 +247,19 @@
 	{
 	    ADM_BITMAPINFOHEADER bmph;
 
-	    fread(&s16, 2, 1, _fd[0]);
+		fread(&s16, 2, 1, fd);
 	    if (s16 != 0x4D42) {
 		printf("\n incorrect bmp sig.\n");
+		fclose(fd);
 		return 0;
 	    }
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&s32, 4, 1, _fd[0]);
-	    fread(&bmph, sizeof(bmph), 1, _fd[0]);
+		fread(&s32, 4, 1, fd);
+		fread(&s32, 4, 1, fd);
+		fread(&s32, 4, 1, fd);
+		fread(&bmph, sizeof(bmph), 1, fd);
 	    if (bmph.biCompression != 0) {
 		printf("\ncannot handle compressed bmp\n");
+		fclose(fd);
 		return 0;
 	    }
 	    _offset = bmph.biSize + 14;
@@ -258,36 +277,38 @@
 	    uint16_t tag = 0, count = 0, off;
 
 	    _offset = 0;
-	    fseek(_fd[0], 0, SEEK_SET);
-	    read16(_fd[0]);	// skip jpeg ffd8
+	    fseek(fd, 0, SEEK_SET);
+	    read16(fd);	// skip jpeg ffd8
 	    while (count < 10 && tag != 0xFFC0) {
 
-		tag = read16(_fd[0]);
+		tag = read16(fd);
 		if ((tag >> 8) != 0xff) {
 		    printf("invalid jpeg tag found (%x)\n", tag);
 		}
 		if (tag == 0xFFC0) {
-		    read16(_fd[0]);	// size
-		    read8(_fd[0]);	// precision
-		    h = read16(_fd[0]);
-		    w = read16(_fd[0]);
+		    read16(fd);	// size
+		    read8(fd);	// precision
+		    h = read16(fd);
+		    w = read16(fd);
                     if(w&1) w++;
                     if(h&1) h++;
 		} else {
 
-		    off = read16(_fd[0]);
+		    off = read16(fd);
 		    if (off < 2) {
 			printf("Offset too short!\n");
+			fclose(fd);
 			return 0;
 		    }
 		    aprintf("Found tag : %x , jumping %d bytes\n", tag,
 			    off);
-		    fseek(_fd[0], off - 2, SEEK_CUR);
+		    fseek(fd, off - 2, SEEK_CUR);
 		}
 		count++;
 	    }
 	    if (tag != 0xffc0) {
 		printf("Cannot fint start of frame\n");
+		fclose(fd);
 		return 0;
 	    }
 	    printf("\n %lu x %lu..\n", w, h);
@@ -298,20 +319,21 @@
 	{
 	    ADM_BITMAPINFOHEADER bmph;
 
-	    fseek(_fd[0], 10, SEEK_SET);
+	    fseek(fd, 10, SEEK_SET);
 
 #define MK32() (fcc_tab[0]+(fcc_tab[1]<<8)+(fcc_tab[2]<<16)+ \
 						(fcc_tab[3]<<24))
 
-	    fread(fcc_tab, 4, 1, _fd[0]);
+	    fread(fcc_tab, 4, 1, fd);
 	    _offset = MK32();
 	    // size, width height follow as int32 
-	    fread(&bmph, sizeof(bmph), 1, _fd[0]);
+	    fread(&bmph, sizeof(bmph), 1, fd);
 #ifdef ADM_BIG_ENDIAN
 	    Endian_BitMapInfo(&bmph);
 #endif
 	    if (bmph.biCompression != 0) {
 		printf("\ncannot handle compressed bmp\n");
+		fclose(fd);
 		return 0;
 	    }
 	    w = bmph.biWidth;
@@ -325,22 +347,23 @@
 	case PIC_PNG:
 	    {
     	     _offset = 0;
-	         fseek(_fd[0], 0, SEEK_SET);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-	         read32(_fd[0]);
-    	     w=read32(_fd[0]);;
-    	     h=read32(_fd[0]);;
+			 fseek(fd, 0, SEEK_SET);
+			 read32(fd);
+			 read32(fd);
+			 read32(fd);
+			 read32(fd);
+			 w=read32(fd);
+			 h=read32(fd);
     	     // It is big endian
     	     printf("Png seems to be %d x %d \n",w,h);
-    	     break;
 	    }
 	    break;
     default:
 	ADM_assert(0);
     }
 
+	fclose(fd);
+
 //_______________________________________
 //              Now build header info
 //_______________________________________
@@ -405,5 +428,12 @@
     *flags = AVI_KEY_FRAME;
     return 1;
 }
-//****************************************************************
-//EOF
+
+FILE* picHeader::openFrameFile(uint32_t frameNum)
+{
+	char filename[250];
+
+	sprintf(filename, _fileMask, frameNum + _first);
+
+	return fopen(filename, "rb");
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-15 13:50:12 UTC (rev 4100)
@@ -36,24 +36,25 @@
 class picHeader         :public vidHeader
 {
 protected:
+	char *_fileMask;
+
 					uint32_t 		_nb_file;
        					uint32_t 		_first,_offset,_w,_h;
 
-            				FILE 		**_fd;
 					uint32_t		*_imgSize;
-
 					uint32_t 		_type;
 
 					uint32_t    read32(FILE *fd);
 					uint16_t    read16(FILE *fd);
 					uint8_t     read8(FILE *fd);
+					FILE* openFrameFile(uint32_t frameNum);
 
 public:
 //  static int checkFourCC(uint8_t *in, uint8_t *fourcc);
 
 virtual   void 				Dump(void) {};
 
-			picHeader( void ) {_nb_file=0;_fd=NULL;_imgSize=NULL;};
+			picHeader( void );
        		    ~picHeader(  ) { };
 // AVI io
 virtual 	uint8_t			open(char *name);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-15 13:50:12 UTC (rev 4100)
@@ -43,7 +43,7 @@
 static uint32_t videoDuration;
 static uint32_t track1, track2;
 
-uint32_t numberOfVideoFrames;
+static uint32_t numberOfVideoFrames;
 
 static uint32_t videoSize,videoBitrate;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-06-15 13:50:12 UTC (rev 4100)
@@ -1,19 +1,12 @@
 SET(ADM_LIB ADM_dialogQt4)
 
 SET(uiFiles
-	about.ui    encoding.ui    license.ui
-	jobs.ui  props.ui    vobsub.ui  working.ui)
+	about.ui  calculator.ui  encoding.ui  license.ui
+	jobs.ui  props.ui  vobsub.ui  working.ui)
 
 SET(headers
-	Q_about.h    Q_encoding.h  
-	Q_license.h  Q_jobs.h  Q_props.h    Q_vobsub.h  Q_working.h  T_index_pg.h)
-if(false)
-IF (USE_FREETYPE)
-	SET(uiFiles ${uiFiles} srt.ui)
-	SET(headers ${headers} Q_srt.h)
-	SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} Q_srt.cpp)
-ENDIF (USE_FREETYPE)
-endif(false)
+	Q_about.h  Q_calculator.h  Q_encoding.h
+	Q_license.h  Q_jobs.h  Q_props.h  Q_vobsub.h  Q_working.h  T_index_pg.h)
 
 QT4_WRAP_UI(${ADM_LIB}_headers ${uiFiles})
 QT4_WRAP_CPP(${ADM_LIB}_source ${headers})
@@ -21,7 +14,7 @@
 
 SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS}
 	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  Q_about.cpp  
-        Q_license.cpp Q_encoding.cpp
+	Q_calculator.cpp  Q_encoding.cpp  Q_license.cpp
 	Q_jobs.cpp  Q_props.cpp   Q_vobsub.cpp  Q_working.cpp   T_index_pg.cpp
 	alert_qt4.cpp  DIA_busy.cpp  DIA_none.cpp  DIA_xvid4.cpp  OCR_none.cpp)
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2008-06-15 13:50:12 UTC (rev 4100)
@@ -36,7 +36,6 @@
 uint8_t DIA_audioCodec( AUDIOENCODER *codec ) {return 0;}
 uint8_t DIA_quota(char *) {return 0;}
 uint8_t DIA_RecentFiles( char **name ){return 0;}
-void    DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate ){}
 uint8_t initGUI( void ) {return 1;}
 void destroyGUI(void) {}
 uint8_t DIA_glyphEdit(void){ return 0;};

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp (from rev 4099, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-15 13:50:12 UTC (rev 4100)
@@ -0,0 +1,259 @@
+/***************************************************************************
+                             Bitrate calculator
+                             ------------------
+
+    begin                : Sat Jun 14 2008
+    copyright            : (C) 2008 by gruntster/mean
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include <math.h>
+
+#include "Q_calculator.h"
+
+#include "avi_vars.h"
+#include "ADM_videoFilter.h"
+#include "ADM_audio/aviaudio.hxx"
+#include "ADM_audiofilter/audioeng_buildfilters.h"
+#include "ADM_video/ADM_vidMisc.h"
+#include "ADM_encoder/adm_encConfig.h"
+
+calculatorDialog::calculatorDialog()
+{
+	ui.setupUi(this);
+
+	connect(ui.formatComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(comboBox_currentIndexChanged(int)));
+	connect(ui.mediumComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(mediumComboBox_currentIndexChanged(int)));
+	connect(ui.customSizeSpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+	connect(ui.audioTrack1SpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+	connect(ui.audioTrack2SpinBox, SIGNAL(valueChanged(int)), this, SLOT(spinBox_valueChanged(int)));
+
+	float duration = 0;
+	aviInfo info;
+	uint16_t mm, hh, ss, ms;
+	unsigned int track1 = 0;
+
+	if (frameStart < frameEnd)
+		_videoFrameCount = frameEnd - frameStart;
+	else
+		_videoFrameCount = frameStart - frameEnd;
+
+	duration = ((float)video_body->getTime(_videoFrameCount) / 1000.);
+
+	if (duration < 0)
+		duration = -duration;
+
+	_videoDuration = (uint32_t)ceil(duration);
+
+	video_body->getVideoInfo(&info);
+	frame2time(_videoFrameCount, info.fps1000, &hh, &mm, &ss, &ms);
+
+	ui.durationLabel->setText(QString("%1:%2:%3").arg(hh, 2, 10, QLatin1Char('0')).arg(mm, 2, 10, QLatin1Char('0')).arg(ss, 2, 10, QLatin1Char('0')));
+
+	if (audioProcessMode() && currentaudiostream)
+	{
+		AVDMGenericAudioStream *stream = buildAudioFilter(currentaudiostream, 0);
+
+		if (stream)
+			track1 = (stream->getInfo()->byterate * 8) / 1000;
+
+		deleteAudioFilter(stream);
+	}
+	else if(currentaudiostream)
+		track1 = (currentaudiostream->getInfo()->byterate * 8) / 1000;
+
+	ui.audioTrack1SpinBox->setValue(track1);
+
+	update();
+}
+
+calculatorDialog::~calculatorDialog()
+{
+}
+
+void calculatorDialog::comboBox_currentIndexChanged(int index)
+{
+	update();
+}
+
+void calculatorDialog::mediumComboBox_currentIndexChanged(int value)
+{
+	ui.customSizeLabel->setEnabled(value == 5);
+	ui.customSizeSpinBox->setEnabled(value == 5);
+	ui.customSizeMbLabel->setEnabled(value == 5);
+
+	update();
+}
+
+void calculatorDialog::spinBox_valueChanged(int value)
+{
+	update();
+}
+
+void calculatorDialog::update(void)
+{
+	unsigned int track1, track2;
+	uint32_t audioSize;
+	uint32_t totalSize;
+	aviInfo info;
+
+	video_body->getVideoInfo(&info);
+
+	track1 = ui.audioTrack1SpinBox->value();
+	track2 = ui.audioTrack2SpinBox->value();
+
+	// kb->Byte
+	audioSize = ((((track1 + track2) * 1000) / 8) * _videoDuration) >> 20;
+
+	ui.audioSizeLabel->setText(QString("%1").arg(audioSize));
+
+	// Compute total size
+	unsigned int s74, s80, dvd;
+	int formatIndex = ui.formatComboBox->currentIndex();
+
+	if (formatIndex == 2)
+	{ 
+		// Mpeg
+		s74 = 730;
+		s80 = 790;
+		dvd = 4300;
+	}
+	else
+	{
+		//AVI or OGM
+		s74 = 650;
+		s80 = 700;
+		dvd = 4300;
+	}
+
+	int mediumIndex = ui.mediumComboBox->currentIndex();
+
+	switch(mediumIndex)
+	{
+		case 0:
+			totalSize = s80;
+			break;
+		case 1:
+			totalSize = 2 * s80;
+			break;
+		case 2:
+			totalSize = s74;
+			break;
+		case 3:
+			totalSize= 2 * s74;
+			break;
+		case 4:
+			totalSize = dvd;
+			break;
+		case 5:
+			totalSize = ui.customSizeSpinBox->value();
+			break;
+	}
+
+	ui.totalSizeLabel->setText(QString("%1").arg(totalSize));
+
+	// Compute muxing overhead size
+	unsigned int muxingOverheadSize;
+	int numberOfAudioTracks = 0;
+	int numberOfChunks;
+
+	switch (formatIndex)
+	{ 
+		case 0:
+			// AVI
+			// Muxing overhead is 8 + 32 = 40 bytes per chunk.
+			// More or less: numberOfChunks = (x + 1) * _videoFrameCount,
+			// where x - the number of audio tracks
+			if (track1 != 0)
+				numberOfAudioTracks++;
+
+			if (track2 != 0)
+				numberOfAudioTracks++;
+
+			numberOfChunks = (numberOfAudioTracks + 1) * _videoFrameCount;
+			muxingOverheadSize = (unsigned int)ceil((numberOfChunks * 40) / 1048576.0);
+			break;
+		case 1:
+			// OGM
+			// Muxing overhead is 1.1% to 1.2% of (videoSize + audioSize)
+			muxingOverheadSize = (unsigned int)ceil(totalSize - totalSize / 1.012);
+			break;
+		case 2:
+			// MPEG
+			// Muxing overhead is 1% to 2% of (videoSize + audioSize)
+			muxingOverheadSize = (unsigned int)ceil(totalSize - totalSize / 1.02);
+			break;
+	}
+
+	unsigned int videoSize = 0;
+
+	// and compute
+	if (audioSize + muxingOverheadSize >= totalSize)
+		videoSize = 0;
+	else
+		videoSize = totalSize - audioSize - muxingOverheadSize;
+
+	unsigned int picSize;
+
+	// Compute average bps
+	float avg;
+	float bpp;
+
+	avg = (videoSize * 1024. * 1024.) / _videoDuration;
+
+	// now we have byte /sec, convert to kb per sec
+	avg = (avg * 8) / 1000;
+	ui.videoBitrateLabel->setText(QString("%1").arg((unsigned int)avg));
+	ui.videoSizeLabel->setText(QString("%1").arg(videoSize));
+
+	// Bpp
+	bpp = avg * 1000000.;  // kbit->bit + compensate for fps1000
+
+	// Fetch info from filter
+	if(videoProcessMode())
+		picSize = getPictureSize();
+	else
+		picSize = info.width * info.height;
+
+	bpp = (bpp / picSize) / info.fps1000;
+
+	ui.bppLabel->setText(QString("%1").arg(bpp, 0, 'g', 3));
+}
+
+unsigned int calculatorDialog::getPictureSize(void)
+{
+	AVDMGenericVideoStream *last = getLastVideoFilter();
+
+	return last->getInfo()->width * last->getInfo()->height;
+}
+
+unsigned int calculatorDialog::videoSize(void)
+{
+	return atoi(ui.videoSizeLabel->text().toUtf8().constData());
+}
+
+unsigned int calculatorDialog::videoBitrate(void)
+{
+	return atoi(ui.videoBitrateLabel->text().toUtf8().constData());
+}
+
+void DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate)
+{
+	if (!avifileinfo)
+		return;
+
+	calculatorDialog dialog;
+
+	if (dialog.exec() == QDialog::Accepted)
+		videoCodecSetFinalSize(dialog.videoSize());
+
+	*sizeInMeg = dialog.videoSize();
+	*avgBitrate = dialog.videoBitrate();
+}

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.h	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.h	2008-06-15 13:50:12 UTC (rev 4100)
@@ -0,0 +1,30 @@
+#ifndef Q_calculator_h
+#define Q_calculator_h
+
+#include "ui_calculator.h"
+
+class calculatorDialog : public QDialog
+{
+	Q_OBJECT
+
+private:
+	Ui_CalculatorDialog ui;
+	unsigned int _videoFrameCount;
+	unsigned int _videoDuration;
+
+	void update(void);
+	unsigned int getPictureSize(void);
+
+public:
+	calculatorDialog();
+	~calculatorDialog();
+
+	unsigned int videoSize(void);
+	unsigned int videoBitrate(void);
+
+private slots:
+	void comboBox_currentIndexChanged(int index);
+	void mediumComboBox_currentIndexChanged(int index);
+	void spinBox_valueChanged(int value);
+};
+#endif	// Q_calculator_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui (from rev 4099, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-15 13:50:12 UTC (rev 4100)
@@ -35,7 +35,7 @@
 PROCESS(actionSave_2,ACT_SaveWave) \
 PROCESS(actionEncoder_2,ACT_SelectEncoder) \
 PROCESS(actionFilters_2,ACT_AudioFilters) \
-PROCESS(actionCalculator,ACT_DUMMY) \
+PROCESS(actionCalculator,ACT_Bitrate) \
 PROCESS(actionRebuild_I_B_Frames,ACT_RebuildKF) \
 PROCESS(actionBitrate_histogram,ACT_BitRate) \
 PROCESS(actionScan_for_black_frames,ACT_AllBlackFrames) \

Modified: branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts	2008-06-15 13:50:12 UTC (rev 4100)
@@ -1,6 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE TS><TS version="1.1" language="it">
-<defaultcodec></defaultcodec>
 <context>
     <name></name>
     <message>
@@ -846,7 +845,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="60"/>
         <source>Kernel interpolation</source>
-        <translation>Interpolazione Kernel</translation>
+        <translation>Interpolazione kernel</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="61"/>
@@ -951,7 +950,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="102"/>
         <source>_Denoise</source>
-        <translation>_Rimuovi interferenza</translation>
+        <translation>_Rimuovi rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp" line="103"/>
@@ -1332,7 +1331,7 @@
         <translation>_Modalit?:</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="196"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="189"/>
         <source>Codec Error</source>
         <translation>Errore codec</translation>
     </message>
@@ -1410,7 +1409,7 @@
         <translation>PSP</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="283"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="277"/>
         <source>FLV</source>
         <translation>FLV</translation>
     </message>
@@ -1530,17 +1529,17 @@
         <translation>Sconosciuto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="87"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="78"/>
         <source>Output file error</source>
         <translation>Errore file di uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="87"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="78"/>
         <source>Could not open &quot;%s&quot; for writing.</source>
         <translation>Impossibile aprire &quot;%s&quot; per la scrittura.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="105"/>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="100"/>
         <source>Problem loading sub</source>
         <translation>Problema di caricamento sottotitoli</translation>
     </message>
@@ -1740,27 +1739,27 @@
 Spostare il segnalibro A.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="151"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="145"/>
         <source>Unsupported video</source>
         <translation>Video non supportato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="151"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="145"/>
         <source>Only FLV1 and VP6 video are supported</source>
         <translation>Sono supportati solo i video FLV1 e VP6</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="178"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="172"/>
         <source>Unsupported audio</source>
         <translation>Audio non supportato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="173"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="167"/>
         <source>Audio must be mp3 for flv output.</source>
         <translation>L&apos;audio di un video flv deve essere mp3.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="178"/>
+        <location filename="../avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp" line="172"/>
         <source>Frequency must be 44100, 22050 or 11025 Hz.</source>
         <translation>La frequenza deve essere 44100, 22050 o 11025 Hz.</translation>
     </message>
@@ -2038,7 +2037,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp" line="120"/>
         <source>Noise Reduction</source>
-        <translation>Riduzione interferenza</translation>
+        <translation>Riduzione rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp" line="121"/>
@@ -2166,62 +2165,62 @@
         <translation>Filtro video parziale</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp" line="822"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp" line="851"/>
         <source>%c (%02d)</source>
         <translation>%c (%02d)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="92"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="85"/>
         <source>Select idx file:</source>
         <translation>Seleziona un file idx:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="210"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="202"/>
         <source>Use glyphset (optional):</source>
         <translation>Usa set di glifi (opzionale):</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="203"/>
         <source>Output SRT file</source>
         <translation>File SRT in uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="222"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="214"/>
         <source>Select input and ouput files</source>
         <translation>Seleziona file di ingresso e di uscita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="246"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="238"/>
         <source>The idx/sub file does not exist.</source>
         <translation>Il file idx/sub non esiste.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="239"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="231"/>
         <source>Please Select a valid output SRT file.</source>
         <translation>Seleziona un file SRT in uscita valido.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="255"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="247"/>
         <source>Cannot load the glyphset file.</source>
         <translation>Impossibile caricare il set di glifi.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="158"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="149"/>
         <source>Save Glyph</source>
         <translation>Salva glifo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="200"/>
         <source>Input TS:</source>
         <translation>TS in ingresso:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="209"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="201"/>
         <source>Subtitle PID:</source>
         <translation>PID sottotitoli:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="233"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="225"/>
         <source>Please Select a valid TS file.</source>
         <translation>Seleziona un file TS valido.</translation>
     </message>
@@ -2238,7 +2237,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp" line="189"/>
         <source>_Use libavcodec MPEG-2 decoder</source>
-        <translation>_Usa decodificatore libavcodec MPEG-2</translation>
+        <translation>_Usa libavcodec come decodificatore MPEG-2</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp" line="190"/>
@@ -3177,24 +3176,24 @@
         <translation>? necessaria una traccia audio per creare questo tipo di file</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="121"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="114"/>
         <source>You don&apos;t have LAME!.
 It is needed to create FLV  video.</source>
         <translation>Non disponi di LAME!
 ? necessario per creare video FLV.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="135"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="128"/>
         <source>Cannot select FLV1  codec.</source>
         <translation>Impossibile selezionare il codec FLV1.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="162"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="155"/>
         <source>Cannot select mpeg4 sp codec.</source>
         <translation>Impossibile selezionare il codec mpeg4 sp.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="197"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="190"/>
         <source>You don&apos;t have FAAC!.
 It is needed to create PSP compatible video.</source>
         <translation>Non disponi di FAAC.
@@ -3298,7 +3297,7 @@
         <translation>Prova uinteger</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="93"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="86"/>
         <source>Use GlyphSet (optional):</source>
         <translation>Usa set di glifi (opzionale):</translation>
     </message>
@@ -3308,27 +3307,27 @@
         <translation>Seleziona il set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="203"/>
         <source>Save SRT file</source>
         <translation>Salva il file SRT</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="276"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="268"/>
         <source>GlyphSet filename</source>
         <translation>Nome file del set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="276"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="268"/>
         <source>Save GlyphSet file</source>
         <translation>Salva il set di glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="200"/>
         <source>Select TS file</source>
         <translation>Seleziona un file TS</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="278"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp" line="270"/>
         <source>Save GlyphSet</source>
         <translation>Salva il set di glifi</translation>
     </message>
@@ -3820,7 +3819,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="130"/>
         <source>Reduce noise, smooth image, increase compressibility.</source>
-        <translation>Riduce l&apos;interferenza, leviga le immagini, aumenta la comprimibilit?.</translation>
+        <translation>Riduce il rumore, leviga le immagini, aumenta la comprimibilit?.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="131"/>
@@ -3850,12 +3849,12 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="134"/>
         <source>Vlad59&apos;s Avisynth port of Jim Casaburi&apos;s denoiser.</source>
-        <translation>Port Avisynth di Vlad59 del filtro di rimozione di interferenza di Jim Casaburi.</translation>
+        <translation>Port Avisynth di Vlad59 del filtro di rimozione del rumore di Jim Casaburi.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="136"/>
         <source>Denoise</source>
-        <translation>Rimozione interferenza</translation>
+        <translation>Rimozione rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="136"/>
@@ -3870,7 +3869,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="137"/>
         <source>Light denoiser.</source>
-        <translation>Rimozione interferenza leggera.</translation>
+        <translation>Rimozione rumore leggera.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="139"/>
@@ -3880,7 +3879,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="139"/>
         <source>Chroma noise reduction filter by MarcFD/Tritical.</source>
-        <translation>Filtro di riduzione interferenza croma di MarcFD/Tritical.</translation>
+        <translation>Filtro di riduzione rumore croma di MarcFD/Tritical.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="141"/>
@@ -3920,7 +3919,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="148"/>
         <source>Sharpen edges without amplifying noise. By Donald Graft.</source>
-        <translation>Rende nitidi i margini senza amplificare l&apos;interferenza. Di Donald Graft.</translation>
+        <translation>Rende nitidi i margini senza amplificare il rumore. Di Donald Graft.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="149"/>
@@ -3950,7 +3949,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="152"/>
         <source>Mean (blur) kernel.</source>
-        <translation>Media (sfocatura) kernel.</translation>
+        <translation>Kernel media (sfocatura).</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="153"/>
@@ -3960,7 +3959,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="153"/>
         <source>Median kernel 3x3. Remove high frequency noise.</source>
-        <translation>Mediana kernel 3x3. Rimuove l&apos;interferenza ad alta frequenza.</translation>
+        <translation>Kernel mediana 3x3. Rimuove il rumore ad alta frequenza.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="154"/>
@@ -3970,7 +3969,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="154"/>
         <source>Median kernel 5x5. Good for reducing chroma noise.</source>
-        <translation>Mediana kernel 5x5. Riduce interferenza croma.</translation>
+        <translation>Kernel mediana 5x5. Riduce rumore croma.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="155"/>
@@ -4105,7 +4104,7 @@
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="188"/>
         <source>Apply operation like P&apos;=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant</source>
-        <translation>Applica operazioni come P&apos;=P*A, P-A, P+A, ecc. usando avvolgimento, media mobile, immagine da file, o costante.</translation>
+        <translation>Applica operazioni come P&apos;=P*A, P-A, P+A, ecc. usando convoluzione, media mobile, immagine da file, o costante.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_filter/filter_declaration.cpp" line="189"/>
@@ -4168,12 +4167,7 @@
         <translation>Win32</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="63"/>
-        <source>You need Xvid4 and either LAME or FAAC support for the iPod profile</source>
-        <translation>Hai bisogno del supporto di Xvid4 e di LAME o FAAC per il profilo Ipod</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/gui_autodrive.cpp" line="74"/>
+        <location filename="../avidemux/gui_autodrive.cpp" line="72"/>
         <source>Cannot select the MPEG-4 SP codec.</source>
         <translation>Impossibile selezionare il codec MPEG-4 SP.</translation>
     </message>
@@ -4240,7 +4234,7 @@
     <message>
         <location filename="../avidemux/ADM_audiofilter/audiofilter_buildchain.cpp" line="417"/>
         <source>Not activated.</source>
-        <translation>Non attivo.</translation>
+        <translation>Non attivato.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_encoder/ADM_encCodecDesc.h" line="13"/>
@@ -4527,6 +4521,40 @@
         <source>DVD (mpeg2enc)</source>
         <translation>DVD (mpeg2enc)</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="92"/>
+        <source>Input file error</source>
+        <translation>Errore file di ingresso</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="86"/>
+        <source>Unknown source type</source>
+        <translation>Tipo di sorgente sconosciuto</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="92"/>
+        <source>Bitmap source failed</source>
+        <translation>Sorgente bitmap fallita</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_ocr/ADM_ocrEngine.cpp" line="100"/>
+        <source>No subs</source>
+        <translation>Nessun sottotitolo</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_autodrive.cpp" line="63"/>
+        <source>Xvid4 and FAAC support is required for the iPod profile.</source>
+        <translation>Il supporto di Xvid4 e FAAC ? richiesto per il profilo iPod.</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="82"/>
+        <source>Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?
+
+You can do it later with &quot;Audio -&gt; Build VBR Time Map&quot;.</source>
+        <translation>Avidemux ha rilevato un audio MP3 VBR in questo file. Per mantenere la sincronizzazione audio/video, ? necessaria la time map. Crearla ora?
+
+Puoi farlo successivamente con \&quot;Audio -&gt; Crea time map VBR\&quot;.</translation>
+    </message>
 </context>
 <context>
     <name>ADMImage</name>
@@ -4644,7 +4672,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidDenoise.cpp" line="397"/>
         <source>Denoise</source>
-        <translation>Rimuovi interferenza</translation>
+        <translation>Rimuovi rumore</translation>
     </message>
 </context>
 <context>
@@ -4676,17 +4704,17 @@
 <context>
     <name>ADMVideoFlux</name>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="133"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="134"/>
         <source>_Temporal threshold:</source>
         <translation>Soglia _temporale:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="134"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="135"/>
         <source>_Spatial threshold:</source>
         <translation>Soglia _spaziale:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="138"/>
+        <location filename="../avidemux/ADM_videoFilter/ADM_vidFlux.cpp" line="139"/>
         <source>FluxSmooth</source>
         <translation>FluxSmooth</translation>
     </message>
@@ -4807,7 +4835,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp" line="309"/>
         <source>Large Median 5x5</source>
-        <translation>Large Median 5x5</translation>
+        <translation>Mediana grande 5x5</translation>
     </message>
 </context>
 <context>
@@ -5150,7 +5178,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidStabilize.cpp" line="63"/>
         <source>Stabilize Threshold</source>
-        <translation>Stabilizza soglia</translation>
+        <translation>Soglia di stabilizzazione</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidStabilize.cpp" line="66"/>
@@ -5264,7 +5292,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="275"/>
         <source>A = convolve(P); Load convolution kernel from file</source>
-        <translation>A = avvolgi(P); carica nucleo di avvolgimento da file</translation>
+        <translation>A = avvolgi(P); carica nucleo di convoluzione da file</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="277"/>
@@ -5299,7 +5327,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="324"/>
         <source>Input _File (image or convolution kernel):</source>
-        <translation>_File di ingresso (immagine o nucleo di avvolgimento):</translation>
+        <translation>_File di ingresso (immagine o nucleo di convoluzione):</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="328"/>
@@ -5335,7 +5363,8 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="360"/>
         <source>Init By _Rolling (compute head start using a rolling average rather than a straight average)</source>
-        <translation>Inizializza con media mobile (elabora partenza facilitata usando una media mobile invece di una media diretta)</translation>
+        <translation>Inizializza con media mobile (elabora partenza facilitata
+usando una media mobile invece di una media diretta)</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp" line="364"/>
@@ -5483,7 +5512,7 @@
     <message>
         <location filename="../avidemux/ADM_audiocodec/ADM_codecwma.cpp" line="200"/>
         <source>Cannot open AMR codec.</source>
-        <translation>Impossibile aprire i codec AMR.</translation>
+        <translation>Impossibile aprire il codec AMR.</translation>
     </message>
 </context>
 <context>
@@ -5496,7 +5525,7 @@
     <message>
         <location filename="../avidemux/ADM_audiocodec/ADM_codecwma.cpp" line="88"/>
         <source>Cannot open WMA2 codec.</source>
-        <translation>Impossibile aprire i codec WMA2.</translation>
+        <translation>Impossibile aprire il codec WMA2.</translation>
     </message>
 </context>
 <context>
@@ -5514,7 +5543,7 @@
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edFrameType.cpp" line="63"/>
         <source>DivX 5 + packed?</source>
-        <translation>DivX 5 + compresso?</translation>
+        <translation>Compresso con DivX5+?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edFrameType.cpp" line="93"/>
@@ -5549,7 +5578,7 @@
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="408"/>
         <source>May be related to an old index file.</source>
-        <translation>Potrebbe essere relativo a un vecchio file di indice.</translation>
+        <translation>Potrebbe essere correlato a un vecchio file di indice.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="415"/>
@@ -5576,25 +5605,6 @@
         <translation>Creare la time map VBR?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>Use that mode</source>
-        <translation>Utilizza questa modalit?</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>H264 detected</source>
-        <translation>H264 rilevato</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
-        <source>If the file is using bframe as reference, it can lead to crash or stutteting.
-Avidemux can use another mode which is safed but &lt;b&gt;YOU WILL LOOSE FRAME ACCURACY&lt;/b&gt;.
-Do you want to use that mode ?</source>
-        <translation>Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash.
-Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura ma &lt;b&gt;PERDERAI LA PRECISIONE DEI FOTOGRAMMI&lt;/b&gt;.
-Vuoi usare quella modalit??</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="712"/>
         <source>Packed Bitstream detected</source>
         <translation>Flusso di bit compresso rilevato</translation>
@@ -5656,6 +5666,25 @@
         <source>Indexing failed</source>
         <translation>Indicizzazione fallita</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>Use safe mode</source>
+        <translation>Usa modalit? sicura</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>H.264 detected</source>
+        <translation>H.264 rilevato</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <source>If the file is using B-frames as reference it can lead to a crash or stuttering.
+Avidemux can use another mode which is safe but &lt;b&gt;YOU WILL LOSE FRAME ACCURACY&lt;/b&gt;.
+Do you want to use that mode?</source>
+        <translation>Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash o una riproduzione a scatti.
+Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura ma &lt;b&gt;PERDERAI PRECISIONE NEI FOTOGRAMMI&lt;/b&gt;.
+Vuoi usare questa modalit??</translation>
+    </message>
 </context>
 <context>
     <name>ADM_Qbitrate</name>
@@ -5844,7 +5873,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp" line="472"/>
         <source>Fast Convolution</source>
-        <translation>Avvolgimento veloce</translation>
+        <translation>Convoluzione veloce</translation>
     </message>
 </context>
 <context>
@@ -6262,7 +6291,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui" line="111"/>
         <source>Block Adaptative</source>
-        <translation>Blocco adattativo</translation>
+        <translation>Adattativo a blocchi</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui" line="118"/>
@@ -6793,7 +6822,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="268"/>
         <source>Noise</source>
-        <translation>Interferenza</translation>
+        <translation>Rumore</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="276"/>
@@ -8485,7 +8514,7 @@
 <context>
     <name>lavMuxer</name>
     <message>
-        <location filename="../avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp" line="376"/>
+        <location filename="../avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp" line="379"/>
         <source>Incompatible frame rate</source>
         <translation>Frame rate incompatibile</translation>
     </message>
@@ -8612,12 +8641,12 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="85"/>
         <source>_Noise:</source>
-        <translation>_Interferenza:</translation>
+        <translation>_Rumore:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="85"/>
         <source>If pixels are closer than noise, they are considered to be the same</source>
-        <translation>Se i pixel sono pi? vicini dell&apos;interferenza, sono considerati identici</translation>
+        <translation>Se i pixel sono pi? vicini del rumore, sono considerati identici</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp" line="86"/>
@@ -8655,7 +8684,7 @@
     <message>
         <location filename="../avidemux/ADM_video/ADM_vidFieldUnblend.cpp" line="81"/>
         <source>Do you want to print metrics on screen ?</source>
-        <translation>Vuoi mostrare le misure sullo schermo?</translation>
+        <translation>Vuoi stampare le misure sullo schermo?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="87"/>
@@ -8670,12 +8699,12 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="90"/>
         <source>_Noise:</source>
-        <translation>_Interferenza:</translation>
+        <translation>_Rumore:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="90"/>
         <source>If pixels are closer than noise, they are considered to be the same</source>
-        <translation>Se i pixel sono pi? vicini dell&apos;interferenza, sono considerati identici</translation>
+        <translation>Se i pixel sono pi? vicini del rumore, sono considerati identici</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="91"/>
@@ -8690,7 +8719,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="92"/>
         <source>_Show metrics</source>
-        <translation>_Mostra misure</translation>
+        <translation>_Mostra metrica</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp" line="92"/>

Modified: branches/avidemux_2.5_branch_gruntster/po/it.po
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/it.po	2008-06-15 12:50:52 UTC (rev 4099)
+++ branches/avidemux_2.5_branch_gruntster/po/it.po	2008-06-15 13:50:12 UTC (rev 4100)
@@ -3,7 +3,7 @@
 "Project-Id-Version: avidemux\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-10-04 22:09+0300\n"
-"PO-Revision-Date: 2008-05-03 15:18+0100\n"
+"PO-Revision-Date: 2008-06-13 00:28+0100\n"
 "Last-Translator: \n"
 "Language-Team: it\n"
 "MIME-Version: 1.0\n"
@@ -59,8 +59,8 @@
 msgstr "PSP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:194
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:283
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:277
 msgid "FLV"
 msgstr "FLV"
 
@@ -163,9 +163,9 @@
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:265
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:286
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:191
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:259
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:280
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
@@ -227,11 +227,11 @@
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:88
 msgid "Cannot open WMA2 codec."
-msgstr "Impossibile aprire i codec WMA2."
+msgstr "Impossibile aprire il codec WMA2."
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:200
 msgid "Cannot open AMR codec."
-msgstr "Impossibile aprire i codec AMR."
+msgstr "Impossibile aprire il codec AMR."
 
 #: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
 msgid "Could not open OSS audio device"
@@ -321,11 +321,11 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 #: avidemux/gui_autodrive.cpp:62
-#: avidemux/gui_autodrive.cpp:74
-#: avidemux/gui_autodrive.cpp:120
-#: avidemux/gui_autodrive.cpp:135
-#: avidemux/gui_autodrive.cpp:162
-#: avidemux/gui_autodrive.cpp:196
+#: avidemux/gui_autodrive.cpp:72
+#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:128
+#: avidemux/gui_autodrive.cpp:155
+#: avidemux/gui_autodrive.cpp:189
 msgid "Codec Error"
 msgstr "Errore codec"
 
@@ -343,7 +343,7 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
 msgid "Not activated."
-msgstr "Non attivo."
+msgstr "Non attivato."
 
 #: avidemux/ADM_codecs/ADM_ffmp43.cpp:45
 msgid "Internal error finding codec"
@@ -367,7 +367,7 @@
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:63
 msgid "DivX 5 + packed?"
-msgstr "DivX 5 + compresso?"
+msgstr "Compresso con DivX5+?"
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:93
 msgid "Rebuilding Frames"
@@ -377,13 +377,23 @@
 msgid "Aborted"
 msgstr "Annullato"
 
+#: avidemux/ADM_editor/ADM_edit.cpp:82
+msgid ""
+"Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n"
+"\n"
+"You can do it later with \"Audio -> Build VBR Time Map\"."
+msgstr ""
+"Avidemux ha rilevato un audio MP3 VBR in questo file. Per mantenere la sincronizzazione audio/video, ? necessaria la time map. Crearla ora?\n"
+"\n"
+"Puoi farlo successivamente con \"Audio -> Crea time map VBR\"."
+
 #: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Formato file identificato ma non supportato..."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:408
 msgid "May be related to an old index file."
-msgstr "Potrebbe essere relativo a un vecchio file di indice."
+msgstr "Potrebbe essere correlato a un vecchio file di indice."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:415
 #, c-format
@@ -409,22 +419,22 @@
 msgstr "Creare la time map VBR?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
-msgstr "Utilizza questa modalit?"
+msgid "Use safe mode"
+msgstr "Usa modalit? sicura"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
-msgstr "H264 rilevato"
+msgid "H.264 detected"
+msgstr "H.264 rilevato"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
-"Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash.\n"
-"Avidemux pu? utilizzare un'altra modalit? pi? sicura ma <b>PERDERAI LA PRECISIONE DEI FOTOGRAMMI</b>.\n"
-"Vuoi usare quella modalit??"
+"Se il file sta utilizzando un fotogramma-B come riferimento pu? causare un crash o una riproduzione a scatti.\n"
+"Avidemux pu? utilizzare un'altra modalit? pi? sicura ma <b>PERDERAI PRECISIONE NEI FOTOGRAMMI</b>.\n"
+"Vuoi usare questa modalit??"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:712
 msgid "Packed Bitstream detected"
@@ -889,7 +899,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:130
 msgid "Reduce noise, smooth image, increase compressibility."
-msgstr "Riduce l'interferenza, leviga le immagini, aumenta la comprimibilit?."
+msgstr "Riduce il rumore, leviga le immagini, aumenta la comprimibilit?."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:80
@@ -901,7 +911,7 @@
 msgstr "Versione ad alta qualit? di denoise3d. Pi? lenta ma pi? precisa."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr "FluxSmooth"
 
@@ -916,13 +926,13 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:134
 msgid "Vlad59's Avisynth port of Jim Casaburi's denoiser."
-msgstr "Port Avisynth di Vlad59 del filtro di rimozione di interferenza di Jim Casaburi."
+msgstr "Port Avisynth di Vlad59 del filtro di rimozione del rumore di Jim Casaburi."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:136
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
 #: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:397
 msgid "Denoise"
-msgstr "Rimozione interferenza"
+msgstr "Rimozione rumore"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:136
 msgid "Port of Transcode DNR."
@@ -935,7 +945,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:137
 msgid "Light denoiser."
-msgstr "Rimozione interferenza leggera."
+msgstr "Rimozione rumore leggera."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:139
 msgid "Cnr2"
@@ -943,7 +953,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:139
 msgid "Chroma noise reduction filter by MarcFD/Tritical."
-msgstr "Filtro di riduzione interferenza croma di MarcFD/Tritical."
+msgstr "Filtro di riduzione rumore croma di MarcFD/Tritical."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:141
 msgid "MSmooth by Donald Graft"
@@ -977,7 +987,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:148
 msgid "Sharpen edges without amplifying noise. By Donald Graft."
-msgstr "Rende nitidi i margini senza amplificare l'interferenza. Di Donald Graft."
+msgstr "Rende nitidi i margini senza amplificare il rumore. Di Donald Graft."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:149
 msgid "asharp"
@@ -1001,7 +1011,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:152
 msgid "Mean (blur) kernel."
-msgstr "Media (sfocatura) kernel."
+msgstr "Kernel media (sfocatura)."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median"
@@ -1009,7 +1019,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median kernel 3x3. Remove high frequency noise."
-msgstr "Mediana kernel 3x3. Rimuove l'interferenza ad alta frequenza."
+msgstr "Kernel mediana 3x3. Rimuove rumore ad alta frequenza."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Median (5x5)"
@@ -1017,7 +1027,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Median kernel 5x5. Good for reducing chroma noise."
-msgstr "Mediana kernel 5x5. Riduce interferenza croma."
+msgstr "Kernel mediana 5x5. Riduce rumore croma."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:155
 msgid "Forced postprocessing"
@@ -1141,7 +1151,7 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:188
 msgid "Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant"
-msgstr "Applica operazioni come P'=P*A, P-A, P+A, ecc. usando avvolgimento, media mobile, immagine da file, o costante."
+msgstr "Applica operazioni come P'=P*A, P-A, P+A, ecc. usando convoluzione, media mobile, immagine da file, o costante."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:189
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:401
@@ -1262,7 +1272,7 @@
 msgid "Indexing"
 msgstr "Indicizzazione"
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:376
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:379
 msgid "Incompatible frame rate"
 msgstr "Frame rate incompatibile"
 
@@ -1314,14 +1324,14 @@
 #: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
 #: avidemux/gtk_gui.cpp:903
 #: avidemux/gtk_gui.cpp:1505
@@ -1375,19 +1385,36 @@
 msgid "Could not read \"%s\"."
 msgstr "Impossibile leggere \"%s\"."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 msgid "Output file error"
 msgstr "Errore file di uscita"
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "Impossibile aprire \"%s\" per la scrittura."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:105
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Input file error"
+msgstr "Errore file di ingresso"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+msgid "Unknown source type"
+msgstr "Tipo di sorgente sconosciuto"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Bitmap source failed"
+msgstr "Sorgente bitmap fallita"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
 msgid "Problem loading sub"
 msgstr "Problema di caricamento sottotitoli"
 
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
+msgid "No subs"
+msgstr "Nessun sottotitolo"
+
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "Errore file ifo"
@@ -1541,8 +1568,8 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:269
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:263
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
@@ -1655,7 +1682,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:149
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:203
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:176
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
 msgid "Filter init failed"
@@ -1683,7 +1710,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:207
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:201
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
@@ -1700,7 +1727,7 @@
 msgstr "Copia intelligente"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:183
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
 msgid "Cannot initialize the video stream"
 msgstr "Impossibile inizializzare il flusso video"
@@ -1711,8 +1738,8 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:179
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:215
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:233
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:332
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:227
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:326
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:214
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:337
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:421
@@ -1721,13 +1748,13 @@
 msgstr "Errore durante la codifica"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid "KeyFrame error"
 msgstr "Errore fotogramma chiave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid ""
 "The beginning frame is not a key frame.\n"
@@ -1736,28 +1763,28 @@
 "Il fotogramma iniziale non ? un fotogramma chiave.\n"
 "Spostare il segnalibro A."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Unsupported video"
 msgstr "Video non supportato"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Only FLV1 and VP6 video are supported"
 msgstr "Sono supportati solo i video FLV1 e VP6"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Unsupported audio"
 msgstr "Audio non supportato"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
 msgid "Audio must be mp3 for flv output."
 msgstr "L'audio di un video flv deve essere mp3."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
 msgstr "La frequenza deve essere 44100, 22050 o 11025 Hz."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:248
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:253
 msgid "Cannot initialize the audio stream"
 msgstr "Impossibile inizializzare il flusso audio"
@@ -2515,86 +2542,86 @@
 msgid "MJPEG Configuration"
 msgstr "Configurazione Mjpeg"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:85
 msgid "Select idx file:"
 msgstr "Seleziona un file idx:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
 msgid "Use GlyphSet (optional):"
 msgstr "Usa set di glifi (opzionale):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 msgid "Select GlyphSet file"
 msgstr "Seleziona il set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Output SRT file"
 msgstr "File SRT in uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Save SRT file"
 msgstr "Salva il file SRT"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:214
 msgid "Select input and ouput files"
 msgstr "Seleziona file di ingresso e di uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
 msgid "The idx/sub file does not exist."
 msgstr "Il file idx/sub non esiste."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
 msgid "Please Select a valid output SRT file."
 msgstr "Seleziona un file SRT in uscita valido."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 msgid "Cannot load the glyphset file."
 msgstr "Impossibile caricare il set di glifi."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "GlyphSet filename"
 msgstr "Nome file del set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "Save GlyphSet file"
 msgstr "Salva il set di glifi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:149
 msgid "Save Glyph"
 msgstr "Salva glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Input TS:"
 msgstr "TS in ingresso:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Select TS file"
 msgstr "Seleziona un file TS"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:201
 msgid "Subtitle PID:"
 msgstr "PID sottotitoli:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 msgid "Use glyphset (optional):"
 msgstr "Usa set di glifi (opzionale):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
 msgid "Please Select a valid TS file."
 msgstr "Seleziona un file TS valido."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:270
 msgid "Save GlyphSet"
 msgstr "Salva set di glifi"
 
@@ -2630,7 +2657,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "_Use libavcodec MPEG-2 decoder"
-msgstr "_Usa decodificatore libavcodec MPEG-2"
+msgstr "_Usa libavcodec come decodificatore MPEG-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 msgid "Create _OpenDML files"
@@ -3139,7 +3166,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
 msgid "_Denoise"
-msgstr "_Rimuovi interferenza"
+msgstr "_Rimuovi rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
@@ -3950,7 +3977,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
 msgid "Block Adaptative :"
-msgstr "Blocco adattativo: "
+msgstr "Adattativo a blocchi: "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
 msgid "Unknown flag :"
@@ -4107,7 +4134,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
 msgid "Chroma Noise Reduction 2"
-msgstr "Riduzione interferenza croma 2"
+msgstr "Riduzione rumore croma 2"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
 msgid "<b>Scene change Treshold</b>"
@@ -4233,7 +4260,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
 msgid "<b>frame2</b>"
-msgstr "<b>fotogramma2</b>"
+msgstr "<b>frame2</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:235
 msgid "Luma"
@@ -4958,7 +4985,7 @@
 msgid "Configure"
 msgstr "Configura"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:89
 msgid "none"
 msgstr "nessuno"
 
@@ -4966,6 +4993,14 @@
 msgid "Select .idx file"
 msgstr "Seleziona un file .idx"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+msgid "Wrong VobSub parametering"
+msgstr "Parametrizzazione VobSub errata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+msgid "The idx/sub file does not set."
+msgstr "Il file idx/sub non ? impostato."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
 msgid "VobSub Settings"
 msgstr "Impostazioni VobSub"
@@ -4976,7 +5011,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:227
 msgid "Select Language :"
-msgstr "Seleziona Lingua: "
+msgstr "Seleziona lingua: "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:241
 msgid "Select Sub"
@@ -5224,11 +5259,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:948
 msgid "Noise Reduction"
-msgstr "Riduzione interferenza"
+msgstr "Riduzione rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:957
 msgid "Set the amount of noise reduction"
-msgstr "Imposta il livello di riduzione interferenza"
+msgstr "Imposta il livello di riduzione rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:964
 msgid "Deblocking Filter"
@@ -5421,7 +5456,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1306
 msgid "Max QP Step"
-msgstr "Max Qp Step"
+msgstr "Max QP Step"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1320
 msgid "Enforce a minimum quantizer level"
@@ -5529,11 +5564,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1618
 msgid "Factor between I and P-frame Quants"
-msgstr "Fattore tra quantizzazione fotogrammi I e P"
+msgstr "Fattore tra quantizzatori fotogrammi I e P"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1625
 msgid "Factor between P and B-frame Quants"
-msgstr "Fattore tra quantizzazione fotogrammi P e B"
+msgstr "Fattore tra quantizzatori fotogrammi P e B"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1632
 msgid "Chroma QP Offset"
@@ -5572,7 +5607,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1697
 msgid "<b>Quantization Matrices</b>"
-msgstr "<b>Quantizzazione matrici</b>"
+msgstr "<b>Matrici quantizzazione</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1702
 msgid "More"
@@ -5621,27 +5656,27 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
 msgid "1- Very low"
-msgstr "1- Molto bassa"
+msgstr "1 - Molto bassa"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
 msgid "2- Low"
-msgstr "2- Bassa"
+msgstr "2 - Bassa"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
 msgid "3- Medium"
-msgstr "3- Media"
+msgstr "3 - Media"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
 msgid "4- High"
-msgstr "4- Alta"
+msgstr "4 - Alta"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
 msgid "5- Very High"
-msgstr "5- Molto alta"
+msgstr "5 - Molto alta"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
 msgid "6- Ultra High"
-msgstr "6- Ultra"
+msgstr "6 - Ultra"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
 msgid "H263 Quantizer"
@@ -6311,7 +6346,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:333
 msgid "Noise"
-msgstr "Interferenza"
+msgstr "Rumore"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:357
 msgid "Sharpness"
@@ -7021,7 +7056,7 @@
 
 #: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
 msgid "Do you want to print metrics on screen ?"
-msgstr "Vuoi mostrare le misure sullo schermo?"
+msgstr "Vuoi stampare le misure sullo schermo?"
 
 #: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
 #: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
@@ -7131,12 +7166,12 @@
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
 msgid "_Noise:"
-msgstr "_Interferenza:"
+msgstr "_Rumore:"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
 msgid "If pixels are closer than noise, they are considered to be the same"
-msgstr "Se i pixel sono pi? vicini dell'interferenza, sono considerati identici"
+msgstr "Se i pixel sono pi? vicini del rumore, sono considerati identici"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
 msgid "I_dentical:"
@@ -7525,7 +7560,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp:472
 msgid "Fast Convolution"
-msgstr "Avvolgimento veloce"
+msgstr "Convoluzione veloce"
 
 #: avidemux/ADM_videoFilter/ADM_vidFields.cpp:229
 msgid "Motion Threshold"
@@ -7535,11 +7570,11 @@
 msgid "Blend Threshold"
 msgstr "Soglia miscela"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 msgid "_Temporal threshold:"
 msgstr "Soglia _temporale:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 msgid "_Spatial threshold:"
 msgstr "Soglia _spaziale:"
 
@@ -7585,7 +7620,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp:309
 msgid "Large Median 5x5"
-msgstr "Large Median 5x5"
+msgstr "Mediana grande 5x5"
 
 #: avidemux/ADM_videoFilter/ADM_vidLogo.cpp:88
 msgid "_Logo (jpg file):"
@@ -7803,7 +7838,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:63
 msgid "Stabilize Threshold"
-msgstr "Stabilizza soglia"
+msgstr "Soglia di stabilizzazione"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
 msgid "P' = A"
@@ -7847,7 +7882,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:275
 msgid "A = convolve(P); Load convolution kernel from file"
-msgstr "A = avvolgi(P); carica nucleo di avvolgimento da file"
+msgstr "A = avvolgi(P); carica nucleo di convoluzione da file"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:277
 msgid "A = pixel from image file as float; Load image from file"
@@ -7875,7 +7910,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
 msgid "Input _File (image or convolution kernel):"
-msgstr "_File di ingresso (immagine o nucleo di avvolgimento):"
+msgstr "_File di ingresso (immagine o nucleo di convoluzione):"
 
 #: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:327
 msgid ""
@@ -8463,14 +8498,14 @@
 msgstr "? necessaria una traccia audio per creare questo tipo di file"
 
 #: avidemux/gui_autodrive.cpp:63
-msgid "You need Xvid4 and either LAME or FAAC support for the iPod profile"
-msgstr "Hai bisogno del supporto di Xvid4 e di LAME o FAAC per il profilo Ipod"
+msgid "Xvid4 and FAAC support is required for the iPod profile."
+msgstr "Il supporto di Xvid4 e FAAC ? richiesto per il profilo iPod."
 
-#: avidemux/gui_autodrive.cpp:74
+#: avidemux/gui_autodrive.cpp:72
 msgid "Cannot select the MPEG-4 SP codec."
 msgstr "Impossibile selezionare il codec MPEG-4 SP."
 
-#: avidemux/gui_autodrive.cpp:121
+#: avidemux/gui_autodrive.cpp:114
 msgid ""
 "You don't have LAME!.\n"
 "It is needed to create FLV  video."
@@ -8478,15 +8513,15 @@
 "Non disponi di LAME!\n"
 "? necessario per creare video FLV."
 
-#: avidemux/gui_autodrive.cpp:135
+#: avidemux/gui_autodrive.cpp:128
 msgid "Cannot select FLV1  codec."
 msgstr "Impossibile selezionare il codec FLV1."
 
-#: avidemux/gui_autodrive.cpp:162
+#: avidemux/gui_autodrive.cpp:155
 msgid "Cannot select mpeg4 sp codec."
 msgstr "Impossibile selezionare il codec mpeg4 sp."
 
-#: avidemux/gui_autodrive.cpp:197
+#: avidemux/gui_autodrive.cpp:190
 msgid ""
 "You don't have FAAC!.\n"
 "It is needed to create PSP compatible video."



From gruntster at mail.berlios.de  Sun Jun 15 16:36:32 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jun 2008 16:36:32 +0200
Subject: [Avidemux-svn-commit] r4101 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_libraries
Message-ID: <200806151436.m5FEaWnG016029@sheep.berlios.de>

Author: gruntster
Date: 2008-06-15 16:36:21 +0200 (Sun, 15 Jun 2008)
New Revision: 4101

Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/
Log:
[Merge] clean up



From gruntster at mail.berlios.de  Mon Jun 16 01:03:46 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 01:03:46 +0200
Subject: [Avidemux-svn-commit] r4102 -
	branches/avidemux_2.4_branch/avidemux/ADM_editor
Message-ID: <200806152303.m5FN3ki1016984@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 01:03:23 +0200 (Mon, 16 Jun 2008)
New Revision: 4102

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
Log:
[vop] scan more frames when checking B-frame consistency (FS#408)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-15 14:36:21 UTC (rev 4101)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-15 23:03:23 UTC (rev 4102)
@@ -592,23 +592,26 @@
 
                 }
 		printf("\n checking for B-Frames...\n");
-		if( vid->_nb_video_frames >12) // 12
+		if( vid->_nb_video_frames > 12)
 		{
 				uint8_t 		*bufferin;
 				uint32_t 		len,flags;
 				uint8_t 		bframe=0, bconsistency=1;
-				uint32_t		scanned=12;
+				uint32_t		scanned;
                                 ADMImage                *buffer=NULL;
-				//buffer=new uint8_t [info.width* info.height*2];
-				if(vid->_nb_video_frames>50) scanned=50;
+
+				if(vid->_nb_video_frames > (info.fps1000 * 5) / 1000)
+					scanned = (info.fps1000 * 5) / 1000;
 				else				scanned=vid->_nb_video_frames;
+
+				printf(" scanning %lu frames\n", scanned);
 				
 				bufferin=new uint8_t [info.width* info.height*2];
                                 if(vid->decoder->dontcopy())
                                         buffer=new ADMImage(info.width,info.height,1);
                                 else
 				        buffer=new ADMImage(info.width,info.height);
-				// we decode 5 frames..should be enough to get an opinion
+
                                 ADMCompressedImage img;
                                 img.data=bufferin;
 				for(uint32_t i=0;i<scanned;i++)  //10



From gruntster at mail.berlios.de  Mon Jun 16 13:04:55 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 13:04:55 +0200
Subject: [Avidemux-svn-commit] r4103 - branches/avidemux_2.4_branch/po
Message-ID: <200806161104.m5GB4t2x012611@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 13:04:41 +0200 (Mon, 16 Jun 2008)
New Revision: 4103

Modified:
   branches/avidemux_2.4_branch/po/es.po
Log:
[I18N] Spanish update by zoppo

Modified: branches/avidemux_2.4_branch/po/es.po
===================================================================
--- branches/avidemux_2.4_branch/po/es.po	2008-06-15 23:03:23 UTC (rev 4102)
+++ branches/avidemux_2.4_branch/po/es.po	2008-06-16 11:04:41 UTC (rev 4103)
@@ -2,8 +2,8 @@
 msgstr ""
 "Project-Id-Version: Avidemux 2.4\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2008-04-24 20:19+0100\n"
-"PO-Revision-Date: 2008-05-03 07:10+0100\n"
+"POT-Creation-Date: 2008-06-12 15:04+0100\n"
+"PO-Revision-Date: 2008-06-16 01:17+0100\n"
 "Last-Translator: Festor Wailon Dacoba <festor90 at gmail.com>\n"
 "Language-Team:  <juliocesarmartin at msn.com>\n"
 "MIME-Version: 1.0\n"
@@ -62,8 +62,8 @@
 msgstr "PSP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:194
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:283
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:277
 msgid "FLV"
 msgstr "FLV"
 
@@ -89,9 +89,8 @@
 msgstr "H.263+ (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:143
-#, fuzzy
 msgid "MPEG-4 ASP (lavc)"
-msgstr "MPEG-PS (A+V)"
+msgstr "MPEG-4 ASP (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:159
 msgid "DV (lavc)"
@@ -134,9 +133,8 @@
 msgstr "SVCD (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:461
-#, fuzzy
 msgid "VCD (mpeg2enc)"
-msgstr "IPOD (mpeg4)"
+msgstr "VCD (mpeg2enc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:493
 msgid "SVCD (mpeg2enc)"
@@ -148,18 +146,16 @@
 msgstr "Cuantizador MPEG"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:539
-#, fuzzy
 msgid "DVD (mpeg2enc)"
-msgstr "IPOD (mpeg4)"
+msgstr "DVD (mpeg2enc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:671
 msgid "MPEG-4 ASP (Xvid4)"
 msgstr "MPEG-4 ASP (Xvid4)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:812
-#, fuzzy
 msgid "MPEG-4 AVC (x264)"
-msgstr "MPEG-PS (A+V)"
+msgstr "MPEG-4 AVC (x264)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:829
 msgid "dummy"
@@ -171,9 +167,9 @@
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:265
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:286
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:191
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:259
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:280
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
@@ -192,14 +188,12 @@
 msgstr "DivX"
 
 #: avidemux/ADM_encoder/adm_encffmpeg.h:47
-#, fuzzy
 msgid "LavCodec"
-msgstr "Codec:"
+msgstr "LavCodec"
 
 #: avidemux/ADM_encoder/adm_encmjpeg.h:60
-#, fuzzy
 msgid "MJPEG"
-msgstr "MPEG"
+msgstr "MJPEG"
 
 #: avidemux/ADM_encoder/adm_encmpeg2enc.h:57
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
@@ -218,9 +212,8 @@
 msgstr "Xvid"
 
 #: avidemux/ADM_encoder/adm_encXvid4.h:62
-#, fuzzy
 msgid "Xvid4"
-msgstr "Xvid"
+msgstr "Xvid4"
 
 #: avidemux/ADM_encoder/adm_encyv12.h:69
 msgid "YV12"
@@ -332,11 +325,11 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 #: avidemux/gui_autodrive.cpp:62
-#: avidemux/gui_autodrive.cpp:74
-#: avidemux/gui_autodrive.cpp:120
-#: avidemux/gui_autodrive.cpp:135
-#: avidemux/gui_autodrive.cpp:162
-#: avidemux/gui_autodrive.cpp:196
+#: avidemux/gui_autodrive.cpp:72
+#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:128
+#: avidemux/gui_autodrive.cpp:155
+#: avidemux/gui_autodrive.cpp:189
 msgid "Codec Error"
 msgstr "Error de codec"
 
@@ -389,6 +382,13 @@
 msgid "Aborted"
 msgstr "Abortado"
 
+#: avidemux/ADM_editor/ADM_edit.cpp:82
+msgid ""
+"Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n"
+"\n"
+"You can do it later with \"Audio -> Build VBR Time Map\"."
+msgstr ""
+
 #: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Tipo de archivo identificado pero no se ha detectado soporte para cargarlo..."
@@ -421,18 +421,20 @@
 msgstr "?Construir mapa de tiempo VBR?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
+#, fuzzy
+msgid "Use safe mode"
 msgstr "Utilizar este modo"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
-msgstr "H264 detectado"
+msgid "H.264 detected"
+msgstr "H.264 detectado"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
+#, fuzzy
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
 "Si el archivo utiliza el imagen B como referencia, puede llevar a un cuelgue o malfuncionamiento.\n"
 "Avidemux puede utilizar otro modo de forma segura pero <b>PERDER? LA EXACTITUD DE IMAGEN</b>.\n"
@@ -911,16 +913,15 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:80
-#, fuzzy
 msgid "MPlayer hqdn3d"
-msgstr "MPlayer eq2"
+msgstr "MPlayer hqdn3d"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 msgid "High quality version of denoise3d. Slower but more precise."
 msgstr "Versi?n de alta calidad de denoise3d. M?s lento pero preciso."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr ""
 
@@ -1297,7 +1298,7 @@
 msgid "Indexing"
 msgstr "Indexando"
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:376
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:379
 msgid "Incompatible frame rate"
 msgstr "Framerate incompatible"
 
@@ -1349,14 +1350,14 @@
 #: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
 #: avidemux/gtk_gui.cpp:903
 #: avidemux/gtk_gui.cpp:1505
@@ -1410,19 +1411,37 @@
 msgid "Could not read \"%s\"."
 msgstr "No se pudo leer \"%s\"."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 msgid "Output file error"
 msgstr "Error de archivo de salida"
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "No se pudo abrir \"%s\" para escritura."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:105
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+#, fuzzy
+msgid "Input file error"
+msgstr "Error de archivo de salida"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+msgid "Unknown source type"
+msgstr "Tipo de fuente desconocida"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Bitmap source failed"
+msgstr ""
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
 msgid "Problem loading sub"
 msgstr "Problema cargando sub"
 
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
+msgid "No subs"
+msgstr ""
+
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "Error en Ifo"
@@ -1577,8 +1596,8 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:269
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:263
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
@@ -1619,38 +1638,32 @@
 msgstr "PCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:487
-#, fuzzy
 msgid "MP2"
-msgstr "MP4"
+msgstr "MP2"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:488
-#, fuzzy
 msgid "MP3"
-msgstr "MP4"
+msgstr "MP3"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:489
-#, fuzzy
 msgid "WMA"
-msgstr "MAD"
+msgstr "WMA"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:490
-#, fuzzy
 msgid "LPCM"
-msgstr "PCM"
+msgstr "LPCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:491
 msgid "AC3"
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:492
-#, fuzzy
 msgid "Ogg Vorbis"
-msgstr "Vorbis"
+msgstr "Ogg Vorbis"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:494
-#, fuzzy
 msgid "AAC"
-msgstr "FAAC"
+msgstr "AAC"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:495
 msgid "QDM2"
@@ -1661,9 +1674,8 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:497
-#, fuzzy
 msgid "MSADPCM"
-msgstr "MAD"
+msgstr "MSADPCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:498
 msgid "ULAW"
@@ -1678,17 +1690,15 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:502
-#, fuzzy
 msgid "Unknown codec"
-msgstr "Desconocido"
+msgstr "Codec desconocido"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:109
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:134
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:111
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:223
-#, fuzzy
 msgid "Saving"
-msgstr "Guardando audio"
+msgstr "Guardando"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
 msgid ""
@@ -1700,7 +1710,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:149
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:203
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:176
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
 msgid "Filter init failed"
@@ -1728,26 +1738,24 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:207
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:201
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
-#, fuzzy
 msgid "Encoding"
-msgstr "Codificando:"
+msgstr "Codificando"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:250
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:467
-#, fuzzy
 msgid "2nd Pass"
-msgstr "Segunda pasada"
+msgstr "2nd pasada"
 
 #: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
 msgid "Smart Copy"
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:183
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
 msgid "Cannot initialize the video stream"
 msgstr "No se puede iniciar la pista de v?deo"
@@ -1758,8 +1766,8 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:179
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:215
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:233
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:332
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:227
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:326
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:214
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:337
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:421
@@ -1768,13 +1776,13 @@
 msgstr "Error durante la codificaci?n"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid "KeyFrame error"
 msgstr "Error de Imagen-Clave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid ""
 "The beginning frame is not a key frame.\n"
@@ -1783,28 +1791,28 @@
 "La imagen inicial no es un Imagen-Clave\n"
 "Desplace el marcador A."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Unsupported video"
 msgstr "V?deo no soportado"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Only FLV1 and VP6 video are supported"
 msgstr "S?lo los v?deos FLV1 y VP6 son soportados"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Unsupported audio"
 msgstr "Audio no soportado"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
 msgid "Audio must be mp3 for flv output."
 msgstr "El formato de audio debe ser MP3 para el formato de salida FVL"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
 msgstr "La frecuencia debe ser 44100, 22050 o 11025 Hz."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:248
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:253
 msgid "Cannot initialize the audio stream"
 msgstr "No se puede inicializar la pista de audio"
@@ -1851,27 +1859,23 @@
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:230
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:287
-#, fuzzy
 msgid "MPEG TS"
-msgstr "MPEG"
+msgstr "MPEG TS"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:231
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:288
-#, fuzzy
 msgid "MPEG VCD"
-msgstr "MPEG"
+msgstr "MPEG VCD"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:232
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:289
-#, fuzzy
 msgid "MPEG SVCD"
-msgstr "MPEG"
+msgstr "MPEG SVCD"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:233
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:290
-#, fuzzy
 msgid "MPEG DVD"
-msgstr "MPEG"
+msgstr "MPEG DVD"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:193
 msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
@@ -1902,14 +1906,12 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:278
-#, fuzzy
 msgid "MPEG Requantizer"
-msgstr "Cuantizador MPEG"
+msgstr "Recuantizador MPEG"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:286
-#, fuzzy
 msgid "MPEG ES"
-msgstr "MPEG"
+msgstr "MPEG ES"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:305
 msgid "Reuse log file ?"
@@ -1940,9 +1942,8 @@
 msgstr "No se pudo inicializar audio"
 
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:70
-#, fuzzy
 msgid "Saving..."
-msgstr "Guardar"
+msgstr "Guardando..."
 
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:111
 msgid "Pass one"
@@ -2390,9 +2391,8 @@
 msgstr "Entrelazando:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:88
-#, fuzzy
 msgid "libavcodec MPEG-2 Configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n libavcodec MPEG-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flv1.cpp:44
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:109
@@ -2413,15 +2413,32 @@
 msgstr "_Minutos:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
-#, fuzzy
 msgid "_Seconds:"
-msgstr "Segunda pasada"
+msgstr "Segunda pasada:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:32
 #, fuzzy
 msgid "Go to Time"
 msgstr "Saltar a _tiempo..."
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:6
+msgid "_Job name:"
+msgstr "Nombre de tarea"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+#, fuzzy
+msgid "Output _File:"
+msgstr "Archivo de Salida"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+#, fuzzy
+msgid "Select Video To Write"
+msgstr "Seleccione archivo AVI para escribir"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:10
+msgid "Save Job"
+msgstr "Guardar tarea"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
 msgid "Full"
 msgstr "Completo"
@@ -2544,9 +2561,8 @@
 msgstr "Control de Frecuencia"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:120
-#, fuzzy
 msgid "libavcodec MPEG-4 configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n libavcodec MPEG-4"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:26
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
@@ -2568,97 +2584,96 @@
 msgstr "_Swap U&V:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:39
-#, fuzzy
 msgid "MJPEG Configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n MJPEG"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:85
 msgid "Select idx file:"
 msgstr "Seleccionar archivo idx:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
 msgid "Use GlyphSet (optional):"
 msgstr "Usar GliphSet (opcional):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 #, fuzzy
 msgid "Select GlyphSet file"
 msgstr "Seleccionar archivo de salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Output SRT file"
 msgstr "Archivo SRT de salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 #, fuzzy
 msgid "Save SRT file"
 msgstr "Guardar el archivo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:214
 msgid "Select input and ouput files"
 msgstr "Seleccionar archivos de entrada y salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
 msgid "The idx/sub file does not exist."
 msgstr "El archivo idx/sub no existe."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
 msgid "Please Select a valid output SRT file."
 msgstr "Seleccione o introduzca un archivo SRT v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 msgid "Cannot load the glyphset file."
 msgstr "No se puede cargar el archivo glyphset."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 #, fuzzy
 msgid "GlyphSet filename"
 msgstr "Nombre no v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 #, fuzzy
 msgid "Save GlyphSet file"
 msgstr "Guardar el archivo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:149
 msgid "Save Glyph"
 msgstr "Guardar Glyph"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 #, fuzzy
 msgid "Input TS:"
 msgstr "Entrada"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 #, fuzzy
 msgid "Select TS file"
 msgstr "Seleccionar archivo TTF"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:201
 msgid "Subtitle PID:"
 msgstr "Subt?tulos PID:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 msgid "Use glyphset (optional):"
 msgstr "Usar glyphset (opcional):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
 #, fuzzy
 msgid "Please Select a valid TS file."
 msgstr "Seleccione o introduzca un archivo SRT v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:270
 #, fuzzy
 msgid "Save GlyphSet"
 msgstr "Guardar Glyph"
@@ -3066,7 +3081,6 @@
 msgstr "Codificando:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
-#, fuzzy
 msgid "S_elect C_olor"
 msgstr "Seleccionar color"
 
@@ -4668,57 +4682,6 @@
 msgid "Run Job"
 msgstr "Ejecutar tarea"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-#, fuzzy
-msgid "Select Video to Write"
-msgstr "Seleccione archivo AVI para escribir"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Invalid filename"
-msgstr "Nombre no v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename."
-msgstr "Seleccione o introduzca un nombre v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Invalid jobname"
-msgstr "Nombre no v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname."
-msgstr "Seleccione o introduzca un nombre v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
-msgid "Save Job"
-msgstr "Guardar tarea"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
-msgid "Select the output file"
-msgstr "Seleccionar archivo de salida"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
-msgid "_Browse..."
-msgstr "Buscar..."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
-msgid "Job name displayed in the job list and used as the script filename"
-msgstr "Nombre de tarea mostrado en la lista de tareas y utilizado como nombre del script"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
-msgid "Filename of the audio/video output"
-msgstr "Nombre del archivo de salida"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
-msgid "_Job name:"
-msgstr "Nombre de tarea"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
-msgid "Output _file:"
-msgstr "Archivo de Salida"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:379
 msgid "Mplayer Delogo"
 msgstr "Mplayer Delogo"
@@ -5115,7 +5078,7 @@
 msgid "Configure"
 msgstr "Configurar"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:89
 msgid "none"
 msgstr "ninguno"
 
@@ -5123,6 +5086,16 @@
 msgid "Select .idx file"
 msgstr "Seleccionar archivo .idx"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+#, fuzzy
+msgid "Wrong VobSub parametering"
+msgstr "Configuraci?n VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+#, fuzzy
+msgid "The idx/sub file does not set."
+msgstr "El archivo idx/sub no existe."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
 msgid "VobSub Settings"
 msgstr "Configuraci?n VobSub"
@@ -6323,6 +6296,11 @@
 msgid "Select Color"
 msgstr "Seleccionar color"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
+msgid "_Browse..."
+msgstr "Buscar..."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:99
 #, fuzzy
 msgid "_Encoding mode:"
@@ -7793,12 +7771,12 @@
 msgid "Blend Threshold"
 msgstr "Umbral de cambio de escena"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 #, fuzzy
 msgid "_Temporal threshold:"
 msgstr "Umbral:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 #, fuzzy
 msgid "_Spatial threshold:"
 msgstr "Umbral:"
@@ -8743,14 +8721,14 @@
 msgstr "Es necesaria una pista de audio para crear ese tipo de archivo"
 
 #: avidemux/gui_autodrive.cpp:63
-msgid "You need Xvid4 and either LAME or FAAC support for the iPod profile"
+msgid "Xvid4 and FAAC support is required for the iPod profile."
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:74
+#: avidemux/gui_autodrive.cpp:72
 msgid "Cannot select the MPEG-4 SP codec."
 msgstr "No se puede seleccionar el codec MPEG4 SP."
 
-#: avidemux/gui_autodrive.cpp:121
+#: avidemux/gui_autodrive.cpp:114
 msgid ""
 "You don't have LAME!.\n"
 "It is needed to create FLV  video."
@@ -8758,15 +8736,15 @@
 "Sin soporte para LAME.\n"
 "Es necesario para crear v?deos FLV."
 
-#: avidemux/gui_autodrive.cpp:135
+#: avidemux/gui_autodrive.cpp:128
 msgid "Cannot select FLV1  codec."
 msgstr "No se puede seleccionar el codec FLV1."
 
-#: avidemux/gui_autodrive.cpp:162
+#: avidemux/gui_autodrive.cpp:155
 msgid "Cannot select mpeg4 sp codec."
 msgstr "No se puede seleccionar el codec MPEG4 SP."
 
-#: avidemux/gui_autodrive.cpp:197
+#: avidemux/gui_autodrive.cpp:190
 msgid ""
 "You don't have FAAC!.\n"
 "It is needed to create PSP compatible video."
@@ -8854,3 +8832,20 @@
 "Puede necesitar copia inteligente.\n"
 " ?Activar?"
 
+#~ msgid "Invalid filename"
+#~ msgstr "Nombre no v?lido"
+#~ msgid "Please select or enter a valid filename."
+#~ msgstr "Seleccione o introduzca un nombre v?lido"
+#~ msgid "Invalid jobname"
+#~ msgstr "Nombre no v?lido"
+#~ msgid "Please select or enter a valid jobname."
+#~ msgstr "Seleccione o introduzca un nombre v?lido"
+#~ msgid "Select the output file"
+#~ msgstr "Seleccionar archivo de salida"
+#~ msgid "Job name displayed in the job list and used as the script filename"
+#~ msgstr ""
+#~ "Nombre de tarea mostrado en la lista de tareas y utilizado como nombre "
+#~ "del script"
+#~ msgid "Filename of the audio/video output"
+#~ msgstr "Nombre del archivo de salida"
+



From gruntster at mail.berlios.de  Mon Jun 16 13:55:25 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 13:55:25 +0200
Subject: [Avidemux-svn-commit] r4104 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiocodec
	ADM_audiofilter ADM_editor ADM_encoder ADM_filter
	ADM_inputs/ADM_amv ADM_inputs/ADM_asf ADM_inputs/ADM_avsproxy
	ADM_inputs/ADM_flv ADM_inputs/ADM_h263 ADM_inputs/ADM_inpics
	ADM_inputs/ADM_matroska ADM_inputs/ADM_mp4
	ADM_inputs/ADM_mpegdemuxer ADM_inputs/ADM_nuv
	ADM_inputs/ADM_ogm ADM_inputs/ADM_openDML
	ADM_libraries/ADM_libmpeg2enc ADM_libraries/ADM_libwrapper
	ADM_libraries/ADM_utilities ADM_osSupport
	ADM_outputs/oplug_avi ADM_script ADM_toolkit
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_NONE/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_videoFilter xpm
Message-ID: <200806161155.m5GBtPk8031215@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 13:54:28 +0200 (Mon, 16 Jun 2008)
New Revision: 4104

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_assert.h
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.h
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edIdentify.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edLoadSave.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_dylib.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/aviio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp
   branches/avidemux_2.4_branch/avidemux/xpm/avidemux_icon.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/begin.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/end.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator_small.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/stop.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/systray.xpm
   branches/avidemux_2.4_branch/avidemux/xpm/systray2.xpm
Log:
[misc] fix various warnings

Modified: branches/avidemux_2.4_branch/avidemux/ADM_assert.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -24,7 +24,7 @@
 extern void *ADM_realloc(void *in,size_t size);
 extern void ADM_dezalloc(void *ptr);
 extern char *ADM_strdup( const char *in);
-extern char *slashToBackSlash(char *in);
+extern char *slashToBackSlash(const char *in);
 typedef void *(* adm_fast_memcpy)(void *to, const void *from, size_t len);
 extern adm_fast_memcpy myAdmMemcpy;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -227,4 +227,4 @@
   
 }
 
-// EOF
\ No newline at end of file
+// EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -18,7 +18,7 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 #include <math.h>
 
 #include "ADM_utilities/default.h"
@@ -57,7 +57,7 @@
 typedef struct externalSource
 {
  AudioSource type;
- char *name;       
+ const char *name;
 }externalSource;
 
 static const externalSource Sources[]=
@@ -70,7 +70,7 @@
 };
 typedef struct Mixer_String
 {
-  char         *name;
+  const char         *name;
   CHANNEL_CONF conf;
 };
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -102,7 +102,7 @@
   return 1;
 }
 
-uint8_t vidHeader::setMyName (char *name)
+uint8_t vidHeader::setMyName (const char *name)
 {
   _name = new char[strlen (name) + 1];
   ADM_assert (_name);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_Video.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -73,7 +73,7 @@
 virtual   void 			Dump(void)=0;
 virtual	  uint8_t		getExtraHeaderData(uint32_t *len, uint8_t **data);
 // AVI io
-virtual 	uint8_t		open(char *name)=0;
+virtual 	uint8_t		open(const char *name)=0;
 virtual 	uint8_t		close(void)=0;
 virtual	uint8_t			reorder( void ) { return 0;} // by default we don"t do frame re-ordering
 virtual	uint8_t			isReordered( void ) { return 0;} // by default we don"t do frame re-ordering
@@ -83,7 +83,7 @@
   uint8_t			getVideoInfo(aviInfo *info);
   uint32_t			getWidth( void ) { return _mainaviheader.dwWidth;};
   uint32_t			getHeight( void ) { return _mainaviheader.dwHeight;};
-  uint8_t			setMyName( char *name);
+  uint8_t			setMyName( const char *name);
   char				*getMyName( void);
   //__________________________
   //				 Audio

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edIdentify.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edIdentify.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edIdentify.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -44,7 +44,7 @@
 /**
 	Read the magic of a file i.e. its 16 first bytes
 */
-uint8_t ADM_Composer::getMagic (char *name, uint32_t * magic)
+uint8_t ADM_Composer::getMagic (const char *name, uint32_t * magic)
 {
   FILE *    tmp;
   uint8_t    ret =    1;
@@ -67,7 +67,7 @@
 
 */
 
-uint8_t ADM_Composer::identify (char *name, fileType * type)
+uint8_t ADM_Composer::identify (const char *name, fileType * type)
 {
   uint32_t magic[4];
   uint32_t id;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edLoadSave.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edLoadSave.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edLoadSave.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -48,8 +48,7 @@
 // Ugly but sooo usefull
 extern uint32_t frameStart,frameEnd;
 static uint32_t edFrameStart,edFrameEnd;
-uint8_t loadVideoCodecConf( char *name);
-uint8_t saveVideoCodecConf( char *name);
+uint8_t loadVideoCodecConf( const char *name);
 const char *getCurrentContainerAsString(void);
 
 uint8_t ADM_Composer::getMarkers(uint32_t *start, uint32_t *end)
@@ -70,7 +69,7 @@
 // Save the config, including name, segment etc...
 //______________________________________________
 
-uint8_t ADM_Composer::saveWorbench (char *name)
+uint8_t ADM_Composer::saveWorbench (const char *name)
 {
         GUI_Error_HIG(QT_TR_NOOP("Unsupported"), NULL);
         return 0;
@@ -78,7 +77,7 @@
 /*______________________________________________
         Save the project as a script
 ______________________________________________*/
-uint8_t ADM_Composer::saveAsScript (char *name, char *outputname)
+uint8_t ADM_Composer::saveAsScript (const char *name, const char *outputname)
 {
 const char *truefalse[]={"false","true"};
 printf("\n **Saving script project **\n");
@@ -296,7 +295,7 @@
 // Save the config, including name, segment etc...
 //______________________________________________
 
-uint8_t ADM_Composer::loadWorbench (char *name)
+uint8_t ADM_Composer::loadWorbench (const char *name)
 {
   GUI_Error_HIG(QT_TR_NOOP("Old format project file"),QT_TR_NOOP( "No more supported."));
  return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -76,7 +76,7 @@
 void DIA_indexerPrefill(char *name);
 extern uint8_t indexMpeg (char *mpeg, char *file, uint8_t aid);
 
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern uint8_t parseScript(char *name);
 uint8_t UI_SetCurrentFormat( ADM_OUT_FORMAT fmt );
 const char *VBR_MSG = QT_TR_NOOP("Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".");
@@ -262,7 +262,7 @@
         
 
 */
-uint8_t ADM_Composer::addFile (char *name, uint8_t mode,fileType forcedType)
+uint8_t ADM_Composer::addFile (const char *name, uint8_t mode,fileType forcedType)
 {
   uint8_t    ret =    0;
   aviInfo    info;
@@ -1511,7 +1511,7 @@
 //              0 else
 //_________________________________________
 //
-uint8_t         ADM_Composer::tryIndexing(char *name,char *idxname)
+uint8_t         ADM_Composer::tryIndexing(const char *name, const char *idxname)
 {
  unsigned int autoidx = 0;
       prefs->get(FEATURE_TRYAUTOIDX,&autoidx);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.hxx	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.hxx	2008-06-16 11:54:28 UTC (rev 4104)
@@ -152,10 +152,10 @@
 				       		uint8_t  	updateAudioTrack(uint32_t seg);			   	
 						void 		deleteAllVideos(void );
 
-						uint8_t 	getMagic(char *name,uint32_t *magic);
-						uint8_t 	identify(char *name, fileType *type);
+						uint8_t 	getMagic(const char *name,uint32_t *magic);
+						uint8_t 	identify(const char *name, fileType *type);
 						uint32_t 	searchForwardSeg(uint32_t startframe);
-                                                uint8_t         tryIndexing(char *name,char *idxname=NULL);
+                                                uint8_t         tryIndexing(const char *name, const char *idxname=NULL);
 
   public:
                                                 uint8_t hasVBRVideos(void);
@@ -169,9 +169,9 @@
   				virtual 			~ADM_Composer();
   						void		clean( void );
   						void		dumpSeg(void);
-                                                uint8_t         saveAsScript (char *name,char *out);
-						uint8_t 	saveWorbench(char *name)      ;
-						uint8_t 	loadWorbench(char *name)      ;
+                                                uint8_t         saveAsScript (const char *name, const char *out);
+						uint8_t 	saveWorbench(const char *name);
+						uint8_t 	loadWorbench(const char *name);
 						uint8_t     resetSeg( void );
 						uint8_t	reorder( void );
 						uint8_t	isReordered( uint32_t framenum );
@@ -179,7 +179,7 @@
   				//_______________________
   				// specific to composer
   				//_______________________
-  						uint8_t 	addFile (char *name, uint8_t mode=0,fileType forcedType=Unknown_FileType);
+  						uint8_t 	addFile (const char *name, uint8_t mode=0,fileType forcedType=Unknown_FileType);
   						uint8_t 	cleanup( void);
 			   			uint8_t 	isMultiSeg( void) { if(_nb_segment>1) return 1; else return 0;}
   						uint8_t 	removeFrames(uint32_t start,uint32_t end);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -90,8 +90,7 @@
 
 
 
-uint8_t loadVideoCodecConf (char *name);
-uint8_t saveVideoCodecConf (char *name);
+uint8_t loadVideoCodecConf (const char *name);
 uint8_t mk_hex (uint8_t a, uint8_t b);
 //*********************************************
 CodecFamilty
@@ -754,7 +753,7 @@
 
 */
 uint8_t
-loadVideoCodecConf (char *name)
+loadVideoCodecConf (const char *name)
 {
   FILE *fd = NULL;
   char str[4000];
@@ -799,7 +798,7 @@
 }
 /***********************/
 uint8_t
-loadVideoCodecConfString (char *cmd)
+loadVideoCodecConfString (const char *cmd)
 {
 #define MAX_STRING 4000
   char str[MAX_STRING * 3];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -18,12 +18,11 @@
  #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 
 #include "config.h"
 #include "fourcc.h"
 #include "avio.hxx"
-#include "config.h"
 #include "avi_vars.h"
 
 
@@ -44,12 +43,12 @@
 {
 SCRIPT_CREATE(FILTER_create_fromscript,ADMVideoFlipV,flipParam);
 BUILD_CREATE(FILTER_create,ADMVideoFlipV);
-char *FILTER_getName(void)
+const char *FILTER_getName(void)
 {
 	return "DynFLIPPER";
 }
 
-char *FILTER_getDesc(void)
+const char *FILTER_getDesc(void)
 {
 	return "Vertical flip, demo for dynamically loaded filters";
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -80,11 +80,10 @@
 }
 void filterListAll( void )
 {
-char *name;
 	printf("\nVideo filters\n");
 	for(uint32_t i=0;i<allfilters.size();i++)
 	{
-		name=allfilters[ i].filtername;
+		const char *name = allfilters[ i].filtername;
 		if(allfilters[ i].viewable)
 		{
 			if(name)
@@ -93,13 +92,12 @@
 	}
 
 }
-VF_FILTERS filterGetTagFromName(char *inname)
+VF_FILTERS filterGetTagFromName(const char *inname)
 {
-char *name;
 	VF_FILTERS filter=VF_DUMMY;
 	for(uint32_t i=0;i<allfilters.size();i++)
 	{
-		name=allfilters[ i].filtername;
+		const char *name=allfilters[ i].filtername;
 		if(allfilters[ i].viewable || allfilters[i].tag==VF_PARTIAL)
 		{
 			if(name)
@@ -128,7 +126,7 @@
 }
 void registerFilterEx(const char *name,VF_FILTERS tag,uint8_t viewable
 		,AVDMGenericVideoStream *(*create) (AVDMGenericVideoStream *in, CONFcouple *)
-		,char *filtername,AVDMGenericVideoStream *(*create_from_script) (AVDMGenericVideoStream *in, int n,Arg *args),char *desc)
+		,const char *filtername,AVDMGenericVideoStream *(*create_from_script) (AVDMGenericVideoStream *in, int n,Arg *args), const char *desc)
 {
 //    printf ("nb_video_filter = %d, max %d, name = %s\n", nb_video_filter, (MAX_FILTER-1), name);
         allfilters.push_back (FILTER_ENTRY (name, create, tag, viewable,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -21,8 +21,7 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
-#include <ADM_assert.h>
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 
 #include "config.h"
 #include "fourcc.h"
@@ -41,7 +40,7 @@
 #define REGISTER(e,a,g,b,c,d) {FILTERDEC(d);registerFilterEx(a,b,c,d,e,NULL,NULL);}
 #define REGISTERX(e,a,g,b,c,d,f) {\
 FILTERDECX(f);\
-FILTERDEC(d);registerFilterEx((char*)a,b,c,d,e,f,(char*)g);\
+FILTERDEC(d);registerFilterEx(a,b,c,d,e,f,g);\
 }
 
 void registerVideoFilters( void )

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_dylib.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_dylib.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_dylib.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -79,7 +79,7 @@
 #endif
 
 
-typedef char *(ADM_getStringT)(void);
+typedef const char *(ADM_getStringT)(void);
 
 static void tryLoading(TYPEOFHANDLE handle);
 static uint32_t dynTag=0xF0000000;
@@ -133,11 +133,9 @@
     
     
     
-    char *name,*desc;
+    const char *name = nameP();
+    const char *desc = descP();
     
-    name=nameP();
-    desc=descP();
-    
     ADM_assert(name);
     ADM_assert(desc);
     

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -122,13 +122,13 @@
         void              (*destroy)( AVDMGenericVideoStream *old); /* Maybe needed ...*/
         VF_FILTERS        tag;
         uint8_t           viewable;
-        char              *filtername;
-        char              *description;
+        const char              *filtername;
+        const char              *description;
         ADM_create_from_scriptT *create_from_script;
 
        FILTER_ENTRY (const char * name, ADM_createT * create, VF_FILTERS tag,
-                     uint8_t viewable, char * filtername,
-                     char * description = 0,
+                     uint8_t viewable, const char * filtername,
+                     const char * description = 0,
                      ADM_create_from_scriptT * create_from_script = 0)
            : name (name),
              create (create),
@@ -197,12 +197,12 @@
                     
 void registerFilterEx(const char *name,VF_FILTERS tag,uint8_t viewable,
                 ADM_createT  *create,
-		char *filtername,
+		const char *filtername,
                 ADM_create_from_scriptT *create_from_script,
-                char *description);
+                const char *description);
                 
 void 		filterListAll( void );
-VF_FILTERS 	filterGetTagFromName(char *inname);
+VF_FILTERS 	filterGetTagFromName(const char *inname);
 uint8_t 	filterAddScript(VF_FILTERS tags,uint32_t n,Arg *args);
 //AVDMGenericVideoStream *filterCreateFromTag(VF_FILTERS tag,uint8_t *conf, AVDMGenericVideoStream *in) ;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -90,7 +90,7 @@
       \brief open the flv file, gather infos and build index(es).
 */
 
-uint8_t amvHeader::open(char *name)
+uint8_t amvHeader::open(const char *name)
 {
   uint32_t prevLen, type, size, pts,pos=0;
   

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -105,7 +105,7 @@
             amvHeader( void );
    virtual  ~amvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,782 +1,782 @@
-/***************************************************************************
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-
-#include <stdio.h>
-#include <stdlib.h>
-
-#include <string.h>
-
-#include "math.h"
-
-#include "ADM_utilities/default.h"
-#include "ADM_editor/ADM_Video.h"
-#include <ADM_assert.h>
-
-#include "fourcc.h"
-#include "ADM_toolkit/toolkit.hxx"
-//#include "DIA_working.h"
-#include "ADM_asf.h"
-#include "ADM_asfPacket.h"
-
-#include "ADM_osSupport/ADM_debugID.h"
-#define MODULE_NAME MODULE_ASF
-#include "ADM_osSupport/ADM_debug.h"
-
-static const uint8_t asf_audio[16]={0x40,0x9e,0x69,0xf8,0x4d,0x5b,0xcf,0x11,0xa8,0xfd,0x00,0x80,0x5f,0x5c,0x44,0x2b};
-static const uint8_t asf_video[16]={0xc0,0xef,0x19,0xbc,0x4d,0x5b,0xcf,0x11,0xa8,0xfd,0x00,0x80,0x5f,0x5c,0x44,0x2b};
-
-
-WAVHeader *asfHeader::getAudioInfo(void )
-{
-  if(!_curAudio) return NULL;
-  return _curAudio->getInfo();
-}
-/*
-    __________________________________________________________
-*/
-
-uint8_t asfHeader::getAudioStream(AVDMGenericAudioStream **audio)
-{
- 
-  *audio=_curAudio;
-  return 1; 
-}
-/*
-    __________________________________________________________
-*/
-
-void asfHeader::Dump(void)
-{
- 
-  printf("*********** ASF INFO***********\n");
-}
-/*
-    __________________________________________________________
-*/
-
-uint8_t asfHeader::close(void)
-{
-	if (_fd) 
-		fclose(_fd);
-
-	_fd=NULL;
-
-  if(_videoExtraData)
-  {
-    delete [] _videoExtraData;
-    _videoExtraData=NULL; 
-  }
-  if(myName)
-  {
-    delete myName;
-    myName=NULL; 
-  }
-  if(_extraData)
-  {
-    delete [] _extraData;
-    _extraData=NULL; 
-  }
-  if(_index)
-  {
-    delete [] _index; 
-  }
-  _index=NULL;
-  if(_packet)
-    delete _packet;
-  _packet=NULL;
-  
-  for(int i=0;i<_nbAudioTrack;i++)
-  {
-    asfAudioTrak *trk=&(_allAudioTracks[i]);
-    if(trk->extraData) delete [] trk->extraData;
-    trk->extraData=NULL;
-  }
-}
-uint8_t       asfHeader::getExtraHeaderData(uint32_t *len, uint8_t **data)
-{
-  *len=_extraDataLen;
-  *data=_extraData;
-  return 1; 
-}
-/*
-    __________________________________________________________
-*/
-
- asfHeader::asfHeader( void ) : vidHeader()
-{
-  _fd=NULL;
-  _videoIndex=-1;
-  myName=NULL;
-  _extraDataLen=0;
-  _extraData=NULL;
-  _packetSize=0;
-  _videoStreamId=0;
-  nbImage=0;
-  _index=NULL;
-  _packet=NULL;
-  _curAudio=NULL;
-  _nbPackets=0;
-  printf("%u\n",sizeof(_allAudioTracks));
-  memset(&(_allAudioTracks[0]),0,sizeof(_allAudioTracks));
-
-  _nbAudioTrack=0;
-  _currentAudioStream=0;
-}
-/*
-    __________________________________________________________
-*/
-
- asfHeader::~asfHeader(  )
-{
-  close();
-}
-/*
-    __________________________________________________________
-*/
-
-uint8_t asfHeader::open(char *name)
-{
-  _fd=fopen(name,"rb");
-  if(!_fd)
-  {
-    GUI_Error_HIG("File Error.","Cannot open file\n");
-    return 0; 
-  }
-  myName=ADM_strdup(name);
-  if(!getHeaders())
-  {
-    return 0; 
-  }
-  buildIndex();
-  fseeko(_fd,_dataStartOffset,SEEK_SET);
-  _packet=new asfPacket(_fd,_nbPackets,_packetSize,&readQueue,_dataStartOffset);
-  curSeq=1;
-  if(_nbAudioTrack)
-  {
-    _curAudio=new asfAudio(this,_currentAudioStream);
-  }
-  return 1;
-}
-/*
-    __________________________________________________________
-*/
-
- 
-/*
-    __________________________________________________________
-*/
-
-  uint8_t  asfHeader::setFlag(uint32_t frame,uint32_t flags)
-{
-  ADM_assert(frame<nbImage);
-  _index[frame].flags=flags;
-  return 1; 
-}
-/*
-    __________________________________________________________
-*/
-
-uint32_t asfHeader::getFlags(uint32_t frame,uint32_t *flags)
-{
-  if(frame>=nbImage) return 0;
-  if(!frame) *flags=AVI_KEY_FRAME;
-  else 
-      *flags=_index[frame].flags;
-  return 1; 
-}
-/*
-    __________________________________________________________
-*/
-
-uint8_t  asfHeader::getFrameNoAlloc(uint32_t framenum,ADMCompressedImage *img)
-{
-  img->dataLength=0;
-  img->flags=AVI_KEY_FRAME;
-  if(framenum>=nbImage)
-  {
-    printf("[ASF] Going out of bound %u %u\n",framenum, nbImage);
-    return 0;
-  }
-  if(!_index[framenum].frameLen)
-  {
-    return 1; // Empty frame 
-  }
-  // In case curSeq is stored as one byte..
-  curSeq&=0xff;
-  //
-  uint32_t len=0;
-  aprintf("Framenum %u len: %u curSeq %u frameSeq=%u packetnb=%u \n",
-         framenum,_index[framenum].frameLen,curSeq,
-         _index[framenum].segNb,_index[framenum].packetNb);
-  // Seeking ?
-  if(_index[framenum].segNb!=curSeq)
-  {
-    printf("Seeking.. curseq:%u wanted seq:%u\n",curSeq,_index[framenum].segNb);
-    if(!_packet->goToPacket(_index[framenum].packetNb))
-    {
-      printf("[ASF] Cannot seek to frame %u\n",framenum);
-      return 0; 
-    }
-    _packet->purge();
-    curSeq=_index[framenum].segNb;
-    printf("Seeking starting at seq=%u\n",curSeq);
-  }
-  
-  
-  len=0;
-  uint32_t delta;
-  while(1)
-  {
-   
-    
-    
-    while(!readQueue.isEmpty())
-    {
-      asfBit *bit;
-      ADM_assert(readQueue.pop((void**)&bit));
-      aprintf(">found packet of size %d seq %d, while curseq =%d wanted seg=%u current offset=%u\n",bit->len,bit->sequence,curSeq,_index[framenum].segNb,len);
-      // Here it is tricky
-      // if len==0 we are reading the first part of our frame
-      // The packet may starts with segments from the previous frame
-      // discard them
-      // Delta is just a security as it should be slightly >10
-      delta=256+bit->sequence-_index[framenum].segNb;
-      delta &=0xff;
-      if(!len) // Starting a new frame
-      {
-          if(_index[framenum].segNb != bit->sequence )
-          {
-            aprintf("Dropping seq=%u too old for %u delta %d\n",
-                  bit->sequence,_index[framenum].segNb,delta);
-            delete[] bit->data;
-            delete bit;
-            if(delta<230)
-            {
-              printf("Very suspicious\n");
-              printf("Very suspicious\n");
-              printf("Very suspicious\n");
-              printf("Very suspicious\n");
-              printf("Very suspicious\n");
-            }
-            continue; 
-          }
-          // We have found our first chunk
-          curSeq=bit->sequence;
-          memcpy(img->data,bit->data,bit->len);
-          len=bit->len;
-          delete[] bit->data;
-          delete bit;
-          continue;
-      }
-      // Continuing a frame
-      // If the seq number is different it is the beginning of a new frame
-      if(bit->sequence!=curSeq )
-      {
-        aprintf("New sequence %u->%u while loading %u frame\n",curSeq,bit->sequence,framenum);
-        img->dataLength=len;
-        readQueue.pushBack(bit); // don't delete it, we will use it later...
-        curSeq=bit->sequence;
-        goto gotcha;
-      }
-      // still same sequence ...add
-      memcpy(img->data+len,bit->data,bit->len);
-      len+=bit->len;
-	  delete[] bit->data;
-      delete bit;
-    }
-    if(!_packet->nextPacket(_videoStreamId))
-    {
-      printf("[ASF] Packet Error\n");
-      return 0; 
-    }
-    _packet->skipPacket();
-  }
-gotcha:
-  
-  img->dataLength=len;
-  if(len!=_index[framenum].frameLen)
-  {
-    printf("[ASF] Frame=%u :-> Mismatch found len : %u expected %u\n",framenum,len, _index[framenum].frameLen);
-  }
-  aprintf(">>Len %d seq %d\n",len,curSeq);
-  return 1; 
-}
-/*
-    __________________________________________________________
-*/
-
-/*******************************************
-  Read Headers to collect information 
-********************************************/
-uint8_t asfHeader::getHeaders(void)
-{
-  uint32_t i=0,nbSubChunk,hi,lo;
-  const chunky *id;
-  uint8_t gid[16];
-  uint32_t mn=0,mx=0;
-  asfChunk chunk(_fd);
-  // The first header is header chunk
-  chunk.nextChunk();
-  id=chunk.chunkId();
-  if(id->id!=ADM_CHUNK_HEADER_CHUNK)
-  {
-    printf("[ASF] expected header chunk\n"); 
-    return 0;
-  }
-  printf("[ASF] getting headers\n");
-  chunk.dump();
-  nbSubChunk=chunk.read32();
-  printf("NB subchunk :%u\n",nbSubChunk);
-  chunk.read8();
-  chunk.read8();
-  for(i=0;i<nbSubChunk;i++)
-  {
-    asfChunk *s=new asfChunk(_fd);
-    uint32_t skip;
-    s->nextChunk();
-    printf("***************\n");  
-    id=s->chunkId();
-    s->dump();
-    switch(id->id)
-    {
-#if 0      
-      case ADM_CHUNK_HEADER_EXTENSION_CHUNK:
-      {
-        s->skip(16); // Clock type extension ????
-        printf("?? %d\n",s->read16());
-        printf("?? %d\n",s->read32());
-          
-        uint32_t streamNameCount;
-        uint32_t payloadCount;
-          
-          asfChunk *u=new asfChunk(_fd);
-          for(int zzz=0;zzz<8;zzz++)
-          {
-              u->nextChunk();
-              u->dump();
-              id=u->chunkId();
-              if(id->id==ADM_CHUNK_EXTENDED_STREAM_PROP)
-              {
-                  s->skip(8); // start time 
-                  s->skip(8); // end time
-                  printf("Bitrate         %u :\n",u->read32());
-                  printf("Buffer Size     %u :\n",u->read32());
-                  printf("BFill           %u :\n",u->read32());
-                  printf("Alt Bitrate     %u :\n",u->read32());
-                  printf("Alt Bsize       %u :\n",u->read32());
-                  printf("Alt Bfullness   %u :\n",u->read32());
-                  printf("Max object Size %u :\n",u->read32());
-                  printf("Flags           0x%x :\n",u->read32());
-                  printf("Stream no       %u :\n",u->read16());
-                  printf("Stream lang     %u :\n",u->read16());
-                  printf("Stream time/fra %lu :\n",u->read64());
-                  streamNameCount=u->read16();
-                  payloadCount=u->read16();
-                  printf("Stream Nm Count %u :\n",streamNameCount);
-                  printf("Payload count   %u :\n",payloadCount);
-                  for(int stream=0;stream<streamNameCount;stream++)
-                  {
-                    u->read16();
-                    skip=u->read16();
-                    u->skip(skip);
-                  }
-                  uint32_t size;
-                  for(int payload=0;payload<payloadCount;payload++)
-                  {
-                    for(int pp=0;pp<16;pp++) printf("0x%02x,",u->read8());
-                    printf("\n");
-                    skip=u->read16();
-                    size=u->read32();
-                    u->skip(size);
-                    printf("Extra Data : %d, skipd %d\n",size,skip);
-                  }
-                  printf("We are at %x\n",ftello(_fd));
-                }
-                u->skipChunk();
-          }
-          delete u;
-      }
-      break;
-#endif      
-      case ADM_CHUNK_FILE_HEADER_CHUNK:
-        {
-            // Client GID
-            printf("Client        :");
-            for(int z=0;z<16;z++) printf(":%02x",s->read8());
-            printf("\n");
-            printf("File size     : %08lx\n",s->read64());
-            printf("Creation time : %08lx\n",s->read64());
-            printf("Number of pack: %08lx\n",s->read64());
-            printf("Timestamp 1   : %08lx\n",s->read64());
-            _duration=s->read64();
-            printf("Timestamp 2   : %08lx\n",_duration);
-            printf("Timestamp 3   : %04x\n",s->read32());
-            printf("Preload       : %04x\n",s->read32());
-            printf("Flags         : %04x\n",s->read32());
-            mx=s->read32();
-            mn=s->read32();
-            if(mx!=mn)
-            {
-              printf("Variable packet size!!\n");
-              delete s;
-              return 0; 
-            }
-            _packetSize=mx;
-            printf("Min size      : %04x\n",mx);
-            printf("Max size      : %04x\n",mn);
-            printf("Uncompres.size: %04x\n",s->read32());
-          }
-          break;
-      case ADM_CHUNK_STREAM_HEADER_CHUNK:
-      {
-         // Client GID
-        uint32_t audiovideo=0; // video=1, audio=2, 0=unknown
-        uint32_t sid;
-        s->read(gid,16);
-        printf("Type            :");
-        for(int z=0;z<16;z++) printf("0x%02x,",gid[z]);
-        if(!memcmp(gid,asf_video,16))
-        {
-          printf("(video)");
-          audiovideo=1;
-        } else
-        {
-          if(!memcmp(gid,asf_audio,16))
-          {
-            printf("(audio)"); 
-            audiovideo=2;
-          } else printf("(? ? ? ?)"); 
-        }
-        printf("\nConceal       :");
-        for(int z=0;z<16;z++) printf(":%02x",s->read8());
-        printf("\n");
-        printf("Reserved    : %08x\n",s->read64());
-        printf("Total Size  : %04x\n",s->read32());
-        printf("Size        : %04x\n",s->read32());
-        sid=s->read16();
-        printf("Stream nb   : %04x\n",sid);
-        printf("Reserved    : %04x\n",s->read32());
-        switch(audiovideo)
-        {
-          case 1: // Video
-          {
-                    _videoStreamId=sid;
-                    if(!loadVideo(s))
-                    {
-                      delete s;
-                      return 0; 
-                    }
-                    break;
-          }
-              break;
-          case 2: // audio
-          {
-            asfAudioTrak *trk=&(_allAudioTracks[_nbAudioTrack]);
-            ADM_assert(_nbAudioTrack<ASF_MAX_AUDIO_TRACK);
-            trk->streamIndex=sid;
-            s->read((uint8_t *)&(trk->wavHeader),sizeof(WAVHeader));
-
+/***************************************************************************
+    copyright            : (C) 2006 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+
+#include <string.h>
+
+#include "math.h"
+
+#include "ADM_utilities/default.h"
+#include "ADM_editor/ADM_Video.h"
+#include <ADM_assert.h>
+
+#include "fourcc.h"
+#include "ADM_toolkit/toolkit.hxx"
+//#include "DIA_working.h"
+#include "ADM_asf.h"
+#include "ADM_asfPacket.h"
+
+#include "ADM_osSupport/ADM_debugID.h"
+#define MODULE_NAME MODULE_ASF
+#include "ADM_osSupport/ADM_debug.h"
+
+static const uint8_t asf_audio[16]={0x40,0x9e,0x69,0xf8,0x4d,0x5b,0xcf,0x11,0xa8,0xfd,0x00,0x80,0x5f,0x5c,0x44,0x2b};
+static const uint8_t asf_video[16]={0xc0,0xef,0x19,0xbc,0x4d,0x5b,0xcf,0x11,0xa8,0xfd,0x00,0x80,0x5f,0x5c,0x44,0x2b};
+
+
+WAVHeader *asfHeader::getAudioInfo(void )
+{
+  if(!_curAudio) return NULL;
+  return _curAudio->getInfo();
+}
+/*
+    __________________________________________________________
+*/
+
+uint8_t asfHeader::getAudioStream(AVDMGenericAudioStream **audio)
+{
+ 
+  *audio=_curAudio;
+  return 1; 
+}
+/*
+    __________________________________________________________
+*/
+
+void asfHeader::Dump(void)
+{
+ 
+  printf("*********** ASF INFO***********\n");
+}
+/*
+    __________________________________________________________
+*/
+
+uint8_t asfHeader::close(void)
+{
+	if (_fd) 
+		fclose(_fd);
+
+	_fd=NULL;
+
+  if(_videoExtraData)
+  {
+    delete [] _videoExtraData;
+    _videoExtraData=NULL; 
+  }
+  if(myName)
+  {
+    delete myName;
+    myName=NULL; 
+  }
+  if(_extraData)
+  {
+    delete [] _extraData;
+    _extraData=NULL; 
+  }
+  if(_index)
+  {
+    delete [] _index; 
+  }
+  _index=NULL;
+  if(_packet)
+    delete _packet;
+  _packet=NULL;
+  
+  for(int i=0;i<_nbAudioTrack;i++)
+  {
+    asfAudioTrak *trk=&(_allAudioTracks[i]);
+    if(trk->extraData) delete [] trk->extraData;
+    trk->extraData=NULL;
+  }
+}
+uint8_t       asfHeader::getExtraHeaderData(uint32_t *len, uint8_t **data)
+{
+  *len=_extraDataLen;
+  *data=_extraData;
+  return 1; 
+}
+/*
+    __________________________________________________________
+*/
+
+ asfHeader::asfHeader( void ) : vidHeader()
+{
+  _fd=NULL;
+  _videoIndex=-1;
+  myName=NULL;
+  _extraDataLen=0;
+  _extraData=NULL;
+  _packetSize=0;
+  _videoStreamId=0;
+  nbImage=0;
+  _index=NULL;
+  _packet=NULL;
+  _curAudio=NULL;
+  _nbPackets=0;
+  printf("%u\n",sizeof(_allAudioTracks));
+  memset(&(_allAudioTracks[0]),0,sizeof(_allAudioTracks));
+
+  _nbAudioTrack=0;
+  _currentAudioStream=0;
+}
+/*
+    __________________________________________________________
+*/
+
+ asfHeader::~asfHeader(  )
+{
+  close();
+}
+/*
+    __________________________________________________________
+*/
+
+uint8_t asfHeader::open(const char *name)
+{
+  _fd=fopen(name,"rb");
+  if(!_fd)
+  {
+    GUI_Error_HIG("File Error.","Cannot open file\n");
+    return 0; 
+  }
+  myName=ADM_strdup(name);
+  if(!getHeaders())
+  {
+    return 0; 
+  }
+  buildIndex();
+  fseeko(_fd,_dataStartOffset,SEEK_SET);
+  _packet=new asfPacket(_fd,_nbPackets,_packetSize,&readQueue,_dataStartOffset);
+  curSeq=1;
+  if(_nbAudioTrack)
+  {
+    _curAudio=new asfAudio(this,_currentAudioStream);
+  }
+  return 1;
+}
+/*
+    __________________________________________________________
+*/
+
+ 
+/*
+    __________________________________________________________
+*/
+
+  uint8_t  asfHeader::setFlag(uint32_t frame,uint32_t flags)
+{
+  ADM_assert(frame<nbImage);
+  _index[frame].flags=flags;
+  return 1; 
+}
+/*
+    __________________________________________________________
+*/
+
+uint32_t asfHeader::getFlags(uint32_t frame,uint32_t *flags)
+{
+  if(frame>=nbImage) return 0;
+  if(!frame) *flags=AVI_KEY_FRAME;
+  else 
+      *flags=_index[frame].flags;
+  return 1; 
+}
+/*
+    __________________________________________________________
+*/
+
+uint8_t  asfHeader::getFrameNoAlloc(uint32_t framenum,ADMCompressedImage *img)
+{
+  img->dataLength=0;
+  img->flags=AVI_KEY_FRAME;
+  if(framenum>=nbImage)
+  {
+    printf("[ASF] Going out of bound %u %u\n",framenum, nbImage);
+    return 0;
+  }
+  if(!_index[framenum].frameLen)
+  {
+    return 1; // Empty frame 
+  }
+  // In case curSeq is stored as one byte..
+  curSeq&=0xff;
+  //
+  uint32_t len=0;
+  aprintf("Framenum %u len: %u curSeq %u frameSeq=%u packetnb=%u \n",
+         framenum,_index[framenum].frameLen,curSeq,
+         _index[framenum].segNb,_index[framenum].packetNb);
+  // Seeking ?
+  if(_index[framenum].segNb!=curSeq)
+  {
+    printf("Seeking.. curseq:%u wanted seq:%u\n",curSeq,_index[framenum].segNb);
+    if(!_packet->goToPacket(_index[framenum].packetNb))
+    {
+      printf("[ASF] Cannot seek to frame %u\n",framenum);
+      return 0; 
+    }
+    _packet->purge();
+    curSeq=_index[framenum].segNb;
+    printf("Seeking starting at seq=%u\n",curSeq);
+  }
+  
+  
+  len=0;
+  uint32_t delta;
+  while(1)
+  {
+   
+    
+    
+    while(!readQueue.isEmpty())
+    {
+      asfBit *bit;
+      ADM_assert(readQueue.pop((void**)&bit));
+      aprintf(">found packet of size %d seq %d, while curseq =%d wanted seg=%u current offset=%u\n",bit->len,bit->sequence,curSeq,_index[framenum].segNb,len);
+      // Here it is tricky
+      // if len==0 we are reading the first part of our frame
+      // The packet may starts with segments from the previous frame
+      // discard them
+      // Delta is just a security as it should be slightly >10
+      delta=256+bit->sequence-_index[framenum].segNb;
+      delta &=0xff;
+      if(!len) // Starting a new frame
+      {
+          if(_index[framenum].segNb != bit->sequence )
+          {
+            aprintf("Dropping seq=%u too old for %u delta %d\n",
+                  bit->sequence,_index[framenum].segNb,delta);
+            delete[] bit->data;
+            delete bit;
+            if(delta<230)
+            {
+              printf("Very suspicious\n");
+              printf("Very suspicious\n");
+              printf("Very suspicious\n");
+              printf("Very suspicious\n");
+              printf("Very suspicious\n");
+            }
+            continue; 
+          }
+          // We have found our first chunk
+          curSeq=bit->sequence;
+          memcpy(img->data,bit->data,bit->len);
+          len=bit->len;
+          delete[] bit->data;
+          delete bit;
+          continue;
+      }
+      // Continuing a frame
+      // If the seq number is different it is the beginning of a new frame
+      if(bit->sequence!=curSeq )
+      {
+        aprintf("New sequence %u->%u while loading %u frame\n",curSeq,bit->sequence,framenum);
+        img->dataLength=len;
+        readQueue.pushBack(bit); // don't delete it, we will use it later...
+        curSeq=bit->sequence;
+        goto gotcha;
+      }
+      // still same sequence ...add
+      memcpy(img->data+len,bit->data,bit->len);
+      len+=bit->len;
+	  delete[] bit->data;
+      delete bit;
+    }
+    if(!_packet->nextPacket(_videoStreamId))
+    {
+      printf("[ASF] Packet Error\n");
+      return 0; 
+    }
+    _packet->skipPacket();
+  }
+gotcha:
+  
+  img->dataLength=len;
+  if(len!=_index[framenum].frameLen)
+  {
+    printf("[ASF] Frame=%u :-> Mismatch found len : %u expected %u\n",framenum,len, _index[framenum].frameLen);
+  }
+  aprintf(">>Len %d seq %d\n",len,curSeq);
+  return 1; 
+}
+/*
+    __________________________________________________________
+*/
+
+/*******************************************
+  Read Headers to collect information 
+********************************************/
+uint8_t asfHeader::getHeaders(void)
+{
+  uint32_t i=0,nbSubChunk,hi,lo;
+  const chunky *id;
+  uint8_t gid[16];
+  uint32_t mn=0,mx=0;
+  asfChunk chunk(_fd);
+  // The first header is header chunk
+  chunk.nextChunk();
+  id=chunk.chunkId();
+  if(id->id!=ADM_CHUNK_HEADER_CHUNK)
+  {
+    printf("[ASF] expected header chunk\n"); 
+    return 0;
+  }
+  printf("[ASF] getting headers\n");
+  chunk.dump();
+  nbSubChunk=chunk.read32();
+  printf("NB subchunk :%u\n",nbSubChunk);
+  chunk.read8();
+  chunk.read8();
+  for(i=0;i<nbSubChunk;i++)
+  {
+    asfChunk *s=new asfChunk(_fd);
+    uint32_t skip;
+    s->nextChunk();
+    printf("***************\n");  
+    id=s->chunkId();
+    s->dump();
+    switch(id->id)
+    {
+#if 0      
+      case ADM_CHUNK_HEADER_EXTENSION_CHUNK:
+      {
+        s->skip(16); // Clock type extension ????
+        printf("?? %d\n",s->read16());
+        printf("?? %d\n",s->read32());
+          
+        uint32_t streamNameCount;
+        uint32_t payloadCount;
+          
+          asfChunk *u=new asfChunk(_fd);
+          for(int zzz=0;zzz<8;zzz++)
+          {
+              u->nextChunk();
+              u->dump();
+              id=u->chunkId();
+              if(id->id==ADM_CHUNK_EXTENDED_STREAM_PROP)
+              {
+                  s->skip(8); // start time 
+                  s->skip(8); // end time
+                  printf("Bitrate         %u :\n",u->read32());
+                  printf("Buffer Size     %u :\n",u->read32());
+                  printf("BFill           %u :\n",u->read32());
+                  printf("Alt Bitrate     %u :\n",u->read32());
+                  printf("Alt Bsize       %u :\n",u->read32());
+                  printf("Alt Bfullness   %u :\n",u->read32());
+                  printf("Max object Size %u :\n",u->read32());
+                  printf("Flags           0x%x :\n",u->read32());
+                  printf("Stream no       %u :\n",u->read16());
+                  printf("Stream lang     %u :\n",u->read16());
+                  printf("Stream time/fra %lu :\n",u->read64());
+                  streamNameCount=u->read16();
+                  payloadCount=u->read16();
+                  printf("Stream Nm Count %u :\n",streamNameCount);
+                  printf("Payload count   %u :\n",payloadCount);
+                  for(int stream=0;stream<streamNameCount;stream++)
+                  {
+                    u->read16();
+                    skip=u->read16();
+                    u->skip(skip);
+                  }
+                  uint32_t size;
+                  for(int payload=0;payload<payloadCount;payload++)
+                  {
+                    for(int pp=0;pp<16;pp++) printf("0x%02x,",u->read8());
+                    printf("\n");
+                    skip=u->read16();
+                    size=u->read32();
+                    u->skip(size);
+                    printf("Extra Data : %d, skipd %d\n",size,skip);
+                  }
+                  printf("We are at %x\n",ftello(_fd));
+                }
+                u->skipChunk();
+          }
+          delete u;
+      }
+      break;
+#endif      
+      case ADM_CHUNK_FILE_HEADER_CHUNK:
+        {
+            // Client GID
+            printf("Client        :");
+            for(int z=0;z<16;z++) printf(":%02x",s->read8());
+            printf("\n");
+            printf("File size     : %08lx\n",s->read64());
+            printf("Creation time : %08lx\n",s->read64());
+            printf("Number of pack: %08lx\n",s->read64());
+            printf("Timestamp 1   : %08lx\n",s->read64());
+            _duration=s->read64();
+            printf("Timestamp 2   : %08lx\n",_duration);
+            printf("Timestamp 3   : %04x\n",s->read32());
+            printf("Preload       : %04x\n",s->read32());
+            printf("Flags         : %04x\n",s->read32());
+            mx=s->read32();
+            mn=s->read32();
+            if(mx!=mn)
+            {
+              printf("Variable packet size!!\n");
+              delete s;
+              return 0; 
+            }
+            _packetSize=mx;
+            printf("Min size      : %04x\n",mx);
+            printf("Max size      : %04x\n",mn);
+            printf("Uncompres.size: %04x\n",s->read32());
+          }
+          break;
+      case ADM_CHUNK_STREAM_HEADER_CHUNK:
+      {
+         // Client GID
+        uint32_t audiovideo=0; // video=1, audio=2, 0=unknown
+        uint32_t sid;
+        s->read(gid,16);
+        printf("Type            :");
+        for(int z=0;z<16;z++) printf("0x%02x,",gid[z]);
+        if(!memcmp(gid,asf_video,16))
+        {
+          printf("(video)");
+          audiovideo=1;
+        } else
+        {
+          if(!memcmp(gid,asf_audio,16))
+          {
+            printf("(audio)"); 
+            audiovideo=2;
+          } else printf("(? ? ? ?)"); 
+        }
+        printf("\nConceal       :");
+        for(int z=0;z<16;z++) printf(":%02x",s->read8());
+        printf("\n");
+        printf("Reserved    : %08x\n",s->read64());
+        printf("Total Size  : %04x\n",s->read32());
+        printf("Size        : %04x\n",s->read32());
+        sid=s->read16();
+        printf("Stream nb   : %04x\n",sid);
+        printf("Reserved    : %04x\n",s->read32());
+        switch(audiovideo)
+        {
+          case 1: // Video
+          {
+                    _videoStreamId=sid;
+                    if(!loadVideo(s))
+                    {
+                      delete s;
+                      return 0; 
+                    }
+                    break;
+          }
+              break;
+          case 2: // audio
+          {
+            asfAudioTrak *trk=&(_allAudioTracks[_nbAudioTrack]);
+            ADM_assert(_nbAudioTrack<ASF_MAX_AUDIO_TRACK);
+            trk->streamIndex=sid;
+            s->read((uint8_t *)&(trk->wavHeader),sizeof(WAVHeader));
+
 		#ifdef ADM_BIG_ENDIAN
 			Endian_WavHeader(&(trk->wavHeader));
-		#endif
-
-            trk->extraDataLen=s->read16();
-            printf("Extension :%u bytes\n",trk->extraDataLen);
-            if(trk->extraDataLen)
-            {
-              trk->extraData=new uint8_t[trk->extraDataLen];
-              s->read(trk->extraData,trk->extraDataLen);
-            }
-              printf("#block in group   :%d\n",s->read8());
-              printf("#byte in group    :%d\n",s->read16());
-              printf("Align1            :%d\n",s->read16());
-              printf("Align2            :%d\n",s->read16());
-              _nbAudioTrack++;
-            
-          }
-          break;
-          default:break; 
-          
-        }
-      }
-      break;
-       default:
-         break;
-    }
-    s->skipChunk();
-    delete s;
-  }
-  printf("End of headers\n");
-  return 1;
-}
-uint8_t    asfHeader::changeAudioStream(uint32_t newstream)
-{
-  ADM_assert(_currentAudioStream<_nbAudioTrack);
-  _currentAudioStream=newstream;
-  return 1;
-}
-uint32_t    asfHeader::getCurrentAudioStreamNumber(void)
-{
-  return _currentAudioStream;
-}
-uint8_t     asfHeader::getAudioStreamsInfo(uint32_t *nbStreams, audioInfo **infos)
-{
-    *nbStreams=_nbAudioTrack;
-    if(_nbAudioTrack)
-    {
-      *infos=new audioInfo[_nbAudioTrack];
-      for(int i=0;i<_nbAudioTrack;i++)
-      {
-        WAV2AudioInfo(&(_allAudioTracks[i].wavHeader),&((*infos)[i]));
-      }
-    }
-    return 1;
-}
-uint8_t asfHeader::loadVideo(asfChunk *s)
-{
-  uint32_t w,h,x;
-            w=s->read32();
-            h=s->read32();
-            s->read8();
-            x=s->read16();
-            _isvideopresent=1;
-
-            memset(&_mainaviheader,0,sizeof(_mainaviheader));
-            _mainaviheader.dwWidth=w;
-            _mainaviheader.dwHeight=h;
-            _video_bih.biWidth=w;
-            _video_bih.biHeight=h;
-            printf("Pic Width  %04d\n",w);
-            printf("Pic Height %04d\n",h);
-            printf(" BMP size  %04d (%04d)\n",x,sizeof(BITMAPINFOHEADER));
-            s->read((uint8_t *)&_video_bih,sizeof(BITMAPINFOHEADER));
-
+		#endif
+
+            trk->extraDataLen=s->read16();
+            printf("Extension :%u bytes\n",trk->extraDataLen);
+            if(trk->extraDataLen)
+            {
+              trk->extraData=new uint8_t[trk->extraDataLen];
+              s->read(trk->extraData,trk->extraDataLen);
+            }
+              printf("#block in group   :%d\n",s->read8());
+              printf("#byte in group    :%d\n",s->read16());
+              printf("Align1            :%d\n",s->read16());
+              printf("Align2            :%d\n",s->read16());
+              _nbAudioTrack++;
+            
+          }
+          break;
+          default:break; 
+          
+        }
+      }
+      break;
+       default:
+         break;
+    }
+    s->skipChunk();
+    delete s;
+  }
+  printf("End of headers\n");
+  return 1;
+}
+uint8_t    asfHeader::changeAudioStream(uint32_t newstream)
+{
+  ADM_assert(_currentAudioStream<_nbAudioTrack);
+  _currentAudioStream=newstream;
+  return 1;
+}
+uint32_t    asfHeader::getCurrentAudioStreamNumber(void)
+{
+  return _currentAudioStream;
+}
+uint8_t     asfHeader::getAudioStreamsInfo(uint32_t *nbStreams, audioInfo **infos)
+{
+    *nbStreams=_nbAudioTrack;
+    if(_nbAudioTrack)
+    {
+      *infos=new audioInfo[_nbAudioTrack];
+      for(int i=0;i<_nbAudioTrack;i++)
+      {
+        WAV2AudioInfo(&(_allAudioTracks[i].wavHeader),&((*infos)[i]));
+      }
+    }
+    return 1;
+}
+uint8_t asfHeader::loadVideo(asfChunk *s)
+{
+  uint32_t w,h,x;
+            w=s->read32();
+            h=s->read32();
+            s->read8();
+            x=s->read16();
+            _isvideopresent=1;
+
+            memset(&_mainaviheader,0,sizeof(_mainaviheader));
+            _mainaviheader.dwWidth=w;
+            _mainaviheader.dwHeight=h;
+            _video_bih.biWidth=w;
+            _video_bih.biHeight=h;
+            printf("Pic Width  %04d\n",w);
+            printf("Pic Height %04d\n",h);
+            printf(" BMP size  %04d (%04d)\n",x,sizeof(BITMAPINFOHEADER));
+            s->read((uint8_t *)&_video_bih,sizeof(BITMAPINFOHEADER));
+
 		#ifdef ADM_BIG_ENDIAN
 			Endian_BitMapInfo(&_video_bih);
-		#endif
-
-            _videostream.dwScale=1000;
-            _videostream.dwRate=30000;
-
-            _videostream.fccHandler=_video_bih.biCompression;
-            printf("Codec : <%s> (%04x)\n",
-                    fourCC::tostring(_video_bih.biCompression),_video_bih.biCompression);
-            if(fourCC::check(_video_bih.biCompression,(uint8_t *)"DVR "))
-            {
-              // It is MS DVR, fail so that the mpeg2 indexer can take it from here
-              _videostream.fccHandler=_video_bih.biCompression=fourCC::get((uint8_t *)"MPEG");
-              printf("This is MSDVR, not ASF\n");
-              return 0; 
-            }
-            printBih(&_video_bih);
-            if(x>sizeof(BITMAPINFOHEADER))
-            {
-              _extraDataLen=x-sizeof(BITMAPINFOHEADER);
-              _extraData=new uint8_t[_extraDataLen];
-              s->read(_extraData,_extraDataLen);
-            }
-            return 1;
-}
-/*
-    Scan the file to build an index
-    
-    Header Chunk
-            Chunk
-            Chunk
-            Chunk
-            
-    Data chunk
-            Chunk
-            Chunk
-            
-    We skip the 1st one, and just read the header of the 2nd one
-    
-*/
-uint8_t asfHeader::buildIndex(void)
-{
-  uint32_t fSize;
-  const chunky *id;
-  uint32_t chunkFound;
-  uint32_t r=5;
-  uint32_t len;
-  
-  fseeko(_fd,0,SEEK_END);
-  fSize=ftello(_fd);
-  fseeko(_fd,0,SEEK_SET);
-  
-  asfChunk h(_fd);
-  printf("[ASF] ********** Building index **********\n");
-  printf("[ASF] Searching data\n");
-  while(r--)
-  {
-    h.nextChunk();    // Skip headers
-    id=h.chunkId();
-    h.dump();
-    if(id->id==ADM_CHUNK_DATA_CHUNK) break;
-    h.skipChunk();
-  }
-  if(id->id!=ADM_CHUNK_DATA_CHUNK) return 0;
-  // Remove leftover from DATA_chunk
- // Unknown	GUID	16
-//       Number of packets	UINT64	8
-//       Unknown	UINT8	1
-//       Unknown	UINT8	1
-//   
-  h.read32();
-  h.read32();
-  h.read32();
-  h.read32();
-  _nbPackets=(uint32_t) h.read64();
-  h.read16();
-  
-  len=h.chunkLen-16-8-2-24;
-  
-  printf("[ASF] nbPacket  : %u\n",_nbPackets);
-  printf("[ASF] len to go : %u\n",len);
-  printf("[ASF] scanning data\n");
-  _dataStartOffset=ftello(_fd);
-  
-  // Here we go
-  //DIA_working *working=new DIA_working("indexing asf");
-  asfPacket *aPacket=new asfPacket(_fd,_nbPackets,_packetSize,
-                                   &readQueue,_dataStartOffset);
-  uint32_t packet=1;
-#define MAXIMAGE (_nbPackets)
-  uint32_t sequence=1;
-  uint32_t ceilImage=MAXIMAGE;
-
-  nbImage=0;
-  asfIndex *tmpIndex=new asfIndex[ceilImage];
-  memset(tmpIndex,0,sizeof(asfIndex)*ceilImage);
-  len=0;
-  tmpIndex[0].segNb=1;
-  while(packet<_nbPackets)
-  {
-    while(!readQueue.isEmpty())
-    {
-      asfBit *bit=NULL;
-      ADM_assert(readQueue.pop((void**)&bit));
-      if(nbImage>=ceilImage-1)
-      {  // Expand if our first guess was too small
-           uint32_t newceil=ceilImage*2;
-           asfIndex *tmptmpIndex=new asfIndex[newceil];
-           memset(tmptmpIndex,0,sizeof(asfIndex)*newceil);
-           memcpy(tmptmpIndex,tmpIndex,sizeof(asfIndex)*ceilImage);
-           delete [] tmpIndex;
-           tmpIndex=tmptmpIndex;
-           ceilImage=newceil;
-      }
-      if(bit->stream==_videoStreamId)
-      {
-          aprintf(">found packet of size %d seq %d, while curseq =%d\n",bit->len,bit->sequence,curSeq);
-          if(bit->sequence!=sequence)
-          {
-            tmpIndex[nbImage].frameLen=len;
-            aprintf("New sequence\n");
-            if( ((sequence+1)&0xff)!=(bit->sequence&0xff))
-            {
-                printf("!!!!!!!!!!!! non continuous sequence %u %u\n",sequence,bit->sequence); 
-    #if 1         
-                // Let's insert a couple of null frame
-                int32_t delta,start,end;
-                
-                start=256+bit->sequence-sequence-1;
-                start&=0xff;
-                printf("!!!!!!!!!!!! Delta %d\n",start);
-                
-                for(int filler=0;filler<start;filler++)
-                {
-                  tmpIndex[++nbImage].frameLen=0;
-                }
-    #endif            
-            }
-            nbImage++;
-            ADM_assert(nbImage<ceilImage);
-            tmpIndex[nbImage].frameLen=0;
-            tmpIndex[nbImage].segNb=bit->sequence;
-            tmpIndex[nbImage].packetNb=bit->packet;
-            tmpIndex[nbImage].flags=bit->flags;
-
-            for(int z=0;z<_nbAudioTrack;z++)
-            {
-              tmpIndex[nbImage].audioSeen[z]=_allAudioTracks[z].length;
-            }
-            readQueue.pushBack(bit);
-    
-            sequence=bit->sequence;
-            len=0;
-            continue;
-          }
-          len+=bit->len;
-      } // End of video stream Id
-      else  // Audio ?
-      {
-        int found=0;
-        for(int i=0;i<_nbAudioTrack && !found;i++)
-        {
-          if(bit->stream == _allAudioTracks[i].streamIndex)
-          {
-            
-            _allAudioTracks[i].length+=bit->len;
-            found=1;
-          }
-        }
-        if(!found) 
-        {
-          printf("Unmapped stream %u\n",bit->stream); 
-        }
-      }
-     delete[] bit->data;
-     delete bit;
-    }
-    //working->update(packet,_nbPackets);
-
-    packet++;
-    aPacket->nextPacket(0xff); // All packets
-    aPacket->skipPacket();
-  }
-  delete aPacket;
-  //delete working;
-  /* Compact index */
-  _index=new asfIndex[nbImage];
-  memcpy(_index,tmpIndex,sizeof(asfIndex)*nbImage);
-  delete [] tmpIndex;
-  
-  fseeko(_fd,_dataStartOffset,SEEK_SET);
-  printf("[ASF] %u images found\n",nbImage);
-  printf("[ASF] ******** End of buildindex *******\n");
-  _videostream.dwLength=_mainaviheader.dwTotalFrames=nbImage;
-  if(!nbImage) return 0;
-  
-  // Update fps
-  // In fact it is an average fps
-  // FIXME
-  float f=nbImage;
-  uint32_t ps;
-  
-  f*=1000.*1000.*10000.;
-  f=f/_duration;
-  ps=(uint32_t)f;
-  // Round up to the closed 0.5 = 500
-  ps=(ps+490)/500;
-  ps*=500;
-  
-  _videostream.dwScale=1000;
-  _videostream.dwRate=ps;
-
-  return 1;
-  
-}
-//EOF
+		#endif
+
+            _videostream.dwScale=1000;
+            _videostream.dwRate=30000;
+
+            _videostream.fccHandler=_video_bih.biCompression;
+            printf("Codec : <%s> (%04x)\n",
+                    fourCC::tostring(_video_bih.biCompression),_video_bih.biCompression);
+            if(fourCC::check(_video_bih.biCompression,(uint8_t *)"DVR "))
+            {
+              // It is MS DVR, fail so that the mpeg2 indexer can take it from here
+              _videostream.fccHandler=_video_bih.biCompression=fourCC::get((uint8_t *)"MPEG");
+              printf("This is MSDVR, not ASF\n");
+              return 0; 
+            }
+            printBih(&_video_bih);
+            if(x>sizeof(BITMAPINFOHEADER))
+            {
+              _extraDataLen=x-sizeof(BITMAPINFOHEADER);
+              _extraData=new uint8_t[_extraDataLen];
+              s->read(_extraData,_extraDataLen);
+            }
+            return 1;
+}
+/*
+    Scan the file to build an index
+    
+    Header Chunk
+            Chunk
+            Chunk
+            Chunk
+            
+    Data chunk
+            Chunk
+            Chunk
+            
+    We skip the 1st one, and just read the header of the 2nd one
+    
+*/
+uint8_t asfHeader::buildIndex(void)
+{
+  uint32_t fSize;
+  const chunky *id;
+  uint32_t chunkFound;
+  uint32_t r=5;
+  uint32_t len;
+  
+  fseeko(_fd,0,SEEK_END);
+  fSize=ftello(_fd);
+  fseeko(_fd,0,SEEK_SET);
+  
+  asfChunk h(_fd);
+  printf("[ASF] ********** Building index **********\n");
+  printf("[ASF] Searching data\n");
+  while(r--)
+  {
+    h.nextChunk();    // Skip headers
+    id=h.chunkId();
+    h.dump();
+    if(id->id==ADM_CHUNK_DATA_CHUNK) break;
+    h.skipChunk();
+  }
+  if(id->id!=ADM_CHUNK_DATA_CHUNK) return 0;
+  // Remove leftover from DATA_chunk
+ // Unknown	GUID	16
+//       Number of packets	UINT64	8
+//       Unknown	UINT8	1
+//       Unknown	UINT8	1
+//   
+  h.read32();
+  h.read32();
+  h.read32();
+  h.read32();
+  _nbPackets=(uint32_t) h.read64();
+  h.read16();
+  
+  len=h.chunkLen-16-8-2-24;
+  
+  printf("[ASF] nbPacket  : %u\n",_nbPackets);
+  printf("[ASF] len to go : %u\n",len);
+  printf("[ASF] scanning data\n");
+  _dataStartOffset=ftello(_fd);
+  
+  // Here we go
+  //DIA_working *working=new DIA_working("indexing asf");
+  asfPacket *aPacket=new asfPacket(_fd,_nbPackets,_packetSize,
+                                   &readQueue,_dataStartOffset);
+  uint32_t packet=1;
+#define MAXIMAGE (_nbPackets)
+  uint32_t sequence=1;
+  uint32_t ceilImage=MAXIMAGE;
+
+  nbImage=0;
+  asfIndex *tmpIndex=new asfIndex[ceilImage];
+  memset(tmpIndex,0,sizeof(asfIndex)*ceilImage);
+  len=0;
+  tmpIndex[0].segNb=1;
+  while(packet<_nbPackets)
+  {
+    while(!readQueue.isEmpty())
+    {
+      asfBit *bit=NULL;
+      ADM_assert(readQueue.pop((void**)&bit));
+      if(nbImage>=ceilImage-1)
+      {  // Expand if our first guess was too small
+           uint32_t newceil=ceilImage*2;
+           asfIndex *tmptmpIndex=new asfIndex[newceil];
+           memset(tmptmpIndex,0,sizeof(asfIndex)*newceil);
+           memcpy(tmptmpIndex,tmpIndex,sizeof(asfIndex)*ceilImage);
+           delete [] tmpIndex;
+           tmpIndex=tmptmpIndex;
+           ceilImage=newceil;
+      }
+      if(bit->stream==_videoStreamId)
+      {
+          aprintf(">found packet of size %d seq %d, while curseq =%d\n",bit->len,bit->sequence,curSeq);
+          if(bit->sequence!=sequence)
+          {
+            tmpIndex[nbImage].frameLen=len;
+            aprintf("New sequence\n");
+            if( ((sequence+1)&0xff)!=(bit->sequence&0xff))
+            {
+                printf("!!!!!!!!!!!! non continuous sequence %u %u\n",sequence,bit->sequence); 
+    #if 1         
+                // Let's insert a couple of null frame
+                int32_t delta,start,end;
+                
+                start=256+bit->sequence-sequence-1;
+                start&=0xff;
+                printf("!!!!!!!!!!!! Delta %d\n",start);
+                
+                for(int filler=0;filler<start;filler++)
+                {
+                  tmpIndex[++nbImage].frameLen=0;
+                }
+    #endif            
+            }
+            nbImage++;
+            ADM_assert(nbImage<ceilImage);
+            tmpIndex[nbImage].frameLen=0;
+            tmpIndex[nbImage].segNb=bit->sequence;
+            tmpIndex[nbImage].packetNb=bit->packet;
+            tmpIndex[nbImage].flags=bit->flags;
+
+            for(int z=0;z<_nbAudioTrack;z++)
+            {
+              tmpIndex[nbImage].audioSeen[z]=_allAudioTracks[z].length;
+            }
+            readQueue.pushBack(bit);
+    
+            sequence=bit->sequence;
+            len=0;
+            continue;
+          }
+          len+=bit->len;
+      } // End of video stream Id
+      else  // Audio ?
+      {
+        int found=0;
+        for(int i=0;i<_nbAudioTrack && !found;i++)
+        {
+          if(bit->stream == _allAudioTracks[i].streamIndex)
+          {
+            
+            _allAudioTracks[i].length+=bit->len;
+            found=1;
+          }
+        }
+        if(!found) 
+        {
+          printf("Unmapped stream %u\n",bit->stream); 
+        }
+      }
+     delete[] bit->data;
+     delete bit;
+    }
+    //working->update(packet,_nbPackets);
+
+    packet++;
+    aPacket->nextPacket(0xff); // All packets
+    aPacket->skipPacket();
+  }
+  delete aPacket;
+  //delete working;
+  /* Compact index */
+  _index=new asfIndex[nbImage];
+  memcpy(_index,tmpIndex,sizeof(asfIndex)*nbImage);
+  delete [] tmpIndex;
+  
+  fseeko(_fd,_dataStartOffset,SEEK_SET);
+  printf("[ASF] %u images found\n",nbImage);
+  printf("[ASF] ******** End of buildindex *******\n");
+  _videostream.dwLength=_mainaviheader.dwTotalFrames=nbImage;
+  if(!nbImage) return 0;
+  
+  // Update fps
+  // In fact it is an average fps
+  // FIXME
+  float f=nbImage;
+  uint32_t ps;
+  
+  f*=1000.*1000.*10000.;
+  f=f/_duration;
+  ps=(uint32_t)f;
+  // Round up to the closed 0.5 = 500
+  ps=(ps+490)/500;
+  ps*=500;
+  
+  _videostream.dwScale=1000;
+  _videostream.dwRate=ps;
+
+  return 1;
+  
+}
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -166,7 +166,7 @@
              asfHeader( void );
     virtual  ~asfHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -41,7 +41,7 @@
 }
 
 
-uint8_t avsHeader::open(char *name)
+uint8_t avsHeader::open(const char *name)
 {
     mySocket=0;
     if(!bindMe(9999))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -30,7 +30,7 @@
         avsHeader( void );
         ~avsHeader(  );
 // AVI io
-        virtual 	uint8_t			open(char *name);
+        virtual 	uint8_t			open(const char *name);
         virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -93,7 +93,7 @@
       \brief open the flv file, gather infos and build index(es).
 */
 
-uint8_t flvHeader::open(char *name)
+uint8_t flvHeader::open(const char *name)
 {
   uint32_t prevLen, type, size, pts,pos=0;
   

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -110,7 +110,7 @@
             flvHeader( void );
    virtual  ~flvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -106,7 +106,7 @@
 // Open and index the (small) h263
 //
 //______________________________________
-uint8_t    h263Header::open(char *name)
+uint8_t    h263Header::open(const char *name)
 {
 	uint32_t w,h,res=255,nbImg=0;
 	uint32_t word;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/ADM_h263.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -49,7 +49,7 @@
 			h263Header( void ) {_fd=NULL;};
        		    	~h263Header(  ) { };
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -19,11 +19,11 @@
 #include <stdlib.h>
 #include <string.h>
 
-#include "math.h"
+#include <math.h>
 
 #include "default.h"
 #include "ADM_editor/ADM_Video.h"
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 
 
 #include "fourcc.h"
@@ -127,7 +127,7 @@
 
 			}
 }
-uint8_t bitsReader::open(char *name)
+uint8_t bitsReader::open(const char *name)
 {
 	_fd=fopen(name,"rb");
 	if(!_fd) return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_h263/bitsRead.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -15,7 +15,7 @@
 
 public:
 			bitsReader(void);
-	uint8_t		open(char *name);
+	uint8_t		open(const char *name);
 			~bitsReader();
 	uint8_t 	forward(uint32_t nbBits);
 	uint8_t 	read(uint32_t nbBits,uint32_t *val);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -128,7 +128,7 @@
     return i;
 }
 //****************************************************************
-uint8_t picHeader::open(char *inname)
+uint8_t picHeader::open(const char *inname)
 {
     uint32_t nnum;
     uint32_t *fcc;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -57,7 +57,7 @@
 			picHeader( void );
        		    ~picHeader(  ) { };
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -34,7 +34,7 @@
     __________________________________________________________
 */
 
-uint8_t mkvHeader::open(char *name)
+uint8_t mkvHeader::open(const char *name)
 {
 
   ADM_ebml_file ebml;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -134,7 +134,7 @@
             mkvHeader( void );
    virtual  ~mkvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -201,7 +201,7 @@
 // other stuff which are pretty useless on
 // 3gp file anyway.
 //______________________________________
-uint8_t    MP4Header::open(char *name)
+uint8_t    MP4Header::open(const char *name)
 {
         printf("** opening 3gpp files **");	
         _fd=fopen(name,"rb");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -157,7 +157,7 @@
                                 MP4Header( void ) ;
 virtual	                        ~MP4Header(  ) ;
 // AVI io
-virtual 	uint8_t	       open(char *name);
+virtual 	uint8_t	       open(const char *name);
 virtual 	uint8_t	       close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -75,7 +75,7 @@
   _index=NULL;
 }
 uint8_t
-dmxAudioStream::open (char *name)
+dmxAudioStream::open (const char *name)
 {
   FILE *file;
   uint32_t dummy;		//,audio=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -56,7 +56,7 @@
                 public:
                 uint32_t        currentTrack;
                                 dmxAudioStream( void);
-                uint8_t         open(char *name);
+                uint8_t         open(const char *name);
         virtual                 ~dmxAudioStream() ;                    
         virtual uint8_t         goTo(uint32_t offset);
         virtual uint32_t        read(uint32_t size,uint8_t *ptr);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -30,7 +30,7 @@
 #include "ADM_audio/aviaudio.hxx"
 
 #include "fourcc.h"
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 
 
 #include "ADM_toolkit/toolkit.hxx"
@@ -178,7 +178,7 @@
 
 */
 #define MAX_LINE 4096
-uint8_t                 dmxHeader::open(char *name)
+uint8_t                 dmxHeader::open(const char *name)
 {
                 FILE *file;
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -42,7 +42,7 @@
 
 
 // AVI io
-        virtual         uint8_t                 open(char *name);
+        virtual         uint8_t                 open(const char *name);
         virtual         uint8_t                 close(void);
   //__________________________
   //                             Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -425,7 +425,7 @@
 
 
 */
-uint8_t    nuvHeader::open(char *name)
+uint8_t    nuvHeader::open(const char *name)
 {
 uint32_t a=0,v=0,t=0;
 uint32_t max=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -107,7 +107,7 @@
 					nuvHeader( void ) ;
 		   virtual  		~nuvHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -155,7 +155,7 @@
 
 
 
-uint8_t oggHeader::open(char *name)
+uint8_t oggHeader::open(const char *name)
 {
 #ifdef ADM_BIG_ENDIAN
 	#define SWAP64(x) { uint64_t y=x;x=R32((y>>16)>>16)+((R32(y&0x0ffffffff)<<16)<<16);}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -61,7 +61,7 @@
  			
 				
 		public:
-					oggAudio( char *name,OgAudioTrack *tracks,uint8_t trkidx );
+					oggAudio(const char *name,OgAudioTrack *tracks,uint8_t trkidx );
 			virtual 	~oggAudio() ;
 			virtual uint8_t goTo(uint32_t offset);
 			virtual uint32_t read(uint32_t size,uint8_t *ptr);
@@ -101,7 +101,7 @@
 					oggHeader( void ) ;
 		   virtual  		~oggHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -50,7 +50,7 @@
 
 }
 
-oggAudio::oggAudio( char *name,OgAudioTrack *tracks,uint8_t trkidx )
+oggAudio::oggAudio(const char *name,OgAudioTrack *tracks,uint8_t trkidx )
 {
 uint64_t f;
 	_tracks=tracks;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -40,7 +40,7 @@
 
 }
 
-uint8_t OGMDemuxer::open(char *name)
+uint8_t OGMDemuxer::open(const char *name)
 {
 		_fd=fopen(name,"rb");
 		if(!_fd) return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -36,7 +36,7 @@
 						OGMDemuxer(void);
 						~OGMDemuxer();
 			uint8_t		dumpHeaders(uint8_t *ptr,uint32_t *size);
-			uint8_t 		open(char *file);			
+			uint8_t 		open(const char *file);			
 			uint8_t		setPos( uint64_t pos );
 			uint8_t		readHeader(uint32_t *paySize, uint32_t *flag,uint64_t *frame,
 							uint8_t *id);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -190,7 +190,7 @@
 // Open and get the headears/index built
 // along way
 //______________________________________
-uint8_t    OpenDMLHeader::open(char *name)
+uint8_t    OpenDMLHeader::open(const char *name)
 {
 uint8_t badAvi=0;
 uint32_t rd;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -123,7 +123,7 @@
 					OpenDMLHeader( void ) ;
        		    			~OpenDMLHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -78,7 +78,7 @@
 		
 	}
 }
-riffParser::riffParser(char *name)
+riffParser::riffParser(const char *name)
 {
 	ADM_assert(fd=fopen(name,"rb"));
 	startPos=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -9,7 +9,7 @@
 	uint64_t curPos;
 	uint8_t  _root;
 
-	riffParser(char *name);
+	riffParser(const char *name);
 	riffParser(riffParser *o, uint32_t size);
 	~riffParser();
 	uint64_t getPos( void );

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc	2008-06-16 11:54:28 UTC (rev 4104)
@@ -36,4 +36,4 @@
 	}
 	nb_alloc=0;
 
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc	2008-06-16 11:54:28 UTC (rev 4104)
@@ -25,4 +25,4 @@
    work properly if the same thread does the locking and unlocking. Gaah!
  */
 
-// MEANX : removed, not used & cause problem on cygwin
\ No newline at end of file
+// MEANX : removed, not used & cause problem on cygwin

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -9,9 +9,9 @@
 {
 #ifdef USE_LATE_BINDING
 #ifdef ADM_WIN32
-	char* libname = "libamrnb-2.dll";
+	const char* libname = "libamrnb-2.dll";
 #else
-	char* libname = "libamrnb-2.so";	// ???
+	const char* libname = "libamrnb-2.so";	// ???
 #endif
 
 	initialised = (loadLibrary(libname) && getSymbols(6, 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -9,9 +9,9 @@
 {
 #ifdef USE_LATE_BINDING
 #ifdef ADM_WIN32
-	char* libname = "libdts.dll";
+	const char* libname = "libdts.dll";
 #else
-	char* libname = "libdts.so";	// ???
+	const char* libname = "libdts.so";	// ???
 #endif
 
 	initialised = (loadLibrary(libname) && getSymbols(7, 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/aviio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/aviio.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/aviio.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1 +1 @@
-// RMED
\ No newline at end of file
+// RMED

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -406,7 +406,7 @@
 void saveCrashProject(void)
 {
   char *baseDir=ADM_getBaseDir();
-  char *name=CRASH_FILE;
+  const char *name=CRASH_FILE;
   static int crashCount=0;
   if(crashCount) return ; // avoid endless looping
   crashCount++;
@@ -426,7 +426,7 @@
 void checkCrashFile(void)
 {
   char *baseDir=ADM_getBaseDir();
-  char *name=CRASH_FILE;
+  const char *name=CRASH_FILE;
   static int crashCount=0;
   char *where=new char[strlen(baseDir)+strlen(name)+2];
   strcpy(where,baseDir);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -375,7 +375,7 @@
 	Split patch into absolute path+name and extention
 
 */
-void PathSplit(char *str, char **root, char **ext)
+void PathSplit(const char *str, char **root, char **ext)
 {
 	char *full;
 	uint32_t l;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -388,7 +388,7 @@
 #endif /* ARCH_X86 */
 
 static struct {
-  char *name;
+  const char *name;
   void *(* function)(void *to, const void *from, size_t len);
 
   uint64_t time; /* This type could be used for non-MSC build too! */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -263,7 +263,7 @@
     This function convert the later to the former
 
 */
-extern char *slashToBackSlash(char *in)
+extern char *slashToBackSlash(const char *in)
 {
     char *out,*cout;
     int n;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h	2008-06-16 11:54:28 UTC (rev 4104)
@@ -30,7 +30,7 @@
   uint32_t hours,minutes,seconds; 
 } ADM_date;
 void            TLK_getDate(ADM_date *date);
-void            PathSplit(char *str, char **root, char **ext);
+void            PathSplit(const char *str, char **root, char **ext);
 void	        PathStripName(char *str);
 const char      *GetFileName(const char *str);
 char            *PathCanonize(const char *tmpname);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1033,7 +1033,7 @@
 	}
 	return true;
 }
-void aviWrite::odml_write_sindex(int stream_nbr, char* stream_fcc)
+void aviWrite::odml_write_sindex(int stream_nbr, const char* stream_fcc)
 {
         
 	// Warning: This changes the file position
@@ -1086,7 +1086,7 @@
                 
 	}	
 }
-bool aviWrite::odml_write_index(int stream_nbr, char* stream_fcc, char* index_fcc){	// write index
+bool aviWrite::odml_write_index(int stream_nbr, const char* stream_fcc, const char* index_fcc){	// write index
 	// Warning: This changes the file position
 	if(doODML==NORMAL){
 		aprintf ("\n writing %lu interleaved ODML indexes for %lu frames in stream %s", odml_indexes[stream_nbr].index_count+1, vframe, stream_fcc);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx	2008-06-16 11:54:28 UTC (rev 4104)
@@ -94,8 +94,8 @@
 	void odml_destroy_index(void);	// deallocate index data structures
 	void odml_write_dummy_chunk(AviList* alist, uint64_t* fpos, uint32_t size);	// write a dummy chunk and get its file position
 	bool odml_index_frame(int stream_nbr, uint32_t data_size, bool keyFrame);	//index one data chunk
-	void odml_write_sindex(int stream_nbr, char* stream_fcc);	// write super index
-	bool odml_write_index(int stream_nbr, char* stream_fcc, char* index_fcc);	// write index
+	void odml_write_sindex(int stream_nbr, const char* stream_fcc);	// write super index
+	bool odml_write_index(int stream_nbr, const char* stream_fcc, const char* index_fcc);	// write index
 	void odml_riff_break(uint32_t len);	// advance to the next riff if required; len = chunk size to be written (incl. 4cc and size info) without padding
 	// END MOD Feb 2005 by GMV
         void reallocIndeces( odml_super_index_t *idx);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -30,13 +30,12 @@
 
 #include "ADM_script/ADM_container.h"
 
-extern VF_FILTERS filterGetTagFromName(char *inname);
 //extern uint8_t indexMpeg(char *mpeg,char *file,uint8_t aid);
 extern uint8_t A_ListAllBlackFrames( char *file );
-extern uint8_t loadVideoCodecConfString( char *name);
+extern uint8_t loadVideoCodecConfString( const char *name);
 extern uint8_t ADM_saveRaw (const char *name);
 extern int A_saveJpg (char *name);
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern int videoCodecConfigure(char *p,uint32_t i, uint8_t  *c);
 
 extern void filterCleanUp( void );

Modified: branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -48,7 +48,7 @@
 
 extern void filterListAll(void );
 
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern int A_saveJpg (char *name);
 extern void filterLoadXml(char *n);
 extern int A_openAvi(char *name);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -57,7 +57,7 @@
 //	Video is in YV12 Colorspace
 //
 //
-int DIA_getCropParams(char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
+int DIA_getCropParams(const char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
 {
 	uint32_t width, height;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -55,7 +55,7 @@
 int SliderIsShifted = 0;
 
 int DIA_coloryuv(COLOR_YUV_PARAM *param) {return 0;}
-int DIA_getCropParams(  char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in) {return 0;}
+int DIA_getCropParams(const char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in) {return 0;}
 
 #ifdef USE_XX_XVID 
 #include "xvid.h"

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -32,4 +32,4 @@
 uint8_t UI_getPhysicalScreenSize(void *window, uint32_t *w,uint32_t *h)
 {
   *w=*h=10000; 
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -193,7 +193,7 @@
       \fn     DIA_getCropParams
       \brief  Handle crop dialog
 */
-int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
+int DIA_getCropParams(const char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
 {
         uint8_t ret=0;
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -186,13 +186,13 @@
 			return 1;
 
 }
-extern int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in);
+extern int DIA_getCropParams(const char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in);
 uint8_t AVDMVideoStreamCrop::configure( AVDMGenericVideoStream *instream)
 
 {
 		uint8_t r;
 		uint32_t w,h;
-    	if(r = (DIA_getCropParams("Crop Settings",_param,instream )))
+    	if(r = (DIA_getCropParams(QT_TR_NOOP("Crop Settings"),_param,instream )))
     	{
 			w=_param->left+_param->right;
 			h=_param->top+_param->bottom;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp	2008-06-16 11:54:28 UTC (rev 4104)
@@ -99,11 +99,11 @@
 {
 SCRIPT_CREATE(FILTER_create_fromscript,ADMVideoYadif,yadifParam);
 BUILD_CREATE(FILTER_create,ADMVideoYadif);
-char *FILTER_getName(void)
+const char *FILTER_getName(void)
 {
 	return "DynYadif";
 }
-char *FILTER_getDesc(void)
+const char *FILTER_getDesc(void)
 {
 	return "YADIF";
 }

Modified: branches/avidemux_2.4_branch/avidemux/xpm/avidemux_icon.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/avidemux_icon.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/avidemux_icon.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * avidemux_icon_xpm[] = {
+static const char * avidemux_icon_xpm[] = {
 "64 64 824 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/begin.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/begin.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/begin.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-const char * xpm_begin[] = {
+static const char * xpm_begin[] = {
 "32 20 56 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/end.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/end.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/end.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-const char * xpm_end[] = {
+static const char * xpm_end[] = {
 "32 20 55 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * gnome_calculator_xpm[] = {
+static const char * gnome_calculator_xpm[] = {
 "24 24 175 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator_small.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator_small.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/gnome-calculator_small.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * gnome_calculator_small_xpm[] = {
+static const char * gnome_calculator_small_xpm[] = {
 "16 16 94 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/stop.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/stop.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/stop.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * xpm_stop[] = {
+static const char * xpm_stop[] = {
 "32 20 30 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/systray.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/systray.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/systray.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * systray_xpm[] = {
+static const char * systray_xpm[] = {
 "22 23 288 2",
 "  	c None",
 ". 	c #DDD4DC",

Modified: branches/avidemux_2.4_branch/avidemux/xpm/systray2.xpm
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/systray2.xpm	2008-06-16 11:04:41 UTC (rev 4103)
+++ branches/avidemux_2.4_branch/avidemux/xpm/systray2.xpm	2008-06-16 11:54:28 UTC (rev 4104)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * systray2_xpm[] = {
+static const char * systray2_xpm[] = {
 "22 23 288 2",
 "  	c None",
 ". 	c #F2D8DF",



From gruntster at mail.berlios.de  Mon Jun 16 14:13:56 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 14:13:56 +0200
Subject: [Avidemux-svn-commit] r4105 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_GTK/ADM_toolkit_gtk ADM_commonUI
Message-ID: <200806161213.m5GCDugv003332@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 14:13:43 +0200 (Mon, 16 Jun 2008)
New Revision: 4105

Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
Log:
[systray] use GTK+ for systray instead of libegg (FS#434)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2008-06-16 12:13:43 UTC (rev 4105)
@@ -107,20 +107,21 @@
 
         gtk_widget_show(dialog);
 
-        if(useTray)
-        {
-              gtk_window_iconify(GTK_WINDOW(dialog));
-              UI_iconify();
-        }
+		if (useTray)
+		{
+			gtk_window_iconify(GTK_WINDOW(dialog));
+			UI_iconify();
+			tray = new ADM_tray(dialog);
+		}
+		else
+			tray = NULL;
+
         _lastTime=0;
         _lastFrame=0;
         _fps_average=0;
-        tray=NULL;
         _total=1000;
-        if(useTray)
-                tray=new ADM_tray("Encoding");
+}
 
-}
 void DIA_encoding::setFps(uint32_t fps)
 {
         _roundup=(uint32_t )floor( (fps+999)/1000);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp	2008-06-16 12:13:43 UTC (rev 4105)
@@ -1,13 +1,11 @@
 /***************************************************************************
-                          adm_encdivx.cpp  -  description
-                             -------------------
+                              ADM_tray_gtk.cpp
+                              ----------------
+
     begin                : Sun Jul 14 2002
-    copyright            : (C) 2002 by mean
+    copyright            : (C) 2002 by mean/gruntster
     email                : fixounet at free.fr
 
-
-Derived from MLdonkey systray code
-http://savannah.nongnu.org/cvs/?group=mldonkey
  ***************************************************************************/
 
 /***************************************************************************
@@ -24,81 +22,105 @@
 #include <string.h>
 #include <stdio.h>
 
-
-
 #include "default.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include <ADM_assert.h>
 #include "ADM_tray.h"
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-extern "C"
+
+extern void UI_deiconify(void);
+
+static GdkPixbuf **pixbuf = NULL;
+static int lastIcon;
+
+static const char *animated[] = {
+	"film1.png","film3.png","film5.png","film7.png","film9.png",
+	"film11.png","film13.png","film15.png","film17.png","film19.png",
+	"film21.png","film23.png"};
+
+void tray_icon_on_click(GtkStatusIcon *status_icon, gpointer user_data)
 {
-#include "systray.h"
+	gtk_window_deiconify(GTK_WINDOW(user_data));
+	UI_deiconify();
 }
-static int nbTray=0;
-static  GdkPixbuf   **pixbuf=NULL;
 
-extern GdkPixbuf        *create_pixbuf                  (const gchar     *filename);
-/*
-class ADM_tray
+static void tray_menu_open_avidemux(GtkStatusIcon *status_icon, gpointer user_data)
 {
-protected:
+	gtk_window_deiconify(GTK_WINDOW(user_data));
+	UI_deiconify();
+}
 
-public:
-        ADM_tray(char *name);
-        ~ADM_tray();
-        setPercent(int percent);
-        setStatus(int working);
+static void tray_icon_popup_menu(GtkStatusIcon *status_icon, guint button, guint activate_time, gpointer user_data)
+{
+	GtkWidget *popupMenu = gtk_menu_new();
+	GtkWidget *item = gtk_menu_item_new_with_label(QT_TR_NOOP("Open Avidemux"));
 
-};*/
-static char *animated[]={
-    "film1.png","film3.png","film5.png","film7.png","film9.png",
-    "film11.png","film13.png","film15.png","film17.png","film19.png",
-    "film21.png","film23.png"};
-ADM_tray::ADM_tray(char *name)
+	gtk_menu_append(popupMenu, item);
+	g_signal_connect(G_OBJECT(item), "activate", G_CALLBACK(tray_menu_open_avidemux), user_data);
+
+	gtk_widget_show_all(popupMenu);
+	gtk_menu_popup(GTK_MENU(popupMenu), NULL, NULL, gtk_status_icon_position_menu, status_icon, button, activate_time);
+}
+
+ADM_tray::ADM_tray(void* parent)
 {
-        ADM_assert(!nbTray);
-        nbTray++;
+	_parent = parent;
+	lastIcon = 0;
+	int nb = sizeof(animated) / sizeof(char *);
 
+	if (!pixbuf)
+	{
+		pixbuf = new GdkPixbuf*[nb];
 
-  int nb=sizeof(animated)/sizeof(char *);
-  if(!pixbuf)
-  {
-      pixbuf=new GdkPixbuf*[nb];
-      for(int i=0;i<nb;i++)
-      {
-        pixbuf[i]=create_pixbuf(animated[i]);
-        if(!pixbuf[i])
-        {
-          printf("Failed to create <%s>\n",animated[i]);
-          ADM_assert(0);
-        }
-      }
+		for (int i = 0; i < nb; i++)
+		{
+			pixbuf[i] = create_pixbuf(animated[i]);
 
-  }
-  sys=adm_new_systray(pixbuf,nb,name);
+			if (!pixbuf[i])
+			{
+				printf("Failed to create <%s>\n", animated[i]);
+				ADM_assert(0);
+			}
+		}
+	}
 
+	sys = gtk_status_icon_new_from_pixbuf(pixbuf[0]);
+
+	g_signal_connect(G_OBJECT(sys), "activate", G_CALLBACK(tray_icon_on_click), _parent);
+	g_signal_connect(G_OBJECT(sys), "popup-menu", G_CALLBACK(tray_icon_popup_menu), _parent);
+	gtk_status_icon_set_tooltip((GtkStatusIcon*)sys, "Avidemux");
+	gtk_status_icon_set_visible((GtkStatusIcon*)sys, TRUE);
 }
+
 ADM_tray::~ADM_tray()
 {
-        nbTray--;
-        ADM_assert(!nbTray);
-        if(sys)
-                adm_delete_systray(sys);
-        sys=NULL;
+	if (sys)
+		gtk_status_icon_set_visible((GtkStatusIcon*)sys, FALSE);
+
+	sys = NULL;
 }
+
 uint8_t ADM_tray::setPercent(int percent)
 {
-char percentS[40];
-        sprintf(percentS,"%d %%",percent);
-        if(sys)
-        {
-                adm_changeIcon_systray();
-                adm_change_tooltip(sys,percentS);
-        }
-        return 1;
+	char percentS[40];
+
+	sprintf(percentS, "Avidemux [%d%%]", percent);
+
+	if (sys)
+	{
+		int maxIcons = sizeof(animated) / sizeof(char *);
+		lastIcon++;
+
+		if (lastIcon >= maxIcons)
+			lastIcon = 0;
+
+		gtk_status_icon_set_from_pixbuf((GtkStatusIcon*)sys, pixbuf[lastIcon]);
+		gtk_status_icon_set_tooltip((GtkStatusIcon*)sys, percentS);
+	}
+
+	return 1;
 }
+
 uint8_t ADM_tray::setStatus(int working)
 {
-        return 1;
+	return 1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2008-06-16 12:13:43 UTC (rev 4105)
@@ -6,7 +6,7 @@
 #
 SET(${ADM_LIB}_SRCS
 ADM_gladeSupport.cpp  ADM_tray_gtk.cpp  choice.cpp  TLK_filesel.cpp  toolkit.cpp  toolkit_dialog.cpp 
-    eggtrayicon.c eggtray_win32.c gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp  mediactrl.c
+    gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp  mediactrl.c
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c	2008-06-16 12:13:43 UTC (rev 4105)
@@ -1,287 +0,0 @@
-/*
-    Borrowed from mldonkey
-*/
-/* Copyright 2004 b8_bavard, INRIA */
-/*
-    This file is part of mldonkey.
-
-    mldonkey is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; either version 2 of the License, or
-    (at your option) any later version.
-
-    mldonkey is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License
-    along with mldonkey; if not, write to the Free Software
-    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-
-/* Stub code to interface with Shell_NotifyIcon */
-#include <config.h>
-#ifdef ADM_WIN32
-#include <windows.h>
-#include <wingdi.h>
-
-#include <gdk/gdk.h> 
-#include <gdk/gdkwin32.h>
-#include <gdk-pixbuf/gdk-pixbuf.h>
-
-#include <stdio.h>
-#include <systray.h>
-#define WM_TRAYMESSAGE           WM_USER /* User defined WM Message */
-#define SYSTRAY_LBUTTONDBLCLK    0
-#define SYSTRAY_LBUTTONCLK       1
-#define SYSTRAY_RBUTTONCLK       2
-
-static UINT timerID = 3;
-static NOTIFYICONDATA nid;
-static HWND systray_hwnd=0;
-static HICON systray_hicon=0;
-static int  win32egg_nb=0;
-static GdkPixbuf **win32egg_pixbuf;
-static int flipflop=0;
-LRESULT msg_handler(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
-{
-  static UINT taskbarRestartMsg; /* static here means value is kept across multiple calls to this func */
-
-  switch(msg) {
-    case WM_CREATE:
-      taskbarRestartMsg = RegisterWindowMessage("TaskbarCreated");
-      break;
-
-    case WM_TIMER:
-        #if 0
-      KillTimer(hWnd, timerID);
-      call_caml_systray_clicked(SYSTRAY_LBUTTONCLK);
-      #endif
-      break;
-
-    case WM_DESTROY:
-      break;
-
-    case WM_TRAYMESSAGE:
-#if 0
-      switch (lParam) {
-        case WM_RBUTTONUP:
-          call_caml_systray_clicked(SYSTRAY_RBUTTONCLK);
-          break;
-
-        case WM_LBUTTONDBLCLK:
-          KillTimer(hWnd, timerID);
-          call_caml_systray_clicked(SYSTRAY_LBUTTONDBLCLK);
-          break;
-
-        case WM_LBUTTONDOWN:
-          SetTimer(hWnd, timerID, GetDoubleClickTime(), NULL);
-          break;
-
-      }
-#endif
-    default: 
-      if (msg == taskbarRestartMsg) {
-        /* explorer crashed and left us hanging... 
-           This will put the systray icon back in it's place, when it restarts */
-        Shell_NotifyIcon(NIM_ADD,&nid);
-      }
-      break;
-
-  }/* end switch */
-
-  return DefWindowProc(hWnd, msg, wParam, lParam);
-
-} 
-/* Create hidden window to process systray messages */
-
-static HWND systray_create_hiddenwin(void)
-{
-
-  WNDCLASSEX wcex;
-  TCHAR wname[32];
-
-  strcpy(wname, "Win");
-
-  wcex.cbSize = sizeof(WNDCLASSEX);
-
-  wcex.style = 0;
-  wcex.lpfnWndProc = (WNDPROC)msg_handler;
-  wcex.cbClsExtra = 0;
-  wcex.cbWndExtra = 0;
-  wcex.hInstance = GetModuleHandle(NULL);
-  wcex.hIcon = NULL;
-  wcex.hCursor = NULL,
-  wcex.hbrBackground = NULL;
-  wcex.lpszMenuName = NULL;
-  wcex.lpszClassName = wname;
-  wcex.hIconSm = NULL;
-
-  RegisterClassEx(&wcex);
-
-  /* Create the window */
-  return (CreateWindow(wname, "", 0, 0, 0, 0, 0, GetDesktopWindow(), NULL, GetModuleHandle(NULL), 0));
-}
-
-/* taken and modified from gdk/win32/gdkwindow-win32.c */
-
-HICON pixmap_to_hicon (GdkPixmap *pixmap, GdkBitmap *mask)
-{
-  ICONINFO ii;
-  HICON hIcon;
-  gint w = 0, h = 0;
-  HANDLE hpixmap = NULL;
-  HBITMAP hbitmap = NULL;
-
-  /* Create Drawing Context */
-  HDC hdc1 = NULL;
-  HBITMAP hbitmaptmp1 = NULL;
-
-    if (!pixmap) {
-      return NULL;
-    }
-
-    gdk_drawable_get_size (GDK_DRAWABLE (pixmap), &w, &h);
-
-    hpixmap = gdk_win32_drawable_get_handle (pixmap); 
-
-    /* we need the inverted mask for the XOR op */
-    hdc1 = CreateCompatibleDC (NULL);
-    hbitmap = CreateCompatibleBitmap (hdc1, w, h);
-    hbitmaptmp1 = SelectObject (hdc1, hbitmap);
-
-    if (mask) {
-      HANDLE hmask = NULL;
-      HDC hdc2 = NULL;
-      HBITMAP hbitmaptmp2 = NULL;
-
-      hmask = gdk_win32_drawable_get_handle (mask); 
-
-      hdc2 = CreateCompatibleDC (NULL);
-      hbitmaptmp2 = SelectObject (hdc2, hmask);
-
-      BitBlt (hdc1, 0,0,w,h, hdc2, 0,0, NOTSRCCOPY);    
-
-      SelectObject (hdc2, hbitmaptmp2);
-      DeleteDC (hdc2);
-    } else {
-      RECT rect;
-      GetClipBox (hdc1, &rect);
-      FillRect (hdc1, &rect, GetStockObject (WHITE_BRUSH));
-    }
-
-    SelectObject (hdc1, hbitmaptmp1); 
-    DeleteDC (hdc1); 
- 
-    ii.fIcon = TRUE;
-    ii.xHotspot = ii.yHotspot = 0; /* ignored for icons */
-    ii.hbmMask = hbitmap;
-    ii.hbmColor = hpixmap; 
-
-    hIcon = CreateIconIndirect (&ii);
-    if (!hIcon) {
-      return NULL;
-    }
-
-    DeleteObject (hbitmap);
-
-    return hIcon;
-}
-
-NOTIFYICONDATA systray_init(GdkPixbuf *pixbuf,  char* text) 
-{
-  GdkPixmap *pm;
-  GdkBitmap *mask;
-
-  gdk_pixbuf_render_pixmap_and_mask(pixbuf, &pm, &mask, 128);
-
-  char* locenc=NULL;
-
-  ZeroMemory(&nid,sizeof(nid));
-  systray_hicon = pixmap_to_hicon (pm, mask);
-  systray_hwnd = systray_create_hiddenwin();
-
-  nid.cbSize=sizeof(NOTIFYICONDATA);
-  nid.hWnd=systray_hwnd;
-  nid.uID=0;
-  nid.uFlags=NIF_ICON | NIF_MESSAGE | NIF_TIP ;
-  nid.uCallbackMessage=WM_TRAYMESSAGE;
-  nid.hIcon=systray_hicon;
-
-  if(text) {
-    locenc = g_locale_from_utf8(text, -1, NULL, NULL, NULL);
-    lstrcpy(nid.szTip, locenc);
-    g_free(locenc);
-  }
-
-  Shell_NotifyIcon(NIM_ADD,&nid);
-  return nid;
-}
-
-void systray_modify_icon (GdkPixmap *pm, GdkBitmap *mask) 
-{
-
-  systray_hicon = pixmap_to_hicon (pm, mask);
-  nid.hIcon = systray_hicon;
-  Shell_NotifyIcon(NIM_MODIFY,&nid);
-}
-
-void systray_modify_tooltip (const char* text) 
-{
-  char *locenc=NULL;
-
-  if(text) {
-    locenc = g_locale_from_utf8(text, -1, NULL, NULL, NULL);
-    lstrcpy(nid.szTip, locenc);
-    g_free(locenc);
-  }
-  Shell_NotifyIcon(NIM_MODIFY,&nid);
-}
-
-void systray_remove_nid(void) 
-{
-  DestroyWindow(nid.hWnd);
-  Shell_NotifyIcon(NIM_DELETE,&nid);
-}
-//*********************************************************
-//*********************************************************
-//*********************************************************
-void *adm_new_systray(GdkPixbuf *zpixbuf[],int nb, char *name)
-{
-void *r;
-	flipflop=0;
-	win32egg_pixbuf=zpixbuf;
-	win32egg_nb=nb;
-  systray_init(win32egg_pixbuf[0],  name);
-  r=(void *)0xdead;
-  return r;
-
-}
-void adm_delete_systray(void *systray)
-{
- systray_remove_nid() ;
-}
-void adm_change_tooltip(void *systray, const char *tips)
-{
-    systray_modify_tooltip (tips ) ;
-}
-void adm_changeIcon_systray(void)
-{
-  GdkPixmap *pm;
-  GdkBitmap *mask;
-  GdkPixbuf *icon;
-	flipflop=flipflop%win32egg_nb;
-	icon=win32egg_pixbuf[flipflop];
-	//ADM_assert(icon);
-
-  	gdk_pixbuf_render_pixmap_and_mask(icon, &pm, &mask, 128);
-
-
-	systray_modify_icon (pm, mask) ;
-
-		
-	flipflop++;
-	flipflop=flipflop%win32egg_nb;
-}
-#endif

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c	2008-06-16 12:13:43 UTC (rev 4105)
@@ -1,514 +0,0 @@
-/* -*- Mode: C; tab-width: 8; indent-tabs-mode: t; c-basic-offset: 8 -*- */
-/* eggtrayicon.c
- * Copyright (C) 2002 Anders Carlsson <andersca at gnu.org>
- *
- * This library is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2 of the License, or (at your option) any later version.
- *
- * This library is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with this library; if not, write to the
- * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
- * Boston, MA 02111-1307, USA.
- */
-#include "config.h"
-#ifndef ADM_WIN32
-
-#include <gtk/gtk.h>
-#include <gtk/gtkversion.h>
-
-
-#include "eggtrayicon.h"
-#include <string.h>
-#include "systray.h"
-#include "../ADM_assert.h"
-#define SYSTEM_TRAY_REQUEST_DOCK    0
-#define SYSTEM_TRAY_BEGIN_MESSAGE   1
-#define SYSTEM_TRAY_CANCEL_MESSAGE  2
-
-#define SYSTEM_TRAY_ORIENTATION_HORZ 0
-#define SYSTEM_TRAY_ORIENTATION_VERT 1
-
-enum {
-  PROP_0,
-  PROP_ORIENTATION
-};
-         
-static GtkPlugClass *parent_class = NULL;
-
-static void egg_tray_icon_init (EggTrayIcon *icon);
-static void egg_tray_icon_class_init (EggTrayIconClass *klass);
-
-static void egg_tray_icon_get_property (GObject    *object,
-                                        guint       prop_id,
-                                        GValue     *value,
-                                        GParamSpec *pspec);
-
-static void egg_tray_icon_realize   (GtkWidget *widget);
-static void egg_tray_icon_unrealize (GtkWidget *widget);
-
-static void egg_tray_icon_update_manager_window (EggTrayIcon *icon);
-
-static GtkWidget   *img=NULL;
-
-static GdkPixbuf **listOfIcons=NULL;
-static int nbListOfIcons=0;
-static int flipflop=0;
-
-GType egg_tray_icon_get_type (void)
-{
-  static GType our_type = 0;
-
-  if (our_type == 0)
-    {
-      static const GTypeInfo our_info =
-      {
-	sizeof (EggTrayIconClass),
-	(GBaseInitFunc) NULL,
-	(GBaseFinalizeFunc) NULL,
-	(GClassInitFunc) egg_tray_icon_class_init,
-	NULL, /* class_finalize */
-	NULL, /* class_data */
-	sizeof (EggTrayIcon),
-	0,    /* n_preallocs */
-	(GInstanceInitFunc) egg_tray_icon_init
-      };
-
-      our_type = g_type_register_static (GTK_TYPE_PLUG, "EggTrayIcon", &our_info, 0);
-    }
-
-  return our_type;
-}
-
-static void egg_tray_icon_init (EggTrayIcon *icon)
-{
-  icon->stamp = 1;
-  icon->orientation = GTK_ORIENTATION_HORIZONTAL;
-  
-  gtk_widget_add_events (GTK_WIDGET (icon), GDK_PROPERTY_CHANGE_MASK);
-}
-
-static void egg_tray_icon_class_init (EggTrayIconClass *klass)
-{
-  GObjectClass *gobject_class = (GObjectClass *)klass;
-  GtkWidgetClass *widget_class = (GtkWidgetClass *)klass;
-
-  parent_class = g_type_class_peek_parent (klass);
-
-  gobject_class->get_property = egg_tray_icon_get_property;
-
-  widget_class->realize   = egg_tray_icon_realize;
-  widget_class->unrealize = egg_tray_icon_unrealize;
-
-  g_object_class_install_property (gobject_class,
-				   PROP_ORIENTATION,
-				   g_param_spec_enum ("orientation",
-						      "Orientation",
-						      "The orientation of the tray.",
-						      GTK_TYPE_ORIENTATION,
-						      GTK_ORIENTATION_HORIZONTAL,
-						      G_PARAM_READABLE));
-}
-
-static void egg_tray_icon_get_property (GObject    *object,
-                            guint       prop_id,
-                            GValue     *value,
-                            GParamSpec *pspec)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (object);
-
-  switch (prop_id)
-    {
-    case PROP_ORIENTATION:
-      g_value_set_enum (value, icon->orientation);
-      break;
-    default:
-      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);
-      break;
-    }
-}
-
-static void egg_tray_icon_get_orientation_property (EggTrayIcon *icon)
-{
-  Display *xdisplay;
-  Atom type;
-  int format;
-	union {
-	  gulong *prop;
-		guchar *prop_ch;
-	} prop = { NULL };
-  gulong nitems;
-  gulong bytes_after;
-  int error, result;
-
-  g_assert (icon->manager_window != None);
-
-  xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-
-  gdk_error_trap_push ();
-  type = None;
-  result = XGetWindowProperty (xdisplay,
-			       icon->manager_window,
-			       icon->orientation_atom,
-			       0, G_MAXLONG, FALSE,
-			       XA_CARDINAL,
-			       &type, &format, &nitems,
-			       &bytes_after, &(prop.prop_ch));
-  error = gdk_error_trap_pop ();
-
-  if (error || result != Success)
-    return;
-
-  if (type == XA_CARDINAL)
-    {
-      GtkOrientation orientation;
-
-      orientation = (prop.prop [0] == SYSTEM_TRAY_ORIENTATION_HORZ) ?
-					GTK_ORIENTATION_HORIZONTAL :
-					GTK_ORIENTATION_VERTICAL;
-
-      if (icon->orientation != orientation)
-	{
-	  icon->orientation = orientation;
-
-	  g_object_notify (G_OBJECT (icon), "orientation");
-	}
-    }
-
-  if (prop.prop)
-    XFree (prop.prop);
-}
-
-static GdkFilterReturn egg_tray_icon_manager_filter (GdkXEvent *xevent, GdkEvent *event, gpointer user_data)
-{
-  EggTrayIcon *icon = user_data;
-  XEvent *xev = (XEvent *)xevent;
-
-  if (xev->xany.type == ClientMessage &&
-      xev->xclient.message_type == icon->manager_atom &&
-      xev->xclient.data.l[1] == icon->selection_atom)
-    {
-      egg_tray_icon_update_manager_window (icon);
-    }
-  else if (xev->xany.window == icon->manager_window)
-    {
-      if (xev->xany.type == PropertyNotify &&
-	  xev->xproperty.atom == icon->orientation_atom)
-	{
-	  egg_tray_icon_get_orientation_property (icon);
-	}
-      if (xev->xany.type == DestroyNotify)
-	{
-	  egg_tray_icon_update_manager_window (icon);
-	}
-    }
-  
-  return GDK_FILTER_CONTINUE;
-}
-
-static void egg_tray_icon_unrealize (GtkWidget *widget)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (widget);
-  GdkWindow *root_window;
-
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (widget),
-                                              icon->manager_window);
-
-      gdk_window_remove_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-    }
-
-  root_window = gdk_screen_get_root_window (gtk_widget_get_screen (widget));
-
-  gdk_window_remove_filter (root_window, egg_tray_icon_manager_filter, icon);
-
-  if (GTK_WIDGET_CLASS (parent_class)->unrealize)
-    (* GTK_WIDGET_CLASS (parent_class)->unrealize) (widget);
-}
-
-static void egg_tray_icon_send_manager_message (EggTrayIcon *icon,
-				    long         message,
-				    Window       window,
-				    long         data1,
-				    long         data2,
-				    long         data3)
-{
-  XClientMessageEvent ev;
-  Display *display;
-  
-  ev.type = ClientMessage;
-  ev.window = window;
-  ev.message_type = icon->system_tray_opcode_atom;
-  ev.format = 32;
-  ev.data.l[0] = gdk_x11_get_server_time (GTK_WIDGET (icon)->window);
-  ev.data.l[1] = message;
-  ev.data.l[2] = data1;
-  ev.data.l[3] = data2;
-  ev.data.l[4] = data3;
-
-  display = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-  
-  gdk_error_trap_push ();
-  XSendEvent (display,
-	      icon->manager_window, False, NoEventMask, (XEvent *)&ev);
-  XSync (display, False);
-  gdk_error_trap_pop ();
-}
-
-static void egg_tray_icon_send_dock_request (EggTrayIcon *icon)
-{
-  egg_tray_icon_send_manager_message (icon,
-				      SYSTEM_TRAY_REQUEST_DOCK,
-				      icon->manager_window,
-				      gtk_plug_get_id (GTK_PLUG (icon)),
-				      0, 0);
-}
-
-static void egg_tray_icon_update_manager_window (EggTrayIcon *icon)
-{
-  Display *xdisplay;
-
-  xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-  
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (GTK_WIDGET (icon)),
-					      icon->manager_window);
-      
-      gdk_window_remove_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-    }
-  
-  XGrabServer (xdisplay);
-  
-  icon->manager_window = XGetSelectionOwner (xdisplay,
-					     icon->selection_atom);
-
-  if (icon->manager_window != None)
-    XSelectInput (xdisplay,
-		  icon->manager_window, StructureNotifyMask|PropertyChangeMask);
-
-  XUngrabServer (xdisplay);
-  XFlush (xdisplay);
-  
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (GTK_WIDGET (icon)),
-					      icon->manager_window);
-      
-      gdk_window_add_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-
-      /* Send a request that we'd like to dock */
-      egg_tray_icon_send_dock_request (icon);
-
-      egg_tray_icon_get_orientation_property (icon);
-    }
-}
-
-static void egg_tray_icon_realize (GtkWidget *widget)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (widget);
-  GdkScreen *screen;
-  GdkDisplay *display;
-  Display *xdisplay;
-  char buffer[256];
-  GdkWindow *root_window;
-
-  if (GTK_WIDGET_CLASS (parent_class)->realize)
-    GTK_WIDGET_CLASS (parent_class)->realize (widget);
-
-  screen = gtk_widget_get_screen (widget);
-  display = gdk_screen_get_display (screen);
-  xdisplay = gdk_x11_display_get_xdisplay (display);
-
-  /* Now see if there's a manager window around */
-  g_snprintf (buffer, sizeof (buffer),
-	      "_NET_SYSTEM_TRAY_S%d",
-	      gdk_screen_get_number (screen));
-
-  icon->selection_atom = XInternAtom (xdisplay, buffer, False);
-  
-  icon->manager_atom = XInternAtom (xdisplay, "MANAGER", False);
-  
-  icon->system_tray_opcode_atom = XInternAtom (xdisplay,
-						   "_NET_SYSTEM_TRAY_OPCODE",
-						   False);
-
-  icon->orientation_atom = XInternAtom (xdisplay,
-					"_NET_SYSTEM_TRAY_ORIENTATION",
-					False);
-
-  egg_tray_icon_update_manager_window (icon);
-
-  root_window = gdk_screen_get_root_window (screen);
-
-  /* Add a root window filter so that we get changes on MANAGER */
-  gdk_window_add_filter (root_window,
-			 egg_tray_icon_manager_filter, icon);
-}
-
-EggTrayIcon *egg_tray_icon_new_for_xscreen (Screen *xscreen, const char *name)
-{
-  GdkDisplay *display;
-  GdkScreen *screen;
-
-  display = gdk_x11_lookup_xdisplay (DisplayOfScreen (xscreen));
-  screen = gdk_display_get_screen (display, XScreenNumberOfScreen (xscreen));
-
-  return egg_tray_icon_new_for_screen (screen, name);
-}
-
-EggTrayIcon *egg_tray_icon_new_for_screen (GdkScreen *screen, const char *name)
-{
-  g_return_val_if_fail (GDK_IS_SCREEN (screen), NULL);
-
-  return g_object_new (EGG_TYPE_TRAY_ICON, "screen", screen, "title", name, NULL);
-}
-
-EggTrayIcon *egg_tray_icon_new (const gchar *name)
-{
-  return g_object_new (EGG_TYPE_TRAY_ICON, "title", name, NULL);
-}
-
-guint egg_tray_icon_send_message (EggTrayIcon *icon,
-			    gint         timeout,
-			    const gchar *message,
-			    gint         len)
-{
-  guint stamp;
-  
-  g_return_val_if_fail (EGG_IS_TRAY_ICON (icon), 0);
-  g_return_val_if_fail (timeout >= 0, 0);
-  g_return_val_if_fail (message != NULL, 0);
-		     
-  if (icon->manager_window == None)
-    return 0;
-
-  if (len < 0)
-    len = strlen (message);
-
-  stamp = icon->stamp++;
-  
-  /* Get ready to send the message */
-  egg_tray_icon_send_manager_message (icon, SYSTEM_TRAY_BEGIN_MESSAGE,
-				      (Window)gtk_plug_get_id (GTK_PLUG (icon)),
-				      timeout, len, stamp);
-
-  /* Now to send the actual message */
-  gdk_error_trap_push ();
-  while (len > 0)
-    {
-      XClientMessageEvent ev;
-      Display *xdisplay;
-
-      xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-      
-      ev.type = ClientMessage;
-      ev.window = (Window)gtk_plug_get_id (GTK_PLUG (icon));
-      ev.format = 8;
-      ev.message_type = XInternAtom (xdisplay,
-				     "_NET_SYSTEM_TRAY_MESSAGE_DATA", False);
-      if (len > 20)
-	{
-	  memcpy (&ev.data, message, 20);
-	  len -= 20;
-	  message += 20;
-	}
-      else
-	{
-	  memcpy (&ev.data, message, len);
-	  len = 0;
-	}
-
-      XSendEvent (xdisplay,
-		  icon->manager_window, False, StructureNotifyMask, (XEvent *)&ev);
-      XSync (xdisplay, False);
-    }
-  gdk_error_trap_pop ();
-
-  return stamp;
-}
-
-void egg_tray_icon_cancel_message (EggTrayIcon *icon,
-			      guint        id)
-{
-  g_return_if_fail (EGG_IS_TRAY_ICON (icon));
-  g_return_if_fail (id > 0);
-  
-  egg_tray_icon_send_manager_message (icon, SYSTEM_TRAY_CANCEL_MESSAGE,
-				      (Window)gtk_plug_get_id (GTK_PLUG (icon)),
-				      id, 0, 0);
-}
-
-GtkOrientation egg_tray_icon_get_orientation (EggTrayIcon *icon)
-{
-  g_return_val_if_fail (EGG_IS_TRAY_ICON (icon), GTK_ORIENTATION_HORIZONTAL);
-
-  return icon->orientation;
-}
-/**************************************************************/
-static GtkWidget   *systray_icon = NULL;
-static GtkWidget   *evbox = NULL;
-static GtkTooltips *systray_icon_tooltips = NULL;
-
-void *adm_new_systray(GdkPixbuf *pixbufA[],int nb , char *name)
-{
-	flipflop=0;
-  systray_icon = GTK_WIDGET (egg_tray_icon_new ("Avidemux"));
-  nbListOfIcons=nb;
-  if(listOfIcons) ADM_dealloc(listOfIcons);
-  listOfIcons=NULL;
-  listOfIcons=ADM_alloc(sizeof( GdkPixbuf *)*nb);
-  memcpy(listOfIcons,pixbufA,sizeof(GdkPixbuf *)*nb);
-  img = gtk_image_new_from_pixbuf (listOfIcons[0]);
-  
-
-  evbox = gtk_event_box_new ();
-  gtk_container_add (GTK_CONTAINER (systray_icon), evbox);
-  gtk_container_add (GTK_CONTAINER (evbox), img);
-  gtk_widget_show_all (systray_icon);
-  gtk_widget_realize (systray_icon);
-  gtk_widget_show (systray_icon);
-
-  systray_icon_tooltips = gtk_tooltips_new ();
-  gtk_tooltips_enable (systray_icon_tooltips);
-
-  gtk_tooltips_set_tip (systray_icon_tooltips, systray_icon, "avidemux", "");
-  return (void *)systray_icon;
-}
-void adm_delete_systray(void *systray)
-{
- ADM_assert( (void*)systray_icon==systray);
- gtk_widget_destroy(systray_icon);
-}
-void adm_change_tooltip(void *systray, const char *tips)
-{
- ADM_assert( (void*)systray_icon==systray);
- gtk_tooltips_set_tip (systray_icon_tooltips, systray_icon, tips, "");
-}
-void adm_changeIcon_systray(void)
-{
-GdkPixbuf *cur;
-	flipflop%=nbListOfIcons; // Double check
-	cur=listOfIcons[flipflop];
-		ADM_assert(cur);
-	flipflop++;
-	flipflop%=nbListOfIcons; // Double check
-  	gtk_image_set_from_pixbuf( GTK_IMAGE(img), GDK_PIXBUF(cur));
-
-}
-#endif   /* not defined GUI_DISABLE_SYSTRAY */
-
-

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h	2008-06-16 12:13:43 UTC (rev 4105)
@@ -1,82 +0,0 @@
-/* -*- Mode: C; tab-width: 8; indent-tabs-mode: t; c-basic-offset: 8 -*- */
-/* eggtrayicon.h
- * Copyright (C) 2002 Anders Carlsson <andersca at gnu.org>
- *
- * This library is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2 of the License, or (at your option) any later version.
- *
- * This library is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with this library; if not, write to the
- * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
- * Boston, MA 02111-1307, USA.
- */
-
-#ifndef __EGG_TRAY_ICON_H__
-#define __EGG_TRAY_ICON_H__
-
-#include <gtk/gtkplug.h>
-#include <gdk/gdkx.h>
-#include <X11/Xatom.h>
-
-G_BEGIN_DECLS
-
-#define EGG_TYPE_TRAY_ICON		(egg_tray_icon_get_type ())
-#define EGG_TRAY_ICON(obj)		(G_TYPE_CHECK_INSTANCE_CAST ((obj), EGG_TYPE_TRAY_ICON, EggTrayIcon))
-#define EGG_TRAY_ICON_CLASS(klass)	(G_TYPE_CHECK_CLASS_CAST ((klass), EGG_TYPE_TRAY_ICON, EggTrayIconClass))
-#define EGG_IS_TRAY_ICON(obj)		(G_TYPE_CHECK_INSTANCE_TYPE ((obj), EGG_TYPE_TRAY_ICON))
-#define EGG_IS_TRAY_ICON_CLASS(klass)	(G_TYPE_CHECK_CLASS_TYPE ((klass), EGG_TYPE_TRAY_ICON))
-#define EGG_TRAY_ICON_GET_CLASS(obj)	(G_TYPE_INSTANCE_GET_CLASS ((obj), EGG_TYPE_TRAY_ICON, EggTrayIconClass))
-
-typedef struct _EggTrayIcon	  EggTrayIcon;
-typedef struct _EggTrayIconClass  EggTrayIconClass;
-
-struct _EggTrayIcon
-{
-  GtkPlug parent_instance;
-
-  guint stamp;
-
-  Atom selection_atom;
-  Atom manager_atom;
-  Atom system_tray_opcode_atom;
-  Atom orientation_atom;
-  Window manager_window;
-
-  GtkOrientation orientation;
-};
-
-struct _EggTrayIconClass
-{
-  GtkPlugClass parent_class;
-};
-
-
-GType        egg_tray_icon_get_type       (void);
-
-EggTrayIcon *egg_tray_icon_new_for_screen (GdkScreen   *screen,
-					   const gchar *name);
-
-
-
-guint        egg_tray_icon_send_message   (EggTrayIcon *icon,
-					   gint         timeout,
-					   const char  *message,
-					   gint         len);
-void         egg_tray_icon_cancel_message (EggTrayIcon *icon,
-					   guint        id);
-
-GtkOrientation egg_tray_icon_get_orientation (EggTrayIcon *icon);
-
-EggTrayIcon *egg_tray_icon_new            (const gchar *name);
-
-G_END_DECLS
-#endif /* __EGG_TRAY_ICON_H__ */
-
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h	2008-06-16 11:54:28 UTC (rev 4104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h	2008-06-16 12:13:43 UTC (rev 4105)
@@ -22,8 +22,9 @@
 {
 protected:
         void    *sys;
+		void *_parent;
 public:
-                ADM_tray(char *name);
+                ADM_tray(void *parent);
                 ~ADM_tray();
         uint8_t setPercent(int percent);
         uint8_t setStatus(int working);



From gruntster at mail.berlios.de  Mon Jun 16 17:43:30 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 17:43:30 +0200
Subject: [Avidemux-svn-commit] r4106 - in branches/avidemux_2.4_branch: .
	avidemux/ADM_audiocodec avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200806161543.m5GFhUOV032616@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 17:43:11 +0200 (Mon, 16 Jun 2008)
New Revision: 4106

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c
Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
   branches/avidemux_2.4_branch/config.h.cmake
Log:
[amrnb] fix regressions (r3385, r3473, r3598, r3612)

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2008-06-16 15:43:11 UTC (rev 4106)
@@ -456,7 +456,7 @@
 ENDIF (USE_LATE_BINDING)
 
 IF (USE_AMR_NB)
-	SET(CONFIG_AMR_NB 1)
+	SET(CONFIG_LIBAMR_NB 1)
 ENDIF (USE_AMR_NB)
 
 ########################################

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp	2008-06-16 15:43:11 UTC (rev 4106)
@@ -235,6 +235,7 @@
         _tail+=nbIn;
         while(_tail-_head>AMR_PACKET)
         {
+          pout=SCRATCH_PAD_SIZE;
           out=avcodec_decode_audio2(_context,(int16_t *)scratchPad,
                                    &pout,_buffer+_head,_tail-_head);
                 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2008-06-16 15:43:11 UTC (rev 4106)
@@ -15,7 +15,7 @@
 		roqvideo.c 	xan.c 	rpza.c 	msrle.c 	msvideo1.c 	cinepak.c 	vqavideo.c 
 		idcinvideo.c 	smc.c 	flicvideo.c 	interplayvideo.c 	dpcm.c 	8bps.c vmdav.c 
 		truemotion1.c flac.c g726.c 	qtrle.c lcl.c 	snow.c  
-		rangecoder.c bitstream.c h264idct.c h261.c amr.c tscc.c 
+		rangecoder.c bitstream.c h264idct.c h261.c libamr.c tscc.c 
 		resample2.c pthread.c qdm2.c bitstream_filter.c eval.c 
 		vc1.c vc1dsp.c vp56.c  vp6.c vp5.c indeo2.c smacker.c  opt.c
                 fraps.c dnxhddata.h  dnxhddec.c

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2008-06-16 15:43:11 UTC (rev 4106)
@@ -54,7 +54,7 @@
 		roqvideo.c 	xan.c 	rpza.c 	msrle.c 	msvideo1.c 	cinepak.c 	vqavideo.c \
 		idcinvideo.c 	smc.c 	flicvideo.c 	interplayvideo.c 	dpcm.c 	8bps.c vmdav.c \
 		truemotion1.c flac.c g726.c 	qtrle.c lcl.c 	snow.c  \
-		rangecoder.c bitstream.c h264idct.c h261.c amr.c tscc.c \
+		rangecoder.c bitstream.c h264idct.c h261.c libamr.c tscc.c \
 		resample2.c pthread.c qdm2.c bitstream_filter.c eval.c \
 		vc1.c vc1dsp.c vp56.c vp56data.c vp6.c vp5.c indeo2.c indeo3.c  smacker.c  opt.c \
 		 fraps.c dnxhddata.h  dnxhddec.c	\
@@ -93,7 +93,7 @@
 adx.c     eval.c      kmvc.c       pnm.c    utils.c \
 alac.c      faac.c      lcl.c      pthread.c  vc1.c \
 allcodecs.c   faad.c      libgsm.c     qdm2.c   vcr1.c \
-amr.c     faandct.c     loco.c       qdrw.c   vmdav.c \
+libamr.c     faandct.c     loco.c       qdrw.c   vmdav.c \
 apiexample.c    fdctref.c     lzo.c      qpeg.c   vorbis.c \
 asv1.c      fft-test.c    mace.c       qtrle.c    vp3.c \
 avcodec.c     fft.c     mdct.c       ra144.c    vp3dsp.c \

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c	2008-06-16 15:43:11 UTC (rev 4106)
@@ -1,699 +0,0 @@
-/*
- * AMR Audio decoder stub
- * Copyright (c) 2003 the ffmpeg project
- *
- * This file is part of FFmpeg.
- *
- * FFmpeg is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2.1 of the License, or (at your option) any later version.
- *
- * FFmpeg is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with FFmpeg; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
- /*
-    This code implements amr-nb and amr-wb audio encoder/decoder through external reference
-    code from www.3gpp.org. The licence of the code from 3gpp is unclear so you
-    have to download the code separately. Two versions exists: One fixed-point
-    and one with floats. For some reason the float-encoder is significant faster
-    atleast on a P4 1.5GHz (0.9s instead of 9.9s on a 30s audio clip at MR102).
-    Both float and fixed point is supported for amr-nb, but only float for
-    amr-wb.
-
-    --AMR-NB--
-    The fixed-point (TS26.073) can be downloaded from:
-    http://www.3gpp.org/ftp/Specs/archive/26_series/26.073/26073-510.zip
-    Extract the soure into ffmpeg/libavcodec/amr
-    To use the fixed version run "./configure" with "--enable-amr_nb-fixed"
-
-    The float version (default) can be downloaded from:
-    http://www.3gpp.org/ftp/Specs/archive/26_series/26.104/26104-510.zip
-    Extract the soure into ffmpeg/libavcodec/amrnb
-
-    The specification for amr-nb can be found in TS 26.071
-    (http://www.3gpp.org/ftp/Specs/html-info/26071.htm) and some other
-    info at http://www.3gpp.org/ftp/Specs/html-info/26-series.htm
-
-    --AMR-WB--
-    The reference code can be downloaded from:
-    http://www.3gpp.org/ftp/Specs/archive/26_series/26.204/26204-510.zip
-    It should be extracted to "libavcodec/amrwb_float". Enable it with
-    "--enable-amr_wb".
-
-    The specification for amr-wb can be downloaded from:
-    http://www.3gpp.org/ftp/Specs/archive/26_series/26.171/26171-500.zip
-
-    If someone want to use the fixed point version it can be downloaded
-    from: http://www.3gpp.org/ftp/Specs/archive/26_series/26.173/26173-571.zip
-
- */
- /* MEANX */
-#include "config.h"
-#ifdef USE_AMR_NB
- /* MEANX */
-
-#include "ADM_libraries/ADM_libwrapper/libwrapper_global.h"
-#include "avcodec.h"
-
-#ifdef CONFIG_AMR_NB_FIXED
-
-#define MMS_IO
-
-#include "amr/sp_dec.h"
-#include "amr/d_homing.h"
-#include "amr/typedef.h"
-#include "amr/sp_enc.h"
-#include "amr/sid_sync.h"
-#include "amr/e_homing.h"
-
-#else
-#include "amrnb/interf_dec.h"
-#include "amrnb/interf_enc.h"
-#endif
-
-/* Common code for fixed and float version*/
-typedef struct AMR_bitrates
-{
-    int startrate;
-    int stoprate;
-    enum Mode mode;
-
-} AMR_bitrates;
-
-/* Match desired bitrate with closest one*/
-static enum Mode getBitrateMode(int bitrate)
-{
-    /* Adjusted so that all bitrates can be used from commandline where
-       only a multiple of 1000 can be specified*/
-    AMR_bitrates rates[]={ {0,4999,MR475}, //4
-                           {5000,5899,MR515},//5
-                           {5900,6699,MR59},//6
-                           {6700,7000,MR67},//7
-                           {7001,7949,MR74},//8
-                           {7950,9999,MR795},//9
-                           {10000,11999,MR102},//10
-                           {12000,64000,MR122},//12
-
-                         };
-    int i;
-    for(i=0;i<8;i++)
-    {
-        if(rates[i].startrate<=bitrate && rates[i].stoprate>=bitrate)
-        {
-            return(rates[i].mode);
-        }
-    }
-    /*Return highest possible*/
-    return(MR122);
-}
-
-static void amr_decode_fix_avctx(AVCodecContext * avctx)
-{
-    const int is_amr_wb = 1 + (avctx->codec_id == CODEC_ID_AMR_WB);
-
-    if(avctx->sample_rate == 0)
-    {
-        avctx->sample_rate = 8000 * is_amr_wb;
-    }
-
-    if(avctx->channels == 0)
-    {
-        avctx->channels = 1;
-    }
-
-    avctx->frame_size = 160 * is_amr_wb;
-}
-
-#ifdef CONFIG_AMR_NB_FIXED
-/* fixed point version*/
-/* frame size in serial bitstream file (frame type + serial stream + flags) */
-#define SERIAL_FRAMESIZE (1+MAX_SERIAL_SIZE+5)
-
-typedef struct AMRContext {
-    int frameCount;
-    Speech_Decode_FrameState *speech_decoder_state;
-    enum RXFrameType rx_type;
-    enum Mode mode;
-    Word16 reset_flag;
-    Word16 reset_flag_old;
-
-    enum Mode enc_bitrate;
-    Speech_Encode_FrameState *enstate;
-    sid_syncState *sidstate;
-    enum TXFrameType tx_frametype;
-
-
-} AMRContext;
-
-static int amr_nb_decode_init(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    s->frameCount=0;
-    s->speech_decoder_state=NULL;
-    s->rx_type = (enum RXFrameType)0;
-    s->mode= (enum Mode)0;
-    s->reset_flag=0;
-    s->reset_flag_old=1;
-
-    if(Speech_Decode_Frame_init(&s->speech_decoder_state, "Decoder"))
-    {
-        av_log(avctx, AV_LOG_ERROR, "Speech_Decode_Frame_init error\n");
-        return -1;
-    }
-
-    amr_decode_fix_avctx(avctx);
-
-    if(avctx->channels > 1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "amr_nb: multichannel decoding not supported\n");
-        return -1;
-    }
-
-    return 0;
-}
-
-static int amr_nb_encode_init(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    s->frameCount=0;
-    s->speech_decoder_state=NULL;
-    s->rx_type = (enum RXFrameType)0;
-    s->mode= (enum Mode)0;
-    s->reset_flag=0;
-    s->reset_flag_old=1;
-
-    if(avctx->sample_rate!=8000)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only 8000Hz sample rate supported\n");
-        return -1;
-    }
-
-    if(avctx->channels!=1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
-        return -1;
-    }
-
-    avctx->frame_size=160;
-    avctx->coded_frame= avcodec_alloc_frame();
-
-    if(Speech_Encode_Frame_init(&s->enstate, 0, "encoder") || sid_sync_init (&s->sidstate))
-    {
-        av_log(avctx, AV_LOG_ERROR, "Speech_Encode_Frame_init error\n");
-        return -1;
-    }
-
-    s->enc_bitrate=getBitrateMode(avctx->bit_rate);
-
-    return 0;
-}
-
-static int amr_nb_encode_close(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    Speech_Encode_Frame_exit(&s->enstate);
-    sid_sync_exit (&s->sidstate);
-    av_freep(&avctx->coded_frame);
-    return 0;
-}
-
-static int amr_nb_decode_close(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    Speech_Decode_Frame_exit(&s->speech_decoder_state);
-    return 0;
-}
-
-static int amr_nb_decode_frame(AVCodecContext * avctx,
-            void *data, int *data_size,
-            uint8_t * buf, int buf_size)
-{
-    AMRContext *s = avctx->priv_data;
-
-    uint8_t*amrData=buf;
-    int offset=0;
-
-    UWord8 toc, q, ft;
-
-    Word16 serial[SERIAL_FRAMESIZE];   /* coded bits */
-    Word16 *synth;
-    UWord8 *packed_bits;
-
-    static Word16 packed_size[16] = {12, 13, 15, 17, 19, 20, 26, 31, 5, 0, 0, 0, 0, 0, 0, 0};
-    int i;
-
-    //printf("amr_decode_frame data_size=%i buf=0x%X buf_size=%d frameCount=%d!!\n",*data_size,buf,buf_size,s->frameCount);
-
-    synth=data;
-
-//    while(offset<buf_size)
-    {
-        toc=amrData[offset];
-        /* read rest of the frame based on ToC byte */
-        q  = (toc >> 2) & 0x01;
-        ft = (toc >> 3) & 0x0F;
-
-        //printf("offset=%d, packet_size=%d amrData= 0x%X %X %X %X\n",offset,packed_size[ft],amrData[offset],amrData[offset+1],amrData[offset+2],amrData[offset+3]);
-
-        offset++;
-
-        packed_bits=amrData+offset;
-
-        offset+=packed_size[ft];
-
-        //Unsort and unpack bits
-        s->rx_type = UnpackBits(q, ft, packed_bits, &s->mode, &serial[1]);
-
-        //We have a new frame
-        s->frameCount++;
-
-        if (s->rx_type == RX_NO_DATA)
-        {
-            s->mode = s->speech_decoder_state->prev_mode;
-        }
-        else {
-            s->speech_decoder_state->prev_mode = s->mode;
-        }
-
-        /* if homed: check if this frame is another homing frame */
-        if (s->reset_flag_old == 1)
-        {
-            /* only check until end of first subframe */
-            s->reset_flag = decoder_homing_frame_test_first(&serial[1], s->mode);
-        }
-        /* produce encoder homing frame if homed & input=decoder homing frame */
-        if ((s->reset_flag != 0) && (s->reset_flag_old != 0))
-        {
-            for (i = 0; i < L_FRAME; i++)
-            {
-                synth[i] = EHF_MASK;
-            }
-        }
-        else
-        {
-            /* decode frame */
-            Speech_Decode_Frame(s->speech_decoder_state, s->mode, &serial[1], s->rx_type, synth);
-        }
-
-        //Each AMR-frame results in 160 16-bit samples
-        *data_size+=160*2;
-        synth+=160;
-
-        /* if not homed: check whether current frame is a homing frame */
-        if (s->reset_flag_old == 0)
-        {
-            /* check whole frame */
-            s->reset_flag = decoder_homing_frame_test(&serial[1], s->mode);
-        }
-        /* reset decoder if current frame is a homing frame */
-        if (s->reset_flag != 0)
-        {
-            Speech_Decode_Frame_reset(s->speech_decoder_state);
-        }
-        s->reset_flag_old = s->reset_flag;
-
-    }
-    return offset;
-}
-
-
-static int amr_nb_encode_frame(AVCodecContext *avctx,
-                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
-{
-    short serial_data[250] = {0};
-
-    AMRContext *s = avctx->priv_data;
-    int written;
-
-    s->reset_flag = encoder_homing_frame_test(data);
-
-    Speech_Encode_Frame(s->enstate, s->enc_bitrate, data, &serial_data[1], &s->mode);
-
-    /* add frame type and mode */
-    sid_sync (s->sidstate, s->mode, &s->tx_frametype);
-
-    written = PackBits(s->mode, s->enc_bitrate, s->tx_frametype, &serial_data[1], frame);
-
-    if (s->reset_flag != 0)
-    {
-        Speech_Encode_Frame_reset(s->enstate);
-        sid_sync_reset(s->sidstate);
-    }
-    return written;
-}
-
-
-#elif defined(CONFIG_AMR_NB) /* Float point version*/
-
-typedef struct AMRContext {
-    int frameCount;
-    void * decState;
-    int *enstate;
-    enum Mode enc_bitrate;
-} AMRContext;
-
-static int amr_nb_decode_init(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    s->frameCount=0;
-    s->decState=Decoder_Interface_initQT_TR_NOOP(getAmrnbWrapper());
-    if(!s->decState)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Decoder_Interface_init error\r\n");
-        return -1;
-    }
-
-    amr_decode_fix_avctx(avctx);
-
-    if(avctx->channels > 1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "amr_nb: multichannel decoding not supported\n");
-        return -1;
-    }
-
-    return 0;
-}
-
-static int amr_nb_encode_init(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    s->frameCount=0;
-
-    if(avctx->sample_rate!=8000)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only 8000Hz sample rate supported\n");
-        return -1;
-    }
-
-    if(avctx->channels!=1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
-        return -1;
-    }
-
-    avctx->frame_size=160;
-    avctx->coded_frame= avcodec_alloc_frame();
-
-    s->enstate=Encoder_Interface_initQT_TR_NOOP(getAmrnbWrapper(), 0);
-    if(!s->enstate)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Encoder_Interface_init error\n");
-        return -1;
-    }
-
-    s->enc_bitrate=getBitrateMode(avctx->bit_rate);
-
-    return 0;
-}
-
-static int amr_nb_decode_close(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    Decoder_Interface_exitQT_TR_NOOP(getAmrnbWrapper(), s->decState);
-    return 0;
-}
-
-static int amr_nb_encode_close(AVCodecContext * avctx)
-{
-    AMRContext *s = avctx->priv_data;
-    Encoder_Interface_exitQT_TR_NOOP(getAmrnbWrapper(), s->enstate);
-    av_freep(&avctx->coded_frame);
-    return 0;
-}
-
-static int amr_nb_decode_frame(AVCodecContext * avctx,
-            void *data, int *data_size,
-            uint8_t * buf, int buf_size)
-{
-    AMRContext *s = (AMRContext*)avctx->priv_data;
-
-    uint8_t*amrData=buf;
-    static short block_size[16]={ 12, 13, 15, 17, 19, 20, 26, 31, 5, 0, 0, 0, 0, 0, 0, 0 };
-    enum Mode dec_mode;
-    int packet_size;
-
-    /* av_log(NULL,AV_LOG_DEBUG,"amr_decode_frame buf=%p buf_size=%d frameCount=%d!!\n",buf,buf_size,s->frameCount); */
-
-    if(buf_size==0) {
-        /* nothing to do */
-        return 0;
-    }
-
-    dec_mode = (buf[0] >> 3) & 0x000F;
-    packet_size = block_size[dec_mode]+1;
-
-    if(packet_size > buf_size) {
-        av_log(avctx, AV_LOG_ERROR, "amr frame too short (%u, should be %u)\n", buf_size, packet_size);
-        return -1;
-    }
-
-    s->frameCount++;
-    /* av_log(NULL,AV_LOG_DEBUG,"packet_size=%d amrData= 0x%X %X %X %X\n",packet_size,amrData[0],amrData[1],amrData[2],amrData[3]); */
-    /* call decoder */
-    Decoder_Interface_DecodeQT_TR_NOOP(getAmrnbWrapper(), s->decState, amrData, data, 0);
-    *data_size=160*2;
-
-    return packet_size;
-}
-
-static int amr_nb_encode_frame(AVCodecContext *avctx,
-                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
-{
-    AMRContext *s = (AMRContext*)avctx->priv_data;
-    int written;
-
-    s->enc_bitrate=getBitrateMode(avctx->bit_rate);
-
-    written = Encoder_Interface_EncodeQT_TR_NOOP(getAmrnbWrapper(), s->enstate,
-        s->enc_bitrate,
-        data,
-        frame,
-        0);
-    /* av_log(NULL,AV_LOG_DEBUG,"amr_nb_encode_frame encoded %u bytes, bitrate %u, first byte was %#02x\n",written, s->enc_bitrate, frame[0] ); */
-
-    return written;
-}
-
-#endif
-
-#if defined(CONFIG_AMR_NB) || defined(CONFIG_AMR_NB_FIXED)
-
-AVCodec amr_nb_decoder =
-{
-    "amr_nb",
-    CODEC_TYPE_AUDIO,
-    CODEC_ID_AMR_NB,
-    sizeof(AMRContext),
-    amr_nb_decode_init,
-    NULL,
-    amr_nb_decode_close,
-    amr_nb_decode_frame,
-};
-
-AVCodec amr_nb_encoder =
-{
-    "amr_nb",
-    CODEC_TYPE_AUDIO,
-    CODEC_ID_AMR_NB,
-    sizeof(AMRContext),
-    amr_nb_encode_init,
-    amr_nb_encode_frame,
-    amr_nb_encode_close,
-    NULL,
-};
-
-#endif
-
-/* -----------AMR wideband ------------*/
-#ifdef CONFIG_AMR_WB
-
-#ifdef _TYPEDEF_H
-//To avoid duplicate typedefs from typdef in amr-nb
-#define typedef_h
-#endif
-
-#include "amrwb_float/enc_if.h"
-#include "amrwb_float/dec_if.h"
-
-/* Common code for fixed and float version*/
-typedef struct AMRWB_bitrates
-{
-    int startrate;
-    int stoprate;
-    int mode;
-
-} AMRWB_bitrates;
-
-static int getWBBitrateMode(int bitrate)
-{
-    /* Adjusted so that all bitrates can be used from commandline where
-       only a multiple of 1000 can be specified*/
-    AMRWB_bitrates rates[]={ {0,7999,0}, //6.6kHz
-                           {8000,9999,1},//8.85
-                           {10000,13000,2},//12.65
-                           {13001,14999,3},//14.25
-                           {15000,17000,4},//15.85
-                           {17001,18000,5},//18.25
-                           {18001,22000,6},//19.85
-                           {22001,23000,7},//23.05
-                           {23001,24000,8},//23.85
-
-                         };
-    int i;
-
-    for(i=0;i<9;i++)
-    {
-        if(rates[i].startrate<=bitrate && rates[i].stoprate>=bitrate)
-        {
-            return(rates[i].mode);
-        }
-    }
-    /*Return highest possible*/
-    return(8);
-}
-
-
-typedef struct AMRWBContext {
-    int frameCount;
-    void *state;
-    int mode;
-    Word16 allow_dtx;
-} AMRWBContext;
-
-static int amr_wb_encode_init(AVCodecContext * avctx)
-{
-    AMRWBContext *s = (AMRWBContext*)avctx->priv_data;
-    s->frameCount=0;
-
-    if(avctx->sample_rate!=16000)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only 16000Hz sample rate supported\n");
-        return -1;
-    }
-
-    if(avctx->channels!=1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
-        return -1;
-    }
-
-    avctx->frame_size=320;
-    avctx->coded_frame= avcodec_alloc_frame();
-
-    s->state = E_IF_init();
-    s->mode=getWBBitrateMode(avctx->bit_rate);
-    s->allow_dtx=0;
-
-    return 0;
-}
-
-static int amr_wb_encode_close(AVCodecContext * avctx)
-{
-    AMRWBContext *s = (AMRWBContext*) avctx->priv_data;
-    E_IF_exit(s->state);
-    av_freep(&avctx->coded_frame);
-    s->frameCount++;
-    return 0;
-}
-
-static int amr_wb_encode_frame(AVCodecContext *avctx,
-                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
-{
-    AMRWBContext *s;
-    int size;
-    s = (AMRWBContext*) avctx->priv_data;
-    s->mode=getWBBitrateMode(avctx->bit_rate);
-    size = E_IF_encode(s->state, s->mode, data, frame, s->allow_dtx);
-    return size;
-}
-
-static int amr_wb_decode_init(AVCodecContext * avctx)
-{
-    AMRWBContext *s = (AMRWBContext *)avctx->priv_data;
-    s->frameCount=0;
-    s->state = D_IF_init();
-
-    amr_decode_fix_avctx(avctx);
-
-    if(avctx->channels > 1)
-    {
-        av_log(avctx, AV_LOG_ERROR, "amr_wb: multichannel decoding not supported\n");
-        return -1;
-    }
-
-    return 0;
-}
-
-extern const UWord8 block_size[];
-
-static int amr_wb_decode_frame(AVCodecContext * avctx,
-            void *data, int *data_size,
-            uint8_t * buf, int buf_size)
-{
-    AMRWBContext *s = (AMRWBContext*)avctx->priv_data;
-
-    uint8_t*amrData=buf;
-    int mode;
-    int packet_size;
-
-    if(buf_size==0) {
-        /* nothing to do */
-        return 0;
-    }
-
-    mode = (amrData[0] >> 3) & 0x000F;
-    packet_size = block_size[mode];
-
-    if(packet_size > buf_size) {
-        av_log(avctx, AV_LOG_ERROR, "amr frame too short (%u, should be %u)\n", buf_size, packet_size+1);
-        return -1;
-    }
-
-    s->frameCount++;
-    D_IF_decode( s->state, amrData, data, _good_frame);
-    *data_size=320*2;
-    return packet_size;
-}
-
-static int amr_wb_decode_close(AVCodecContext * avctx)
-{
-    AMRWBContext *s = (AMRWBContext *)avctx->priv_data;
-    D_IF_exit(s->state);
-    return 0;
-}
-
-AVCodec amr_wb_decoder =
-{
-    "amr_wb",
-    CODEC_TYPE_AUDIO,
-    CODEC_ID_AMR_WB,
-    sizeof(AMRWBContext),
-    amr_wb_decode_init,
-    NULL,
-    amr_wb_decode_close,
-    amr_wb_decode_frame,
-};
-
-AVCodec amr_wb_encoder =
-{
-    "amr_wb",
-    CODEC_TYPE_AUDIO,
-    CODEC_ID_AMR_WB,
-    sizeof(AMRWBContext),
-    amr_wb_encode_init,
-    amr_wb_encode_frame,
-    amr_wb_encode_close,
-    NULL,
-};
-
-#endif //CONFIG_AMR_WB
- /* MEANX */
- #endif
- /* MEANX */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2008-06-16 15:43:11 UTC (rev 4106)
@@ -6,6 +6,8 @@
 #include <stdio.h>
 int main(void)
 {
+	printf("#include \"config.h\"\n\n");
+
 #define DECLARE_DECODER(a,b); printf("#define ENABLE_"#a"_DECODER 1\n"); 
   
     DECLARE_DECODER(NELLYMOSER,nellymoser);
@@ -144,7 +146,6 @@
     DECLARE_DECODER (ZLIB, zlib);
     DECLARE_DECODER (ZMBV, zmbv);
     DECLARE_DECODER (FLAC, flac);
-    DECLARE_DECODER (LIBAMR_NB, libamr_nb);
     DECLARE_DECODER (LIBAMR_WB, libamr_wb);
     DECLARE_DECODER (LIBGSM, libgsm);
     DECLARE_DECODER (LIBGSM_MS, libgsm_ms);
@@ -190,6 +191,12 @@
     DECLARE_DECODER (ADPCM_YAMAHA, adpcm_yamaha);
     DECLARE_DECODER (DVDSUB, dvdsub);
 
+	printf("#ifdef USE_AMR_NB\n");
+	printf("#define ENABLE_LIBAMR_NB_DECODER 1\n");
+	printf("#else\n");
+	printf("#define ENABLE_LIBAMR_NB_DECODER 0\n");
+	printf("#endif\n");
+
 #define DECLARE_PARSER(a,b); printf("#define ENABLE_"#a"_PARSER 1\n"); 
     DECLARE_PARSER (H263, h263);
     DECLARE_PARSER (H264, h264);
@@ -333,7 +340,6 @@
 printf("#define ENABLE_ALPHA      0\n");
 
 // Hack so CMake and autoconf don't need to be changed
-printf("#include \"config.h\"\n");
 printf("#ifdef ARCH_POWERPC\n");
 printf("#define ENABLE_POWERPC      1\n");
 printf("#else\n");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2008-06-16 15:43:11 UTC (rev 4106)
@@ -1,3 +1,5 @@
+#include "config.h"
+
 #define ENABLE_NELLYMOSER_DECODER 1
 #define ENABLE_ADPCM_IMA_AMV_DECODER 1
 #define ENABLE_CINEPAK_DECODER 1
@@ -130,7 +132,6 @@
 #define ENABLE_ZLIB_DECODER 0
 #define ENABLE_ZMBV_DECODER 0
 #define ENABLE_FLAC_DECODER 0
-#define ENABLE_LIBAMR_NB_DECODER 0
 #define ENABLE_LIBAMR_WB_DECODER 0
 #define ENABLE_LIBGSM_DECODER 0
 #define ENABLE_LIBGSM_MS_DECODER 0
@@ -175,6 +176,11 @@
 #define ENABLE_ADPCM_XA_DECODER 0
 #define ENABLE_ADPCM_YAMAHA_DECODER 0
 #define ENABLE_DVDSUB_DECODER 0
+#ifdef USE_AMR_NB
+#define ENABLE_LIBAMR_NB_DECODER 1
+#else
+#define ENABLE_LIBAMR_NB_DECODER 0
+#endif
 #define ENABLE_H263_PARSER 1
 #define ENABLE_H264_PARSER 1
 #define ENABLE_MPEG4VIDEO_PARSER 1
@@ -303,7 +309,6 @@
 #define ENABLE_MLIB      0
 #define ENABLE_SPARC      0
 #define ENABLE_ALPHA      0
-#include "config.h"
 #ifdef ARCH_POWERPC
 #define ENABLE_POWERPC      1
 #else

Copied: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c (from rev 4095, branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/amr.c	2008-06-13 12:18:36 UTC (rev 4095)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c	2008-06-16 15:43:11 UTC (rev 4106)
@@ -0,0 +1,719 @@
+/*
+ * AMR Audio decoder stub
+ * Copyright (c) 2003 the ffmpeg project
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+ /** @file
+ * Adaptive Multi-Rate (AMR) Audio decoder stub.
+ *
+ * This code implements both an AMR-NarrowBand (AMR-NB) and an AMR-WideBand
+ * (AMR-WB) audio encoder/decoder through external reference code from
+ * http://www.3gpp.org/. The license of the code from 3gpp is unclear so you
+ * have to download the code separately. Two versions exists: One fixed-point
+ * and one floating-point. For some reason the float encoder is significantly
+ * faster at least on a P4 1.5GHz (0.9s instead of 9.9s on a 30s audio clip
+ * at MR102). Both float and fixed point are supported for AMR-NB, but only
+ * float for AMR-WB.
+ *
+ * \section AMR-NB
+ *
+ * \subsection Float
+ * The float version (default) can be downloaded from:
+ * http://www.3gpp.org/ftp/Specs/archive/26_series/26.104/26104-610.zip
+ *
+ * \subsection Fixed-point
+ * The fixed-point (TS26.073) can be downloaded from:
+ * http://www.3gpp.org/ftp/Specs/archive/26_series/26.073/26073-600.zip
+ *
+ * \subsection Specification
+ * The specification for AMR-NB can be found in TS 26.071
+ * (http://www.3gpp.org/ftp/Specs/html-info/26071.htm) and some other
+ * info at http://www.3gpp.org/ftp/Specs/html-info/26-series.htm.
+ *
+ * \section AMR-WB
+ *
+ * \subsection Float
+ * The reference code can be downloaded from:
+ * http://www.3gpp.org/ftp/Specs/archive/26_series/26.204/26204-600.zip
+ *
+ * \subsection Fixed-point
+ * If someone wants to use the fixed point version it can be downloaded from:
+ * http://www.3gpp.org/ftp/Specs/archive/26_series/26.173/26173-571.zip.
+ *
+ * \subsection Specification
+ * The specification for AMR-WB can be found in TS 26.171
+ * (http://www.3gpp.org/ftp/Specs/html-info/26171.htm) and some other
+ * info at http://www.3gpp.org/ftp/Specs/html-info/26-series.htm.
+ *
+ */
+ /* MEANX */
+#include "config.h"
+#ifdef USE_AMR_NB
+ /* MEANX */
+
+#include "ADM_libraries/ADM_libwrapper/libwrapper_global.h"
+#include "avcodec.h"
+
+#ifdef CONFIG_LIBAMR_NB_FIXED
+
+#define MMS_IO
+
+#include "amr/sp_dec.h"
+#include "amr/d_homing.h"
+#include "amr/typedef.h"
+#include "amr/sp_enc.h"
+#include "amr/sid_sync.h"
+#include "amr/e_homing.h"
+
+#else
+#include <amrnb/interf_dec.h>
+#include <amrnb/interf_enc.h>
+#endif
+
+static const char *nb_bitrate_unsupported =
+    "bitrate not supported: use one of 4.75k, 5.15k, 5.9k, 6.7k, 7.4k, 7.95k, 10.2k or 12.2k\n";
+static const char *wb_bitrate_unsupported =
+    "bitrate not supported: use one of 6.6k, 8.85k, 12.65k, 14.25k, 15.85k, 18.25k, 19.85k, 23.05k, or 23.85k\n";
+
+/* Common code for fixed and float version*/
+typedef struct AMR_bitrates
+{
+    int rate;
+    enum Mode mode;
+} AMR_bitrates;
+
+/* Match desired bitrate */
+static int getBitrateMode(int bitrate)
+{
+    /* make the correspondance between bitrate and mode */
+    AMR_bitrates rates[]={ {4750,MR475},
+                           {5150,MR515},
+                           {5900,MR59},
+                           {6700,MR67},
+                           {7400,MR74},
+                           {7950,MR795},
+                           {10200,MR102},
+                           {12200,MR122},
+                         };
+    int i;
+
+    for(i=0;i<8;i++)
+    {
+        if(rates[i].rate==bitrate)
+        {
+            return(rates[i].mode);
+        }
+    }
+    /* no bitrate matching, return an error */
+    return -1;
+}
+
+static void amr_decode_fix_avctx(AVCodecContext * avctx)
+{
+    const int is_amr_wb = 1 + (avctx->codec_id == CODEC_ID_AMR_WB);
+
+    if(avctx->sample_rate == 0)
+    {
+        avctx->sample_rate = 8000 * is_amr_wb;
+    }
+
+    if(avctx->channels == 0)
+    {
+        avctx->channels = 1;
+    }
+
+    avctx->frame_size = 160 * is_amr_wb;
+}
+
+#ifdef CONFIG_LIBAMR_NB_FIXED
+/* fixed point version*/
+/* frame size in serial bitstream file (frame type + serial stream + flags) */
+#define SERIAL_FRAMESIZE (1+MAX_SERIAL_SIZE+5)
+
+typedef struct AMRContext {
+    int frameCount;
+    Speech_Decode_FrameState *speech_decoder_state;
+    enum RXFrameType rx_type;
+    enum Mode mode;
+    Word16 reset_flag;
+    Word16 reset_flag_old;
+
+    int enc_bitrate;
+    Speech_Encode_FrameState *enstate;
+    sid_syncState *sidstate;
+    enum TXFrameType tx_frametype;
+} AMRContext;
+
+static int amr_nb_decode_init(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+    s->speech_decoder_state=NULL;
+    s->rx_type = (enum RXFrameType)0;
+    s->mode= (enum Mode)0;
+    s->reset_flag=0;
+    s->reset_flag_old=1;
+
+    if(Speech_Decode_Frame_init(&s->speech_decoder_state, "Decoder"))
+    {
+        av_log(avctx, AV_LOG_ERROR, "Speech_Decode_Frame_init error\n");
+        return -1;
+    }
+
+    amr_decode_fix_avctx(avctx);
+
+    if(avctx->channels > 1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "amr_nb: multichannel decoding not supported\n");
+        return -1;
+    }
+
+    return 0;
+}
+
+static int amr_nb_encode_init(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+    s->speech_decoder_state=NULL;
+    s->rx_type = (enum RXFrameType)0;
+    s->mode= (enum Mode)0;
+    s->reset_flag=0;
+    s->reset_flag_old=1;
+
+    if(avctx->sample_rate!=8000)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only 8000Hz sample rate supported\n");
+        return -1;
+    }
+
+    if(avctx->channels!=1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
+        return -1;
+    }
+
+    avctx->frame_size=160;
+    avctx->coded_frame= avcodec_alloc_frame();
+
+    if(Speech_Encode_Frame_init(&s->enstate, 0, "encoder") || sid_sync_init (&s->sidstate))
+    {
+        av_log(avctx, AV_LOG_ERROR, "Speech_Encode_Frame_init error\n");
+        return -1;
+    }
+
+    if((s->enc_bitrate=getBitrateMode(avctx->bit_rate))<0)
+    {
+        av_log(avctx, AV_LOG_ERROR, nb_bitrate_unsupported);
+        return -1;
+    }
+
+    return 0;
+}
+
+static int amr_nb_encode_close(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    Speech_Encode_Frame_exit(&s->enstate);
+    sid_sync_exit (&s->sidstate);
+    av_freep(&avctx->coded_frame);
+    return 0;
+}
+
+static int amr_nb_decode_close(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    Speech_Decode_Frame_exit(&s->speech_decoder_state);
+    return 0;
+}
+
+static int amr_nb_decode_frame(AVCodecContext * avctx,
+            void *data, int *data_size,
+            uint8_t * buf, int buf_size)
+{
+    AMRContext *s = avctx->priv_data;
+    uint8_t*amrData=buf;
+    int offset=0;
+    UWord8 toc, q, ft;
+    Word16 serial[SERIAL_FRAMESIZE];   /* coded bits */
+    Word16 *synth;
+    UWord8 *packed_bits;
+    static Word16 packed_size[16] = {12, 13, 15, 17, 19, 20, 26, 31, 5, 0, 0, 0, 0, 0, 0, 0};
+    int i;
+
+    //printf("amr_decode_frame data_size=%i buf=0x%X buf_size=%d frameCount=%d!!\n",*data_size,buf,buf_size,s->frameCount);
+
+    synth=data;
+
+    toc=amrData[offset];
+    /* read rest of the frame based on ToC byte */
+    q  = (toc >> 2) & 0x01;
+    ft = (toc >> 3) & 0x0F;
+
+    //printf("offset=%d, packet_size=%d amrData= 0x%X %X %X %X\n",offset,packed_size[ft],amrData[offset],amrData[offset+1],amrData[offset+2],amrData[offset+3]);
+
+    offset++;
+
+    packed_bits=amrData+offset;
+
+    offset+=packed_size[ft];
+
+    //Unsort and unpack bits
+    s->rx_type = UnpackBits(q, ft, packed_bits, &s->mode, &serial[1]);
+
+    //We have a new frame
+    s->frameCount++;
+
+    if (s->rx_type == RX_NO_DATA)
+    {
+        s->mode = s->speech_decoder_state->prev_mode;
+    }
+    else {
+        s->speech_decoder_state->prev_mode = s->mode;
+    }
+
+    /* if homed: check if this frame is another homing frame */
+    if (s->reset_flag_old == 1)
+    {
+        /* only check until end of first subframe */
+        s->reset_flag = decoder_homing_frame_test_first(&serial[1], s->mode);
+    }
+    /* produce encoder homing frame if homed & input=decoder homing frame */
+    if ((s->reset_flag != 0) && (s->reset_flag_old != 0))
+    {
+        for (i = 0; i < L_FRAME; i++)
+        {
+            synth[i] = EHF_MASK;
+        }
+    }
+    else
+    {
+        /* decode frame */
+        Speech_Decode_Frame(s->speech_decoder_state, s->mode, &serial[1], s->rx_type, synth);
+    }
+
+    //Each AMR-frame results in 160 16-bit samples
+    *data_size=160*2;
+
+    /* if not homed: check whether current frame is a homing frame */
+    if (s->reset_flag_old == 0)
+    {
+        /* check whole frame */
+        s->reset_flag = decoder_homing_frame_test(&serial[1], s->mode);
+    }
+    /* reset decoder if current frame is a homing frame */
+    if (s->reset_flag != 0)
+    {
+        Speech_Decode_Frame_reset(s->speech_decoder_state);
+    }
+    s->reset_flag_old = s->reset_flag;
+
+    return offset;
+}
+
+
+static int amr_nb_encode_frame(AVCodecContext *avctx,
+                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
+{
+    short serial_data[250] = {0};
+    AMRContext *s = avctx->priv_data;
+    int written;
+
+    s->reset_flag = encoder_homing_frame_test(data);
+
+    Speech_Encode_Frame(s->enstate, s->enc_bitrate, data, &serial_data[1], &s->mode);
+
+    /* add frame type and mode */
+    sid_sync (s->sidstate, s->mode, &s->tx_frametype);
+
+    written = PackBits(s->mode, s->enc_bitrate, s->tx_frametype, &serial_data[1], frame);
+
+    if (s->reset_flag != 0)
+    {
+        Speech_Encode_Frame_reset(s->enstate);
+        sid_sync_reset(s->sidstate);
+    }
+    return written;
+}
+
+
+#elif defined(CONFIG_LIBAMR_NB) /* Float point version*/
+
+typedef struct AMRContext {
+    int frameCount;
+    void * decState;
+    int *enstate;
+    int enc_bitrate;
+} AMRContext;
+
+static int amr_nb_decode_init(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+    s->decState=Decoder_Interface_init_(getAmrnbWrapper());
+    if(!s->decState)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Decoder_Interface_init error\r\n");
+        return -1;
+    }
+
+    amr_decode_fix_avctx(avctx);
+
+    if(avctx->channels > 1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "amr_nb: multichannel decoding not supported\n");
+        return -1;
+    }
+
+    return 0;
+}
+
+static int amr_nb_encode_init(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+
+    if(avctx->sample_rate!=8000)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only 8000Hz sample rate supported\n");
+        return -1;
+    }
+
+    if(avctx->channels!=1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
+        return -1;
+    }
+
+    avctx->frame_size=160;
+    avctx->coded_frame= avcodec_alloc_frame();
+
+    s->enstate=Encoder_Interface_init_(getAmrnbWrapper(), 0);
+    if(!s->enstate)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Encoder_Interface_init error\n");
+        return -1;
+    }
+
+    if((s->enc_bitrate=getBitrateMode(avctx->bit_rate))<0)
+    {
+        av_log(avctx, AV_LOG_ERROR, nb_bitrate_unsupported);
+        return -1;
+    }
+
+    return 0;
+}
+
+static int amr_nb_decode_close(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    Decoder_Interface_exit(s->decState);
+    return 0;
+}
+
+static int amr_nb_encode_close(AVCodecContext * avctx)
+{
+    AMRContext *s = avctx->priv_data;
+
+    Encoder_Interface_exit(s->enstate);
+    av_freep(&avctx->coded_frame);
+    return 0;
+}
+
+static int amr_nb_decode_frame(AVCodecContext * avctx,
+            void *data, int *data_size,
+            uint8_t * buf, int buf_size)
+{
+    AMRContext *s = avctx->priv_data;
+    uint8_t*amrData=buf;
+    static short block_size[16]={ 12, 13, 15, 17, 19, 20, 26, 31, 5, 0, 0, 0, 0, 0, 0, 0 };
+    enum Mode dec_mode;
+    int packet_size;
+
+    /* av_log(NULL,AV_LOG_DEBUG,"amr_decode_frame buf=%p buf_size=%d frameCount=%d!!\n",buf,buf_size,s->frameCount); */
+
+    dec_mode = (buf[0] >> 3) & 0x000F;
+    packet_size = block_size[dec_mode]+1;
+
+    if(packet_size > buf_size) {
+        av_log(avctx, AV_LOG_ERROR, "amr frame too short (%u, should be %u)\n", buf_size, packet_size);
+        return -1;
+    }
+
+    s->frameCount++;
+    /* av_log(NULL,AV_LOG_DEBUG,"packet_size=%d amrData= 0x%X %X %X %X\n",packet_size,amrData[0],amrData[1],amrData[2],amrData[3]); */
+    /* call decoder */
+    Decoder_Interface_Decode_(getAmrnbWrapper(), s->decState, amrData, data, 0);
+    *data_size=160*2;
+
+    return packet_size;
+}
+
+static int amr_nb_encode_frame(AVCodecContext *avctx,
+                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
+{
+    AMRContext *s = avctx->priv_data;
+    int written;
+
+    if((s->enc_bitrate=getBitrateMode(avctx->bit_rate))<0)
+    {
+        av_log(avctx, AV_LOG_ERROR, nb_bitrate_unsupported);
+        return -1;
+    }
+
+    written = Encoder_Interface_Encode_(getAmrnbWrapper(), s->enstate,
+        s->enc_bitrate,
+        data,
+        frame,
+        0);
+    /* av_log(NULL,AV_LOG_DEBUG,"amr_nb_encode_frame encoded %u bytes, bitrate %u, first byte was %#02x\n",written, s->enc_bitrate, frame[0] ); */
+
+    return written;
+}
+
+#endif
+
+#if defined(CONFIG_LIBAMR_NB) || defined(CONFIG_LIBAMR_NB_FIXED)
+
+AVCodec libamr_nb_decoder =
+{
+    "libamr_nb",
+    CODEC_TYPE_AUDIO,
+    CODEC_ID_AMR_NB,
+    sizeof(AMRContext),
+    amr_nb_decode_init,
+    NULL,
+    amr_nb_decode_close,
+    amr_nb_decode_frame,
+};
+
+AVCodec libamr_nb_encoder =
+{
+    "libamr_nb",
+    CODEC_TYPE_AUDIO,
+    CODEC_ID_AMR_NB,
+    sizeof(AMRContext),
+    amr_nb_encode_init,
+    amr_nb_encode_frame,
+    amr_nb_encode_close,
+    NULL,
+};
+
+#endif
+
+/* -----------AMR wideband ------------*/
+#ifdef CONFIG_LIBAMR_WB
+
+#ifdef _TYPEDEF_H
+//To avoid duplicate typedefs from typdef in amr-nb
+#define typedef_h
+#endif
+
+#include <amrwb/enc_if.h>
+#include <amrwb/dec_if.h>
+#include <amrwb/if_rom.h>
+
+/* Common code for fixed and float version*/
+typedef struct AMRWB_bitrates
+{
+    int rate;
+    int mode;
+} AMRWB_bitrates;
+
+static int getWBBitrateMode(int bitrate)
+{
+    /* make the correspondance between bitrate and mode */
+    AMRWB_bitrates rates[]={ {6600,0},
+                           {8850,1},
+                           {12650,2},
+                           {14250,3},
+                           {15850,4},
+                           {18250,5},
+                           {19850,6},
+                           {23050,7},
+                           {23850,8},
+                         };
+    int i;
+
+    for(i=0;i<9;i++)
+    {
+        if(rates[i].rate==bitrate)
+        {
+            return(rates[i].mode);
+        }
+    }
+    /* no bitrate matching, return an error */
+    return -1;
+}
+
+
+typedef struct AMRWBContext {
+    int frameCount;
+    void *state;
+    int mode;
+    Word16 allow_dtx;
+} AMRWBContext;
+
+static int amr_wb_encode_init(AVCodecContext * avctx)
+{
+    AMRWBContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+
+    if(avctx->sample_rate!=16000)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only 16000Hz sample rate supported\n");
+        return -1;
+    }
+
+    if(avctx->channels!=1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "Only mono supported\n");
+        return -1;
+    }
+
+    if((s->mode=getWBBitrateMode(avctx->bit_rate))<0)
+    {
+        av_log(avctx, AV_LOG_ERROR, wb_bitrate_unsupported);
+        return -1;
+    }
+
+    avctx->frame_size=320;
+    avctx->coded_frame= avcodec_alloc_frame();
+
+    s->state = E_IF_init();
+    s->allow_dtx=0;
+
+    return 0;
+}
+
+static int amr_wb_encode_close(AVCodecContext * avctx)
+{
+    AMRWBContext *s = avctx->priv_data;
+
+    E_IF_exit(s->state);
+    av_freep(&avctx->coded_frame);
+    s->frameCount++;
+    return 0;
+}
+
+static int amr_wb_encode_frame(AVCodecContext *avctx,
+                            unsigned char *frame/*out*/, int buf_size, void *data/*in*/)
+{
+    AMRWBContext *s = avctx->priv_data;
+    int size;
+
+    if((s->mode=getWBBitrateMode(avctx->bit_rate))<0)
+    {
+        av_log(avctx, AV_LOG_ERROR, wb_bitrate_unsupported);
+        return -1;
+    }
+    size = E_IF_encode(s->state, s->mode, data, frame, s->allow_dtx);
+    return size;
+}
+
+static int amr_wb_decode_init(AVCodecContext * avctx)
+{
+    AMRWBContext *s = avctx->priv_data;
+
+    s->frameCount=0;
+    s->state = D_IF_init();
+
+    amr_decode_fix_avctx(avctx);
+
+    if(avctx->channels > 1)
+    {
+        av_log(avctx, AV_LOG_ERROR, "amr_wb: multichannel decoding not supported\n");
+        return -1;
+    }
+
+    return 0;
+}
+
+static int amr_wb_decode_frame(AVCodecContext * avctx,
+            void *data, int *data_size,
+            uint8_t * buf, int buf_size)
+{
+    AMRWBContext *s = avctx->priv_data;
+    uint8_t*amrData=buf;
+    int mode;
+    int packet_size;
+
+    if(buf_size==0) {
+        /* nothing to do */
+        return 0;
+    }
+
+    mode = (amrData[0] >> 3) & 0x000F;
+    packet_size = block_size[mode];
+
+    if(packet_size > buf_size) {
+        av_log(avctx, AV_LOG_ERROR, "amr frame too short (%u, should be %u)\n", buf_size, packet_size+1);
+        return -1;
+    }
+
+    s->frameCount++;
+    D_IF_decode( s->state, amrData, data, _good_frame);
+    *data_size=320*2;
+    return packet_size;
+}
+
+static int amr_wb_decode_close(AVCodecContext * avctx)
+{
+    AMRWBContext *s = avctx->priv_data;
+
+    D_IF_exit(s->state);
+    return 0;
+}
+
+AVCodec libamr_wb_decoder =
+{
+    "libamr_wb",
+    CODEC_TYPE_AUDIO,
+    CODEC_ID_AMR_WB,
+    sizeof(AMRWBContext),
+    amr_wb_decode_init,
+    NULL,
+    amr_wb_decode_close,
+    amr_wb_decode_frame,
+};
+
+AVCodec libamr_wb_encoder =
+{
+    "libamr_wb",
+    CODEC_TYPE_AUDIO,
+    CODEC_ID_AMR_WB,
+    sizeof(AMRWBContext),
+    amr_wb_encode_init,
+    amr_wb_encode_frame,
+    amr_wb_encode_close,
+    NULL,
+};
+
+#endif //CONFIG_LIBAMR_WB
+ /* MEANX */
+ #endif
+ /* MEANX */

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2008-06-16 12:13:43 UTC (rev 4105)
+++ branches/avidemux_2.4_branch/config.h.cmake	2008-06-16 15:43:11 UTC (rev 4106)
@@ -29,9 +29,6 @@
 /* use ALSA as possible audio device */
 #cmakedefine ALSA_SUPPORT
 
-/* AMR_NB */
-#cmakedefine AMR_NB
-
 /* X86_64 AMD64 assembly */
 #cmakedefine ARCH_64_BITS
 
@@ -54,6 +51,7 @@
 #cmakedefine CONFIG_ENCODERS
 #cmakedefine CONFIG_DVVIDEO_ENCODER
 
+#cmakedefine CONFIG_LIBAMR_NB
 #cmakedefine CONFIG_DECODERS
 #cmakedefine CONFIG_DVVIDEO_DECODER
 #cmakedefine CONFIG_H263_DECODER



From gruntster at mail.berlios.de  Mon Jun 16 19:04:25 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jun 2008 19:04:25 +0200
Subject: [Avidemux-svn-commit] r4107 - in branches/avidemux_2.4_branch: .
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200806161704.m5GH4Pq0016213@sheep.berlios.de>

Author: gruntster
Date: 2008-06-16 19:04:13 +0200 (Mon, 16 Jun 2008)
New Revision: 4107

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp
   branches/avidemux_2.4_branch/configure.in.in
Log:
[Automake] sync with CMake

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am	2008-06-16 15:43:11 UTC (rev 4106)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am	2008-06-16 17:04:13 UTC (rev 4107)
@@ -9,7 +9,7 @@
 libADM_toolkit_gtk_a_METASOURCES = AUTO
 
 libADM_toolkit_gtk_a_SOURCES = ADM_gladeSupport.cpp  ADM_tray_gtk.cpp  choice.cpp  TLK_filesel.cpp  toolkit.cpp  toolkit_dialog.cpp \
-		eggtrayicon.c eggtray_win32.c gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp mediactrl.c
+		gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp mediactrl.c
 
 
 EXTRA_DIST = 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2008-06-16 15:43:11 UTC (rev 4106)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2008-06-16 17:04:13 UTC (rev 4107)
@@ -13,7 +13,8 @@
 about_rsc.cpp \
 AQ_about.cpp \
 AQ_license.cpp \
-DIA_srt.cpp
+DIA_srt.cpp \
+AQ_calculator.cpp
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I../../../ADM_libraries/ADM_utilities \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-16 15:43:11 UTC (rev 4106)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_calculator.cpp	2008-06-16 17:04:13 UTC (rev 4107)
@@ -18,7 +18,7 @@
 
 #include "ui_calculator.h"
 #include "default.h"
-#include "ADM_misc.h"
+#include "ADM_toolkit/toolkit.hxx"
 
 #include "avi_vars.h"
 #include "ADM_editor/ADM_edit.hxx"

Modified: branches/avidemux_2.4_branch/configure.in.in
===================================================================
--- branches/avidemux_2.4_branch/configure.in.in	2008-06-16 15:43:11 UTC (rev 4106)
+++ branches/avidemux_2.4_branch/configure.in.in	2008-06-16 17:04:13 UTC (rev 4107)
@@ -583,7 +583,7 @@
 
 if test "x$have_libamrnb" = "xyes"; then
 	AC_DEFINE(AMR_NB,1,[AMR_NB])
-	AC_DEFINE(CONFIG_AMR_NB,1,[AMR_NB])
+	AC_DEFINE(CONFIG_LIBAMR_NB,1,[AMR_NB])
 	AC_DEFINE(USE_AMR_NB,1,[Tell avidemux to use libamrnb])
 else
 	AC_MSG_WARN(libamr not found, you can download it there : ftp://ftp.penguin.cz/pub/users/utx/amr/)



From mean at mail.berlios.de  Mon Jun 16 19:26:37 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jun 2008 19:26:37 +0200
Subject: [Avidemux-svn-commit] r4108 -
	branches/avidemux_2.4_branch/avidemux/ADM_encoder
Message-ID: <200806161726.m5GHQbWX016822@sheep.berlios.de>

Author: mean
Date: 2008-06-16 19:26:36 +0200 (Mon, 16 Jun 2008)
New Revision: 4108

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp
Log:
[Lavc] Add/fix 2 pass average bitrate

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp	2008-06-16 17:04:13 UTC (rev 4107)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp	2008-06-16 17:26:36 UTC (rev 4108)
@@ -403,9 +403,13 @@
       _codec->init (_param.bitrate, _fps, flag1);
       break;
     case COMPRESS_2PASS:
+    case COMPRESS_2PASS_BITRATE:
+
       ffmpegEncoderCQ * cdec;
-
-      printf ("\n ffmpeg dual size: %lu", _param.finalsize);
+      if(_param.mode==COMPRESS_2PASS)
+        printf ("\n ffmpeg dual size: %lu", _param.finalsize);
+      else
+        printf ("\n ffmpeg dual bitrate: %lu", _param.avg_bitrate);
       _state = enc_Pass1;
       cdec = new ffmpegEncoderCQ (_w, _h, _id);	// Pass1
       cdec->setConfig (&_settings);
@@ -562,8 +566,19 @@
 
   // compute average bitrate
   uint32_t    vbr = 0;
+ switch(_param.mode)
+  {
+    case COMPRESS_2PASS:          
+          // compute average bitrate
+            vbr= ADM_computeBitrate(_fps, _frametogo,_param.finalsize);
+            break;
+    case COMPRESS_2PASS_BITRATE:
+            vbr=_param.avg_bitrate*1000; // in b/s
+            break;
+    default:
+          ADM_assert(0);
+  }
 
-    vbr= ADM_computeBitrate(_fps, _frametogo,_param.finalsize);
 
   _codec->setLogFile (_logname);
   if(!_codec->init (vbr, _fps))



From mean at mail.berlios.de  Mon Jun 16 19:27:13 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jun 2008 19:27:13 +0200
Subject: [Avidemux-svn-commit] r4109 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4
Message-ID: <200806161727.m5GHRDr8019932@sheep.berlios.de>

Author: mean
Date: 2008-06-16 19:27:02 +0200 (Mon, 16 Jun 2008)
New Revision: 4109

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
Log:
[Mov/mp4] Ignores all atom when waiting for avcC

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-06-16 17:26:36 UTC (rev 4108)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-06-16 17:27:02 UTC (rev 4109)
@@ -1,6 +1,6 @@
 /***************************************************************************
 /*
-    
+
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr
  ***************************************************************************/
@@ -45,7 +45,7 @@
 
 uint32_t ADM_UsecFromFps1000(uint32_t fps1000);
 // 14496-1 / 8.2.1
-typedef enum 
+typedef enum
 {
 	Tag_InitialObjDesc	=0x02,
 	Tag_ES_Desc		=0x03,
@@ -61,7 +61,7 @@
 */
 uint8_t     MP4Header::lookupMainAtoms(void *ztom)
 {
-  
+
   adm_atom *tom=(adm_atom *)ztom;
   adm_atom *moov;
   ADMAtoms id;
@@ -84,19 +84,19 @@
     {
       switch( id)
       {
-        case ADM_MP4_MVHD: parseMvhd(&son);break; 
-        case ADM_MP4_TRACK: 
+        case ADM_MP4_MVHD: parseMvhd(&son);break;
+        case ADM_MP4_TRACK:
             if(!parseTrack(&son))
             {
                 printf("Parse Track failed\n");
             } ;
             break;
-        default : 
+        default :
                 adm_printf(ADM_PRINT_DEBUG,"atom %s not handled\n",fourCC::tostringBE(son.getFCC()));
                 break;
       }
-      
-      
+
+
     }
     son.skipAtom();
   }
@@ -113,7 +113,7 @@
   adm_atom *tom=(adm_atom *)ztom;
   tom->skipBytes(12);
   uint32_t scale,duration=1000;
-  
+
         scale=tom->read32();
         duration=tom->read32();
         _videoScale=scale;
@@ -138,7 +138,7 @@
   uint32_t container;
   uint32_t w,h;
   uint32_t trackType=TRACK_OTHER;
-  
+
   printf("Parsing Track\n");
    while(!tom->isDone())
   {
@@ -161,7 +161,7 @@
                       son.skipBytes(8);
                       son.skipBytes(4); // layers
                       son.skipBytes(40); // layers
-  
+
                       w=son.read32()>>16;
                       h=son.read32()>>16;
                       adm_printf(ADM_PRINT_DEBUG,"tkhd : %ld %ld\n",w,h);
@@ -205,7 +205,7 @@
      }
      switch(id)
      {
-       case ADM_MP4_MDHD:  
+       case ADM_MP4_MDHD:
        {
                 uint32_t version=son.read(),duration;
                 son.skipBytes(3); // flags + version
@@ -223,16 +223,16 @@
                 printf("MDHD,Track duration :%s, trackScale :%u\n",ms2timedisplay((1000*duration)/trackScale),trackScale);
                 break;
        }
-       case ADM_MP4_HDLR:  
+       case ADM_MP4_HDLR:
        {
             uint32_t type;
-            
+
                 son.read32();
                 son.read32();
                 type=son.read32();
                 printf("[HDLR]\n");
                 switch(type)
-                {	
+                {
                 case MKFCCR('v','i','d','e')://'vide':
                         *trackType=TRACK_VIDEO;
                         printf("hdlr video found \n ");
@@ -256,14 +256,14 @@
                         printf("Url : <%s>\n",str);
                       }
                       break;
-                 
+
                 }
                 break;
-       } 
-       case ADM_MP4_MINF:  
+       }
+       case ADM_MP4_MINF:
        {
             // We are only interested in stbl
-            
+
             while(!son.isDone())
             {
               adm_atom grandson(&son);
@@ -278,7 +278,7 @@
                    if(! parseStbl(&grandson,*trackType, w, h,trackScale))
                    {
                       printf("STBL failed\n");
-                      return 0; 
+                      return 0;
                    }
                    r=1;
               }
@@ -289,7 +289,7 @@
         default:
             adm_printf(ADM_PRINT_DEBUG,"** atom  NOT HANDLED [%s] \n",fourCC::tostringBE(son.getFCC()));
      }
-     
+
      son.skipAtom();
   }
   return r;
@@ -305,11 +305,11 @@
   ADMAtoms id;
   uint32_t container;
   MPsampleinfo  info;
-  
-  
+
+
   memset(&info,0,sizeof(info));
 
-  
+
   printf("<<Parsing Stbl>>\n");
   while(!tom->isDone())
   {
@@ -336,9 +336,9 @@
                   }
           }
           break;
-         
+
        }
-       case ADM_MP4_STTS: 
+       case ADM_MP4_STTS:
             {
                 printf("stts:%lu\n",son.read32()); // version & flags
                 info.nbStts=son.read32();
@@ -349,13 +349,13 @@
                 double dur;
                 for(int i=0;i<info.nbStts;i++)
                 {
-                        
+
                         info.SttsN[i]=son.read32();
                         info.SttsC[i]=son.read32();
-                        adm_printf(ADM_PRINT_VERY_VERBOSE,"stts: count:%u size:%u (unscaled)\n",info.SttsN[i],info.SttsC[i]);	
+                        adm_printf(ADM_PRINT_VERY_VERBOSE,"stts: count:%u size:%u (unscaled)\n",info.SttsN[i],info.SttsC[i]);
                         //dur*=1000.*1000.;; // us
                         //dur/=myScale;
-                }                
+                }
             }
             break;
        case ADM_MP4_STSC:
@@ -400,10 +400,10 @@
               }
           }
           break;
-           case ADM_MP4_CTTS: // Composition time to sample             
+           case ADM_MP4_CTTS: // Composition time to sample
             {
                 uint32_t n,i,j,k,v;
-                
+
                   printf("ctts:%lu\n",son.read32()); // version & flags
                   n=son.read32();
                   if(n==1) // all the same , ignore
@@ -423,12 +423,12 @@
                     sum+=count[i];
                 }
                 info.Ctts=new uint32_t[sum+1]; // keep a safe margin
-                
+
                 for(i=0;i<n;i++)
                 {
                     if(i<20)
                     {
-                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",count[i],count[i],values[i],values[i]);   
+                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",count[i],count[i],values[i],values[i]);
                     }
                     for(k=0;k<count[i];k++)
                     {
@@ -446,7 +446,7 @@
                 ADM_assert(info.nbCtts<sum+1);
                 printf("Found %u elements\n",info.nbCtts);
             }
-            break;  
+            break;
        case ADM_MP4_STCO:
        {
           son.read32();
@@ -490,7 +490,7 @@
                    left=entrySize-8;
                    if(i || (trackType==TRACK_VIDEO && _videoFound) || (trackType==TRACK_OTHER))
                    {
-                    son.skipBytes(left); 
+                    son.skipBytes(left);
                     printf("[STSD] ignoring %s, size %u\n",fourCC::tostringBE(entryName),entrySize);
                     if(trackType==TRACK_OTHER) printf("[STSD] because track=other\n");
                     continue;
@@ -507,23 +507,23 @@
                                 left-=4;
                                 printf("[STSD] vendor %s\n",fourCC::tostringBE(son.read32()));
                                 left-=4;
-                                
+
                                 son.skipBytes(8); // spatial qual etc..
                                 left-=8;
-                                
+
                                 printf("[STSD] width :%u\n",lw=son.read16());
                                 printf("[STSD] height :%u\n",lh=son.read16());
                                 left-=4;
-                                
+
                                 son.skipBytes(8); // Resolution
                                 left-=8;
-                                
+
                                 printf("[STSD] datasize :%u\n",son.read32());
                                 left-=4;
-                     
+
                                 printf("[STSD] FrameCount :%u\n",son.read16());
                                 left-=4;
-                                
+
                                 // Codec name
                                 uint32_t u32=son.read();
                                 if(u32>31) u32=31;
@@ -532,22 +532,22 @@
                                 printf(">\n");
                                 son.skipBytes(32-1-u32);
                                 left-=32;
-                                // 
+                                //
                                 son.read32();
                                 left-=4; //Depth & color Id
                                 //
                                 printf("LEFT:%d\n",left);
-                                
+
                                 if(left>8)
                                 {
-//                                  decodeVideoAtom(&son); 
+//                                  decodeVideoAtom(&son);
                                 }
                                 //
 #define commonPart(x)             _videostream.fccHandler=_video_bih.biCompression=fourCC::get((uint8_t *)#x);
-                      
 
-                                 _video_bih.biWidth=_mainaviheader.dwWidth=lw ; 
-                                  _video_bih.biHeight=_mainaviheader.dwHeight=lh; 
+
+                                 _video_bih.biWidth=_mainaviheader.dwWidth=lw ;
+                                  _video_bih.biHeight=_mainaviheader.dwHeight=lh;
                                   _video_bih.biCompression=_videostream.fccHandler;
 
                                 //
@@ -622,13 +622,19 @@
                                           commonPart(H264);
                                           // There is a avcC atom just after
                                           // configuration data for h264
-nextAtom:                                          
+nextAtom:
                                           adm_atom avcc(&son);
                                           printf("Reading avcC, got %s\n",fourCC::tostringBE(avcc.getFCC()));
-                                          if(avcc.getFCC()==MKFCCR('c','o','l','r')) // Color atom
+                                          switch(avcc.getFCC())
                                           {
-                                        	  avcc.skipAtom();
-                                        	  goto nextAtom;
+                                              case MKFCCR('a','v','c','C'): break;
+                                              default:
+                                              case MKFCCR('c','o','l','r'):  // Color atom
+                                              case MKFCCR('p','a','s','p'):
+                                              case MKFCCR('c','l','a','p'):
+                                                  avcc.skipAtom();
+                                                  goto nextAtom;
+                                                  break;
                                           }
                                           int len,offset;
                                           VDEO.extraDataSize=avcc.getRemainingSize();
@@ -644,14 +650,14 @@
                                             printf("avcC AVCProfileIndication :%x\n", MKD8(1));
                                             printf("avcC profile_compatibility:%x\n", MKD8(2));
                                             printf("avcC AVCLevelIndication   :%x\n", MKD8(3));
-        
+
                                             printf("avcC lengthSizeMinusOne   :%x\n", MKD8(4));
                                             printf("avcC NumSeq               :%x\n", MKD8(5));
                                             len=MKD16(6);
                                             printf("avcC sequenceParSetLen    :%x ",len );
                                             offset=8;
                                             mixDump(VDEO.extraData+offset,len);
-        
+
                                             offset=8+len;
                                             printf("\navcC numOfPictureParSets  :%x\n", MKD8(offset++));
                                             len=MKD16(offset);
@@ -667,7 +673,7 @@
                                                 adm_atom avcc(&son);
                                                 printf("Reading , got %s\n",fourCC::tostringBE(avcc.getFCC()));
                                                 left=0;
-                                                
+
                                             }
                                             break;
                                 } // Entry name
@@ -676,34 +682,34 @@
                      case TRACK_AUDIO:
                      {
                         uint32_t channels,bpp,encoding,fq,packSize;
-                        
+
                                 // Put some defaults
                                 ADIO.encoding=1234;
                                 ADIO.frequency=44100;
                                 ADIO.byterate=128000>>3;
                                 ADIO.channels=2;
                                 ADIO.bitspersample=16;
-                        
+
                                 printf("[STSD] AUDIO <%s>, 0x%08x, size %u\n",fourCC::tostringBE(entryName),entryName,entrySize);
                                 son.skipBytes(8);  // reserved etc..
                                 left-=8;
-                                
+
                                 int atomVersion=son.read16();  // version
                                 left-=2;
                                 printf("[STSD]Revision       :%d\n",atomVersion);
                                 son.skipBytes(2);  // revision
                                 left-=2;
-                                
+
                                 printf("[STSD]Vendor         : %s\n",fourCC::tostringBE(son.read32()));
                                 left-=4;
-                                
+
                                 ADIO.channels=channels=son.read16(); // Channel
                                 left-=2;
                                 printf("[STSD]Channels       :%d\n",ADIO.channels);
                                 ADIO.bitspersample=bpp=son.read16(); // version/revision
                                 left-=2;
                                 printf("[STSD]Bit per sample :%d\n",bpp);
-                                
+
                                 encoding=son.read16(); // version/revision
                                 left-=2;
                                 printf("[STSD]Encoding       :%d\n",encoding);
@@ -711,8 +717,8 @@
                                 packSize=son.read16(); // Packet Size
                                 left-=2;
                                 printf("[STSD]Packet size    :%d\n",encoding);
-                                
-                              
+
+
                                 fq=ADIO.frequency=son.read16();
                                 printf("[STSD]Fq:%u\n",fq);
                                 if(ADIO.frequency<6000) ADIO.frequency=48000;
@@ -755,12 +761,12 @@
 #define audioCodec(x) ADIO.encoding=WAV_##x;
                                 switch(entryName)
                                 {
-                                    
+
                                     case MKFCCR('t','w','o','s'):
                                             audioCodec(LPCM);
                                             ADIO.byterate=ADIO.frequency*ADIO.bitspersample*ADIO.channels/8;
                                             break;
-                                                
+
                                     case MKFCCR('u','l','a','w'):
                                             audioCodec(ULAW);
                                             ADIO.byterate=ADIO.frequency;
@@ -842,11 +848,11 @@
                                                           ADIO.blockalign=ADM_swap16(item.read16());
                                                           ADIO.bitspersample=ADM_swap16(item.read16());
                                                           printWavHeader(&(ADIO));
-                                                          
+
                                                         }
                                                        break;
                                                         case MKFCCR('m','p','4','a'):
-                                                          break; 
+                                                          break;
                                                         case MKFCCR('e','s','d','s'):
                                                           {
                                                                decodeEsds(&item,TRACK_AUDIO);
@@ -858,7 +864,7 @@
                                                      }
 
                                                      item.skipAtom();
-                                                   
+
                                                  }  // Wave iddone
                                                  left=0;
                                               }  // if ==wave
@@ -868,25 +874,25 @@
                                                           {
                                                                decodeEsds(&wave,TRACK_AUDIO);
                                                                goto foundit; // FIXME!!!
-                                                          } 
+                                                          }
                                                 else
                                                 {
-                                                  printf("UNHANDLED ATOM : %s\n",fourCC::tostringBE(wave.getFCC())); 
+                                                  printf("UNHANDLED ATOM : %s\n",fourCC::tostringBE(wave.getFCC()));
                                                 }
                                               }
                                             } // if left > 10
-foundit: // HACK FIXME     
+foundit: // HACK FIXME
                                             left=0;
-                                    }       
+                                    }
                                             break; // mp4a
-                                  
+
                                 }
                      }
                           break;
                      default:
                           ADM_assert(0);
                    }
-                   son.skipBytes(left); 
+                   son.skipBytes(left);
                 }
        }
               break;
@@ -907,7 +913,7 @@
               return 1;
           }
           r=indexify(&(_tracks[0]),trackScale,&info,0,&nbo);
-          
+
           _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0].nbIndex;
           // update fps
           float f=_videostream.dwLength;
@@ -939,7 +945,7 @@
             updateCtts(&info);
           }
 
-          
+
            VDEO.index[0].intra=AVI_KEY_FRAME;
         }
           break;
@@ -963,7 +969,7 @@
                 _tracks[1+nbAudioTrack].scale=trackScale;
                 nbAudioTrack++;
             }
-            
+
             break;
     case TRACK_OTHER:
         r=1;
@@ -977,7 +983,7 @@
 */
 uint8_t MP4Header::decodeEsds(void *ztom,uint32_t trackType)
 {
-adm_atom *tom=(adm_atom *)ztom; 
+adm_atom *tom=(adm_atom *)ztom;
 int tag,l;
             // in case of mpeg4 we only take
             // the mpeg4 vol header
@@ -1009,10 +1015,10 @@
                                           case 0x6d:ADIO.encoding=WAV_MP3;break;
                                           case 226:ADIO.encoding=WAV_AC3;break;
                                           break;
-                                  
+
                                       }
                                     }
-                                    tom->skipBytes(1+3+4+4);	
+                                    tom->skipBytes(1+3+4+4);
                                     break;
                             }
                             case Tag_DecSpecificInfo:
@@ -1038,7 +1044,7 @@
                                     }
                             }
             }
-            
+
     tom->skipAtom();
     return 1;
 }
@@ -1049,15 +1055,15 @@
 uint8_t MP4Header::updateCtts(MPsampleinfo *info )
 {
     uint32_t scope=info->nbCtts;
-            
+
             if(scope>_videostream.dwLength) scope=_videostream.dwLength;
-            
+
             // Search floor value
             uint32_t  flor=0xFFFFFFFF;
             uint32_t  cel=0;
             for(uint32_t i=0;i<scope;i++)
             {
-              if(info->Ctts[i]>4294967290) 
+              if(info->Ctts[i]>4294967290)
               {
                 if(i)
                   info->Ctts[i]=info->Ctts[0];
@@ -1081,7 +1087,7 @@
                 aprintf(">Frame :%u delta=%d\n",i,floops);
               if(floops<0)
               {
-                printf("[3GPP] CTTS negative for frame %u : %d\n",i,floops); 
+                printf("[3GPP] CTTS negative for frame %u : %d\n",i,floops);
                 floops=0;
               }
               _tracks[0].index[i].deltaPtsDts=floops;



From mean at mail.berlios.de  Mon Jun 16 19:35:03 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jun 2008 19:35:03 +0200
Subject: [Avidemux-svn-commit] r4110 -
	branches/avidemux_2.4_branch/avidemux/ADM_videoFilter
Message-ID: <200806161735.m5GHZ3PG031476@sheep.berlios.de>

Author: mean
Date: 2008-06-16 19:35:02 +0200 (Mon, 16 Jun 2008)
New Revision: 4110

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp
Log:
[Overrun] Fix overflow (FS#343)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp	2008-06-16 17:27:02 UTC (rev 4109)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp	2008-06-16 17:35:02 UTC (rev 4110)
@@ -129,8 +129,8 @@
 }
 
 //
-//  
 //
+//
 
 int getResizeParams(uint32_t * w, uint32_t * h, uint32_t * algo,uint32_t ow,uint32_t oh,uint32_t fps)
 {
@@ -187,12 +187,12 @@
 
 					}
 #if (defined( ARCH_X86)  || defined(ARCH_X86_64))
-		
+
 		#define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
-		ADD(MMX,MMX);		
+		ADD(MMX,MMX);
 		ADD(3DNOW,3DNOW);
 		ADD(MMXEXT,MMX2);
-#endif	
+#endif
 #ifdef USE_ALTIVEC
 		flags|=SWS_CPU_CAPS_ALTIVEC;
 #endif
@@ -210,9 +210,11 @@
 }
 char *AVDMVideoStreamMPResize::printConf( void )
 {
- 	static char buf[50];
+ 	 #define STRING_BUF 100
+ 	static char buf[STRING_BUF+1];
 
- 	sprintf((char *)buf," MPL Resize %lu x %lu --> %lu x %lu (%s)",
+
+ 	snprintf((char *)buf,STRING_BUF," MPL Resize %u x %u --> %u x %u (%s)",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
@@ -314,12 +316,12 @@
    				ADMImage *data,
 				uint32_t *flags)
 {
-			if(frame>=_info.nb_frames) 
+			if(frame>=_info.nb_frames)
 			{
 				printf("Filter : out of bound!\n");
 				return 0;
 			}
-	
+
 			ADM_assert(_param);
 
        			if(!_in->getFrameNumberNoAlloc(frame, len,_uncompressed,flags)) return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp	2008-06-16 17:27:02 UTC (rev 4109)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp	2008-06-16 17:35:02 UTC (rev 4110)
@@ -48,9 +48,10 @@
 
 char *AVDMVideoStreamResize::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Resize %lu x %lu --> %lu x %lu",
+    #define STRING_BUF 100
+ 	static char buf[STRING_BUF+1];
+
+ 	snprintf((char *)buf,STRING_BUF," Resize %u x %u --> %u x %u ",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
@@ -82,8 +83,8 @@
 				_param->w=_info.width;
 				_param->h = _info.height;
 				_param->algo = 0;
-			}			
-			_intermediate_buffer=new uint8_t [3*_info.width*_in->getInfo()->height];	
+			}
+			_intermediate_buffer=new uint8_t [3*_info.width*_in->getInfo()->height];
 
   _info.encoding=1;
   _init=0;
@@ -92,7 +93,7 @@
 	Hpattern_luma=NULL;
     Hpattern_chroma=NULL;
 }
-#if !defined(MPLAYER_RESIZE_PREFFERED) 
+#if !defined(MPLAYER_RESIZE_PREFFERED)
 AVDMGenericVideoStream *createResizeFromParam(AVDMGenericVideoStream *in,uint32_t x,uint32_t y)
 {
 
@@ -157,15 +158,15 @@
 				uint32_t *flags)
 {
 static Image in,out;
-	if(frame>=_info.nb_frames) 
+	if(frame>=_info.nb_frames)
 	{
 		printf("Filter : out of bound!\n");
 		return 0;
 	}
-	
-	ADM_assert(_param);	
+
+	ADM_assert(_param);
 	if(!_in->getFrameNumberNoAlloc(frame, len,_uncompressed,flags)) return 0;
-       		
+
 	// do the resize in 3 passes, Y, U then V
 	in.width=_in->getInfo()->width;
 	in.height=_in->getInfo()->height;
@@ -173,7 +174,7 @@
 
 	out.width=_info.width;
 	out.height=_info.height;
-	out.data=data->data;	
+	out.data=data->data;
 	if(!_init)
 	{
 		_init=1;
@@ -185,11 +186,11 @@
 		}
 		precompute(&out,&in, _param->algo );
 	}
-       	zoom(&out,&in)         ;       
+       	zoom(&out,&in)         ;
        data->flags=*flags=_uncompressed->flags;
 
        *len= _info.width*_info.height+(_info.width*_info.height>>1);
-       data->copyInfo(_uncompressed);	
+       data->copyInfo(_uncompressed);
       return 1;
 }
 



From mean at mail.berlios.de  Mon Jun 16 19:49:33 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jun 2008 19:49:33 +0200
Subject: [Avidemux-svn-commit] r4111 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806161749.m5GHnXIj000301@sheep.berlios.de>

Author: mean
Date: 2008-06-16 19:49:32 +0200 (Mon, 16 Jun 2008)
New Revision: 4111

Modified:
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[UI] Update time when changing fps (FS#362)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-16 17:35:02 UTC (rev 4110)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-16 17:49:32 UTC (rev 4111)
@@ -25,7 +25,7 @@
 #include <fcntl.h>	/* O_RDONLY */
 #include <errno.h>
 #include <glib.h>
-    
+
 #include "ADM_lavcodec.h"
 
 #include "fourcc.h"
@@ -193,7 +193,7 @@
   }
   switch (action)
     {
-        case ACT_GLYPHEDIT: 
+        case ACT_GLYPHEDIT:
                                 DIA_glyphEdit();
                                 return;
         case ACT_AVS_PROXY:
@@ -209,7 +209,7 @@
                                 GUI_jobs();
                                 return;
         case ACT_RECENT0:
-        case ACT_RECENT1:        
+        case ACT_RECENT1:
         case ACT_RECENT2:
         case ACT_RECENT3:
                         const char **name;
@@ -242,15 +242,15 @@
    case ACT_AudioCodecChanged:
                 nw=UI_getCurrentACodec();
    		audioCodecChanged(nw);
-    		
+
 		return;
-    
+
     case ACT_RunScript:
                 GUI_FileSelRead (QT_TR_NOOP("Select ECMAScript to Run"),(SELFILE_CB *) A_parseECMAScript);
-                        
+
                         //
     		return;
-		
+
     case ACT_RecentFiles:
     	char *file;
 		if(		DIA_RecentFiles(&file))
@@ -278,17 +278,17 @@
     	if(DIA_Preferences())
 	{
 	saveEncoderConfig ();
- 	#ifdef HAVE_AUDIO     
+ 	#ifdef HAVE_AUDIO
       		AVDM_audioSave();
- 	#endif     
-      	prefs->save ();	
-	}      
+ 	#endif
+      	prefs->save ();
+	}
 	return;
     case ACT_SavePref:
       saveEncoderConfig ();
- #ifdef HAVE_AUDIO     
+ #ifdef HAVE_AUDIO
       AVDM_audioSave();
- #endif     
+ #endif
       prefs->save ();
       return;
     case ACT_SetLogFile:
@@ -300,7 +300,7 @@
       ADM_aviUISetMuxer();
       return;
       break;
-#ifdef HAVE_AUDIO      
+#ifdef HAVE_AUDIO
     	case ACT_SelectDevOSS:
 				   AVDM_switch (DEVICE_OSS);
 				   return;break;
@@ -313,7 +313,7 @@
 	case ACT_SelectDevALSA:
 				   AVDM_switch (DEVICE_ALSA);
 				   return;break;
-#endif                                  
+#endif
     case ACT_Fast:
       ADM_assert(0);
       break;
@@ -323,11 +323,11 @@
          if( saveprefsonexit )
             prefs->save ();
       }
-      cleanUp (); 
+      cleanUp ();
       exit (0);
       break;
 /*			case ACT_SelectEncoder:
-				
+
 						A_selectEncoder();
   	  			return;
 						break;*/
@@ -339,7 +339,7 @@
       break;
 
     }
-//------------------------------------------------                                      
+//------------------------------------------------
 
   if (playing)			// only allow some action
     {
@@ -390,7 +390,7 @@
       return;
     }
 
-//#define TEST_UNPACK    
+//#define TEST_UNPACK
   // we have an AVI loaded
   switch (action)
     {
@@ -438,16 +438,16 @@
     			break;
     case ACT_SaveUnpackedMpeg4:
       if(GUI_Question(QT_TR_NOOP("This is to be used to undo packed VOP on MPEG-4.\nContinue ?")))
-			{ 
+			{
                           GUI_FileSelWrite (QT_TR_NOOP("Select AVI File to Write"), (SELFILE_CB *)A_SaveUnpackedVop);
-				
+
 			}
     			break;
-			
+
     case ACT_SaveOGM:
                         GUI_FileSelWrite (QT_TR_NOOP("Select OGM File to Write"), (SELFILE_CB *)ogmSave);
     			break;
-				
+
     case ACT_SaveWork:
       GUI_FileSelWrite (QT_TR_NOOP("Select Workbench to Save"), A_saveWorkbench);
 	  UI_refreshCustomMenu();
@@ -465,8 +465,8 @@
 		UI_refreshCustomMenu();
       }
       break;
-        case ACT_JumpToFrame: 
-                // read value	
+        case ACT_JumpToFrame:
+                // read value
                 nf=UI_readCurFrame();
                 if(nf>0 && nf< avifileinfo->nb_frames)
                 {
@@ -514,7 +514,7 @@
     case ACT_SaveWave:
       	{
           GUI_FileSelWrite (QT_TR_NOOP("Select File to Save Audio"),(SELFILE_CB *)A_audioSave);
-	
+
 	}
       break;
 
@@ -547,7 +547,7 @@
       break;
 
     case ACT_SaveBunchJPG:
-      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG Sequence to Save"), A_saveBunchJpg);      
+      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG Sequence to Save"), A_saveBunchJpg);
     	break;
     case ACT_SaveImg:
       GUI_FileSelWrite (QT_TR_NOOP("Select BMP to Save"), A_saveImg);
@@ -557,7 +557,7 @@
       GUI_FileSelWrite (QT_TR_NOOP("Select JPEG to Save"), (SELFILE_CB *)A_saveJpg);
       	//GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
       	break;
-    
+
     case ACT_Scale:
       if (!ignore_change)
 	{
@@ -575,7 +575,7 @@
     {
         ADM_PREVIEW_MODE oldpreview=getPreviewMode(),newpreview=(ADM_PREVIEW_MODE)UI_getCurrentPreview();
           printf("Old preview %d, New preview mode : %d\n",oldpreview,newpreview);
-          
+
           if(oldpreview==newpreview)
           {
             return;
@@ -606,10 +606,10 @@
     case ACT_PrevBlackFrame:
       GUI_NextPrevBlackFrame(-1);
       break;
-    case ACT_AllBlackFrames:    
+    case ACT_AllBlackFrames:
       GUI_FileSelWrite (QT_TR_NOOP("Select File to Save"), (SELFILE_CB *)A_ListAllBlackFrames);
-        break;                        
-    
+        break;
+
     case ACT_PreviousFrame:
         GUI_PrevFrame();
       break;
@@ -672,7 +672,7 @@
        A_changeAudioStream((AVDMGenericAudioStream *) NULL, AudioNone,NULL);
       break;
 
-  
+
     case ACT_MarkA:
     case ACT_MarkB:
       uint32_t swapit;
@@ -770,8 +770,8 @@
 
     case ACT_Delete:
     case ACT_Cut:
-    
-     
+
+
       old=frameStart;
       if( A_delete(frameStart,frameEnd))
       {
@@ -779,11 +779,11 @@
 	{			// we removed too much
 	  old = avifileinfo->nb_frames - 1;
 	}
-      	curframe=old;	 
-      	GUI_GoToFrame (old);      
+      	curframe=old;
+      	GUI_GoToFrame (old);
       }
-      
-      
+
+
       break;
 
     case ACT_AudioMap:
@@ -807,11 +807,12 @@
 
       	if (DIA_GetFloatValue (&fps, 1., 60., QT_TR_NOOP("Frame Rate"),QT_TR_NOOP("_Frames per second:")))
 	{
-	
+
 	  info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
 	  video_body->updateVideoInfo (&info);
 	  // update display
 	  video_body->getVideoInfo (avifileinfo);
+	  rebuild_status_bar();
 	 }
 	}
       break;
@@ -849,7 +850,7 @@
    case ACT_HEX_DUMP:
       GUI_showCurrentFrameHex();
       break;
-      
+
     default:
       printf ("\n unhandled action %d\n", action);
       ADM_assert (0);
@@ -910,7 +911,7 @@
 
 
   GUI_close(); // Cleanup
-  
+
   DIA_StartBusy ();
   /*
   ** we may get a relative path by cmdline
@@ -933,11 +934,11 @@
   if (res!=ADM_OK)			// an error occured
     {
 		delete[] longname;
-    	if(ADM_IGN==res) 
+    	if(ADM_IGN==res)
 	{
 		return 0;
 	}
-	
+
 	currentaudiostream = NULL;
 	avifileinfo = NULL;
 
@@ -1051,7 +1052,7 @@
 
   // Init renderer
     admPreview::setMainDimension(avifileinfo->width, avifileinfo->height);
-  curframe = 0;  
+  curframe = 0;
 
   // Draw first frame
   rebuild_status_bar();
@@ -1060,7 +1061,7 @@
   UI_setMarkers (frameStart, frameEnd);
 
   getFirstVideoFilter(); // Rebuild filter if needed
-  
+
   /* Zoom out if needed */
   uint32_t phyW,phyH;
   UI_getPhysicalScreenSize(NULL, &phyW,&phyH);
@@ -1080,12 +1081,12 @@
       currentZoom=ZOOM_1_1;
       changePreviewZoom(currentZoom);
   }
-        
-  
-  
+
+
+
       admPreview::update (curframe);
       update_status_bar();
-   
+
    printf("\n** conf updated **\n");
 }
 
@@ -1180,18 +1181,18 @@
       return;
     }
 
-  
+
   out = fopen (name, "wb");
   if (!out) return;
-  
+
   work=new DIA_working(QT_TR_NOOP("Saving audio"));
-  
+
   uint32_t timeEnd,timeStart,sample,hold,len;
   uint64_t tgt_sample,cur_sample;
   double   duration;
 
   // compute start position and duration in samples
-    
+
    timeStart=video_body->getTime (frameStart);
    timeEnd=video_body->getTime (frameEnd+1);
 
@@ -1199,12 +1200,12 @@
    duration=timeEnd-timeStart;
    printf("Duration:%f ms\n",duration);
    if(duration<0) duration=-duration;
-  
-   duration/=1000;   
+
+   duration/=1000;
    duration*=currentaudiostream->getInfo()->frequency;
-   
-   tgt_sample=(uint64_t)floor(duration);  
-   
+
+   tgt_sample=(uint64_t)floor(duration);
+
    cur_sample=0;
    written = 0;
    hold=0;
@@ -1218,19 +1219,19 @@
 	if(hold>ONE_STRIKE)
 	{
 		fwrite(buffer,hold,1,out);
-		hold=0;		
+		hold=0;
 	}
 	if(cur_sample>tgt_sample)
-		break;   
+		break;
       work->update(cur_sample>>10, tgt_sample>>10);
       if(!work->isAlive()) break;
     };
   if(hold)
   {
   	fwrite(buffer,hold,1,out);
-	hold=0;  
+	hold=0;
   }
-  
+
   fclose (out);
   delete work;
   delete[] buffer;
@@ -1262,7 +1263,7 @@
     if(!GUI_getFrameContent(&image, curframe))
     {
       GUI_Error_HIG(QT_TR_NOOP("Get Frame"),QT_TR_NOOP("Cannot get this frame to save"));
-      return 0; 
+      return 0;
     }
     return (int) image.saveAsJpg (name);
 }
@@ -1278,7 +1279,7 @@
          video_body->changeAudioStream(0,b);
         b^=1;
         return 1;
- 	
+
 }
 #endif
 
@@ -1295,7 +1296,7 @@
   char	 fullName[2048],*ext;
   DIA_working *working;
   uint8_t success=0;
-  
+
         if(frameStart>frameEnd)
                 {
                   GUI_Error_HIG(QT_TR_NOOP("Mark A > B"), QT_TR_NOOP("Set your markers correctly."));
@@ -1303,14 +1304,14 @@
                 }
         // Split name into base + extension
         PathSplit(name,&name,&ext);
-        
+
         src=new ADMImage(avifileinfo->width,avifileinfo->height);
         ADM_assert(src);
 
         working=new DIA_working(QT_TR_NOOP("Saving as set of jpegs"));
         for(curImg=frameStart;curImg<=frameEnd;curImg++)
-        {	
-                working->update(curImg-frameStart,frameEnd-frameStart);	
+        {
+                working->update(curImg-frameStart,frameEnd-frameStart);
                 if (!GUI_getFrameContent (src,curImg ))
                 {
                   GUI_Error_HIG(QT_TR_NOOP("Cannot decode frame"), QT_TR_NOOP("Aborting."));
@@ -1321,7 +1322,7 @@
                 if(!src->saveAsJpg(fullName)) goto _bunch_abort;
         }
         success=1;
-        
+
 _bunch_abort:
         if(success)
             GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "Saved %d images."), curImg-frameStart);
@@ -1339,7 +1340,7 @@
 */
 void A_saveImg (char *name)
 {
-  
+
   ADMImage image(avifileinfo->width,avifileinfo->height);
   GUI_getFrameContent(&image, curframe);
   if(image.saveAsBmp(name))
@@ -1382,8 +1383,8 @@
 //_____________________________________________________________
 //
 //              Load wave
-//              
 //
+//
 //_____________________________________________________________
 AudioSource currentAudioSource=AudioAvi;
 AudioSource secondAudioSource=AudioNone;
@@ -1415,8 +1416,8 @@
 //_____________________________________________________________
 //
 //              Load wave
-//              
 //
+//
 //_____________________________________________________________
 
 int
@@ -1482,9 +1483,9 @@
   uint32_t written = 0;
   FILE *out;
   AVDMGenericAudioStream *saveFilter;
-  
+
   uint64_t sampleTarget,sampleCurrent;
-  
+
 #undef BITT
 #define BITT 4*1152
 #define OUTCHUNK 1024*1024
@@ -1540,7 +1541,7 @@
 			ADM_dealloc(outbuffer);
 			return;
 		}
-   
+
     	DIA_working *work=new DIA_working(QT_TR_NOOP("Saving audio"));
 
 
@@ -1555,11 +1556,11 @@
   duration=(tend-tstart);
   duration*=saveFilter->getInfo()->frequency;
   duration/=1000.;
-  
+
   sampleTarget=(uint64_t)floor(duration);
   sampleCurrent=0;
   gauge=0;
-  
+
   if( frameStart == frameEnd ){
      /* JSC: we will write some bytes, but nobody should expect useful data */
     GUI_Error_HIG(QT_TR_NOOP("No frames to encode"),QT_TR_NOOP("Please check markers. Is \"A>\" == \">B\"?"));
@@ -1575,23 +1576,23 @@
       //      printf("Got : %lu\n",len2);
       gauge += len;
       sampleCurrent+=samples;
-      // update GUI                   
+      // update GUI
 	// JSC: if "A>" == ">B" we will get >100% here => assert in work->update()
 	if (work->update ((sampleCurrent>>10 > sampleTarget>>10 ? sampleTarget>>10 : sampleCurrent>>10), sampleTarget>>10))	// abort request ?
 	    break;;
-      if (gauge > OUTCHUNK)	// either out buffer is full	
+      if (gauge > OUTCHUNK)	// either out buffer is full
 	{
-	  fwrite (outbuffer, 1, gauge, out);	  
+	  fwrite (outbuffer, 1, gauge, out);
 	  written += gauge;
 	  gauge = 0;
-	}   	
+	}
     };
 // Clean up
 	if(gauge)
 	{
-		fwrite (outbuffer,  gauge,1, out);	  
+		fwrite (outbuffer,  gauge,1, out);
 		written += gauge;
-		gauge = 0;	
+		gauge = 0;
 	}
   saveFilter->endWrite (out, written);
   fclose (out);
@@ -1725,7 +1726,7 @@
                 }
                 ADM_assert (video_body->getFlags (i, &flags));
         }
-      
+
       if (flags & AVI_B_FRAME)	// oops
 	{
 	  // se search for the next i /p
@@ -1910,7 +1911,7 @@
       aviInfo info;
       ADM_assert (video_body->getVideoInfo (&info));
       count = end - start;
-     
+
       if( end < start ){
         GUI_Error_HIG(QT_TR_NOOP("Marker A > B"), QT_TR_NOOP("Cannot delete the selection."));
          return 0;
@@ -1933,18 +1934,18 @@
 	{
           GUI_Error_HIG (QT_TR_NOOP("Something bad happened (II)"), NULL);
 	}
-      
 
 
+
       frameEnd=avifileinfo->nb_frames-1;
       frameStart=0;
       rebuild_status_bar ();
       UI_setMarkers (frameStart, frameEnd);
       ReSync ();
      return 1;
-      
 
 
+
 }
 extern int DIA_getMPParams( uint32_t *pplevel, uint32_t *ppstrength,uint32_t *swap);
 //
@@ -1958,7 +1959,7 @@
                 return 0;
         }
         return GUI_GoToFrame(frame);
-        
+
 }
 
 //
@@ -1966,7 +1967,7 @@
 {
 uint32_t type,strength,swap;
 	if(!avifileinfo) return;
-	
+
 	video_body->getPostProc(&type,&strength,&swap);
 
  	if(DIA_getMPParams( &type, &strength,&swap))
@@ -1985,8 +1986,8 @@
 {
         uint32_t nb;
         audioInfo *infos=NULL;
-        
-        uint32_t old,nw;        
+
+        uint32_t old,nw;
         uint8_t r=0;
         uint32_t oldtrack,newtrack;
         char *newtrackname=ADM_strdup(currentAudioName);
@@ -1998,7 +1999,7 @@
         }
         newtrack=oldtrack=(uint32_t)video_body->getCurrentAudioStreamNumber(0);
         nw=old=currentAudioSource;
-        
+
         /* Build dialog factory widget */
         diaMenuEntry sourcesStream[]={
             {AudioAvi,QT_TR_NOOP("Video"),QT_TR_NOOP("Take audio from video file")},
@@ -2007,14 +2008,14 @@
             {AudioMP3,QT_TR_NOOP("External MP3"),QT_TR_NOOP("Take audio from external MP3 file")},
             {AudioWav,QT_TR_NOOP("External WAV"),QT_TR_NOOP("Take audio from external WAV file")}
         };
-        
-        
+
+
         diaElemMenu   sourceMenu(&nw,QT_TR_NOOP("_Audio source:"),5,sourcesStream,NULL);
-        
-        
-        
+
+
+
         diaElemFile  sourceName(0,&newtrackname,QT_TR_NOOP("_External file:"), NULL, QT_TR_NOOP("Select file"));
-        
+
         // Now build the list of embedded track
 #define MAX_AUDIO_TRACK 10
 #define MAX_AUDIO_TRACK_NAME 100
@@ -2027,24 +2028,24 @@
            sourceavitracks[i]=new diaMenuEntryDynamic(i,string,NULL);
         }
          if(infos) delete [] infos;
-         
+
          diaElemMenuDynamic   sourceFromVideo(&newtrack,QT_TR_NOOP("_Track from video:"),nb,sourceavitracks);
          diaElem *allWidgets[]={&sourceMenu,&sourceFromVideo,&sourceName};
-         
+
          /* Link..*/
          sourceMenu.link(&(sourcesStream[0]),1,&sourceFromVideo);
          sourceMenu.link(&(sourcesStream[2]),1,&sourceName);
          sourceMenu.link(&(sourcesStream[3]),1,&sourceName);
          sourceMenu.link(&(sourcesStream[4]),1,&sourceName);
-         
-         
+
+
          if( diaFactoryRun(QT_TR_NOOP("Main Audio Track"),3,allWidgets))
          {
            if(nw!=AudioNone && nw!=AudioAvi)
            {
               if( !ADM_fileExist(newtrackname))
               {
-                GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP("Cannot load"),QT_TR_NOOP("The selected audio file does not exist.")); 
+                GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP("Cannot load"),QT_TR_NOOP("The selected audio file does not exist."));
                 goto roger_and_out;
               }
            }
@@ -2083,7 +2084,7 @@
                             ADM_assert(0);
         }
          }
-roger_and_out:         
+roger_and_out:
          /* Clean up */
          for(int i=0;i<nb;i++)
             delete sourceavitracks[i];
@@ -2106,7 +2107,7 @@
             {AudioMP3,QT_TR_NOOP("External MP3"),QT_TR_NOOP("Take audio from external MP3 file")},
             {AudioWav,QT_TR_NOOP("External WAV"),QT_TR_NOOP("Take audio from external WAV file")}
         };
-        
+
         old=nw=secondAudioSource;
 
         diaElemMenu     sourceMenu(&nw,QT_TR_NOOP("_Audio source:"),4,sourcesStream,NULL);
@@ -2114,7 +2115,7 @@
         diaElem *allWidgets[]={&sourceMenu,&sourceName};
 
   /* Link..*/
-        
+
          sourceMenu.link(&(sourcesStream[2]),1,&sourceName);
          sourceMenu.link(&(sourcesStream[3]),1,&sourceName);
          sourceMenu.link(&(sourcesStream[1]),1,&sourceName);
@@ -2152,11 +2153,11 @@
                         {
                                 delete tmp;
                                 GUI_Error_HIG(QT_TR_NOOP("Error loading the MP3 file"), NULL);
-                                
+
                         }
                         else
                         {
-                                secondaudiostream = tmp;     
+                                secondaudiostream = tmp;
                                 secondAudioSource=AudioMP3;
                                 secondAudioName=ADM_strdup(name);
                                 printf ("\n MP3 loaded\n");
@@ -2178,7 +2179,7 @@
                         }
                         else
                         {
-                                secondaudiostream = tmp;     
+                                secondaudiostream = tmp;
                                 secondAudioSource=AudioAC3;
                                 secondAudioName=ADM_strdup(name);
                                 printf ("\n AC3 loaded\n");
@@ -2200,7 +2201,7 @@
                         }
                         else
                         {
-                                secondaudiostream = tmp;     
+                                secondaudiostream = tmp;
                                 secondAudioSource=AudioAC3;
                                 secondAudioName=ADM_strdup(name);
                                 printf ("\n AC3 loaded\n");
@@ -2213,8 +2214,8 @@
         }
         return 0;
 }
-             
 
+
 //****************
 uint8_t A_TimeShift(void)
 {
@@ -2239,7 +2240,7 @@
 // Just in case update file info
         if(!avifileinfo) return;
         rebuild_status_bar();
-        
+
         if(curframe>avifileinfo->nb_frames) curframe=frameEnd;
         UI_setMarkers (frameStart, frameEnd);
         GUI_GoToFrame(curframe);
@@ -2255,7 +2256,7 @@
 
         base=ADM_getJobDir();
         fullname=new char[strlen(name)+strlen(base)+2+4];
-        
+
         strcpy(fullname,base);
         strcat(fullname,"/");
         strcat(fullname,name);
@@ -2313,7 +2314,7 @@
 
     percent = UI_readScale();
     tg= (avifileinfo->nb_frames-1) * percent / 100.;
-    
+
     return (uint32_t)floor(tg);;
 
 
@@ -2332,20 +2333,20 @@
 
     //    if(!guiReady) return ;
     text[0] = 0;
- 
+
 	UI_updateFrameCount( curframe);
 	UI_updateTimeCount( curframe,avifileinfo->fps1000);
-       
+
     // progress bar
     len = 100;
     if(avifileinfo->nb_frames>1)
     	len=len / (double) (avifileinfo->nb_frames-1);
     len *= (double) curframe;
 
-   
 
+
      UI_setScale(len);
-   	
+
 }
 
 ///
@@ -2359,10 +2360,10 @@
 
     //    if(!guiReady) return ;
     text[0] = 0;
- 
+
 	UI_setFrameCount( curframe, avifileinfo->nb_frames);
 	UI_setTimeCount( curframe, avifileinfo->nb_frames,avifileinfo->fps1000);
-	
+
     // progress bar
     len = 100;
     if(avifileinfo->nb_frames>1)
@@ -2382,7 +2383,7 @@
 {
   uint32_t flags;
   if(!video_body->getUncompressedFrame(frame,image,&flags)) return 0;
-  return 1; 
+  return 1;
 }
 /**
     \fn GUI_close
@@ -2461,25 +2462,25 @@
  uint32_t fullLen,flags;
  char sType[5];
  char sSize[15];
- 
+
  if (!avifileinfo) return;
- 
+
  buffer=new uint8_t [avifileinfo->width*avifileinfo->height*3];
- video_body->getRaw (curframe, buffer, &fullLen);  
+ video_body->getRaw (curframe, buffer, &fullLen);
  video_body->getFlags (curframe, &flags);
- 
+
  diaElemHex binhex("*****",fullLen,buffer);
-      
+
  if(flags==AVI_KEY_FRAME) sprintf(sType,"I");
   else if(flags==AVI_B_FRAME) sprintf(sType,"B");
     else sprintf(sType,"P");
  sprintf(sSize,"%d bytes",fullLen);
- 
+
  diaElemReadOnlyText Type(sType,QT_TR_NOOP("Frame type:"));
  diaElemReadOnlyText Size(sSize,QT_TR_NOOP("Frame size:"));
  diaElem *elems[]={&Type,&Size,&binhex   };
  if(diaFactoryRun(QT_TR_NOOP("Frame Hex Dump"),3,elems))
- 
+
  delete [] buffer;
 }
 



From mean at mail.berlios.de  Mon Jun 16 20:07:46 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jun 2008 20:07:46 +0200
Subject: [Avidemux-svn-commit] r4112 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_inputs/ADM_mp4 plugins/ADM_videoFilters
	plugins/ADM_videoFilters/TIsophote
	plugins/ADM_videoFilters/TIsophote/original
Message-ID: <200806161807.m5GI7k1G002339@sheep.berlios.de>

Author: mean
Date: 2008-06-16 20:07:45 +0200 (Mon, 16 Jun 2008)
New Revision: 4112

Added:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/HELP FILE.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/avisynth.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/gpl.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/internal.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/resource.h
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CMakeLists.txt
Log:
[Merge]


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-06-16 18:07:45 UTC (rev 4112)
@@ -1,6 +1,6 @@
 /***************************************************************************
 /*
-    
+
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr
  ***************************************************************************/
@@ -42,7 +42,7 @@
 
 uint32_t ADM_UsecFromFps1000(uint32_t fps1000);
 // 14496-1 / 8.2.1
-typedef enum 
+typedef enum
 {
 	Tag_InitialObjDesc	=0x02,
 	Tag_ES_Desc		=0x03,
@@ -58,7 +58,7 @@
 */
 uint8_t     MP4Header::lookupMainAtoms(void *ztom)
 {
-  
+
   adm_atom *tom=(adm_atom *)ztom;
   adm_atom *moov;
   ADMAtoms id;
@@ -81,19 +81,19 @@
     {
       switch( id)
       {
-        case ADM_MP4_MVHD: parseMvhd(&son);break; 
-        case ADM_MP4_TRACK: 
+        case ADM_MP4_MVHD: parseMvhd(&son);break;
+        case ADM_MP4_TRACK:
             if(!parseTrack(&son))
             {
                 printf("Parse Track failed\n");
             } ;
             break;
-        default : 
+        default :
                 adm_printf(ADM_PRINT_DEBUG,"atom %s not handled\n",fourCC::tostringBE(son.getFCC()));
                 break;
       }
-      
-      
+
+
     }
     son.skipAtom();
   }
@@ -110,7 +110,7 @@
   adm_atom *tom=(adm_atom *)ztom;
   tom->skipBytes(12);
   uint32_t scale,duration=1000;
-  
+
         scale=tom->read32();
         duration=tom->read32();
         _videoScale=scale;
@@ -135,7 +135,7 @@
   uint32_t container;
   uint32_t w,h;
   uint32_t trackType=TRACK_OTHER;
-  
+
   printf("Parsing Track\n");
    while(!tom->isDone())
   {
@@ -158,7 +158,7 @@
                       son.skipBytes(8);
                       son.skipBytes(4); // layers
                       son.skipBytes(40); // layers
-  
+
                       w=son.read32()>>16;
                       h=son.read32()>>16;
                       adm_printf(ADM_PRINT_DEBUG,"tkhd : %ld %ld\n",w,h);
@@ -202,7 +202,7 @@
      }
      switch(id)
      {
-       case ADM_MP4_MDHD:  
+       case ADM_MP4_MDHD:
        {
                 uint32_t version=son.read(),duration;
                 son.skipBytes(3); // flags + version
@@ -220,16 +220,16 @@
                 printf("MDHD,Track duration :%s, trackScale :%u\n",ms2timedisplay((1000*duration)/trackScale),trackScale);
                 break;
        }
-       case ADM_MP4_HDLR:  
+       case ADM_MP4_HDLR:
        {
             uint32_t type;
-            
+
                 son.read32();
                 son.read32();
                 type=son.read32();
                 printf("[HDLR]\n");
                 switch(type)
-                {	
+                {
                 case MKFCCR('v','i','d','e')://'vide':
                         *trackType=TRACK_VIDEO;
                         printf("hdlr video found \n ");
@@ -253,14 +253,14 @@
                         printf("Url : <%s>\n",str);
                       }
                       break;
-                 
+
                 }
                 break;
-       } 
-       case ADM_MP4_MINF:  
+       }
+       case ADM_MP4_MINF:
        {
             // We are only interested in stbl
-            
+
             while(!son.isDone())
             {
               adm_atom grandson(&son);
@@ -275,7 +275,7 @@
                    if(! parseStbl(&grandson,*trackType, w, h,trackScale))
                    {
                       printf("STBL failed\n");
-                      return 0; 
+                      return 0;
                    }
                    r=1;
               }
@@ -286,7 +286,7 @@
         default:
             adm_printf(ADM_PRINT_DEBUG,"** atom  NOT HANDLED [%s] \n",fourCC::tostringBE(son.getFCC()));
      }
-     
+
      son.skipAtom();
   }
   return r;
@@ -302,11 +302,11 @@
   ADMAtoms id;
   uint32_t container;
   MPsampleinfo  info;
-  
-  
+
+
   memset(&info,0,sizeof(info));
 
-  
+
   printf("<<Parsing Stbl>>\n");
   while(!tom->isDone())
   {
@@ -333,9 +333,9 @@
                   }
           }
           break;
-         
+
        }
-       case ADM_MP4_STTS: 
+       case ADM_MP4_STTS:
             {
                 printf("stts:%lu\n",son.read32()); // version & flags
                 info.nbStts=son.read32();
@@ -346,13 +346,13 @@
                 double dur;
                 for(int i=0;i<info.nbStts;i++)
                 {
-                        
+
                         info.SttsN[i]=son.read32();
                         info.SttsC[i]=son.read32();
-                        adm_printf(ADM_PRINT_VERY_VERBOSE,"stts: count:%u size:%u (unscaled)\n",info.SttsN[i],info.SttsC[i]);	
+                        adm_printf(ADM_PRINT_VERY_VERBOSE,"stts: count:%u size:%u (unscaled)\n",info.SttsN[i],info.SttsC[i]);
                         //dur*=1000.*1000.;; // us
                         //dur/=myScale;
-                }                
+                }
             }
             break;
        case ADM_MP4_STSC:
@@ -397,10 +397,10 @@
               }
           }
           break;
-           case ADM_MP4_CTTS: // Composition time to sample             
+           case ADM_MP4_CTTS: // Composition time to sample
             {
                 uint32_t n,i,j,k,v;
-                
+
                   printf("ctts:%lu\n",son.read32()); // version & flags
                   n=son.read32();
                   if(n==1) // all the same , ignore
@@ -420,12 +420,12 @@
                     sum+=count[i];
                 }
                 info.Ctts=new uint32_t[sum+1]; // keep a safe margin
-                
+
                 for(i=0;i<n;i++)
                 {
                     if(i<20)
                     {
-                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",count[i],count[i],values[i],values[i]);   
+                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",count[i],count[i],values[i],values[i]);
                     }
                     for(k=0;k<count[i];k++)
                     {
@@ -443,7 +443,7 @@
                 ADM_assert(info.nbCtts<sum+1);
                 printf("Found %u elements\n",info.nbCtts);
             }
-            break;  
+            break;
        case ADM_MP4_STCO:
        {
           son.read32();
@@ -487,7 +487,7 @@
                    left=entrySize-8;
                    if(i || (trackType==TRACK_VIDEO && _videoFound) || (trackType==TRACK_OTHER))
                    {
-                    son.skipBytes(left); 
+                    son.skipBytes(left);
                     printf("[STSD] ignoring %s, size %u\n",fourCC::tostringBE(entryName),entrySize);
                     if(trackType==TRACK_OTHER) printf("[STSD] because track=other\n");
                     continue;
@@ -504,23 +504,23 @@
                                 left-=4;
                                 printf("[STSD] vendor %s\n",fourCC::tostringBE(son.read32()));
                                 left-=4;
-                                
+
                                 son.skipBytes(8); // spatial qual etc..
                                 left-=8;
-                                
+
                                 printf("[STSD] width :%u\n",lw=son.read16());
                                 printf("[STSD] height :%u\n",lh=son.read16());
                                 left-=4;
-                                
+
                                 son.skipBytes(8); // Resolution
                                 left-=8;
-                                
+
                                 printf("[STSD] datasize :%u\n",son.read32());
                                 left-=4;
-                     
+
                                 printf("[STSD] FrameCount :%u\n",son.read16());
                                 left-=4;
-                                
+
                                 // Codec name
                                 uint32_t u32=son.read();
                                 if(u32>31) u32=31;
@@ -529,22 +529,22 @@
                                 printf(">\n");
                                 son.skipBytes(32-1-u32);
                                 left-=32;
-                                // 
+                                //
                                 son.read32();
                                 left-=4; //Depth & color Id
                                 //
                                 printf("LEFT:%d\n",left);
-                                
+
                                 if(left>8)
                                 {
-//                                  decodeVideoAtom(&son); 
+//                                  decodeVideoAtom(&son);
                                 }
                                 //
 #define commonPart(x)             _videostream.fccHandler=_video_bih.biCompression=fourCC::get((uint8_t *)#x);
-                      
 
-                                 _video_bih.biWidth=_mainaviheader.dwWidth=lw ; 
-                                  _video_bih.biHeight=_mainaviheader.dwHeight=lh; 
+
+                                 _video_bih.biWidth=_mainaviheader.dwWidth=lw ;
+                                  _video_bih.biHeight=_mainaviheader.dwHeight=lh;
                                   _video_bih.biCompression=_videostream.fccHandler;
 
                                 //
@@ -619,13 +619,19 @@
                                           commonPart(H264);
                                           // There is a avcC atom just after
                                           // configuration data for h264
-nextAtom:                                          
+nextAtom:
                                           adm_atom avcc(&son);
                                           printf("Reading avcC, got %s\n",fourCC::tostringBE(avcc.getFCC()));
-                                          if(avcc.getFCC()==MKFCCR('c','o','l','r')) // Color atom
+                                          switch(avcc.getFCC())
                                           {
-                                        	  avcc.skipAtom();
-                                        	  goto nextAtom;
+                                              case MKFCCR('a','v','c','C'): break;
+                                              default:
+                                              case MKFCCR('c','o','l','r'):  // Color atom
+                                              case MKFCCR('p','a','s','p'):
+                                              case MKFCCR('c','l','a','p'):
+                                                  avcc.skipAtom();
+                                                  goto nextAtom;
+                                                  break;
                                           }
                                           int len,offset;
                                           VDEO.extraDataSize=avcc.getRemainingSize();
@@ -641,14 +647,14 @@
                                             printf("avcC AVCProfileIndication :%x\n", MKD8(1));
                                             printf("avcC profile_compatibility:%x\n", MKD8(2));
                                             printf("avcC AVCLevelIndication   :%x\n", MKD8(3));
-        
+
                                             printf("avcC lengthSizeMinusOne   :%x\n", MKD8(4));
                                             printf("avcC NumSeq               :%x\n", MKD8(5));
                                             len=MKD16(6);
                                             printf("avcC sequenceParSetLen    :%x ",len );
                                             offset=8;
                                             mixDump(VDEO.extraData+offset,len);
-        
+
                                             offset=8+len;
                                             printf("\navcC numOfPictureParSets  :%x\n", MKD8(offset++));
                                             len=MKD16(offset);
@@ -664,7 +670,7 @@
                                                 adm_atom avcc(&son);
                                                 printf("Reading , got %s\n",fourCC::tostringBE(avcc.getFCC()));
                                                 left=0;
-                                                
+
                                             }
                                             break;
                                 } // Entry name
@@ -673,34 +679,34 @@
                      case TRACK_AUDIO:
                      {
                         uint32_t channels,bpp,encoding,fq,packSize;
-                        
+
                                 // Put some defaults
                                 ADIO.encoding=1234;
                                 ADIO.frequency=44100;
                                 ADIO.byterate=128000>>3;
                                 ADIO.channels=2;
                                 ADIO.bitspersample=16;
-                        
+
                                 printf("[STSD] AUDIO <%s>, 0x%08x, size %u\n",fourCC::tostringBE(entryName),entryName,entrySize);
                                 son.skipBytes(8);  // reserved etc..
                                 left-=8;
-                                
+
                                 int atomVersion=son.read16();  // version
                                 left-=2;
                                 printf("[STSD]Revision       :%d\n",atomVersion);
                                 son.skipBytes(2);  // revision
                                 left-=2;
-                                
+
                                 printf("[STSD]Vendor         : %s\n",fourCC::tostringBE(son.read32()));
                                 left-=4;
-                                
+
                                 ADIO.channels=channels=son.read16(); // Channel
                                 left-=2;
                                 printf("[STSD]Channels       :%d\n",ADIO.channels);
                                 ADIO.bitspersample=bpp=son.read16(); // version/revision
                                 left-=2;
                                 printf("[STSD]Bit per sample :%d\n",bpp);
-                                
+
                                 encoding=son.read16(); // version/revision
                                 left-=2;
                                 printf("[STSD]Encoding       :%d\n",encoding);
@@ -708,8 +714,8 @@
                                 packSize=son.read16(); // Packet Size
                                 left-=2;
                                 printf("[STSD]Packet size    :%d\n",encoding);
-                                
-                              
+
+
                                 fq=ADIO.frequency=son.read16();
                                 printf("[STSD]Fq:%u\n",fq);
                                 if(ADIO.frequency<6000) ADIO.frequency=48000;
@@ -752,12 +758,12 @@
 #define audioCodec(x) ADIO.encoding=WAV_##x;
                                 switch(entryName)
                                 {
-                                    
+
                                     case MKFCCR('t','w','o','s'):
                                             audioCodec(LPCM);
                                             ADIO.byterate=ADIO.frequency*ADIO.bitspersample*ADIO.channels/8;
                                             break;
-                                                
+
                                     case MKFCCR('u','l','a','w'):
                                             audioCodec(ULAW);
                                             ADIO.byterate=ADIO.frequency;
@@ -839,11 +845,11 @@
                                                           ADIO.blockalign=ADM_swap16(item.read16());
                                                           ADIO.bitspersample=ADM_swap16(item.read16());
                                                           printWavHeader(&(ADIO));
-                                                          
+
                                                         }
                                                        break;
                                                         case MKFCCR('m','p','4','a'):
-                                                          break; 
+                                                          break;
                                                         case MKFCCR('e','s','d','s'):
                                                           {
                                                                decodeEsds(&item,TRACK_AUDIO);
@@ -855,7 +861,7 @@
                                                      }
 
                                                      item.skipAtom();
-                                                   
+
                                                  }  // Wave iddone
                                                  left=0;
                                               }  // if ==wave
@@ -865,25 +871,25 @@
                                                           {
                                                                decodeEsds(&wave,TRACK_AUDIO);
                                                                goto foundit; // FIXME!!!
-                                                          } 
+                                                          }
                                                 else
                                                 {
-                                                  printf("UNHANDLED ATOM : %s\n",fourCC::tostringBE(wave.getFCC())); 
+                                                  printf("UNHANDLED ATOM : %s\n",fourCC::tostringBE(wave.getFCC()));
                                                 }
                                               }
                                             } // if left > 10
-foundit: // HACK FIXME     
+foundit: // HACK FIXME
                                             left=0;
-                                    }       
+                                    }
                                             break; // mp4a
-                                  
+
                                 }
                      }
                           break;
                      default:
                           ADM_assert(0);
                    }
-                   son.skipBytes(left); 
+                   son.skipBytes(left);
                 }
        }
               break;
@@ -904,7 +910,7 @@
               return 1;
           }
           r=indexify(&(_tracks[0]),trackScale,&info,0,&nbo);
-          
+
           _videostream.dwLength= _mainaviheader.dwTotalFrames=_tracks[0].nbIndex;
           // update fps
           float f=_videostream.dwLength;
@@ -936,7 +942,7 @@
             updateCtts(&info);
           }
 
-          
+
            VDEO.index[0].intra=AVI_KEY_FRAME;
         }
           break;
@@ -960,7 +966,7 @@
                 _tracks[1+nbAudioTrack].scale=trackScale;
                 nbAudioTrack++;
             }
-            
+
             break;
     case TRACK_OTHER:
         r=1;
@@ -974,7 +980,7 @@
 */
 uint8_t MP4Header::decodeEsds(void *ztom,uint32_t trackType)
 {
-adm_atom *tom=(adm_atom *)ztom; 
+adm_atom *tom=(adm_atom *)ztom;
 int tag,l;
             // in case of mpeg4 we only take
             // the mpeg4 vol header
@@ -1006,10 +1012,10 @@
                                           case 0x6d:ADIO.encoding=WAV_MP3;break;
                                           case 226:ADIO.encoding=WAV_AC3;break;
                                           break;
-                                  
+
                                       }
                                     }
-                                    tom->skipBytes(1+3+4+4);	
+                                    tom->skipBytes(1+3+4+4);
                                     break;
                             }
                             case Tag_DecSpecificInfo:
@@ -1035,7 +1041,7 @@
                                     }
                             }
             }
-            
+
     tom->skipAtom();
     return 1;
 }
@@ -1046,15 +1052,15 @@
 uint8_t MP4Header::updateCtts(MPsampleinfo *info )
 {
     uint32_t scope=info->nbCtts;
-            
+
             if(scope>_videostream.dwLength) scope=_videostream.dwLength;
-            
+
             // Search floor value
             uint32_t  flor=0xFFFFFFFF;
             uint32_t  cel=0;
             for(uint32_t i=0;i<scope;i++)
             {
-              if(info->Ctts[i]>4294967290) 
+              if(info->Ctts[i]>4294967290)
               {
                 if(i)
                   info->Ctts[i]=info->Ctts[0];
@@ -1078,7 +1084,7 @@
                 aprintf(">Frame :%u delta=%d\n",i,floops);
               if(floops<0)
               {
-                printf("[3GPP] CTTS negative for frame %u : %d\n",i,floops); 
+                printf("[3GPP] CTTS negative for frame %u : %d\n",i,floops);
                 floops=0;
               }
               _tracks[0].index[i].deltaPtsDts=floops;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-16 18:07:45 UTC (rev 4112)
@@ -808,6 +808,7 @@
 	  video_body->updateVideoInfo (&info);
 	  // update display
 	  video_body->getVideoInfo (avifileinfo);
+          rebuild_status_bar();
 	 }
 	}
       break;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CMakeLists.txt	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CMakeLists.txt	2008-06-16 18:07:45 UTC (rev 4112)
@@ -54,3 +54,5 @@
 ADD_SUBDIRECTORY(Srt)
 ADD_SUBDIRECTORY(Ass)
 # Dependancy toward codec & pics ADD_SUBDIRECTORY(Animated)
+#ADD_SUBDIRECTORY(leakKernelDeint)
+ADD_SUBDIRECTORY(TIsophote)

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,493 @@
+/***************************************************************************
+                       \file TIsophote.cpp
+                       \brief Port of TIsophote by Tritical http://bengal.missouri.edu/~kes25c/
+     ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+/*
+**                     TIsophote v0.9.1 for AviSynth 2.5.x
+**
+**   TIsophote is a simple unconstrained level-set (isophote) smoothing filter.
+**
+**   Copyright (C) 2004 Kevin Stone
+**
+**   This program is free software; you can redistribute it and/or modify
+**   it under the terms of the GNU General Public License as published by
+**   the Free Software Foundation; either version 2 of the License, or
+**   (at your option) any later version.
+**
+**   This program is distributed in the hope that it will be useful,
+**   but WITHOUT ANY WARRANTY; without even the implied warranty of
+**   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**   GNU General Public License for more details.
+**
+**   You should have received a copy of the GNU General Public License
+**   along with this program; if not, write to the Free Software
+**   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+
+#include "ADM_default.h"
+#include "ADM_videoFilterDynamic.h"
+#include "ADM_vidTisophote.h"
+
+#include "DIA_factory.h"
+static FILTER_PARAM kdintParam={4,{"iterations","tStep","type","chroma"}};
+
+
+VF_DEFINE_FILTER(ADMVideoTIsophote,kdintParam,
+    tisophote,
+                QT_TR_NOOP("TIsophote"),
+                1,
+                VF_NOISE,
+                QT_TR_NOOP("Port of TIsophote by tritical ."));
+
+
+
+
+
+uint8_t ADMVideoTIsophote::configure( AVDMGenericVideoStream *instream)
+{
+  #define PX(x) &(_param->x)
+_in=instream;
+
+   diaMenuEntry menuField[3]={{0,QT_TR_NOOP("Simple"),NULL},
+                             {1,QT_TR_NOOP("Medium"),NULL},
+                             {2,QT_TR_NOOP("Slow"),NULL}
+                          };
+
+
+    diaElemMenu     menu1(PX(type),QT_TR_NOOP("_Type:"), 3,menuField);
+    diaElemUInteger iterations(PX(iterations),QT_TR_NOOP("_Iterations:"),1,10,QT_TR_NOOP("Smaller means more deinterlacing"));
+    diaElemToggle   chroma(PX(chroma),QT_TR_NOOP("_Chroma:"),QT_TR_NOOP("Process chroma."));
+    diaElemFloat   step(PX(tStep),QT_TR_NOOP("_Step:"),0,1,QT_TR_NOOP("Step."));
+
+    diaElem *elems[4]={&menu1,&iterations,&chroma,&step};
+
+   return  diaFactoryRun(QT_TR_NOOP("KernelDeint"),4,elems);
+}
+uint8_t	ADMVideoTIsophote::getCoupledConf( CONFcouple **couples)
+{
+
+			*couples=new CONFcouple(4);
+			CSET(iterations);
+			CSET(tStep);
+			CSET(type);
+			CSET(chroma);
+
+		return 1;
+}
+char *ADMVideoTIsophote::printConf( void )
+{
+ 	static char buf[50];
+
+ 	sprintf((char *)buf," TIsoPhote by Tritical");
+        return buf;
+}
+
+ADMVideoTIsophote::~ADMVideoTIsophote()
+{
+ if(vidCache) delete vidCache;
+ if(_param) delete _param;
+  if(dst1) delete dst1;
+  if(dst2) delete dst2;
+}
+
+
+ ADMVideoTIsophote::ADMVideoTIsophote( AVDMGenericVideoStream *in,CONFcouple *couples)
+{
+
+		if(!couples)
+		{
+			_param=NEW(TISO_CONF);
+	    		_param->iterations=4;
+	    		_param->tStep=0.2;
+	    		_param->type=0;
+	    		_param->chroma=0;
+		}
+		else
+		{
+			_param=NEW(TISO_CONF);
+			GET(iterations);
+			GET(tStep);
+			GET(type);
+			GET(chroma);
+
+
+		}
+	    debug=0;
+	    _in=in;
+
+	   _uncompressed=NULL;
+
+  	memcpy(&_info,_in->getInfo(),sizeof(_info));
+	vidCache=new VideoCache(4,_in);
+    dst1=new ADMImage(_info.width,_info.height);
+    dst2=new ADMImage(_info.width,_info.height);
+
+}
+/**
+    \fn getFrameNumberNoAlloc
+    \brief Get a processed image
+
+*/
+uint8_t ADMVideoTIsophote::getFrameNumberNoAlloc(uint32_t frame,
+							uint32_t *len,
+							ADMImage *data,
+							uint32_t *flags)
+{
+  // Get the current frame.
+  uint32_t n=frame;
+
+    if(frame>_info.nb_frames-1) return 0;
+
+    ADMImage *mysrc=NULL;
+    mysrc=vidCache->getImage(frame);
+
+    //*****
+    ADMImage *src = vidCache->getImage(n);
+
+	unsigned char *srcp1 = src->GetReadPtr(PLANAR_Y);
+	int src1_pitch = src->GetPitch(PLANAR_Y);
+	int width = src->GetRowSize(PLANAR_Y) - 1;
+	int height = src->GetHeight(PLANAR_Y) - 1;
+	unsigned char *srcpp, *srcp, *srcpn;
+	unsigned char *dstp1 = dst1->GetWritePtr(PLANAR_Y);
+	int dst1_pitch = dst1->GetPitch(PLANAR_Y);
+	unsigned char *dstp2 = dst2->GetWritePtr(PLANAR_Y);
+	int dst2_pitch = dst2->GetPitch(PLANAR_Y);
+	unsigned char *dstp;
+	double off = 0.0000000001;
+	int x, y, b, dst_pitch, src_pitch, temp;
+	int Ix, Ix2, Iy, Iy2, Ixy, Ixx, Iyy;
+	BitBlit(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+	BitBlit(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+	for (b=0; b<_param->iterations; ++b)
+	{
+		if (b&1)
+		{
+			srcp = dstp2 + dst2_pitch;
+			src_pitch = dst2_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp = dstp1 + dst1_pitch;
+			dst_pitch = dst1_pitch;
+		}
+		else
+		{
+			srcp = dstp1 + dst1_pitch;
+			src_pitch = dst1_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp = dstp2 + dst2_pitch;
+			dst_pitch = dst2_pitch;
+		}
+		if (_param->type == 0)
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcp[x+1] - srcp[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x] - srcpp[x];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+					Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+					temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+		else if (_param->type == 1)
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+					Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+					temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+		else
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] +
+						srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+					Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] +
+						srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+					temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+	}
+	srcp1 = src->GetReadPtr(PLANAR_U);
+	src1_pitch = src->GetPitch(PLANAR_U);
+	width = src->GetRowSize(PLANAR_U) - 1;
+	height = src->GetHeight(PLANAR_U) - 1;
+	dstp1 = dst1->GetWritePtr(PLANAR_U);
+	dst1_pitch = dst1->GetPitch(PLANAR_U);
+	dstp2 = dst2->GetWritePtr(PLANAR_U);
+	dst2_pitch = dst2->GetPitch(PLANAR_U);
+	if (_param->chroma)
+	{
+		BitBlit(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		BitBlit(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		for (b=0; b<_param->iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (_param->type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcp[x+1] - srcp[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (_param->type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] +
+							srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] +
+							srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+		srcp1 = src->GetReadPtr(PLANAR_V);
+		dstp1 = dst1->GetWritePtr(PLANAR_V);
+		dstp2 = dst2->GetWritePtr(PLANAR_V);
+		BitBlit(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		BitBlit(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		for (b=0; b<_param->iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (_param->type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcp[x+1] - srcp[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (_param->type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] +
+							srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] +
+							srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*_param->tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+	}
+	else
+	{
+		if (_param->iterations&1) BitBlit(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		else BitBlit(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		srcp1 = src->GetReadPtr(PLANAR_V);
+		dstp1 = dst1->GetWritePtr(PLANAR_V);
+		dstp2 = dst2->GetWritePtr(PLANAR_V);
+		if (_param->iterations&1) BitBlit(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		else BitBlit(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+	}
+	if (_param->iterations&1) data->duplicate(dst2);
+        else data->duplicate(dst1);
+
+    //*****
+    vidCache->unlockAll();
+    return 1;
+
+}
+
+//***

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.h	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.h	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,57 @@
+/*
+**                     TIsophote v0.9.1 for AviSynth 2.5.x
+**
+**   TIsophote is a simple unconstrained level-set (isophote) smoothing filter.
+**
+**   Copyright (C) 2004 Kevin Stone
+**
+**   This program is free software; you can redistribute it and/or modify
+**   it under the terms of the GNU General Public License as published by
+**   the Free Software Foundation; either version 2 of the License, or
+**   (at your option) any later version.
+**
+**   This program is distributed in the hope that it will be useful,
+**   but WITHOUT ANY WARRANTY; without even the implied warranty of
+**   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**   GNU General Public License for more details.
+**
+**   You should have received a copy of the GNU General Public License
+**   along with this program; if not, write to the Free Software
+**   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+
+#ifndef ADM_TISOPHOTE
+#define ADM_TISOPHOTE
+
+typedef struct  TISO_CONF
+{
+    uint32_t        iterations ; //  int 4
+    float           tStep;        // float 0.2
+    uint32_t        type;         // drop down 0--2 2
+    uint32_t        chroma;       // bool 0
+}KERNEL_CONF;
+
+class  ADMVideoTIsophote:public AVDMGenericVideoStream
+ {
+
+ protected:
+        virtual char 		*printConf(void) ;
+	TISO_CONF		*_param;
+        int			 debug;
+	VideoCache		*vidCache;
+        ADMImage    *dst1;
+        ADMImage    *dst2;
+
+
+ public:
+
+  			ADMVideoTIsophote(  AVDMGenericVideoStream *in,CONFcouple *setup);
+  			~ADMVideoTIsophote();
+	virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+						ADMImage *data,uint32_t *flags);
+	virtual uint8_t	getCoupledConf( CONFcouple **couples)		;
+	virtual uint8_t configure( AVDMGenericVideoStream *instream);
+
+};
+
+#endif

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/CMakeLists.txt	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/CMakeLists.txt	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,9 @@
+INCLUDE(vf_plugin)
+
+
+SET(ADM_vf_Tisophote_SRCS ADM_vidTisophote.cpp)
+
+ADD_LIBRARY(ADM_vf_Tisophote SHARED ${ADM_vf_Tisophote_SRCS})
+
+INIT_VIDEOFILTER_PLUGIN(ADM_vf_Tisophote)
+INSTALL_VIDEOFILTER(ADM_vf_Tisophote)

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/HELP FILE.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/HELP FILE.txt	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/HELP FILE.txt	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,118 @@
+                                                                                                      |
+                                   TIsophote for AviSynth v2.5.x                                      |
+                                       v0.9.1 (24 July 2004)                                          |
+                                            by tritical                                               |
+                                                                                                      |
+                                             HELP FILE                                                |
+-------------------------------------------------------------------------------------------------------
+-------------------------------------------------------------------------------------------------------
+
+
+INFO:
+
+
+      TIsophote is a level-set (isophote) smoothing filter.  It does simple unconstrained level-set
+   smoothing.  Basically, it can smooth jagged edges in an image.  If over used it will remove jagged 
+   edges as well as object features and eventually completely eliminate all level curves. For a more 
+   in-depth explanation see the technical info towards the bottom of the help file. 
+
+    Or for more info (includes information besides simple unconstrained smoothing):
+
+              http://neuron2.net/library/LSImageReconstruction.pdf
+
+   Syntax =>    TIsophote(int iterations, float tStep, int type, bool chroma)
+
+
+
+PARAMETERS:
+
+
+   iterations
+  
+      Sets the number of iterations used.  More iterations will take more processing time.
+      Increasing the number of iterations while holding tStep constant will result in more and
+      more shortening of the level curves.  Total 'time' of the filter is equal to -
+      iterations*tStep. iterations must be set to at least 1.
+
+      default -  4  (int)
+
+
+   tStep
+
+      Sets the update per iteration.  At 1.0, each iteration is a full cycle of the flow equation.
+      At 0, the original image is always returned.  Generally, lower values produce more "stable"
+      flow but require more iterations.  Recommended values are between 0.1 and 0.5, though setting
+      this to 1.0 is usually ok and simply results in an extra overall smoothing.  While this
+      value can be anything, it really only makes sense when it is 0.0 <= tStep <= 1.0, other values
+      will generally result in garbage output.  This setting could be seen as a strength of smoothing
+      per iteration setting (1.0 being strongest, 0.0 being nothing).  Note:  technically for long run
+      numerical stability this value must be less then 0.25!
+
+      default -  0.2  (float)
+
+
+   type
+
+      Sets how the needed derivatives are calculated.
+
+         type 0 - simplest possible estimate of both first and second derivatives 
+                  (fastest, probably best clean video)
+
+         type 1 - sobel operator for first derivatives, simple estimate for second
+                  (in-between 0 and 2 speed wise and noise wise)
+
+         type 2 - sobel operator for first and similar inherent denoising operator for second
+                  (slowest, probably best for noisy video)   
+  
+      default -  2 (int)
+
+
+   chroma
+
+      If set to true the chroma planes are processed.  If set to false the chroma planes from the
+      source are simply copied to the output frame.
+
+      default - false  (bool)
+   
+
+
+TECHNICAL INFO:
+
+
+   The filter operation is really quite simple, all it does is use the following equation to update the 
+   value of each pixel in the frame after each iteration.
+
+    I(n) = a pixel in the frame at iteration n
+
+    I(n+1) = I(n) + It
+
+    It = ((Ix*Ix*Iyy + 2*Ix*Iy*Ixy + Iy*Iy*Ixx) * tStep) / (Ix*Ix + Iy*Iy + e)
+
+        - e = a very small constant (ex. 10^-10) to prevent division by 0
+        - Ix, Iy, Ixy, Iyy, Ixx are the first and second derivatives of
+          the image at the current pixel location, i.e.
+             Ix = first derivative in x direction
+             Iy = first derivative in y direction, etc...
+      
+
+
+CHANGE LIST:
+
+   07/24/2004  v0.9.1
+       - Changed default values for iterations, type, and chroma parameters
+       - Fixed incorrect clipping for values below 0.  Pixel values were clipped 
+            to 0-255 range but values below 0 were getting clipped to abs(pixel)
+            instead of 0 which would lead to artifacts.
+
+   06/25/2004  v0.9
+       - Initial Release
+
+
+
+TO DO LIST:  
+
+     - bug fixes as needed
+
+
+
+contact:    doom9.org forum (nick = tritical)

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.cpp	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.cpp	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,647 @@
+/*
+**                     TIsophote v0.9.1 for AviSynth 2.5.x
+**
+**   TIsophote is a simple unconstrained level-set (isophote) smoothing filter.
+**
+**   Copyright (C) 2004 Kevin Stone
+**
+**   This program is free software; you can redistribute it and/or modify
+**   it under the terms of the GNU General Public License as published by
+**   the Free Software Foundation; either version 2 of the License, or
+**   (at your option) any later version.
+**
+**   This program is distributed in the hope that it will be useful,
+**   but WITHOUT ANY WARRANTY; without even the implied warranty of
+**   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**   GNU General Public License for more details.
+**
+**   You should have received a copy of the GNU General Public License
+**   along with this program; if not, write to the Free Software
+**   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+
+#include "TIsophote.h"
+
+PVideoFrame __stdcall TIsophote::GetFrame(int n, IScriptEnvironment* env) 
+{
+	if (n<0) n = 0;
+	else if (n>nfrms) n = nfrms;
+	if (vi.IsYV12()) return(GetFrameYV12(n, env));
+	else return(GetFrameYUY2(n, env));
+}
+
+PVideoFrame __stdcall TIsophote::GetFrameYV12(int n, IScriptEnvironment* env) 
+{
+	PVideoFrame src = child->GetFrame(n, env);
+	PVideoFrame dst1 = env->NewVideoFrame(vi);
+	PVideoFrame dst2 = env->NewVideoFrame(vi);
+	const unsigned char *srcp1 = src->GetReadPtr(PLANAR_Y);
+	int src1_pitch = src->GetPitch(PLANAR_Y);
+	int width = src->GetRowSize(PLANAR_Y) - 1;
+	int height = src->GetHeight(PLANAR_Y) - 1;
+	unsigned char *srcpp, *srcp, *srcpn;
+	unsigned char *dstp1 = dst1->GetWritePtr(PLANAR_Y);
+	int dst1_pitch = dst1->GetPitch(PLANAR_Y);
+	unsigned char *dstp2 = dst2->GetWritePtr(PLANAR_Y);
+	int dst2_pitch = dst2->GetPitch(PLANAR_Y);
+	unsigned char *dstp;
+	double off = 0.0000000001;
+	int x, y, b, dst_pitch, src_pitch, temp;
+	int Ix, Ix2, Iy, Iy2, Ixy, Ixx, Iyy;
+	env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+	env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+	for (b=0; b<iterations; ++b)
+	{
+		if (b&1)
+		{
+			srcp = dstp2 + dst2_pitch;
+			src_pitch = dst2_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp = dstp1 + dst1_pitch;
+			dst_pitch = dst1_pitch;
+		}
+		else
+		{
+			srcp = dstp1 + dst1_pitch;
+			src_pitch = dst1_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp = dstp2 + dst2_pitch;
+			dst_pitch = dst2_pitch;
+		}
+		if (type == 0)
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcp[x+1] - srcp[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x] - srcpp[x];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+					Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+					temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+		else if (type == 1)
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+					Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+					temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+		else
+		{
+			for (y=1; y<height; ++y)
+			{
+				for (x=1; x<width; ++x)
+				{
+					Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+					Ix2 = Ix*Ix;
+					Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+					Iy2 = Iy*Iy;
+					Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+					Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] + 
+						srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+					Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] + 
+						srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+					temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+					if (temp > 255) temp = 255;
+					else if (temp < 0) temp = 0;
+					dstp[x] = temp;
+				}
+				srcpp += src_pitch;
+				srcp += src_pitch;
+				srcpn += src_pitch;
+				dstp += dst_pitch;
+			}
+		}
+	}
+	srcp1 = src->GetReadPtr(PLANAR_U);
+	src1_pitch = src->GetPitch(PLANAR_U);
+	width = src->GetRowSize(PLANAR_U) - 1;
+	height = src->GetHeight(PLANAR_U) - 1;
+	dstp1 = dst1->GetWritePtr(PLANAR_U);
+	dst1_pitch = dst1->GetPitch(PLANAR_U);
+	dstp2 = dst2->GetWritePtr(PLANAR_U);
+	dst2_pitch = dst2->GetPitch(PLANAR_U);
+	if (chroma)
+	{
+		env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		for (b=0; b<iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcp[x+1] - srcp[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] + 
+							srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] + 
+							srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+		srcp1 = src->GetReadPtr(PLANAR_V);
+		dstp1 = dst1->GetWritePtr(PLANAR_V);
+		dstp2 = dst2->GetWritePtr(PLANAR_V);
+		env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		for (b=0; b<iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcp[x+1] - srcp[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcp[x+1] + srcp[x-1] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=1; x<width; ++x)
+					{
+						Ix = srcpp[x+1]+srcp[x+1]+srcp[x+1]+srcpn[x+1]-srcpp[x-1]-srcp[x-1]-srcp[x-1]-srcpn[x-1];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-1]+srcpn[x]+srcpn[x]+srcpn[x+1]-srcpp[x-1]-srcpp[x]-srcpp[x]-srcpp[x+1];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-1] - srcpp[x+1] - srcpn[x-1] + srcpn[x+1];
+						Ixx = srcpp[x+1] + srcp[x+1] + srcp[x+1] + srcpn[x+1] + srcpp[x-1] + srcp[x-1] + 
+							srcp[x-1] + srcpn[x-1] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-1] + srcpp[x] + srcpp[x] + srcpp[x+1] + srcpn[x-1] + srcpn[x] + 
+							srcpn[x] + srcpn[x+1] - (srcp[x-1]<<1) - (srcp[x]<<2) - (srcp[x+1]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+	}
+	else
+	{
+		if (iterations&1) env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		else env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+		srcp1 = src->GetReadPtr(PLANAR_V);
+		dstp1 = dst1->GetWritePtr(PLANAR_V);
+		dstp2 = dst2->GetWritePtr(PLANAR_V);
+		if (iterations&1) env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+		else env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+	}
+	if (iterations&1) return dst2;
+	return dst1;
+}
+
+PVideoFrame __stdcall TIsophote::GetFrameYUY2(int n, IScriptEnvironment* env) 
+{
+	PVideoFrame src = child->GetFrame(n, env);
+	PVideoFrame dst1 = env->NewVideoFrame(vi);
+	PVideoFrame dst2 = env->NewVideoFrame(vi);
+	const unsigned char *srcp1 = src->GetReadPtr();
+	int src1_pitch = src->GetPitch(PLANAR_Y);
+	int width = src->GetRowSize() - 1;
+	int height = src->GetHeight() - 1;
+	unsigned char *srcpp, *srcp, *srcpn;
+	unsigned char *dstp1 = dst1->GetWritePtr();
+	int dst1_pitch = dst1->GetPitch();
+	unsigned char *dstp2 = dst2->GetWritePtr();
+	int dst2_pitch = dst2->GetPitch();
+	unsigned char *dstp;
+	double off = 0.0000000001;
+	int x, y, b, dst_pitch, src_pitch, temp;
+	int Ix, Ix2, Iy, Iy2, Ixy, Ixx, Iyy;
+	env->BitBlt(dstp1,dst1_pitch,srcp1,src1_pitch,width+1,height+1);
+	env->BitBlt(dstp2,dst2_pitch,srcp1,src1_pitch,width+1,height+1);
+	if (!chroma)
+	{
+		for (b=0; b<iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=2; x<width; x+=2)
+					{
+						Ix = srcp[x+2] - srcp[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcp[x+2] + srcp[x-2] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=2; x<width; x+=2)
+					{
+						Ix = srcpp[x+2]+srcp[x+2]+srcp[x+2]+srcpn[x+2]-srcpp[x-2]-srcp[x-2]-srcp[x-2]-srcpn[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-2]+srcpn[x]+srcpn[x]+srcpn[x+2]-srcpp[x-2]-srcpp[x]-srcpp[x]-srcpp[x+2];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcp[x+2] + srcp[x-2] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=2; x<width; x+=2)
+					{
+						Ix = srcpp[x+2]+srcp[x+2]+srcp[x+2]+srcpn[x+2]-srcpp[x-2]-srcp[x-2]-srcp[x-2]-srcpn[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-2]+srcpn[x]+srcpn[x]+srcpn[x+2]-srcpp[x-2]-srcpp[x]-srcpp[x]-srcpp[x+2];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcpp[x+2] + srcp[x+2] + srcp[x+2] + srcpn[x+2] + srcpp[x-2] + srcp[x-2] + 
+							srcp[x-2] + srcpn[x-2] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-2] + srcpp[x] + srcpp[x] + srcpp[x+2] + srcpn[x-2] + srcpn[x] + 
+							srcpn[x] + srcpn[x+2] - (srcp[x-2]<<1) - (srcp[x]<<2) - (srcp[x+2]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+	}
+	else
+	{
+		width -= 3;
+		for (b=0; b<iterations; ++b)
+		{
+			if (b&1)
+			{
+				srcp = dstp2 + dst2_pitch;
+				src_pitch = dst2_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp1 + dst1_pitch;
+				dst_pitch = dst1_pitch;
+			}
+			else
+			{
+				srcp = dstp1 + dst1_pitch;
+				src_pitch = dst1_pitch;
+				srcpp = srcp - src_pitch;
+				srcpn = srcp + src_pitch;
+				dstp = dstp2 + dst2_pitch;
+				dst_pitch = dst2_pitch;
+			}
+			if (type == 0)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=4; x<width; ++x)
+					{
+						Ix = srcp[x+2] - srcp[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcp[x+2] + srcp[x-2] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+						++x;
+						Ix = srcp[x+4] - srcp[x-4];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x] - srcpp[x];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-4] - srcpp[x+4] - srcpn[x-4] + srcpn[x+4];
+						Ixx = srcp[x+4] + srcp[x-4] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else if (type == 1)
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=4; x<width; ++x)
+					{
+						Ix = srcpp[x+2]+srcp[x+2]+srcp[x+2]+srcpn[x+2]-srcpp[x-2]-srcp[x-2]-srcp[x-2]-srcpn[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-2]+srcpn[x]+srcpn[x]+srcpn[x+2]-srcpp[x-2]-srcpp[x]-srcpp[x]-srcpp[x+2];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcp[x+2] + srcp[x-2] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+						++x;
+						Ix = srcpp[x+4]+srcp[x+4]+srcp[x+4]+srcpn[x+4]-srcpp[x-4]-srcp[x-4]-srcp[x-4]-srcpn[x-4];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-4]+srcpn[x]+srcpn[x]+srcpn[x+4]-srcpp[x-4]-srcpp[x]-srcpp[x]-srcpp[x+4];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-4] - srcpp[x+4] - srcpn[x-4] + srcpn[x+4];
+						Ixx = srcp[x+4] + srcp[x-4] - srcp[x] - srcp[x];
+						Iyy = srcpp[x] + srcpn[x] - srcp[x] - srcp[x];
+						temp = srcp[x] + ((int)((((Ix2*Iyy - Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 1) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+			else
+			{
+				for (y=1; y<height; ++y)
+				{
+					for (x=4; x<width; ++x)
+					{
+						Ix = srcpp[x+2]+srcp[x+2]+srcp[x+2]+srcpn[x+2]-srcpp[x-2]-srcp[x-2]-srcp[x-2]-srcpn[x-2];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-2]+srcpn[x]+srcpn[x]+srcpn[x+2]-srcpp[x-2]-srcpp[x]-srcpp[x]-srcpp[x+2];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-2] - srcpp[x+2] - srcpn[x-2] + srcpn[x+2];
+						Ixx = srcpp[x+2] + srcp[x+2] + srcp[x+2] + srcpn[x+2] + srcpp[x-2] + srcp[x-2] + 
+							srcp[x-2] + srcpn[x-2] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-2] + srcpp[x] + srcpp[x] + srcpp[x+2] + srcpn[x-2] + srcpn[x] + 
+							srcpn[x] + srcpn[x+2] - (srcp[x-2]<<1) - (srcp[x]<<2) - (srcp[x+2]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+						++x;
+						Ix = srcpp[x+4]+srcp[x+4]+srcp[x+4]+srcpn[x+4]-srcpp[x-4]-srcp[x-4]-srcp[x-4]-srcpn[x-4];
+						Ix2 = Ix*Ix;
+						Iy = srcpn[x-4]+srcpn[x]+srcpn[x]+srcpn[x+4]-srcpp[x-4]-srcpp[x]-srcpp[x]-srcpp[x+4];
+						Iy2 = Iy*Iy;
+						Ixy = srcpp[x-4] - srcpp[x+4] - srcpn[x-4] + srcpn[x+4];
+						Ixx = srcpp[x+4] + srcp[x+4] + srcp[x+4] + srcpn[x+4] + srcpp[x-4] + srcp[x-4] + 
+							srcp[x-4] + srcpn[x-4] - (srcpp[x]<<1) - (srcp[x]<<2) - (srcpn[x]<<1);
+						Iyy = srcpp[x-4] + srcpp[x] + srcpp[x] + srcpp[x+4] + srcpn[x-4] + srcpn[x] + 
+							srcpn[x] + srcpn[x+4] - (srcp[x-4]<<1) - (srcp[x]<<2) - (srcp[x+4]<<1);
+						temp = srcp[x] + ((int)((((Ix2*Iyy - 4*Ix*Iy*Ixy + Iy2*Ixx)*tStep) / (((Ix2 + Iy2) << 3) + off)) + 0.5f));
+						if (temp > 255) temp = 255;
+						else if (temp < 0) temp = 0;
+						dstp[x] = temp;
+					}
+					srcpp += src_pitch;
+					srcp += src_pitch;
+					srcpn += src_pitch;
+					dstp += dst_pitch;
+				}
+			}
+		}
+	}
+	if (iterations&1) return dst2;
+	return dst1;
+}
+
+AVSValue __cdecl Create_TIsophote(AVSValue args, void* user_data, IScriptEnvironment* env) 
+{
+	int iterations = 4;
+	double tStep = 0.2f;
+	int type = 2;
+	bool chroma = false;
+    return new TIsophote(args[0].AsClip(),
+						args[1].AsInt(iterations),
+						args[2].AsFloat(tStep),
+						args[3].AsInt(type),
+						args[4].AsBool(chroma),
+						env);
+}
+
+extern "C" __declspec(dllexport) const char* __stdcall AvisynthPluginInit2(IScriptEnvironment* env) 
+{
+    env->AddFunction("TIsophote", "c[iterations]i[tStep]f[type]i[chroma]b", Create_TIsophote, 0);
+    return 0;
+}
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.h	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/TIsophote.h	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,55 @@
+/*
+**                     TIsophote v0.9.1 for AviSynth 2.5.x
+**
+**   TIsophote is a simple unconstrained level-set (isophote) smoothing filter.
+**
+**   Copyright (C) 2004 Kevin Stone
+**
+**   This program is free software; you can redistribute it and/or modify
+**   it under the terms of the GNU General Public License as published by
+**   the Free Software Foundation; either version 2 of the License, or
+**   (at your option) any later version.
+**
+**   This program is distributed in the hope that it will be useful,
+**   but WITHOUT ANY WARRANTY; without even the implied warranty of
+**   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**   GNU General Public License for more details.
+**
+**   You should have received a copy of the GNU General Public License
+**   along with this program; if not, write to the Free Software
+**   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+
+#include <windows.h>
+#include "internal.h"
+
+class TIsophote : public GenericVideoFilter
+{
+private:
+	int iterations;
+	double tStep;
+	int type;
+	bool chroma;
+	int nfrms;
+	PVideoFrame __stdcall TIsophote::GetFrameYV12(int n, IScriptEnvironment *env);
+	PVideoFrame __stdcall TIsophote::GetFrameYUY2(int n, IScriptEnvironment *env);
+
+public:
+	PVideoFrame __stdcall TIsophote::GetFrame(int n, IScriptEnvironment *env);
+
+	TIsophote(PClip _child, int _iterations, double _tStep, int _type, bool _chroma, IScriptEnvironment* env) : 
+		GenericVideoFilter(_child), iterations(_iterations), tStep(_tStep), type(_type), chroma(_chroma)
+	{
+		if (!vi.IsYV12() && !vi.IsYUY2())
+			env->ThrowError("TIsophote:  YV12 and YUY2 data only!");
+		if (iterations <= 0)
+			env->ThrowError("TIsophote:  iterations must be set to at least 1!");
+		if (type < 0 || type > 2)
+			env->ThrowError("TIsophote:  type must be set to 0, 1, or 2!");
+		nfrms = vi.num_frames-1;
+	}
+	TIsophote::~TIsophote()
+	{
+		// nothing to free
+	}
+};
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/avisynth.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/avisynth.h	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/avisynth.h	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,711 @@
+// Avisynth v2.5.  Copyright 2002 Ben Rudiak-Gould et al.
+// http://www.avisynth.org
+
+// This program is free software; you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation; either version 2 of the License, or
+// (at your option) any later version.
+//
+// This program is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with this program; if not, write to the Free Software
+// Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA, or visit
+// http://www.gnu.org/copyleft/gpl.html .
+//
+// Linking Avisynth statically or dynamically with other modules is making a
+// combined work based on Avisynth.  Thus, the terms and conditions of the GNU
+// General Public License cover the whole combination.
+//
+// As a special exception, the copyright holders of Avisynth give you
+// permission to link Avisynth with independent modules that communicate with
+// Avisynth solely through the interfaces defined in avisynth.h, regardless of the license
+// terms of these independent modules, and to copy and distribute the
+// resulting combined work under terms of your choice, provided that
+// every copy of the combined work is accompanied by a complete copy of
+// the source code of Avisynth (the version of Avisynth used to produce the
+// combined work), being distributed under the terms of the GNU General
+// Public License plus this exception.  An independent module is a module
+// which is not derived from or based on Avisynth, such as 3rd-party filters,
+// import and export plugins, or graphical user interfaces.
+
+
+
+
+
+#ifndef __AVISYNTH_H__
+#define __AVISYNTH_H__
+
+enum { AVISYNTH_INTERFACE_VERSION = 2 };
+
+
+/* Define all types necessary for interfacing with avisynth.dll
+   Moved from internal.h */
+
+// Win32 API macros, notably the types BYTE, DWORD, ULONG, etc. 
+#include <windef.h>  
+
+// COM interface macros
+#include <objbase.h>
+
+// Raster types used by VirtualDub & Avisynth
+#define in64 (__int64)(unsigned short)
+typedef unsigned long	Pixel;    // this will break on 64-bit machines!
+typedef unsigned long	Pixel32;
+typedef unsigned char Pixel8;
+typedef long			PixCoord;
+typedef	long			PixDim;
+typedef	long			PixOffset;
+
+
+/* Compiler-specific crap */
+
+// Tell MSVC to stop precompiling here
+#ifdef _MSC_VER
+  #pragma hdrstop
+#endif
+
+// Set up debugging macros for MS compilers; for others, step down to the
+// standard <assert.h> interface
+#ifdef _MSC_VER
+  #include <crtdbg.h>
+#else
+  #define _RPT0(a,b) ((void)0)
+  #define _RPT1(a,b,c) ((void)0)
+  #define _RPT2(a,b,c,d) ((void)0)
+  #define _RPT3(a,b,c,d,e) ((void)0)
+  #define _RPT4(a,b,c,d,e,f) ((void)0)
+  
+  #define _ASSERTE(x) assert(x)
+  #include <assert.h>
+#endif
+
+
+
+// I had problems with Premiere wanting 1-byte alignment for its structures,
+// so I now set the Avisynth struct alignment explicitly here.
+#pragma pack(push,8)
+
+#define FRAME_ALIGN 16
+// Default frame alignment is 16 bytes, to help P4, when using SSE2
+
+// The VideoInfo struct holds global information about a clip (i.e.
+// information that does not depend on the frame number).  The GetVideoInfo
+// method in IClip returns this struct.
+
+// Audio Sample information
+typedef float SFLOAT;
+
+enum {SAMPLE_INT8  = 1<<0,
+        SAMPLE_INT16 = 1<<1, 
+        SAMPLE_INT24 = 1<<2,    // Int24 is a very stupid thing to code, but it's supported by some hardware.
+        SAMPLE_INT32 = 1<<3,
+        SAMPLE_FLOAT = 1<<4};
+
+enum {
+   PLANAR_Y=1<<0,
+   PLANAR_U=1<<1,
+   PLANAR_V=1<<2,
+   PLANAR_ALIGNED=1<<3,
+   PLANAR_Y_ALIGNED=PLANAR_Y|PLANAR_ALIGNED,
+   PLANAR_U_ALIGNED=PLANAR_U|PLANAR_ALIGNED,
+   PLANAR_V_ALIGNED=PLANAR_V|PLANAR_ALIGNED,
+  };
+
+struct VideoInfo {
+  int width, height;    // width=0 means no video
+  unsigned fps_numerator, fps_denominator;
+  int num_frames;
+  // This is more extensible than previous versions. More properties can be added seeminglesly.
+
+  // Colorspace properties.
+  enum {
+    CS_BGR = 1<<28,  
+    CS_YUV = 1<<29,
+    CS_INTERLEAVED = 1<<30,
+    CS_PLANAR = 1<<31
+  };
+
+  // Specific colorformats
+  enum { CS_UNKNOWN = 0,
+         CS_BGR24 = 1<<0 | CS_BGR | CS_INTERLEAVED,
+         CS_BGR32 = 1<<1 | CS_BGR | CS_INTERLEAVED,
+         CS_YUY2 = 1<<2 | CS_YUV | CS_INTERLEAVED,
+         CS_YV12 = 1<<3 | CS_YUV | CS_PLANAR,  // y-v-u, planar
+         CS_I420 = 1<<4 | CS_YUV | CS_PLANAR,  // y-u-v, planar
+         CS_IYUV = 1<<4 | CS_YUV | CS_PLANAR  // same as above
+         };
+  int pixel_type;                // changed to int as of 2.5
+  
+
+  int audio_samples_per_second;   // 0 means no audio
+  int sample_type;                // as of 2.5
+  __int64 num_audio_samples;      // changed as of 2.5
+  int nchannels;                  // as of 2.5
+
+  // Imagetype properties
+
+  int image_type;
+
+  enum {
+    IT_BFF = 1<<0,
+    IT_TFF = 1<<1,
+    IT_FIELDBASED = 1<<2
+  };
+
+  // useful functions of the above
+  bool HasVideo() const { return (width!=0); }
+  bool HasAudio() const { return (audio_samples_per_second!=0); }
+  bool IsRGB() const { return !!(pixel_type&CS_BGR); }
+  bool IsRGB24() const { return (pixel_type&CS_BGR24)==CS_BGR24; } // Clear out additional properties
+  bool IsRGB32() const { return (pixel_type & CS_BGR32) == CS_BGR32 ; }
+  bool IsYUV() const { return !!(pixel_type&CS_YUV ); }
+  bool IsYUY2() const { return (pixel_type & CS_YUY2) == CS_YUY2; }  
+  bool IsYV12() const { return ((pixel_type & CS_YV12) == CS_YV12)||((pixel_type & CS_I420) == CS_I420); }
+  bool IsColorSpace(int c_space) const { return ((pixel_type & c_space) == c_space); }
+  bool Is(int property) const { return ((pixel_type & property)==property ); }
+  bool IsPlanar() const { return !!(pixel_type & CS_PLANAR); }
+  bool IsFieldBased() const { return !!(image_type & IT_FIELDBASED); }
+  bool IsParityKnown() const { return ((image_type & IT_FIELDBASED)&&(image_type & (IT_BFF||IT_TFF))); }
+  bool IsBFF() const { return !!(image_type & IT_BFF); }
+  bool IsTFF() const { return !!(image_type & IT_TFF); }
+  
+  bool IsVPlaneFirst() const {return ((pixel_type & CS_YV12) == CS_YV12); }  // Don't use this 
+  int BytesFromPixels(int pixels) const { return pixels * (BitsPerPixel()>>3); }   // Will not work on planar images, but will return only luma planes
+  int RowSize() const { return BytesFromPixels(width); }  // Also only returns first plane on planar images
+  int BMPSize() const { if (IsPlanar()) {int p = height * ((RowSize()+3) & ~3); p+=p>>1; return p;  } return height * ((RowSize()+3) & ~3); }
+  __int64 AudioSamplesFromFrames(__int64 frames) const { return HasVideo() ? ((__int64)(frames) * audio_samples_per_second * fps_denominator / fps_numerator) : 0; }
+  int FramesFromAudioSamples(__int64 samples) const { return (HasAudio()) ? (int)(samples * (__int64)fps_numerator / (__int64)fps_denominator / (__int64)audio_samples_per_second) : 0; }
+  __int64 AudioSamplesFromBytes(__int64 bytes) const { return HasAudio() ? bytes / BytesPerAudioSample() : 0; }
+  __int64 BytesFromAudioSamples(__int64 samples) const { return samples * BytesPerAudioSample(); }
+  int AudioChannels() const { return nchannels; }
+  int SampleType() const{ return sample_type;}
+  bool IsSampleType(int testtype) const{ return !!(sample_type&testtype);}
+  int SamplesPerSecond() const { return audio_samples_per_second; }
+  int BytesPerAudioSample() const { return nchannels*BytesPerChannelSample();}
+  void SetFieldBased(bool isfieldbased)  { if (isfieldbased) image_type|=IT_FIELDBASED; else  image_type&=~IT_FIELDBASED; }
+  void Set(int property)  { image_type|=property; }
+  void Clear(int property)  { image_type&=~property; }
+
+  int BitsPerPixel() const { 
+    switch (pixel_type) {
+      case CS_BGR24:
+        return 24;
+      case CS_BGR32:
+        return 32;
+      case CS_YUY2:
+        return 16;
+      case CS_YV12:
+      case CS_I420:
+        return 12;
+      default:
+        return 0;
+    }
+  }
+  int BytesPerChannelSample() const { 
+    switch (sample_type) {
+    case SAMPLE_INT8:
+      return sizeof(signed char);
+    case SAMPLE_INT16:
+      return sizeof(signed short);
+    case SAMPLE_INT24:
+      return 3;
+    case SAMPLE_INT32:
+      return sizeof(signed int);
+    case SAMPLE_FLOAT:
+      return sizeof(SFLOAT);
+    default:
+      _ASSERTE("Sample type not recognized!");
+      return 0;
+    }
+  }
+
+  // useful mutator
+  void SetFPS(unsigned numerator, unsigned denominator) {
+    unsigned x=numerator, y=denominator;
+    while (y) {   // find gcd
+      unsigned t = x%y; x = y; y = t;
+    }
+    fps_numerator = numerator/x;
+    fps_denominator = denominator/x;
+  }
+  // Test for same colorspace
+  bool IsSameColorspace(const VideoInfo& vi) {
+    if (vi.pixel_type == pixel_type) return TRUE;
+    if (IsYV12() && vi.IsYV12()) return TRUE;
+    return FALSE;
+  }
+
+};
+
+enum {
+  FILTER_TYPE=1,
+  FILTER_INPUT_COLORSPACE=2,
+  FILTER_OUTPUT_TYPE=9,
+  FILTER_NAME=4,
+  FILTER_AUTHOR=5,
+  FILTER_VERSION=6,
+  FILTER_ARGS=7,
+  FILTER_ARGS_INFO=8,
+  FILTER_ARGS_DESCRIPTION=10,
+  FILTER_DESCRIPTION=11,
+};
+enum {  //SUBTYPES
+  FILTER_TYPE_AUDIO=1,
+  FILTER_TYPE_VIDEO=2,
+  FILTER_OUTPUT_TYPE_SAME=3,
+  FILTER_OUTPUT_TYPE_DIFFERENT=4,
+};
+
+
+
+// VideoFrameBuffer holds information about a memory block which is used
+// for video data.  For efficiency, instances of this class are not deleted
+// when the refcount reaches zero; instead they're stored in a linked list
+// to be reused.  The instances are deleted when the corresponding AVS
+// file is closed.
+
+class VideoFrameBuffer {
+  BYTE* const data;
+  const int data_size;
+  // sequence_number is incremented every time the buffer is changed, so
+  // that stale views can tell they're no longer valid.
+  long sequence_number;
+
+  friend class VideoFrame;
+  friend class Cache;
+  friend class ScriptEnvironment;
+  long refcount;
+
+public:
+  VideoFrameBuffer(int size);
+  VideoFrameBuffer();
+  ~VideoFrameBuffer();
+
+  const BYTE* GetReadPtr() const { return data; }
+  BYTE* GetWritePtr() { ++sequence_number; return data; }
+  int GetDataSize() { return data_size; }
+  int GetSequenceNumber() { return sequence_number; }
+  int GetRefcount() { return refcount; }
+};
+
+
+class IClip;
+class PClip;
+class PVideoFrame;
+class IScriptEnvironment;
+class AVSValue;
+
+
+// VideoFrame holds a "window" into a VideoFrameBuffer.  Operator new
+// is overloaded to recycle class instances.
+
+class VideoFrame {
+  int refcount;
+  VideoFrameBuffer* const vfb;
+  const int offset, pitch, row_size, height, offsetU, offsetV, pitchUV;  // U&V offsets are from top of picture.
+
+  friend class PVideoFrame;
+  void AddRef() { InterlockedIncrement((long *)&refcount); }
+  void Release() { if (refcount==1) InterlockedDecrement(&vfb->refcount); InterlockedDecrement((long *)&refcount); }
+
+  friend class ScriptEnvironment;
+  friend class Cache;
+
+  VideoFrame(VideoFrameBuffer* _vfb, int _offset, int _pitch, int _row_size, int _height);
+  VideoFrame(VideoFrameBuffer* _vfb, int _offset, int _pitch, int _row_size, int _height, int _offsetU, int _offsetV, int _pitchUV);
+
+  void* operator new(unsigned size);
+// TESTME: OFFSET U/V may be switched to what could be expected from AVI standard!
+public:
+  int GetPitch() const { return pitch; }
+  int GetPitch(int plane) const { switch (plane) {case PLANAR_U: case PLANAR_V: return pitchUV;} return pitch; }
+  int GetRowSize() const { return row_size; }
+  int GetRowSize(int plane) const { 
+    switch (plane) {
+    case PLANAR_U: case PLANAR_V: if (pitchUV) return row_size>>1; else return 0;
+    case PLANAR_U_ALIGNED: case PLANAR_V_ALIGNED: 
+      if (pitchUV) { 
+        int r = ((row_size+FRAME_ALIGN-1)&(~(FRAME_ALIGN-1)) )>>1; // Aligned rowsize
+        if (r<=pitchUV) 
+          return r; 
+        return row_size>>1; 
+      } else return 0;
+    case PLANAR_Y_ALIGNED:
+      int r = (row_size+FRAME_ALIGN-1)&(~(FRAME_ALIGN-1)); // Aligned rowsize
+      if (r<=pitch) 
+        return r; 
+      return row_size;
+    }
+    return row_size; }
+  int GetHeight() const { return height; }
+  int GetHeight(int plane) const {  switch (plane) {case PLANAR_U: case PLANAR_V: if (pitchUV) return height>>1; return 0;} return height; }
+
+  // generally you shouldn't use these three
+  VideoFrameBuffer* GetFrameBuffer() const { return vfb; }
+  int GetOffset() const { return offset; }
+  int GetOffset(int plane) const { switch (plane) {case PLANAR_U: return offsetU;case PLANAR_V: return offsetV;default: return offset;}; }
+
+  // in plugins use env->SubFrame()
+  VideoFrame* Subframe(int rel_offset, int new_pitch, int new_row_size, int new_height) const;
+  VideoFrame* Subframe(int rel_offset, int new_pitch, int new_row_size, int new_height, int rel_offsetU, int rel_offsetV, int pitchUV) const;
+
+
+  const BYTE* GetReadPtr() const { return vfb->GetReadPtr() + offset; }
+  const BYTE* GetReadPtr(int plane) const { return vfb->GetReadPtr() + GetOffset(plane); }
+
+  bool IsWritable() const { return (refcount == 1 && vfb->refcount == 1); }
+
+  BYTE* GetWritePtr() const {
+    if (vfb->GetRefcount()>1) {
+      _ASSERT(FALSE);
+      //throw AvisynthError("Internal Error - refcount was more than one!");
+    }
+    return IsWritable() ? (vfb->GetWritePtr() + offset) : 0;
+  }
+
+  BYTE* GetWritePtr(int plane) const {
+    if (plane==PLANAR_Y) {
+      if (vfb->GetRefcount()>1) {
+        _ASSERT(FALSE);
+//        throw AvisynthError("Internal Error - refcount was more than one!");
+      }
+      return IsWritable() ? vfb->GetWritePtr() + GetOffset(plane) : 0;
+    }
+    return vfb->data + GetOffset(plane);
+  }
+
+  ~VideoFrame() { InterlockedDecrement(&vfb->refcount); }
+};
+
+enum {
+  CACHE_NOTHING=0,
+  CACHE_RANGE=1,
+  CACHE_ALL=2,
+  CACHE_AUDIO=3
+ };
+
+// Base class for all filters.
+class IClip {
+  friend class PClip;
+  friend class AVSValue;
+  int refcnt;
+  void AddRef() { InterlockedIncrement((long *)&refcnt); }
+  void Release() { InterlockedDecrement((long *)&refcnt); if (!refcnt) delete this; }
+public:
+  IClip() : refcnt(0) {}
+
+  virtual int __stdcall GetVersion() { return AVISYNTH_INTERFACE_VERSION; }
+  
+  virtual PVideoFrame __stdcall GetFrame(int n, IScriptEnvironment* env) = 0;
+  virtual bool __stdcall GetParity(int n) = 0;  // return field parity if field_based, else parity of first field in frame
+  virtual void __stdcall GetAudio(void* buf, __int64 start, __int64 count, IScriptEnvironment* env) = 0;  // start and count are in samples
+  virtual void __stdcall SetCacheHints(int cachehints,int frame_range) = 0 ;  // We do not pass cache requests upwards, only to the next filter.
+  virtual const VideoInfo& __stdcall GetVideoInfo() = 0;
+  virtual __stdcall ~IClip() {}
+};
+
+
+// smart pointer to IClip
+class PClip {
+
+  IClip* p;
+
+  IClip* GetPointerWithAddRef() const { if (p) p->AddRef(); return p; }
+  friend class AVSValue;
+  friend class VideoFrame;
+
+  void Init(IClip* x) {
+    if (x) x->AddRef();
+    p=x;
+  }
+  void Set(IClip* x) {
+    if (x) x->AddRef();
+    if (p) p->Release();
+    p=x;
+  }
+
+public:
+  PClip() { p = 0; }
+  PClip(const PClip& x) { Init(x.p); }
+  PClip(IClip* x) { Init(x); }
+  void operator=(IClip* x) { Set(x); }
+  void operator=(const PClip& x) { Set(x.p); }
+
+  IClip* operator->() const { return p; }
+
+  // useful in conditional expressions
+  operator void*() const { return p; }
+  bool operator!() const { return !p; }
+
+  ~PClip() { if (p) p->Release(); }
+};
+
+
+// smart pointer to VideoFrame
+class PVideoFrame {
+
+  VideoFrame* p;
+
+  void Init(VideoFrame* x) {
+    if (x) x->AddRef();
+    p=x;
+  }
+  void Set(VideoFrame* x) {
+    if (x) x->AddRef();
+    if (p) p->Release();
+    p=x;
+  }
+
+public:
+  PVideoFrame() { p = 0; }
+  PVideoFrame(const PVideoFrame& x) { Init(x.p); }
+  PVideoFrame(VideoFrame* x) { Init(x); }
+  void operator=(VideoFrame* x) { Set(x); }
+  void operator=(const PVideoFrame& x) { Set(x.p); }
+
+  VideoFrame* operator->() const { return p; }
+
+  // for conditional expressions
+  operator void*() const { return p; }
+  bool operator!() const { return !p; }
+
+  ~PVideoFrame() { if (p) p->Release();}
+};
+
+
+class AVSValue {
+public:
+
+  AVSValue() { type = 'v'; }
+  AVSValue(IClip* c) { type = 'c'; clip = c; if (c) c->AddRef(); }
+  AVSValue(const PClip& c) { type = 'c'; clip = c.GetPointerWithAddRef(); }
+  AVSValue(bool b) { type = 'b'; boolean = b; }
+  AVSValue(int i) { type = 'i'; integer = i; }
+//  AVSValue(__int64 l) { type = 'l'; longlong = l; }
+  AVSValue(float f) { type = 'f'; floating_pt = f; }
+  AVSValue(double f) { type = 'f'; floating_pt = float(f); }
+  AVSValue(const char* s) { type = 's'; string = s; }
+  AVSValue(const AVSValue* a, int size) { type = 'a'; array = a; array_size = size; }
+  AVSValue(const AVSValue& v) { Assign(&v, true); }
+
+  ~AVSValue() { if (IsClip() && clip) clip->Release(); }
+  AVSValue& operator=(const AVSValue& v) { Assign(&v, false); return *this; }
+
+  // Note that we transparently allow 'int' to be treated as 'float'.
+  // There are no int<->bool conversions, though.
+
+  bool Defined() const { return type != 'v'; }
+  bool IsClip() const { return type == 'c'; }
+  bool IsBool() const { return type == 'b'; }
+  bool IsInt() const { return type == 'i'; }
+//  bool IsLong() const { return (type == 'l'|| type == 'i'); }
+  bool IsFloat() const { return type == 'f' || type == 'i'; }
+  bool IsString() const { return type == 's'; }
+  bool IsArray() const { return type == 'a'; }
+
+  PClip AsClip() const { _ASSERTE(IsClip()); return IsClip()?clip:0; }
+  bool AsBool() const { _ASSERTE(IsBool()); return boolean; }
+  int AsInt() const { _ASSERTE(IsInt()); return integer; }   
+//  int AsLong() const { _ASSERTE(IsLong()); return longlong; } 
+  const char* AsString() const { _ASSERTE(IsString()); return IsString()?string:0; }
+  double AsFloat() const { _ASSERTE(IsFloat()); return IsInt()?integer:floating_pt; }
+
+  bool AsBool(bool def) const { _ASSERTE(IsBool()||!Defined()); return IsBool() ? boolean : def; }
+  int AsInt(int def) const { _ASSERTE(IsInt()||!Defined()); return IsInt() ? integer : def; }
+  double AsFloat(double def) const { _ASSERTE(IsFloat()||!Defined()); return IsInt() ? integer : type=='f' ? floating_pt : def; }
+  const char* AsString(const char* def) const { _ASSERTE(IsString()||!Defined()); return IsString() ? string : def; }
+
+  int ArraySize() const { _ASSERTE(IsArray()); return IsArray()?array_size:1; }
+
+  const AVSValue& operator[](int index) const {
+    _ASSERTE(IsArray() && index>=0 && index<array_size);
+    return (IsArray() && index>=0 && index<array_size) ? array[index] : *this;
+  }
+
+private:
+
+  short type;  // 'a'rray, 'c'lip, 'b'ool, 'i'nt, 'f'loat, 's'tring, 'v'oid, or 'l'ong
+  short array_size;
+  union {
+    IClip* clip;
+    bool boolean;
+    int integer;
+    float floating_pt;
+    const char* string;
+    const AVSValue* array;
+//    __int64 longlong;
+  };
+
+  void Assign(const AVSValue* src, bool init) {
+    if (src->IsClip() && src->clip)
+      src->clip->AddRef();
+    if (!init && IsClip() && clip)
+      clip->Release();
+    // make sure this copies the whole struct!
+    ((__int32*)this)[0] = ((__int32*)src)[0];
+    ((__int32*)this)[1] = ((__int32*)src)[1];
+  }
+};
+
+
+// instantiable null filter
+class GenericVideoFilter : public IClip {
+protected:
+  PClip child;
+  VideoInfo vi;
+public:
+  GenericVideoFilter(PClip _child) : child(_child) { vi = child->GetVideoInfo(); }
+  PVideoFrame __stdcall GetFrame(int n, IScriptEnvironment* env) { return child->GetFrame(n, env); }
+  void __stdcall GetAudio(void* buf, __int64 start, __int64 count, IScriptEnvironment* env) { child->GetAudio(buf, start, count, env); }
+  const VideoInfo& __stdcall GetVideoInfo() { return vi; }
+  bool __stdcall GetParity(int n) { return child->GetParity(n); }
+  void __stdcall SetCacheHints(int cachehints,int frame_range) { } ;  // We do not pass cache requests upwards, only to the next filter.
+};
+
+
+class AvisynthError /* exception */ {
+public:
+  const char* const msg;
+  AvisynthError(const char* _msg) : msg(_msg) {}
+};
+
+
+
+
+/* Helper classes useful to plugin authors */
+
+class AlignPlanar : public GenericVideoFilter 
+{
+public:
+  AlignPlanar(PClip _clip);
+  static PClip Create(PClip clip);
+  PVideoFrame __stdcall GetFrame(int n, IScriptEnvironment* env);
+};
+
+
+
+class FillBorder : public GenericVideoFilter 
+{
+public:
+  FillBorder(PClip _clip);
+  static PClip Create(PClip clip);
+  PVideoFrame __stdcall GetFrame(int n, IScriptEnvironment* env);
+};
+
+
+
+class ConvertAudio : public GenericVideoFilter 
+/**
+  * Helper class to convert audio to any format
+ **/
+{
+public:
+  ConvertAudio(PClip _clip, int prefered_format);
+  void __stdcall GetAudio(void* buf, __int64 start, __int64 count, IScriptEnvironment* env);
+
+  static PClip Create(PClip clip, int sample_type, int prefered_type);
+  static AVSValue __cdecl Create_float(AVSValue args, void*, IScriptEnvironment*);
+  static AVSValue __cdecl Create_32bit(AVSValue args, void*, IScriptEnvironment*);
+  static AVSValue __cdecl Create_24bit(AVSValue args, void*, IScriptEnvironment*);
+  static AVSValue __cdecl Create_16bit(AVSValue args, void*, IScriptEnvironment*);
+  static AVSValue __cdecl Create_8bit(AVSValue args, void*, IScriptEnvironment*);
+  virtual ~ConvertAudio()
+  {if (tempbuffer_size) {delete[] tempbuffer;tempbuffer_size=0;}}
+private:
+  void convertToFloat(char* inbuf, float* outbuf, char sample_type, int count);
+  void convertFromFloat(float* inbuf, void* outbuf, char sample_type, int count);
+
+  __inline int Saturate_int8(float n);
+  __inline short Saturate_int16(float n);
+  __inline int Saturate_int24(float n);
+  __inline int Saturate_int32(float n);
+
+  char src_format;
+  char dst_format;
+  int src_bps;
+  char *tempbuffer;
+  SFLOAT *floatbuffer;
+  int tempbuffer_size;
+};
+
+
+// For GetCPUFlags.  These are backwards-compatible with those in VirtualDub.
+enum {                    
+                    /* slowest CPU to support extension */
+  CPUF_FORCE			  = 0x01,   // N/A
+  CPUF_FPU			    = 0x02,   // 386/486DX
+  CPUF_MMX			    = 0x04,   // P55C, K6, PII
+  CPUF_INTEGER_SSE	= 0x08,		// PIII, Athlon
+  CPUF_SSE			    = 0x10,		// PIII, Athlon XP/MP
+  CPUF_SSE2			    = 0x20,		// PIV, Hammer
+  CPUF_3DNOW			  = 0x40,   // K6-2
+  CPUF_3DNOW_EXT		= 0x80,		// Athlon
+  CPUF_X86_64       = 0xA0,   // Hammer (note: equiv. to 3DNow + SSE2, which only Hammer
+                              //         will have anyway)
+};
+#define MAX_INT 0x7fffffff
+#define MIN_INT -0x7fffffff
+
+
+
+class IScriptEnvironment {
+public:
+  virtual __stdcall ~IScriptEnvironment() {}
+
+  virtual /*static*/ long __stdcall GetCPUFlags() = 0;
+
+  virtual char* __stdcall SaveString(const char* s, int length = -1) = 0;
+  virtual char* __stdcall Sprintf(const char* fmt, ...) = 0;
+  // note: val is really a va_list; I hope everyone typedefs va_list to a pointer
+  virtual char* __stdcall VSprintf(const char* fmt, void* val) = 0;
+
+  __declspec(noreturn) virtual void __stdcall ThrowError(const char* fmt, ...) = 0;
+
+  class NotFound /*exception*/ {};  // thrown by Invoke and GetVar
+
+  typedef AVSValue (__cdecl *ApplyFunc)(AVSValue args, void* user_data, IScriptEnvironment* env);
+
+  virtual void __stdcall AddFunction(const char* name, const char* params, ApplyFunc apply, void* user_data) = 0;
+  virtual bool __stdcall FunctionExists(const char* name) = 0;
+  virtual AVSValue __stdcall Invoke(const char* name, const AVSValue args, const char** arg_names=0) = 0;
+
+  virtual AVSValue __stdcall GetVar(const char* name) = 0;
+  virtual bool __stdcall SetVar(const char* name, const AVSValue& val) = 0;
+  virtual bool __stdcall SetGlobalVar(const char* name, const AVSValue& val) = 0;
+
+  virtual void __stdcall PushContext(int level=0) = 0;
+  virtual void __stdcall PopContext() = 0;
+
+  // align should be 4 or 8
+  virtual PVideoFrame __stdcall NewVideoFrame(const VideoInfo& vi, int align=FRAME_ALIGN) = 0;
+
+  virtual bool __stdcall MakeWritable(PVideoFrame* pvf) = 0;
+
+  virtual /*static*/ void __stdcall BitBlt(BYTE* dstp, int dst_pitch, const BYTE* srcp, int src_pitch, int row_size, int height) = 0;
+
+  typedef void (__cdecl *ShutdownFunc)(void* user_data, IScriptEnvironment* env);
+  virtual void __stdcall AtExit(ShutdownFunc function, void* user_data) = 0;
+
+  virtual void __stdcall CheckVersion(int version = AVISYNTH_INTERFACE_VERSION) = 0;
+
+  virtual PVideoFrame __stdcall Subframe(PVideoFrame src, int rel_offset, int new_pitch, int new_row_size, int new_height) = 0;
+
+	virtual int __stdcall SetMemoryMax(int mem) = 0;
+
+  virtual int __stdcall SetWorkingDir(const char * newdir) = 0;
+
+};
+
+
+// avisynth.dll exports this; it's a way to use it as a library, without
+// writing an AVS script or without going through AVIFile.
+IScriptEnvironment* __stdcall CreateScriptEnvironment(int version = AVISYNTH_INTERFACE_VERSION);
+
+
+#pragma pack(pop)
+
+#endif //__AVISYNTH_H__

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/gpl.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/gpl.txt	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/gpl.txt	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,340 @@
+		    GNU GENERAL PUBLIC LICENSE
+		       Version 2, June 1991
+
+ Copyright (C) 1989, 1991 Free Software Foundation, Inc.
+                       59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ Everyone is permitted to copy and distribute verbatim copies
+ of this license document, but changing it is not allowed.
+
+			    Preamble
+
+  The licenses for most software are designed to take away your
+freedom to share and change it.  By contrast, the GNU General Public
+License is intended to guarantee your freedom to share and change free
+software--to make sure the software is free for all its users.  This
+General Public License applies to most of the Free Software
+Foundation's software and to any other program whose authors commit to
+using it.  (Some other Free Software Foundation software is covered by
+the GNU Library General Public License instead.)  You can apply it to
+your programs, too.
+
+  When we speak of free software, we are referring to freedom, not
+price.  Our General Public Licenses are designed to make sure that you
+have the freedom to distribute copies of free software (and charge for
+this service if you wish), that you receive source code or can get it
+if you want it, that you can change the software or use pieces of it
+in new free programs; and that you know you can do these things.
+
+  To protect your rights, we need to make restrictions that forbid
+anyone to deny you these rights or to ask you to surrender the rights.
+These restrictions translate to certain responsibilities for you if you
+distribute copies of the software, or if you modify it.
+
+  For example, if you distribute copies of such a program, whether
+gratis or for a fee, you must give the recipients all the rights that
+you have.  You must make sure that they, too, receive or can get the
+source code.  And you must show them these terms so they know their
+rights.
+
+  We protect your rights with two steps: (1) copyright the software, and
+(2) offer you this license which gives you legal permission to copy,
+distribute and/or modify the software.
+
+  Also, for each author's protection and ours, we want to make certain
+that everyone understands that there is no warranty for this free
+software.  If the software is modified by someone else and passed on, we
+want its recipients to know that what they have is not the original, so
+that any problems introduced by others will not reflect on the original
+authors' reputations.
+
+  Finally, any free program is threatened constantly by software
+patents.  We wish to avoid the danger that redistributors of a free
+program will individually obtain patent licenses, in effect making the
+program proprietary.  To prevent this, we have made it clear that any
+patent must be licensed for everyone's free use or not licensed at all.
+
+  The precise terms and conditions for copying, distribution and
+modification follow.
+
+		    GNU GENERAL PUBLIC LICENSE
+   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
+
+  0. This License applies to any program or other work which contains
+a notice placed by the copyright holder saying it may be distributed
+under the terms of this General Public License.  The "Program", below,
+refers to any such program or work, and a "work based on the Program"
+means either the Program or any derivative work under copyright law:
+that is to say, a work containing the Program or a portion of it,
+either verbatim or with modifications and/or translated into another
+language.  (Hereinafter, translation is included without limitation in
+the term "modification".)  Each licensee is addressed as "you".
+
+Activities other than copying, distribution and modification are not
+covered by this License; they are outside its scope.  The act of
+running the Program is not restricted, and the output from the Program
+is covered only if its contents constitute a work based on the
+Program (independent of having been made by running the Program).
+Whether that is true depends on what the Program does.
+
+  1. You may copy and distribute verbatim copies of the Program's
+source code as you receive it, in any medium, provided that you
+conspicuously and appropriately publish on each copy an appropriate
+copyright notice and disclaimer of warranty; keep intact all the
+notices that refer to this License and to the absence of any warranty;
+and give any other recipients of the Program a copy of this License
+along with the Program.
+
+You may charge a fee for the physical act of transferring a copy, and
+you may at your option offer warranty protection in exchange for a fee.
+
+  2. You may modify your copy or copies of the Program or any portion
+of it, thus forming a work based on the Program, and copy and
+distribute such modifications or work under the terms of Section 1
+above, provided that you also meet all of these conditions:
+
+    a) You must cause the modified files to carry prominent notices
+    stating that you changed the files and the date of any change.
+
+    b) You must cause any work that you distribute or publish, that in
+    whole or in part contains or is derived from the Program or any
+    part thereof, to be licensed as a whole at no charge to all third
+    parties under the terms of this License.
+
+    c) If the modified program normally reads commands interactively
+    when run, you must cause it, when started running for such
+    interactive use in the most ordinary way, to print or display an
+    announcement including an appropriate copyright notice and a
+    notice that there is no warranty (or else, saying that you provide
+    a warranty) and that users may redistribute the program under
+    these conditions, and telling the user how to view a copy of this
+    License.  (Exception: if the Program itself is interactive but
+    does not normally print such an announcement, your work based on
+    the Program is not required to print an announcement.)
+
+These requirements apply to the modified work as a whole.  If
+identifiable sections of that work are not derived from the Program,
+and can be reasonably considered independent and separate works in
+themselves, then this License, and its terms, do not apply to those
+sections when you distribute them as separate works.  But when you
+distribute the same sections as part of a whole which is a work based
+on the Program, the distribution of the whole must be on the terms of
+this License, whose permissions for other licensees extend to the
+entire whole, and thus to each and every part regardless of who wrote it.
+
+Thus, it is not the intent of this section to claim rights or contest
+your rights to work written entirely by you; rather, the intent is to
+exercise the right to control the distribution of derivative or
+collective works based on the Program.
+
+In addition, mere aggregation of another work not based on the Program
+with the Program (or with a work based on the Program) on a volume of
+a storage or distribution medium does not bring the other work under
+the scope of this License.
+
+  3. You may copy and distribute the Program (or a work based on it,
+under Section 2) in object code or executable form under the terms of
+Sections 1 and 2 above provided that you also do one of the following:
+
+    a) Accompany it with the complete corresponding machine-readable
+    source code, which must be distributed under the terms of Sections
+    1 and 2 above on a medium customarily used for software interchange; or,
+
+    b) Accompany it with a written offer, valid for at least three
+    years, to give any third party, for a charge no more than your
+    cost of physically performing source distribution, a complete
+    machine-readable copy of the corresponding source code, to be
+    distributed under the terms of Sections 1 and 2 above on a medium
+    customarily used for software interchange; or,
+
+    c) Accompany it with the information you received as to the offer
+    to distribute corresponding source code.  (This alternative is
+    allowed only for noncommercial distribution and only if you
+    received the program in object code or executable form with such
+    an offer, in accord with Subsection b above.)
+
+The source code for a work means the preferred form of the work for
+making modifications to it.  For an executable work, complete source
+code means all the source code for all modules it contains, plus any
+associated interface definition files, plus the scripts used to
+control compilation and installation of the executable.  However, as a
+special exception, the source code distributed need not include
+anything that is normally distributed (in either source or binary
+form) with the major components (compiler, kernel, and so on) of the
+operating system on which the executable runs, unless that component
+itself accompanies the executable.
+
+If distribution of executable or object code is made by offering
+access to copy from a designated place, then offering equivalent
+access to copy the source code from the same place counts as
+distribution of the source code, even though third parties are not
+compelled to copy the source along with the object code.
+
+  4. You may not copy, modify, sublicense, or distribute the Program
+except as expressly provided under this License.  Any attempt
+otherwise to copy, modify, sublicense or distribute the Program is
+void, and will automatically terminate your rights under this License.
+However, parties who have received copies, or rights, from you under
+this License will not have their licenses terminated so long as such
+parties remain in full compliance.
+
+  5. You are not required to accept this License, since you have not
+signed it.  However, nothing else grants you permission to modify or
+distribute the Program or its derivative works.  These actions are
+prohibited by law if you do not accept this License.  Therefore, by
+modifying or distributing the Program (or any work based on the
+Program), you indicate your acceptance of this License to do so, and
+all its terms and conditions for copying, distributing or modifying
+the Program or works based on it.
+
+  6. Each time you redistribute the Program (or any work based on the
+Program), the recipient automatically receives a license from the
+original licensor to copy, distribute or modify the Program subject to
+these terms and conditions.  You may not impose any further
+restrictions on the recipients' exercise of the rights granted herein.
+You are not responsible for enforcing compliance by third parties to
+this License.
+
+  7. If, as a consequence of a court judgment or allegation of patent
+infringement or for any other reason (not limited to patent issues),
+conditions are imposed on you (whether by court order, agreement or
+otherwise) that contradict the conditions of this License, they do not
+excuse you from the conditions of this License.  If you cannot
+distribute so as to satisfy simultaneously your obligations under this
+License and any other pertinent obligations, then as a consequence you
+may not distribute the Program at all.  For example, if a patent
+license would not permit royalty-free redistribution of the Program by
+all those who receive copies directly or indirectly through you, then
+the only way you could satisfy both it and this License would be to
+refrain entirely from distribution of the Program.
+
+If any portion of this section is held invalid or unenforceable under
+any particular circumstance, the balance of the section is intended to
+apply and the section as a whole is intended to apply in other
+circumstances.
+
+It is not the purpose of this section to induce you to infringe any
+patents or other property right claims or to contest validity of any
+such claims; this section has the sole purpose of protecting the
+integrity of the free software distribution system, which is
+implemented by public license practices.  Many people have made
+generous contributions to the wide range of software distributed
+through that system in reliance on consistent application of that
+system; it is up to the author/donor to decide if he or she is willing
+to distribute software through any other system and a licensee cannot
+impose that choice.
+
+This section is intended to make thoroughly clear what is believed to
+be a consequence of the rest of this License.
+
+  8. If the distribution and/or use of the Program is restricted in
+certain countries either by patents or by copyrighted interfaces, the
+original copyright holder who places the Program under this License
+may add an explicit geographical distribution limitation excluding
+those countries, so that distribution is permitted only in or among
+countries not thus excluded.  In such case, this License incorporates
+the limitation as if written in the body of this License.
+
+  9. The Free Software Foundation may publish revised and/or new versions
+of the General Public License from time to time.  Such new versions will
+be similar in spirit to the present version, but may differ in detail to
+address new problems or concerns.
+
+Each version is given a distinguishing version number.  If the Program
+specifies a version number of this License which applies to it and "any
+later version", you have the option of following the terms and conditions
+either of that version or of any later version published by the Free
+Software Foundation.  If the Program does not specify a version number of
+this License, you may choose any version ever published by the Free Software
+Foundation.
+
+  10. If you wish to incorporate parts of the Program into other free
+programs whose distribution conditions are different, write to the author
+to ask for permission.  For software which is copyrighted by the Free
+Software Foundation, write to the Free Software Foundation; we sometimes
+make exceptions for this.  Our decision will be guided by the two goals
+of preserving the free status of all derivatives of our free software and
+of promoting the sharing and reuse of software generally.
+
+			    NO WARRANTY
+
+  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
+FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
+OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
+PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
+OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
+MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
+TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
+PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
+REPAIR OR CORRECTION.
+
+  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
+WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
+REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
+INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
+OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
+TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
+YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
+PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGES.
+
+		     END OF TERMS AND CONDITIONS
+
+	    How to Apply These Terms to Your New Programs
+
+  If you develop a new program, and you want it to be of the greatest
+possible use to the public, the best way to achieve this is to make it
+free software which everyone can redistribute and change under these terms.
+
+  To do so, attach the following notices to the program.  It is safest
+to attach them to the start of each source file to most effectively
+convey the exclusion of warranty; and each file should have at least
+the "copyright" line and a pointer to where the full notice is found.
+
+    <one line to give the program's name and a brief idea of what it does.>
+    Copyright (C) <year>  <name of author>
+
+    This program is free software; you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation; either version 2 of the License, or
+    (at your option) any later version.
+
+    This program is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with this program; if not, write to the Free Software
+    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+
+Also add information on how to contact you by electronic and paper mail.
+
+If the program is interactive, make it output a short notice like this
+when it starts in an interactive mode:
+
+    Gnomovision version 69, Copyright (C) year name of author
+    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
+    This is free software, and you are welcome to redistribute it
+    under certain conditions; type `show c' for details.
+
+The hypothetical commands `show w' and `show c' should show the appropriate
+parts of the General Public License.  Of course, the commands you use may
+be called something other than `show w' and `show c'; they could even be
+mouse-clicks or menu items--whatever suits your program.
+
+You should also get your employer (if you work as a programmer) or your
+school, if any, to sign a "copyright disclaimer" for the program, if
+necessary.  Here is a sample; alter the names:
+
+  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
+  `Gnomovision' (which makes passes at compilers) written by James Hacker.
+
+  <signature of Ty Coon>, 1 April 1989
+  Ty Coon, President of Vice
+
+This General Public License does not permit incorporating your program into
+proprietary programs.  If your program is a subroutine library, you may
+consider it more useful to permit linking proprietary applications with the
+library.  If this is what you want to do, use the GNU Library General
+Public License instead of this License.

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/internal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/internal.h	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/internal.h	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,115 @@
+// Avisynth v2.5.  Copyright 2002 Ben Rudiak-Gould et al.
+// http://www.avisynth.org
+
+// This program is free software; you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation; either version 2 of the License, or
+// (at your option) any later version.
+//
+// This program is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with this program; if not, write to the Free Software
+// Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA, or visit
+// http://www.gnu.org/copyleft/gpl.html .
+//
+// Linking Avisynth statically or dynamically with other modules is making a
+// combined work based on Avisynth.  Thus, the terms and conditions of the GNU
+// General Public License cover the whole combination.
+//
+// As a special exception, the copyright holders of Avisynth give you
+// permission to link Avisynth with independent modules that communicate with
+// Avisynth solely through the interfaces defined in avisynth.h, regardless of the license
+// terms of these independent modules, and to copy and distribute the
+// resulting combined work under terms of your choice, provided that
+// every copy of the combined work is accompanied by a complete copy of
+// the source code of Avisynth (the version of Avisynth used to produce the
+// combined work), being distributed under the terms of the GNU General
+// Public License plus this exception.  An independent module is a module
+// which is not derived from or based on Avisynth, such as 3rd-party filters,
+// import and export plugins, or graphical user interfaces.
+
+
+#ifndef __Internal_H__
+#define __Internal_H__
+
+#define AVS_VERSION 2.54
+#define AVS_VERSTR "AviSynth 2.54, build:"__DATE__" ["__TIME__"]"
+
+
+#include "avisynth.h"
+
+
+
+struct AVSFunction {
+  const char* name;
+  const char* param_types;
+  AVSValue (__cdecl *apply)(AVSValue args, void* user_data, IScriptEnvironment* env);
+  void* user_data;
+};
+
+
+int RGB2YUV(int rgb);
+
+PClip Create_MessageClip(const char* message, int width, int height,
+  int pixel_type, bool shrink, int textcolor, int halocolor, int bgcolor,
+  IScriptEnvironment* env);
+
+PClip new_Splice(PClip _child1, PClip _child2, bool realign_sound, IScriptEnvironment* env);
+PClip new_SeparateFields(PClip _child, IScriptEnvironment* env);
+PClip new_AssumeFrameBased(PClip _child);
+
+void BitBlt(BYTE* dstp, int dst_pitch, const BYTE* srcp, 
+            int src_pitch, int row_size, int height);
+
+  void asm_BitBlt_ISSE(BYTE* dstp, int dst_pitch, const BYTE* srcp, int src_pitch, int row_size, int height);
+  void asm_BitBlt_MMX(BYTE* dstp, int dst_pitch, const BYTE* srcp, int src_pitch, int row_size, int height);
+
+long GetCPUFlags();
+
+
+class _PixelClip {
+  enum { buffer=320 };
+  BYTE clip[256+buffer*2];
+public:
+  _PixelClip() {  
+    memset(clip, 0, buffer);
+    for (int i=0; i<256; ++i) clip[i+buffer] = i;
+    memset(clip+buffer+256, 255, buffer);
+  }
+  BYTE operator()(int i) { return clip[i+buffer]; }
+};
+
+extern _PixelClip PixelClip;
+
+
+template<class ListNode>
+static __inline void Relink(ListNode* newprev, ListNode* me, ListNode* newnext) {
+  if (me == newprev || me == newnext) return;
+  me->next->prev = me->prev;
+  me->prev->next = me->next;
+  me->prev = newprev;
+  me->next = newnext;
+  me->prev->next = me->next->prev = me;
+}
+
+
+
+/*** Inline helper methods ***/
+
+
+static __inline BYTE ScaledPixelClip(int i) {
+  return PixelClip((i+32768) >> 16);
+}
+
+
+static __inline bool IsClose(int a, int b, unsigned threshold) 
+  { return (unsigned(a-b+threshold) <= threshold*2); }
+
+
+
+
+#endif  // __Internal_H__
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/resource.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/resource.h	2008-06-16 17:49:32 UTC (rev 4111)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/original/resource.h	2008-06-16 18:07:45 UTC (rev 4112)
@@ -0,0 +1,14 @@
+//{{NO_DEPENDENCIES}}
+// Microsoft Visual C++ generated include file.
+// Used by TIsophote.rc
+
+// Next default values for new objects
+// 
+#ifdef APSTUDIO_INVOKED
+#ifndef APSTUDIO_READONLY_SYMBOLS
+#define _APS_NEXT_RESOURCE_VALUE        101
+#define _APS_NEXT_COMMAND_VALUE         40001
+#define _APS_NEXT_CONTROL_VALUE         1001
+#define _APS_NEXT_SYMED_VALUE           101
+#endif
+#endif



From gruntster at mail.berlios.de  Tue Jun 17 02:03:48 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 02:03:48 +0200
Subject: [Avidemux-svn-commit] r4113 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200806170003.m5H03mmi000196@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 02:03:41 +0200 (Tue, 17 Jun 2008)
New Revision: 4113

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c
Log:
[amrnb] late binding fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c	2008-06-16 18:07:45 UTC (rev 4112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libamr.c	2008-06-17 00:03:41 UTC (rev 4113)
@@ -430,7 +430,7 @@
 {
     AMRContext *s = avctx->priv_data;
 
-    Decoder_Interface_exit(s->decState);
+    Decoder_Interface_exit_(getAmrnbWrapper(), s->decState);
     return 0;
 }
 
@@ -438,7 +438,7 @@
 {
     AMRContext *s = avctx->priv_data;
 
-    Encoder_Interface_exit(s->enstate);
+    Encoder_Interface_exit_(getAmrnbWrapper(), s->enstate);
     av_freep(&avctx->coded_frame);
     return 0;
 }



From gruntster at mail.berlios.de  Tue Jun 17 04:15:44 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 04:15:44 +0200
Subject: [Avidemux-svn-commit] r4114 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_filter
	ADM_osSupport ADM_script ADM_toolkit
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
	ADM_userInterfaces/ADM_NONE/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200806170215.m5H2FiXS008319@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 04:15:24 +0200 (Tue, 17 Jun 2008)
New Revision: 4114

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_saveload.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemux.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_toolkit/filesel.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gtkgui.h
Log:
[DND] fix GTK drag and drop for Win32 and Qt4 for Linux (FS#366)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_saveload.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_saveload.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_saveload.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -63,12 +63,12 @@
 /**
 	Xml Read/write ConfCouple from files
 */
-void filterSaveXml(char *docname)
+void filterSaveXml(const char *docname)
 {
 	filterSaveXml(docname,0);
 }
 
-void filterSaveXml(char *docname,uint8_t silent)
+void filterSaveXml(const char *docname,uint8_t silent)
 {
  xmlDocPtr xdoc;
  xmlNodePtr node;
@@ -136,12 +136,12 @@
 		xmlFreeDoc(xdoc);
 	return ;
 }
-void filterLoadXml(char *docname)
+void filterLoadXml(const char *docname)
 {
 	filterLoadXml(docname,0);
 }
 
-int filterLoadXml(char *docname,uint8_t silent)
+int filterLoadXml(const char *docname,uint8_t silent)
 {
  xmlDocPtr xdoc;
  xmlNodePtr node,subnode;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-17 02:15:24 UTC (rev 4114)
@@ -179,15 +179,15 @@
   void	filterSetPostProc( void );
   
 #ifdef USE_LIBXML2
-void filterSaveXml(char *name);
-void filterSaveXml(char *name,uint8_t silent);
-void filterLoadXml(char *name);
-int  filterLoadXml(char *name,uint8_t silent);
+void filterSaveXml(const char *name);
+void filterSaveXml(const char *name,uint8_t silent);
+void filterLoadXml(const char *name);
+int  filterLoadXml(const char *name,uint8_t silent);
 #endif
- void filterSave(char *name);
- void filterLoad(char *name);
- int filterLoad(char *name,uint8_t silent);
- void filterSave(char *name,uint8_t silent);
+ void filterSave(const char *name);
+ void filterLoad(const char *name);
+ int filterLoad(const char *name,uint8_t silent);
+ void filterSave(const char *name,uint8_t silent);
 CONFcouple *filterBuildCouple(FILTER_PARAM *param,uint32_t n,Arg *args);
 void filterSaveScriptJS(FILE *f);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -40,6 +40,8 @@
 #undef fopen
 #undef fclose
 
+extern char * actual_workbench_file;
+
 size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
 {
   return fread(ptr,size,n,sstream); 
@@ -408,3 +410,94 @@
 		*root=full;
 		return ;
 }
+
+// CYB 2005.02.23: DND
+void fileReadWrite(SELFILE_CB *cb, int rw, const char *name)
+{
+
+	if(name)
+	{
+		if(cb)
+		{
+			FILE *fd;
+			fd=fopen(name,"rb");
+			if(rw==0) // read
+			{
+				// try to open it..
+				if(!fd)
+				{
+                                  GUI_Error_HIG(QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\"."), name);
+					return;
+				}
+			}
+			else // write
+			{
+				if(fd){
+				  struct stat buf;
+				  int fdino;
+					fclose(fd);
+
+					char msg[300];
+
+					snprintf(msg, 300, QT_TR_NOOP("%s already exists.\n\nDo you want to replace it?"), GetFileName(name));
+
+                                        if(!GUI_Question(msg))
+						return;
+	                                /*
+	                                ** JSC Fri Feb 10 00:07:30 CET 2006
+	                                ** compare existing output file inode against each current open files inode
+	                                ** i'm ignoring st_dev, so we may get false positives
+	                                ** i'm testing until fd=1024, should be MAXFD computed by configure
+	                                ** keep in mind:
+	                                ** you can overwrite .idx files, they are loaded into memory and closed soon
+	                                ** you cannot overwrite segment data files, all files are kept open and
+	                                ** are detected here
+	                                */
+#ifndef ADM_WIN32
+					if( stat(name,&buf) == -1 ){
+						fprintf(stderr,"stat(%s) failed\n",name);
+						return;
+					}
+#endif
+					fdino = buf.st_ino;
+					for(int i=0;i<1024;i++){
+						if( fstat(i,&buf) != -1 ){
+							if( buf.st_ino == fdino ){
+							  char str[512];
+								snprintf(str,512,"File \"%s\" exists and is opened by Avidemux",name);
+								GUI_Error_HIG(str,
+                                                                    QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
+								return;
+							}
+						}
+					}
+					/*
+	                                ** compare output file against actual EMCAscript file
+					** need to stat() to avoid symlink (/home/x.js) vs. real file (/export/home/x.js) case
+	                                */
+					if( actual_workbench_file ){
+						if( stat(actual_workbench_file,&buf) != -1 ){
+							if( buf.st_ino == fdino ){
+							  char str[512];
+								snprintf(str,512,"File \"%s\" exists and is the actual ECMAscript file",name);
+                                                                GUI_Error_HIG(str,QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
+								return;
+							}
+						}
+					}
+				}
+
+				// check we have right access to it
+				fd=fopen(name,"wb");
+				if(!fd)
+				{
+                                  GUI_Error_HIG(QT_TR_NOOP("Cannot write the file"),QT_TR_NOOP( "No write access to \"%s\"."), name);
+					return;
+				}
+			}
+			fclose(fd);
+			cb(name);
+		} // no callback -> return value
+	}
+}
+// CYB 2005.02.23: DND

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemux.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemux.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemux.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -37,12 +37,12 @@
 #include "ADM_osSupport/ADM_debug.h"
 
 
-extern int A_openAvi (char *name);
+extern int A_openAvi (const char *name);
 extern int A_Save (const char *name);
-extern int A_appendAvi (char *name);
+extern int A_appendAvi (const char *name);
 extern uint8_t ogmSave(char *name);
 extern int GUI_GoToFrame(uint32_t frame);
-extern int filterLoadXml(char *docname,uint8_t silent);
+extern int filterLoadXml(const char *docname,uint8_t silent);
 extern int A_delete(uint32_t start, uint32_t end);
 
 extern uint8_t A_ListAllBlackFrames( char *file );

Modified: branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -29,7 +29,7 @@
 #include <ctype.h>
 
 #include "avi_vars.h"
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 
 #include "gui_action.hxx"
 #include "ADM_encoder/ADM_vidEncode.hxx"
@@ -50,9 +50,8 @@
 
 extern uint8_t loadVideoCodecConf( const char *name);
 extern int A_saveJpg (char *name);
-extern void filterLoadXml(char *n);
-extern int A_openAvi(char *name);
-extern int A_appendAvi (char *name);
+extern void filterLoadXml(const char *n);
+extern int A_appendAvi (const char *name);
 extern void A_saveAudio(char *name);
 extern int A_loadNone( void );
 extern void A_saveAudioDecodedTest(char *name);
@@ -101,7 +100,7 @@
 extern int A_SaveUnpackedVop(const char *name);
 extern int A_SavePackedVop(const char *name);
 extern int A_saveDVDPS(char *name);
-extern void A_saveWorkbench (char *name);
+extern void A_saveWorkbench (const char *name);
 extern uint8_t A_rebuildKeyFrame (void);
 extern uint8_t A_setContainer(const char *cont);
 uint8_t scriptAddVar(char *var,char *value);
@@ -146,7 +145,7 @@
         {"run",			1,"load and run a script",		(one_arg_type)A_parseECMAScript},
         {"audio-normalize",	1,"activate normalization",		call_normalize},
         {"audio-resample",	1,"resample to x hz",			call_resample},
-        {"filters",		1,"load a filter preset",		filterLoadXml}   ,
+        {"filters",		1,"load a filter preset",		(one_arg_type)filterLoadXml}   ,
         {"codec-conf",		1,"load a codec configuration",		(one_arg_type )loadVideoCodecConf}   ,
         {"vcd-res",		0,"set VCD resolution",			(one_arg_type)setVCD}              ,
         {"svcd-res",		0,"set SVCD resolution",		(one_arg_type)setSVCD}              ,
@@ -161,8 +160,8 @@
         {"save-raw-audio",	1,"save audio as-is ",			A_saveAudio},
         {"save-raw-video",	1,"save raw video stream (mpeg/... ) ",	(one_arg_type)ADM_saveRaw},
         {"save-uncompressed-audio",1,"save uncompressed audio",A_saveAudioDecodedTest},
-        {"load",		1,"load video or workbench",		(one_arg_type )A_openAvi},
-        {"load-workbench",	1,"load workbench file",		(one_arg_type)A_openAvi},
+        {"load",		1,"load video or workbench", (one_arg_type)A_openAvi},
+        {"load-workbench",	1,"load workbench file", (one_arg_type)A_openAvi},
         {"append",		1,"append video",			(one_arg_type)A_appendAvi},
         {"save",		1,"save avi",				save},		
         {"save-workbench",	1,"save workbench file",		(one_arg_type)A_saveWorkbench},

Modified: branches/avidemux_2.4_branch/avidemux/ADM_toolkit/filesel.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_toolkit/filesel.h	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_toolkit/filesel.h	2008-06-17 02:15:24 UTC (rev 4114)
@@ -15,9 +15,9 @@
 
 #ifndef FILESEL_H
 #define FILESEL_H
-typedef void SELFILE_CB(char *);
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) ;
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) ;
+typedef void SELFILE_CB(const char *);
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) ;
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) ;
 void GUI_FileSelRead(const char *label, char * * name);
 void GUI_FileSelWrite(const char *label, char * * name);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -81,7 +81,7 @@
 static uint32_t ADM_nbCustom=0;
 // Needed for DND
 // extern int A_openAvi (char *name);
-extern void A_appendAvi (char *name);
+extern int A_appendAvi (const char *name);
 
 
 static void on_audio_change(void);
@@ -129,7 +129,7 @@
 extern void guiCallback(GtkMenuItem * menuitem, gpointer user_data);
 extern void HandleAction(Action act);
 extern gboolean UI_on_key_press(GtkWidget *widget, GdkEventKey* event, gpointer user_data);
-extern void fileReadWrite(SELFILE_CB cb, int rw, char *name);
+extern void fileReadWrite(SELFILE_CB *cb, int rw, const char *name);
 
 // To build vcodec
 extern uint32_t encoderGetNbEncoder(void);
@@ -1120,21 +1120,25 @@
     \fn DNDmerge
     \brief Extract the actual filename from the DNDstring file://abcd and store it into where
 */
-static void DNDmerge(char **where, char *start,char *end)
+static void DNDmerge(char **where, char *start, char *end)
 {
-  int len=end-start;
-  ADM_assert(len>7); // file:// = 7 bytes
-  len-=7;
-  *where=(char *)ADM_alloc(end-start+1);  // 7 more but who cares ?
-  memcpy(*where,start+7,len);
-  
-  // chomp it
-  char *tail=(*where)+len;
-  do
-  { 
-      *tail=0;
-      tail--;
-  }while(*tail==0xA || *tail==0xd);
+	char urlFile[end - start + 1];
+	char *tail = urlFile + (end - start);
+
+	memcpy(urlFile, start, end - start);
+
+	do
+	{
+		*tail = 0;
+		tail--;
+	} while (*tail == '\r' || *tail == '\n');
+
+	gchar *filename = g_filename_from_uri(urlFile, NULL, NULL);
+
+	*where = new char[strlen(filename) + 1];
+	strcpy(*where, filename);
+
+	g_free(filename);
 }
 // DND CYB
 #define MAX_DND_FILES 20
@@ -1150,7 +1154,7 @@
    char *names[MAX_DND_FILES];
    
     memset(names,0,sizeof(char *)*MAX_DND_FILES);
-    if (info != TARGET_URI_LIST)
+    if (info != TARGET_STRING && info != TARGET_URL)
     {
       gtk_drag_finish(dc,TRUE,FALSE,t);
       return;
@@ -1184,15 +1188,13 @@
     for(int i=0;i<current-1;i++)
     {
       printf("DND : %d %s\n",i,names[i]);
-      char *filename=names[i];
-      if (avifileinfo) 
-              {
-                    fileReadWrite(A_appendAvi, 0, (char*)filename);
-               }
-               else
-               {
-                    fileReadWrite(reinterpret_cast <void (*)(char *)> (A_openAvi), 0, (char*)filename);
-               }
+      const char *filename = names[i];
+
+	  if (avifileinfo)
+		  fileReadWrite(reinterpret_cast <void (*)(const char *)> (A_appendAvi), 0, filename);
+	  else
+		  fileReadWrite(reinterpret_cast <void (*)(const char *)> (A_openAvi), 0, filename);
+
       ADM_dealloc(names[i]); 
     }
     gtk_drag_finish(dc,TRUE,FALSE,t);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -38,7 +38,7 @@
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 
-extern char * actual_workbench_file;
+extern void fileReadWrite(SELFILE_CB *cb, int rw, const char *name);
 
 static void GUI_FileSel(const char *label, SELFILE_CB * cb, int rw, char **name=NULL);
 char            *PathCanonize(const char *tmpname);
@@ -307,98 +307,6 @@
     GUI_FileSel(label, NULL, 1,name);
 }
 
-// CYB 2005.02.23: DND
-void fileReadWrite(SELFILE_CB *cb, int rw, char *name)
-{
-
-	if(name)
-	{
-		if(cb)
-		{
-			FILE *fd;
-			fd=fopen(name,"rb");
-			if(rw==0) // read
-			{
-				// try to open it..
-				if(!fd)
-				{
-                                  GUI_Error_HIG(QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\"."), name);
-					return;
-				}
-			}
-			else // write
-			{
-				if(fd){
-				  struct stat buf;
-				  int fdino;
-					fclose(fd);
-
-					char msg[300];
-
-					snprintf(msg, 300, QT_TR_NOOP("%s already exists.\n\nDo you want to replace it?"), GetFileName(name));
-
-                                        if(!GUI_Question(msg))
-						return;
-	                                /*
-	                                ** JSC Fri Feb 10 00:07:30 CET 2006
-	                                ** compare existing output file inode against each current open files inode
-	                                ** i'm ignoring st_dev, so we may get false positives
-	                                ** i'm testing until fd=1024, should be MAXFD computed by configure
-	                                ** keep in mind:
-	                                ** you can overwrite .idx files, they are loaded into memory and closed soon
-	                                ** you cannot overwrite segment data files, all files are kept open and
-	                                ** are detected here
-	                                */
-#ifndef ADM_WIN32
-					if( stat(name,&buf) == -1 ){
-						fprintf(stderr,"stat(%s) failed\n",name);
-						return;
-					}
-#endif
-					fdino = buf.st_ino;
-					for(int i=0;i<1024;i++){
-						if( fstat(i,&buf) != -1 ){
-							if( buf.st_ino == fdino ){
-							  char str[512];
-								snprintf(str,512,"File \"%s\" exists and is opened by Avidemux",name);
-								GUI_Error_HIG(str,
-                                                                    QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
-								return;
-							}
-						}
-					}
-					/*
-	                                ** compare output file against actual EMCAscript file
-					** need to stat() to avoid symlink (/home/x.js) vs. real file (/export/home/x.js) case
-	                                */
-					if( actual_workbench_file ){
-						if( stat(actual_workbench_file,&buf) != -1 ){
-							if( buf.st_ino == fdino ){
-							  char str[512];
-								snprintf(str,512,"File \"%s\" exists and is the actual ECMAscript file",name);
-                                                                GUI_Error_HIG(str,QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
-								return;
-							}
-						}
-					}
-				}
-
-				// check we have right access to it
-				fd=fopen(name,"wb");
-				if(!fd)
-				{
-                                  GUI_Error_HIG(QT_TR_NOOP("Cannot write the file"),QT_TR_NOOP( "No write access to \"%s\"."), name);
-					return;
-				}
-			}
-			fclose(fd);
-			cb(name);
-		} // no callback -> return value
-	}
-}
-// CYB 2005.02.23: DND
-
-
 void GUI_FileSel(const char *label, SELFILE_CB * cb, int rw,char **rname)
 {				/* Create the selector */
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -20,9 +20,9 @@
 { 
   return 0;
 }
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) 
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) 
 {}
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) 
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) 
 {}
 void GUI_FileSelRead(const char *label, char * * name)
 {}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -39,6 +39,7 @@
 #include "ADM_editor/ADM_outputfmt.h"
 #include "ADM_toolkit/filesel.h"
 #include "prefs.h"
+#include "avi_vars.h"
 
 extern int global_argc;
 extern char **global_argv;
@@ -55,7 +56,9 @@
 extern void loadTranslator(void);
 extern void initTranslator(void);
 extern void destroyTranslator(void);
-extern int A_openAvi2(char *name, uint8_t mode);
+extern int A_openAvi(const char *name);
+extern int A_appendAvi(const char *name);
+extern void fileReadWrite(SELFILE_CB *cb, int rw, const char *name);
 
 int SliderIsShifted=0;
 static void setupMenus(void);
@@ -330,6 +333,8 @@
 	ui.lineEdit_2->installEventFilter(this);
 
 	this->setFocus(Qt::OtherFocusReason);
+
+	setAcceptDrops(true);
 }
 /**
 \fn     custom
@@ -486,13 +491,18 @@
 	{
 		urlList = event->mimeData()->urls();
 
-		if (urlList.size() > 0)
+		for (int fileIndex = 0; fileIndex < urlList.size(); fileIndex++)
 		{
-			fileName = urlList[0].toLocalFile();
+			fileName = urlList[fileIndex].toLocalFile();
 			info.setFile(fileName);
 
 			if (info.isFile())
-				A_openAvi2(fileName.toUtf8().data(), 0);
+			{
+				if (avifileinfo)
+					fileReadWrite(reinterpret_cast <void (*)(const char *)> (A_appendAvi), 0, fileName.toUtf8().data());
+				else
+					fileReadWrite(reinterpret_cast <void (*)(const char *)> (A_openAvi), 0, fileName.toUtf8().data());
+			}
 		}
 	}
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -25,7 +25,7 @@
 static void GUI_FileSelSelect(const char *label, char **name, uint32_t access) ;
 
 //****************************************************************************************************
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) 
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) 
 {
   char *name;
   GUI_FileSelRead(label,&name);
@@ -36,7 +36,7 @@
   }
 }
 //****************************************************************************************************
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) 
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) 
 {
   char *name;
   GUI_FileSelWrite(label,&name);

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-17 02:15:24 UTC (rev 4114)
@@ -70,8 +70,8 @@
 
 void A_handleSecondTrack (int tracktype);
 int A_delete(uint32_t start, uint32_t end);
-void A_saveImg (char *name);
-void A_saveBunchJpg( char *name);
+void A_saveImg (const char *name);
+void A_saveBunchJpg( const char *name);
 void A_requantize(void);
 int A_saveJpg (char *name);
 int A_loadWave (char *name);
@@ -79,9 +79,9 @@
 int A_loadMP3 (char *name);
 int A_loadNone( void );
 void A_saveAudioDecodedTest (char *name);
-void A_openBrokenAvi (char *name);
-int A_openAvi2 (char *name, uint8_t mode);
-int A_appendAvi (char *name);
+void A_openBrokenAvi (const char *name);
+int A_openAvi2 (const char *name, uint8_t mode);
+int A_appendAvi (const char *name);
 void A_externalAudioTrack( void );
 
 void HandleAction (Action action);
@@ -117,7 +117,7 @@
 void ADM_cutWizard (void);
 uint8_t  ADM_saveRaw (const char *name);
 char * actual_workbench_file;
-void A_saveWorkbench (char *name);
+void A_saveWorkbench (const char *name);
 void updateLoaded (void);
 extern void encoderSetLogFile (char *name);
 extern void videoCodecSelect (void);
@@ -872,18 +872,18 @@
 //_____________________________________________________________
 
 void
-A_openBrokenAvi (char *name)
+A_openBrokenAvi (const char *name)
 {
   A_openAvi2 (name, 1);
 }
 
 int
-A_openAvi (char *name)
+A_openAvi (const char *name)
 {
   return A_openAvi2 (name, 0);
 }
 extern void GUI_PreviewEnd (void);
-int A_openAvi2 (char *name, uint8_t mode)
+int A_openAvi2 (const char *name, uint8_t mode)
 {
   uint8_t res;
   gchar *name_utf8;
@@ -1094,7 +1094,7 @@
 //  Append an AVI to the existing one
 //___________________________________________
 int
-A_appendAvi (char *name)
+A_appendAvi (const char *name)
 {
 
 
@@ -1289,11 +1289,12 @@
       \brief Save the selection  as a bunch of jpeg 95% qual
 
 */
-void A_saveBunchJpg(char *name)
+void A_saveBunchJpg(const char *name)
 {
   ADMImage *src=NULL;
   uint32_t curImg;
   char	 fullName[2048],*ext;
+  char *baseName;
   DIA_working *working;
   uint8_t success=0;
 
@@ -1303,7 +1304,7 @@
                         return;
                 }
         // Split name into base + extension
-        PathSplit(name,&name,&ext);
+        PathSplit(name,&baseName,&ext);
 
         src=new ADMImage(avifileinfo->width,avifileinfo->height);
         ADM_assert(src);
@@ -1318,7 +1319,7 @@
                         goto _bunch_abort;
                 }
                 if(!working->isAlive()) goto _bunch_abort;
-                sprintf(fullName,"%s%04d.jpg",name,curImg-frameStart);
+                sprintf(fullName,"%s%04d.jpg",baseName,curImg-frameStart);
                 if(!src->saveAsJpg(fullName)) goto _bunch_abort;
         }
         success=1;
@@ -1338,7 +1339,7 @@
       \fn A_saveImg
       \brief Save current displayed image as a BMP file
 */
-void A_saveImg (char *name)
+void A_saveImg (const char *name)
 {
 
   ADMImage image(avifileinfo->width,avifileinfo->height);
@@ -1779,7 +1780,7 @@
 }
 
 void
-A_saveWorkbench (char *name)
+A_saveWorkbench (const char *name)
 {
 #if 0
   video_body->saveWorbench (name);

Modified: branches/avidemux_2.4_branch/avidemux/gtkgui.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtkgui.h	2008-06-17 00:03:41 UTC (rev 4113)
+++ branches/avidemux_2.4_branch/avidemux/gtkgui.h	2008-06-17 02:15:24 UTC (rev 4114)
@@ -15,7 +15,7 @@
  *                                                                         *
  ***************************************************************************/
 
-int 			A_openAvi		(char *name);
+int 			A_openAvi		(const char *name);
 void 			A_saveAudio	(char *name);
 void 			A_saveAudioDecoded	(char *name);
 void 			A_saveAVI		(char *name);



From mean at mail.berlios.de  Tue Jun 17 08:10:46 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Jun 2008 08:10:46 +0200
Subject: [Avidemux-svn-commit] r4115 - in
	branches/avidemux_2.4_branch/avidemux: ADM_audio
	ADM_outputs/oplug_avi
Message-ID: <200806170610.m5H6AkXm009203@sheep.berlios.de>

Author: mean
Date: 2008-06-17 08:10:44 +0200 (Tue, 17 Jun 2008)
New Revision: 4115

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
Log:
[Avi] Fix headers when using PCM/LPCM (FS#450)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp	2008-06-17 02:15:24 UTC (rev 4114)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp	2008-06-17 06:10:44 UTC (rev 4115)
@@ -156,27 +156,28 @@
 	return 0;
 
 }
-//*************
-// The packet is 1024 bytes long BUT the 4/8 bytes (mono/stereo) are used for predictor initialization
-//
-// See Mike Melanson nice doc http://www.multimedia.cx/simpleaudio.html
-//___________________________
+/**
+        \fn getPacketPCM
+        \brief
+*/
 uint8_t		AVDMGenericAudioStream::getPacketPCM(uint8_t *dest, uint32_t *len, 
 								uint32_t *samples)
 {
-// Take ~ 10 m packets
+// Take ~ 32 samples packet
 //
 	uint32_t count,sample;
-			sample=_wavheader->frequency/100;			
-			count=sample*_wavheader->channels;
+    uint32_t sampleSizeInBytes=1;
                         if(_wavheader->encoding!=WAV_ULAW && _wavheader->encoding!=WAV_8BITS_UNSIGNED)
 			{
-				count*=2;			
+				sampleSizeInBytes=2;
 			}
+			count=32*_wavheader->channels;
+            count*=sampleSizeInBytes;
+
 			if(packetTail-packetHead<count)
 			{
 				count=packetTail-packetHead;
-				count&=0xffffffC;
+				count&=~(sampleSizeInBytes*_wavheader->channels);
 			}
 			memcpy(dest,&packetBuffer[packetHead],count);			
 			packetHead+=count;
@@ -189,15 +190,7 @@
 				printf("Wav Packetizer: running empty, last packet sent\n");
 				return 0;
 			}
-                        if(_wavheader->encoding!=WAV_ULAW && _wavheader->encoding!=WAV_8BITS_UNSIGNED&&
-                                        _wavheader->encoding!=WAV_IMAADPCM  )
-			{
-				*samples=sample/2;
-			}
-			else
-			{
-				*samples=sample;
-			}
+			*samples=sample/sampleSizeInBytes;
 			*len=count;
 			return 1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-17 02:15:24 UTC (rev 4114)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-17 06:10:44 UTC (rev 4115)
@@ -421,13 +421,18 @@
 			header->dwSampleSize 	= wav.blockalign;
 			header->dwInitialFrames =1;				
 			header->dwSuggestedBufferSize=10*wav.blockalign;				
-			
 			extra=(uint8_t *)&wmaheader;
 			extraLen=12;
 			break;
+    case WAV_PCM:
+    case WAV_LPCM:
+            header->dwScale=header->dwSampleSize=wav.blockalign=2*wav.channels; // Realign
+            header->dwLength/=header->dwScale;
+            break;
           case WAV_8BITS_UNSIGNED:
                         wav.encoding=WAV_PCM;
-			header->dwScale 	= 1;
+			header->dwScale=header->dwSampleSize=wav.blockalign=wav.channels;
+			header->dwLength/=header->dwScale;
                         wav.bitspersample=8;
                         break;
                         



From gruntster at mail.berlios.de  Tue Jun 17 12:41:04 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 12:41:04 +0200
Subject: [Avidemux-svn-commit] r4116 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_osSupport
Message-ID: <200806171041.m5HAf4fk018646@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 12:40:56 +0200 (Tue, 17 Jun 2008)
New Revision: 4116

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[Win32] use native UTF-8 functions rather than GLib (backport of r3891)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 06:10:44 UTC (rev 4115)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 10:40:56 UTC (rev 4116)
@@ -1,416 +1,418 @@
-/***************************************************************************
-                    
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h" 
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-    
-#include <dirent.h>
-#include <errno.h>
-#include <sys/stat.h>
-
-#include <unistd.h>
-
-#ifdef WIN32
-#include <glib.h>
-#endif
-
-#include "default.h"
-#include "ADM_misc.h"
-
-
-#include "ADM_toolkit/filesel.h"
-#include "ADM_toolkit/toolkit.hxx"
-
-#include "ADM_assert.h"
-#undef fread
-#undef fwrite
-#undef fopen
-#undef fclose
-
-extern char * actual_workbench_file;
-
-size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
-{
-  return fread(ptr,size,n,sstream); 
-  
-}
-
-size_t ADM_fwrite (void *ptr, size_t size, size_t n, FILE *sstream)
-{
-  return fwrite(ptr,size,n,sstream); 
-  
-}
-FILE  *ADM_fopen (const char *file, const char *mode)
-{
-  FILE *f;
-
-#ifndef ADM_WIN32
-  return fopen(file,mode); 
-#else
-  gchar *retval = g_locale_from_utf8 (file, -1, NULL, NULL, NULL);
-  f=fopen(retval,mode);
-  g_free (retval);
-  return f;  
-#endif
-}
-
-int    ADM_fclose (FILE *file)
-{
-  return fclose(file); 
-}
-//*****************************
-static char basedir[1024]={0};
-static char jobdir[1024]={0};
-static char customdir[1024]={0};
-int baseDirDone=0;
-int jobDirDone=0;
-int customDirDone=0;
-#ifdef ADM_WIN32
-const char *ADM_DIR_NAME="\\avidemux";
-#else
-const char *ADM_DIR_NAME="/.avidemux";
-#endif
-/*
-
-*/
-/*
-      Get the  directory where jobs are stored
-******************************************************/
-
-char *ADM_getCustomDir(void)
-{
-  if(customDirDone) return customdir;
-
-  char *rootDir;
-  rootDir=ADM_getBaseDir();
-  strncpy(customdir,rootDir,1023);
-#if defined(ADM_WIN32)
-  strcat(customdir,"\\custom"); 
-#else
-  strcat(customdir,"/custom");
-#endif
-  if(!ADM_mkdir(customdir))
-  {
-    GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't create custom directory (%s)."),customdir);
-                return NULL;
-  }
-  customDirDone=1;
-  return customdir;
-}
-/*
-      Get the  directory where jobs are stored
-******************************************************/
-
-char *ADM_getJobDir(void)
-{
-  if(jobDirDone) return jobdir;
-
-  char *rootDir;
-  rootDir=ADM_getBaseDir();
-  strncpy(jobdir,rootDir,1023);
-#if defined(ADM_WIN32)
-  strcat(jobdir,"\\jobs"); 
-#else
-  strcat(jobdir,"/jobs");
-#endif
-  if(!ADM_mkdir(jobdir))
-  {
-    GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't create job directory (%s)."),jobdir);
-                return NULL;
-  }
-  jobDirDone=1;
-  return jobdir;
-}
-/*
-      Get the root directory for .avidemux stuff
-******************************************************/
-char *ADM_getBaseDir(void)
-{
-char *dirname=NULL;
-DIR *dir=NULL;
-char *home;
-//
-        if(baseDirDone) return basedir;
-// Get the base directory
-#if defined(ADM_WIN32)
-        if( ! (home=getenv("USERPROFILE")) )
-        {
-          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $USERPROFILE."));
-                    home="c:\\";
-        }
-
-#else
-        if( ! (home=getenv("HOME")) )
-        {
-          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $HOME."));
-                return NULL;
-        }
-#endif
-
- // Try to open the .avidemux directory
-        dirname=new char[strlen(home)+strlen(ADM_DIR_NAME)+2];
-        strcpy(dirname,home);
-        strcat(dirname,ADM_DIR_NAME);
-        if(!ADM_mkdir(dirname))
-        {
-          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("Cannot create the .avidemux directory"), NULL);
-                        delete [] dirname;
-                        return NULL;
-        }
-        delete [] dirname;
-
-        // Now built the filename
-        strncpy(basedir,home,1023);
-        strncat(basedir,ADM_DIR_NAME,1023-strlen(basedir));
-        baseDirDone=1;
-        printf("Using %s as base directory for prefs/jobs/...\n",basedir);
-        return basedir;
-}
-/*----------------------------------------
-      Create a directory
-      If it already exists, do nothing
-------------------------------------------*/
-uint8_t ADM_mkdir(const char *dirname)
-{
-DIR *dir=NULL;
-              // Check it already exists ?
-              dir=opendir(dirname);
-              if(dir)
-              { 
-                  printf("Directory %s exists.Good.\n",dirname);
-                  closedir(dir);
-                  return 1;
-              }
-#if defined(ADM_WIN32)
-                if(mkdir(dirname))
-                {
-                    printf("Oops: mkdir failed on %s\n",dirname);   
-                    return 0;
-                }
-                
-#else    
-                char *sys=new char[strlen(dirname)+strlen("mkdir ")+2];
-                strcpy(sys,"mkdir ");
-                strcat(sys,dirname);
-                printf("Creating dir :%s\n",sys);
-                system(sys);
-                delete [] sys;
-#endif		
-              if((dir=opendir(dirname))==NULL)
-                {
-                        return 0;
-                }
-              closedir(dir); 
-              return 1;
-}
-uint8_t buildDirectoryContent(uint32_t *outnb,const char *base, char *jobName[],int maxElems,const char *ext)
-{
-
-DIR *dir;
-struct dirent *direntry;
-int dirmax=0,len;
-int extlen=strlen(ext);
-    ADM_assert(extlen);
-    
-         dir=opendir(base);
-        if(!dir)
-        {
-                return 0;
-        }
-        while((direntry=readdir(dir)))
-        {
-                len=strlen(direntry->d_name);
-                if(len<(extlen+1)) continue;
-                int xbase=len-extlen;
-                if(memcmp(direntry->d_name+xbase,ext,extlen))
-                //if(direntry->d_name[len-1]!='s' || direntry->d_name[len-2]!='j' || direntry->d_name[len-3]!='.')
-                {
-                        printf("ignored:%s\n",direntry->d_name);
-                        continue;
-                }
-                jobName[dirmax]=(char *)ADM_alloc(strlen(base)+strlen(direntry->d_name)+2);
-                strcpy(jobName[dirmax],base);
-                strcat(jobName[dirmax],"/");
-                strcat(jobName[dirmax],direntry->d_name);
-                dirmax++;
-                if(dirmax>=maxElems)
-                {
-                        printf("[jobs]: Max # of jobs exceeded\n");
-                         break;
-                }
-        }
-        closedir(dir);
-        *outnb=dirmax;
-        return 1;
-}
-//------------------------------------------------------------------
-
-/*
-
-** note: it modifies it's first argument
-*/
-void simplify_path(char **buf){
-   unsigned int last1slash = 0;
-   unsigned int last2slash = 0;
-	while( !strncmp(*buf,"/../",4) )
-		memmove(*buf,*buf+3,strlen(*buf+3)+1);
-	for(unsigned int i=0;i<strlen(*buf)-2;i++)
-		while( !strncmp(*buf+i,"/./",3) )
-			memmove(*buf+i,*buf+i+2,strlen(*buf+i+2)+1);
-	for(unsigned int i=0;i<strlen(*buf)-3;i++){
-		if( *(*buf+i) == '/' ){
-			last2slash = last1slash;
-			last1slash = i;
-		}
-		if( !strncmp(*buf+i,"/../",4) ){
-			memmove(*buf+last2slash,*buf+i+3,strlen(*buf+i+3)+1);
-			return simplify_path(buf);
-		}
-	}
-}
-
-//
-//	Make it absolute
-//
-char *PathCanonize(const char *tmpname)
-{
-	char path[300];
-	char *out ;
-
-	if( ! getcwd(path,300) ){
-		fprintf(stderr,"\ngetcwd() failed with: %s (%u)\n",
-		               strerror(errno), errno );
-		path[0] = '\0';
-	}
-	if(!tmpname || tmpname[0]==0)
-	{
-		out=new char [strlen(path)+2];
-		strcpy(out,path);
-#ifndef ADM_WIN32		
-		strcat(out,"/");
-#else
-		strcat(out,"\\");
-#endif	
-		printf("\n Canonizing null string ??? (%s)\n",out);
-	}else if(tmpname[0]=='/'
-#if defined(ADM_WIN32)
-		|| tmpname[1]==':'
-#endif	
-	
-	)
-	{
-		out=new char[strlen(tmpname)+1];
-		strcpy(out,tmpname);
-		return out;
-	}else{
-		out=new char[strlen(path)+strlen(tmpname)+6];
-		strcpy(out,path);
-#ifndef ADM_WIN32		
-		strcat(out,"/");
-#else
-		strcat(out,"\\");
-#endif		
-		strcat(out,tmpname);
-	}
-	simplify_path(&out);
-	return out;
-}
-/*
-	Strip the path and only keep the name
-
-*/
-void		PathStripName(char *str)
-{
-		int len=strlen(str);
-		if(len<=1) return;
-		len--;
-#ifndef ADM_WIN32		
-		while( *(str+len)!='/' && len)
-#else
-	while( *(str+len)!='\\' && len)
-#endif		
-		{
-			 *(str+len)=0;
-			 len--;
-		}
-}
-
-/*
-	Get the filename without path
-
-*/
-const char *GetFileName(const char *str)
-{
-	char *filename;
-        char *filename2;
-#ifndef ADM_WIN32		
-	filename = strrchr(str, '/');
-        
-#else
-	filename = strrchr(str, '\\');
-        filename2 = strrchr(str, '/');
-        if(filename2 && filename)
-        {
-          if(filename2>filename) filename=filename2; 
-        }
-#endif
-	if (filename)
-		return filename+1;
-	else
-		return str;
-}
-
-/*
-	Split patch into absolute path+name and extention
-
-*/
-void PathSplit(const char *str, char **root, char **ext)
-{
-	char *full;
-	uint32_t l;
-
-		full=PathCanonize(str);
-		// Search the last .
-		l=strlen(full);
-		l--;
-		ADM_assert(l>0);
-		while( *(full+l)!='.' && l) l--;
-		if(!l || l==(strlen(full)-1))
-		{
-			if(l==(strlen(full)-1))
-			{
-				*(full+l)=0;  // remove trailing .
-			}
-			*ext=new char[2];
-			*root=full;
-			strcpy(*ext,"");
-			return ;
-		}
-		// else we do get an extension
-		// starting at l+1
-		uint32_t suff;
-
-		suff=strlen(full)-l-1;
-		*ext=new char[suff+1];
-		strcpy(*ext,full+l+1);
-		*(full+l)=0;
-		*root=full;
-		return ;
-}
-
+/***************************************************************************
+                    
+    copyright            : (C) 2006 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h" 
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+    
+#include <dirent.h>
+#include <errno.h>
+#include <sys/stat.h>
+#include <unistd.h>
+
+#ifdef __WIN32
+#include <windows.h>
+#endif
+
+#include "default.h"
+#include "ADM_misc.h"
+
+
+#include "ADM_toolkit/filesel.h"
+#include "ADM_toolkit/toolkit.hxx"
+
+#include "ADM_assert.h"
+#undef fread
+#undef fwrite
+#undef fopen
+#undef fclose
+
+extern char * actual_workbench_file;
+
+size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
+{
+  return fread(ptr,size,n,sstream); 
+  
+}
+
+size_t ADM_fwrite (void *ptr, size_t size, size_t n, FILE *sstream)
+{
+  return fwrite(ptr,size,n,sstream); 
+  
+}
+FILE  *ADM_fopen (const char *file, const char *mode)
+{
+#ifdef __MINGW32__
+	int nFileLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, file, -1, NULL, 0);
+	int nModeLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, mode, -1, NULL, 0);
+	wchar_t wFile[nFileLen + 1];
+	wchar_t wMode[nModeLen + 1];
+
+	MultiByteToWideChar(CP_UTF8, 0, mode, -1, wMode, nModeLen + 1);
+	MultiByteToWideChar(CP_UTF8, 0, file, -1, wFile, nFileLen + 1);
+
+	return _wfopen(wFile, wMode);
+#else
+	return fopen(file, mode);
+#endif
+}
+
+int    ADM_fclose (FILE *file)
+{
+  return fclose(file); 
+}
+//*****************************
+static char basedir[1024]={0};
+static char jobdir[1024]={0};
+static char customdir[1024]={0};
+int baseDirDone=0;
+int jobDirDone=0;
+int customDirDone=0;
+#ifdef ADM_WIN32
+const char *ADM_DIR_NAME="\\avidemux";
+#else
+const char *ADM_DIR_NAME="/.avidemux";
+#endif
+/*
+
+*/
+/*
+      Get the  directory where jobs are stored
+******************************************************/
+
+char *ADM_getCustomDir(void)
+{
+  if(customDirDone) return customdir;
+
+  char *rootDir;
+  rootDir=ADM_getBaseDir();
+  strncpy(customdir,rootDir,1023);
+#if defined(ADM_WIN32)
+  strcat(customdir,"\\custom"); 
+#else
+  strcat(customdir,"/custom");
+#endif
+  if(!ADM_mkdir(customdir))
+  {
+    GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't create custom directory (%s)."),customdir);
+                return NULL;
+  }
+  customDirDone=1;
+  return customdir;
+}
+/*
+      Get the  directory where jobs are stored
+******************************************************/
+
+char *ADM_getJobDir(void)
+{
+  if(jobDirDone) return jobdir;
+
+  char *rootDir;
+  rootDir=ADM_getBaseDir();
+  strncpy(jobdir,rootDir,1023);
+#if defined(ADM_WIN32)
+  strcat(jobdir,"\\jobs"); 
+#else
+  strcat(jobdir,"/jobs");
+#endif
+  if(!ADM_mkdir(jobdir))
+  {
+    GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't create job directory (%s)."),jobdir);
+                return NULL;
+  }
+  jobDirDone=1;
+  return jobdir;
+}
+/*
+      Get the root directory for .avidemux stuff
+******************************************************/
+char *ADM_getBaseDir(void)
+{
+char *dirname=NULL;
+DIR *dir=NULL;
+char *home;
+//
+        if(baseDirDone) return basedir;
+// Get the base directory
+#if defined(ADM_WIN32)
+        if( ! (home=getenv("USERPROFILE")) )
+        {
+          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $USERPROFILE."));
+                    home="c:\\";
+        }
+
+#else
+        if( ! (home=getenv("HOME")) )
+        {
+          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $HOME."));
+                return NULL;
+        }
+#endif
+
+ // Try to open the .avidemux directory
+        dirname=new char[strlen(home)+strlen(ADM_DIR_NAME)+2];
+        strcpy(dirname,home);
+        strcat(dirname,ADM_DIR_NAME);
+        if(!ADM_mkdir(dirname))
+        {
+          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("Cannot create the .avidemux directory"), NULL);
+                        delete [] dirname;
+                        return NULL;
+        }
+        delete [] dirname;
+
+        // Now built the filename
+        strncpy(basedir,home,1023);
+        strncat(basedir,ADM_DIR_NAME,1023-strlen(basedir));
+        baseDirDone=1;
+        printf("Using %s as base directory for prefs/jobs/...\n",basedir);
+        return basedir;
+}
+/*----------------------------------------
+      Create a directory
+      If it already exists, do nothing
+------------------------------------------*/
+uint8_t ADM_mkdir(const char *dirname)
+{
+DIR *dir=NULL;
+              // Check it already exists ?
+              dir=opendir(dirname);
+              if(dir)
+              { 
+                  printf("Directory %s exists.Good.\n",dirname);
+                  closedir(dir);
+                  return 1;
+              }
+#if defined(ADM_WIN32)
+                if(mkdir(dirname))
+                {
+                    printf("Oops: mkdir failed on %s\n",dirname);   
+                    return 0;
+                }
+                
+#else    
+                char *sys=new char[strlen(dirname)+strlen("mkdir ")+2];
+                strcpy(sys,"mkdir ");
+                strcat(sys,dirname);
+                printf("Creating dir :%s\n",sys);
+                system(sys);
+                delete [] sys;
+#endif		
+              if((dir=opendir(dirname))==NULL)
+                {
+                        return 0;
+                }
+              closedir(dir); 
+              return 1;
+}
+uint8_t buildDirectoryContent(uint32_t *outnb,const char *base, char *jobName[],int maxElems,const char *ext)
+{
+
+DIR *dir;
+struct dirent *direntry;
+int dirmax=0,len;
+int extlen=strlen(ext);
+    ADM_assert(extlen);
+    
+         dir=opendir(base);
+        if(!dir)
+        {
+                return 0;
+        }
+        while((direntry=readdir(dir)))
+        {
+                len=strlen(direntry->d_name);
+                if(len<(extlen+1)) continue;
+                int xbase=len-extlen;
+                if(memcmp(direntry->d_name+xbase,ext,extlen))
+                //if(direntry->d_name[len-1]!='s' || direntry->d_name[len-2]!='j' || direntry->d_name[len-3]!='.')
+                {
+                        printf("ignored:%s\n",direntry->d_name);
+                        continue;
+                }
+                jobName[dirmax]=(char *)ADM_alloc(strlen(base)+strlen(direntry->d_name)+2);
+                strcpy(jobName[dirmax],base);
+                strcat(jobName[dirmax],"/");
+                strcat(jobName[dirmax],direntry->d_name);
+                dirmax++;
+                if(dirmax>=maxElems)
+                {
+                        printf("[jobs]: Max # of jobs exceeded\n");
+                         break;
+                }
+        }
+        closedir(dir);
+        *outnb=dirmax;
+        return 1;
+}
+//------------------------------------------------------------------
+
+/*
+
+** note: it modifies it's first argument
+*/
+void simplify_path(char **buf){
+   unsigned int last1slash = 0;
+   unsigned int last2slash = 0;
+	while( !strncmp(*buf,"/../",4) )
+		memmove(*buf,*buf+3,strlen(*buf+3)+1);
+	for(unsigned int i=0;i<strlen(*buf)-2;i++)
+		while( !strncmp(*buf+i,"/./",3) )
+			memmove(*buf+i,*buf+i+2,strlen(*buf+i+2)+1);
+	for(unsigned int i=0;i<strlen(*buf)-3;i++){
+		if( *(*buf+i) == '/' ){
+			last2slash = last1slash;
+			last1slash = i;
+		}
+		if( !strncmp(*buf+i,"/../",4) ){
+			memmove(*buf+last2slash,*buf+i+3,strlen(*buf+i+3)+1);
+			return simplify_path(buf);
+		}
+	}
+}
+
+//
+//	Make it absolute
+//
+char *PathCanonize(const char *tmpname)
+{
+	char path[300];
+	char *out ;
+
+	if( ! getcwd(path,300) ){
+		fprintf(stderr,"\ngetcwd() failed with: %s (%u)\n",
+		               strerror(errno), errno );
+		path[0] = '\0';
+	}
+	if(!tmpname || tmpname[0]==0)
+	{
+		out=new char [strlen(path)+2];
+		strcpy(out,path);
+#ifndef ADM_WIN32		
+		strcat(out,"/");
+#else
+		strcat(out,"\\");
+#endif	
+		printf("\n Canonizing null string ??? (%s)\n",out);
+	}else if(tmpname[0]=='/'
+#if defined(ADM_WIN32)
+		|| tmpname[1]==':'
+#endif	
+	
+	)
+	{
+		out=new char[strlen(tmpname)+1];
+		strcpy(out,tmpname);
+		return out;
+	}else{
+		out=new char[strlen(path)+strlen(tmpname)+6];
+		strcpy(out,path);
+#ifndef ADM_WIN32		
+		strcat(out,"/");
+#else
+		strcat(out,"\\");
+#endif		
+		strcat(out,tmpname);
+	}
+	simplify_path(&out);
+	return out;
+}
+/*
+	Strip the path and only keep the name
+
+*/
+void		PathStripName(char *str)
+{
+		int len=strlen(str);
+		if(len<=1) return;
+		len--;
+#ifndef ADM_WIN32		
+		while( *(str+len)!='/' && len)
+#else
+	while( *(str+len)!='\\' && len)
+#endif		
+		{
+			 *(str+len)=0;
+			 len--;
+		}
+}
+
+/*
+	Get the filename without path
+
+*/
+const char *GetFileName(const char *str)
+{
+	char *filename;
+        char *filename2;
+#ifndef ADM_WIN32		
+	filename = strrchr(str, '/');
+        
+#else
+	filename = strrchr(str, '\\');
+        filename2 = strrchr(str, '/');
+        if(filename2 && filename)
+        {
+          if(filename2>filename) filename=filename2; 
+        }
+#endif
+	if (filename)
+		return filename+1;
+	else
+		return str;
+}
+
+/*
+	Split patch into absolute path+name and extention
+
+*/
+void PathSplit(const char *str, char **root, char **ext)
+{
+	char *full;
+	uint32_t l;
+
+		full=PathCanonize(str);
+		// Search the last .
+		l=strlen(full);
+		l--;
+		ADM_assert(l>0);
+		while( *(full+l)!='.' && l) l--;
+		if(!l || l==(strlen(full)-1))
+		{
+			if(l==(strlen(full)-1))
+			{
+				*(full+l)=0;  // remove trailing .
+			}
+			*ext=new char[2];
+			*root=full;
+			strcpy(*ext,"");
+			return ;
+		}
+		// else we do get an extension
+		// starting at l+1
+		uint32_t suff;
+
+		suff=strlen(full)-l-1;
+		*ext=new char[suff+1];
+		strcpy(*ext,full+l+1);
+		*(full+l)=0;
+		*root=full;
+		return ;
+}
+
 // CYB 2005.02.23: DND
 void fileReadWrite(SELFILE_CB *cb, int rw, const char *name)
 {
@@ -420,7 +422,7 @@
 		if(cb)
 		{
 			FILE *fd;
-			fd=fopen(name,"rb");
+			fd=ADM_fopen(name,"rb");
 			if(rw==0) // read
 			{
 				// try to open it..
@@ -435,7 +437,7 @@
 				if(fd){
 				  struct stat buf;
 				  int fdino;
-					fclose(fd);
+					ADM_fclose(fd);
 
 					char msg[300];
 
@@ -488,14 +490,14 @@
 				}
 
 				// check we have right access to it
-				fd=fopen(name,"wb");
+				fd=ADM_fopen(name,"wb");
 				if(!fd)
 				{
                                   GUI_Error_HIG(QT_TR_NOOP("Cannot write the file"),QT_TR_NOOP( "No write access to \"%s\"."), name);
 					return;
 				}
 			}
-			fclose(fd);
+			ADM_fclose(fd);
 			cb(name);
 		} // no callback -> return value
 	}

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-17 06:10:44 UTC (rev 4115)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-17 10:40:56 UTC (rev 4116)
@@ -175,7 +175,6 @@
 
 void HandleAction (Action action)
 {
-  gchar *name_utf8;
   static int recursive = 0;
 
   uint32_t nf = 0;
@@ -217,9 +216,8 @@
                                 name=prefs->get_lastfiles();
                                 rank=(int)action-ACT_RECENT0;
                                 ADM_assert(name[rank]);
-				name_utf8 = g_filename_from_utf8(name[rank], -1, NULL, NULL, NULL);
-                                A_openAvi2 (name_utf8, 0);
-				g_free(name_utf8);
+                                A_openAvi2 (name[rank], 0);
+
                 return;
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
@@ -886,7 +884,6 @@
 int A_openAvi2 (const char *name, uint8_t mode)
 {
   uint8_t res;
-  gchar *name_utf8;
   char *longname;
   uint32_t magic[4];
   uint32_t id = 0;
@@ -969,8 +966,7 @@
 	}
 
 	/* remember any video or workbench file to "recent" */
-	name_utf8 = g_filename_to_utf8(longname, -1, NULL, NULL, NULL);
-	prefs->set_lastfile(name_utf8);
+	prefs->set_lastfile(longname);
         UI_updateRecentMenu();
 	updateLoaded ();
         if(currentaudiostream)
@@ -1000,7 +996,7 @@
 		}
 	UI_setTitle(longname+i);
     }
-	g_free(name_utf8);
+
 	delete[] longname;
 	return 1;
 }



From gruntster at mail.berlios.de  Tue Jun 17 12:52:23 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 12:52:23 +0200
Subject: [Avidemux-svn-commit] r4117 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200806171052.m5HAqNlL032047@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 12:52:12 +0200 (Tue, 17 Jun 2008)
New Revision: 4117

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp
Log:
[x264] correct the Partition Decision numbering on Qt4 interface

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp	2008-06-17 10:40:56 UTC (rev 4116)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp	2008-06-17 10:52:12 UTC (rev 4117)
@@ -1,171 +1,171 @@
-
-// Author: mean <fixounet at free.fr>, (C) 2007
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include <math.h>
-
-#include "ADM_assert.h"
-#include "config.h"
-
-#include "fourcc.h"
-#include "avio.hxx"
-#include "avi_vars.h"
-
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
-#include "ADM_encoder/ADM_vidEncode.hxx"
-#include "ADM_codecs/ADM_x264param.h"
-
-#ifdef USE_X264
-extern "C"
-{
-#include "x264.h"
-}
-#endif
-/**
-      \fn DIA_x264
-      \brief Dialog for x264 codec settings
-*/
-uint8_t DIA_x264(COMPRES_PARAMS *config)
-{
-int b;
-int ret=0;
-int code;
-      ADM_x264Param localParam;
-      ADM_assert(config->extraSettingsLen==sizeof(localParam));
-      memcpy(&localParam,config->extraSettings,sizeof(localParam));
-#define PX(x) &(localParam.x)
-         
-      
-      // Our tabs
-         /* Tab 1 main */
-           diaElemBitrate bitrate(config,NULL);
-           bitrate.setMaxQz(51);
-           diaElem *main[]={&bitrate};
-           diaElemTabs tabMain(QT_TR_NOOP("Main"),1,main);
-
-           
-        /* Tab 2 Motion */
-
-
-         diaMenuEntry partitionM[] = {
-                  {0,   QT_TR_NOOP("1  - Extremely Low (Fastest)")}
-                ,{1,    QT_TR_NOOP("2  - Very Low")}
-                ,{3,    QT_TR_NOOP("3  - Low")}
-                ,{4,    QT_TR_NOOP("4  - Medium")}
-                ,{5,    QT_TR_NOOP("5  - High (Default)")}
-                ,{6,    QT_TR_NOOP("6  - Very High")}
-                ,{7,    QT_TR_NOOP("6B - Very High (RDO on Bframes)")}
-                ,{8,    QT_TR_NOOP("7  - Ultra High")}
-                ,{9,    QT_TR_NOOP("7B - Ultra High (RDO on Bframes)")}};
-
-                            
-        diaElemMenu parition(PX(PartitionDecision),QT_TR_NOOP("Partition Decision"),10,partitionM);
-        
-         diaMenuEntry meM[] = {
-                             {0,    QT_TR_NOOP("Diamond Search")},
-                             {1,    QT_TR_NOOP("Hexagonal Search")},
-                             {2,    QT_TR_NOOP("Uneven Multi-hexagon")},
-                             {3,    QT_TR_NOOP("Exhaustive Search")}
+
+// Author: mean <fixounet at free.fr>, (C) 2007
+//
+// Copyright: See COPYING file that comes with this distribution
+//
+//
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <math.h>
+
+#include "ADM_assert.h"
+#include "config.h"
+
+#include "fourcc.h"
+#include "avio.hxx"
+#include "avi_vars.h"
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
+#include "ADM_encoder/ADM_vidEncode.hxx"
+#include "ADM_codecs/ADM_x264param.h"
+
+#ifdef USE_X264
+extern "C"
+{
+#include "x264.h"
+}
+#endif
+/**
+      \fn DIA_x264
+      \brief Dialog for x264 codec settings
+*/
+uint8_t DIA_x264(COMPRES_PARAMS *config)
+{
+int b;
+int ret=0;
+int code;
+      ADM_x264Param localParam;
+      ADM_assert(config->extraSettingsLen==sizeof(localParam));
+      memcpy(&localParam,config->extraSettings,sizeof(localParam));
+#define PX(x) &(localParam.x)
+         
+      
+      // Our tabs
+         /* Tab 1 main */
+           diaElemBitrate bitrate(config,NULL);
+           bitrate.setMaxQz(51);
+           diaElem *main[]={&bitrate};
+           diaElemTabs tabMain(QT_TR_NOOP("Main"),1,main);
+
+           
+        /* Tab 2 Motion */
+
+
+         diaMenuEntry partitionM[] = {
+                  {0,   QT_TR_NOOP("1  - Extremely Low (Fastest)")}
+                ,{1,    QT_TR_NOOP("2  - Very Low")}
+                ,{2,    QT_TR_NOOP("3  - Low")}
+                ,{3,    QT_TR_NOOP("4  - Medium")}
+                ,{4,    QT_TR_NOOP("5  - High (Default)")}
+                ,{5,    QT_TR_NOOP("6  - Very High")}
+                ,{6,    QT_TR_NOOP("6B - Very High (RDO on Bframes)")}
+                ,{7,    QT_TR_NOOP("7  - Ultra High")}
+                ,{8,    QT_TR_NOOP("7B - Ultra High (RDO on Bframes)")}};
+
+                            
+        diaElemMenu parition(PX(PartitionDecision),QT_TR_NOOP("Partition Decision"),10,partitionM);
+        
+         diaMenuEntry meM[] = {
+                             {0,    QT_TR_NOOP("Diamond Search")},
+                             {1,    QT_TR_NOOP("Hexagonal Search")},
+                             {2,    QT_TR_NOOP("Uneven Multi-hexagon")},
+                             {3,    QT_TR_NOOP("Exhaustive Search")}
 #if X264_BUILD >= 58
 							 ,{4, QT_TR_NOOP("Hadamard Exhaustive Search")}
-#endif
-							 };
-
-         diaElemMenu      me(PX(Method),QT_TR_NOOP("VHQ Mode"),
- #if X264_BUILD >= 58
-			 5
-#else
-			 4
-#endif
-			 ,meM);
-
-         diaElemUInteger  rframe(PX(MaxRefFrames),QT_TR_NOOP("Max Ref Frames"),0,15);
-         diaElemUInteger  range(PX(Range),QT_TR_NOOP("Max B Frames"),0,64);
-         diaElemToggle    chromaMe(PX(ChromaME),QT_TR_NOOP("Chroma ME"));
-         diaElemToggle    mixedRef(PX(MixedRefs),QT_TR_NOOP("Mixed Refs"));
-         diaElemToggle    fastPSkip(PX(fastPSkip),QT_TR_NOOP("Fast P Skip"));
-         diaElemToggle    dctDecimate(PX(DCTDecimate),QT_TR_NOOP("DCT Decimate"));
-         diaElemToggle    interlaced(PX(interlaced),QT_TR_NOOP("Interlaced"));
-         
-         diaElemFrame  frameMe(QT_TR_NOOP("Motion Estimation"));
-         frameMe.swallow(&parition);
-         frameMe.swallow(&me);
-         frameMe.swallow(&rframe);
-         frameMe.swallow(&range);
-         frameMe.swallow(&chromaMe);
-         frameMe.swallow(&mixedRef);
-         frameMe.swallow(&fastPSkip);
-         frameMe.swallow(&dctDecimate);
-         frameMe.swallow(&interlaced);
-         
-           diaElem *motions[]={&frameMe};
-          diaElemTabs tabMotion(QT_TR_NOOP("Motion"),1,motions);
-         
-         
-        /* Tab3-Misc  */
-           diaMenuEntry trellisM[] = {
-                  {0,   QT_TR_NOOP("Disabled")}
-                ,{1,    QT_TR_NOOP("Low")}
-                ,{2,    QT_TR_NOOP("High")}};
-           
-          diaElemMenu trellis(PX(Trellis),QT_TR_NOOP("Trellis"),3,trellisM);
-          diaElemToggle    cabac(PX(CABAC),QT_TR_NOOP("CABAC"));
-          diaElemUInteger  noise(PX(NoiseReduction),QT_TR_NOOP("Noise Reduction"),0,255);
-          diaElemToggle    deblock(PX(DeblockingFilter),QT_TR_NOOP("Deblocking Filter"));
-          diaElemInteger  deblockStrength(PX(Strength),QT_TR_NOOP("Strength"),-6,6);
-          diaElemInteger  deblockThreshold(PX(Threshold),QT_TR_NOOP("Threshold"),-6,6);
-          deblock.link(1,&deblockStrength);
-          deblock.link(1,&deblockThreshold);
-          
-          
-          diaElemFrame  frameMisc(QT_TR_NOOP("Misc"));
-          frameMisc.swallow(&trellis);
-          frameMisc.swallow(&cabac);
-          frameMisc.swallow(&noise);
-          frameMisc.swallow(&deblock);
-          frameMisc.swallow(&deblockStrength);
-          frameMisc.swallow(&deblockThreshold);
-            
-           diaElem *misc[]={&frameMisc};
-          diaElemTabs tabMisc(QT_TR_NOOP("Misc"),1,misc);
-        /* Tab 4 Partition & frame*/
-         
-             diaElemToggle    _8x8(PX(_8x8),QT_TR_NOOP("8x8 Transform"));
-             diaElemToggle    _8x8P(PX(_8x8P),QT_TR_NOOP("8x8P Transform"));
-             diaElemToggle    _8x8B(PX(_8x8B),QT_TR_NOOP("8x8B Transform"));
-             diaElemToggle    _4x4(PX(_4x4),QT_TR_NOOP("_4x4 Transform"));
-             diaElemToggle    _8x8I(PX(_8x8I),QT_TR_NOOP("_8x8I Transform"));
-             diaElemToggle    _4x4I(PX(_4x4I),QT_TR_NOOP("_4x4I Transform"));
-          diaElemFrame  frameTransform(QT_TR_NOOP("Transform"));
-           frameTransform.swallow(&_8x8);
-           frameTransform.swallow(&_8x8P);
-           frameTransform.swallow(&_8x8B);
-           frameTransform.swallow(&_4x4);
-           frameTransform.swallow(&_8x8I);
-           frameTransform.swallow(&_4x4I);
-          
-           diaElemUInteger  bframe(PX(MaxBFrame),QT_TR_NOOP("Max B Frames"),0,3);
-           diaElemFrame frameB(QT_TR_NOOP("B Frames"));
-           frameB.swallow(&bframe);
-           
-            diaElem *bfr[]={&frameTransform,&frameB};
-          diaElemTabs tabTransform(QT_TR_NOOP("Transform"),2,bfr);
-           
-          /* End of tabs */
-        diaElemTabs *tabs[4]={&tabMain,&tabMotion,&tabMisc,&tabTransform};
-        if( diaFactoryRunTabs(QT_TR_NOOP("x264 Configuration"),4,tabs))
-	{
-           memcpy(config->extraSettings,&localParam,sizeof(localParam));
-           return 1;
-        }
-         return 0;
-}
-
-// EOF
+#endif
+							 };
+
+         diaElemMenu      me(PX(Method),QT_TR_NOOP("VHQ Mode"),
+ #if X264_BUILD >= 58
+			 5
+#else
+			 4
+#endif
+			 ,meM);
+
+         diaElemUInteger  rframe(PX(MaxRefFrames),QT_TR_NOOP("Max Ref Frames"),0,15);
+         diaElemUInteger  range(PX(Range),QT_TR_NOOP("Max B Frames"),0,64);
+         diaElemToggle    chromaMe(PX(ChromaME),QT_TR_NOOP("Chroma ME"));
+         diaElemToggle    mixedRef(PX(MixedRefs),QT_TR_NOOP("Mixed Refs"));
+         diaElemToggle    fastPSkip(PX(fastPSkip),QT_TR_NOOP("Fast P Skip"));
+         diaElemToggle    dctDecimate(PX(DCTDecimate),QT_TR_NOOP("DCT Decimate"));
+         diaElemToggle    interlaced(PX(interlaced),QT_TR_NOOP("Interlaced"));
+         
+         diaElemFrame  frameMe(QT_TR_NOOP("Motion Estimation"));
+         frameMe.swallow(&parition);
+         frameMe.swallow(&me);
+         frameMe.swallow(&rframe);
+         frameMe.swallow(&range);
+         frameMe.swallow(&chromaMe);
+         frameMe.swallow(&mixedRef);
+         frameMe.swallow(&fastPSkip);
+         frameMe.swallow(&dctDecimate);
+         frameMe.swallow(&interlaced);
+         
+           diaElem *motions[]={&frameMe};
+          diaElemTabs tabMotion(QT_TR_NOOP("Motion"),1,motions);
+         
+         
+        /* Tab3-Misc  */
+           diaMenuEntry trellisM[] = {
+                  {0,   QT_TR_NOOP("Disabled")}
+                ,{1,    QT_TR_NOOP("Low")}
+                ,{2,    QT_TR_NOOP("High")}};
+           
+          diaElemMenu trellis(PX(Trellis),QT_TR_NOOP("Trellis"),3,trellisM);
+          diaElemToggle    cabac(PX(CABAC),QT_TR_NOOP("CABAC"));
+          diaElemUInteger  noise(PX(NoiseReduction),QT_TR_NOOP("Noise Reduction"),0,255);
+          diaElemToggle    deblock(PX(DeblockingFilter),QT_TR_NOOP("Deblocking Filter"));
+          diaElemInteger  deblockStrength(PX(Strength),QT_TR_NOOP("Strength"),-6,6);
+          diaElemInteger  deblockThreshold(PX(Threshold),QT_TR_NOOP("Threshold"),-6,6);
+          deblock.link(1,&deblockStrength);
+          deblock.link(1,&deblockThreshold);
+          
+          
+          diaElemFrame  frameMisc(QT_TR_NOOP("Misc"));
+          frameMisc.swallow(&trellis);
+          frameMisc.swallow(&cabac);
+          frameMisc.swallow(&noise);
+          frameMisc.swallow(&deblock);
+          frameMisc.swallow(&deblockStrength);
+          frameMisc.swallow(&deblockThreshold);
+            
+           diaElem *misc[]={&frameMisc};
+          diaElemTabs tabMisc(QT_TR_NOOP("Misc"),1,misc);
+        /* Tab 4 Partition & frame*/
+         
+             diaElemToggle    _8x8(PX(_8x8),QT_TR_NOOP("8x8 Transform"));
+             diaElemToggle    _8x8P(PX(_8x8P),QT_TR_NOOP("8x8P Transform"));
+             diaElemToggle    _8x8B(PX(_8x8B),QT_TR_NOOP("8x8B Transform"));
+             diaElemToggle    _4x4(PX(_4x4),QT_TR_NOOP("_4x4 Transform"));
+             diaElemToggle    _8x8I(PX(_8x8I),QT_TR_NOOP("_8x8I Transform"));
+             diaElemToggle    _4x4I(PX(_4x4I),QT_TR_NOOP("_4x4I Transform"));
+          diaElemFrame  frameTransform(QT_TR_NOOP("Transform"));
+           frameTransform.swallow(&_8x8);
+           frameTransform.swallow(&_8x8P);
+           frameTransform.swallow(&_8x8B);
+           frameTransform.swallow(&_4x4);
+           frameTransform.swallow(&_8x8I);
+           frameTransform.swallow(&_4x4I);
+          
+           diaElemUInteger  bframe(PX(MaxBFrame),QT_TR_NOOP("Max B Frames"),0,3);
+           diaElemFrame frameB(QT_TR_NOOP("B Frames"));
+           frameB.swallow(&bframe);
+           
+            diaElem *bfr[]={&frameTransform,&frameB};
+          diaElemTabs tabTransform(QT_TR_NOOP("Transform"),2,bfr);
+           
+          /* End of tabs */
+        diaElemTabs *tabs[4]={&tabMain,&tabMotion,&tabMisc,&tabTransform};
+        if( diaFactoryRunTabs(QT_TR_NOOP("x264 Configuration"),4,tabs))
+	{
+           memcpy(config->extraSettings,&localParam,sizeof(localParam));
+           return 1;
+        }
+         return 0;
+}
+
+// EOF



From gruntster at mail.berlios.de  Tue Jun 17 18:27:01 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 18:27:01 +0200
Subject: [Avidemux-svn-commit] r4118 - in
	branches/avidemux_2.4_branch/avidemux: ADM_osSupport ADM_toolkit
Message-ID: <200806171627.m5HGR1oc014933@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 18:26:50 +0200 (Tue, 17 Jun 2008)
New Revision: 4118

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
Log:
[Win32] handle loading unicode filenames from command line (FS#354) & consolidate Win32 UTF-8 functions

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 10:52:12 UTC (rev 4117)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-17 16:26:50 UTC (rev 4118)
@@ -22,18 +22,12 @@
 #include <sys/stat.h>
 #include <unistd.h>
 
-#ifdef __WIN32
-#include <windows.h>
-#endif
-
 #include "default.h"
 #include "ADM_misc.h"
-
-
 #include "ADM_toolkit/filesel.h"
 #include "ADM_toolkit/toolkit.hxx"
-
 #include "ADM_assert.h"
+
 #undef fread
 #undef fwrite
 #undef fopen
@@ -41,6 +35,10 @@
 
 extern char * actual_workbench_file;
 
+#ifdef __WIN32
+extern int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString);
+#endif
+
 size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
 {
   return fread(ptr,size,n,sstream); 
@@ -55,15 +53,16 @@
 FILE  *ADM_fopen (const char *file, const char *mode)
 {
 #ifdef __MINGW32__
-	int nFileLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, file, -1, NULL, 0);
-	int nModeLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, mode, -1, NULL, 0);
-	wchar_t wFile[nFileLen + 1];
-	wchar_t wMode[nModeLen + 1];
+	int fileNameLength = utf8StringToWideChar(file, -1, NULL);
+	int modeLength = utf8StringToWideChar(mode, -1, NULL);
 
-	MultiByteToWideChar(CP_UTF8, 0, mode, -1, wMode, nModeLen + 1);
-	MultiByteToWideChar(CP_UTF8, 0, file, -1, wFile, nFileLen + 1);
+	wchar_t wcFile[fileNameLength];
+	wchar_t wcMode[modeLength];
 
-	return _wfopen(wFile, wMode);
+	utf8StringToWideChar(file, -1, wcFile);
+	utf8StringToWideChar(mode, -1, wcMode);
+
+	return _wfopen(wcFile, wcMode);
 #else
 	return fopen(file, mode);
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2008-06-17 10:52:12 UTC (rev 4117)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2008-06-17 16:26:50 UTC (rev 4118)
@@ -447,4 +447,31 @@
 	delete[] logPath;
 #endif
 }
+
+// Convert string from ANSI code page to UTF-8
+int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String)
+{
+	int wideCharStringLen = MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, NULL, 0);
+	wchar_t wideCharString[wideCharStringLen];
+
+	MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, wideCharString, wideCharStringLen);
+
+	int multiByteStringLen = WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, NULL, 0, NULL, NULL);
+
+	if (utf8String)
+		WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, utf8String, multiByteStringLen, NULL, NULL);
+
+	return multiByteStringLen;
+}
+
+// Convert UTF-8 string to wide char
+int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
+{
+	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
+
+	if (wideCharString)
+		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
+
+	return wideCharStringLength;
+}
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-17 10:52:12 UTC (rev 4117)
+++ branches/avidemux_2.4_branch/avidemux/ADM_toolkit/automation.cpp	2008-06-17 16:26:50 UTC (rev 4118)
@@ -105,7 +105,11 @@
 extern uint8_t A_setContainer(const char *cont);
 uint8_t scriptAddVar(char *var,char *value);
 extern uint8_t ADM_vob2vobsub(char *nameVob, char *nameVobSub, char *nameIfo);
-//
+
+#ifdef __WIN32
+	extern int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String);
+#endif
+
 static int call_bframe(void);
 static int call_x264(void);
 static int call_packedvop(void);
@@ -238,7 +242,17 @@
                       {
                             if(cur==1) 
                             {
-                                A_openAvi(argv[cur]);
+#ifdef __WIN32
+								int utf8StringLength = ansiStringToUtf8(argv[cur], -1, NULL);
+								char utf8FileName[utf8StringLength];
+
+								ansiStringToUtf8(argv[cur], -1, utf8FileName);
+
+								A_openAvi(utf8FileName);
+#else
+								A_openAvi(argv[cur]);
+#endif
+	
                             }
                             else
                                 printf("\n Found garbage %s\n",argv[cur]);



From gruntster at mail.berlios.de  Tue Jun 17 20:54:40 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jun 2008 20:54:40 +0200
Subject: [Avidemux-svn-commit] r4119 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_dialog ADM_toolkit_gtk
Message-ID: <200806171854.m5HIse4B016585@sheep.berlios.de>

Author: gruntster
Date: 2008-06-17 20:54:27 +0200 (Tue, 17 Jun 2008)
New Revision: 4119

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
Log:
[GTK] escape text for generic message boxes (FS#402)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-17 16:26:50 UTC (rev 4118)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-17 18:54:27 UTC (rev 4119)
@@ -212,14 +212,14 @@
 GtkTreeIter iter;
 char *str;
 ADM_date  *date;
-char str1[200],str2[200],str3[200];
+char *str1,str2[200],str3[200];
 
         gtk_list_store_clear (jobs.store);
         for (uint32_t i = 0; i < jobs.nb; i++)
         {
-                sprintf(str1,"<span weight=\"heavy\"> %s </span>\n" 
-               "<span size=\"smaller\" style=\"oblique\" > %s </span> "
-                ,GetFileName(jobs.name[i]),QT_TR_NOOP(StringStatus[jobs.status[i].status]));
+               str1 = g_markup_printf_escaped("<span weight=\"heavy\">%s</span>\n" 
+               "<span size=\"smaller\" style=\"oblique\">%s</span>"
+                , GetFileName(jobs.name[i]), StringStatus[jobs.status[i].status]);
 
                 date=&(jobs.status[i].startDate);
                 sprintf(str2,"%02d:%02d:%02d",date->hours,
@@ -235,7 +235,8 @@
                 gtk_list_store_set (jobs.store, &iter, 0,str1,1,str2,2,str3,-1);
                 printf("Start : %s\n",str2);
                 printf("End : %s\n",str3);
-                
+
+				g_free(str1);
         }
 }
 //*************************************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-06-17 16:26:50 UTC (rev 4118)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-06-17 18:54:27 UTC (rev 4119)
@@ -161,7 +161,6 @@
 
         dialog=create_dialogYN();
         gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
         gtk_register_dialog(dialog);
         if(gtk_dialog_run(GTK_DIALOG(dialog))==GTK_RESPONSE_YES)
         {
@@ -191,7 +190,6 @@
         }
         dialog=create_dialogInfo();
         gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
         gtk_register_dialog(dialog);
         gtk_dialog_run(GTK_DIALOG(dialog));
         gtk_unregister_dialog(dialog);
@@ -235,7 +233,7 @@
 			g_free(secondary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary);
 		g_free(secondary);
 	}
 	else
@@ -245,7 +243,7 @@
 			printf("Info: %s\n", primary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	va_end(ap);
@@ -278,7 +276,6 @@
         }
         dialog=create_dialogWarning();
         gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
         gtk_register_dialog(dialog);
         gtk_dialog_run(GTK_DIALOG(dialog));
         gtk_unregister_dialog(dialog);
@@ -321,7 +318,7 @@
 			g_free(secondary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary);
 		g_free(secondary);
 	}
 	else
@@ -331,7 +328,7 @@
 			printf("Info: %s\n", primary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	va_end(ap);
@@ -380,7 +377,7 @@
 			g_free(secondary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary);
 		g_free(secondary);
 	}
 	else
@@ -390,7 +387,7 @@
 			printf("Info: %s\n", primary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	va_end(ap);
@@ -443,7 +440,7 @@
 			g_free(secondary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary);
 		g_free(secondary);
 	}
 	else
@@ -453,7 +450,7 @@
 			printf("Info: %s\n", primary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	va_end(ap);



From gruntster at mail.berlios.de  Wed Jun 18 00:14:35 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jun 2008 00:14:35 +0200
Subject: [Avidemux-svn-commit] r4120 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200806172214.m5HMEZvP002650@sheep.berlios.de>

Author: gruntster
Date: 2008-06-18 00:14:29 +0200 (Wed, 18 Jun 2008)
New Revision: 4120

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
Log:
[about] update copyright on GTK+ About window (FS#407)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2008-06-17 18:54:27 UTC (rev 4119)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2008-06-17 22:14:29 UTC (rev 4120)
@@ -41,8 +41,9 @@
     "JSC",
     "Anish Mistry",
     "Jakub Misak",
-    "Kuisathaverat \t",
-    "And all the others.",
+    "Kuisathaverat",
+	"Gruntster",
+    QT_TR_NOOP("and all the others."),
     NULL
   };
   const gchar *artists[] = {
@@ -63,12 +64,12 @@
   aboutdialog1 = gtk_about_dialog_new ();
   gtk_about_dialog_set_version (GTK_ABOUT_DIALOG (aboutdialog1), subversion);
 // /MEANX
-  gtk_about_dialog_set_name (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Avidemux"));
-  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("\302\251 2001-2007 Mean"));
-  gtk_about_dialog_set_comments (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Multiplatform video editor"));
+  gtk_about_dialog_set_name (GTK_ABOUT_DIALOG (aboutdialog1), "Avidemux");
+  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), "\302\251 2001 - 2008 Mean");
+  gtk_about_dialog_set_comments (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Multi-platform Video Editor"));
   gtk_about_dialog_set_license (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Avidemux is free software; you can redistribute it and/or modify it\nunder the terms of the GNU General Public License version 2\nas published by the Free Software Foundation.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any othe!
 r program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Library General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you m!
 ust give the recipients all the rights that\nyou have.  You mu!
 st make 
sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be l!
 icensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; !
 they are outside its scope.  The act of\nrunning the Program i!
 s not re
stricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work unde!
 r the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Excep!
 tion: if the Program itself is interactive but\n    does not n!
 ormally 
print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn add!
 ition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections !
 1 and 2 above on a medium\n    customarily used for software i!
 nterchan
ge; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable!
 .\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\npr!
 ohibited by law if you do not accept this License.  Therefore,!
  by\nmod
ifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this !
 License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which!
  is\nimplemented by public license practices.  Many people hav!
 e made\n
generous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Pu!
 blic License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goa!
 ls\nof preserving the free status of all derivatives of our fr!
 ee softw
are and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENT!
 IAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's !
 name and a brief idea of what it does.>\n    Copyright (C) <ye!
 ar>  <na
me of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) ye!
 ar name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating !
 your program into\nproprietary programs.  If your program is a!
  subrout
ine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Library General\nPublic License instead of this License."));
   gtk_about_dialog_set_website (GTK_ABOUT_DIALOG (aboutdialog1), "http://www.avidemux.org");
-  gtk_about_dialog_set_website_label (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("http://www.avidemux.org"));
+  gtk_about_dialog_set_website_label (GTK_ABOUT_DIALOG (aboutdialog1), "http://www.avidemux.org");
   gtk_about_dialog_set_authors (GTK_ABOUT_DIALOG (aboutdialog1), authors);
   gtk_about_dialog_set_artists (GTK_ABOUT_DIALOG (aboutdialog1), artists);
   gtk_about_dialog_set_translator_credits (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("translator-credits"));



From gruntster at mail.berlios.de  Wed Jun 18 01:37:17 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jun 2008 01:37:17 +0200
Subject: [Avidemux-svn-commit] r4121 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_gui2 ADM_QT4/ADM_gui
Message-ID: <200806172337.m5HNbHOp030135@sheep.berlios.de>

Author: gruntster
Date: 2008-06-18 01:37:09 +0200 (Wed, 18 Jun 2008)
New Revision: 4121

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
Log:
[script] don't always tick audio shift when loading script (FS#377)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-17 22:14:29 UTC (rev 4120)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-17 23:37:09 UTC (rev 4121)
@@ -1226,6 +1226,8 @@
 }
 uint8_t UI_setTimeShift(int onoff,int value)
 {
+	if (!value)
+		onoff = 0;
 
         gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (lookup_widget(guiRootWindow,"CheckButtonTimeshift")),onoff);
         gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(guiRootWindow,"spinbuttonTimeShift")),value) ;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-17 22:14:29 UTC (rev 4120)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-17 23:37:09 UTC (rev 4121)
@@ -1031,7 +1031,7 @@
 
 uint8_t UI_setTimeShift(int onoff,int value)
 {
-	if(onoff)
+	if (onoff && value)
 		WIDGET(checkBox_TimeShift)->setCheckState(Qt::Checked);
 	else
 		WIDGET(checkBox_TimeShift)->setCheckState(Qt::Unchecked);



From gruntster at mail.berlios.de  Wed Jun 18 03:22:14 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jun 2008 03:22:14 +0200
Subject: [Avidemux-svn-commit] r4122 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200806180122.m5I1MEbg005532@sheep.berlios.de>

Author: gruntster
Date: 2008-06-18 03:21:57 +0200 (Wed, 18 Jun 2008)
New Revision: 4122

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
Log:
[subtitler] i18n, typos and add missing chinese simplified encoding

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-06-17 23:37:09 UTC (rev 4121)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-06-18 01:21:57 UTC (rev 4122)
@@ -42,21 +42,21 @@
 /*****************************************************************/
 typedef struct unicd
 {
-	char *display,*name;
+	const char *display;
+	const char *name;
 }unicd;
 
   static unicd  names[]=
 {
-	{(char *)"Ascii"	,(char *)"ISO-8859-1"},
-	{(char *)"Cyrillic"	,(char *)"WINDOWS-1251"}, // ru
-	{(char *)"Czech"	,(char *)"ISO-8859-2"},	// cz
-	{(char *)"German"	,(char *)"ISO-8859-9"}		// german ?
-	,{(char *)"Slovene"	,(char *)"CP1250"}		// UTF8
-        
-        ,{(char *)"UTF16"	,(char *)"UTF16"}		// UTF8
-	,{(char *)"UTF8"	,(char *)"UTF8"}		// UTF8
-	,{(char *)"Chinese Traditionnal(Big5)"	,(char *)"CP950"}		// UTF8
-	,{(char *)"Chinese Simplified (GB2312)"	,(char *)"CP936"}		// UTF8
+	{QT_TR_NOOP("Chinese Simplified (GB2312)"), "CP936"},		// UTF8
+	{QT_TR_NOOP("Chinese Traditional (Big5)"), "CP950"}	,	// UTF8
+	{QT_TR_NOOP("Cyrillic"), "WINDOWS-1251"}, // ru
+	{QT_TR_NOOP("Czech"), "ISO-8859-2"},	// cz
+	{QT_TR_NOOP("German"), "ISO-8859-9"},		// german ?
+	{QT_TR_NOOP("Latin-1"), "ISO-8859-1"},
+	{QT_TR_NOOP("Slovene"), "CP1250"},		// UTF8
+	{QT_TR_NOOP("UTF-8"), "UTF-8"},		// UTF8
+	{QT_TR_NOOP("UTF-16"), "UTF-16"}		// UTF16
 };
 typedef struct 
 {
@@ -71,7 +71,7 @@
 */
 uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param)
 {
-#define item(x) QT_TR_NOOP(names[x].display)
+#define item(x) names[x].display
 #define Mitem(x) {x,item(x)}
 diaMenuEntry encoding[]={
   Mitem(0),
@@ -82,6 +82,7 @@
   Mitem(5),
   Mitem(6),
   Mitem(7),
+  Mitem(8)
 };       
 
 #define PX(x) &(param->x)
@@ -101,7 +102,7 @@
       {
           if(!strcmp(param->_charset,names[i].name)) myEncoding=i;
       }
-      diaElemMenu      encodingM(&myEncoding,QT_TR_NOOP("_Encoding:"),8,encoding);
+      diaElemMenu      encodingM(&myEncoding,QT_TR_NOOP("_Encoding:"),9,encoding);
     //  diaElemUInteger  fontSize(PX(_fontsize),QT_TR_NOOP("Font Si_Ze:"),8,120);
       diaElemButton    color(QT_TR_NOOP("S_elect C_olor"), colorCallBack,&(colors[0]));
       diaElemButton    setBase(QT_TR_NOOP("Set Size and _Position"), sizePositionCallback,&sizePos);



From gruntster at mail.berlios.de  Wed Jun 18 13:07:47 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jun 2008 13:07:47 +0200
Subject: [Avidemux-svn-commit] r4123 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities
Message-ID: <200806181107.m5IB7ltR028537@sheep.berlios.de>

Author: gruntster
Date: 2008-06-18 13:07:36 +0200 (Wed, 18 Jun 2008)
New Revision: 4123

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp
Log:
[Win32] load translations for GTK+ when executing Avidemux outside its own folder (FS#422)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp	2008-06-18 01:21:57 UTC (rev 4122)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp	2008-06-18 11:07:36 UTC (rev 4123)
@@ -5,12 +5,27 @@
 #include <libintl.h>
 #include <locale.h>
 
+#ifdef __WIN32
+#include <windows.h>
+#endif
+
 void initGetText(void)
 {
 	char *local = setlocale(LC_ALL, "");
 
 #ifdef ADM_WIN32
-	bindtextdomain("avidemux", "./share/locale");
+	char moduleName[MAX_PATH];
+
+	GetModuleFileName(0, moduleName, sizeof(moduleName) / sizeof(char));
+
+	char *slash = strrchr(moduleName, '\\');
+
+	if (slash)
+		*slash = '\0';
+
+	strncat(moduleName, "\\share\\locale", MAX_PATH - 1);
+
+	bindtextdomain("avidemux", moduleName);
 #else
 	bindtextdomain("avidemux", ADMLOCALE);
 #endif



From mean at mail.berlios.de  Wed Jun 18 19:44:40 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 18 Jun 2008 19:44:40 +0200
Subject: [Avidemux-svn-commit] r4124 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiodevice
Message-ID: <200806181744.m5IHieKW016502@sheep.berlios.de>

Author: mean
Date: 2008-06-18 19:44:39 +0200 (Wed, 18 Jun 2008)
New Revision: 4124

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
Log:
[Audio] Fix volume when using alsa +dmix 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2008-06-18 11:07:36 UTC (rev 4123)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2008-06-18 17:44:39 UTC (rev 4124)
@@ -26,8 +26,8 @@
 #include <errno.h>
 #include <sys/types.h>
 #include "prefs.h"
- 
 
+
 #ifdef ALSA_SUPPORT
 #include <alsa/asoundlib.h>
 #include <ADM_assert.h>
@@ -51,7 +51,7 @@
 uint8_t alsaAudioDevice::init( uint8_t channel,uint32_t fq )
 {
 	int dir=0;
-	
+
 	_channels=channel;
 	_init=0;
    /* Playback stream */
@@ -67,7 +67,7 @@
   static char *pcm_name;
   if( prefs->get(DEVICE_AUDIO_ALSA_DEVICE, &pcm_name) != RC_OK )
                pcm_name = ADM_strdup("plughw:0,0");
-	
+
  /* Allocate the snd_pcm_hw_params_t structure on the stack. */
     snd_pcm_hw_params_alloca(&hwparams);
     snd_pcm_sw_params_alloca(&swparams);
@@ -107,9 +107,9 @@
     //  fprintf(stderr, "Error setting float format.\n");
 
 #ifdef ADM_BIG_ENDIAN
-    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_BE) < 0) 
+    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_BE) < 0)
 #else
-    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_LE) < 0) 
+    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_LE) < 0)
 #endif
     {
       fprintf(stderr, "Error setting format.\n");
@@ -297,8 +297,9 @@
 		ADM_dealloc(pcm_name);
 		return 0;
 	}
-	if( (rc=snd_mixer_attach(mixer_handle,pcm_name)) < 0 ){
-		printf("ALSA: snd_mixer_attach failed: %d\n",rc);
+// MEANX: Cannot use the real name, does not work with dmix
+	if( (rc=snd_mixer_attach(mixer_handle,"hw:0")) < 0 ){
+		printf("ALSA: snd_mixer_attach failed: %d, %s\n",rc, snd_strerror (rc));
 		snd_mixer_close(mixer_handle);
 		ADM_dealloc(pcm_name);
 		return 0;



From gruntster at mail.berlios.de  Wed Jun 18 21:35:33 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jun 2008 21:35:33 +0200
Subject: [Avidemux-svn-commit] r4125 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_dialog ADM_dialogFactory ADM_filters ADM_toolkit_gtk
Message-ID: <200806181935.m5IJZXqH027013@sheep.berlios.de>

Author: gruntster
Date: 2008-06-18 21:35:02 +0200 (Wed, 18 Jun 2008)
New Revision: 4125

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eraser.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
Log:
[GTK] correct the button order on all GTK+ windows

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2008-06-18 19:35:02 UTC (rev 4125)
@@ -9,7 +9,7 @@
 DIA_acodec.cpp    DIA_chromaShift.cpp  DIA_encoding.cpp   DIA_hue.cpp        DIA_ocr.cpp       DIA_properties.cpp  DIA_vcodec.cpp   DIA_xvid.cpp
 DIA_cnr2.cpp         DIA_eq2.cpp        DIA_idx_pg.cpp     DIA_partial.cpp   DIA_quota.cpp       DIA_vobsub.cpp
 DIA_asharp.cpp    DIA_coloryuv.cpp     DIA_equalizer.cpp  DIA_jobs.cpp       DIA_pause.cpp     DIA_recent.cpp      DIA_working.cpp
-DIA_busy.cpp      DIA_contrast.cpp     DIA_exLame.cpp     DIA_pipe.cpp      DIA_resize.cpp      DIA_x264.cpp
+DIA_busy.cpp      DIA_contrast.cpp     DIA_resize.cpp      DIA_x264.cpp
 DIA_threshold.cpp DIA_SwissArmyKnife.cpp DIA_particle.cpp DIA_eraser.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -500,6 +500,12 @@
     uint32_t height = in->getInfo()->height;
 
     dialog = create_swiss_army_knife_dialog();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
+
     gtk_register_dialog (dialog);
     gtk_window_set_title (GTK_WINDOW (dialog),
                           QT_TR_NOOP("Swiss Army Knife Configuration"));

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -66,8 +66,11 @@
 	AUDIOENCODER old=*codec;
 	
 	dialog=create_dialogAudioCodec();
-//	gtk_transient(dialog);
-        gtk_register_dialog(dialog);
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+	gtk_register_dialog(dialog);
 
 	
 	// now set the input one

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -67,6 +67,10 @@
         height=in->getInfo()->height;
 
         dialog=create_dialog1();
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
         gtk_register_dialog(dialog);
         gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP("ASHARP"));
         gtk_widget_show(dialog);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -69,6 +69,10 @@
 	if(!avifileinfo) return ;
 	
 	dialog=create_Calculator();
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_CANCEL,
+										GTK_RESPONSE_APPLY,
+										-1);
 	gtk_register_dialog(dialog);
         gtk_signal_connect(GTK_OBJECT(WID(optionmenu1)), "changed",
                       GTK_SIGNAL_FUNC(cb_mod),   (void *) 0);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -63,6 +63,11 @@
         height=in->getInfo()->height;
 
         dialog=create_ChromaShift();
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+											GTK_RESPONSE_OK,
+											GTK_RESPONSE_CANCEL,
+											GTK_RESPONSE_APPLY,
+											-1);
         gtk_register_dialog(dialog);
         gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP("Chroma Shift"));
         gtk_widget_show(dialog);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -48,7 +48,11 @@
 GtkWidget *dialog;
 int ret=0;
         dialog=create_dialog1();
-        
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
+
         // Update
         ENTRY_SET(lm);ENTRY_SET(ln);
         ENTRY_SET(um);ENTRY_SET(un);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -56,6 +56,10 @@
     int ret=0;
 
     dialog=create_dialog1();
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+								GTK_RESPONSE_OK,
+								GTK_RESPONSE_CANCEL,
+								-1);
     gtk_register_dialog(dialog);
     
     COMBO_SET(Matrix,matrix);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -68,6 +68,10 @@
         height=in->getInfo()->height;
 
         dialog=create_dialog1();
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
         gtk_register_dialog(dialog);
         gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP("Contrast"));
         gtk_widget_show(dialog);	

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -68,6 +68,11 @@
 	uint8_t ret=0;
 
 	dialog=create_dialog1();
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										GTK_RESPONSE_APPLY,
+										-1);
 	gtk_register_dialog(dialog);
 	gtk_window_set_title(GTK_WINDOW(dialog), name);
 	gtk_widget_show(dialog);
@@ -78,10 +83,6 @@
 	CONNECT(buttonAutocrop,clicked,ui_autocrop);
 	CONNECT(buttonReset,clicked,ui_reset);
 	CONNECT(scale,value_changed,ui_frame_changed);
-	                  
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk), GTK_RESPONSE_OK);
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply), GTK_RESPONSE_APPLY);
 
 #define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_update)
           
@@ -223,205 +224,170 @@
   GtkWidget *dialog1;
   GtkWidget *dialog_vbox1;
   GtkWidget *vbox1;
-  GtkWidget *hbuttonbox1;
-  GtkWidget *buttonCancel;
-  GtkWidget *buttonApply;
-  GtkWidget *buttonOk;
-  GtkWidget *hbuttonbox2;
-  GtkWidget *buttonAutocrop;
-  GtkWidget *buttonReset;
-  GtkWidget *alignment1;
-  GtkWidget *hbox1;
-  GtkWidget *image1;
-  GtkWidget *label1;
+  GtkWidget *drawingarea1;
+  GtkWidget *scale;
   GtkWidget *table1;
+  GtkWidget *label1;
   GtkWidget *label2;
   GtkWidget *label3;
   GtkWidget *label4;
-  GtkWidget *label5;
+  GtkObject *spinbuttonRight_adj;
+  GtkWidget *spinbuttonRight;
   GtkObject *spinbuttonLeft_adj;
   GtkWidget *spinbuttonLeft;
-  GtkObject *spinbuttonTop_adj;
-  GtkWidget *spinbuttonTop;
   GtkObject *spinbuttonBottom_adj;
   GtkWidget *spinbuttonBottom;
-  GtkObject *spinbuttonRight_adj;
-  GtkWidget *spinbuttonRight;
-  GtkWidget *scale;
-  GtkWidget *drawingarea1;
+  GtkObject *spinbuttonTop_adj;
+  GtkWidget *spinbuttonTop;
+  GtkWidget *hbox1;
+  GtkWidget *hbox2;
+  GtkWidget *buttonAutocrop;
+  GtkWidget *buttonReset;
   GtkWidget *dialog_action_area1;
+  GtkWidget *applybutton1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
 
   dialog1 = gtk_dialog_new ();
   gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP("Crop Settings"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
 
   dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
   gtk_widget_show (dialog_vbox1);
 
-  vbox1 = gtk_vbox_new (FALSE, 0);
+  vbox1 = gtk_vbox_new (FALSE, 6);
   gtk_widget_show (vbox1);
   gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox1), 6);
 
-  hbuttonbox1 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox1, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox1), GTK_BUTTONBOX_END);
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
 
-  buttonCancel = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (buttonCancel);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonCancel);
-  GTK_WIDGET_SET_FLAGS (buttonCancel, GTK_CAN_DEFAULT);
+  scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
+  gtk_widget_show (scale);
+  gtk_box_pack_start (GTK_BOX (vbox1), scale, FALSE, TRUE, 0);
 
-  buttonApply = gtk_button_new_from_stock ("gtk-apply");
-  gtk_widget_show (buttonApply);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonApply);
-  GTK_WIDGET_SET_FLAGS (buttonApply, GTK_CAN_DEFAULT);
-
-  buttonOk = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (buttonOk);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonOk);
-  GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
-
-  hbuttonbox2 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox2, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox2), GTK_BUTTONBOX_START);
-
-  buttonAutocrop = gtk_button_new_with_mnemonic (QT_TR_NOOP("AutoCrop"));
-  gtk_widget_show (buttonAutocrop);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonAutocrop);
-  GTK_WIDGET_SET_FLAGS (buttonAutocrop, GTK_CAN_DEFAULT);
-
-  buttonReset = gtk_button_new ();
-  gtk_widget_show (buttonReset);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonReset);
-  GTK_WIDGET_SET_FLAGS (buttonReset, GTK_CAN_DEFAULT);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 0, 0);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (buttonReset), alignment1);
-
-  hbox1 = gtk_hbox_new (FALSE, 2);
-  gtk_widget_show (hbox1);
-  gtk_container_add (GTK_CONTAINER (alignment1), hbox1);
-
-  image1 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_BUTTON);
-  gtk_widget_show (image1);
-  gtk_box_pack_start (GTK_BOX (hbox1), image1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new_with_mnemonic (QT_TR_NOOP("Reset"));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-
   table1 = gtk_table_new (2, 4, FALSE);
   gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, TRUE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, FALSE, 10);
+  gtk_table_set_row_spacings (GTK_TABLE (table1), 4);
+  gtk_table_set_col_spacings (GTK_TABLE (table1), 15);
 
-  label2 = gtk_label_new (QT_TR_NOOP("Crop Left :"));
+  label1 = gtk_label_new (QT_TR_NOOP("Crop Left:"));
+  gtk_widget_show (label1);
+  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
+
+  label2 = gtk_label_new (QT_TR_NOOP("Crop Right:"));
   gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 0, 1,
+  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_FILL);
   gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
 
   label3 = gtk_label_new (QT_TR_NOOP("Crop Top:"));
   gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 1, 2,
+  gtk_table_attach (GTK_TABLE (table1), label3, 2, 3, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_FILL);
   gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
 
-  label4 = gtk_label_new (QT_TR_NOOP("Crop Right:"));
+  label4 = gtk_label_new (QT_TR_NOOP("Crop Bottom:"));
   gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 2, 3, 0, 1,
+  gtk_table_attach (GTK_TABLE (table1), label4, 2, 3, 1, 2,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_FILL);
   gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
 
-  label5 = gtk_label_new (QT_TR_NOOP("Crop Bottom:"));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table1), label5, 2, 3, 1, 2,
+  spinbuttonRight_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonRight = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRight_adj), 1, 0);
+  gtk_widget_show (spinbuttonRight);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonRight, 1, 2, 1, 2,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
 
   spinbuttonLeft_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
   spinbuttonLeft = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonLeft_adj), 1, 0);
   gtk_widget_show (spinbuttonLeft);
   gtk_table_attach (GTK_TABLE (table1), spinbuttonLeft, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonLeft), TRUE);
 
-  spinbuttonTop_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonTop = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTop_adj), 1, 0);
-  gtk_widget_show (spinbuttonTop);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTop, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTop), TRUE);
-
   spinbuttonBottom_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
   spinbuttonBottom = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBottom_adj), 1, 0);
   gtk_widget_show (spinbuttonBottom);
   gtk_table_attach (GTK_TABLE (table1), spinbuttonBottom, 3, 4, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBottom), TRUE);
 
-  spinbuttonRight_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonRight = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRight_adj), 1, 0);
-  gtk_widget_show (spinbuttonRight);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonRight, 3, 4, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+  spinbuttonTop_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonTop = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTop_adj), 1, 0);
+  gtk_widget_show (spinbuttonTop);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonTop, 3, 4, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRight), TRUE);
 
-  scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 110, 1, 10, 10)));
-  gtk_widget_show (scale);
-  gtk_box_pack_start (GTK_BOX (vbox1), scale, FALSE, TRUE, 0);
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, TRUE, 0);
 
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, FALSE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, 100, 100);
+  hbox2 = gtk_hbox_new (TRUE, 6);
+  gtk_widget_show (hbox2);
+  gtk_box_pack_start (GTK_BOX (hbox1), hbox2, FALSE, TRUE, 0);
 
+  buttonAutocrop = gtk_button_new_with_mnemonic (QT_TR_NOOP("Auto Crop"));
+  gtk_widget_show (buttonAutocrop);
+  gtk_box_pack_start (GTK_BOX (hbox2), buttonAutocrop, FALSE, TRUE, 0);
+
+  buttonReset = gtk_button_new_from_stock ("gtk-clear");
+  gtk_widget_show (buttonReset);
+  gtk_box_pack_start (GTK_BOX (hbox2), buttonReset, FALSE, TRUE, 0);
+
   dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
   gtk_widget_show (dialog_action_area1);
   gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
 
+  applybutton1 = gtk_button_new_from_stock ("gtk-apply");
+  gtk_widget_show (applybutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), applybutton1, GTK_RESPONSE_APPLY);
+  GTK_WIDGET_SET_FLAGS (applybutton1, GTK_CAN_DEFAULT);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
   /* Store pointers to all widgets, for use by lookup_widget(). */
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
   GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox1, "hbuttonbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonCancel, "buttonCancel");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonApply, "buttonApply");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonOk, "buttonOk");
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox2, "hbuttonbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonAutocrop, "buttonAutocrop");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, "buttonReset");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment1, "alignment1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, image1, "image1");
-  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (dialog1, scale, "scale");
   GLADE_HOOKUP_OBJECT (dialog1, table1, "table1");
+  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
   GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
   GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
   GLADE_HOOKUP_OBJECT (dialog1, label4, "label4");
-  GLADE_HOOKUP_OBJECT (dialog1, label5, "label5");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRight, "spinbuttonRight");
   GLADE_HOOKUP_OBJECT (dialog1, spinbuttonLeft, "spinbuttonLeft");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTop, "spinbuttonTop");
   GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBottom, "spinbuttonBottom");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRight, "spinbuttonRight");
-  GLADE_HOOKUP_OBJECT (dialog1, scale, "scale");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTop, "spinbuttonTop");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonAutocrop, "buttonAutocrop");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, "buttonReset");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, applybutton1, "applybutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
 
   return dialog1;
 }
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -67,6 +67,10 @@
         h=in->getInfo()->height;
 
         dialog=create_dialog1();
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+											GTK_RESPONSE_OK,
+											GTK_RESPONSE_CANCEL,
+											-1);
         gtk_register_dialog(dialog);
         gtk_widget_show(dialog);	
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -116,6 +116,12 @@
         memcpy(scaler,param->_scaler,sizeof(scaler));
 
 	dialog=create_dialog1();
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										A_RESET,
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										GTK_RESPONSE_APPLY,
+										-1);
 	gtk_register_dialog(dialog);
 	gtk_widget_set_usize(WID(drawingarea_histin), 256,128);
     gtk_widget_set_usize(WID(drawingarea_histout), 256,128);
@@ -134,10 +140,6 @@
 		resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_YUV420P, PIX_FMT_RGB32);
 	}
 
-	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
-	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(button3),      GTK_RESPONSE_OK);
-	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply),  GTK_RESPONSE_APPLY);
-        gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonReset),  A_RESET);
 	  upload();
 
 	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
@@ -431,20 +433,18 @@
   GtkWidget *dialog1;
   GtkWidget *dialog_vbox1;
   GtkWidget *vbox1;
-  GtkWidget *hbox2;
+  GtkWidget *drawingarea1;
+  GtkWidget *gui_scale;
+  GtkWidget *hbox1;
   GtkWidget *curve1;
-  GtkWidget *vseparator1;
-  GtkWidget *vbox3;
+  GtkWidget *vbox2;
   GtkWidget *drawingarea_histin;
   GtkWidget *drawingarea_histout;
-  GtkWidget *hbox1;
-  GtkWidget *buttonReset;
-  GtkWidget *buttonCancel;
-  GtkWidget *buttonApply;
-  GtkWidget *button3;
-  GtkWidget *gui_scale;
-  GtkWidget *drawingarea1;
   GtkWidget *dialog_action_area1;
+  GtkWidget *button1;
+  GtkWidget *button2;
+  GtkWidget *button3;
+  GtkWidget *button4;
 
   dialog1 = gtk_dialog_new ();
   gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP("Equalizer"));
@@ -457,85 +457,75 @@
   gtk_widget_show (vbox1);
   gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
 
-  hbox2 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox2, TRUE, TRUE, 0);
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
 
+  gui_scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 10, 10)));
+  gtk_widget_show (gui_scale);
+  gtk_box_pack_start (GTK_BOX (vbox1), gui_scale, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
+
   curve1 = gtk_curve_new ();
   gtk_widget_show (curve1);
-  gtk_box_pack_start (GTK_BOX (hbox2), curve1, FALSE, FALSE, 0);
+  gtk_box_pack_start (GTK_BOX (hbox1), curve1, TRUE, TRUE, 0);
   gtk_curve_set_range (GTK_CURVE (curve1), 0, 1, 0, 1);
 
-  vseparator1 = gtk_vseparator_new ();
-  gtk_widget_show (vseparator1);
-  gtk_box_pack_start (GTK_BOX (hbox2), vseparator1, FALSE, FALSE, 0);
+  vbox2 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox2);
+  gtk_box_pack_start (GTK_BOX (hbox1), vbox2, TRUE, TRUE, 0);
 
-  vbox3 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox3);
-  gtk_box_pack_start (GTK_BOX (hbox2), vbox3, TRUE, TRUE, 0);
-
   drawingarea_histin = gtk_drawing_area_new ();
   gtk_widget_show (drawingarea_histin);
-  gtk_box_pack_start (GTK_BOX (vbox3), drawingarea_histin, TRUE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea_histin, 10, -1);
+  gtk_box_pack_start (GTK_BOX (vbox2), drawingarea_histin, TRUE, TRUE, 0);
 
   drawingarea_histout = gtk_drawing_area_new ();
   gtk_widget_show (drawingarea_histout);
-  gtk_box_pack_start (GTK_BOX (vbox3), drawingarea_histout, TRUE, TRUE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox2), drawingarea_histout, TRUE, TRUE, 0);
 
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, TRUE, 0);
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
 
-  buttonReset = gtk_button_new_from_stock ("gtk-clear");
-  gtk_widget_show (buttonReset);
-  gtk_box_pack_start (GTK_BOX (hbox1), buttonReset, FALSE, FALSE, 0);
+  button1 = gtk_button_new_from_stock ("gtk-clear");
+  gtk_widget_show (button1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), button1, A_RESET);
+  GTK_WIDGET_SET_FLAGS (button1, GTK_CAN_DEFAULT);
 
-  buttonCancel = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (buttonCancel);
-  gtk_box_pack_start (GTK_BOX (hbox1), buttonCancel, FALSE, FALSE, 0);
+  button2 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (button2);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), button2, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (button2, GTK_CAN_DEFAULT);
 
-  buttonApply = gtk_button_new_from_stock ("gtk-apply");
-  gtk_widget_show (buttonApply);
-  gtk_box_pack_start (GTK_BOX (hbox1), buttonApply, FALSE, FALSE, 0);
-
-  button3 = gtk_button_new_from_stock ("gtk-ok");
+  button3 = gtk_button_new_from_stock ("gtk-apply");
   gtk_widget_show (button3);
-  gtk_box_pack_start (GTK_BOX (hbox1), button3, FALSE, FALSE, 0);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), button3, GTK_RESPONSE_APPLY);
+  GTK_WIDGET_SET_FLAGS (button3, GTK_CAN_DEFAULT);
 
-  gui_scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 10, 10)));
-  gtk_widget_show (gui_scale);
-  gtk_box_pack_start (GTK_BOX (vbox1), gui_scale, TRUE, TRUE, 0);
+  button4 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (button4);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), button4, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (button4, GTK_CAN_DEFAULT);
 
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), drawingarea1, TRUE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, 100, 100);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
   /* Store pointers to all widgets, for use by lookup_widget(). */
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
   GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (dialog1, gui_scale, "gui_scale");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
   GLADE_HOOKUP_OBJECT (dialog1, curve1, "curve1");
-  GLADE_HOOKUP_OBJECT (dialog1, vseparator1, "vseparator1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
   GLADE_HOOKUP_OBJECT (dialog1, drawingarea_histin, "drawingarea_histin");
   GLADE_HOOKUP_OBJECT (dialog1, drawingarea_histout, "drawingarea_histout");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, "buttonReset");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonCancel, "buttonCancel");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonApply, "buttonApply");
-  GLADE_HOOKUP_OBJECT (dialog1, button3, "button3");
-  GLADE_HOOKUP_OBJECT (dialog1, gui_scale, "gui_scale");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, button1, "button1");
+  GLADE_HOOKUP_OBJECT (dialog1, button2, "button2");
+  GLADE_HOOKUP_OBJECT (dialog1, button3, "button3");
+  GLADE_HOOKUP_OBJECT (dialog1, button4, "button4");
 
-  //gtk_widget_grab_default (buttonApply);
   return dialog1;
 }
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eraser.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eraser.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eraser.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -776,6 +776,10 @@
     }
 
     dialog = create_eraser_dialog();
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+								GTK_RESPONSE_OK,
+								GTK_RESPONSE_CANCEL,
+								-1);
     gtk_register_dialog (dialog);
 
     // Fix up a bunch of things that Glade can't do.  This is less efficient

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -69,6 +69,10 @@
         height=in->getInfo()->height;
 
         dialog=create_dialog1();
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
         gtk_register_dialog(dialog);
         
         gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP("Hue"));

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -76,6 +76,12 @@
         GtkWidget *dialog;
 
         dialog=create_dialog1();
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
+
         gtk_register_dialog(dialog);
         
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -93,7 +93,13 @@
 	uint8_t ret=0;
 
 	dialog=create_dialog1();
-        gtk_register_dialog(dialog);
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
+	gtk_register_dialog(dialog);
 	
 	x=param->xoff;
 	y=param->yoff;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -58,7 +58,12 @@
     GtkWidget *dialog;
     int ret=0,done=0;
     dialog=create_dialog1();
-        
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+								GTK_RESPONSE_OK,
+								GTK_RESPONSE_CANCEL,
+								-1);
+
     // Update
     SPIN_SET(spinbuttonStart,_start);
     SPIN_SET(spinbuttonSize,_end);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -264,6 +264,11 @@
     uint32_t height = in->getInfo()->height;
 
     dialog = create_particle_dialog();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+								GTK_RESPONSE_OK,
+								GTK_RESPONSE_CANCEL,
+								-1);
     gtk_register_dialog (dialog);
     gtk_window_set_title (GTK_WINDOW (dialog),
                           QT_TR_NOOP("Particle Analysis Configuration"));

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -45,6 +45,11 @@
 	while(ret==2)
 	{
 		dialog=create_dialog1();
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_CANCEL,
+										GTK_RESPONSE_OK,
+										-1);
 		//  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(button1), GTK_RESPONSE_CANCEL);
 		//  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(button2), GTK_RESPONSE_OK);
 		//gtk_transient(dialog);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -41,6 +41,12 @@
 GtkTreeIter   iter;
 
 	dialog=create_dialog1();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
+
 	gtk_transient(dialog);
 	tree=lookup_widget(dialog,"treeview1");
 	gtk_signal_connect (GTK_OBJECT (lookup_widget(dialog,"treeview1")),

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -91,6 +91,13 @@
 	iw=*width;
 	ih=*height;
 	dialog=create_dialog1();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									GTK_RESPONSE_APPLY,
+									-1);
+
 	//gtk_transient(dialog);
         gtk_register_dialog(dialog);
 	erx=ery=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -87,6 +87,12 @@
         height=in->getInfo()->height;
 
         dialog=create_dialog1();
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+									GTK_RESPONSE_OK,
+									GTK_RESPONSE_CANCEL,
+									-1);
+
         gtk_register_dialog(dialog);
         gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP("Subtitle Size and Position"));
         gtk_widget_show(dialog);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -195,6 +195,12 @@
     uint32_t height = in->getInfo()->height;
 
     dialog = create_threshold_dialog();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
     gtk_register_dialog(dialog);
     gtk_window_set_title (GTK_WINDOW (dialog),
                           QT_TR_NOOP("Threshold Configuration"));

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -45,6 +45,11 @@
         nb=encoderGetNbEncoder();
         
         dialog=create_dialog1();
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+											GTK_RESPONSE_OK,
+											GTK_RESPONSE_CANCEL,
+											-1);
         	
         gtk_register_dialog(dialog);
         COMPRES_PARAMS *desc=videoCodecGetDescriptor (*codec);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -73,6 +73,12 @@
   while(!ext)
   {
     dialog = create_dialog1();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
     gtk_register_dialog(dialog);
     gtk_dialog_add_action_widget(GTK_DIALOG(dialog),WID(buttonSelect),GTK_RESPONSE_APPLY);
     

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -103,6 +103,12 @@
         specific=(ADM_x264Param *)config->extraSettings;
 
         dialog=create_dialog1();
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+											GTK_RESPONSE_OK,
+											GTK_RESPONSE_CANCEL,
+											-1);
+
         gtk_register_dialog(dialog);
         gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonResetDaults),ACTION_LOAD_DEFAULT);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -60,7 +60,11 @@
 	gint r,b;
 
 	dialog=create_dialog1();
-//	gtk_transient(dialog);
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
         gtk_register_dialog(dialog);
 
 	// set the right select button

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -65,6 +65,11 @@
       ADM_assert(incoming->extraSettingsLen==sizeof(localParam));
       memcpy(&localParam,incoming->extraSettings,sizeof(localParam));
       dialog=create_dialog1();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
       gtk_register_dialog(dialog);
 
 #define HIST_SET(x) gtk_option_menu_set_history(GTK_OPTION_MENU(WID(optionmenuType)), x)
@@ -435,6 +440,11 @@
 int col, row;
 
       dialog=create_dialog3();
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
       gtk_register_dialog(dialog);
       //
       for(int i=0;i<64;i++)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2008-06-18 19:35:02 UTC (rev 4125)
@@ -11,7 +11,7 @@
 libADM_dialogGtk_a_SOURCES =  DIA_vcodec.cpp DIA_acodec.cpp \
 	DIA_properties.cpp  DIA_about.cpp DIA_recent.cpp \
 	DIA_resize.cpp DIA_working.cpp \
-	DIA_working.h DIA_busy.cpp DIA_busy.h DIA_exLame.cpp DIA_pipe.cpp  \
+	DIA_working.h DIA_busy.cpp DIA_busy.h  \
 	DIA_xvid.cpp DIA_crop.cpp  DIA_encoding.cpp   \
 	DIA_xvid4.cpp  \
 	DIA_pause.cpp \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -65,7 +65,6 @@
   GtkWidget *colorselectiondialog1;
   GtkWidget *ok_button1;
   GtkWidget *cancel_button1;
-  GtkWidget *help_button1;
   GtkWidget *color_selection1;
 
   colorselectiondialog1 = gtk_color_selection_dialog_new (QT_TR_NOOP("Select Color"));
@@ -77,12 +76,7 @@
 
   cancel_button1 = GTK_COLOR_SELECTION_DIALOG (colorselectiondialog1)->cancel_button;
   gtk_widget_show (cancel_button1);
-  GTK_WIDGET_SET_FLAGS (cancel_button1, GTK_CAN_DEFAULT);
 
-  help_button1 = GTK_COLOR_SELECTION_DIALOG (colorselectiondialog1)->help_button;
-  gtk_widget_show (help_button1);
-  GTK_WIDGET_SET_FLAGS (help_button1, GTK_CAN_DEFAULT);
-
   color_selection1 = GTK_COLOR_SELECTION_DIALOG (colorselectiondialog1)->colorsel;
   gtk_widget_show (color_selection1);
   gtk_color_selection_set_has_opacity_control (GTK_COLOR_SELECTION (color_selection1), FALSE);
@@ -91,7 +85,6 @@
   GLADE_HOOKUP_OBJECT_NO_REF (colorselectiondialog1, colorselectiondialog1, "colorselectiondialog1");
   GLADE_HOOKUP_OBJECT_NO_REF (colorselectiondialog1, ok_button1, "ok_button1");
   GLADE_HOOKUP_OBJECT_NO_REF (colorselectiondialog1, cancel_button1, "cancel_button1");
-  GLADE_HOOKUP_OBJECT_NO_REF (colorselectiondialog1, help_button1, "help_button1");
   GLADE_HOOKUP_OBJECT_NO_REF (colorselectiondialog1, color_selection1, "color_selection1");
 
   return colorselectiondialog1;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -123,13 +123,17 @@
   cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
   gtk_widget_show (cancelbutton1);
   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
   
   okbutton1 = gtk_button_new_from_stock ("gtk-ok");
   gtk_widget_show (okbutton1);
   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
   GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
   
+  gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
   /* Finalize them */
   for(int i=0;i<nb;i++)
   {
@@ -206,13 +210,17 @@
   cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
   gtk_widget_show (cancelbutton1);
   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
   
   okbutton1 = gtk_button_new_from_stock ("gtk-ok");
   gtk_widget_show (okbutton1);
   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
   GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-  
+
+  gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_OK,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
   // Show it & run
   gtk_register_dialog(dialog);
   if(GTK_RESPONSE_OK==gtk_dialog_run(GTK_DIALOG(dialog)))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt	2008-06-18 19:35:02 UTC (rev 4125)
@@ -5,7 +5,7 @@
 SET(ADM_LIB ADM_filtersGtk)
 #
 SET(${ADM_LIB}_SRCS
-gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
+gui_filtermanager.cpp  gui_filtermanager_dialog.cpp
 
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2008-06-18 19:35:02 UTC (rev 4125)
@@ -7,7 +7,7 @@
 
 libADM_filtersGtk_a_METASOURCES = AUTO
 
-libADM_filtersGtk_a_SOURCES = gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
+libADM_filtersGtk_a_SOURCES = gui_filtermanager.cpp  gui_filtermanager_dialog.cpp
 
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -73,6 +73,12 @@
                                       GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                                       GTK_STOCK_OPEN, GTK_RESPONSE_ACCEPT,
                                       NULL);
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_ACCEPT,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
 	gtk_window_set_title (GTK_WINDOW (dialog),title);
         initFileSelector();
         setFilter(dialog);
@@ -145,6 +151,12 @@
                                       GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                                       GTK_STOCK_OPEN, GTK_RESPONSE_ACCEPT,
                                       NULL);
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_ACCEPT,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
 	gtk_window_set_title (GTK_WINDOW (dialog),title);
         initFileSelector();
         setFilter(dialog);
@@ -239,6 +251,12 @@
                                       GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                                       GTK_STOCK_OPEN, GTK_RESPONSE_ACCEPT,
                                       NULL);
+
+	gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+										GTK_RESPONSE_ACCEPT,
+										GTK_RESPONSE_CANCEL,
+										-1);
+
         gtk_window_set_title (GTK_WINDOW (dialog),title);
         gtk_register_dialog(dialog);
         /* Set default dir if provided ..*/
@@ -339,6 +357,11 @@
                                       GTK_STOCK_OPEN, GTK_RESPONSE_ACCEPT,
                                       NULL);
         }
+
+		gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
+											GTK_RESPONSE_ACCEPT,
+											GTK_RESPONSE_CANCEL,
+											-1);
 		gtk_dialog_set_default_response (GTK_DIALOG (dialog), GTK_RESPONSE_ACCEPT);
         /**********/
         initFileSelector();

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-06-18 17:44:39 UTC (rev 4124)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-06-18 19:35:02 UTC (rev 4125)
@@ -612,6 +612,12 @@
   GLADE_HOOKUP_OBJECT (dialog1, buttonNo, "buttonNo");
 
   gtk_widget_grab_default (buttonYes);
+
+  gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog1),
+										GTK_RESPONSE_YES,
+										GTK_RESPONSE_NO,
+										-1);
+
   return dialog1;
 }
 
@@ -684,6 +690,12 @@
   GLADE_HOOKUP_OBJECT (dialog1, buttonYes, "buttonYes");
 
   gtk_widget_grab_default (buttonYes);
+
+  gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog1),
+										GTK_RESPONSE_YES,
+										GTK_RESPONSE_NO,
+										-1);
+
   return dialog1;
 }
 



From mean at mail.berlios.de  Fri Jun 20 19:24:07 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 20 Jun 2008 19:24:07 +0200
Subject: [Avidemux-svn-commit] r4127 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiofilter
Message-ID: <200806201724.m5KHO772001272@sheep.berlios.de>

Author: mean
Date: 2008-06-20 19:24:01 +0200 (Fri, 20 Jun 2008)
New Revision: 4127

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
Log:
[Audio] Fix pal2film/film2pal + simplify (FS#441)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp	2008-06-19 00:34:59 UTC (rev 4126)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp	2008-06-20 17:24:01 UTC (rev 4127)
@@ -30,17 +30,15 @@
 #include "audioeng_process.h"
 #include "audiofilter_film2pal.h"
 
-
-#define PAL_SAM  25025
-#define FILM_SAM 24000
-
 //__________
 
 AUDMAudioFilterFilm2Pal::AUDMAudioFilterFilm2Pal(AUDMAudioFilter * instream):AUDMAudioFilter (instream)
 {
     // nothing special here...
-  _target=0.0;
+  _target=0;
+  _removed=0;
   _previous->rewind();
+  _modulo=0;
   printf("[Film2Pal] Creating\n");
 };
 
@@ -58,42 +56,42 @@
   
   shrink();
   fillIncomingBuffer(status);
-  float *head;
   
-  
-  shrink();
-  fillIncomingBuffer(status);
-  
   len=_tail-_head;
   if(len>max) len=max;
   
   len=len/min;
-  len*=min;
 
   rendered=0;
   start=&_incomingBuffer[_head];
-  while(len>=min)
+
+  while(len--) // in sample
   {
-    memcpy(buffer,start,min*sizeof(float));
-    buffer+=min;
-    start+=min;
-    rendered+=min;
-    len-=min;
-    _target+=(PAL_SAM-FILM_SAM);
-    _head+=min;
-    //_______________________________________
-    // Remove sample
-    // To compensate
-    //_______________________________________
-    // Fps higher=we have to accelerate sound = remove samples
-    // The compression factor is 1-((25-24)/25)	
-    while(_target>PAL_SAM && rendered>=min)
-    {	
-      rendered-=min;	
-      buffer-=min;
-      _target=_target-PAL_SAM;
-    }
-	
+        //_______________________________________
+        // FilmToPal : 24 fps to 25 fps -> shorten frame
+        // 1001 samples -> 960 samples
+        //______________________________________
+       if(_removed) // Fixme , use dither or something
+        { 
+              _removed--;
+        }
+        else
+        {
+        
+            memcpy(buffer,start,min*sizeof(float));
+            buffer+=min;
+            rendered+=min;    
+        }
+        _target++; // nb Processed
+     // Consume it
+        start+=min;
+        _head+=min;
+        _modulo++;
+        if(_target>1001)
+        {
+            _removed+=41;
+            _target-=1001;
+        }
   }
   return rendered;
 };
@@ -101,18 +99,21 @@
 AUDMAudioFilterPal2Film::AUDMAudioFilterPal2Film(AUDMAudioFilter * instream):AUDMAudioFilter (instream)
 {
     // nothing special here...
-  _target=0.0;
+  _target=0;
+  _removed=0;
+  _modulo=0;
   _previous->rewind();
   printf("[Pal2Film] Creating\n");
 };
 
 AUDMAudioFilterPal2Film::~AUDMAudioFilterPal2Film()
 {
-  printf("[Film2Pal] Creating\n");
+  printf("[Film2Pal] Destroying\n");
 }
 //
 //___________________________________________
 uint32_t AUDMAudioFilterPal2Film::fill( uint32_t max, float * buffer,AUD_Status *status)
+//uint32_t AUDMAudioFilterFilm2Pal::fill( uint32_t max, float * buffer,AUD_Status *status)
 {
   uint32_t len,i,rendered;
   uint32_t min=_wavHeader.channels;
@@ -120,42 +121,56 @@
   
   shrink();
   fillIncomingBuffer(status);
-  float *head;
   
+  ADM_assert(_tail>=_head);
   
-  shrink();
-  fillIncomingBuffer(status);
-  
-  len=_tail-_head;
+  len=_tail-_head;  // How much float available ?
   if(len>max) len=max;
   
-  len=len/min;
-  len*=min;
-
+  len=len/min; // convert to sample
+  
+  if(len==0)
+  {
+        printf("**oops**\n");
+  }
   rendered=0;
   start=&_incomingBuffer[_head];
-  while(len)
+  while(len--)
   {
         memcpy(buffer,start,min*sizeof(float));
+       // printf(" Target :%d removed :%d\n",_target,_removed);
         buffer+=min;
-        start+=min;
         rendered+=min;
-        len-=min;
-        _target+=(PAL_SAM-FILM_SAM);
+
+       
+        _target++; // _target is the number of sample we processed
+
+        _modulo++;
+
+        if(_target>960) // Time to duplicate samples
+        {
+            _removed+=41;
+            _target-=960;
+        }
+        if(rendered>=max-1)
+        {
+            start+=min;
+            _head+=min;
+            return rendered;
+        }
         //_______________________________________
-        // Duplicate sample
-        // To compensate
-        //_______________________________________
-        // In : One second is worth FILM_SAM samples
-        // Out:FILM_SAM+(PAL_SAM-FILM_SAM)*FILM_SAM/FILM_SAM=PAL_SAM = 25 fps
-      
-        while(_target>FILM_SAM)
+        // Pal2Film : 25 fps to 24 fps -> Duplicate samples
+        // by 41 samples every 960 samples 960->1001
+        //______________________________________
+        if(_removed /*&& ((_modulo&15)==1)*/) // Spread the duplication
         {
-          memcpy(buffer,start-min,min*sizeof(float));
+          memcpy(buffer,start,min*sizeof(float));
           buffer+=min;
           rendered+=min;			
-          _target=_target-FILM_SAM;
-        }
+          _removed--;
+        }  
+        start+=min;
+        _head+=min;
   }
   return rendered;
 };



From mean at mail.berlios.de  Fri Jun 20 19:24:30 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 20 Jun 2008 19:24:30 +0200
Subject: [Avidemux-svn-commit] r4128 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiofilter
Message-ID: <200806201724.m5KHOU0T002452@sheep.berlios.de>

Author: mean
Date: 2008-06-20 19:24:29 +0200 (Fri, 20 Jun 2008)
New Revision: 4128

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.h
Log:
[Audio] Fix pal2film/film2pal + simplify (FS#441)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.h	2008-06-20 17:24:01 UTC (rev 4127)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_film2pal.h	2008-06-20 17:24:29 UTC (rev 4128)
@@ -21,7 +21,9 @@
 class AUDMAudioFilterFilm2Pal : public AUDMAudioFilter
 {
   protected:
-    float  _target;
+    uint32_t   _target;
+    uint32_t _removed;
+    uint32_t _modulo;
   public:
                           AUDMAudioFilterFilm2Pal(AUDMAudioFilter *previous);
     virtual                ~AUDMAudioFilterFilm2Pal();
@@ -30,7 +32,10 @@
 class AUDMAudioFilterPal2Film : public AUDMAudioFilter
 {
   protected:
-    float  _target;
+    uint32_t   _target;
+    uint32_t _removed;
+    uint32_t _modulo;
+
   public:
                             AUDMAudioFilterPal2Film(AUDMAudioFilter *previous);
     virtual                ~AUDMAudioFilterPal2Film();



From mean at mail.berlios.de  Fri Jun 20 19:24:56 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 20 Jun 2008 19:24:56 +0200
Subject: [Avidemux-svn-commit] r4129 -
	branches/avidemux_2.4_branch/avidemux/ADM_script
Message-ID: <200806201724.m5KHOuFA003438@sheep.berlios.de>

Author: mean
Date: 2008-06-20 19:24:55 +0200 (Fri, 20 Jun 2008)
New Revision: 4129

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
Log:
[JS] Fix pal2film etc in js

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2008-06-20 17:24:29 UTC (rev 4128)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2008-06-20 17:24:55 UTC (rev 4129)
@@ -230,7 +230,7 @@
                                         break;
                                 priv->getObject()->m_bPAL2Film = JSVAL_TO_BOOLEAN(*vp);
                                 enterLock();
-                                audioFilterFilm2Pal(priv->getObject()->m_bPAL2Film);
+                                audioFilterPal2Film(priv->getObject()->m_bPAL2Film);
                                 leaveLock();
                                 break;
                         }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-20 17:24:29 UTC (rev 4128)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-20 17:24:55 UTC (rev 4129)
@@ -428,6 +428,7 @@
  	
        info.fps1000=fps;
         video_body->updateVideoInfo(&info);
+        video_body->getVideoInfo (avifileinfo);
         
 	leaveLock();
         return JS_TRUE;



From mean at mail.berlios.de  Sat Jun 21 11:46:29 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 11:46:29 +0200
Subject: [Avidemux-svn-commit] r4130 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: ADM_audio
	ADM_audiodevice ADM_outputs/oplug_avi
Message-ID: <200806210946.m5L9kT2v031708@sheep.berlios.de>

Author: mean
Date: 2008-06-21 11:46:28 +0200 (Sat, 21 Jun 2008)
New Revision: 4130

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/audio_packetizer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
Log:
[Audio] Port from 2.4 : PCM header, Alsa mixer, simplify audio


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/audio_packetizer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/audio_packetizer.cpp	2008-06-20 17:24:55 UTC (rev 4129)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/audio_packetizer.cpp	2008-06-21 09:46:28 UTC (rev 4130)
@@ -1,7 +1,7 @@
 /***************************************************************************
                           aviaudio.cpp  -  description
                              -------------------
-    begin                : 
+    begin                :
     copyright            : (C) 2004 by mean
     email                : fixounet at free.fr
 
@@ -35,7 +35,7 @@
 #include "ADM_audio/ADM_dcainfo.h"
 
 #define MINSTOCK 5000
-#define MINUS_ONE 0xffffffff	
+#define MINUS_ONE 0xffffffff
 
 //
 uint8_t AVDMGenericAudioStream::flushPacket(void)
@@ -46,7 +46,7 @@
 }
 uint8_t AVDMGenericAudioStream::getPacket(uint8_t *dest, uint32_t *len, uint32_t *samples)
 {
-	uint32_t instock=0,rd=0;	
+	uint32_t instock=0,rd=0;
 
 	if (_eos)
 		return 0;
@@ -56,7 +56,7 @@
 _refill:
 	shrink();
 	instock=packetTail-packetHead;
-	
+
 	while(instock<MINSTOCK)
 	{
 		rd=read(MINSTOCK,&packetBuffer[packetTail]);
@@ -102,7 +102,7 @@
 		case WAV_AC3:
 				return getPacketAC3(dest,len,samples);
 				break;
-				
+
 		case WAV_WMA:
 				return getPacketWMA(dest,len,samples);
 				break;
@@ -123,25 +123,25 @@
 		packetTail-=packetHead;
 		packetHead=0;
 	}
-	
+
 	return 1;
 }
 //___________________________
-uint8_t		AVDMGenericAudioStream::getPacketWMA(uint8_t *dest, uint32_t *len, 
+uint8_t		AVDMGenericAudioStream::getPacketWMA(uint8_t *dest, uint32_t *len,
 								uint32_t *samples)
 {
 	uint32_t align=_wavheader->blockalign;
 	uint32_t avail;
-	
-	
+
+
 	avail=packetTail-packetHead;
-	
+
 	if(avail>=align)
 	{
 		//printf("WMA: %lu\n",align);
 		memcpy(dest,&packetBuffer[packetHead],align);
 		packetHead+=align;
-		*samples=1024; 
+		*samples=1024;
 		#warning FIXME
 		*len=align;
 		return 1;
@@ -152,31 +152,32 @@
 	return 0;
 
 }
-//*************
-// The packet is 1024 bytes long BUT the 4/8 bytes (mono/stereo) are used for predictor initialization
-//
-// See Mike Melanson nice doc http://www.multimedia.cx/simpleaudio.html
-//___________________________
-uint8_t		AVDMGenericAudioStream::getPacketPCM(uint8_t *dest, uint32_t *len, 
+/**
+        \fn getPacketPCM
+        \brief
+*/
+uint8_t		AVDMGenericAudioStream::getPacketPCM(uint8_t *dest, uint32_t *len,
 								uint32_t *samples)
 {
-// Take ~ 10 m packets
+// Take ~ 32 samples packet
 //
 	uint32_t count,sample;
-			sample=_wavheader->frequency/100;			
-			count=sample*_wavheader->channels;
-                        if(_wavheader->encoding!=WAV_ULAW && _wavheader->encoding!=WAV_8BITS_UNSIGNED)
+    uint32_t sampleSizeInBytes=1;
+            if(_wavheader->encoding!=WAV_ULAW && _wavheader->encoding!=WAV_8BITS_UNSIGNED)
 			{
-				count*=2;			
+				sampleSizeInBytes=2;
 			}
+			count=32*_wavheader->channels;
+            count*=sampleSizeInBytes;
+
 			if(packetTail-packetHead<count)
 			{
 				count=packetTail-packetHead;
-				count&=0xffffffC;
+				count&=~(sampleSizeInBytes*_wavheader->channels);
 			}
-			memcpy(dest,&packetBuffer[packetHead],count);			
+			memcpy(dest,&packetBuffer[packetHead],count);
 			packetHead+=count;
-			
+
 			// now revert to sample
 			sample=count/_wavheader->channels;
 			if(!sample)
@@ -185,27 +186,19 @@
 				printf("Wav Packetizer: running empty, last packet sent\n");
 				return 0;
 			}
-                        if(_wavheader->encoding!=WAV_ULAW && _wavheader->encoding!=WAV_8BITS_UNSIGNED&&
-                                        _wavheader->encoding!=WAV_IMAADPCM  )
-			{
-				*samples=sample/2;
-			}
-			else
-			{
-				*samples=sample;
-			}
+			*samples=sample/sampleSizeInBytes;
 			*len=count;
 			return 1;
 }
-	
-uint8_t		AVDMGenericAudioStream::getPacketAC3(uint8_t *dest, uint32_t *len, 
+
+uint8_t		AVDMGenericAudioStream::getPacketAC3(uint8_t *dest, uint32_t *len,
 								uint32_t *samples)
 {
 	uint32_t instock,rd;
 	uint32_t startOffset,endOffset;
 	uint8_t  lock=0;
 	uint8_t  headerfound=0;
-				
+
 			ADM_assert(_wavheader->encoding==WAV_AC3);
 			ADM_assert(packetTail>=packetHead);
 			if(packetTail<packetHead+6)
@@ -218,13 +211,13 @@
 			int flags,sample_rate,bit_rate;
 			int found=0;
 			uint32_t start,size=0;
-			
+
 			start=packetHead;
 
 			while(start+6<packetTail)
 			{
 				if(packetBuffer[start]!=0x0b || packetBuffer[start+1]!=0x77)
-				{	
+				{
 					if(!lock)
 					{
 						printf("AC3: searching sync ");
@@ -237,10 +230,10 @@
 					start++;
 					continue;
 				}
-			
-			
-				size= ADM_a52_syncinfo (&packetBuffer[start], &flags, 
-						&sample_rate, &bit_rate);			
+
+
+				size= ADM_a52_syncinfo (&packetBuffer[start], &flags,
+						&sample_rate, &bit_rate);
 				if(!size)
 				{
 					printf("AC3: Cannot sync\n");
@@ -261,7 +254,7 @@
 					printf("AC3Pkt: Need %lu have:%lu\n",size,packetTail-packetHead);
 					break;
 				}
-			
+
 			}
 			if(!found)
 			{
@@ -282,8 +275,8 @@
 			}
 			*len=size;
 			*samples=1536;
-			
-			
+
+
 			return 1;
 }
 uint8_t		AVDMGenericAudioStream::getPacketDTS(uint8_t *dest, uint32_t *len,uint32_t *samples)
@@ -310,9 +303,9 @@
 
                 while(start+DTS_HEADER_SIZE<packetTail)
                 {
-                        if(packetBuffer[start]!=0x07f || packetBuffer[start+1]!=0xfe|| 
+                        if(packetBuffer[start]!=0x07f || packetBuffer[start+1]!=0xfe||
                             packetBuffer[start+2]!=0x80|| packetBuffer[start+3]!=0x01)
-                        {	
+                        {
                             if(!lock)
                             {
                                     printf("DTS: searching sync ");
@@ -374,7 +367,7 @@
 		to avoid as much as possible false detection
 
 */
-uint8_t		AVDMGenericAudioStream::getPacketMP3(uint8_t *dest, uint32_t *len, 
+uint8_t		AVDMGenericAudioStream::getPacketMP3(uint8_t *dest, uint32_t *len,
 								uint32_t *samples)
 {
 	uint32_t instock,rd;
@@ -382,9 +375,9 @@
 	uint32_t layer;
 	uint32_t size;
 	MpegAudioInfo mpegInfo,mpegTemp;
-			
+
 			ADM_assert(_wavheader->encoding==WAV_MP2||_wavheader->encoding==WAV_MP3);
-_retry:                        
+_retry:
 			if(packetTail<packetHead+4)
 			{
 				printf("PKTZ: MP3Buffer empty:%lu / %lu\n",packetHead,packetTail);
@@ -393,10 +386,10 @@
 			// Build template, only fq ATM
 			memset(&mpegTemp,0,sizeof(mpegTemp));
 			mpegTemp.samplerate=_wavheader->frequency;
-			
+
 			// It is MP3, read packet
 			// synchro start
-			
+
 			if(!getMpegFrameInfo(&(packetBuffer[packetHead]),packetTail-packetHead,
 						&mpegInfo,&mpegTemp,&startOffset))
 			{
@@ -429,16 +422,16 @@
                                packetHead+=mpegInfo.size;
                         // /Patch
 			return 1;
-}		
+}
 //---
-uint8_t		AVDMGenericAudioStream::getPacketAAC(uint8_t *dest, uint32_t *len, 
+uint8_t		AVDMGenericAudioStream::getPacketAAC(uint8_t *dest, uint32_t *len,
 								uint32_t *samples)
 {
 	uint32_t instock,rd;
 	uint32_t startOffset,endOffset;
 	AacAudioInfo mpegInfo,mpegTemp;
-	
-				
+
+
 			ADM_assert(_wavheader->encoding==WAV_AAC);
 			if(packetTail<packetHead+8)
 			{

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2008-06-20 17:24:55 UTC (rev 4129)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2008-06-21 09:46:28 UTC (rev 4130)
@@ -26,8 +26,8 @@
 #include <errno.h>
 #include <sys/types.h>
 #include "prefs.h"
- 
 
+
 #ifdef ALSA_SUPPORT
 #include <alsa/asoundlib.h>
 #include "ADM_assert.h"
@@ -51,7 +51,7 @@
 uint8_t alsaAudioDevice::init( uint8_t channel,uint32_t fq )
 {
 	int dir=0;
-	
+
 	_channels=channel;
 	_init=0;
    /* Playback stream */
@@ -67,7 +67,7 @@
   static char *pcm_name;
   if( prefs->get(DEVICE_AUDIO_ALSA_DEVICE, &pcm_name) != RC_OK )
                pcm_name = ADM_strdup("plughw:0,0");
-	
+
  /* Allocate the snd_pcm_hw_params_t structure on the stack. */
     snd_pcm_hw_params_alloca(&hwparams);
     snd_pcm_sw_params_alloca(&swparams);
@@ -107,9 +107,9 @@
     //  fprintf(stderr, "Error setting float format.\n");
 
 #ifdef ADM_BIG_ENDIAN
-    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_BE) < 0) 
+    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_BE) < 0)
 #else
-    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_LE) < 0) 
+    if (snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_LE) < 0)
 #endif
     {
       fprintf(stderr, "Error setting format.\n");
@@ -297,8 +297,9 @@
 		ADM_dealloc(pcm_name);
 		return 0;
 	}
-	if( (rc=snd_mixer_attach(mixer_handle,pcm_name)) < 0 ){
-		printf("ALSA: snd_mixer_attach failed: %d\n",rc);
+// MEANX: Cannot use the real name, does not work with dmix
+	if( (rc=snd_mixer_attach(mixer_handle,"hw:0")) < 0 ){
+		printf("ALSA: snd_mixer_attach failed: %d, %s\n",rc, snd_strerror (rc));
 		snd_mixer_close(mixer_handle);
 		ADM_dealloc(pcm_name);
 		return 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-20 17:24:55 UTC (rev 4129)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-06-21 09:46:28 UTC (rev 4130)
@@ -14,7 +14,7 @@
  /*
  * MODIFIED Feb 2005 by GMV: ODML write support
  */
- 
+
 /***************************************************************************
  *                                                                         *
  *   This program is free software; you can redistribute it and/or modify  *
@@ -73,7 +73,7 @@
 	LMovie=NULL;
 	LMain=NULL;
         _file=NULL;
-		
+
 	// MOD Feb 2005 by GMV: ODML support
 	odml_indexes=NULL;
 	// END MOD Feb 2005 by GMV
@@ -120,13 +120,13 @@
   UNUSED_ARG(astream);
 
         ADM_assert(_file);
-        
+
         _file->seek(32);
 // Update main header
 #ifdef ADM_BIG_ENDIAN
 	MainAVIHeader ma;
 	memcpy(&ma,mainheader,sizeof(MainAVIHeader));
-	Endian_AviMainHeader(&ma);		
+	Endian_AviMainHeader(&ma);
   	_file->write ((uint8_t *)&ma, sizeof (ma));
 #else
   	_file->write ((uint8_t *)mainheader, sizeof (MainAVIHeader));
@@ -137,7 +137,7 @@
 
 	AVIStreamHeader as;
 	memcpy(&as,videostream,sizeof(as));
-	Endian_AviStreamHeader(&as);		
+	Endian_AviStreamHeader(&as);
   	_file->write ((uint8_t *)&as, sizeof (as));
 #else
         _file->write ((uint8_t *)videostream, sizeof (AVIStreamHeader));
@@ -159,8 +159,8 @@
   ADM_assert (_file);
   ADM_assert (LAll == NULL);
   _file->seek(0);
-  
 
+
   LAll = new AviList ("RIFF", _file);
   LAll->Begin ("AVI ");
   // Header chunk
@@ -171,8 +171,8 @@
 #ifdef ADM_BIG_ENDIAN
 	MainAVIHeader ma;
 	memcpy(&ma,&_mainheader,sizeof(ma));
-	Endian_AviMainHeader(&ma);		
-	LMain->Write((uint8_t *)&ma,sizeof(ma));	
+	Endian_AviMainHeader(&ma);
+	LMain->Write((uint8_t *)&ma,sizeof(ma));
 #else
   	LMain->Write ((uint8_t *) &_mainheader, sizeof (MainAVIHeader));
 #endif
@@ -194,7 +194,7 @@
 	uint32_t odml_video_super_idx_size;
         if(doODML!=NORMAL)
         {
-            
+
             odml_video_super_idx_size=24+odml_default_nbrof_index*16;
         }else
         {
@@ -203,11 +203,11 @@
 	// END MOD Feb 2005 by GMV
 #ifdef ADM_BIG_ENDIAN
 	// in case of Little endian, do the usual swap crap
-	
+
 	AVIStreamHeader as;
 	ADM_BITMAPINFOHEADER b;
 	memcpy(&as,&_videostream,sizeof(as));
-	Endian_AviStreamHeader(&as);		
+	Endian_AviStreamHeader(&as);
 	memcpy(&b,&_bih,sizeof(_bih));
 	Endian_BitMapInfo( &b );
   	setStreamInfo (_file, (uint8_t *) &as,
@@ -215,7 +215,7 @@
 		// MOD Feb 2005 by GMV: ODML support
 		odml_video_super_idx_size,0,
 		// END MOD Feb 2005 by GMV
-		  extra,extraLen, 	 
+		  extra,extraLen,
 		 0x1000);
 #else
   	setStreamInfo (_file, (uint8_t *) &_videostream,
@@ -223,7 +223,7 @@
 		// MOD Feb 2005 by GMV: ODML support
 		odml_video_super_idx_size,0,
 		// END MOD Feb 2005 by GMV
-		  extra,extraLen, 	 
+		  extra,extraLen,
 		 0x1000);
 
 #endif
@@ -243,7 +243,7 @@
 //________________________________________________
 //   Beginning of the write process
 //   We fill-in the headers
-//	3- Write audio headers 
+//	3- Write audio headers
 //   That one can be used several times so we pass stuff
 //   as parameter
 //_______________________________________________
@@ -252,7 +252,7 @@
 	96000, 88200, 64000, 48000,
 	44100, 32000, 24000, 22050,
 	16000, 12000, 11025,  8000,
-	0,     0,     0,     0 
+	0,     0,     0,     0
 };
 /**
         \fn WriteAudioHeader
@@ -274,7 +274,7 @@
 uint8_t aacHeader[12];
 uint8_t *extra=NULL;
 uint32_t extraLen=0;
-     
+
 	if(!stream) return 1;
         if(doODML!=NORMAL)
         {
@@ -293,8 +293,8 @@
 	wmaheader[25-16]=01;
 
         memcpy(&wav,stream->getInfo (),sizeof(wav));
-      
 
+
       memset (header, 0, sizeof (AVIStreamHeader));
       header->fccType = fourCC::get ((uint8_t *) "auds");
       header->dwInitialFrames = 0;
@@ -304,83 +304,83 @@
       header->dwQuality = 0xffffffff;
       header->dwSuggestedBufferSize = 8000;
       header->dwLength = stream->getLength ();
-      
+
 	switch(wav.encoding)
 	{
-                case WAV_IMAADPCM:
-                        wav.blockalign=1024;
-                        header->dwScale         = wav.blockalign;
-                        header->dwSampleSize    = 1;
-                        header->dwInitialFrames =1;                             
-                        header->dwSuggestedBufferSize=2048;                                
-                        break;
+        case WAV_IMAADPCM:
+                wav.blockalign=1024;
+                header->dwScale         = wav.blockalign;
+                header->dwSampleSize    = 1;
+                header->dwInitialFrames =1;
+                header->dwSuggestedBufferSize=2048;
+                break;
 		case WAV_AAC:
 		{
-		// nb sample in stream  
-		
+		// nb sample in stream
+
 			double len;
 			len=_videostream.dwLength;
-#if 1			
+#if 1
 			len/=_videostream.dwRate;
-			len*=_videostream.dwScale;			
+			len*=_videostream.dwScale;
 			len*=wav.frequency;
 			len/=1024;
-#else		
-			header->dwLength= floor(len);//_videostream.dwLength; 
-#endif			
+#else
+			header->dwLength= floor(len);//_videostream.dwLength;
+#endif
 		 // AAC is mostly VBR
 		 header->dwFlags=1;
 		 header->dwInitialFrames=0;
 		 header->dwRate=wav.frequency;
-		 
-		 	
-		 
+
+
+
 		 header->dwScale=1024; //sample/packet 1024 seems good for aac
 		 header->dwSampleSize = 0;
 		 header->dwSuggestedBufferSize=8192;
-		 header->dwInitialFrames = 0;	 
-		
-		// header->dwLength= _videostream.dwLength; 
-		 wav.blockalign=1024;	  
-		 wav.bitspersample = 0; 
-		 
+		 header->dwInitialFrames = 0;
+
+		// header->dwLength= _videostream.dwLength;
+		 wav.blockalign=1024;
+		 wav.bitspersample = 0;
+
 		//*b++ = (BYTE)((profile +1) << 3 | (SRI >> 1));
 		//*b++ = (BYTE)(((SRI & 0x1) << 7) | (aacsource->GetChannelCount() << 3));
-		
+
 		int SRI=4;	// Default 44.1 khz
 		for(int i=0;i<16;i++) if(wav.frequency==aacBitrate[i]) SRI=i;
 		aacHeader[0]=0x2;
 		aacHeader[1]=0x0;
 		aacHeader[2]=(2<<3)+(SRI>>1); // Profile LOW
 		aacHeader[3]=((SRI&1)<<7)+((wav.channels)<<3);
-		
 
+
 		extra=&(aacHeader[0]);
 		extraLen=4;
 		}
 		break;
-#if 1		
-	case WAV_DTS:
-	case WAV_AC3: // Vista compatibility
-		 		  extra=(uint8_t *)wmaheader;
-		 		  extra[0]=0;
-		 		  extra[1]=0;
-				  extraLen=2;
-				  header->dwScale = 1;  
-				  wav.blockalign=1;	
-			break;
-#endif			
-	case WAV_MP3:							
+#if 1
+        case WAV_DTS:
+        case WAV_AC3: // Vista compatibility
+                      extra=(uint8_t *)wmaheader;
+                      extra[0]=0;
+                      extra[1]=0;
+                      extraLen=2;
+                      header->dwScale = 1;
+                      wav.blockalign=1;
+                break;
+#endif
+	case WAV_MP3:
 		  // then update VBR fields
 		  mp3vbr.cbsize = R16(12);
 		  mp3vbr.wId = R16(1);
-		  mp3vbr.fdwflags = R32(2);				  
+		  mp3vbr.fdwflags = R32(2);
 	    	  mp3vbr.nframesperblock = R16(1);
 		  mp3vbr.ncodecdelay = 0;
-		  
+
 		  wav.bitspersample = 0;
 		  mp3vbr.nblocksize=R16(0x180); //384; // ??
-    
+
 		  header->dwScale = 1;
 	  	  header->dwInitialFrames = 1;
                   extra=(uint8_t *)&mp3vbr;
@@ -390,69 +390,74 @@
 		  	//ADM_assert (audiostream->asTimeTrack ());
 		  	wav.blockalign = 1152;	// just a try
 		     	wav.bitspersample = 16;
-		  
+
 		    	header->dwRate 	= wav.frequency;	//wav->byterate;
 			header->dwScale = wav.blockalign;
 			header->dwLength= _videostream.dwLength;
-		   
+
   			header->dwSampleSize = 0;
 		  	printf ("\n VBR audio detected\n");
 		  	//
 		  	// use extended headers
-		  	//		
 		  	//
-			mp3vbr.nblocksize=1152;	
-			
-		   }	
-		   else 
+		  	//
+			mp3vbr.nblocksize=1152;
+
+		   }
+		   else
                    {
                      wav.blockalign=1;
-                     
-                     
+
+
                    }
 
-			
 
+
 			  break;
-	
-					 
+
+
 	case WAV_WMA:
 			header->dwScale 	= wav.blockalign;
 			header->dwSampleSize 	= wav.blockalign;
-			header->dwInitialFrames =1;				
-			header->dwSuggestedBufferSize=10*wav.blockalign;				
-			
+			header->dwInitialFrames =1;
+			header->dwSuggestedBufferSize=10*wav.blockalign;
 			extra=(uint8_t *)&wmaheader;
 			extraLen=12;
 			break;
-          case WAV_8BITS_UNSIGNED:
-                        wav.encoding=WAV_PCM;
-			header->dwScale 	= 1;
-                        wav.bitspersample=8;
-                        break;
-                        
-                        
+    case WAV_PCM:
+    case WAV_LPCM:
+            header->dwScale=header->dwSampleSize=wav.blockalign=2*wav.channels; // Realign
+            header->dwLength/=header->dwScale;
+            break;
+    case WAV_8BITS_UNSIGNED:
+            wav.encoding=WAV_PCM;
+			header->dwScale=header->dwSampleSize=wav.blockalign=wav.channels;
+			header->dwLength/=header->dwScale;
+            wav.bitspersample=8;
+            break;
+
+
 	default:
-			header->dwScale = 1;  
-			wav.blockalign=1;	
+			header->dwScale = 1;
+			wav.blockalign=1;
 			break;
     }
 #ifdef ADM_BIG_ENDIAN
 	// in case of Little endian, do the usual swap crap
-	
+
 	AVIStreamHeader as;
 	WAVHeader w;
 	memcpy(&as,header,sizeof(as));
-	Endian_AviStreamHeader(&as);		
+	Endian_AviStreamHeader(&as);
 	memcpy(&w,&wav,sizeof(w));
 	Endian_WavHeader( &w );
-  	setStreamInfo (_file, 
+  	setStreamInfo (_file,
 		(uint8_t *) &as,
 		  (uint8_t *)&w,sizeof(WAVHeader),
 		// MOD Feb 2005 by GMV: ODML support
 		odml_audio_super_idx_size,odml_stream_nbr,
 		// END MOD Feb 2005 by GMV
-		  extra,extraLen, 	 
+		  extra,extraLen,
 		 0x1000);
 #else
 	setStreamInfo (_file,
@@ -475,7 +480,7 @@
 //
 //_______________________________________________________
 uint8_t aviWrite::saveBegin (char 	*name,
-		     MainAVIHeader 	*inmainheader, 
+		     MainAVIHeader 	*inmainheader,
 		     uint32_t 		nb_frame,
 		     AVIStreamHeader * invideostream,
 		     ADM_BITMAPINFOHEADER	*bih,
@@ -505,14 +510,14 @@
         curindex = 0;
         vframe = asize = 0;
         nb_audio=0;
-        
+
 // update avi header according to the information WE want
 //
         memcpy (&_mainheader, inmainheader, sizeof (MainAVIHeader));
         _mainheader.dwFlags = AVIF_HASINDEX + AVIF_ISINTERLEAVED;
 
 
-        
+
 // update main header codec with video codev
         if (inaudiostream)
         {
@@ -543,10 +548,10 @@
         f*=1000;
         f/=_videostream.dwScale;
         _mainheader.dwMicroSecPerFrame=ADM_UsecFromFps1000( (uint32_t)floor(f));
-        
 
+
         // Recompute image size
-uint32_t is;	
+uint32_t is;
         is=_bih.biWidth*_bih.biHeight;
         is*=(_bih.biBitCount+7)/8;
         _bih.biSizeImage=is;
@@ -561,15 +566,15 @@
 	}
 	// set generation mode
         uint32_t pref_odml=0;
-        
+
         if(!prefs->get(FEATURE_USE_ODML, &pref_odml))
         {
-          pref_odml=0;                
-        }            
-        
+          pref_odml=0;
+        }
+
 	doODML=NO;	// only option for users without largefile support
 	#if defined _FILE_OFFSET_BITS && _FILE_OFFSET_BITS == 64
-        if(pref_odml)        
+        if(pref_odml)
 	       doODML=HIDDEN;	// default; TODO: user should be able to choose NO for plain avi
 	#endif
 	if(doODML!=NO){
@@ -578,9 +583,9 @@
 		aprintf("\nnumber of streams: %lu\n",odml_nbrof_streams);
 		// get number of frames per index
 
-		odml_index_size=(long)ceil(1000000.0/(double)_mainheader.dwMicroSecPerFrame*600.0);	// one index per 10 Minutes; decrease if 4GB are not enough for this amount of time 
+		odml_index_size=(long)ceil(1000000.0/(double)_mainheader.dwMicroSecPerFrame*600.0);	// one index per 10 Minutes; decrease if 4GB are not enough for this amount of time
                 aprintf("\n old number of frames per index: %lu\n",odml_index_size);
-                double fps=invideostream->dwRate/invideostream->dwScale;      
+                double fps=invideostream->dwRate/invideostream->dwScale;
 
                         aprintf("Fps1000:%f\n",fps);
                         fps=600*fps; // 10 mn worth;
@@ -618,7 +623,7 @@
             odml_default_nbrof_index=16;
         }
 	// END MOD Feb 2005 by GMV
-	
+
   //___________________
   // Prepare header
   //___________________
@@ -629,9 +634,9 @@
 
 	// MOD Feb 2005 by GMV: ODML support
 	/*writeAudioHeader (	inaudiostream , &_audio1 );
-	writeAudioHeader (	inaudiostream2, &_audio2);*/ 
+	writeAudioHeader (	inaudiostream2, &_audio2);*/
 	writeAudioHeader (	inaudiostream , &_audio1,1);
-	writeAudioHeader (	inaudiostream2, &_audio2,2); 
+	writeAudioHeader (	inaudiostream2, &_audio2,2);
 	// odml header placeholder
 	odml_write_dummy_chunk(LMain, &odml_header_fpos, 16);
 	// END MOD Feb 2005 by GMV
@@ -642,7 +647,7 @@
   //
 
   ADM_assert (!LMovie);
-  
+
   LMovie = new AviList ("LIST", _file);
   LMovie->Begin ("movi");
   curindex = 0;
@@ -660,7 +665,7 @@
 uint8_t aviWrite::saveVideoFrame (uint32_t len, uint32_t flags, uint8_t * data)
 {
   vframe++;
-  // MOD Feb 2005 by GMV:  interleave ODML index dummy and index frame 
+  // MOD Feb 2005 by GMV:  interleave ODML index dummy and index frame
 	// write initial index chunks
 	if(vframe==2 && doODML!=NO){	// apparently some players require a video frame at first in the movi list, so we put the initial index dummys behind it (bye bye index before data)
 		odml_write_dummy_chunk(LMovie, &(odml_indexes[0].odml_index[0].fpos), 24+8*odml_index_size);
@@ -751,14 +756,14 @@
             // END MOD Feb 2005 by GMV
             printf ("\n writing %lu index parts", curindex);
             printf ("\n received %lu video parts", vframe);
-            
+
             // Updating compared to what has been really written
             //
-            
-            // Write index  
+
+            // Write index
             LAll->Write32 ("idx1");
             LAll->Write32 (curindex * 16);
-            
+
             for (uint32_t i = 0; i < curindex; i++)
                 {
                 LAll->Write32 (myindex[i].fcc);
@@ -807,7 +812,7 @@
 				printf("error writing audio (dual) indexes");
 			}
 	}
-	odml_destroy_index();		
+	odml_destroy_index();
 // END MOD Feb 2005 by GMV
 #ifdef MOVINDEX
   LAll->End ();
@@ -822,7 +827,7 @@
 	else
   _mainheader.dwTotalFrames = vframe;
 // END MOD Feb 2005 by GMV
-	
+
   _videostream.dwLength = vframe;
   //astream.dwLength = asize;
 
@@ -835,7 +840,7 @@
   // AUDIO SIZE ->TODO
   delete _file;
   _file=NULL;
-  
+
   qfclose (_out);
   _out = NULL;
   return 1;
@@ -847,7 +852,7 @@
 //
 uint8_t aviWrite::setStreamInfo (ADMFile * fo,
 			 uint8_t * stream,
-			 uint8_t * info, uint32_t infolen, 
+			 uint8_t * info, uint32_t infolen,
 			// MOD Feb 2005 by GMV: ODML support
 			 uint32_t odml_headerlen,
 			 uint8_t odml_stream_nbr,
@@ -886,17 +891,17 @@
     uint32_t consumed=odml_headerlen*4;
   junklen = (consumed+maxxed-1)/maxxed;
   junklen=junklen*maxxed;
-  
+
   printf("[ODML] using ODML placeholder of size %u bytes\n",junklen);
   junk = (uint8_t *) ADM_alloc (junklen);
   ADM_assert (junk);
   memset (junk,0, junklen);
   //
-  // Fill junk with out info string  
+  // Fill junk with out info string
   uint32_t len=strlen("Avidemux");
-  
+
   if(junklen>len)
-  	memcpy(junk,"Avidemux",len);	
+  	memcpy(junk,"Avidemux",len);
 
   if(doODML!=NO)
   {
@@ -926,10 +931,10 @@
 uint32_t pos;
 	 // we take size of file + index
 	 // with 32 bytes per index entry
-	 // 
+	 //
 	 ADM_assert(_file);
 	 pos=_file->tell();
-	 return pos+curindex*4*4;	 	
+	 return pos+curindex*4*4;
 }
 
 // MOD Feb 2005 by GMV:  ODML functions
@@ -964,7 +969,7 @@
 		uint8_t* dummy=(uint8_t*)ADM_alloc (size);
 		memset(dummy,0,size);
 		// write dummy chunk
-		alist->WriteChunk ((uint8_t *) "JUNK", size, dummy);	
+		alist->WriteChunk ((uint8_t *) "JUNK", size, dummy);
 		// clean up
 		ADM_dealloc (dummy);
 	}
@@ -1011,7 +1016,7 @@
 			if(sidx->index_count>=sidx->odml_nbrof_index-1)	// can index counter be increased?
                                 reallocIndeces(sidx);
                         ++(sidx->index_count);	// increment index counter
-			
+
 			// handle possible riff break
 			odml_riff_break(data_size+8); // data size + fcc + size info (padding is handled in odml_riff_break)
 			// write placeholder
@@ -1020,27 +1025,27 @@
 		}
 		odml_index_t* idx=sidx->odml_index+(sidx->index_count);		// access to index
 		odml_index_data_t* idxd=idx->index+(idx->nEntriesInUse);	// access to unused index data
-		
+
 		uint64_t pos=LMovie->Tell()+8;	// preview position of data
 		idxd->fpos=pos;	// store file position of data
-		
+
 		if(keyFrame)
 			idxd->size=data_size; //store data size
 		else	// if no key frame
 			idxd->size=data_size|0x80000000; //store data size with bit 31 set
-		
+
 		++(idx->nEntriesInUse);	// advance to next free index data entry
 	}
 	return true;
 }
 void aviWrite::odml_write_sindex(int stream_nbr, const char* stream_fcc)
 {
-        
+
 	// Warning: This changes the file position
 	if(doODML==NORMAL)
                 {
                     uint32_t startAt=odml_indexes[stream_nbr].fpos;
-                    uint32_t pad=odml_indexes[stream_nbr].pad; 
+                    uint32_t pad=odml_indexes[stream_nbr].pad;
                     uint32_t endAt=startAt+pad+8;
 #ifndef MOVINDEX
 		_file->seek(startAt);
@@ -1069,7 +1074,7 @@
                         odml_indexes[stream_nbr].odml_index[a].nEntriesInUse);
 		}
                 uint32_t at=LIndex->Tell();
-                
+
                 int32_t junkLen=endAt-at-8;
                 ADM_assert(junkLen>=9);
                 printf("Padding ODML index with junk of size %d, total padding %lu\n",junkLen, odml_indexes[stream_nbr].pad);
@@ -1082,9 +1087,9 @@
                 delete [] zz;
                 ADM_assert(endAt==Junk->Tell());
                 delete Junk;
-                
-                
-	}	
+
+
+	}
 }
 bool aviWrite::odml_write_index(int stream_nbr, const char* stream_fcc, const char* index_fcc){	// write index
 	// Warning: This changes the file position



From mean at mail.berlios.de  Sat Jun 21 11:46:30 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 11:46:30 +0200
Subject: [Avidemux-svn-commit] r4131 - in
	branches/avidemux_2.5_branch_gruntster/avidemux:
	ADM_audiofilter ADM_script
Message-ID: <200806210946.m5L9kUlW031719@sheep.berlios.de>

Author: mean
Date: 2008-06-21 11:46:30 +0200 (Sat, 21 Jun 2008)
New Revision: 4131

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
Log:
[Audio] Port of pal2film from 2.4


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp	2008-06-21 09:46:28 UTC (rev 4130)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.cpp	2008-06-21 09:46:30 UTC (rev 4131)
@@ -30,17 +30,15 @@
 #include "audioeng_process.h"
 #include "audiofilter_film2pal.h"
 
-
-#define PAL_SAM  25025
-#define FILM_SAM 24000
-
 //__________
 
 AUDMAudioFilterFilm2Pal::AUDMAudioFilterFilm2Pal(AUDMAudioFilter * instream):AUDMAudioFilter (instream)
 {
     // nothing special here...
-  _target=0.0;
+  _target=0;
+  _removed=0;
   _previous->rewind();
+  _modulo=0;
   printf("[Film2Pal] Creating\n");
 };
 
@@ -58,42 +56,42 @@
   
   shrink();
   fillIncomingBuffer(status);
-  float *head;
   
-  
-  shrink();
-  fillIncomingBuffer(status);
-  
   len=_tail-_head;
   if(len>max) len=max;
   
   len=len/min;
-  len*=min;
 
   rendered=0;
   start=&_incomingBuffer[_head];
-  while(len>=min)
+
+  while(len--) // in sample
   {
-    memcpy(buffer,start,min*sizeof(float));
-    buffer+=min;
-    start+=min;
-    rendered+=min;
-    len-=min;
-    _target+=(PAL_SAM-FILM_SAM);
-    _head+=min;
-    //_______________________________________
-    // Remove sample
-    // To compensate
-    //_______________________________________
-    // Fps higher=we have to accelerate sound = remove samples
-    // The compression factor is 1-((25-24)/25)	
-    while(_target>PAL_SAM && rendered>=min)
-    {	
-      rendered-=min;	
-      buffer-=min;
-      _target=_target-PAL_SAM;
-    }
-	
+        //_______________________________________
+        // FilmToPal : 24 fps to 25 fps -> shorten frame
+        // 1001 samples -> 960 samples
+        //______________________________________
+       if(_removed) // Fixme , use dither or something
+        { 
+              _removed--;
+        }
+        else
+        {
+        
+            memcpy(buffer,start,min*sizeof(float));
+            buffer+=min;
+            rendered+=min;    
+        }
+        _target++; // nb Processed
+     // Consume it
+        start+=min;
+        _head+=min;
+        _modulo++;
+        if(_target>1001)
+        {
+            _removed+=41;
+            _target-=1001;
+        }
   }
   return rendered;
 };
@@ -101,18 +99,21 @@
 AUDMAudioFilterPal2Film::AUDMAudioFilterPal2Film(AUDMAudioFilter * instream):AUDMAudioFilter (instream)
 {
     // nothing special here...
-  _target=0.0;
+  _target=0;
+  _removed=0;
+  _modulo=0;
   _previous->rewind();
   printf("[Pal2Film] Creating\n");
 };
 
 AUDMAudioFilterPal2Film::~AUDMAudioFilterPal2Film()
 {
-  printf("[Film2Pal] Creating\n");
+  printf("[Film2Pal] Destroying\n");
 }
 //
 //___________________________________________
 uint32_t AUDMAudioFilterPal2Film::fill( uint32_t max, float * buffer,AUD_Status *status)
+//uint32_t AUDMAudioFilterFilm2Pal::fill( uint32_t max, float * buffer,AUD_Status *status)
 {
   uint32_t len,i,rendered;
   uint32_t min=_wavHeader.channels;
@@ -120,42 +121,56 @@
   
   shrink();
   fillIncomingBuffer(status);
-  float *head;
   
+  ADM_assert(_tail>=_head);
   
-  shrink();
-  fillIncomingBuffer(status);
-  
-  len=_tail-_head;
+  len=_tail-_head;  // How much float available ?
   if(len>max) len=max;
   
-  len=len/min;
-  len*=min;
-
+  len=len/min; // convert to sample
+  
+  if(len==0)
+  {
+        printf("**oops**\n");
+  }
   rendered=0;
   start=&_incomingBuffer[_head];
-  while(len)
+  while(len--)
   {
         memcpy(buffer,start,min*sizeof(float));
+       // printf(" Target :%d removed :%d\n",_target,_removed);
         buffer+=min;
-        start+=min;
         rendered+=min;
-        len-=min;
-        _target+=(PAL_SAM-FILM_SAM);
+
+       
+        _target++; // _target is the number of sample we processed
+
+        _modulo++;
+
+        if(_target>960) // Time to duplicate samples
+        {
+            _removed+=41;
+            _target-=960;
+        }
+        if(rendered>=max-1)
+        {
+            start+=min;
+            _head+=min;
+            return rendered;
+        }
         //_______________________________________
-        // Duplicate sample
-        // To compensate
-        //_______________________________________
-        // In : One second is worth FILM_SAM samples
-        // Out:FILM_SAM+(PAL_SAM-FILM_SAM)*FILM_SAM/FILM_SAM=PAL_SAM = 25 fps
-      
-        while(_target>FILM_SAM)
+        // Pal2Film : 25 fps to 24 fps -> Duplicate samples
+        // by 41 samples every 960 samples 960->1001
+        //______________________________________
+        if(_removed /*&& ((_modulo&15)==1)*/) // Spread the duplication
         {
-          memcpy(buffer,start-min,min*sizeof(float));
+          memcpy(buffer,start,min*sizeof(float));
           buffer+=min;
           rendered+=min;			
-          _target=_target-FILM_SAM;
-        }
+          _removed--;
+        }  
+        start+=min;
+        _head+=min;
   }
   return rendered;
 };

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.h	2008-06-21 09:46:28 UTC (rev 4130)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiofilter_film2pal.h	2008-06-21 09:46:30 UTC (rev 4131)
@@ -21,7 +21,9 @@
 class AUDMAudioFilterFilm2Pal : public AUDMAudioFilter
 {
   protected:
-    float  _target;
+    uint32_t   _target;
+    uint32_t _removed;
+    uint32_t _modulo;
   public:
                           AUDMAudioFilterFilm2Pal(AUDMAudioFilter *previous);
     virtual                ~AUDMAudioFilterFilm2Pal();
@@ -30,7 +32,10 @@
 class AUDMAudioFilterPal2Film : public AUDMAudioFilter
 {
   protected:
-    float  _target;
+    uint32_t   _target;
+    uint32_t _removed;
+    uint32_t _modulo;
+
   public:
                             AUDMAudioFilterPal2Film(AUDMAudioFilter *previous);
     virtual                ~AUDMAudioFilterPal2Film();

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2008-06-21 09:46:28 UTC (rev 4130)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2008-06-21 09:46:30 UTC (rev 4131)
@@ -229,7 +229,7 @@
                                         break;
                                 priv->getObject()->m_bPAL2Film = JSVAL_TO_BOOLEAN(*vp);
                                 enterLock();
-                                audioFilterFilm2Pal(priv->getObject()->m_bPAL2Film);
+                                audioFilterPal2Film(priv->getObject()->m_bPAL2Film);
                                 leaveLock();
                                 break;
                         }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-21 09:46:28 UTC (rev 4130)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-21 09:46:30 UTC (rev 4131)
@@ -465,6 +465,7 @@
  	
        info.fps1000=fps;
         video_body->updateVideoInfo(&info);
+        video_body->getVideoInfo (avifileinfo);
         
 	leaveLock();
         return JS_TRUE;



From mean at mail.berlios.de  Sat Jun 21 20:49:02 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:02 +0200
Subject: [Avidemux-svn-commit] r4132 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include
Message-ID: <200806211849.m5LIn2xD020564@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:02 +0200 (Sat, 21 Jun 2008)
New Revision: 4132

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
Log:
[Core] Gcc 4.3.1+AMD64 mangle fix


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2008-06-21 09:46:30 UTC (rev 4131)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2008-06-21 18:49:02 UTC (rev 4132)
@@ -28,9 +28,9 @@
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    endif
 #else
-#    if defined(ADM_CPU_X86_64) && defined(PIC)
+#    if defined(ADM_CPU_X86_64)  //defined(PIC)
 #        define MANGLE(a) #a"(%%rip)"
-#        define FUNNY_MANGLE(x) x
+#        define FUNNY_MANGLE(x) x asm(#x)
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y]
 #    elif defined(__APPLE__)
 #        define MANGLE(a) "_" #a



From mean at mail.berlios.de  Sat Jun 21 20:49:04 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:04 +0200
Subject: [Avidemux-svn-commit] r4133 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include
Message-ID: <200806211849.m5LIn4Kb020576@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:03 +0200 (Sat, 21 Jun 2008)
New Revision: 4133

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
Log:
[GCC] Funny mangle, take two AMD64+Array+pic


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2008-06-21 18:49:02 UTC (rev 4132)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2008-06-21 18:49:03 UTC (rev 4133)
@@ -28,10 +28,10 @@
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    endif
 #else
-#    if defined(ADM_CPU_X86_64)  //defined(PIC)
+#    if defined(ADM_CPU_X86_64) && defined(PIC)
 #        define MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(#x)
-#        define FUNNY_MANGLE_ARRAY(x, y) x[y]
+#        define FUNNY_MANGLE_ARRAY(x, y)  x[y] asm(#x)
 #    elif defined(__APPLE__)
 #        define MANGLE(a) "_" #a
 #    else



From mean at mail.berlios.de  Sat Jun 21 20:49:06 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:06 +0200
Subject: [Avidemux-svn-commit] r4134 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264
Message-ID: <200806211849.m5LIn6kw020588@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:06 +0200 (Sat, 21 Jun 2008)
New Revision: 4134

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp
Log:
[X264] Add ADM_default to get stdint, needed for uint8_t & friends


Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp	2008-06-21 18:49:03 UTC (rev 4133)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp	2008-06-21 18:49:06 UTC (rev 4134)
@@ -17,8 +17,8 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
 #include <libxml/parser.h>
+#include "ADM_default.h"
 #include "presetOptions.h"
 
 x264PresetOptions::x264PresetOptions(void) : x264Options()



From mean at mail.berlios.de  Sat Jun 21 20:49:08 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:08 +0200
Subject: [Avidemux-svn-commit] r4135 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: .
	ADM_audiocodec ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200806211849.m5LIn8qY020600@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:07 +0200 (Sat, 21 Jun 2008)
New Revision: 4135

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_pluginLoad.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names
Log:
[UI] skeleton for get plugin info dialog


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_pluginLoad.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_pluginLoad.cpp	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_pluginLoad.cpp	2008-06-21 18:49:07 UTC (rev 4135)
@@ -27,6 +27,10 @@
 #else
 #define aprintf(...) {}
 #endif
+/*  Exported functions */
+uint32_t ADM_ad_getNbFilters(void);
+bool     ADM_ad_getFilterInfo(int filter, const char **name, 
+                                uint32_t *major,uint32_t *minor,uint32_t *patch);
 
 /**
  * 
@@ -95,6 +99,34 @@
 	return 0;
 }
 /**
+    \fn ADM_ad_getNbFilters
+    \brief returns the # of loaded audio decoder
+*/
+uint32_t ADM_ad_getNbFilters(void)
+{
+    return (uint32_t )ADM_audioPlugins.size();
+}
+/**
+    \fn ADM_ad_getFilterInfo
+    \brief returns infos about a given filter
+    @param filter [in] # of the filter we are intereseted in, between 0 & ADM_ad_getNbFilters
+    @param name [out] Name of the decoder plugin
+    @param major, minor,patch [out] Version number
+    @return true
+*/
+bool ADM_ad_getFilterInfo(int filter, const char **name, uint32_t *major,uint32_t *minor,uint32_t *patch)
+{
+
+        ADM_assert(filter>=0 && filter<ADM_audioPlugins.size());
+
+    	ADM_ad_plugin *a=ADM_audioPlugins[filter];
+        a->getDecoderVersion(major, minor, patch);
+        
+        *name=a->getInfo();
+        return 1;
+}
+
+/**
  * 	\fn ADM_ad_loadPlugins
  *  \brief load all audio plugins
  */

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2008-06-21 18:49:07 UTC (rev 4135)
@@ -3,14 +3,16 @@
  */
 
 #ifdef HAVE_CONFIG_H
-#  include "config.h"
+#  include <config.h>
 #endif
 
+
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
 
 #include "ADM_default.h"
 #include "ADM_gladeSupport.h"
+
 #include "../ADM_toolkit_gtk/jogshuttle.h"
 #include "../ADM_toolkit_gtk/gtkmarkscale.h"
 
@@ -31,11 +33,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8448;
+  GtkWidget *image8523;
   GtkWidget *append_video1;
-  GtkWidget *image8449;
+  GtkWidget *image8524;
   GtkWidget *save_stuff;
-  GtkWidget *image8450;
+  GtkWidget *image8525;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -45,41 +47,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8451;
+  GtkWidget *image8526;
   GtkWidget *save_project_as1;
-  GtkWidget *image8452;
+  GtkWidget *image8527;
   GtkWidget *run_script1;
-  GtkWidget *image8453;
+  GtkWidget *image8528;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8454;
+  GtkWidget *image8529;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8455;
+  GtkWidget *image8530;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8456;
+  GtkWidget *image8531;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8457;
+  GtkWidget *image8532;
   GtkWidget *copy1;
-  GtkWidget *image8458;
+  GtkWidget *image8533;
   GtkWidget *paste1;
-  GtkWidget *image8459;
+  GtkWidget *image8534;
   GtkWidget *delete1;
-  GtkWidget *image8460;
+  GtkWidget *image8535;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8461;
+  GtkWidget *image8536;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -107,13 +109,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8462;
+  GtkWidget *image8537;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8463;
+  GtkWidget *image8538;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -138,35 +140,36 @@
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8464;
+  GtkWidget *image8539;
   GtkWidget *previous_frame1;
-  GtkWidget *image8465;
+  GtkWidget *image8540;
   GtkWidget *next_frame1;
-  GtkWidget *image8466;
+  GtkWidget *image8541;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8467;
+  GtkWidget *image8542;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8468;
+  GtkWidget *image8543;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8469;
+  GtkWidget *image8544;
   GtkWidget *last_frame1;
-  GtkWidget *image8470;
+  GtkWidget *image8545;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8471;
+  GtkWidget *image8546;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8472;
+  GtkWidget *image8547;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
+  GtkWidget *plugins1;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8473;
+  GtkWidget *image8548;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -297,9 +300,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8448 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8448);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8448);
+  image8523 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8523);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8523);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Append..."));
   gtk_widget_show (append_video1);
@@ -308,17 +311,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8449 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8449);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8449);
+  image8524 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8524);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8524);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Save"));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8450 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8450);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8450);
+  image8525 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8525);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8525);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -360,25 +363,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8451 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8451);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8451);
+  image8526 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8526);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8526);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("Save P_roject As..."));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8452 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8452);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8452);
+  image8527 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8527);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8527);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Load/Run Project..."));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8453 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8453);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8453);
+  image8528 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8528);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8528);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("A_dd to Joblist..."));
   gtk_widget_show (add_to_joblist1);
@@ -412,9 +415,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8454 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8454);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8454);
+  image8529 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8529);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8529);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("AVI _Muxer Options"));
   gtk_widget_show (avi_muxer_options1);
@@ -432,9 +435,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8455 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8455);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8455);
+  image8530 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8530);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8530);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_Edit"));
   gtk_widget_show (menuitem2);
@@ -447,9 +450,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8456 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8456);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8456);
+  image8531 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8531);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8531);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -463,9 +466,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8457 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8457);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8457);
+  image8532 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8532);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8532);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Copy"));
   gtk_widget_show (copy1);
@@ -474,9 +477,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8458 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8458);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8458);
+  image8533 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8533);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8533);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Paste"));
   gtk_widget_show (paste1);
@@ -485,9 +488,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8459 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8459);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8459);
+  image8534 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8534);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8534);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Delete"));
   gtk_widget_show (delete1);
@@ -496,9 +499,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8460 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8460);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8460);
+  image8535 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8535);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8535);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -528,9 +531,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8461 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8461);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8461);
+  image8536 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8536);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8536);
 
   view1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_View"));
   gtk_widget_show (view1);
@@ -677,9 +680,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8462 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8462);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8462);
+  image8537 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8537);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8537);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_Encoder"));
   gtk_widget_show (audio_encoder1);
@@ -706,9 +709,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8463 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
-  gtk_widget_show (image8463);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8463);
+  image8538 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
+  gtk_widget_show (image8538);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8538);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -810,9 +813,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8464 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8464);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8464);
+  image8539 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8539);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8539);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("P_revious Frame"));
   gtk_widget_show (previous_frame1);
@@ -821,9 +824,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8465 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8465);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8465);
+  image8540 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8540);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8540);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Next Frame"));
   gtk_widget_show (next_frame1);
@@ -832,9 +835,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8466 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8466);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8466);
+  image8541 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8541);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8541);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("Pr_evious Intra Frame"));
   gtk_widget_show (previous_intra_frame1);
@@ -843,9 +846,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8467 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8467);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8467);
+  image8542 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8542);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8542);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("Next _Intra Frame"));
   gtk_widget_show (next_intra_frame1);
@@ -854,9 +857,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8468 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8468);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8468);
+  image8543 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8543);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8543);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("Previou_s Black Frame"));
   gtk_widget_show (search_previous_black_frame1);
@@ -873,9 +876,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8469 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8469);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8469);
+  image8544 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8544);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8544);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("_Last Frame"));
   gtk_widget_show (last_frame1);
@@ -884,9 +887,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8470 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8470);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8470);
+  image8545 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8545);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8545);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -919,9 +922,9 @@
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8471 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8471);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8471);
+  image8546 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8546);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8546);
 
   jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (QT_TR_NOOP("Go to _Time..."));
   gtk_widget_show (jump_to_time1);
@@ -930,9 +933,9 @@
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8472 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8472);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8472);
+  image8547 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8547);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8547);
 
   custom1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_Custom"));
   gtk_widget_show (custom1);
@@ -945,6 +948,10 @@
   help2_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (help2), help2_menu);
 
+  plugins1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_Plugins"));
+  gtk_widget_show (plugins1);
+  gtk_container_add (GTK_CONTAINER (help2_menu), plugins1);
+
   show_builtin_support1 = gtk_menu_item_new_with_mnemonic (QT_TR_NOOP("_Built-in Support"));
   gtk_widget_show (show_builtin_support1);
   gtk_container_add (GTK_CONTAINER (help2_menu), show_builtin_support1);
@@ -953,9 +960,9 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8473 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8473);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8473);
+  image8548 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8548);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8548);
 
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
@@ -1470,6 +1477,7 @@
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_FOCUS);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_DEFAULT);
 
+
   /* Store pointers to all widgets, for use by lookup_widget(). */
   GLADE_HOOKUP_OBJECT_NO_REF (mainWindow, mainWindow, "mainWindow");
   GLADE_HOOKUP_OBJECT (mainWindow, vbox1, "vbox1");
@@ -1477,11 +1485,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, "menuitem1");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, "menuitem1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, "open_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8448, "image8448");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8523, "image8523");
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, "append_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8449, "image8449");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8524, "image8524");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, "save_stuff");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8450, "image8450");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8525, "image8525");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, "save_stuff_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, "save_as_avi1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, "separator1");
@@ -1491,41 +1499,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, "close1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, "separator3");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, "save_project1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8451, "image8451");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8526, "image8526");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, "save_project_as1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8452, "image8452");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8527, "image8527");
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, "run_script1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8453, "image8453");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8528, "image8528");
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, "add_to_joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, "joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, "separator16");
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, "connect_to_avsproxy1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, "separator18");
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, "video_informations1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8454, "image8454");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8529, "image8529");
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, "avi_muxer_options1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, "separator4");
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, "quit1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8455, "image8455");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8530, "image8530");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, "menuitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, "menuitem2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, "reset_edits1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8456, "image8456");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8531, "image8531");
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, "separator5");
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, "cut1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8457, "image8457");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8532, "image8532");
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, "copy1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8458, "image8458");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8533, "image8533");
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, "paste1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8459, "image8459");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8534, "image8534");
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, "delete1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8460, "image8460");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8535, "image8535");
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, "separator6");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, "set_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, "set_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, "separator7");
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, "preferences1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8461, "image8461");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8536, "image8536");
   GLADE_HOOKUP_OBJECT (mainWindow, view1, "view1");
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, "view1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, "toolbar1");
@@ -1553,13 +1561,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, "build_vbr_time_map1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, "separator11");
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, "save_audio1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8462, "image8462");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8537, "image8537");
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, "audio_encoder1");
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, "filters2");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, "tools1");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, "tools1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, "calculator1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8463, "image8463");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8538, "image8538");
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, "separator12");
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, "rebuild_frames");
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, "check_frames");
@@ -1584,35 +1592,36 @@
   GLADE_HOOKUP_OBJECT (mainWindow, go1, "go1");
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, "go1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, "play_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8464, "image8464");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8539, "image8539");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, "previous_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8465, "image8465");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8540, "image8540");
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, "next_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8466, "image8466");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8541, "image8541");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, "previous_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8467, "image8467");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8542, "image8542");
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, "next_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8468, "image8468");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8543, "image8543");
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, "search_previous_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, "search_next_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, "first_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8469, "image8469");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8544, "image8544");
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, "last_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8470, "image8470");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8545, "image8545");
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, "separator14");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, "go_to_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, "go_to_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, "separator15");
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, "jum_to_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8471, "image8471");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8546, "image8546");
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, "jump_to_time1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8472, "image8472");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8547, "image8547");
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, "custom1");
   GLADE_HOOKUP_OBJECT (mainWindow, help2, "help2");
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, "help2_menu");
+  GLADE_HOOKUP_OBJECT (mainWindow, plugins1, "plugins1");
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, "show_builtin_support1");
   GLADE_HOOKUP_OBJECT (mainWindow, about1, "about1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8473, "image8473");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8548, "image8548");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, "toolbar2");
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, "menutoolbuttonOpen");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, "toolitem11");

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2008-06-21 18:49:07 UTC (rev 4135)
@@ -109,6 +109,6 @@
 //CALLBACK(zoom_4_1                                   ,ACT_ZOOM_4_1);
 CALLBACK(edit_glyph1                                ,ACT_GLYPHEDIT);
 //CALLBACK(hscalVolume                                ,ACT_VOLUME);
+CALLBACK(plugins1                                   ,ACT_PLUGIN_INFO);
 
 
-

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2008-06-21 18:49:07 UTC (rev 4135)
@@ -20,6 +20,7 @@
 DIA_tsSub.cpp        
 DIA_jobs_save.cpp
 DIA_flv1.cpp            
+DIA_plugins.cpp
 )
 
 SET(OBSOLETE_SRCS

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp	2008-06-21 18:49:07 UTC (rev 4135)
@@ -0,0 +1,41 @@
+
+/***************************************************************************
+  \file DIA_plugins.cpp
+  (C) 2008 Mean Fixounet at free.fr 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "config.h"
+#include "ADM_default.h"
+#include "DIA_factory.h"
+/* Functions we need to get infos */
+uint32_t ADM_ad_getNbFilters(void);
+bool     ADM_ad_getFilterInfo(int filter, const char **name, uint32_t *major,uint32_t *minor,uint32_t *patch);
+/* /Functions */
+/**
+        \fn DIA_pluginsInfo
+        \brief Display loaded plugin infos        
+
+*/
+uint8_t DIA_pluginsInfo(void)
+{
+    uint32_t aNbPlugin=ADM_ad_getNbFilters();
+    printf("[Audio Plugins] Found %u plugins\n",aNbPlugin);
+    for(int i=0;i<aNbPlugin;i++)
+    {
+        const char *name;
+        uint32_t major,minor,patch;
+            ADM_ad_getFilterInfo(i, &name,&major,&minor,&patch);
+            printf("[Audio Plugins] %s version :%2d.%2d.%2d\n",name,major,minor,patch);
+
+    }
+    return 1;
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-21 18:49:07 UTC (rev 4135)
@@ -159,7 +159,7 @@
 uint8_t GUI_close(void);
 extern void A_jog(void);
 extern void DIA_glyphEdit(void);
-
+extern uint8_t DIA_pluginsInfo(void);
 //___________________________________________
 // serialization of user event through gui
 //
@@ -240,7 +240,9 @@
    		audioCodecChanged(nw);
     		
 		return;
-    
+    case ACT_PLUGIN_INFO:
+            DIA_pluginsInfo();
+            return;
     case ACT_RunScript:
                 GUI_FileSelRead (QT_TR_NOOP("Select ECMAScript to Run"),(SELFILE_CB *) A_parseECMAScript);
                         

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names	2008-06-21 18:49:06 UTC (rev 4134)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names	2008-06-21 18:49:07 UTC (rev 4135)
@@ -162,3 +162,4 @@
 ACT(AVS_PROXY)
 ACT(JOG)
 ACT(GLYPHEDIT)
+ACT(PLUGIN_INFO)
\ No newline at end of file



From mean at mail.berlios.de  Sat Jun 21 20:49:10 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:10 +0200
Subject: [Avidemux-svn-commit] r4136 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2
Message-ID: <200806211849.m5LInAFR020631@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:10 +0200 (Sat, 21 Jun 2008)
New Revision: 4136

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/update
Log:
[Misc] Partially updated update


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/update
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/update	2008-06-21 18:49:07 UTC (rev 4135)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/update	2008-06-21 18:49:10 UTC (rev 4136)
@@ -1,2 +1,2 @@
-cp /home/fx/Projects/nicer/main-nicer/src/interface.c ./GUI_main2.cpp
+cp ../glade/src/interface.c ./GUI_main2.cpp
 bash patch.bash



From mean at mail.berlios.de  Sat Jun 21 20:49:12 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jun 2008 20:49:12 +0200
Subject: [Avidemux-svn-commit] r4137 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade
Message-ID: <200806211849.m5LInCT0020641@sheep.berlios.de>

Author: mean
Date: 2008-06-21 20:49:11 +0200 (Sat, 21 Jun 2008)
New Revision: 4137

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade2
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
Log:
[GTK] Move gtk2_build to build tree


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2008-06-21 18:49:10 UTC (rev 4136)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2008-06-21 18:49:11 UTC (rev 4137)
@@ -50,7 +50,7 @@
 		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8448">
+			<widget class="GtkImage" id="image8523">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-open</property>
 			  <property name="icon_size">1</property>
@@ -71,7 +71,7 @@
 		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8449">
+			<widget class="GtkImage" id="image8524">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-add</property>
 			  <property name="icon_size">1</property>
@@ -91,7 +91,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8450">
+			<widget class="GtkImage" id="image8525">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -169,7 +169,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8451">
+			<widget class="GtkImage" id="image8526">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -189,7 +189,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8452">
+			<widget class="GtkImage" id="image8527">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -209,7 +209,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8453">
+			<widget class="GtkImage" id="image8528">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-execute</property>
 			  <property name="icon_size">1</property>
@@ -267,7 +267,7 @@
 		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8454">
+			<widget class="GtkImage" id="image8529">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-properties</property>
 			  <property name="icon_size">1</property>
@@ -302,7 +302,7 @@
 		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8455">
+			<widget class="GtkImage" id="image8530">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-quit</property>
 			  <property name="icon_size">1</property>
@@ -335,7 +335,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8456">
+			<widget class="GtkImage" id="image8531">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-undo</property>
 			  <property name="icon_size">1</property>
@@ -362,7 +362,7 @@
 		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8457">
+			<widget class="GtkImage" id="image8532">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-cut</property>
 			  <property name="icon_size">1</property>
@@ -383,7 +383,7 @@
 		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8458">
+			<widget class="GtkImage" id="image8533">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-copy</property>
 			  <property name="icon_size">1</property>
@@ -404,7 +404,7 @@
 		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8459">
+			<widget class="GtkImage" id="image8534">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-paste</property>
 			  <property name="icon_size">1</property>
@@ -425,7 +425,7 @@
 		      <accelerator key="Delete" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8460">
+			<widget class="GtkImage" id="image8535">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-remove</property>
 			  <property name="icon_size">1</property>
@@ -475,7 +475,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8461">
+			<widget class="GtkImage" id="image8536">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-preferences</property>
 			  <property name="icon_size">1</property>
@@ -702,7 +702,7 @@
 		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8462">
+			<widget class="GtkImage" id="image8537">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -753,7 +753,7 @@
 		      <accelerator key="F7" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8463">
+			<widget class="GtkImage" id="image8538">
 			  <property name="visible">True</property>
 			  <property name="pixbuf">gnome-calculator_small.xpm</property>
 			  <property name="xalign">0.5</property>
@@ -945,7 +945,7 @@
 		      <accelerator key="P" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8464">
+			<widget class="GtkImage" id="image8539">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-play</property>
 			  <property name="icon_size">1</property>
@@ -966,7 +966,7 @@
 		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8465">
+			<widget class="GtkImage" id="image8540">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-previous</property>
 			  <property name="icon_size">1</property>
@@ -987,7 +987,7 @@
 		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8466">
+			<widget class="GtkImage" id="image8541">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-next</property>
 			  <property name="icon_size">1</property>
@@ -1008,7 +1008,7 @@
 		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8467">
+			<widget class="GtkImage" id="image8542">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-rewind</property>
 			  <property name="icon_size">1</property>
@@ -1029,7 +1029,7 @@
 		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8468">
+			<widget class="GtkImage" id="image8543">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-forward</property>
 			  <property name="icon_size">1</property>
@@ -1066,7 +1066,7 @@
 		      <accelerator key="Home" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8469">
+			<widget class="GtkImage" id="image8544">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-first</property>
 			  <property name="icon_size">1</property>
@@ -1087,7 +1087,7 @@
 		      <accelerator key="End" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8470">
+			<widget class="GtkImage" id="image8545">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-last</property>
 			  <property name="icon_size">1</property>
@@ -1138,7 +1138,7 @@
 		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8471">
+			<widget class="GtkImage" id="image8546">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1159,7 +1159,7 @@
 		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8472">
+			<widget class="GtkImage" id="image8547">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1194,6 +1194,15 @@
 		<widget class="GtkMenu" id="help2_menu">
 
 		  <child>
+		    <widget class="GtkMenuItem" id="plugins1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Plugins</property>
+		      <property name="use_underline">True</property>
+		      <signal name="activate" handler="on_plugins1_activate" last_modification_time="Sat, 21 Jun 2008 18:24:10 GMT"/>
+		    </widget>
+		  </child>
+
+		  <child>
 		    <widget class="GtkMenuItem" id="show_builtin_support1">
 		      <property name="visible">True</property>
 		      <property name="label" translatable="yes">_Built-in Support</property>
@@ -1208,7 +1217,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8473">
+			<widget class="GtkImage" id="image8548">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-about</property>
 			  <property name="icon_size">1</property>

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade2 (from rev 4136, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2008-06-21 18:49:10 UTC (rev 4136)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade2	2008-06-21 18:49:11 UTC (rev 4137)
@@ -0,0 +1,2625 @@
+<?xml version="1.0" standalone="no"?> <!--*- mode: xml -*-->
+<!DOCTYPE glade-interface SYSTEM "http://glade.gnome.org/glade-2.0.dtd">
+
+<glade-interface>
+
+<widget class="GtkWindow" id="mainWindow">
+  <property name="visible">True</property>
+  <property name="title" translatable="yes">Avidemux</property>
+  <property name="type">GTK_WINDOW_TOPLEVEL</property>
+  <property name="window_position">GTK_WIN_POS_NONE</property>
+  <property name="modal">False</property>
+  <property name="resizable">True</property>
+  <property name="destroy_with_parent">False</property>
+  <property name="icon">avidemux_icon_small.png</property>
+  <property name="decorated">True</property>
+  <property name="skip_taskbar_hint">False</property>
+  <property name="skip_pager_hint">False</property>
+  <property name="type_hint">GDK_WINDOW_TYPE_HINT_NORMAL</property>
+  <property name="gravity">GDK_GRAVITY_NORTH_WEST</property>
+  <property name="focus_on_map">True</property>
+  <property name="urgency_hint">False</property>
+
+  <child>
+    <widget class="GtkVBox" id="vbox1">
+      <property name="visible">True</property>
+      <property name="homogeneous">False</property>
+      <property name="spacing">0</property>
+
+      <child>
+	<widget class="GtkMenuBar" id="menuBar">
+	  <property name="visible">True</property>
+	  <property name="can_focus">True</property>
+	  <property name="pack_direction">GTK_PACK_DIRECTION_LTR</property>
+	  <property name="child_pack_direction">GTK_PACK_DIRECTION_LTR</property>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="menuitem1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_File</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="menuitem1_menu">
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="open_video1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Open...</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8448">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-open</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="append_video1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Append...</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8449">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-add</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="save_stuff">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Save</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8450">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-save</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+
+		      <child>
+			<widget class="GtkMenu" id="save_stuff_menu">
+
+			  <child>
+			    <widget class="GtkMenuItem" id="save_as_avi1">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Save _Video...</property>
+			      <property name="use_underline">True</property>
+			      <accelerator key="S" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+			    </widget>
+			  </child>
+
+			  <child>
+			    <widget class="GtkSeparatorMenuItem" id="separator1">
+			      <property name="visible">True</property>
+			    </widget>
+			  </child>
+
+			  <child>
+			    <widget class="GtkMenuItem" id="save_image1">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Save _BMP Image...</property>
+			      <property name="use_underline">True</property>
+			    </widget>
+			  </child>
+
+			  <child>
+			    <widget class="GtkMenuItem" id="save_jpg_image1">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Save _JPEG Image...</property>
+			      <property name="use_underline">True</property>
+			    </widget>
+			  </child>
+
+			  <child>
+			    <widget class="GtkMenuItem" id="save_selection_as_jpegs1">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Save _Selection as JPEG Images...</property>
+			      <property name="use_underline">True</property>
+			    </widget>
+			  </child>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="close1">
+		      <property name="visible">True</property>
+		      <property name="label">gtk-close</property>
+		      <property name="use_stock">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator3">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="save_project1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Save _Project</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8451">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-save</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="save_project_as1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Save P_roject As...</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8452">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-save-as</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="run_script1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Load/Run Project...</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8453">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-execute</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="add_to_joblist1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">A_dd to Joblist...</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="joblist1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Show _Joblist</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="J" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator16">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="connect_to_avsproxy1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Co_nnect to avsproxy</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator18">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="video_informations1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Proper_ties</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8454">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-properties</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="avi_muxer_options1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">AVI _Muxer Options</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator4">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="quit1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Quit</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8455">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-quit</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="menuitem2">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Edit</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="menuitem2_menu">
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="reset_edits1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Reset Edits</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8456">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-undo</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator5">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="cut1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Cu_t</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8457">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-cut</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="copy1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Copy</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8458">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-copy</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="paste1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Paste</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8459">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-paste</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="delete1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Delete</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="Delete" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8460">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-remove</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator6">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="set_marker_a1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Set Marker _A</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="bracketleft" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="set_marker_b1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Set Marker _B</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="bracketright" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator7">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="preferences1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Pre_ferences</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8461">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-preferences</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="view1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_View</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="view1_menu">
+
+		  <child>
+		    <widget class="GtkCheckMenuItem" id="toolbar1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Main Toolbar</property>
+		      <property name="use_underline">True</property>
+		      <property name="active">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkCheckMenuItem" id="sidebar1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_A/V Sidebar</property>
+		      <property name="use_underline">True</property>
+		      <property name="active">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator8">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="zoom_1_4">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Zoom 1:4</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="4" modifiers="GDK_CONTROL_MASK | GDK_SHIFT_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="zoom_1_2">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Z_oom 1:2</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="2" modifiers="GDK_CONTROL_MASK | GDK_SHIFT_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="zoom_1_1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Zoom _1:1</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="1" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="zoom_2_1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Zoom _2:1</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="2" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="video_1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">Vi_deo</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="video_1_menu">
+
+		  <child>
+		    <widget class="GtkMenuItem" id="decoder_options1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Decoder Options</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="F3" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="set_postprocessing1">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Select postprocessing level</property>
+		      <property name="label" translatable="yes">_Postprocessing</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="F4" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator9">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkCheckMenuItem" id="preview1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">P_review</property>
+		      <property name="use_underline">True</property>
+		      <property name="active">False</property>
+		      <accelerator key="F5" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkCheckMenuItem" id="display_output1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Display _Output</property>
+		      <property name="use_underline">True</property>
+		      <property name="active">False</property>
+		      <accelerator key="F6" modifiers="0" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator10">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="change_fps">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Frame Rate</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="videoencoder">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Encoder</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="V" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="filters1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Fil_ters</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="F" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="audio1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Audio</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="audio1_menu">
+
+		  <child>
+		    <widget class="GtkMenuItem" id="main_audio">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Main Track</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="second_audio_track1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Second Track</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="build_vbr_time_map1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Build VBR Time Map</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator11">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="save_audio1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">S_ave...</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8462">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-save-as</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="audio_encoder1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Encoder</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="filters2">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Filters</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="tools1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Tools</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="tools1_menu">
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="calculator1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Calculator</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="F7" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8463">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">gnome-calculator_small.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator12">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="rebuild_frames">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Rebuild Frames (I &amp; B)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="check_frames">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">C_heck Frames (slow)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="bitrate_histogram1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Bitrate Histogram</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="item1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Scan for Black Frames...</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator13">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="v2v">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_VOB -&gt; VobSub</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="ocr_vobsub_2_srt">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_OCR (VobSub -&gt; srt)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="ocr_dvb">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">OCR (TS-&gt;srt)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="edit_glyph1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Edit Glyph</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator17">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="see_hex1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Frame Hex Dump</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="help1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">A_uto</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="help1_menu">
+
+		  <child>
+		    <widget class="GtkMenuItem" id="vcd1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_VCD</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="svcd1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_SVCD</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="dvd1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_DVD</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="psp1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_PSP</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="psp_(h264)1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">PSP (_H.264)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="flv1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">F_LV</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="go1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Go</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="go1_menu">
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="play_video1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Play/Stop</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="P" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8464">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-media-play</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="previous_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">P_revious Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8465">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-media-previous</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="next_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Next Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8466">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-media-next</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="previous_intra_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Pr_evious Intra Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8467">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-media-rewind</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="next_intra_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Next _Intra Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8468">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-media-forward</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="search_previous_black_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Previou_s Black Frame</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="search_next_black_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Ne_xt Black Frame</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="first_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_First Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="Home" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8469">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-goto-first</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="last_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Last Frame</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="End" modifiers="0" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8470">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-goto-last</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator14">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="go_to_marker_a1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Go to Marker _A</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="bracketleft" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="go_to_marker_b1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Go to Marker _B</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="bracketright" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSeparatorMenuItem" id="separator15">
+		      <property name="visible">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="jum_to_frame1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Go to Fra_me...</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8471">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-jump-to</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="jump_to_time1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Go to _Time...</property>
+		      <property name="use_underline">True</property>
+		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8472">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-jump-to</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="custom1">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Custom</property>
+	      <property name="use_underline">True</property>
+	    </widget>
+	  </child>
+
+	  <child>
+	    <widget class="GtkMenuItem" id="help2">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">_Help</property>
+	      <property name="use_underline">True</property>
+
+	      <child>
+		<widget class="GtkMenu" id="help2_menu">
+
+		  <child>
+		    <widget class="GtkMenuItem" id="show_builtin_support1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_Built-in Support</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkImageMenuItem" id="about1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">_About</property>
+		      <property name="use_underline">True</property>
+
+		      <child internal-child="image">
+			<widget class="GtkImage" id="image8473">
+			  <property name="visible">True</property>
+			  <property name="stock">gtk-about</property>
+			  <property name="icon_size">1</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	  </child>
+	</widget>
+	<packing>
+	  <property name="padding">0</property>
+	  <property name="expand">False</property>
+	  <property name="fill">False</property>
+	</packing>
+      </child>
+
+      <child>
+	<widget class="GtkToolbar" id="toolbar2">
+	  <property name="visible">True</property>
+	  <property name="orientation">GTK_ORIENTATION_HORIZONTAL</property>
+	  <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
+	  <property name="tooltips">True</property>
+	  <property name="show_arrow">True</property>
+
+	  <child>
+	    <widget class="GtkMenuToolButton" id="menutoolbuttonOpen">
+	      <property name="visible">True</property>
+	      <property name="tooltip" translatable="yes">Open a file</property>
+	      <property name="stock_id">gtk-open</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">True</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolItem" id="toolitem11">
+	      <property name="visible">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">False</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolButton" id="toolbuttonSave">
+	      <property name="visible">True</property>
+	      <property name="tooltip" translatable="yes">Save the file</property>
+	      <property name="stock_id">gtk-save</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">True</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolButton" id="toolbuttonInfo">
+	      <property name="visible">True</property>
+	      <property name="tooltip" translatable="yes">Audio/video file information</property>
+	      <property name="stock_id">gtk-properties</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">False</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkSeparatorToolItem" id="separatortoolitem1">
+	      <property name="visible">True</property>
+	      <property name="draw">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolButton" id="toolbuttonCalc">
+	      <property name="visible">True</property>
+	      <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
+	      <property name="label" translatable="yes">Calculator</property>
+	      <property name="use_underline">True</property>
+	      <property name="icon">gnome-calculator.xpm</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">True</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkSeparatorToolItem" id="separatortoolitem2">
+	      <property name="visible">True</property>
+	      <property name="draw">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolItem" id="toolitem12">
+	      <property name="visible">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">False</property>
+
+	      <child>
+		<widget class="GtkComboBox" id="comboboxPreview">
+		  <property name="visible">True</property>
+		  <property name="items" translatable="yes"></property>
+		  <property name="add_tearoffs">False</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolItem" id="toolitem13">
+	      <property name="visible">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">False</property>
+
+	      <child>
+		<widget class="GtkToggleButton" id="togglebutton1">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="relief">GTK_RELIEF_NONE</property>
+		  <property name="focus_on_click">True</property>
+		  <property name="active">False</property>
+		  <property name="inconsistent">False</property>
+
+		  <child>
+		    <widget class="GtkImage" id="image8272">
+		      <property name="width_request">17</property>
+		      <property name="height_request">16</property>
+		      <property name="visible">True</property>
+		      <property name="pixbuf">audio-volume-medium.png</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkToolItem" id="toolitem14">
+	      <property name="visible">True</property>
+	      <property name="visible_horizontal">True</property>
+	      <property name="visible_vertical">True</property>
+	      <property name="is_important">False</property>
+
+	      <child>
+		<widget class="GtkHScale" id="hscalVolume">
+		  <property name="width_request">100</property>
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="draw_value">False</property>
+		  <property name="value_pos">GTK_POS_TOP</property>
+		  <property name="digits">0</property>
+		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
+		  <property name="inverted">False</property>
+		  <property name="adjustment">99 0 100 1 1 1</property>
+		</widget>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="expand">False</property>
+	      <property name="homogeneous">False</property>
+	    </packing>
+	  </child>
+	</widget>
+	<packing>
+	  <property name="padding">0</property>
+	  <property name="expand">False</property>
+	  <property name="fill">False</property>
+	</packing>
+      </child>
+
+      <child>
+	<widget class="GtkVBox" id="vbox10">
+	  <property name="visible">True</property>
+	  <property name="homogeneous">False</property>
+	  <property name="spacing">3</property>
+
+	  <child>
+	    <widget class="GtkHBox" id="hbox14">
+	      <property name="visible">True</property>
+	      <property name="homogeneous">False</property>
+	      <property name="spacing">0</property>
+
+	      <child>
+		<widget class="GtkAlignment" id="alignment19">
+		  <property name="visible">True</property>
+		  <property name="xalign">0.5</property>
+		  <property name="yalign">0.5</property>
+		  <property name="xscale">1</property>
+		  <property name="yscale">1</property>
+		  <property name="top_padding">3</property>
+		  <property name="bottom_padding">0</property>
+		  <property name="left_padding">3</property>
+		  <property name="right_padding">0</property>
+
+		  <child>
+		    <widget class="GtkVBox" id="vbox9">
+		      <property name="visible">True</property>
+		      <property name="homogeneous">False</property>
+		      <property name="spacing">9</property>
+
+		      <child>
+			<widget class="GtkVBox" id="vbox11">
+			  <property name="visible">True</property>
+			  <property name="homogeneous">False</property>
+			  <property name="spacing">0</property>
+
+			  <child>
+			    <widget class="GtkLabel" id="label18">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">&lt;b&gt;Video&lt;/b&gt;</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">True</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">False</property>
+			      <property name="xalign">0</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkAlignment" id="alignment12">
+			      <property name="visible">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xscale">1</property>
+			      <property name="yscale">1</property>
+			      <property name="top_padding">3</property>
+			      <property name="bottom_padding">0</property>
+			      <property name="left_padding">12</property>
+			      <property name="right_padding">0</property>
+
+			      <child>
+				<widget class="GtkVBox" id="vbox7">
+				  <property name="visible">True</property>
+				  <property name="homogeneous">False</property>
+				  <property name="spacing">3</property>
+
+				  <child>
+				    <widget class="GtkComboBox" id="comboboxVideo">
+				      <property name="visible">True</property>
+				      <property name="items" translatable="yes">Copy</property>
+				      <property name="add_tearoffs">False</property>
+				      <property name="focus_on_click">True</property>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+
+				  <child>
+				    <widget class="GtkButton" id="buttonConfV">
+				      <property name="visible">True</property>
+				      <property name="tooltip" translatable="yes">Configure video encoder</property>
+				      <property name="can_focus">True</property>
+				      <property name="label" translatable="yes">Configure</property>
+				      <property name="use_underline">True</property>
+				      <property name="relief">GTK_RELIEF_NORMAL</property>
+				      <property name="focus_on_click">True</property>
+				      <accelerator key="F3" modifiers="0" signal="clicked"/>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+
+				  <child>
+				    <widget class="GtkButton" id="buttonFilters">
+				      <property name="visible">True</property>
+				      <property name="tooltip" translatable="yes">Video filters</property>
+				      <property name="can_focus">True</property>
+				      <property name="label" translatable="yes">Filters</property>
+				      <property name="use_underline">True</property>
+				      <property name="relief">GTK_RELIEF_NORMAL</property>
+				      <property name="focus_on_click">True</property>
+				      <accelerator key="F1" modifiers="0" signal="clicked"/>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+				</widget>
+			      </child>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">True</property>
+			      <property name="fill">True</property>
+			    </packing>
+			  </child>
+			</widget>
+			<packing>
+			  <property name="padding">0</property>
+			  <property name="expand">False</property>
+			  <property name="fill">False</property>
+			</packing>
+		      </child>
+
+		      <child>
+			<widget class="GtkVBox" id="vbox12">
+			  <property name="visible">True</property>
+			  <property name="homogeneous">False</property>
+			  <property name="spacing">0</property>
+
+			  <child>
+			    <widget class="GtkLabel" id="label19">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">&lt;b&gt;Audio&lt;/b&gt;</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">True</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">False</property>
+			      <property name="xalign">0</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkAlignment" id="alignment13">
+			      <property name="visible">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xscale">1</property>
+			      <property name="yscale">1</property>
+			      <property name="top_padding">3</property>
+			      <property name="bottom_padding">0</property>
+			      <property name="left_padding">12</property>
+			      <property name="right_padding">0</property>
+
+			      <child>
+				<widget class="GtkVBox" id="vbox8">
+				  <property name="visible">True</property>
+				  <property name="homogeneous">False</property>
+				  <property name="spacing">3</property>
+
+				  <child>
+				    <widget class="GtkComboBox" id="comboboxAudio">
+				      <property name="visible">True</property>
+				      <property name="items" translatable="yes">Copy</property>
+				      <property name="add_tearoffs">False</property>
+				      <property name="focus_on_click">True</property>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+
+				  <child>
+				    <widget class="GtkButton" id="buttonConfA">
+				      <property name="visible">True</property>
+				      <property name="tooltip" translatable="yes">Configure audio encoder</property>
+				      <property name="can_focus">True</property>
+				      <property name="label" translatable="yes">Configure</property>
+				      <property name="use_underline">True</property>
+				      <property name="relief">GTK_RELIEF_NORMAL</property>
+				      <property name="focus_on_click">True</property>
+				      <accelerator key="F4" modifiers="0" signal="clicked"/>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+
+				  <child>
+				    <widget class="GtkButton" id="buttonAudioFilter">
+				      <property name="visible">True</property>
+				      <property name="tooltip" translatable="yes">Audio filters</property>
+				      <property name="can_focus">True</property>
+				      <property name="relief">GTK_RELIEF_NORMAL</property>
+				      <property name="focus_on_click">True</property>
+				      <accelerator key="F2" modifiers="0" signal="clicked"/>
+
+				      <child>
+					<widget class="GtkAlignment" id="alignment16">
+					  <property name="visible">True</property>
+					  <property name="xalign">0.5</property>
+					  <property name="yalign">0.5</property>
+					  <property name="xscale">0</property>
+					  <property name="yscale">0</property>
+					  <property name="top_padding">0</property>
+					  <property name="bottom_padding">0</property>
+					  <property name="left_padding">0</property>
+					  <property name="right_padding">0</property>
+
+					  <child>
+					    <widget class="GtkHBox" id="hbox18">
+					      <property name="visible">True</property>
+					      <property name="homogeneous">False</property>
+					      <property name="spacing">2</property>
+
+					      <child>
+						<widget class="GtkLabel" id="label22">
+						  <property name="visible">True</property>
+						  <property name="label" translatable="yes">Filters</property>
+						  <property name="use_underline">True</property>
+						  <property name="use_markup">False</property>
+						  <property name="justify">GTK_JUSTIFY_LEFT</property>
+						  <property name="wrap">False</property>
+						  <property name="selectable">False</property>
+						  <property name="xalign">0.5</property>
+						  <property name="yalign">0.5</property>
+						  <property name="xpad">0</property>
+						  <property name="ypad">0</property>
+						  <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+						  <property name="width_chars">-1</property>
+						  <property name="single_line_mode">False</property>
+						  <property name="angle">0</property>
+						</widget>
+						<packing>
+						  <property name="padding">0</property>
+						  <property name="expand">False</property>
+						  <property name="fill">False</property>
+						</packing>
+					      </child>
+					    </widget>
+					  </child>
+					</widget>
+				      </child>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">False</property>
+				      <property name="fill">False</property>
+				    </packing>
+				  </child>
+
+				  <child>
+				    <widget class="GtkHBox" id="hbox19">
+				      <property name="visible">True</property>
+				      <property name="homogeneous">False</property>
+				      <property name="spacing">6</property>
+
+				      <child>
+					<widget class="GtkCheckButton" id="CheckButtonTimeshift">
+					  <property name="visible">True</property>
+					  <property name="tooltip" translatable="yes">Enable time shift</property>
+					  <property name="can_focus">True</property>
+					  <property name="label" translatable="yes">Shift:</property>
+					  <property name="use_underline">True</property>
+					  <property name="relief">GTK_RELIEF_NORMAL</property>
+					  <property name="focus_on_click">True</property>
+					  <property name="active">False</property>
+					  <property name="inconsistent">False</property>
+					  <property name="draw_indicator">True</property>
+					</widget>
+					<packing>
+					  <property name="padding">0</property>
+					  <property name="expand">False</property>
+					  <property name="fill">False</property>
+					</packing>
+				      </child>
+
+				      <child>
+					<widget class="GtkSpinButton" id="spinbuttonTimeShift">
+					  <property name="visible">True</property>
+					  <property name="tooltip" translatable="yes">Audio/video time shift (ms)</property>
+					  <property name="can_focus">True</property>
+					  <property name="climb_rate">1</property>
+					  <property name="digits">0</property>
+					  <property name="numeric">True</property>
+					  <property name="update_policy">GTK_UPDATE_ALWAYS</property>
+					  <property name="snap_to_ticks">False</property>
+					  <property name="wrap">False</property>
+					  <property name="adjustment">0 -99999 99999 1 10 10</property>
+					</widget>
+					<packing>
+					  <property name="padding">0</property>
+					  <property name="expand">True</property>
+					  <property name="fill">True</property>
+					</packing>
+				      </child>
+				    </widget>
+				    <packing>
+				      <property name="padding">0</property>
+				      <property name="expand">True</property>
+				      <property name="fill">True</property>
+				    </packing>
+				  </child>
+				</widget>
+			      </child>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">True</property>
+			      <property name="fill">True</property>
+			    </packing>
+			  </child>
+			</widget>
+			<packing>
+			  <property name="padding">0</property>
+			  <property name="expand">False</property>
+			  <property name="fill">False</property>
+			</packing>
+		      </child>
+
+		      <child>
+			<widget class="GtkVBox" id="vbox13">
+			  <property name="visible">True</property>
+			  <property name="homogeneous">False</property>
+			  <property name="spacing">0</property>
+
+			  <child>
+			    <widget class="GtkLabel" id="label20">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">&lt;b&gt;Format&lt;/b&gt;</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">True</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">False</property>
+			      <property name="xalign">0</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkAlignment" id="alignment14">
+			      <property name="visible">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xscale">1</property>
+			      <property name="yscale">1</property>
+			      <property name="top_padding">3</property>
+			      <property name="bottom_padding">0</property>
+			      <property name="left_padding">12</property>
+			      <property name="right_padding">0</property>
+
+			      <child>
+				<widget class="GtkComboBox" id="comboboxFormat">
+				  <property name="visible">True</property>
+				  <property name="add_tearoffs">False</property>
+				  <property name="focus_on_click">True</property>
+				</widget>
+			      </child>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">True</property>
+			      <property name="fill">True</property>
+			    </packing>
+			  </child>
+			</widget>
+			<packing>
+			  <property name="padding">0</property>
+			  <property name="expand">False</property>
+			  <property name="fill">False</property>
+			</packing>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="padding">0</property>
+		  <property name="expand">False</property>
+		  <property name="fill">False</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkDrawingArea" id="guiDrawing">
+		  <property name="width_request">496</property>
+		  <property name="height_request">288</property>
+		  <property name="visible">True</property>
+		  <property name="sensitive">False</property>
+		</widget>
+		<packing>
+		  <property name="padding">0</property>
+		  <property name="expand">True</property>
+		  <property name="fill">True</property>
+		</packing>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="padding">0</property>
+	      <property name="expand">True</property>
+	      <property name="fill">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkTable" id="table2">
+	      <property name="border_width">3</property>
+	      <property name="visible">True</property>
+	      <property name="n_rows">3</property>
+	      <property name="n_columns">2</property>
+	      <property name="homogeneous">False</property>
+	      <property name="row_spacing">0</property>
+	      <property name="column_spacing">6</property>
+
+	      <child>
+		<widget class="GtkVBox" id="vbox14">
+		  <property name="visible">True</property>
+		  <property name="homogeneous">False</property>
+		  <property name="spacing">0</property>
+
+		  <child>
+		    <widget class="GtkLabel" id="label21">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">&lt;b&gt;Selection&lt;/b&gt;</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">True</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkAlignment" id="alignment15">
+		      <property name="visible">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xscale">1</property>
+		      <property name="yscale">1</property>
+		      <property name="top_padding">3</property>
+		      <property name="bottom_padding">0</property>
+		      <property name="left_padding">12</property>
+		      <property name="right_padding">0</property>
+
+		      <child>
+			<widget class="GtkTable" id="table1">
+			  <property name="visible">True</property>
+			  <property name="n_rows">2</property>
+			  <property name="n_columns">2</property>
+			  <property name="homogeneous">False</property>
+			  <property name="row_spacing">3</property>
+			  <property name="column_spacing">3</property>
+
+			  <child>
+			    <widget class="GtkLabel" id="labelMarkA">
+			      <property name="visible">True</property>
+			      <property name="can_focus">True</property>
+			      <property name="label" translatable="yes"> 0000000</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">1</property>
+			      <property name="right_attach">2</property>
+			      <property name="top_attach">0</property>
+			      <property name="bottom_attach">1</property>
+			      <property name="x_options">fill</property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkLabel" id="labelMarkB">
+			      <property name="visible">True</property>
+			      <property name="can_focus">True</property>
+			      <property name="label" translatable="yes"> 0000000</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">1</property>
+			      <property name="right_attach">2</property>
+			      <property name="top_attach">1</property>
+			      <property name="bottom_attach">2</property>
+			      <property name="x_options">fill</property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkButton" id="buttonGotoA">
+			      <property name="height_request">20</property>
+			      <property name="visible">True</property>
+			      <property name="tooltip" translatable="yes">Go to marker A</property>
+			      <property name="label" translatable="yes">A:</property>
+			      <property name="use_underline">True</property>
+			      <property name="relief">GTK_RELIEF_NORMAL</property>
+			      <property name="focus_on_click">True</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">0</property>
+			      <property name="right_attach">1</property>
+			      <property name="top_attach">0</property>
+			      <property name="bottom_attach">1</property>
+			      <property name="x_options">fill</property>
+			      <property name="y_options">fill</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkButton" id="buttonGotoB">
+			      <property name="height_request">20</property>
+			      <property name="visible">True</property>
+			      <property name="tooltip" translatable="yes">Go to marker B</property>
+			      <property name="label" translatable="yes">B:</property>
+			      <property name="use_underline">True</property>
+			      <property name="relief">GTK_RELIEF_NORMAL</property>
+			      <property name="focus_on_click">True</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">0</property>
+			      <property name="right_attach">1</property>
+			      <property name="top_attach">1</property>
+			      <property name="bottom_attach">2</property>
+			      <property name="x_options">fill</property>
+			      <property name="y_options">fill</property>
+			    </packing>
+			  </child>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">True</property>
+		      <property name="fill">True</property>
+		    </packing>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">1</property>
+		  <property name="bottom_attach">3</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options">fill</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkHBox" id="hbox10">
+		  <property name="visible">True</property>
+		  <property name="homogeneous">False</property>
+		  <property name="spacing">0</property>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonPlay">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Play</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+		      <accelerator key="space" modifiers="0" signal="clicked"/>
+
+		      <child>
+			<widget class="GtkImage" id="image591">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">play.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonStop">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Stop</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image5056">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">stop.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonPrevFrame">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Previous frame</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+		      <accelerator key="KP_4" modifiers="0" signal="clicked"/>
+
+		      <child>
+			<widget class="GtkImage" id="image593">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">backward.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonNextFrame">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Next frame</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+		      <accelerator key="KP_6" modifiers="0" signal="clicked"/>
+
+		      <child>
+			<widget class="GtkImage" id="image594">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">forward.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonPrevKFrame">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Previous keyframe</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+		      <accelerator key="KP_2" modifiers="0" signal="clicked"/>
+
+		      <child>
+			<widget class="GtkImage" id="image595">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">Kbackward.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonNextKFrame">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Next keyframe</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+		      <accelerator key="KP_8" modifiers="0" signal="clicked"/>
+
+		      <child>
+			<widget class="GtkImage" id="image596">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">Kforward.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonMarkA">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Selection: start</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image2306">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">markA.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonMarkB">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Selection: end</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image2307">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">markB.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonPrevBlack">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Previous black frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image2308">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">xpm_prevblack.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonNextBlack">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Next black frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image2309">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">xpm_nextblack.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonBegin">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">First frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image5057">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">begin.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkButton" id="buttonEnd">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Last frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="relief">GTK_RELIEF_NONE</property>
+		      <property name="focus_on_click">False</property>
+
+		      <child>
+			<widget class="GtkImage" id="image2245">
+			  <property name="visible">True</property>
+			  <property name="pixbuf">end.xpm</property>
+			  <property name="xalign">0.5</property>
+			  <property name="yalign">0.5</property>
+			  <property name="xpad">0</property>
+			  <property name="ypad">0</property>
+			</widget>
+		      </child>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">1</property>
+		  <property name="bottom_attach">2</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkHScale" id="sliderNavigate">
+		  <property name="visible">True</property>
+		  <property name="draw_value">True</property>
+		  <property name="value_pos">GTK_POS_LEFT</property>
+		  <property name="digits">1</property>
+		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
+		  <property name="inverted">False</property>
+		  <property name="adjustment">0 0 99.9899978638 0.00999999977648 1 0</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkHBox" id="hbox16">
+		  <property name="visible">True</property>
+		  <property name="homogeneous">False</property>
+		  <property name="spacing">6</property>
+
+		  <child>
+		    <widget class="GtkLabel" id="label1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Frame: </property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkEntry" id="boxCurFrame">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Current frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="editable">True</property>
+		      <property name="visibility">True</property>
+		      <property name="max_length">8</property>
+		      <property name="text" translatable="yes">0</property>
+		      <property name="has_frame">True</property>
+		      <property name="invisible_char">*</property>
+		      <property name="activates_default">False</property>
+		      <property name="width_chars">8</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="labelTotalFrame">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">/ 0000000</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">5</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="label4">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Time: </property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkEntry" id="boxCurTime">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Current time</property>
+		      <property name="can_focus">True</property>
+		      <property name="editable">True</property>
+		      <property name="visibility">True</property>
+		      <property name="max_length">0</property>
+		      <property name="text" translatable="yes">00:00:00.000</property>
+		      <property name="has_frame">True</property>
+		      <property name="invisible_char">*</property>
+		      <property name="activates_default">False</property>
+		      <property name="width_chars">13</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="labelTotalTime">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">/ 00:00:00,000</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">5</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="labelFrameType">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">Frame: ?</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">2</property>
+		  <property name="bottom_attach">3</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="Custom" id="jogg">
+		  <property name="visible">True</property>
+		  <property name="creation_function">jog_shuttle_new</property>
+		  <property name="int1">0</property>
+		  <property name="int2">0</property>
+		  <property name="last_modification_time">Wed, 04 Jul 2007 18:33:02 GMT</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options">expand</property>
+		</packing>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="padding">0</property>
+	      <property name="expand">False</property>
+	      <property name="fill">False</property>
+	    </packing>
+	  </child>
+	</widget>
+	<packing>
+	  <property name="padding">0</property>
+	  <property name="expand">True</property>
+	  <property name="fill">True</property>
+	</packing>
+      </child>
+    </widget>
+  </child>
+</widget>
+
+</glade-interface>



From mean at mail.berlios.de  Sun Jun 22 09:13:53 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 09:13:53 +0200
Subject: [Avidemux-svn-commit] r4138 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: ADM_encoder
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200806220713.m5M7Drrb021695@sheep.berlios.de>

Author: mean
Date: 2008-06-22 09:13:53 +0200 (Sun, 22 Jun 2008)
New Revision: 4138

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_pluginLoad.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp
Log:
[UI] Display audio & video encoder plugins info


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp	2008-06-21 18:49:11 UTC (rev 4137)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp	2008-06-22 07:13:53 UTC (rev 4138)
@@ -16,8 +16,9 @@
 
 #include "ADM_default.h"
 #include "ADM_externalEncoder.h"
-#include "ADM_plugin/ADM_vidEnc_plugin.h"
+#include "ADM_plugin/ADM_vidEnc_plugin.h"
 
+
 externalEncoder::externalEncoder(COMPRES_PARAMS *params, bool globalHeader)
 {
 	_plugin = getVideoEncoderPlugin(params->extra_param);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_pluginLoad.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_pluginLoad.cpp	2008-06-21 18:49:11 UTC (rev 4137)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_pluginLoad.cpp	2008-06-22 07:13:53 UTC (rev 4138)
@@ -59,7 +59,38 @@
 		&close, "vidEncClose"));
 }
 
-std::vector<ADM_vidEnc_plugin *> ADM_videoEncoderPlugins;
+std::vector<ADM_vidEnc_plugin *> ADM_videoEncoderPlugins;
+/**
+    \fn ADM_ve_getNbEncoders
+    \brief get the number of encoder plugin loaded
+    @return the number of encoder plugins
+*/
+uint32_t ADM_ve_getNbEncoders(void)
+{
+    return ADM_videoEncoderPlugins.size();
+
+}
+/**
+     \fn ADM_ve_getEncoderInfo
+     \brief Get info about an encoder plugin
+     @param filter [in] Encoder index, between 0 and ADM_ve_getNbEncoders-1 included
+     @param name [out] Name + info of the encoder
+     @param major,minor,patch [out] Version number of the encoder
+     @return true
+*/
+bool     ADM_ve_getEncoderInfo(int filter, const char **name, uint32_t *major,uint32_t *minor,uint32_t *patch)
+{
+    ADM_assert(filter>=0 && filter<ADM_videoEncoderPlugins.size());
+    ADM_vidEnc_plugin *plugin =ADM_videoEncoderPlugins[filter];
+        *name=plugin->getEncoderDescription(0);
+    int ma,mi,pa;
+        plugin->getEncoderVersion(0,&ma,&mi,&pa);
+        *major=(uint32_t)ma;
+        *minor=(uint32_t)mi;
+        *patch=(uint32_t)pa;
+        return true;
+
+}
 
 static int loadVideoEncoderPlugin(int uiType, const char *file)
 {
@@ -284,5 +315,7 @@
 
 	return ADM_videoEncoderPlugins[index];
 }
-
+/**
+
+*/
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp	2008-06-21 18:49:11 UTC (rev 4137)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_plugins.cpp	2008-06-22 07:13:53 UTC (rev 4138)
@@ -19,6 +19,9 @@
 /* Functions we need to get infos */
 uint32_t ADM_ad_getNbFilters(void);
 bool     ADM_ad_getFilterInfo(int filter, const char **name, uint32_t *major,uint32_t *minor,uint32_t *patch);
+uint32_t ADM_ve_getNbEncoders(void);
+bool     ADM_ve_getEncoderInfo(int filter, const char **name, uint32_t *major,uint32_t *minor,uint32_t *patch);
+
 /* /Functions */
 /**
         \fn DIA_pluginsInfo
@@ -28,14 +31,74 @@
 uint8_t DIA_pluginsInfo(void)
 {
     uint32_t aNbPlugin=ADM_ad_getNbFilters();
+    uint32_t veNbPlugin=ADM_ve_getNbEncoders();
+
+    // Audio Plugins
+
     printf("[Audio Plugins] Found %u plugins\n",aNbPlugin);
+    diaElemReadOnlyText *aText[aNbPlugin];
+    diaElemFrame frameAudio(QT_TR_NOOP("Audio Plugins"));
+        
+       
     for(int i=0;i<aNbPlugin;i++)
     {
         const char *name;
         uint32_t major,minor,patch;
+        char versionString[256];
+        char infoString[256];
+        char *end;
             ADM_ad_getFilterInfo(i, &name,&major,&minor,&patch);
-            printf("[Audio Plugins] %s version :%2d.%2d.%2d\n",name,major,minor,patch);
+            snprintf(versionString,255,"%02d.%02d.%02d",major,minor,patch);
+            strncpy(infoString,name,255);
+            if(strlen(infoString))
+            {
+                end=strlen(infoString)+infoString-1;
+                // Remove trailing line feed
+                while(*end==0x0a || *end==0x0d) *end--=0;
+            }
+            aText[i]=new diaElemReadOnlyText(infoString,versionString);
+            frameAudio.swallow(aText[i]);
+    }
+    diaElem *diaAudio[]={&frameAudio};
+    diaElemTabs tabAudio(QT_TR_NOOP("Audio"),1,diaAudio);
+    // /Audio
 
+    // Encoder
+    printf("[VideoEncoder Plugins] Found %u plugins\n",veNbPlugin);
+    diaElemReadOnlyText *veText[veNbPlugin];
+    diaElemFrame frameVE(QT_TR_NOOP("Video Encoder Plugins"));
+        
+       
+    for(int i=0;i<veNbPlugin;i++)
+    {
+        const char *name;
+        uint32_t major,minor,patch;
+        char versionString[256];
+        char infoString[256];
+        char *end;
+            ADM_ve_getEncoderInfo(i, &name,&major,&minor,&patch);
+            snprintf(versionString,255,"%02d.%02d.%02d",major,minor,patch);
+            strncpy(infoString,name,255);
+            if(strlen(infoString))
+            {
+                end=strlen(infoString)+infoString-1;
+                // Remove trailing line feed
+                while(*end==0x0a || *end==0x0d) *end--=0;
+            }
+            veText[i]=new diaElemReadOnlyText(infoString,versionString);
+            frameVE.swallow(veText[i]);
     }
+    diaElem *diaVE[]={&frameVE};
+    diaElemTabs tabVE(QT_TR_NOOP("Video Encoder"),1,diaVE);
+
+    // /Encoder
+    diaElemTabs *tabs[]={&tabAudio,&tabVE};
+    diaFactoryRunTabs(QT_TR_NOOP("Plugins Info"),2,tabs);
+
+    for(int i=0;i<aNbPlugin;i++)
+        delete aText[i];
+    for(int i=0;i<veNbPlugin;i++)
+        delete veText[i];
+
     return 1;
 }



From mean at mail.berlios.de  Sun Jun 22 09:13:55 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 09:13:55 +0200
Subject: [Avidemux-svn-commit] r4139 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src
Message-ID: <200806220713.m5M7DtSb021707@sheep.berlios.de>

Author: mean
Date: 2008-06-22 09:13:55 +0200 (Sun, 22 Jun 2008)
New Revision: 4139

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_readOnlyText.cpp
Log:
[Factory] Also copy the name of the text for *text factory element


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_readOnlyText.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_readOnlyText.cpp	2008-06-22 07:13:53 UTC (rev 4138)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_readOnlyText.cpp	2008-06-22 07:13:55 UTC (rev 4139)
@@ -47,13 +47,14 @@
   : diaElem(ELEM_ROTEXT)
 {
   param=(void *)ADM_strdup(readyOnly);
-  paramTitle=toggleTitle;
+  paramTitle=ADM_strdup(toggleTitle);
   this->tip=tip;
 }
 
 diaElemReadOnlyText::~diaElemReadOnlyText()
 {
   ADM_dealloc(param);
+  ADM_dealloc(paramTitle);
 }
 void diaElemReadOnlyText::setMe(void *dialog, void *opaque,uint32_t line)
 {
@@ -95,13 +96,14 @@
 {
   if(!*text) *text=ADM_strdup("");
   param=(void *)text;
-  paramTitle=toggleTitle;
+  paramTitle=ADM_strdup(toggleTitle);
+  
   this->tip=tip;
 }
 
 diaElemText::~diaElemText()
 {
-  
+  ADM_dealloc(paramTitle);
 }
 void diaElemText::setMe(void *dialog, void *opaque,uint32_t line)
 {



From mean at mail.berlios.de  Sun Jun 22 11:20:58 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 11:20:58 +0200
Subject: [Avidemux-svn-commit] r4140 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806220920.m5M9KwX0031535@sheep.berlios.de>

Author: mean
Date: 2008-06-22 11:20:57 +0200 (Sun, 22 Jun 2008)
New Revision: 4140

Modified:
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[UI] Have predefined framerate (FS#361)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-22 07:13:55 UTC (rev 4139)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-22 09:20:57 UTC (rev 4140)
@@ -796,22 +796,47 @@
 
     case ACT_ChangeFPS:
     	{
-      	float  fps;
-	 aviInfo info;
-	 video_body->getVideoInfo (&info);
-       	fps=info.fps1000;
-	fps/=1000.;
+         float  fps;
+         aviInfo info;
+         uint32_t useDefined=1;
+         uint32_t defaultFps[3]={25000,23976,29970};
+         uint32_t index=0;
+         video_body->getVideoInfo (&info);
+         fps=info.fps1000;
+         fps/=1000.;
 
 
-      	if (DIA_GetFloatValue (&fps, 1., 60., QT_TR_NOOP("Frame Rate"),QT_TR_NOOP("_Frames per second:")))
-	{
 
-	  info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
-	  video_body->updateVideoInfo (&info);
-	  // update display
-	  video_body->getVideoInfo (avifileinfo);
-	  rebuild_status_bar();
-	 }
+        diaElemToggle togUsePredefined(&useDefined,QT_TR_NOOP("Use custom value"));
+        diaElemFloat  fpsFloatValue(&fps,QT_TR_NOOP("Frame Rate"),1.,200.,QT_TR_NOOP("_Frames per second"));
+
+        diaMenuEntry menuFps[]={
+              {0,QT_TR_NOOP("PAL - 25 FPS")},
+              {1,QT_TR_NOOP("FILM- 24 FPS")},
+              {2,QT_TR_NOOP("NTSC- 30 FPS")}};
+
+         diaElemMenu      stdFps(&index,QT_TR_NOOP("Standard FrameRate:"),3,menuFps);
+
+        togUsePredefined.link(1,&fpsFloatValue);
+        togUsePredefined.link(0,&stdFps);
+
+        diaElem *elems[3]={&togUsePredefined,&fpsFloatValue,&stdFps};
+        if(diaFactoryRun(QT_TR_NOOP("Change FrameRate"),3,elems))
+        {
+          if(useDefined)
+          {
+            info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
+          }else
+          {
+            info.fps1000=defaultFps[index];
+          }
+          video_body->updateVideoInfo (&info);
+          printf("[MainUI] New framerate :%u\n",info.fps1000);
+          // update display
+          video_body->getVideoInfo (avifileinfo);
+          rebuild_status_bar();
+
+        }
 	}
       break;
       // set decoder option (post processing ...)



From mean at mail.berlios.de  Sun Jun 22 15:38:00 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 15:38:00 +0200
Subject: [Avidemux-svn-commit] r4141 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_libraries/ADM_utilities
Message-ID: <200806221338.m5MDc0Va015067@sheep.berlios.de>

Author: mean
Date: 2008-06-22 15:38:00 +0200 (Sun, 22 Jun 2008)
New Revision: 4141

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
   branches/avidemux_2.4_branch/avidemux/prefs.in
Log:
[Prefs] Change default font & audio device(alsa/dmix)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2008-06-22 09:20:57 UTC (rev 4140)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2008-06-22 13:38:00 UTC (rev 4141)
@@ -87,7 +87,7 @@
 	{"codecs.xvid.bitrate",		UINT,	"1500000",NULL,	"17",	"5900000"},
 	{"codecs.xvid.finalsize",	UINT,	"700",	NULL,	"0",	"3999"	},
 	{"codecs.preferredcodec",		STRING,"FFmpeg4",NULL, NULL, NULL },
-	{"filters.subtitle.fontname",		FILENAME,"/usr/X11R6/lib/X11/fonts/truetype/arial.ttf",NULL, NULL, NULL },
+	{"filters.subtitle.fontname",		FILENAME,"/usr/share/fonts/truetype/DejaVuSans.ttf",NULL, NULL, NULL },
 	{"filters.subtitle.charset",		STRING,"ISO-8859-1",NULL, NULL, NULL },
 	{"filters.subtitle.fontsize",		UINT,	"24",	NULL,	"1",	"576"	},
 	{"filters.subtitle.ypercent",	INT,	"255",	NULL,	"0",	"255"	},
@@ -96,8 +96,8 @@
 	{"filters.subtitle.selfadjustable",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"filters.subtitle.usebackgroundcolor",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"settings.mpegsplit",	UINT,	"790",	NULL,	"400",	"5000"	},
-	{"device.audiodevice",	STRING,"OSS",	NULL, NULL, NULL },
-	{"device.audio.alsa_device",		STRING,"plughw:0,0",NULL, NULL, NULL },
+	{"device.audiodevice",		STRING,"ALSA",	NULL, NULL, NULL },
+	{"device.audio.alsa_device",		STRING,"dmix",	NULL, NULL, NULL },
 	{"device.videodevice",		UINT,	"0",	NULL,	"0",	"10"	},
 	{"default.postproc_type",		UINT,	"3",	NULL,	"0",	"7"	},
 	{"default.postproc_value",		UINT,	"3",	NULL,	"0",	"5"	},

Modified: branches/avidemux_2.4_branch/avidemux/prefs.in
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.in	2008-06-22 09:20:57 UTC (rev 4140)
+++ branches/avidemux_2.4_branch/avidemux/prefs.in	2008-06-22 13:38:00 UTC (rev 4141)
@@ -36,7 +36,7 @@
 codecs.xvid.bitrate,			UINT,	1500000,17,	5900000
 codecs.xvid.finalsize,			UINT,	700,	0,	3999
 codecs.preferredcodec,			STRING,	FFmpeg4
-filters.subtitle.fontname,		FILENAME, "/usr/X11R6/lib/X11/fonts/truetype/arial.ttf"
+filters.subtitle.fontname,		FILENAME, "/usr/share/fonts/truetype/DejaVuSans.ttf"
 filters.subtitle.charset,		STRING, "ISO-8859-1"
 filters.subtitle.fontsize,		UINT,	24,	1,	576
 filters.subtitle.ypercent,		INT,	255,	0,	255
@@ -46,8 +46,8 @@
 filters.subtitle.usebackgroundcolor,	UINT,	0,	0,	1
 # codec metasettings for mpeg2enc based
 settings.mpegsplit, 			UINT,	790,	400,	5000
-device.audiodevice,			STRING,	OSS
-device.audio.alsa_device,               STRING, "plughw:0 at 0"
+device.audiodevice,			STRING,	ALSA
+device.audio.alsa_device,               STRING, "dmix"
 device.videodevice,			UINT,	0,	0,	10
 # Posproc
 default.postproc_type,			UINT,	3,	0,	7
@@ -100,4 +100,4 @@
 # priority
 priority.encoding,          UINT,   3,      0,      4
 priority.indexing,          UINT,   3,      0,      4
-priority.playback,          UINT,   0,      0,      4
\ No newline at end of file
+priority.playback,          UINT,   0,      0,      4



From mean at mail.berlios.de  Sun Jun 22 16:46:22 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 16:46:22 +0200
Subject: [Avidemux-svn-commit] r4142 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806221446.m5MEkMmG025906@sheep.berlios.de>

Author: mean
Date: 2008-06-22 16:46:21 +0200 (Sun, 22 Jun 2008)
New Revision: 4142

Modified:
   branches/avidemux_2.4_branch/avidemux/gui_action.cpp
Log:
[Code] Missing include (FS#349)

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.cpp	2008-06-22 13:38:00 UTC (rev 4141)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.cpp	2008-06-22 14:46:21 UTC (rev 4142)
@@ -1,5 +1,6 @@
-#include <stdio.h>
-#include <strings.h>
+#include "default.h"
+#include <strings.h>
+
 #include <vector>
 using std::vector;
 #include <utility>



From mean at mail.berlios.de  Sun Jun 22 19:23:25 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jun 2008 19:23:25 +0200
Subject: [Avidemux-svn-commit] r4143 -
	branches/avidemux_2.4_branch/avidemux/ADM_codecs
Message-ID: <200806221723.m5MHNPM0011635@sheep.berlios.de>

Author: mean
Date: 2008-06-22 19:23:25 +0200 (Sun, 22 Jun 2008)
New Revision: 4143

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
Log:
[Mpeg2] Handle the case where depending on progressive/interlaced mpeg2dec force the height to the next multiple of 32 (FS#142)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2008-06-22 14:46:21 UTC (rev 4142)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2008-06-22 17:23:25 UTC (rev 4143)
@@ -153,17 +153,20 @@
 	// store for future use
 	_seqFound = 0;
 	par_width=par_height=1;
-
-	printf ("\nInitializing MPEG2 decoder %lu x %lu\n", _w, _h);
+    uint32_t roundWidth,roundHeight;
+    roundWidth=(_w+15)&~15;
+    roundHeight=(_h+31)&~31; // depending on interlaced/Progressive the height must be a multiple of 32
+	printf ("[Mpeg2dec]Initializing MPEG2 decoder %lu x %lu\n", _w, _h);
+    printf ("[Mpeg2dec]Initializing MPEG2 decoder using %lu x %lu\n", roundWidth, roundHeight);
 	output = yv12_open ();
 	inst = (yv12_instance_t *) output;
-	unpackBuffer = new uint8_t[(w * h * 9) >> 1];
+	unpackBuffer = new uint8_t[(roundWidth * roundHeight * 9) >> 1];
 	inst->buffer = unpackBuffer;
 	_decoder = mpeg2_init();
 	dec = &((MPEG2DEC)->decoder);
 
-	wmb = (_w + 15) >> 4;;
-	hmb = (_h + 15) >> 4;;
+	wmb = (roundWidth) >> 4;;
+	hmb = (roundWidth) >> 4;;
 
 	dec->quant_stride = wmb;
 	dec->quant = (int8_t *)ADM_alloc ((wmb * hmb) * sizeof (int8_t));
@@ -225,7 +228,7 @@
     }
   if (dontcopy ())
     {
-      uint32_t plane = _w * _h;
+      uint32_t plane = _w * ((_h+31)&~31);
 
       out->_planes[0] = t;
       out->_planes[1] = t + plane;
@@ -236,7 +239,10 @@
     }
   else
     {
-      memcpy (out->data, t, (_w * _h * 3) >> 1);
+    uint32_t plane = _w * ((_h+31)&~31);
+      memcpy (YPLANE(out), t, _w * _h );
+      memcpy (UPLANE(out), t+plane, (_w * _h)>>2 );
+      memcpy (VPLANE(out), t+(plane*5)/4, (_w * _h)>>2 );
     }
 
   switch (MPEG2DEC->decoder.coding_type)
@@ -324,6 +330,7 @@
 		  fprintf (stderr, "display setup failed\n");
 		  exit (1);
 		}
+          printf("[Mpeg2dec] Found info %u x %u\n", info->sequence->width, info->sequence->height);
 	      uint8_t *buf[3];
 	      void *id;
 	      //mpeg2_custom_fbuf(MPEG2DEC,1);
@@ -414,7 +421,8 @@
 }
 
 /**
-	yv12_setup_fbuf : Allocate some buffers
+	\fn yv12_setup_fbuf 
+    \brief : Allocate some buffers
 */
 static void
 yv12_setup_fbuf (vo_instance_t * _instance, uint8_t ** buf, void **id)



From gruntster at mail.berlios.de  Sun Jun 22 21:25:03 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Jun 2008 21:25:03 +0200
Subject: [Avidemux-svn-commit] r4144 - in branches/avidemux_2.4_branch:
	admin avidemux avidemux/ADM_libraries/ADM_utilities
Message-ID: <200806221925.m5MJP3JQ009298@sheep.berlios.de>

Author: gruntster
Date: 2008-06-22 21:24:53 +0200 (Sun, 22 Jun 2008)
New Revision: 4144

Modified:
   branches/avidemux_2.4_branch/admin/prefs_gen.pl
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
   branches/avidemux_2.4_branch/avidemux/prefs.in
Log:
[Win32] by default enable Win32 audio output (FS#391) and arial.ttf for subtitle font

Modified: branches/avidemux_2.4_branch/admin/prefs_gen.pl
===================================================================
--- branches/avidemux_2.4_branch/admin/prefs_gen.pl	2008-06-22 17:23:25 UTC (rev 4143)
+++ branches/avidemux_2.4_branch/admin/prefs_gen.pl	2008-06-22 19:24:53 UTC (rev 4144)
@@ -40,17 +40,17 @@
 my @data;
 my $flag;
 my $num_opts = 0;
+my $prev_optname = "";
 
 open($fd,"< $in") or die;
 while(<$fd>){
 	chomp;
-	s/#.*$//;
+	s/^(#\s.*|#$)//;
 	next if( /^[ 	]*$/ );
 	#     optname       type           value  rest
-        if( /^([^,]+)\s*,\s*([A-Z]+)\s*,\s*([^,]+)(.*)$/ ){
-	   my ($N,$a,$b,$c,$d,$e) = ($1,uc($1),$2,$3,$4,$4);
+	if( /^([^,]+)\s*,\s*([A-Z]+)\s*,\s*([^,]+)(.*)$/ ){
+		my ($N,$a,$b,$c,$d,$e) = ($1,uc($1),$2,$3,$4,$4);
 		$a       =~ s/\./_/g;
-		$h_str   .= "\t$a,\n";
 		$cpp_str .= "\t{\"$N\",";
 		$cpp_str .= "\t" if( length($c)%8 != 3 );
 		$cpp_str .= "\t$b,";
@@ -81,9 +81,19 @@
 			$cpp_str .= "},\n";
 			die "value($a) < min : $c < $d\n" if( $c < $d );
 		}
-		$num_opts++;
+
+		if ($prev_optname ne $N){
+			$h_str .= "\t$a,\n";
+			$num_opts++;
+			$prev_optname = $N;
+		}
 	}else{
-		die "parse error in \"$in\" line \"$_\".";
+		if ( /^#/ ){
+			$cpp_str .= "$_\n";
+		}
+		else {
+			die "parse error in \"$in\" line \"$_\".";
+		}
 	}
 }
 close($fd);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2008-06-22 17:23:25 UTC (rev 4143)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2008-06-22 19:24:53 UTC (rev 4144)
@@ -87,7 +87,11 @@
 	{"codecs.xvid.bitrate",		UINT,	"1500000",NULL,	"17",	"5900000"},
 	{"codecs.xvid.finalsize",	UINT,	"700",	NULL,	"0",	"3999"	},
 	{"codecs.preferredcodec",		STRING,"FFmpeg4",NULL, NULL, NULL },
+#ifdef __WIN32
+	{"filters.subtitle.fontname",		FILENAME,"C:\\Windows\\Fonts\\arial.ttf",NULL, NULL, NULL },
+#else
 	{"filters.subtitle.fontname",		FILENAME,"/usr/share/fonts/truetype/DejaVuSans.ttf",NULL, NULL, NULL },
+#endif
 	{"filters.subtitle.charset",		STRING,"ISO-8859-1",NULL, NULL, NULL },
 	{"filters.subtitle.fontsize",		UINT,	"24",	NULL,	"1",	"576"	},
 	{"filters.subtitle.ypercent",	INT,	"255",	NULL,	"0",	"255"	},
@@ -96,7 +100,11 @@
 	{"filters.subtitle.selfadjustable",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"filters.subtitle.usebackgroundcolor",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"settings.mpegsplit",	UINT,	"790",	NULL,	"400",	"5000"	},
+#ifdef __WIN32
+	{"device.audiodevice",		STRING,"WIN32",NULL, NULL, NULL },
+#else
 	{"device.audiodevice",		STRING,"ALSA",	NULL, NULL, NULL },
+#endif
 	{"device.audio.alsa_device",		STRING,"dmix",	NULL, NULL, NULL },
 	{"device.videodevice",		UINT,	"0",	NULL,	"0",	"10"	},
 	{"default.postproc_type",		UINT,	"3",	NULL,	"0",	"7"	},

Modified: branches/avidemux_2.4_branch/avidemux/prefs.in
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.in	2008-06-22 17:23:25 UTC (rev 4143)
+++ branches/avidemux_2.4_branch/avidemux/prefs.in	2008-06-22 19:24:53 UTC (rev 4144)
@@ -36,7 +36,11 @@
 codecs.xvid.bitrate,			UINT,	1500000,17,	5900000
 codecs.xvid.finalsize,			UINT,	700,	0,	3999
 codecs.preferredcodec,			STRING,	FFmpeg4
+#ifdef __WIN32
+filters.subtitle.fontname,		FILENAME, "C:\\Windows\\Fonts\\arial.ttf"
+#else
 filters.subtitle.fontname,		FILENAME, "/usr/share/fonts/truetype/DejaVuSans.ttf"
+#endif
 filters.subtitle.charset,		STRING, "ISO-8859-1"
 filters.subtitle.fontsize,		UINT,	24,	1,	576
 filters.subtitle.ypercent,		INT,	255,	0,	255
@@ -46,7 +50,11 @@
 filters.subtitle.usebackgroundcolor,	UINT,	0,	0,	1
 # codec metasettings for mpeg2enc based
 settings.mpegsplit, 			UINT,	790,	400,	5000
+#ifdef __WIN32
+device.audiodevice,			STRING,	WIN32
+#else
 device.audiodevice,			STRING,	ALSA
+#endif
 device.audio.alsa_device,               STRING, "dmix"
 device.videodevice,			UINT,	0,	0,	10
 # Posproc



From gruntster at mail.berlios.de  Sun Jun 22 22:19:19 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Jun 2008 22:19:19 +0200
Subject: [Avidemux-svn-commit] r4145 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs
	ADM_inputs/ADM_inpics
Message-ID: <200806222019.m5MKJJwr016434@sheep.berlios.de>

Author: gruntster
Date: 2008-06-22 22:19:12 +0200 (Sun, 22 Jun 2008)
New Revision: 4145

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
Log:
[RGB/DIB] treat BMPs as DIB + switch handling of colourspace for 24/32bit RGB and DIB images (FS#425)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-22 19:24:53 UTC (rev 4144)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2008-06-22 20:19:12 UTC (rev 4145)
@@ -399,14 +399,14 @@
     {
       // RGB 16 Codecs
       printf ("\n using RGB codec\n");
-      return (decoders *) (new decoderRGB16 (w, h, 0, bpp));
+      return (decoders *) (new decoderRGB16 (w, h, 1, bpp));
 
     }
  if ((fcc == 0) || fourCC::check (fcc, (uint8_t *) "DIB "))
     {
       // RGB 16 Codecs
-      printf ("\n using RGB-DIB codec\n");
-      return (decoders *) (new decoderRGB16 (w, h, 1, bpp));
+      printf ("\n using DIB codec\n");
+      return (decoders *) (new decoderRGB16 (w, h, 0, bpp));
 
     }
   if (isMpeg12Compatible (fcc))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-22 19:24:53 UTC (rev 4144)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-22 20:19:12 UTC (rev 4145)
@@ -406,7 +406,7 @@
 	        break;
 	    case PIC_BMP:
 	    case PIC_BMP2:
-	        _video_bih.biCompression = _videostream.fccHandler = 0;
+	        _video_bih.biCompression = _videostream.fccHandler = fourCC::get((uint8_t *) "DIB ");
 	        break;
 	    case PIC_PNG:
 	        _video_bih.biCompression = _videostream.fccHandler =



From gruntster at mail.berlios.de  Mon Jun 23 12:35:12 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Jun 2008 12:35:12 +0200
Subject: [Avidemux-svn-commit] r4146 - branches/avidemux_2.4_branch/po
Message-ID: <200806231035.m5NAZCVs009295@sheep.berlios.de>

Author: gruntster
Date: 2008-06-23 12:34:57 +0200 (Mon, 23 Jun 2008)
New Revision: 4146

Modified:
   branches/avidemux_2.4_branch/po/cs.po
Log:
[I18N] Czech update by J.M.

Modified: branches/avidemux_2.4_branch/po/cs.po
===================================================================
--- branches/avidemux_2.4_branch/po/cs.po	2008-06-22 20:19:12 UTC (rev 4145)
+++ branches/avidemux_2.4_branch/po/cs.po	2008-06-23 10:34:57 UTC (rev 4146)
@@ -7,18 +7,21 @@
 msgstr ""
 "Project-Id-Version: cs\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-10-26 02:09+0200\n"
-"PO-Revision-Date: 2007-10-27 10:30+0200\n"
+"POT-Creation-Date: 2008-06-23 02:33+0200\n"
+"PO-Revision-Date: 2008-06-23 08:31+0100\n"
 "Last-Translator: Jakub Misak <jmisak at centrum.cz>\n"
 "Language-Team:  <cs at li.org>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 "X-Generator: KBabel 1.11.4\n"
-"Plural-Forms:  nplurals=3; plural=(n==1) ? 0 : (n>=2 && n<=4) ? 1 : 2;\n"
+"Plural-Forms: nplurals=3; plural=(n==1) ? 0 : (n>=2 && n<=4) ? 1 : 2;\n"
+"X-Poedit-Basepath: /home/jmisak/programy/avidemux_2.4_branch\n"
+"X-Poedit-SearchPath-0: \n"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:42
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:369
 msgid "AVI"
 msgstr ""
 
@@ -47,23 +50,30 @@
 msgstr ""
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:49
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:493
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:131
 msgid "MP4"
 msgstr ""
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:50
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:119
 msgid "OGM"
 msgstr ""
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:51
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:130
 msgid "PSP"
 msgstr ""
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:277
 msgid "FLV"
 msgstr ""
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:53
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:132
 msgid "MKV"
 msgstr ""
 
@@ -71,6 +81,148 @@
 msgid "DUMMY"
 msgstr ""
 
+#: avidemux/ADM_encoder/adm_encmpeg2enc.h:57
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:523
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
+msgid "MPEG"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encyv12.h:69
+msgid "YV12"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encmjpeg.h:60
+msgid "MJPEG"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encx264.h:65
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
+msgid "x264"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encxvid.h:61
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
+msgid "Xvid"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encXvid4.h:62
+msgid "Xvid4"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encffmpeg.h:47
+msgid "LavCodec"
+msgstr ""
+
+#: avidemux/ADM_encoder/adm_encdivx.h:52
+msgid "DivX"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:13
+msgid "YV12 (raw)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:111
+msgid "H.263 (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:127
+msgid "H.263+ (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:143
+msgid "MPEG-4 ASP (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:159
+msgid "DV (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:175
+msgid "FLV1 (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:191
+msgid "Snow (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:207
+msgid "FF Huffyuv (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:223
+msgid "Huffyuv (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:239
+msgid "FFV1 (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:257
+msgid "MJPEG (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:314
+msgid "VCD (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:374
+msgid "DVD (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:434
+msgid "SVCD (lavc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:461
+msgid "VCD (mpeg2enc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:493
+msgid "SVCD (mpeg2enc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:512
+msgid "MPEG-2 requant"
+msgstr "MPEG-2 rekvantizace"
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:539
+msgid "DVD (mpeg2enc)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:671
+msgid "MPEG-4 ASP (Xvid4)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:812
+msgid "MPEG-4 AVC (x264)"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:829
+msgid "dummy"
+msgstr ""
+
+#: avidemux/ADM_encoder/ADM_encCodecDesc.h:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1081
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1121
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:271
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
+#: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:90
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:69
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:379
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:191
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:259
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:280
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:221
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:225
+#: avidemux/ADM_encoder/adm_encCopy.cpp:91
+msgid "Copy"
+msgstr "Kopie"
+
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:88
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:200
 msgid "Internal error"
@@ -87,7 +239,7 @@
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:220
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:103
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:296
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:295
 msgid "Stereo"
 msgstr ""
 
@@ -136,28 +288,38 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:252
 msgid "_Disable reservoir:"
-msgstr ""
+msgstr "Z_ak?zat bitov? z?sobn?k"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:256
 msgid "LAME Configuration"
 msgstr "Nastaven? LAME"
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
-#: avidemux/gui_autodrive.cpp:62 avidemux/gui_autodrive.cpp:71
-#: avidemux/gui_autodrive.cpp:112 avidemux/gui_autodrive.cpp:127
-#: avidemux/gui_autodrive.cpp:154 avidemux/gui_autodrive.cpp:188
+#: avidemux/gui_autodrive.cpp:62
+#: avidemux/gui_autodrive.cpp:72
+#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:128
+#: avidemux/gui_autodrive.cpp:155
+#: avidemux/gui_autodrive.cpp:189
 msgid "Codec Error"
 msgstr "Chyba kodeku"
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 msgid ""
-"The number of channels is greater than what the selected audio codec can "
-"do.\n"
+"The number of channels is greater than what the selected audio codec can do.\n"
 "Either change codec or use the mixer filter to have less channels."
 msgstr ""
 "Po?et kan?l? je v?t?? ne? zvl?dne zvolen? audio kodek.\n"
 "Bu? zm??te kodek, nebo mix?rem v audio filtrech sni?te po?et kan?l?."
 
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
+msgid "Encoder initialization failed"
+msgstr "Selhala inicializace kod?ru"
+
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:417
+msgid "Not activated."
+msgstr "Neaktivov?no."
+
 #: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
 msgid "VBR"
 msgstr "VBR"
@@ -187,7 +349,7 @@
 msgstr "Chyba konverze do BMP"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
-#: avidemux/gtk_gui.cpp:1927
+#: avidemux/gtk_gui.cpp:1950
 msgid "Something bad happened"
 msgstr "P?ihodilo se n?co zl?ho"
 
@@ -196,73 +358,73 @@
 msgstr "Nelze zak?dovat sn?mek"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
-#: avidemux/ADM_ocr/adm_glyph.cpp:221 avidemux/gtk_gui.cpp:903
-#: avidemux/gtk_gui.cpp:1505
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:430
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
+#: avidemux/gtk_gui.cpp:926
+#: avidemux/gtk_gui.cpp:1528
 msgid "File error"
 msgstr "Chyba souboru"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
-#: avidemux/gtk_gui.cpp:1505
+#: avidemux/gtk_gui.cpp:1528
 #, c-format
 msgid "Cannot open \"%s\" for writing."
 msgstr "Nelze otev??t soubor \"%s\" k z?pisu."
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:191
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:193
 msgid "Wrong Colorspace"
-msgstr ""
+msgstr "Nespr?vn? barevn? model"
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:191
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:193
 msgid "Only YV12/I420 or YUY2/I422 JPegs are supported"
-msgstr ""
+msgstr "Podporov?n je jen YV12/I420 nebo YUY2/I422 JPEG."
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp:37
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:290
+#: avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:291
 msgid "_File"
 msgstr "_Soubor"
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:324
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:327
 msgid "NTSC 4:3"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:325
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:326
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:328
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:329
 msgid "NTSC 16:9"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:327
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:330
 msgid "PAL 4:3"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:328
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:331
 msgid "PAL 16:9"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:329
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:376
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:398
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:42
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:332
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:383
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:43
 msgid "1:1"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:331
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:598
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:795
-#, fuzzy
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:334
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:599
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:796
 msgid "Unknown"
-msgstr "Nezn?m? ud?lost"
+msgstr "Nezn?m?"
 
 #: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:193
@@ -278,129 +440,136 @@
 msgid "lvemux init failed"
 msgstr "Nelze inicializovat lvemux"
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:378
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:379
 msgid "Incompatible frame rate"
 msgstr "Nekompatibiln? sn?mkov? frekvence"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:180
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:418
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1382
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:617
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:548
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:336
 msgid "Preview"
 msgstr "N?hled"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:78
 msgid "Hue"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:171
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:175
 msgid "Hue/Saturation"
 msgstr "Odst?n/sytost"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:189
 msgid "<b>Hue:</b>"
 msgstr "<b>Odst?n:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:197
 msgid "<b>Saturation:</b>"
 msgstr "<b>Sytost:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:159
 msgid "ColorYuv (From avisynth)"
 msgstr "ColorYUV (z Avisynthu)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:72
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:194
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:212
-#: avidemux/ADM_filter/filter_declaration.cpp:103
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:76
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:216
+#: avidemux/ADM_filter/filter_declaration.cpp:108
 msgid "Contrast"
 msgstr "Kontrast"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:221
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:225
 msgid "Brightness"
 msgstr "Jas"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:197
 msgid "Gamma"
 msgstr "Gama"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:200
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:204
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:97
 msgid "Gain"
 msgstr "Zv??en?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:207
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:211
 msgid "Luma Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:243
 msgid "Chroma U"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:221
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:225
 msgid "Chroma V"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:324
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:328
 msgid "<b>Color Correction Matrix</b>"
 msgstr "<b>Matice korekce barev</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:347
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:351
 msgid "Matrix"
 msgstr "Matice"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:354
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:358
 msgid "Opt"
 msgstr "Volba"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:361
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:365
 msgid "Level"
 msgstr "?rove?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:373
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:381
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:389
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:553
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:568
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:583
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1124
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:377
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:385
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:393
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:554
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:569
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:584
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1191
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:225
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:327
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:51
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
+#: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:263
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264 avidemux/gtk_gui.cpp:2005
-#: avidemux/gtk_gui.cpp:2104
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
+#: avidemux/gtk_gui.cpp:2028
+#: avidemux/gtk_gui.cpp:2127
 msgid "None"
 msgstr "Nic"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:374
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:378
 msgid "Rec.709"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:382
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:386
 msgid "Coring"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:390
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:394
 msgid "TV->PC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:391
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:395
 msgid "PC->TV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:392
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:396
 msgid "PC->TV.Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:398
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:402
 msgid ""
 "<b>Matrix Warning :</b>\n"
 "all above values are normalized to 256!"
@@ -408,19 +577,19 @@
 "<b>Varov?n? matice:</b>\n"
 "V?echny hodnoty naho?e jsou normalizov?ny na 256!"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:408
 msgid "AutoGain"
 msgstr "Automatick? zv??en?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:408
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:412
 msgid "Display Stats"
 msgstr "Zobrazovat statistiku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:412
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
 msgid "AutoWhite"
 msgstr "Automatick? b?l?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:420
 msgid "<b>frame2</b>"
 msgstr "<b>Vlastnosti</b>"
 
@@ -430,19 +599,19 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:79
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:661
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:668
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:675
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:662
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:669
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:789
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:632
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:648
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:664
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:694
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:636
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:652
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:698
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:426
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:440
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1213
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:82
 msgid "0"
 msgstr ""
@@ -457,7 +626,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:108
 msgid "TimeCode:"
-msgstr ""
+msgstr "?asov? k?d:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:116
 msgid "# of Glyphs :"
@@ -473,10 +642,10 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:154
 msgid " Text:"
-msgstr ""
+msgstr "Text:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:161
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:256
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:255
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:276
 msgid " "
@@ -484,7 +653,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:176
 msgid "_Calibrate"
-msgstr ""
+msgstr "_Kalibrace"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:180
 msgid "If the glyphs are too thin, enter a lower value here"
@@ -492,11 +661,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:182
 msgid "S_kip all"
-msgstr ""
+msgstr "_P?esko?it v?e"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
 msgid "Skip the whole image"
-msgstr ""
+msgstr "P?esko?it cel? obr?zek"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:188
 msgid "Skip Glyph"
@@ -504,7 +673,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:192
 msgid "Skip the current letter/glyph"
-msgstr ""
+msgstr "P?esko?it aktu?ln? p?smeno/glyf"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:194
 msgid "_Ignore glyph"
@@ -522,1535 +691,1395 @@
 msgid "<b>Bitmap</b>"
 msgstr "<b>Bitmapa</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:184
 msgid "Privileges Required"
-msgstr ""
+msgstr "Po?adovan? opr?vn?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:184
 msgid "Root privileges are required to perform this operation."
-msgstr ""
+msgstr "K t?to akci jsou nutn? pr?va roota."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:205
 msgid "Shutting down"
-msgstr ""
+msgstr "Vyp?n?m"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:382
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:150
 #, c-format
 msgid "%d%%"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:404
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:411
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:418
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:412
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:419
 #, c-format
 msgid "%lu MB"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:514
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:515
 msgid "Encoding..."
 msgstr "Prob?h? k?dov?n?..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:545
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:546
 msgid "<b>Phase:</b>"
 msgstr "<b>F?ze:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:560
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:561
 msgid "<b>Video Codec:</b>"
 msgstr "<b>Video kodek:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:576
 msgid "<b>Audio Codec:</b>"
 msgstr "<b>Audio kodek:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:590
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:591
 msgid "<b>Container:</b>"
 msgstr "<b>Kontejner:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:622
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:623
 msgid "<b>Processed Frames:</b>"
 msgstr "<b>Zpracovan? sn?mky:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:630
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:631
 msgid "<b>Total Frames:</b>"
 msgstr "<b>Celkov? po?et sn?mk?:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:638
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:639
 msgid "<b>Quantiser:</b>"
 msgstr "<b>Kvantiz?r:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:646
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:647
 msgid "<b>Average Bitrate:</b>"
 msgstr "<b>Pr?m?rn? datov? tok:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:654
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:655
 msgid "0 kB/s"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:699
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:700
 msgid "<b>Video Size:</b>"
 msgstr "<b>Velikost videa:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:707
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:708
 msgid "<b>Audio Size:</b>"
 msgstr "<b>Velikost audia:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:715
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:716
 msgid "<b>Total Size:</b>"
 msgstr "<b>Celkov? velikost:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:723
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:731
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:724
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:732
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:740
 msgid "0 MB"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:765
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:244
 msgid "<b>Elapsed:</b>"
 msgstr "<b>Uplynulo:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:772
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:773
 msgid "<b>Time Remaining:</b>"
 msgstr "<b>Zb?vaj?c? ?as:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:780
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:781
 msgid "<b>Frames/sec:</b>"
 msgstr "<b>Sn?mk? za sekundu:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:802
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:803
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:447
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:451
 msgid "00:00:00"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:826
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:827
 msgid "Shut down computer when finished"
 msgstr "Po ukon?en? vypnout po??ta?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:834
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:835
 msgid "Priority:"
 msgstr "Priorita:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:241
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:844
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:240
 msgid "High"
 msgstr "Vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:844
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
 msgid "Above Normal"
 msgstr "Vy???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:243
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:846
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:242
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
 msgid "Normal"
 msgstr "Norm?ln?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:846
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
 msgid "Below Normal"
 msgstr "Ni???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:245
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:848
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:244
 msgid "Low"
 msgstr "N?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:885
 msgid "Pause / Abort"
 msgstr "_Pozastavit / Ukon?it"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:205
-#: avidemux/ADM_filter/filter_declaration.cpp:101
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:209
+#: avidemux/ADM_filter/filter_declaration.cpp:106
 msgid "MPlayer eq2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:235
 msgid "Brigh_tness:"
 msgstr "_Jas:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:243
 msgid "_Saturation:"
 msgstr "_Sytost:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:274
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:278
 msgid "_Contrast:"
 msgstr "_Kontrast:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:300
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:304
 msgid "_Initial:"
 msgstr "_V?choz?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:326
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
 msgid "_Red:"
 msgstr "?_erven?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:343
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:347
 msgid "_Green:"
 msgstr "Ze_len?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:351
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:355
 msgid "_Blue:"
 msgstr "_Modr?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:359
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:363
 msgid "_Weight:"
 msgstr "S?l_a:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:385
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:389
 msgid "<b>Gamma</b>"
 msgstr "<b>Gama</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:128
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:144
-#: avidemux/ADM_filter/filter_declaration.cpp:180
+#: avidemux/ADM_filter/filter_declaration.cpp:194
 msgid "Partial"
 msgstr "??ste?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:137
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:142
 msgid "Start frame for partial :"
 msgstr "Po??te?n? sn?mek:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:144
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:149
 msgid "End frame for partial :"
 msgstr "Koncov? sn?mek:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:167
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:172
 msgid "Configure partialized filter"
 msgstr "Nastaven? ??ste?n?ho filtru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:206
 #: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:163
 msgid "Threshold Configuration"
 msgstr "Nastaven? prahu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:272
-#: avidemux/ADM_filter/filter_declaration.cpp:174
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:407
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:982
+#: avidemux/ADM_filter/filter_declaration.cpp:188
 msgid "Threshold"
 msgstr "Pr?h"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:294
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:429
 msgid "Minimum value to be in-range:"
 msgstr "Minim?ln? hodnota rozsahu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:327
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:462
 msgid "Maximum value to be in-range:"
 msgstr "Maximm?ln? hodnota rozsahu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:358
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:493
 msgid "Output values:   "
 msgstr "V?stupn? hodnoty:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:365
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:500
 msgid "In-range values go black, out-of-range values go white"
 msgstr "Hodnoty v rozsahu ?ern?, hodnoty mimo rozsah b?l?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:366
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:501
 msgid "In-range values go white, out-of-range values go black"
 msgstr "Hodnoty v rozsahu b?l?, hodnoty mimo rozsah ?ern?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:372
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:507
 msgid "Debugging settings (bits):   "
 msgstr "Lad?c? nastaven? (bity):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:404
-msgid "Threshold output"
-msgstr "V?stup prahu"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp:405
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1366
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:601
-msgid "Final output"
-msgstr "Fin?ln? v?stup"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:109
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:114
 msgid "Select Xvid matrix file to load"
 msgstr "Zvolte matici pro Xvid k na?ten?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:126
 msgid "Error Loading"
 msgstr "Chyba na?ten?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:126
 msgid "Error loadind the custom matrix file."
 msgstr "Chyba na?ten? souboru s vlastn? matic?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:144
 msgid "Matrix Loaded"
 msgstr "Matice na?tena"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:144
 msgid "The custom matrix file has been successfully loaded."
 msgstr "Soubor s vlastn? matic? se ?sp??n? na?etl."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:184
 msgid "Size (MBytes):"
 msgstr "Velikost (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:185
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:369
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:374
 msgid "Average bitrate (kb/s):"
 msgstr "Pr?m?rn? datov? tok (kb/s) :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:354
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:359
 msgid "Target bitrate (kb/s):"
 msgstr "C?lov? datov? tok (kb/s)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:362
-msgid "Target size (MBytes):"
-msgstr "Celkov? velikost (MB):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:367
+msgid "Target video size (MB):"
+msgstr "C?lov? velikost videa (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:489
 msgid "Select Custom Matrix File to write"
 msgstr "Zvolte soubor s vlastn? matic? k z?pisu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:494
 msgid "Error Writing"
 msgstr "Chyba z?pisu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:494
 msgid "Error writing the custom matrix file."
 msgstr "Nezda?ilo se zapsat soubor s vlastn? matic?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:700
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:710
 msgid "XviD encoding options"
 msgstr "Nastaven? kodeku Xvid"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:734
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:744
 msgid "Encoding type:"
 msgstr "Typ k?dov?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:749
 msgid "Bitrate (kb/s):"
 msgstr "Datov? tok (kb/s):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:744
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:754
 msgid "Quantizer:"
 msgstr "Kvantiz?r:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:756
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:766
 msgid "Select 1-pass or 2-pass encoding"
 msgstr "Vyberte jedno nebo dvoupr?chodov? k?dov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:760
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:123
-msgid "Single pass - bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:770
+msgid "Single Pass - Bitrate"
 msgstr "Jeden pr?chod - datov? tok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:764
-msgid "Single pass - quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:774
+msgid "Single Pass - Quantizer"
 msgstr "Jeden pr?chod - kvantiz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:768
-msgid "Two pass, final size"
-msgstr "Dva pr?chody, fin?ln? velikost"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:778
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:669
+msgid "Two Pass - Video Size"
+msgstr "Dva pr?chody - velikost videa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:772
-msgid "Two pass, average bitrate"
-msgstr "Dva pr?chody, pr?m?rn? datov? tok"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:782
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:670
+msgid "Two Pass - Average Bitrate"
+msgstr "Dva pr?chody - pr?m?rn? datov? tok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:776
-msgid "Same Qz as input"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:786
+msgid "Same Quantizer as Input"
 msgstr "Stejn? kvantiz?ry jako vstup"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:785
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:795
 msgid "Target video bitrate"
 msgstr "C?lov? datov? tok videa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:792
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:802
 msgid "Constant quantizer - each frame will get the same compression"
 msgstr "Konstantn? kvantiz?r - ka?d? sn?mek se stejnou m?rou komprese"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:794
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:804
 msgid "Variable bitrate mode"
 msgstr "Re?im variabiln?ho datov?ho toku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:806
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:816
 msgid "_Interlaced"
 msgstr "_Prokl?dan?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:809
-msgid ""
-"Enables interlaced frame support - use only if your source contains "
-"interlacing artifacts (i.e. fields instead of progressive frames)"
-msgstr ""
-"Aktivuje prokl?dan? k?dov?n? - pou??vejte pouze pokud zdroj obsahuje "
-"artefakty prokl?d?n? (tj. p?lsn?mky m?sto progresivn?ch sn?mk?)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:819
+msgid "Enables interlaced frame support - use only if your source contains interlacing artifacts (i.e. fields instead of progressive frames)"
+msgstr "Aktivuje prokl?dan? k?dov?n? - pou??vejte pouze pokud zdroj obsahuje artefakty prokl?d?n? (tj. p?lsn?mky m?sto progresivn?ch sn?mk?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:811
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:821
 msgid "_Greyscale"
 msgstr "_Odst?ny ?edi"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:814
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:824
 msgid "Encode in black & white"
 msgstr "K?duje pouze ?ernob?l? obraz"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:820
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:830
 msgid "Ca_rtoon mode"
 msgstr "_Re?im kreslen?ch seri?l?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:823
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:833
 msgid "Enables special motion estimation features for cartoons/anime"
 msgstr "Speci?ln? vlastnosti odhadu pohybu pro animovan? filmy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:825
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:835
 msgid "C_hroma optimizer"
 msgstr "Opti_malizace chrominance"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:828
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:838
 msgid "Enables a chroma optimizer prefilter"
 msgstr "Aktivuje p?edfiltr optimalizace chrominance"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:834
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:844
 msgid "Turbo Mode"
 msgstr "_Turbo re?im"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:837
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:847
 msgid "Enables fast 1st pass encoding"
 msgstr "Rychl? k?dov?n? prvn?ho pr?chodu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:839
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:849
 msgid "Packed bitstream"
 msgstr "Z_abalen? bitstream"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:842
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:852
 msgid "Enables Divx like packed vop, DO NOT SET, it is ugly"
 msgstr "Pou?ije zabalen? VOP jako DivX, NEPOU??VAT, je to o?kliv?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:844
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:854
 msgid "Main"
 msgstr "Hlavn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:863
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:873
 msgid "Motion search precision:"
 msgstr "P?esnost odhadu pohybu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:867
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:877
 msgid "VHQ mode:"
 msgstr "Re?im VHQ:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:880
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:890
 msgid "Higher settings give higher quality results, at the cost of slower encoding"
 msgstr "Vy??? hodnoty znamenaj? vy??? kvalitu za cenu pomalej??ho k?dov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:884
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:357
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:894
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
 msgid "0 - None"
 msgstr "0 - nic"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:888
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:898
 msgid "1 - Very low"
 msgstr "1 - velmi n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:892
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:902
 msgid "2 - Low"
 msgstr "2 - n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:896
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:906
 msgid "3 - Medium"
 msgstr "3 - st?edn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:910
 msgid "4 - High"
 msgstr "4 - vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:904
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:914
 msgid "5 - Very high"
 msgstr "5 - velmi vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:908
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:918
 msgid "6 - Ultra high"
 msgstr "6 - ultra vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:917
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:927
 msgid "VHQ enables an additional search process to increase quality"
 msgstr "VHQ umo?n? dal?? vyhled?vac? proces ke zlep?en? kvality"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:921
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:931
 msgid "0 - Off"
 msgstr "0 - vypnuto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:925
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:935
 msgid "1 - Mode decision"
 msgstr "1 - rozhodov?n? re?imu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:929
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:939
 msgid "2 - Limited search"
 msgstr "2 - omezen? hled?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:933
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:943
 msgid "3 - Medium search"
 msgstr "3 - st?edn? hled?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:937
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:947
 msgid "4 - Wide search"
 msgstr "4 - ?irok? hled?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:947
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:957
 msgid "C_hroma motion"
 msgstr "C_hroma pohyb"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:950
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:960
 msgid "Use chroma information to estimate motion"
 msgstr "Pou?ije informaci z chrominance k odhadu pohybu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:952
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:962
 msgid "_4MV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:955
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:965
 msgid "Use 4 motion vectors per macroblock, might give better compression"
 msgstr "Pou?ije 4 vektory pohybu na makroblok, m??e zlep?it kompresi"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:957
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:967
 msgid "HQ _AC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:960
-msgid ""
-"Enable a better prediction of AC component. Turns on Lumi masking - applies "
-"more compression to dark/light areas that the eye cannot notice easily"
-msgstr ""
-"Lep?? predikce AC komponentu. Zapne maskov?n? luminance - aplikuje v?t?? "
-"m?ru komprese na tmav?/sv?tl? m?sta, kde to oko tak snadno nepozn?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:970
+msgid "Enable a better prediction of AC component. Turns on Lumi masking - applies more compression to dark/light areas that the eye cannot notice easily"
+msgstr "Lep?? predikce AC komponentu. Zapne maskov?n? luminance - aplikuje v?t?? m?ru komprese na tmav?/sv?tl? m?sta, kde to oko tak snadno nepozn?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:966
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:976
 msgid "I-frame interval - Min:"
 msgstr "Interval I sn?mk? - min.:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:974
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:984
 msgid "Minimum space between I-frames, 1 will disable forced I-frame spacing"
-msgstr ""
-"Nejmen?? vzd?lenost mezi kl??ov?mi sn?mky, 1 vypne vynucen? umis?ov?n? I "
-"sn?mk?"
+msgstr "Nejmen?? vzd?lenost mezi kl??ov?mi sn?mky, 1 vypne vynucen? umis?ov?n? I sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:976
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1194
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1199
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:986
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1209
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1214
 msgid "Max:"
 msgstr "max.:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:984
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:994
 msgid "Maximum number of frames allowed between I-frames"
 msgstr "Maxim?ln? povolen? po?et sn?mk? mezi I sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:999
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1009
 msgid "Number of B-frames:"
 msgstr "Po?et B sn?mk?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1007
-msgid ""
-"Maximum number of sequential B-frames (when set to 0, the original I/P "
-"encoder is used)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1017
+msgid "Maximum number of sequential B-frames (when set to 0, the original I/P encoder is used)"
 msgstr "Nejvy??? po?et n?sledn?ch B sn?mk? (0 znamen? ??dn? B sn?mky)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1013
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1023
 msgid "_Qpel"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1016
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1026
 msgid "Use Quarter pixel resolution for a more precise motion estimation"
 msgstr "Pou?ije rozli?en? na ?tvrt pixelu pro p?esn?j?? odhad pohybu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1018
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1028
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:82
 msgid "_GMC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1021
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1031
 msgid "Global Motion Compensation can save bits on camera pans, zooming and rotation"
-msgstr ""
-"Global Motion Compensation (glob?ln? kompenzace pohybu) m??e u?et?it bity na "
-"p?ejezdech kamery, p?ibl??en? a rotaci"
+msgstr "Global Motion Compensation (glob?ln? kompenzace pohybu) m??e u?et?it bity na p?ejezdech kamery, p?ibl??en? a rotaci"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1023
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1033
 msgid "_BVHQ"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1026
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1036
 msgid "Produces nicer-looking B-frames"
 msgstr "Produkuje l?pe vypadaj?c? B sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1028
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1038
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:101
 msgid "Advanced Simple Profile"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1040
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:827
-msgid "As input"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1050
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:880
+msgid "As Input"
 msgstr "Jako vstup"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1043
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1053
 msgid "Get PAR from input video file"
 msgstr "Z?skat PAR ze zdrojov?ho video souboru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1049
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1059
 msgid "Pixel Width"
 msgstr "???ka pixelu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1051
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:796
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1061
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:850
 msgid ":"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1060
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1070
 msgid "Pixel Height"
 msgstr "V??ka pixelu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1061
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1071
 msgid "Pixel Aspect Ratio"
 msgstr "Pom?r stran pixelu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:965
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1076
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1021
 msgid "Motion & Misc"
 msgstr "Odhad pohybu atd."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1079
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1089
 msgid "Quantization type:"
 msgstr "Typ kvantizace:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1083
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1093
 msgid "_H.263"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1086
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1096
 msgid "H.263 quantizers smooth the picture (useful at lower bitrates)"
 msgstr "H.263 kvantiz?ry d?vaj? rozmazan?j?? obraz (dobr? p?i ni???m bitrate)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1090
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1100
 msgid "_MPEG"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1093
-msgid ""
-"MPEG quantizers (slightly slower) produce sharper picture (useful at higher "
-"bitrates)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1103
+msgid "MPEG quantizers (slightly slower) produce sharper picture (useful at higher bitrates)"
 msgstr "H.263 kvantiz?ry d?vaj? ost?ej?? obraz (dobr? p?i vy???m bitrate)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1097
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1107
 msgid "_Custom Matrix"
 msgstr "_Vlastn? matice"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1107
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1117
 msgid "Load Custom Matrix:  "
 msgstr "Na??st vlastn? matici:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1128
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1581
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1138
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1690
 msgid "Open CQM file"
-msgstr "_Otev??t CQM soubor"
+msgstr "Otev??t CQM soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1136
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1568
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1604
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1146
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1578
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1698
 msgid "Edit Custom Matrix"
 msgstr "Upravit vlastn? matici"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1153
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1163
 msgid "I-frame quantizer - Min:"
 msgstr "Kvantiz?r I sn?mk? - min.:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1158
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1168
 msgid "P-frame quantizer - Min:"
 msgstr "Kvantiz?r P sn?mk? - min.:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1163
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1173
 msgid "B-frame quantizer - Min:"
 msgstr "Kvantiz?r B sn?mk? - min.:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1176
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1186
 msgid "Minimum quantizer allowed for I-frames"
 msgstr "Nejni??? povolen? kvantiz?r pro I sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1182
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1192
 msgid "Minimum quantizer allowed for P-frames"
 msgstr "Nejni??? povolen? kvantiz?r pro P sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1188
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1198
 msgid "Minimum quantizer allowed for B-frames"
 msgstr "Nejni??? povolen? kvantiz?r pro B sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1217
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1227
 msgid "Maximum quantizer allowed for I-frames"
 msgstr "Nejvy??? povolen? kvantiz?r pro I sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1223
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1233
 msgid "Maximum quantizer allowed for P-frames"
 msgstr "Nejvy??? povolen? kvantiz?r pro P sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1229
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1239
 msgid "Maximum quantizer allowed for B-frames"
 msgstr "Nejvy??? povolen? kvantiz?r pro B sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1231
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1241
 msgid "Quantizer restrictions"
 msgstr "Omezen? kvantiz?r?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1235
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1245
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:79
 msgid "_Trellis quantization"
 msgstr "_S??ov? (trellis) kvantizace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1248
 msgid "Rate distortion quantization, will find optimal encoding for each block"
 msgstr "Nalezne optim?ln? k?dov?n? pro ka?d? blok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1240
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:309
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1250
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:313
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:112
 msgid "Quantization"
 msgstr "Kvantizace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1268
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1278
 msgid "I-frame boost (%):"
 msgstr "Zlep?en? I sn?mk? (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1273
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1283
 msgid "I-frames closer than ... frames..."
 msgstr "I sn?mky bli??? ne? ... sn?mk?..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1278
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1288
 msgid "...are reduced by (%):"
 msgstr "...jsou redukov?ny o (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1283
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1293
 msgid "Max overflow improvement (%):"
 msgstr "Max. zlep?en? p?ete?en? (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1288
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1298
 msgid "Max overflow degradation (%):"
 msgstr "Max. zhor?en? p?ete?en? (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1300
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1310
 #, c-format
 msgid "A value of 20 will give 20% more bits to every I-frame"
 msgstr "20 p?id?l? o 20 procent v?c bit? ka?d?mu I sn?mku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1306
-msgid ""
-"I-frames appearing in the range below this value will be treated as "
-"consecutive keyframes"
-msgstr ""
-"I sn?mky v rozsahu pod touto hodnotou budou pova?ov?ny za po sob? jdouc? "
-"kl??ov? sn?mky"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1311
-msgid ""
-"Reduction of bitrate for the first consecutive I-frames. The last I-frame "
-"will get treated normally"
-msgstr ""
-"Redukce bitrate pro prvn? po sob? jdouc? I sn?mky. Posledn? I sn?mek bude "
-"br?n norm?ln?"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1316
-msgid ""
-"How much of the overflow the codec can eat into during undersized sections - "
-"larger values will bridge the gap faster"
-msgstr ""
-"Kolik z p?ete?en? si kodek m??e vz?t b?hem podm?re?n?ch ??st? - vy??? "
-"hodnoty p?ekro?? mezeru rychleji"
+msgid "I-frames appearing in the range below this value will be treated as consecutive keyframes"
+msgstr "I sn?mky v rozsahu pod touto hodnotou budou pova?ov?ny za po sob? jdouc? kl??ov? sn?mky"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1321
-msgid ""
-"How much of the overflow the codec can eat into during oversized sections - "
-"larger values will bridge the gap faster"
-msgstr ""
-"Kolik z p?ete?en? si kodek m??e vz?t b?hem p??li? velk?ch ??st? - vy??? "
-"hodnoty p?ekro?? mezeru rychleji"
+msgid "Reduction of bitrate for the first consecutive I-frames. The last I-frame will get treated normally"
+msgstr "Redukce bitrate pro prvn? po sob? jdouc? I sn?mky. Posledn? I sn?mek bude br?n norm?ln?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1326
+msgid "How much of the overflow the codec can eat into during undersized sections - larger values will bridge the gap faster"
+msgstr "Kolik z p?ete?en? si kodek m??e vz?t b?hem podm?re?n?ch ??st? - vy??? hodnoty p?ekro?? mezeru rychleji"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1331
+msgid "How much of the overflow the codec can eat into during oversized sections - larger values will bridge the gap faster"
+msgstr "Kolik z p?ete?en? si kodek m??e vz?t b?hem p??li? velk?ch ??st? - vy??? hodnoty p?ekro?? mezeru rychleji"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1333
 msgid "Two pass tuning"
 msgstr "Vylad?n? 2. pr?chodu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1340
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1350
 msgid "High bitrate scenes (%):"
 msgstr "Sc?ny s vysok?m bitrate (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1345
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1355
 msgid "Low bitrate scenes (%):"
 msgstr "Sc?ny s n?zk?m bitrate (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1350
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1360
 msgid "Overflow control strength (%):"
 msgstr "S?la kontroly p?ete?en? (%):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1362
-msgid ""
-"The higher this value, the more bits get taken from frames larger than the "
-"average size, and redistributed to others"
-msgstr ""
-"??m vy??? je tato hodnota, t?m v?c bit? se vezme ze sn?mk? v?t??ch ne? "
-"pr?m?rn? velikost a rozd?l? se mezi ostatn?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
+msgid "The higher this value, the more bits get taken from frames larger than the average size, and redistributed to others"
+msgstr "??m vy??? je tato hodnota, t?m v?c bit? se vezme ze sn?mk? v?t??ch ne? pr?m?rn? velikost a rozd?l? se mezi ostatn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1367
-msgid ""
-"The higher this value, the more bits get assigned to frames below the "
-"average frame size"
-msgstr ""
-"??m vy??? je tato hodnota, t?m v?c bit? se p?id?l? sn?mk?m pod pr?m?rnou "
-"velikost? sn?mku"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1377
+msgid "The higher this value, the more bits get assigned to frames below the average frame size"
+msgstr "??m vy??? je tato hodnota, t?m v?c bit? se p?id?l? sn?mk?m pod pr?m?rnou velikost? sn?mku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
-msgid ""
-"0 = default from core (let XviD decide), else overflow payback percent per "
-"frame"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1382
+msgid "0 = default from core (let XviD decide), else overflow payback percent per frame"
 msgstr "0 = v?choz? z j?dra (nechat Xvid rozhodnout)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1374
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1384
 msgid "Curve compression"
 msgstr "Komprese k?ivky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1378
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1388
 msgid "Second Pass"
 msgstr "Druh? pr?chod"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1591
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1601
 msgid "<b>Intra Matrix</b>"
 msgstr "<b>Intra matice</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1609
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1619
 msgid "<b>Inter Matrix</b>"
 msgstr "<b>Inter matice</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:560
-msgid "X264 configuration"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:116
+msgid "Hadamard Exhaustive Search"
+msgstr "Hadamardovo d?kladn? vyhled?v?n?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:602
+msgid "x264 Configuration"
 msgstr "Nastaven? x264"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:575
-msgid "Encoding Mode:"
-msgstr "Re?im k?dov?n?:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:623
+msgid "Encoding Mode"
+msgstr "Re?im k?dov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:587
-msgid "Entry input for target file size or bitrate"
-msgstr "C?lov? velikost nebo datov? tok"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:630
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:484
+msgid "Quantizer"
+msgstr "Kvantiz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:589
-msgid "Quantizer (0-51):"
-msgstr "Kvantiz?r (0-51):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:637
+msgid "Target Size"
+msgstr "C?lov? velikost"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:602
-msgid ""
-"Constant Quantizer - Each frame will the same compression. Low numbers equal "
-"higher quality while high numbers equal lower quality"
-msgstr ""
-"Konstantn? kvantiz?r - ka?d? sn?mek se stejnou m?rou komprese. N?zk? ??sla "
-"znamenaj? vy??? kvalitu a naopak"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:650
+msgid "Constant Quantizer - Each frame will have the same compression. Low numbers equal higher quality while high numbers equal lower quality."
+msgstr "Konstantn? kvantiz?r - ka?d? sn?mek se stejnou m?rou komprese. N?zk? ??sla znamenaj? vy??? kvalitu a naopak."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:612
-msgid "Target Size:"
-msgstr "C?lov? velikost:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:658
+msgid "Target bitrate or file size"
+msgstr "C?lov? datov? tok nebo velikost souboru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:666
 msgid "Single Pass - Quality Quantizer (Average)"
 msgstr "Jeden pr?chod - kvantiz?r kvality (pr?m?rn?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:625
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:667
 msgid "Single Pass - Quality Quantizer (Constant)"
 msgstr "Jeden pr?chod - kvantiz?r kvality (konstantn?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:626
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:668
 msgid "Single Pass - Bitrate (Average)"
 msgstr "Jeden pr?chod - datov? tok (pr?m?rn?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:627
-msgid "Two Pass - File Size"
-msgstr "Dva pr?chody - velikost souboru"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:628
-msgid "Two Pass - Average bitrate"
-msgstr "Dva pr?chody - pr?m?rn? datov? tok"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:630
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:672
 msgid "Bitrate"
 msgstr "Datov? tok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:656
-msgid "Partition decision"
-msgstr "Rozhodov?n? rozd?len?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
+msgid "Partition Decision"
+msgstr "Rozhodov?n? ??st?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:663
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:712
 msgid "Method"
 msgstr "Metoda"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:724
 msgid "1  - Extremely Low (Fastest)"
 msgstr "1 - extr?mn? n?zk? (nejrychlej??)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:725
 msgid "2  - Very Low"
 msgstr "2 - velmi n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:726
 msgid "3  - Low"
 msgstr "3 - n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:727
 msgid "4  - Medium"
 msgstr "4 - st?edn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:728
 msgid "5  - High (Default)"
 msgstr "5 - vysok? (v?choz?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:680
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:729
 msgid "6  - Very High"
 msgstr "6 - velmi vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:681
-msgid "6B - Very High (RDO on Bframes)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:730
+msgid "6B - Very High (RDO on B-frames)"
 msgstr "6B - velmi vysok? (RDO na B sn?mc?ch)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:682
-msgid "7 - Ultra High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
+msgid "7  - Ultra High"
 msgstr "7 - ultra vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:683
-msgid "7B - Ultra High (RDO on Bframes)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:732
+msgid "7B - Ultra High (RDO on B-frames)"
 msgstr "7B - ultra vysok? (RDO na B sn?mc?ch)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
-msgid "Diamond search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:739
+msgid "Diamond Search"
 msgstr "Vyhled?v?n? ?ty??heln?ku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:691
-msgid "Hexagonal search"
-msgstr "Hexagon?ln?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:740
+msgid "Hexagonal Search"
+msgstr "Hexagon?ln? vyhled?v?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:692
-msgid "Uneven multi hexagon"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:741
+msgid "Uneven Multi-hexagon"
 msgstr "Nerovnom?rn? multihexagon?ln?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:693
-msgid "Exhaustive search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:742
+msgid "Exhaustive Search"
 msgstr "D?kladn? vyhled?v?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
-msgid ""
-"Set how many previous frames can be referenced by a P/B-frame. Numbers above "
-"5 do not seem to improve quality greatly. Numbers are 3 to 5 are recommended"
-msgstr ""
-"Kolik p?edchoz?ch sn?mk? m??e b?t odkazov?no z P/B sn?mk?. Hodnoty nad 5 u? "
-"moc kvalitu nezvy?uj?. Doporu?eno je 3 a? 5."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:708
-msgid "Max. Ref. frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
+msgid "Max. Ref. Frames"
 msgstr "Max. referen?n?ch sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:715
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:757
 msgid "Range"
 msgstr "Rozsah"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:728
-msgid ""
-"Define how many pixels are analysised. The higher the range the more "
-"accurate the analysis but the slower the encoding time"
-msgstr ""
-"Ur?uje kolik pixel? je analyzov?no. ??m vy??? rozsah, t?m p?esn?j?? anal?za, "
-"ale pomalej?? k?dov?n?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:770
+msgid "Define how many pixels are analysed for motion estimation. The higher the range the more accurate the analysis but the slower the encoding time."
+msgstr "Ur?uje kolik pixel? je analyzov?no pro odhad pohybu. ??m vy??? rozsah, t?m p?esn?j?? anal?za, ale pomalej?? k?dov?n?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:779
+msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers 3 to 5 are recommended."
+msgstr "Kolik p?edchoz?ch sn?mk? m??e b?t odkazov?no z P/B sn?mk?. Hodnoty nad 5 u? moc kvalitu nezvy?uj?. Doporu?eno je 3 a? 5."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:782
 msgid "Chroma ME"
 msgstr "Chrominance pro odhad pohybu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:736
-msgid ""
-"Uses chroma (color) components for motion for compression and helps the "
-"quality"
-msgstr "Pou?ije chrominanci (barevnou slo?ku) pro pohyb, zlep?uje kvalitu"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:787
+msgid "Use color information for detecting motion to improve quality"
+msgstr "Pou?ije informaci z chrominance k odhadu pohybu pro zlep?en? kvality"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:790
 msgid "Mixed Refs"
 msgstr "Sm??en? reference"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:795
 msgid "Calculate referencing individually based on each partition"
 msgstr "Po??t? reference jednotliv? v z?vislosti na ka?d?m rozd?len?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:801
 msgid "Fast P-Skip"
-msgstr ""
+msgstr "Rychl? p?esko?en? u P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:753
-msgid "Uncheck to enable fast p-skip"
-msgstr ""
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
+msgid "Early skip detection on P-frames to speedup encoding. Quality will be slightly reduced."
+msgstr "Detekce ?asn?ho p?esko?en? na P sn?mc?ch ke zrychlen? k?dov?n?. Kvalita se lehce sn???."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:756
-msgid "DCT decimate"
-msgstr ""
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:807
+msgid "DCT Decimate"
+msgstr "DCT decimace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:760
-msgid "Interlace"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:812
+msgid "Interlaced"
 msgstr "Prokl?dan?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:763
-msgid "Encode interlaced"
-msgstr "K?dovat prokl?dan?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:815
+msgid "Input video is interlaced"
+msgstr "Vstupn? video je prokl?dan?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:765
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:817
 msgid "<b>Motion Estimation</b>"
 msgstr "<b>Odhad pohybu</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:792
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
-msgid ""
-"Enforce the size of a decoded pixel decoded to a certain value. Leave this "
-"at 1:1 for non-anamorphic video"
-msgstr ""
-"Nastav? velikost dek?dovan?ho pixelu na ur?itou hodnotu. Pro neanamorfn? "
-"video nechte na 1:1."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:846
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:857
+msgid "Enforce the size of a decoded pixel decoded to a certain value. Set this to 1:1 for non-anamorphic video."
+msgstr "Nastav? velikost dek?dovan?ho pixelu na ur?itou hodnotu. Pro neanamorfn? video nechte na 1:1."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:793
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:805
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:847
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:858
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:83
 msgid "1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:808
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:861
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:563
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp:87
 msgid "Custom"
 msgstr "Vlastn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:813
-msgid "Set a custom aspect ratio. Default 1:1 is recommended for most video."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:866
+msgid "Set a custom aspect ratio. The default 1:1 is recommended for most video."
 msgstr "Nastav? vlastn? pom?r stran pixelu. V?choz? 1:1 je doporu?en? pro v?t?inu vide?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:818
-msgid "Predefined Aspect Ratios"
-msgstr "P?ednastaven? pom?ry stran"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:871
+msgid "Predefined Aspect Ratio"
+msgstr "P?ednastaven? pom?r stran"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:823
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:876
 msgid "Set a common predefined aspect ratio"
 msgstr "Nastav? b??n? p?eddefinovan? pom?r stran"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:856
-msgid "<b>Sample Aspect Ratio (A/R)</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:901
+msgid "<b>Sample Aspect Ratio</b>"
 msgstr "<b>Pom?r stran pixelu</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:878
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:928
 msgid "CABAC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:881
-msgid ""
-"Lossless compression method which usually improves the bitrate usage by 15% "
-"(especially on high bitrate). Helps the quality a lot but is slower. "
-msgstr ""
-"Bezeztr?tov? kompresn? metoda,kter? obvykle zlep?? datov? tok o 15 % "
-"(zejm?na u vysok?ho datov?ho toku). V?razn? zlep?? kvalitu, ale je pomalej??."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:931
+msgid "Lossless compression technique that reduces bitrate by approximately 10%. Increases encoding and decoding time."
+msgstr "Bezeztr?tov? kompresn? technika, kter? sn??? datov? tok zhruba o 10 %. Zv??? ?as k?dov?n? i dek?dov?n?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:938
 msgid "Trellis"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:893
-msgid ""
-"Use rate distortion quantization to find optimal encoding for each block. "
-"Level 0 equals disabled, level 1 equals normal and level 2 equals high"
-msgstr ""
-"Pou??t rate distortion kvantizaci k nalezen? optim?ln?ho zak?dov?n? ka?d?ho "
-"bloku. 0 znamen? vypnuto, 1 znamen? norm?ln? ?rove? a 2 vysokou."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:947
+msgid "Use Trellis Rate Distortion Optimisation to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high."
+msgstr "Pou??t s??ovou rate distortion kvantizaci k nalezen? optim?ln?ho zak?dov?n? ka?d?ho bloku. 0 znamen? vypnuto, 1 znamen? norm?ln? ?rove? a 2 vysokou."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:954
 msgid "Noise Reduction"
 msgstr "Redukce ?umu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:909
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:963
 msgid "Set the amount of noise reduction"
 msgstr "Nastaven? m?ry redukce ?umu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:916
-msgid "Deblocking Filter :"
-msgstr "Filtr pro deblocking:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:970
+msgid "Deblocking Filter"
+msgstr "Filtr pro deblocking"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:919
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:973
 msgid "Enable in-loop deblocking to filter the video"
 msgstr "Aktivuje in-loop deblocking na filtraci videa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:932
-msgid "Set the amount of blurring to use for block edges when they are found"
-msgstr "M?ra rozmaz?n? okraj? blok? kdy? jsou nalezeny"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:990
+msgid "Strength"
+msgstr "S?la"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:941
-msgid "Define the level for when deblocking is applied"
-msgstr "?rove? kdy je aplikov?n deblocking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1004
+msgid "Threshold for block detection. Positive values will detect more blocks, negative values will detect less."
+msgstr "Pr?h detekce bloku. Kladn? hodnoty detekuj? v?ce blok?, z?porn? jich detekuj? m?n?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:944
-msgid "<i>Threshold</i>"
-msgstr "<i>Pr?h</i>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1013
+msgid "Positive values will soften the video, negative values will sharpen"
+msgstr "Kladn? hodnoty zjemn? obraz, z?porn? jej zost??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:952
-msgid "<i>Strength</i>"
-msgstr "<i>S?la</i>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:960
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1016
 msgid "<b>Misc. Options</b>"
 msgstr "<b>R?zn?</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:986
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1047
 msgid "8x8 Transform"
 msgstr "8x8 transformace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:989
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1050
 msgid "General block breakdown transformation"
 msgstr "Obecn? transformace rozd?len? blok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:992
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1053
 msgid "8x8, 8x16 and 16x8 P-frame search"
 msgstr "8x8, 8x16 a 16x8 vyhled?v?n? P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:995
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
 msgid "Improve the P-frame quality"
 msgstr "Zlep?? kvalitu P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:998
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1059
 msgid "8x8, 8x16 and 16x8 B-frame search"
 msgstr "8x8, 8x16 a 16x8 vyhled?v?n? B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1001
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1062
 msgid "Improve the B-frame quality"
 msgstr "Zlep?? kvalitu B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1004
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
 msgid "4x4, 4x8 and 8x4 P-frame search"
 msgstr "4x4, 4x8 a 8x4 vyhled?v?n? P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1007
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1068
 msgid "Further improve the P-frame quality"
 msgstr "Dal?? zlep?en? kvality P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1009
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1070
 msgid "8x8 Intra search"
 msgstr "8x8 vnit?n? hled?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1012
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1073
 msgid "Enable DCT Intra block search to improve quality"
 msgstr "Aktivuje vyhled?v?n? DCT blok? ke zlep?en? kvality"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1015
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1076
 msgid "4x4 Intra search"
 msgstr "4x4 vnit?n? vyhled?v?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1018
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1079
 msgid "Further enable DCT Intra block search to improve quality"
 msgstr "Dal?? vyhled?v?n? DCT blok? ke zlep?en? kvality"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1021
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1082
 msgid "<b>Partition Macroblocks</b>"
-msgstr "<b>Makrobloky rozd?len?</b>"
+msgstr "<b>Makrobloky ??st?</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1043
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1106
 msgid "Bias"
 msgstr "M?ra B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
-msgid ""
-"Increase / decrease probability for how often B-frames are used. Will not "
-"violate the maximum consecutive frame limit"
-msgstr ""
-"Zv??it/sn??it pravd?podobnost jak ?asto jsou pou?ity B sn?mky. Neporu?? "
-"limit maxima n?sledn?ch sn?mk?."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
-msgid ""
-"Set the maximum number of consecutive B-frames. This defines how many "
-"duplicate frames can be droped. Numbers 2 to 5 are recommended. This greatly "
-"improves the use of bitrate and quality"
-msgstr ""
-"Maxim?ln? po?et po sob? jdouc?ch B sn?mk?. To ur?uje kolik duplikovan?ch "
-"sn?mk? lze zahodit. Doporu?eno 2 a? 5. Toto velmi zlep?uje vyu?it? datov?ho "
-"toku a kvalitu."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1068
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
 msgid "Max Consecutive"
 msgstr "Max. n?sledn?ch B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1079
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1126
+msgid "Increase / decrease probability for how often B-frames are used. It will not violate the maximum consecutive frame limit."
+msgstr "Zv??it/sn??it pravd?podobnost jak ?asto jsou pou?ity B sn?mky. Neporu?? limit maxima n?sledn?ch sn?mk?."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1135
+msgid "Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be dropped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality."
+msgstr "Maxim?ln? po?et po sob? jdouc?ch B sn?mk?. To ur?uje kolik duplikovan?ch sn?mk? lze zahodit. Doporu?eno 2 a? 5. Toto velmi zlep?uje vyu?it? datov?ho toku a kvalitu."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1149
 msgid "Bidirectional ME"
 msgstr "Obousm?rn? odhad pohybu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
-msgid ""
-"Jointly optimize both Motion Vector's in B-frames. This will improve quality "
-"but take more time for encoding"
-msgstr ""
-"Spole?n? optimalizuje vektory pohybu v B sn?mc?ch. Zlep?? kvalitu, ale "
-"zpomal? k?dov?n?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1154
+msgid "Optimise both motion vectors in B-frames. This will improve quality but take more time for encoding."
+msgstr "Optimalizuje oba vektory pohybu v B sn?mc?ch. Zlep?? kvalitu, ale zpomal? k?dov?n?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1086
-msgid "Weighted biprediction"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1156
+msgid "Weighted Biprediction"
 msgstr "Vyv??en? obousm?rn? predikce"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1091
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1161
 msgid "Enables weighting of B-frames to help fades"
 msgstr "Aktivuje v??en? B sn?mk? k zlep?en? ztmavov?n? a zesv?tlov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1094
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1164
 msgid "Adaptative DCT"
 msgstr "Adaptivn? DCT"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1099
-msgid ""
-"Use fewer B-frame if needed. This is always recommended. If not enabled, the "
-"codec will always use the maximum number of consecutive B-frames"
-msgstr ""
-"Pou?ije m?n? B sn?mk? kdy? je t?eba. Toto je v?dy doporu?eno. Pokud nen? "
-"aktivov?no, kodek v?dy pou?ije maxim?ln? po?et po sob? jdouc?ch B sn?mk?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
+msgid "Use fewer B-frames if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames."
+msgstr "Pou?ije m?n? B sn?mk? kdy? je t?eba. Toto je v?dy doporu?eno. Pokud nen? aktivov?no, kodek v?dy pou?ije maxim?ln? po?et po sob? jdouc?ch B sn?mk?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1102
-msgid "Use as reference"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1172
+msgid "Use as Reference"
 msgstr "Pou??t jako referenci"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1107
-msgid ""
-"Allow B-frames to make references non-linearly to another B-frame (instead "
-"of creating a duplicate copy)"
-msgstr ""
-"Povol?, aby B sn?mky odkazovaly neline?rn? na dal?? B sn?mky (m?sto "
-"vytvo?en? kopie)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1177
+msgid "Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"
+msgstr "Povol?, aby B sn?mky odkazovaly neline?rn? na dal?? B sn?mky (m?sto vytvo?en? kopie)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
-msgid "B-Frame Direct Mode:  "
-msgstr "P??m? re?im B sn?mk?:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1183
+msgid "B-Frame Direct Mode"
+msgstr "P??m? re?im B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1121
-msgid "Auto"
-msgstr ""
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1192
+msgid "Spatial"
+msgstr "Prostorov?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1122
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1193
 msgid "Temporal"
 msgstr "?asov?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1123
-msgid "Spatial"
-msgstr "Prostorov?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1194
+msgid "Auto"
+msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1126
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1196
 msgid "<b>B-Frames</b>"
 msgstr "<b>B sn?mky</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1131
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1201
 msgid "Partitions & Frames"
 msgstr "Rozd?len? a sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1159
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1236
 msgid "Set how much \"bitrate bonus\" a keyframe can get"
 msgstr "Jak velk? \"bonus\" datov?ho toku m??e dostat kl??ov? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1162
-msgid "Keyframe boost (%)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1245
+msgid "Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"
+msgstr "Kolik datov?ho toku je ode?teno z B sn?mku v porovn?n? s p?edchoz?m P sn?mkem"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1254
+msgid "Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream."
+msgstr "Jak moc m??e datov? tok kol?sat p?es cel? video. Nastaven? s 0 % vytvo?? video s konstantn?m datov?m tokem, zat?mco 100 % znamen? video zalo?en? ?ist? na kvalit?."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1257
+msgid "Keyframe Boost (%)"
 msgstr "Podpo?en? kl??ov?ch sn?mk? (%)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
-msgid "B-frame reduction (%)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1264
+msgid "B-frame Reduction (%)"
 msgstr "Redukce B sn?mk? (%)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1176
-msgid "Bitrate variability (%)"
-msgstr "Variabilita datov?ho toku"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1271
+msgid "Bitrate Variability (%)"
+msgstr "Variabilita datov?ho toku (%)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1189
-msgid ""
-"Set how much bitrate is deducted from a B-frame as compared to the previous "
-"P-frame"
-msgstr "Kolik datov?ho toku je ode?teno z B sn?mku v porovn?n? s p?edchoz?m P sn?mkem"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1198
-msgid ""
-"Define how much the bitrate can fluctuate over the entire video. 0% results "
-"in a constant bitrate stream, while 100% results in a pure quality based "
-"bitrate stream"
-msgstr ""
-"Jak moc m??e datov? tok kol?sat p?es cel? video. Nastaven? s 0 % vytvo?? "
-"video s konstantn?m datov?m tokem, zat?mco 100 % znamen? video zalo?en? "
-"?ist? na kvalit?."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1201
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1278
 msgid "<b>Bitrate</b>"
 msgstr "<b>Datov? tok</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1219
-msgid "Min Qp"
-msgstr "Min. kvantiz?r"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1298
+msgid "Min QP"
+msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1226
-msgid "Max Qp"
-msgstr "Max. kvantiz?r"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1305
+msgid "Max QP"
+msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1233
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1312
 msgid "Max QP Step"
 msgstr "Max. kvantiza?n? krok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1247
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1326
 msgid "Enforce a minimum quantizer level"
 msgstr "Nastav? minim?ln? ?rove? kvantizace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1256
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1335
 msgid "Enforce a maximum quantizer level"
 msgstr "Nastav? maxim?ln? ?rove? kvantizace"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1344
 msgid "Define how much the quantizer rate can change between two consecutive frames"
 msgstr "Jak moc se m??e kvantizace m?nit mezi po sob? jdouc?mi sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1268
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1347
 msgid "<b>Quantization Limits</b>"
 msgstr "<b>Kvantiza?n? limity</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1286
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1374
+msgid "Increase / decrease sensitivity for detecting scene changes. Improves I-frame usage and quality."
+msgstr "Zv???/sn??? citlivost detekce zm?ny sc?ny. Zlep?uje vyu?it? I sn?mk? a kvalitu."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1377
 msgid "Scene Cut Threshold"
 msgstr "Pr?h st?ihu sc?ny"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1300
-msgid ""
-"Increase / decrease sensitivity for detecting Scene Changes to compensate "
-"for. Improves I-frame usage and helps quality"
-msgstr ""
-"Zv???/sn??? citlivost detekce zm?ny sc?ny pro kompenzaci. Zlep?uje vyu?it? I "
-"sn?mk? a kvalitu."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1303
-msgid "Min IDR frame interval"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1384
+msgid "Min IDR Frame Interval"
 msgstr "Min. interval IDR sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1316
-msgid ""
-"Set minimum frame interval between IDR frames. Defines the minimum amount a "
-"frame can be reused and referenced by other frames before a new clean one is "
-"established"
-msgstr ""
-"Minim?ln? interval mezi IDR sn?mky. Nastav? minim?ln? m?ru kdy m??e b?t "
-"sn?mek znovupou?it a odkazov?n z jin?ch sn?mk? p?edt?m, ne? je vytvo?en nov? "
-"?ist?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1397
+msgid "Set minimum frame interval between IDR frames. Defines the minimum amount a frame can be reused and referenced by other frames before a new IDR frame is established."
+msgstr "Minim?ln? interval mezi IDR sn?mky. Nastav? minim?ln? m?ru kdy m??e b?t sn?mek znovupou?it a odkazov?n z jin?ch sn?mk? p?edt?m, ne? je vytvo?en nov? IDR sn?mek."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1325
-msgid ""
-"Set maximum frame interval between IDR frames. Defines the maximum amount a "
-"frame can be reused and referenced by other frames before a new clean one is "
-"established"
-msgstr ""
-"Maxim?ln? interval mezi IDR sn?mky. Nastav? maxim?ln? m?ru kdy m??e b?t "
-"sn?mek znovupou?it a odkazov?n z jin?ch sn?mk? p?edt?m, ne? je vytvo?en nov? "
-"?ist?."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1406
+msgid "Set maximum frame interval between IDR frames. Defines the maximum amount a frame can be reused and referenced by other frames before a new IDR frame is established."
+msgstr "Maxim?ln? interval mezi IDR sn?mky. Nastav? maxim?ln? m?ru kdy m??e b?t sn?mek znovupou?it a odkazov?n z jin?ch sn?mk? p?edt?m, ne? je vytvo?en nov? IDR sn?mek."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1328
-msgid "Max IDR frame interval"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1409
+msgid "Max IDR Frame Interval"
 msgstr "Max. interval IDR sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1335
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1416
 msgid "<b>More Rate Settings</b>"
 msgstr "<b>Dal?? nastaven? datov?ho toku</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1353
-msgid "VBV buffer size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1436
+msgid "VBV Buffer Size"
 msgstr "Velikost VBV bufferu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1360
-msgid "Initial VBV buffer (%)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1443
+msgid "Initial VBV Buffer (%)"
 msgstr "Po??te?n? VBV buffer (%)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1367
-msgid "Maximum local bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1450
+msgid "Maximum Local Bitrate"
 msgstr "Maxim?ln? lok?ln? datov? tok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1398
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1481
 msgid "<b>Video Buffer Verifier</b>"
 msgstr "<b>Kontrola video bufferu</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1403
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1486
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:117
 msgid "Rate Control"
 msgstr "??zen? datov?ho toku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1430
-msgid ""
-"Allowed variance of average bitrate. Lower values mean less variance. Higher "
-"values mean more variance."
-msgstr "Povolen? variabilita pr?m?rn?ho datov?ho toku. Ni??? hodnoty znamenaj? men?? odchylky. Vy??? hodnoty znamenaj? v?t?? odchylky."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1433
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1514
 msgid "Bitrate Variance"
 msgstr "Odchylky datov?ho toku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1446
-msgid ""
-"Allowed variance of average quantizer or quality. Lower values mean less "
-"variance. Higher values mean more variance. Note that 0 means constant "
-"quality while 1 means constant fluctuation. Recommended 0.6."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1527
+msgid "Allowed variance of average bitrate. Lower values mean less variance. Higher values mean more variance."
+msgstr "Povolen? variabilita pr?m?rn?ho datov?ho toku. Ni??? hodnoty znamenaj? men?? odchylky. Vy??? hodnoty znamenaj? v?t?? odchylky."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1536
+msgid "Allowed variance of average quantizer or quality. Lower values mean less variance. Higher values mean more variance. Note that 0 means constant quality while 1 means constant fluctuation. Recommended 0.6."
 msgstr "Povolen? variabilita pr?m?rn?ho kvantiz?ru nebo kvality. Ni??? hodnoty znamenaj? men?? odchylky. Vy??? hodnoty znamenaj? v?t?? odchylky. 0 znamen? konstantn? kvalitu, 1 znamen? konstantn? v?kyvy. Doporu?eno 0,6."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1455
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1545
 msgid "Reduced fluctuations in Quantizer (before curve compression)"
 msgstr "Sn??en? v?kyvy kvantiz?r? (p?ed kompres? k?ivky)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1464
-msgid "Reduce fluctuations in QP (after curve compression)"
-msgstr "Sn??en? v?kyvy kvantiz?r? (po kompresi k?ivky)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1467
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1556
 msgid "Quantizer Compression"
 msgstr "Komprese kvantiz?r?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1474
-msgid "Temp. Blur of est Frame Complexity"
-msgstr "Vyhlazen? komplexnosti sn?mk?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1563
+msgid "Temp. Blur of Est. Frame Complexity"
+msgstr "?asov? vyhlazen? komplexnosti sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1481
-msgid "Temp. Blur of Quant after CC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1570
+msgid "Temp. Blur of Quant. after CC"
 msgstr "Vyhlazen? kvantiz?r? po kompresi k?ivky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1488
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1577
 msgid "<b>Misc</b>"
 msgstr "<b>R?zn?</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1512
-msgid "Quantization factors used between I- and P- frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1603
+msgid "Quantization factors used between I and P-frames"
 msgstr "Kvantiza?n? faktory pou?it? mezi I a P sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1521
-msgid "Quantization used between P- and B- frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1612
+msgid "Quantization used between P and B-frames"
 msgstr "Kvantizace pou?it? mezi P a B sn?mky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1530
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1621
 msgid "Quantization difference between chroma (color) and luma (brightness)"
 msgstr "Rozd?l kvantizace mezi chrominanc? (barvy) a luminanc? (jas)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1533
-msgid "Factor between I and P frame Quants"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1624
+msgid "Factor between I and P-frame Quants"
 msgstr "Faktor mezi kvantiz?ry I a P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1540
-msgid "Factor between P and B frame Quants"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1631
+msgid "Factor between P and B-frame Quants"
 msgstr "Faktor mezi kvantiz?ry P a B sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1547
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1638
 msgid "Chroma QP Offset"
 msgstr "Kvantiza?n? rozd?l chrominance"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1554
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1645
 msgid "<b>Quantizers</b>"
 msgstr "<b>Kvantiz?ry</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1572
-msgid "Custom matrix"
-msgstr "Vlastn? matice"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1663
+msgid "Flat Matrix"
+msgstr "Ploch? matice"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1587
-msgid "JVT matrix"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1670
+msgid "JVT Matrix"
 msgstr "JVT matice"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1595
-msgid "Flat matrix"
-msgstr "Ploch? matice"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1680
+msgid "Custom Matrix"
+msgstr "Vlastn? matice"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1609
-msgid "Edit a loaded custom quantization matrix file"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1701
+msgid "Edit loaded custom quantization matrix file"
 msgstr "Upravit na?tenou vlastn? matici ze souboru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1617
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1703
 msgid "<b>Quantization Matrices</b>"
 msgstr "<b>Kvantiza?n? matice</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1622
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1708
 msgid "More"
 msgstr "Dal??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1630
-msgid "Defaults"
-msgstr "V?choz?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1716
+msgid "_Defaults"
+msgstr "_V?choz?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:141
 msgid "Chroma Noise Reduction 2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:166
 msgid "<b>Scene change Treshold</b>"
 msgstr "<b>Pr?h zm?ny sc?ny</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:185
 msgid "Sensibility"
 msgstr "Citlivost"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:193
 msgid "Max"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:208
 msgid "Luma :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:215
 msgid "Chroma U :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:222
 msgid "Chroma V :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:261
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:265
 msgid "Narrow"
 msgstr "?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:286
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:290
 msgid "<b>Settings</b>"
 msgstr "<b>Nastaven?</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:305
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:309
 msgid "Use also chroma to detect scene change"
 msgstr "Pou??t i chrominanci k detekci zm?ny sc?ny"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:309
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:313
 msgid "<b>Mode</b>"
 msgstr "<b>Re?im</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:379
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:385
 msgid "Mplayer Delogo"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:397
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:403
 msgid "X"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:410
 msgid "Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:411
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:417
 msgid "W"
 msgstr "?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:418
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:424
 msgid "H"
 msgstr "V"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:431
 msgid "Band"
 msgstr "Tlou??ka rozmazan?ho okraje"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:67
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:71
-msgid "ASHARP"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:72
+msgid "Chroma Shift"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:189
 msgid "ChromaShift"
 msgstr "Posun chrominance"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:203
 msgid "U Shift :"
 msgstr "Posun U:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:205
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:210
 msgid "V Shift :"
 msgstr "Posun V:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:247
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:252
 msgid "<b>Preview</b>"
 msgstr "<b>N?hled</b>"
 
@@ -2090,20 +2119,15 @@
 msgid "/dev/null"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:66
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:273
-msgid "Avidemux"
-msgstr ""
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:46
+msgid "and all the others."
+msgstr "a v?ichni ostatn?."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:67
-msgid "? 2001-2007 Mean"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:68
-msgid "Multiplatform video editor"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
+msgid "Multi-platform Video Editor"
 msgstr "Multiplatformn? video editor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:70
 msgid ""
 "Avidemux is free software; you can redistribute it and/or modify it\n"
 "under the terms of the GNU General Public License version 2\n"
@@ -2113,8 +2137,7 @@
 "\t\t       Version 2, June 1991\n"
 "\n"
 " Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
-"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
-"USA\n"
+"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
 " Everyone is permitted to copy and distribute verbatim copies\n"
 " of this license document, but changing it is not allowed.\n"
 "\n"
@@ -2249,8 +2272,7 @@
 "\n"
 "    a) Accompany it with the complete corresponding machine-readable\n"
 "    source code, which must be distributed under the terms of Sections\n"
-"    1 and 2 above on a medium customarily used for software interchange; "
-"or,\n"
+"    1 and 2 above on a medium customarily used for software interchange; or,\n"
 "\n"
 "    b) Accompany it with a written offer, valid for at least three\n"
 "    years, to give any third party, for a charge no more than your\n"
@@ -2357,8 +2379,7 @@
 "later version\", you have the option of following the terms and conditions\n"
 "either of that version or of any later version published by the Free\n"
 "Software Foundation.  If the Program does not specify a version number of\n"
-"this License, you may choose any version ever published by the Free "
-"Software\n"
+"this License, you may choose any version ever published by the Free Software\n"
 "Foundation.\n"
 "\n"
 "  10. If you wish to incorporate parts of the Program into other free\n"
@@ -2374,8 +2395,7 @@
 "  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\n"
 "FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
 "OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
-"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER "
-"EXPRESSED\n"
+"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\n"
 "OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
 "MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\n"
 "TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
@@ -2420,8 +2440,7 @@
 "\n"
 "    You should have received a copy of the GNU General Public License\n"
 "    along with this program; if not, write to the Free Software\n"
-"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
-"USA\n"
+"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
 "\n"
 "\n"
 "Also add information on how to contact you by electronic and paper mail.\n"
@@ -2430,8 +2449,7 @@
 "when it starts in an interactive mode:\n"
 "\n"
 "    Gnomovision version 69, Copyright (C) year name of author\n"
-"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show "
-"w'.\n"
+"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n"
 "    This is free software, and you are welcome to redistribute it\n"
 "    under certain conditions; type `show c' for details.\n"
 "\n"
@@ -2456,108 +2474,112 @@
 "library.  If this is what you want to do, use the GNU Library General\n"
 "Public License instead of this License."
 msgstr ""
+"Tento program je svobodn? software; m??ete jej ???it a modifikovat \n"
+"podle ustanoven? GNU General Public License verze 2, vyd?van? \n"
+"Free Software Foundation.\n"
+"\n"
+"Tento program je roz?i?ov?n v nad?ji, ?e bude u?ite?n?, av?ak \n"
+"BEZ JAK?KOLIV Z?RUKY; neposkytuj? se ani odvozen? z?ruky \n"
+"PRODEJNOSTI anebo VHODNOSTI PRO UR?IT? ??EL. \n"
+"Dal?? podrobnosti hledejte v GNU General Public License. \n"
+"\n"
+"Kopii GNU General Public License jste m?l(a) obdr?et spolu s t?mto \n"
+"programem; pokud se tak nestalo, napi?te o ni Free Software \n"
+"Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:71
-msgid "http://www.avidemux.org"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:75
 msgid "translator-credits"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:237
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:241
 msgid "Xvid Encoder"
 msgstr "Kod?r Xvid"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:250
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:254
 msgid "Constant Quantizer"
 msgstr "Konstantn? kvantiz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:258
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:262
 msgid "Constant Bitrate (kbps)"
 msgstr "Konstantn? datov? tok (kb/s)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:266
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:270
 msgid "Dual pass (MBytes)"
 msgstr "Dva pr?chody (MB)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:296
 msgid "Basic"
 msgstr "Z?kladn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:301
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:305
 msgid "Motion Search"
 msgstr "Odhad pohybu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:317
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:321
 msgid "Max I frame interval "
 msgstr "Max. interval I sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:333
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:337
 msgid "Min I frame interval"
 msgstr "Min. interval I sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
 msgid "1- Very low"
 msgstr "1- velmi n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
 msgid "2- Low"
 msgstr "2- n?zk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
 msgid "3- Medium"
 msgstr "3- st?edn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
 msgid "4- High"
 msgstr "4- vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
 msgid "5- Very High"
 msgstr "5- velmi vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:385
 msgid "6- Ultra High"
 msgstr "6- ultra vysok?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:399
 msgid "H263 Quantizer"
 msgstr "H.263 kvantiz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:400
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:404
 msgid "MPEG Quantizer"
 msgstr "MPEG kvantiz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:407
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:411
 msgid "Advanced"
 msgstr "Roz???en?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:416
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:420
 msgid "Min I Frame Qzer"
 msgstr "Min. kvantiz?r I sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:424
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:428
 msgid "Max I Frame Qzer"
 msgstr "Max. kvantiz?r I sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:432
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:436
 msgid "Min P Frame Qzer"
 msgstr "Min. kvantiz?r P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:440
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:444
 msgid "Max P Frame Qzer"
 msgstr "Max. kvantiz?r P sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:480
-msgid "Quantizer"
-msgstr "Kvantiz?r"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:485
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:489
 msgid "Not Yet!"
 msgstr "Je?t? nen?!"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:490
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:494
 msgid "B Frames"
 msgstr "B sn?mky"
 
@@ -2569,163 +2591,36 @@
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr "Parametry (nap?. -b 192 -m s ...):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:405
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:381
-#, fuzzy
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:511
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:388
 msgid "Swiss Army Knife Configuration"
-msgstr "Nastaven? x264"
+msgstr "Swiss Army Knife"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:898
-#: avidemux/ADM_filter/filter_declaration.cpp:173
-msgid "Swiss Army Knife"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:75
+msgid "ASHARP"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:925
-msgid "Select _Operation on each pixel P and input A:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:937
-msgid "Input _Type:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:956
-msgid "Input _File (convolution kernel):   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:960
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:975
-msgid "Select Convolution Kernel File"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:971
-msgid "Input _File (image file):   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:997
-msgid "First, _add to each float pixel value:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1011
-msgid "Then, _multiply each float pixel value by:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1025
-msgid "Mi_nimum loaded pixel value (will be scaled to 0):"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1051
-msgid "Ma_ximum loaded pixel value (will be scaled to 255):"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1073
-msgid "Pixel Value Scaling as Image File is Loaded"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1085
-msgid "Input _Constant:      "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1102
-msgid "Memory constant _alpha:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1112
-msgid " = 1 / "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1130
-msgid "_Initial average (\"head start\") is "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1137
-#, fuzzy
-msgid "straight"
-msgstr "6- ultra vysok?"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1138
-msgid "rolling"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1140
-msgid " average"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1148
-msgid "      of frames "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1158
-msgid " through "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1176
-msgid "Integer _Bias (will be added to result of selected operation):"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1216
-msgid "First, _add to each pixel result value:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1230
-msgid "Then, _multiply each pixel result value by:   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1244
-msgid "Mi_nimum result value (will be scaled to 0):"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1270
-msgid "Ma_ximum result value (will be scaled to 255):"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1292
-msgid "Pixel Value Scaling on Result of Selected Operation"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1301
-msgid "(description of current config will go here)"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1318
-msgid "_Histogram every N frames (0 to disable):   "
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1332
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:567
-msgid "_Debugging settings (bits):   "
-msgstr "La_d?c? nastaven? (bity):   "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1365
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:600
-msgid "Swiss Army Knife output"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp:1390
-#, fuzzy
-msgid "Enable Preview"
-msgstr "N?hled"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:187
 msgid "ASharp by MarcFD"
 msgstr "ASharp"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:196
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:200
 msgid "Threshold :"
 msgstr "Pr?h:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:208
 msgid "Strength :"
 msgstr "S?la:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:216
 msgid "Block Adaptative :"
 msgstr "Blokov? adaptivn?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:224
 msgid "Unknown flag :"
 msgstr "Nezn?m? parametr:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp:96
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp:102
 msgid "Recent files"
 msgstr "Ned?vn? soubory"
 
@@ -2753,114 +2648,109 @@
 msgid "Retry"
 msgstr "Zkusit znovu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:996
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:999
 msgid "Calculator"
 msgstr "Kalkul?tor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:414
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:418
 msgid "<b>Target</b>"
 msgstr "<b>C?l</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:441
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:445
 msgid "Duration:"
 msgstr "D?lka:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:461
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:465
 msgid "_Medium:"
 msgstr "_M?dium:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:472
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:476
 msgid "_Format:"
 msgstr "_Form?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:487
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:545
 msgid "Total size (custom)"
 msgstr "Celkov? velikost (vlastn?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:493
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:497
 msgid "_Custom size (MB):"
 msgstr "_Vlastn? velikost (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:507
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
 msgid "Output container format"
 msgstr "V?stupn? form?t kontejneru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
-msgid "MPEG"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
 msgid "Total size"
 msgstr "Celkov? velikost"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:542
 msgid "1x 80 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:543
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
 msgid "2x 80 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
 msgid "1x 74 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
 msgid "2x 74 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
 msgid "DVD5"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:571
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:575
 msgid "Track _1:"
 msgstr "_1. stopa:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:579
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:583
 msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
 msgstr "Datov? tok zvuku v kb/s pro stopu 1 (0 znamen? bez zvuku)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:586
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:590
 msgid "Track _2: "
 msgstr "_2. stopa:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:594
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
 msgid "Audio bitrate in kb/s for track 2 (optional)"
 msgstr "Datov? tok zvuku v kb/s pro stopu 2 (voliteln?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:602
 msgid "<b>Audio Bitrate</b>"
 msgstr "<b>Datov? tok zvuku</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:624
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:628
 msgid "Audio size (MB):"
 msgstr "Velikost zvuku (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:640
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:644
 msgid "Video size (MB):"
 msgstr "Velikost videa (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:656
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:660
 msgid "Total size (MB):"
 msgstr "Celkov? velikost (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:682
 msgid "Video bitrate:"
 msgstr "Datov? tok videa:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:686
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:690
 msgid "Bits per pixel:"
 msgstr "Bit? na pixel:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:702
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:706
 msgid "0.0"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:710
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:714
 msgid "<b>Result</b>"
 msgstr "<b>V?sledek</b>"
 
@@ -2943,7 +2833,7 @@
 msgstr "Pom?r stran pixelu:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:311
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1060
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1063
 msgid "<b>Video</b>"
 msgstr ""
 
@@ -2988,7 +2878,7 @@
 msgstr "Variabiln? datov? tok:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:489
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1100
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1103
 msgid "<b>Audio</b>"
 msgstr ""
 
@@ -3013,7 +2903,7 @@
 msgstr "Dokon?en"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-#: avidemux/gtk_gui.cpp:2282
+#: avidemux/gtk_gui.cpp:2305
 msgid "Failed"
 msgstr "Chyba"
 
@@ -3025,106 +2915,113 @@
 msgid "Running"
 msgstr "B???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:98
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:104
 msgid "  Job Name  "
 msgstr "N?zev ?lohy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:103
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:109
 msgid "Started at"
 msgstr "Za??tek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:113
 msgid "Finished at"
 msgstr "Konec"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:140
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:178
 msgid "Sure!"
 msgstr "Jist?!"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:140
 msgid "Delete ALL jobs"
 msgstr "Smazat v?echny ?lohy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:140
 msgid "Are you sure you want to delete all jobs ?"
 msgstr "Ur?it? chcete smazat v?echny ?lohy?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:178
 msgid "Delete job"
 msgstr "Smazat ?lohu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:178
 #, c-format
 msgid "Are you sure you want to delete %s job ?"
 msgstr "Ur?it? chcete smazat ?lohu %s?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:187
 msgid "Unknown event"
 msgstr "Nezn?m? ud?lost"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:261
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:268
 msgid "Jobs"
 msgstr "?lohy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:294
 msgid "Delete All Jobs"
 msgstr "Odstranit v?echny ?lohy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:299
 msgid "Delete Job"
 msgstr "Odstranit ?lohu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:304
 msgid "Run all jobs"
 msgstr "Spustit v?echny ?lohy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:302
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:309
 msgid "Run Job"
 msgstr "Spustit ?lohu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:235
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:239
 msgid "Luma"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:243
-#, fuzzy
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:247
 msgid "Chroma v"
-msgstr "Chrominance pro odhad pohybu"
+msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:95
 msgid "none"
 msgstr "Nic"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:98
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:104
 msgid "Select .idx file"
 msgstr "Zvolte .idx soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:115
+msgid "Wrong VobSub parametering"
+msgstr "?patn? parametry VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:115
+msgid "The idx/sub file does not set."
+msgstr "idx/sub soubor neexistuje."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:202
 msgid "VobSub Settings"
 msgstr "Nastaven? VobSub"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:213
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
 msgid "Select .idx"
 msgstr "_Vybrat .idx"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:227
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:233
 msgid "Select Language :"
 msgstr "Jazyk:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:241
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:247
 msgid "Select Sub"
 msgstr "V?b?r titulk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:254
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:260
 msgid "Extra Shrink Factor :"
 msgstr "Faktor extra smr?t?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:269
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:275
 msgid "Shift (ms) :"
 msgstr "Posun (ms):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:283
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:289
 msgid "Extra Settings"
 msgstr "Roz???en? nastaven?"
 
@@ -3132,216 +3029,120 @@
 msgid "Equalizer"
 msgstr "Ekvaliz?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:312
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:319
 #: avidemux/ADM_filter/filter_declaration.cpp:56
 msgid "Resize"
 msgstr "Zm?na velikosti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:326
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:333
 msgid " Width "
 msgstr "???ka"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:333
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:340
 msgid " Height "
 msgstr "V??ka"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:363
 msgid "Source :"
 msgstr "Zdroj:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:362
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:369
 msgid "Destination"
 msgstr "C?l"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:380
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:402
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:387
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:409
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:42
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:48
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:43
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:44
 msgid "4:3"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:384
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:406
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:391
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:413
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:43
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:49
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:44
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:45
 msgid "16:9"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:412
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
 msgid " Error X:"
 msgstr "Odchylka X:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:426
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
 msgid " Error Y:"
 msgstr "Odchylka Y:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:440
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:447
 msgid "16 round up"
 msgstr "Zaokrouhlen? na 16"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:454
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:461
 msgid "Bilinear"
 msgstr "Biline?rn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:458
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:465
 msgid "Bicubic"
 msgstr "Bikubick?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:462
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:469
 msgid "Lanczos3"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:274
 msgid "Particle Analysis Configuration"
 msgstr "Nastaven? anal?zy ??stic"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:404
-msgid "Particle Detection"
-msgstr "Detekce ??stic"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:431
-msgid "Mi_nimum area for a particle to be detected:    "
-msgstr "Mi_nim?ln? plocha k detekci ??stice:    "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:445
-msgid "Ma_ximum area for a particle to be detected:   "
-msgstr "Ma_xim?ln? plocha k detekci ??stice:   "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:463
-msgid "_Left side crop (ignore this many pixels on the left):        "
-msgstr "O?ez _lev? strany (ignorovat tolik pixel? vlevo):        "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:477
-msgid "_Right side crop (ignore this many pixels on the right):     "
-msgstr "O?ez p_rav? strany (ignorovat tolik pixel? vpravo):     "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:491
-msgid "_Top crop (ignore this many pixels on the top):                  "
-msgstr "_Horn? o?ez (ignorovat tolik pixel? naho?e):                  "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:505
-msgid "_Bottom crop (ignore this many pixels on the bottom):   "
-msgstr "_Spodn? o?ez (ignorovat tolik pixel? dole):   "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:523
-msgid "Output _Format:   "
-msgstr "V?stupn? _form?t:   "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:535
-#: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:174
-msgid "_Output File:"
-msgstr "V?stupn? s_oubor:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:545
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
-msgid "_Browse..."
-msgstr "_Proch?zet..."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp:553
-msgid "_Camera Number for output file:      "
-msgstr "??slo _kamery pro v?stupn? soubor:      "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:252
+#: avidemux/ADM_videoFilter/ADM_vidCrop.cpp:195
 msgid "Crop Settings"
 msgstr "Nastaven? o?ezu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:289
-msgid "AutoCrop"
-msgstr "Automaticky"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:277
+msgid "Crop Left:"
+msgstr "O?ez vlevo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:311
-msgid "Reset"
-msgstr "Vr?tit"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:284
+msgid "Crop Right:"
+msgstr "Vpravo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:320
-msgid "Crop Left :"
-msgstr "Vlevo:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:328
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:291
 msgid "Crop Top:"
 msgstr "Naho?e:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:336
-msgid "Crop Right:"
-msgstr "Vpravo:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:344
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:298
 msgid "Crop Bottom:"
 msgstr "Dole:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:341
+msgid "Auto Crop"
+msgstr "Automatick? o?ez"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:109
 msgid "Video encoder"
 msgstr "Video kod?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1080
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1120
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1083
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1123
 msgid "Configure"
 msgstr "Nastavit"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:91
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:228
 msgid "Subtitle Size and Position"
 msgstr "Velikost a um?st?n? titulk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:236
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:242
 msgid "Font Size:"
 msgstr "Velikost p?sma:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-msgid "Select Video to Write"
-msgstr "Zvolte video k z?pisu"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Invalid filename"
-msgstr "Neplatn? n?zev souboru"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename."
-msgstr "Pros?m zvolte nebo napi?te platn? n?zev souboru."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Invalid jobname"
-msgstr "Neplatn? n?zev ?lohy"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname."
-msgstr "Pros?m zvolte nebo napi?te platn? n?zev ?lohy."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
-msgid "Save Job"
-msgstr "Ulo?it ?lohu"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
-msgid "Select the output file"
-msgstr "Vyberte v?stupn? soubor"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
-msgid "Job name displayed in the job list and used as the script filename"
-msgstr "N?zev ?lohy zobrazen? v seznamu ?loh a pou?it? jako n?zev souboru se skriptem"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
-msgid "Filename of the audio/video output"
-msgstr "N?zev souboru audio/video v?stupu"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
-msgid "_Job name:"
-msgstr "_N?zev ?lohy:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
-msgid "Output _file:"
-msgstr "_V?stupn? soubor:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:98
 msgid "Paused"
 msgstr "Zastaveno"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:109
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:114
 msgid ""
 "<b>Encoding is paused.</b>\n"
 "\n"
@@ -3351,19 +3152,19 @@
 "\n"
 "M??ete pokra?ovat nebo jej ukon?it."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:136
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:141
 msgid "Abort"
 msgstr "Ukon?it"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:163
 msgid "Resume"
 msgstr "Pokra?ovat"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:138
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:141
 msgid "AudioCodec"
 msgstr "Audio kodek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:166
 msgid "Configure codec"
 msgstr "Nastavit kodek"
 
@@ -3377,16 +3178,16 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:121
 msgid "String"
-msgstr ""
+msgstr "?et?zec"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
 msgid "Search string"
-msgstr ""
+msgstr "Vyhledat ?et?zec"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
 msgid "End reached"
-msgstr ""
+msgstr "Dosa?en konec"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
@@ -3396,7 +3197,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
 msgid "Head reached"
-msgstr ""
+msgstr "Dosa?en ?vod"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:344
 msgid "dialog1"
@@ -3404,27 +3205,27 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:396
 msgid "Prev. Empty"
-msgstr ""
+msgstr "P?edchoz? pr?zdn?"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:418
 msgid "Next Empty"
-msgstr ""
+msgstr "Dal?? pr?zdn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:438
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:382
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:543
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:380
 msgid "Input"
 msgstr "Vstup"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:439
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:386
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:544
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:384
 msgid "Output"
 msgstr "V?stup"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:440
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:545
 msgid "Side"
 msgstr "Vedle sebe"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:441
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:546
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
@@ -3432,515 +3233,519 @@
 msgid "Top"
 msgstr "Vrchn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:442
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:547
 msgid "Separate"
 msgstr "Samostatn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:621
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:721
 #, c-format
 msgid "Frame:%c(%02d)"
 msgstr "Sn?mek: %c (%02d)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:274
+msgid "Avidemux"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:298
 msgid "_Open..."
 msgstr "_Otev??t..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:308
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:309
 msgid "_Append..."
 msgstr "_P?ipojit..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:320
 msgid "_Save"
 msgstr "_Ulo?it"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:331
 msgid "Save _Video..."
 msgstr "_Ulo?it video..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:342
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:343
 msgid "Save _BMP Image..."
 msgstr "Ulo?it _BMP obr?zek..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:346
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:347
 msgid "Save _JPEG Image..."
 msgstr "Ulo?it _JPEG obr?zek..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:350
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:351
 msgid "Save _Selection as JPEG Images..."
 msgstr "Ulo?it _v?b?r jako JPEG obr?zky..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:363
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:364
 msgid "Save _Project"
 msgstr "Ulo?it p_rojekt"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:371
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:372
 msgid "Save P_roject As..."
 msgstr "Ulo?it pro_jekt jako..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:379
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:380
 msgid "_Load/Run Project..."
 msgstr "_Na??st/spustit projekt..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:387
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:388
 msgid "A_dd to Joblist..."
 msgstr "P?i_dat do seznamu ?loh..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:391
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:392
 msgid "Show _Joblist"
 msgstr "Uk?zat _seznam ?loh"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:403
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:404
 msgid "Co_nnect to avsproxy"
 msgstr "P?ipojit s_e k avsproxy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:412
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:413
 msgid "Proper_ties"
 msgstr "Vlas_tnosti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:423
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:424
 msgid "AVI _Muxer Options"
 msgstr "N_astaven? z?pisu AVI"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:432
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:433
 msgid "_Quit"
 msgstr "U_kon?it"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:443
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:444
 msgid "_Edit"
 msgstr "_Upravit"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:450
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:451
 msgid "_Reset Edits"
 msgstr "V_r?tit ?pravy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:463
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:464
 msgid "Cu_t"
 msgstr "_Vyjmout"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:474
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:475
 msgid "_Copy"
 msgstr "_Kop?rovat"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:485
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:486
 msgid "_Paste"
 msgstr "V_lo?it"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:496
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:497
 msgid "_Delete"
 msgstr "_Odstranit"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:512
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:513
 msgid "Set Marker _A"
 msgstr "Nastavit zna?ku _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:519
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:520
 msgid "Set Marker _B"
 msgstr "Nastavit zna?ku _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:531
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:532
 msgid "Pre_ferences"
 msgstr "_P?edvolby"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:539
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:540
 msgid "_View"
 msgstr "_Zobrazit"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:546
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:547
 msgid "_Main Toolbar"
 msgstr "_Hlavn? n?strojov? li?ta"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:551
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:552
 msgid "_A/V Sidebar"
 msgstr "_A/V postrann? li?ta"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:561
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:562
 msgid "_Zoom 1:4"
 msgstr "_Velikost 1:4"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:569
 msgid "Z_oom 1:2"
 msgstr "V_elikost 1:2"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:576
 msgid "Zoom _1:1"
 msgstr "Velikost _1:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:582
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:583
 msgid "Zoom _2:1"
 msgstr "Velikost _2:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:590
 msgid "Vi_deo"
 msgstr "_Video"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:596
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:597
 msgid "_Decoder Options"
 msgstr "_Nastaven? dekod?ru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:603
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:604
 msgid "_Postprocessing"
 msgstr "_Dodate?n? zpracov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:607
 msgid "Select postprocessing level"
 msgstr "Nastavit ?rove? dodate?n?ho zpracov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:616
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:617
 msgid "P_review"
 msgstr "N?_hled"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:623
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:624
 msgid "Display _Output"
 msgstr "_Zobrazovat v?stup"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:635
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:636
 msgid "_Frame Rate"
 msgstr "_Sn?mkov? frekvence"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:639
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:688
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:640
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:689
 msgid "_Encoder"
 msgstr "_Kod?r"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:646
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:647
 msgid "Fil_ters"
 msgstr "_Filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:653
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:654
 msgid "_Audio"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:660
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:661
 msgid "_Main Track"
 msgstr "_Hlavn? stopa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:665
 msgid "_Second Track"
 msgstr "_Druh? stopa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:669
 msgid "_Build VBR Time Map"
 msgstr "_Sestavit ?asovou mapu VBR"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:678
 msgid "S_ave..."
 msgstr "_Ulo?it..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:696
 msgid "_Filters"
 msgstr "_Filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:699
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:700
 msgid "_Tools"
 msgstr "_N?stroje"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:706
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:707
 msgid "_Calculator"
 msgstr "_Kalkul?tor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:722
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:723
 msgid "_Rebuild Frames (I & B)"
 msgstr "_Sestavit sn?mky (I a B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:726
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:727
 msgid "C_heck Frames (slow)"
 msgstr "_Zkontrolovat sn?mky (pomal?)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:730
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:731
 msgid "_Bitrate Histogram"
 msgstr "_Histogram datov?ho toku"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:734
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:735
 msgid "_Scan for Black Frames..."
 msgstr "V_yhledat ?ern? sn?mky..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:743
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:744
 msgid "_VOB -> VobSub"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:747
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:748
 msgid "_OCR (VobSub -> srt)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:751
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:752
 msgid "OCR (TS->srt)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:755
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:756
 msgid "_Edit Glyph"
 msgstr "_Upravit glyf"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:765
 msgid "_Frame Hex Dump"
 msgstr "He_x v?pis sn?mk?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:768
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:769
 msgid "A_uto"
 msgstr "Au_to"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:775
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:776
 msgid "_VCD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:780
 msgid "_SVCD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:783
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:784
 msgid "_DVD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:787
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:788
 msgid "_PSP"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:791
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:792
 msgid "PSP (_H.264)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:795
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:796
 msgid "F_LV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:799
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:800
 msgid "IPOD (mpeg4)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:803
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
 msgid "_Go"
 msgstr "P?e_j?t"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:810
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:811
 msgid "_Play/Stop"
 msgstr "_P?ehr?t/Stop"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:821
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:822
 msgid "P_revious Frame"
 msgstr "P?_edchoz? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:833
 msgid "_Next Frame"
 msgstr "_N?sleduj?c? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:844
 msgid "Pr_evious Intra Frame"
 msgstr "P?e_dchoz? kl??ov? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:854
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:855
 msgid "Next _Intra Frame"
 msgstr "N?_sleduj?c? kl??ov? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:865
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:866
 msgid "Previou_s Black Frame"
 msgstr "P?edch_oz? ?ern? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:869
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:870
 msgid "Ne_xt Black Frame"
 msgstr "N?sled_uj?c? ?ern? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:873
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:874
 msgid "_First Frame"
 msgstr "P_rvn? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:885
 msgid "_Last Frame"
 msgstr "Pos_ledn? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:901
 msgid "Go to Marker _A"
 msgstr "P?ej?t na zna?ku _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:907
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:908
 msgid "Go to Marker _B"
 msgstr "P?ej?t na zna?ku _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:919
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:920
 msgid "Go to Fra_me..."
 msgstr "P?ej?t na sn?_mek..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:930
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:931
 msgid "Go to _Time..."
 msgstr "P?ej?_t na ?as..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:941
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:942
 msgid "_Custom"
 msgstr "V_lastn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:945
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:946
 msgid "_Help"
 msgstr "N?p_ov?da"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:952
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:953
 msgid "_Built-in Support"
 msgstr "_Vestav?n? podpora"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:956
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:957
 msgid "_About"
 msgstr "_O programu"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:974
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:975
 msgid "Open a file"
 msgstr "Otev??t soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:984
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:985
 msgid "Save the file"
 msgstr "Ulo?it soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:990
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:991
 msgid "Audio/video file information"
 msgstr "Audio/video informace o souboru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:999
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1002
 msgid "Bitrate/size calculator"
 msgstr "Kalkul?tor datov?ho toku/velikosti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1078
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1118
-msgid "Copy"
-msgstr "Kopie"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1083
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1086
 msgid "Configure video encoder"
 msgstr "Nastaven? video kod?ru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1088
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1144
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1091
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1147
 msgid "Filters"
 msgstr "Filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1091
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1094
 msgid "Video filters"
 msgstr "Video filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1126
 msgid "Configure audio encoder"
 msgstr "Nastaven? audio kod?ru"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1131
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1134
 msgid "Audio filters"
 msgstr "Audio filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1152
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1155
 msgid "Shift:"
 msgstr "Posun:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1155
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1158
 msgid "Enable time shift"
 msgstr "Aktivovat ?asov? posun"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
 msgid "Audio/video time shift (ms)"
 msgstr "?asov? posun zvuku proti obrazu (ms)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1168
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1171
 msgid "<b>Format</b>"
 msgstr "<b>Form?t</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1209
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1204
 msgid "Frame: "
 msgstr "Sn?mek:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1216
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1211
 msgid "Current frame"
 msgstr "Sou?asn? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1221
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1216
 msgid "/ 0000000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1228
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1223
 msgid "Time: "
 msgstr "?as:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1235
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1230
 msgid "Current time"
 msgstr "Sou?asn? ?as"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1236
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1231
 msgid "00:00:00.000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1239
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1234
 msgid "/ 00:00:00,000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1246
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1241
 msgid "Frame: ?"
 msgstr "Sn?mek: ?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1270
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1265
 msgid "Play"
 msgstr "P?ehr?t"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1279
 msgid "Stop"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1296
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1291
 msgid "Previous frame"
 msgstr "P?edchoz? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1311
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1306
 msgid "Next frame"
 msgstr "N?sleduj?c? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1326
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1321
 msgid "Previous keyframe"
 msgstr "P?edchoz? kl??ov? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1341
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1336
 msgid "Next keyframe"
 msgstr "N?sleduj?c? kl??ov? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1355
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1350
 msgid "Selection: start"
 msgstr "V?b?r: za??tek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1366
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1361
 msgid "Selection: end"
 msgstr "V?b?r: konec"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1377
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1372
 msgid "Previous black frame"
 msgstr "P?edchoz? ?ern? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1388
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1383
 msgid "Next black frame"
 msgstr "N?sleduj?c? ?ern? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1399
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1394
 msgid "First frame"
 msgstr "Prvn? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1410
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1405
 msgid "Last frame"
 msgstr "Posledn? sn?mek"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1424
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1419
 msgid "<b>Selection</b>"
 msgstr "<b>V?b?r</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1441
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1436
 msgid "B:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1448
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1443
 msgid "Go to marker B"
 msgstr "P?ej?t na zna?ku B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1450
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1445
 msgid "A:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1457
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1452
 msgid "Go to marker A"
 msgstr "P?ej?t na zna?ku A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1459
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1467
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1454
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1462
 msgid " 0000000"
 msgstr ""
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
+msgid "_Browse..."
+msgstr "_Proch?zet..."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:99
 msgid "_Encoding mode:"
 msgstr "_Re?im k?dov?n?:"
@@ -3951,6 +3756,10 @@
 msgid "_Bitrate (kb/s):"
 msgstr "_Datov? tok (kb/s):"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:123
+msgid "Single pass - bitrate"
+msgstr "Jeden pr?chod - datov? tok"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:125
 msgid "Single pass - constant quality"
 msgstr "Jeden pr?chod - konstantn? kvalita"
@@ -3982,11 +3791,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:283
 msgid "_Video size (MB):"
-msgstr ""
+msgstr "_Velikost videa (MB):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:288
 msgid "_Average bitrate (kb/s):"
-msgstr ""
+msgstr "_Pr?m?rn? datov? tok (kb/s):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:293
 msgid "-"
@@ -4000,7 +3809,7 @@
 msgid "Auto-detect"
 msgstr "Automatick? detekce"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp:71
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp:70
 msgid "Select Color"
 msgstr "Barva"
 
@@ -4196,7 +4005,7 @@
 msgstr "Transformace"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
-#: avidemux/ADM_filter/filter_declaration.cpp:129
+#: avidemux/ADM_filter/filter_declaration.cpp:135
 #: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:397
 msgid "Denoise"
 msgstr "Redukce ?umu"
@@ -4209,63 +4018,39 @@
 msgid "Miscellaneous"
 msgstr "R?zn?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:585
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:657
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:719
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:779
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:842
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:582
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:660
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:728
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:788
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:851
 msgid "label1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:706
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:715
 msgid "Alert"
 msgstr "Upozorn?n?"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp:55
+msgid "Open Avidemux"
+msgstr "Otev??t Avidemux"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:252
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:276
 #, c-format
 msgid "Couldn't find pixmap file: %s"
 msgstr "Nelze naj?t soubor s bitmapou: %s"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:100
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:201
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:469
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:106
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:213
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:400
 msgid "Cannot open directory as a file"
 msgstr "Nelze otev??t adres?? jako soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
-#: avidemux/gtk_gui.cpp:900
-#, c-format
-msgid "Cannot open \"%s\"."
-msgstr "Nelze otev??t \"%s\"."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:338
-#, c-format
-msgid ""
-"%s already exists.\n"
-"\n"
-"Do you want to replace it?"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:365
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:379
-msgid "It is possible that you are trying to overwrite an input file!"
-msgstr "Je mo?n?, ?e se sna??te p?epsat vstupn? soubor!"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:390
-msgid "Cannot write the file"
-msgstr "Nelze zapsat soubor"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:390
-#, c-format
-msgid "No write access to \"%s\"."
-msgstr "Nen? povolen z?pis do \"%s\"."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:524
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:455
 msgid "Images"
 msgstr "Obr?zky"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:536
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:467
 msgid "All"
 msgstr "V?echny"
 
@@ -4303,25 +4088,17 @@
 msgstr "Histogram datov?ho toku"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:37
-msgid "_Swap U&V:"
+msgid "_Swap U&V"
 msgstr "_Prohodit U a V"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:39
-msgid "Mjpeg Configuration"
+msgid "MJPEG Configuration"
 msgstr "Nastaven? MJPEG"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:128
 msgid "Video Codecs"
 msgstr "Video kodeky"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
-msgid "Xvid"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
-msgid "x264"
-msgstr ""
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
 msgid "Audio Codecs"
 msgstr "Audio kodeky"
@@ -4363,10 +4140,12 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:307
 msgid "aRts"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:313
 msgid "ESD"
 msgstr ""
 
@@ -4379,25 +4158,27 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
-msgid "gettext"
+msgid "Gettext"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:304
 msgid "ALSA"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:319
 msgid "OSS"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:322
 msgid "SDL"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
-#, fuzzy
 msgid "XVideo"
-msgstr "_Video"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:166
 msgid "AltiVec"
@@ -4424,7 +4205,7 @@
 msgstr "Knihovny"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:406
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:404
 msgid "CPU"
 msgstr "CPU"
 
@@ -4523,9 +4304,8 @@
 msgstr "_Typ:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:95
-#, fuzzy
 msgid "_MntMode:"
-msgstr "Re?im pohybu"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:96
 msgid "_Link:"
@@ -4578,13 +4358,12 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:112
 msgid "Debug:"
-msgstr ""
+msgstr "Lad?n?:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:121
-#: avidemux/ADM_filter/filter_declaration.cpp:73
-#, fuzzy
+#: avidemux/ADM_filter/filter_declaration.cpp:74
 msgid "TDeint"
-msgstr "TDeint"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
 msgid "_Hours:"
@@ -4681,9 +4460,8 @@
 msgstr "?_asov? posun (ms):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
-#, fuzzy
 msgid "Time shift value (ms)"
-msgstr "?asov? posun:"
+msgstr "?asov? posun (ms):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "R_esampling (Hz):"
@@ -4691,7 +4469,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "Resampling frequency (Hz)"
-msgstr ""
+msgstr "Frekvence p?evzorkov?n? (Hz)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:81
 msgid "Film to PAL"
@@ -4765,48 +4543,83 @@
 msgid "Audio Filters"
 msgstr "Audio filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:51
+msgid "Chinese Simplified (GB2312)"
+msgstr "Zjednodu?en? ??n?tina (GB2312)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:52
+msgid "Chinese Traditional (Big5)"
+msgstr "Tradi?n? ??n?tina (Big5)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:53
+msgid "Cyrillic"
+msgstr "Azbuka"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:54
+msgid "Czech"
+msgstr "?e?tina"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:55
+msgid "German"
+msgstr "N?m?ina"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:56
+msgid "Latin-1"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:57
+msgid "Slovene"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:58
+msgid "UTF-8"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:59
+msgid "UTF-16"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
 msgid "_Subtitle file:"
 msgstr "_Soubor s titulky:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
 msgid "Select Subtitle file"
 msgstr "Zvolte soubor s titulky"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:90
 msgid "_Font (TTF):"
 msgstr "P?s_mo (TTF):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:90
 msgid "Select TTF file"
 msgstr "Zvolte TTF soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:105
 msgid "_Encoding:"
 msgstr "_K?dov?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
 msgid "S_elect C_olor"
 msgstr "Zvolte ba_rvu"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
 msgid "Set Size and _Position"
 msgstr "Zvolte _velikost a um?st?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
 msgid "_Auto split"
 msgstr "_Automatick? rozd?lov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:110
 msgid "_Delay (ms):"
 msgstr "Zp_o?d?n? (ms):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
-#: avidemux/ADM_filter/filter_declaration.cpp:151
-#, fuzzy
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:113
+#: avidemux/ADM_filter/filter_declaration.cpp:159
 msgid "Subtitler"
-msgstr "Titulky"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:34
 msgid "_VOB file(s):"
@@ -4873,89 +4686,101 @@
 msgid "Timecode:"
 msgstr "?asov? k?d:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:85
 msgid "Select idx file:"
 msgstr "Zvolte idx soubor:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
 msgid "Use GlyphSet (optional):"
 msgstr "Pou??t sadu glyf? (voliteln?):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:369
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 msgid "Select GlyphSet file"
 msgstr "Zvolte soubor se sadou glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Output SRT file"
 msgstr "V?stupn? SRT soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Save SRT file"
 msgstr "Ulo?it SRT soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:214
 msgid "Select input and ouput files"
 msgstr "Zvolte vstupn? a v?stupn? soubory"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
 msgid "The idx/sub file does not exist."
 msgstr "idx/sub soubor neexistuje"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
 msgid "Please Select a valid output SRT file."
 msgstr "Pros?m zvolte spr?vn? SRT soubor."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 msgid "Cannot load the glyphset file."
 msgstr "Nelze na??st soubor se sadou glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "GlyphSet filename"
 msgstr "N?zev souboru se sadou glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 msgid "Save GlyphSet file"
 msgstr "Ulo?it soubor se sadou glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:149
 msgid "Save Glyph"
 msgstr "Ulo?it glyf"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Input TS:"
 msgstr "Vstupn? TS:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 msgid "Select TS file"
 msgstr "Zvolte TS soubor"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:201
 msgid "Subtitle PID:"
 msgstr "PID titulk?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 msgid "Use glyphset (optional):"
 msgstr "Pou??t sadu glyf? (voliteln?):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
 msgid "Please Select a valid TS file."
-msgstr ""
+msgstr "Vyberte pros?m platn? TS soubor."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:270
 msgid "Save GlyphSet"
 msgstr "Ulo?it sadu glyf?"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:63
+msgid "VCD 40 kB"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:64
+msgid "SVCD 112 kB"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:65
+msgid "DVD 224 kB"
+msgstr ""
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:71
 msgid "Mi_n. bitrate:"
 msgstr "Mi_n. datov? tok:"
@@ -4994,19 +4819,16 @@
 msgstr "Nastaven? rekvantizace"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:33
-#, fuzzy
 msgid "VCD"
-msgstr "VCD"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:34
-#, fuzzy
 msgid "SVCD"
-msgstr "SVCD"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:35
-#, fuzzy
 msgid "DVD"
-msgstr "DVD"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:36
 msgid "DVD half D1"
@@ -5020,19 +4842,19 @@
 msgid "PSP full res (720*480"
 msgstr "PSP pln? rozli?en? (720*480)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:54
 msgid "_Target type:"
 msgstr "_C?lov? form?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:54
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:55
 msgid "_Source aspect ratio:"
 msgstr "Zdrojov? _pom?r stran:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:55
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:56
 msgid "_Destination aspect ratio:"
 msgstr "C?lov? pom?r _stran:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
 msgid "Auto Wizard"
 msgstr "Automatick? pr?vodce"
 
@@ -5046,13 +4868,13 @@
 msgstr "_S?la filtru:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:346
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:344
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
 msgid "_Horizontal deblocking"
 msgstr "_Horizont?ln? deblocking"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:347
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:345
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
 msgid "_Vertical deblocking"
 msgstr "V_ertik?ln? deblocking"
@@ -5062,284 +4884,312 @@
 msgid "_Deringing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:6
+msgid "_Job name:"
+msgstr "_N?zev ?lohy:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+msgid "Output _File:"
+msgstr "_V?stupn? soubor:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+msgid "Select Video To Write"
+msgstr "Zvolte video k z?pisu"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:10
+msgid "Save Job"
+msgstr "Ulo?it ?lohu"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
 msgid "_Use systray while encoding"
 msgstr "_Pohltit do panelu p?i k?dov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
 msgid "_Accept non-standard audio frequency for DVD"
 msgstr "P_ovolit nestandardn? frekvenci zvuku pro DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "_Use libavcodec MPEG-2 decoder"
 msgstr "_Pou??vat libavcodec MPEG-2 dekod?r"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:191
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 msgid "Create _OpenDML files"
 msgstr "_Vytv??et OpenDML soubory"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:191
 msgid "Automatically _index MPEG files"
 msgstr "Automaticky indexovat _MPEG soubory"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
 msgid "Automatically _swap A and B if A>B"
 msgstr "Automaticky _prohodit zna?ky A a B pokud je A > B"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
 msgid "_Disable NUV audio sync"
 msgstr "_Vypnout synchronizaci zvuku pro NuppelVideo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:195
 msgid "Automatically _build VBR map"
 msgstr "Automaticky sestavit mapu _VBR"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:197
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
 msgid "Automatically _rebuild index"
 msgstr "Automaticky _sestavit index"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:197
 msgid "Automatically remove _packed bitstream"
 msgstr "Automaticky _odstranit zabalen? bitstream"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:200
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:199
 msgid "SIMD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:202
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
 msgid "Enable all SIMD"
 msgstr "Aktivovat v?echny SIMD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:202
 msgid "Enable MMX"
 msgstr "Aktivovat MMX"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
 msgid "Enable MMXEXT"
 msgstr "Aktivovat MMXEXT"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:205
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:204
 msgid "Enable 3DNOW"
 msgstr "Aktivovat 3DNOW"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:205
 msgid "Enable 3DNOWEXT"
 msgstr "Aktivovat 3DNOWEXT"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:206
 msgid "Enable SSE"
 msgstr "Aktivovat SSE"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
 msgid "Enable SSE2"
 msgstr "Aktivovat SSE2"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
 msgid "Enable SSE3"
 msgstr "Aktivovat SSE3"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:209
 msgid "Enable SSSE3"
 msgstr "Aktivovat SSSE3"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
 msgid "_lavc threads:"
 msgstr "Vl?kna _libavcodecu:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:232
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:231
 msgid "_x264 threads:"
 msgstr "Vl?kna _x264:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:232
 msgid "X_vid threads:"
 msgstr "Vl?kna X_vidu:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:235
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:234
 msgid "Multi-threading"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:241
 msgid "Above normal"
 msgstr "Vy???"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:244
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:243
 msgid "Below normal"
 msgstr "Ni???"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:247
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:246
 msgid "_Encoding priority:"
 msgstr "Priorita _k?dov?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:248
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:247
 msgid "_Indexing/unpacking priority:"
 msgstr "Priorita i_ndexace/rozbalov?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:249
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:248
 msgid "_Playback priority:"
 msgstr "Priorita p?_ehr?v?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:251
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:250
 msgid "Prioritisation"
 msgstr "Priority"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:256
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:255
 msgid "_Split MPEG files every (MB):"
 msgstr "_Rozd?lovat MPEG soubory ka?d?ch (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:258
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:257
 msgid "_Use alternative tag for MP3 in .mp4"
 msgstr "_Pou??vat alternativn? zna?ku pro MP3 v .mp4"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:261
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:260
 msgid "GTK+ (slow)"
 msgstr "GTK+ (pomal?)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:262
 msgid "XVideo (best)"
 msgstr "XVideo (nejlep??)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:267
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:266
 msgid "SDL (GDI)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:268
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:267
 msgid "SDL (DirectX)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:270
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:269
 msgid "SDL (good)"
 msgstr "SDL (dobr?)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:274
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:273
 msgid "Video _display:"
 msgstr "_Video v?stup:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:279
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:278
 msgid "No alerts"
 msgstr "??dn?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:280
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:279
 msgid "Display only error alerts"
 msgstr "Pouze chybov? hl??ky"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:281
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:280
 msgid "Display all alerts"
 msgstr "V?echny"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:283
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:282
 msgid "_Message level:"
 msgstr "Z_obrazovat zpr?vy:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:486
 msgid "PCM"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
 msgid "Master"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:290
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
 msgid "_Volume control:"
 msgstr "_Ovlada? hlasitosti ovl?d?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:295
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:294
 msgid "No downmixing"
 msgstr "??dn? smixov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:296
 msgid "Pro Logic"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:298
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:297
 msgid "Pro Logic II"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:300
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:299
 msgid "_Local playback downmixing:"
 msgstr "_Lok?ln? smixov?n? p?ehr?v?n?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:332
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:310
+msgid "Core Audio"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:316
+msgid "JACK"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:325
+msgid "Win32"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:330
 msgid "_Audio output:"
 msgstr "_Audio v?stup:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:335
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:333
 msgid "ALSA _device:"
 msgstr "AL_SA za??zen?:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:346
 msgid "De_ringing"
 msgstr "De_ringing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:349
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:347
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
 #: avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp:197
 msgid "_Strength:"
 msgstr "_S?la:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:350
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
 msgid "Default Postprocessing"
 msgstr "V?choz? dodate?n? zpracov?n?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:362
 msgid "_Filter directory:"
 msgstr "_Adres?? s filtry:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:362
 msgid "Select filter directory"
 msgstr "Zvolte adres?? s filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:365
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:363
 msgid "_Load external filters"
 msgstr "_Na??st extern? filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:368
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:366
 msgid "Use _Global GlyphSet"
 msgstr "Pou??t _glob?ln? sadu glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:369
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 msgid "Gl_yphSet:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:374
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:372
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:98
 msgid "User Interface"
 msgstr "U?ivatelsk? prost?ed?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:378
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:376
 msgid "Automation"
 msgstr "Automatizace"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:391
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:394
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:397
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:389
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:392
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:395
 msgid "Audio"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:402
-#: avidemux/gtk_gui.cpp:2004
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:400
+#: avidemux/gtk_gui.cpp:2027
 msgid "Video"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:410
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:408
 msgid "Threading"
 msgstr "Vl?kna"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:414
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:412
 msgid "Global GlyphSet"
 msgstr "Glob?ln? sada glyf?"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:418
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:416
 msgid "External Filters"
 msgstr "Extern? filtry"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:422
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:420
 msgid "Preferences"
 msgstr "P?edvolby"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
-#, fuzzy
 msgid "Full"
-msgstr "1: Pln?"
+msgstr "Pln?"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:53
 msgid "Log"
@@ -5431,38 +5281,51 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:183
 msgid "Cannot initialize the video stream"
 msgstr "Nelze inicializovat video stream"
 
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:140
+msgid "Dummy"
+msgstr ""
+
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:149
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:174
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:176
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:203
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
 msgid "Filter init failed"
 msgstr "Selhala inicializace filtr?"
 
+#: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:201
+msgid "Encoding"
+msgstr "K?dov?n?"
+
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:179
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:215
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:212
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:335
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:419
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:233
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:332
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:214
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:337
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:421
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:227
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:326
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
 msgid "Error while encoding"
 msgstr "Chyba p?i k?dov?n?"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:224
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 msgid "KeyFrame error"
 msgstr "Chyba kl??ov?ho sn?mku"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:224
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 msgid ""
 "The beginning frame is not a key frame.\n"
 "Please move the A marker."
@@ -5470,6 +5333,10 @@
 "?vodn? sn?mek nen? kl??ov?.\n"
 "Posu?te pros?m zna?ku A."
 
+#: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
+msgid "Smart Copy"
+msgstr ""
+
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:121
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:96
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:98
@@ -5477,6 +5344,13 @@
 msgid "Cannot initiate save"
 msgstr "Nelze inicializovat ulo?en?"
 
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:134
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:109
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:111
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:223
+msgid "Saving"
+msgstr "Ukl?d?n?"
+
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
 msgid ""
 "Width is not a multiple of 8\n"
@@ -5486,7 +5360,7 @@
 "Chcete p?esto pokra?ovat?"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:127
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:399
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:401
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:100
 msgid ""
 "\n"
@@ -5495,11 +5369,21 @@
 "\n"
 "M? se znovu pou??t log soubor?"
 
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:136
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:410
+msgid "1st Pass"
+msgstr "1. pr?chod"
+
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:152
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:435
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:437
 msgid "Aborting"
 msgstr "Ukon?en?"
 
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:250
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:467
+msgid "2nd Pass"
+msgstr "2. pr?chod"
+
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:75
 msgid "Mux every N video frames"
 msgstr "Multiplexovat ka?d?ch N video sn?mk?"
@@ -5536,11 +5420,79 @@
 msgid "Error initalizing video filters"
 msgstr "Chyba inicializace video filtr?"
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:251
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:485
+msgid "DTS"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:487
+msgid "MP2"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:488
+msgid "MP3"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:489
+msgid "WMA"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:490
+msgid "LPCM"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:491
+msgid "AC3"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:492
+msgid "Ogg Vorbis"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:494
+msgid "AAC"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:495
+msgid "QDM2"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:496
+msgid "AMR-NB"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:497
+msgid "MSADPCM"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:498
+msgid "ULAW"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:499
+msgid "IMA ADPCM"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:500
+msgid "8-bit PCM"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:502
+msgid "Unknown codec"
+msgstr "Nezn?m? kodek"
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:253
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:248
 msgid "Cannot initialize the audio stream"
 msgstr "Nelze inicializovat audio stream"
 
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:111
+msgid "Pass one"
+msgstr "1. pr?chod"
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:139
+msgid "Pass 2"
+msgstr "2. pr?chod"
+
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:126
 msgid "Could not initialize video"
 msgstr "Inicializace videa se nezda?ila"
@@ -5549,6 +5501,10 @@
 msgid "Could not initialize audio"
 msgstr "Inicializace zvuku se nezda?ila"
 
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:70
+msgid "Saving..."
+msgstr "Ukl?d?n?..."
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:142
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:153
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:94
@@ -5569,38 +5525,98 @@
 msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
 msgstr "Pro DVD mus? b?t audio 48kHz MP2, AC3 nebo LPCM."
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:260
+msgid "libmpeg2enc VCD"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:263
+msgid "libmpeg2enc SVCD"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:266
+msgid "libmpeg2enc DVD"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:269
+msgid "FFmpeg MPEG-1 VBR"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:272
+msgid "FFmpeg MPEG-2 SVCD VBR"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:275
+msgid "FFmpeg MPEG-2 DVD VBR"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:278
+msgid "MPEG Requantizer"
+msgstr "MPEG rekvantiz?r"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:286
+msgid "MPEG ES"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:287
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:230
+msgid "MPEG TS"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:288
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:231
+msgid "MPEG VCD"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:289
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:232
+msgid "MPEG SVCD"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:290
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:233
+msgid "MPEG DVD"
+msgstr ""
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:305
 msgid "Reuse log file ?"
 msgstr "Pou??t existuj?c? log soubor?"
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:311
+msgid "Pass 1/2"
+msgstr ""
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:320
 msgid "Error in pass 1"
 msgstr "Chyba v prvn?m pr?chodu"
 
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:371
+msgid "Pass 2/2"
+msgstr ""
+
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:463
 msgid "Error in pass 2"
 msgstr "Chyba ve druh?m pr?chodu"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Unsupported video"
-msgstr ""
+msgstr "Nepodporovan? video"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Only FLV1 and VP6 video are supported"
-msgstr ""
+msgstr "Podporovan? je pouze FLV1 a VP6 video."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Unsupported audio"
-msgstr ""
+msgstr "Nepodporovan? audio"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
 msgid "Audio must be mp3 for flv output."
-msgstr ""
+msgstr "Pro FLV v?stup mus? b?t audio MP3."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
-msgstr ""
+msgstr "Frekvence mus? b?t 44100, 22050 nebo 11025 Hz."
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
 msgid "This is not MPEG compatible"
@@ -5622,6 +5638,10 @@
 msgid "For DVD, audio must be 48 kHz MP2(stereo), AC3, DTS or LPCM (stereo)."
 msgstr "Pro DVD mus? b?t audio 48kHz MP2 (stereo), AC3, DTS nebo LPCM (stereo)."
 
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:222
+msgid "---"
+msgstr ""
+
 #: avidemux/ADM_filter/filter_saveload.cpp:155
 msgid "Problem reading XML filters"
 msgstr "Chyba ?ten? XML filtr?"
@@ -5643,9 +5663,8 @@
 msgstr "Nenalezen uzel"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:54
-#, fuzzy
 msgid "Crop"
-msgstr "Kopie"
+msgstr ""
 
 #: avidemux/ADM_filter/filter_declaration.cpp:54
 msgid "Remove lines from top/bottom/left/right."
@@ -5722,506 +5741,532 @@
 msgid "Fade in/out."
 msgstr "Postupn? ztmaven?/zesv?tlen?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:69
+#: avidemux/ADM_filter/filter_declaration.cpp:70
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:186
 msgid "yadif"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:69
+#: avidemux/ADM_filter/filter_declaration.cpp:70
 msgid "Yet Another DeInterlacer. Ported from MPlayer."
 msgstr "Filtr na prokl?dan? obraz portovan? z MPlayeru."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:70
+#: avidemux/ADM_filter/filter_declaration.cpp:71
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:119
 msgid "mcDeinterlace"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:70
+#: avidemux/ADM_filter/filter_declaration.cpp:71
 msgid "Motion compensation deinterlacer. Ported from MPlayer."
 msgstr "Filtr na proklad s kompenzac? pohybu. Portovan? z MPlayeru."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:71
+#: avidemux/ADM_filter/filter_declaration.cpp:72
 msgid "Deinterlace"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:71
+#: avidemux/ADM_filter/filter_declaration.cpp:72
 msgid "Mask interlacing artifacts. Port of Smart deinterlace."
 msgstr "Maskuje artefakty prokl?d?n?. Port filtru Smart deinterlace."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:72
+#: avidemux/ADM_filter/filter_declaration.cpp:73
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:100
 msgid "KernelDeint"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:72
+#: avidemux/ADM_filter/filter_declaration.cpp:73
 msgid "Kernel deinterlacer by Donald Graft."
 msgstr "Filtr na prokl?dan? obraz od Donalda Grafta."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:73
+#: avidemux/ADM_filter/filter_declaration.cpp:74
 msgid "Motion adaptative deinterlacer by Tritical."
 msgstr "Filtr prokl?dan?ho obrazu s pohybovou adaptac?. Autorem je Tritical."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:74
+#: avidemux/ADM_filter/filter_declaration.cpp:75
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:119
 msgid "libavcodec deinterlacer"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:74
+#: avidemux/ADM_filter/filter_declaration.cpp:75
 msgid "All FFmpeg deinterlace filters (bicubic, median, ...)."
 msgstr "V?echny filtry prokladu z FFmpegu (bikubick?, median...)"
 
-#: avidemux/ADM_filter/filter_declaration.cpp:75
+#: avidemux/ADM_filter/filter_declaration.cpp:76
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:131
 msgid "Decomb Telecide"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:75
+#: avidemux/ADM_filter/filter_declaration.cpp:76
 msgid "Great deinterlacing package including IVTC."
 msgstr "V?born? bal?k filtr? prokl?dan?ho obrazu v?etn? IVTC."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:76
+#: avidemux/ADM_filter/filter_declaration.cpp:77
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:211
 msgid "Decomb Decimate"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:76
+#: avidemux/ADM_filter/filter_declaration.cpp:77
 msgid "Useful to remove dupes left by Telecide."
 msgstr "U?ite?n? k odstran?n? duplik?t? zanechan?ch filtrem Telecide."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:77
+#: avidemux/ADM_filter/filter_declaration.cpp:78
 msgid "Pulldown"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:77
+#: avidemux/ADM_filter/filter_declaration.cpp:78
 msgid "Convert 24 fps to 30 fps by repeating fields."
 msgstr "Zm?na z 24 na 30 sn?mk? za sekundu opakov?n?m p?lsn?mk?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:79
+#: avidemux/ADM_filter/filter_declaration.cpp:80
 msgid "Bobber - convert each field into a full sized frame."
 msgstr "Bobber - p?evede ka?d? p?lsn?mek na sn?mek pln? velikosti."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:81
+#: avidemux/ADM_filter/filter_declaration.cpp:82
 msgid "PAL field shift"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:81
+#: avidemux/ADM_filter/filter_declaration.cpp:82
 msgid "Shift fields by one. Useful for some PAL movies."
 msgstr "Posune p?lsn?mky o jeden. U?ite?n? u n?kter?ch PAL film?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:82
+#: avidemux/ADM_filter/filter_declaration.cpp:83
 msgid "PAL smart"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:82
+#: avidemux/ADM_filter/filter_declaration.cpp:83
 msgid "Smartly revert non constant PAL field shift."
 msgstr "Chytr? napraven? nekonstantn?ho posunu p?lsn?mk? v PAL."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:87
+#: avidemux/ADM_filter/filter_declaration.cpp:88
 msgid "Drop"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:87
+#: avidemux/ADM_filter/filter_declaration.cpp:88
 msgid "Drop damaged fields (e.g. from VHS capture)."
 msgstr "Zahod? po?kozen? p?lsn?mky (nap?. z VHS nahr?vky)."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:88
+#: avidemux/ADM_filter/filter_declaration.cpp:89
 msgid "Swap fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:88
+#: avidemux/ADM_filter/filter_declaration.cpp:89
 msgid "Swap top and bottom fields."
 msgstr "Prohod? horn? a doln? p?lsn?mky."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:89
+#: avidemux/ADM_filter/filter_declaration.cpp:90
 msgid "Smart swap fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:89
+#: avidemux/ADM_filter/filter_declaration.cpp:90
 msgid "Smartly swap fields. Needed when field order changes."
 msgstr "Chytr? prohozen? p?lsn?mk?. Je pot?eba, kdy? se m?n? po?ad? p?lsn?mk?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:91
+#: avidemux/ADM_filter/filter_declaration.cpp:92
 msgid "Keep even fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:91
+#: avidemux/ADM_filter/filter_declaration.cpp:92
 msgid "Keep top fields. Gives a half height picture."
 msgstr "Zachov? horn? p?lsn?mky. V?sledkem je obraz polovi?n? v??ky."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:92
+#: avidemux/ADM_filter/filter_declaration.cpp:93
 msgid "Keep odd fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:92
+#: avidemux/ADM_filter/filter_declaration.cpp:93
 msgid "Keep bottom fileds. Gives a half height picture."
 msgstr "Zachov? spodn? p?lsn?mky. V?sledkem je obraz polovi?n? v??ky."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:93
+#: avidemux/ADM_filter/filter_declaration.cpp:94
 msgid "Separate fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:93
+#: avidemux/ADM_filter/filter_declaration.cpp:94
 msgid "Each field becomes full picture, half sized."
 msgstr "Ka?d? p?lsn?mek se stane pln?m sn?mkem s polovi?n? velikost?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:94
+#: avidemux/ADM_filter/filter_declaration.cpp:95
 msgid "Merge fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:94
+#: avidemux/ADM_filter/filter_declaration.cpp:95
 msgid "Merge two pictures as if they were two fields."
 msgstr "Spoj? dva obrazy tak, jako by to byly dva p?lsn?mky."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:96
+#: avidemux/ADM_filter/filter_declaration.cpp:98
+msgid "Hz Stack fields"
+msgstr ""
+
+#: avidemux/ADM_filter/filter_declaration.cpp:98
+msgid "Put botj fields side by side."
+msgstr "Um?st? oba p?lsn?mky vedle sebe."
+
+#: avidemux/ADM_filter/filter_declaration.cpp:101
 msgid "Stack fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:96
+#: avidemux/ADM_filter/filter_declaration.cpp:101
 msgid "Put two fields on top of one another."
 msgstr "Um?st? jeden p?lsn?mek nad druh?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:97
+#: avidemux/ADM_filter/filter_declaration.cpp:102
 msgid "Unstack fields"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:97
+#: avidemux/ADM_filter/filter_declaration.cpp:102
 msgid "Interleave top and bottom part of the picture."
 msgstr "Prolo?? vrchn? a spodn? ??st obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:101
+#: avidemux/ADM_filter/filter_declaration.cpp:106
 msgid "Adjust contrast, brightness, saturation and gamma."
 msgstr "?prava kontrastu, jasu, sytosti a gama."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:102
+#: avidemux/ADM_filter/filter_declaration.cpp:107
 msgid "MPlayer hue"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:102
+#: avidemux/ADM_filter/filter_declaration.cpp:107
 msgid "Adjust hue and saturation."
 msgstr "?prava odst?nu a sytosti."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:103
+#: avidemux/ADM_filter/filter_declaration.cpp:108
 msgid "Adjust contrast, brightness and colors."
 msgstr "?prava kontrastu, jasu a barev."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:104
+#: avidemux/ADM_filter/filter_declaration.cpp:109
 msgid "Luma equalizer"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:104
+#: avidemux/ADM_filter/filter_declaration.cpp:109
 msgid "Luma correction filter with histogram."
 msgstr "Korekce luminance s histogramem."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:106
+#: avidemux/ADM_filter/filter_declaration.cpp:111
 msgid "Swap U and V"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:106
+#: avidemux/ADM_filter/filter_declaration.cpp:111
 msgid "Invert chroma U and chroma V."
 msgstr "Inverze chroma U a chroma V."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:107
+#: avidemux/ADM_filter/filter_declaration.cpp:112
 msgid "Chroma shift"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:107
+#: avidemux/ADM_filter/filter_declaration.cpp:112
 msgid "Shift chroma U/V to fix badly synced luma/chroma."
 msgstr "Posun U/V chrominance pro opravu ?patn? synchronizovan? luminance/chrominance."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:109
+#: avidemux/ADM_filter/filter_declaration.cpp:114
 msgid "Luma only"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:109
+#: avidemux/ADM_filter/filter_declaration.cpp:114
 msgid "Convert picture to greyscale (black and white)."
 msgstr "P?evede obraz na odst?ny ?edi (?ernob?l?)."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:110
+#: avidemux/ADM_filter/filter_declaration.cpp:115
 msgid "Chroma U only"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:110
+#: avidemux/ADM_filter/filter_declaration.cpp:115
 msgid "Convert picture to grey, keeping only chroma U."
 msgstr "P?evede obraz na ?ed?, zachov? pouze chroma U."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:111
+#: avidemux/ADM_filter/filter_declaration.cpp:116
 msgid "Chroma V only"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:111
+#: avidemux/ADM_filter/filter_declaration.cpp:116
 msgid "Convert picture to grey, keeping only chroma V."
 msgstr "P?evede obraz na ?ed?, zachov? pouze chroma V."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:113
+#: avidemux/ADM_filter/filter_declaration.cpp:118
 msgid "Luma delta"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:113
+#: avidemux/ADM_filter/filter_declaration.cpp:118
 msgid "Difference between current and previous picture."
 msgstr "Rozd?l mezi sou?asn?m a p?edchoz?m obr?zkem."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:114
+#: avidemux/ADM_filter/filter_declaration.cpp:119
 msgid "Avisynth ColorYUV"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:114
+#: avidemux/ADM_filter/filter_declaration.cpp:119
 msgid "Alter colors (auto white balance etc...). Ported from Avisynth."
 msgstr "Zm?na barev (automatick? vyv??en? b?l? atd.) Portov?no z Avisynthu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:123
+#: avidemux/ADM_filter/filter_declaration.cpp:129
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:80
 msgid "MPlayer denoise3d"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:123
+#: avidemux/ADM_filter/filter_declaration.cpp:129
 msgid "Reduce noise, smooth image, increase compressibility."
 msgstr "Redukce ?umu, vyhlazen? obrazu, zv?t?? kompresibilitu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:124
+#: avidemux/ADM_filter/filter_declaration.cpp:130
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:80
 msgid "MPlayer hqdn3d"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:124
+#: avidemux/ADM_filter/filter_declaration.cpp:130
 msgid "High quality version of denoise3d. Slower but more precise."
 msgstr "Vysokokvalitn? verze denoise3d. Pomalej??, ale p?esn?j??."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:125
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_filter/filter_declaration.cpp:131
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:125
+#: avidemux/ADM_filter/filter_declaration.cpp:131
 msgid "Spatio-temporal cleaner by Ross Thomas."
 msgstr "Prostorovo-?asov? vyhlazen? obrazu od Rosse Thomase."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:127
+#: avidemux/ADM_filter/filter_declaration.cpp:133
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:106
 msgid "Temporal Cleaner"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:127
+#: avidemux/ADM_filter/filter_declaration.cpp:133
 msgid "Vlad59's Avisynth port of Jim Casaburi's denoiser."
 msgstr "Vlad59 vytvo?il port pro Avisynth filtru ?umu od Jima Casaburiho."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:129
+#: avidemux/ADM_filter/filter_declaration.cpp:135
 msgid "Port of Transcode DNR."
 msgstr "Port filtru DNR z Transcode."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:130
+#: avidemux/ADM_filter/filter_declaration.cpp:136
 #: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:66
 msgid "Stabilize"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:130
+#: avidemux/ADM_filter/filter_declaration.cpp:136
 msgid "Light denoiser."
 msgstr "Lehk? redukce ?umu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:132
+#: avidemux/ADM_filter/filter_declaration.cpp:138
 msgid "Cnr2"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:132
+#: avidemux/ADM_filter/filter_declaration.cpp:138
 msgid "Chroma noise reduction filter by MarcFD/Tritical."
 msgstr "Redukce chrominan?n?ho ?umu, napsali MarcFD aTritical."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:134
+#: avidemux/ADM_filter/filter_declaration.cpp:140
 msgid "MSmooth by Donald Graft"
-msgstr ""
+msgstr "MSmooth Donalda Grafta"
 
-#: avidemux/ADM_filter/filter_declaration.cpp:134
+#: avidemux/ADM_filter/filter_declaration.cpp:140
 msgid "Smooth the image, don't blur edges. Useful on anime."
 msgstr "Vyhlazen? obrazu, bez rozmaz?n? obrys?. U?ite?n? na kreslen? filmy."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:135
+#: avidemux/ADM_filter/filter_declaration.cpp:141
 #: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:74
 msgid "Soften"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:135
+#: avidemux/ADM_filter/filter_declaration.cpp:141
 msgid "A variant of stabilize."
 msgstr "Varianta filtru Stabilize."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:139
+#: avidemux/ADM_filter/filter_declaration.cpp:146
 msgid "Sharpen"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:139
+#: avidemux/ADM_filter/filter_declaration.cpp:146
 msgid "Enhance difference between near pixels."
 msgstr "Zaost?? obraz zv?t?en?m rozd?lu mezi bl?zk?mi pixely."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:140
+#: avidemux/ADM_filter/filter_declaration.cpp:147
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:172
 msgid "MSharpen"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:140
+#: avidemux/ADM_filter/filter_declaration.cpp:147
 msgid "Sharpen edges without amplifying noise. By Donald Graft."
 msgstr "Zaost?? obrysy, ani? by zv?t?il ?um. Od Donalda Grafta."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:141
+#: avidemux/ADM_filter/filter_declaration.cpp:148
 msgid "asharp"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:141
+#: avidemux/ADM_filter/filter_declaration.cpp:148
 msgid "Adaptative sharpener by MarcFD."
 msgstr "Adaptivn? doost?en?, napsal MarcFD."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:143
+#: avidemux/ADM_filter/filter_declaration.cpp:150
 msgid "Gauss smooth"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:143
+#: avidemux/ADM_filter/filter_declaration.cpp:150
 msgid "Gaussian smooth. Blur the picture."
 msgstr "Gaussovo rozost?en? obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:144
+#: avidemux/ADM_filter/filter_declaration.cpp:151
 msgid "Mean"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:144
+#: avidemux/ADM_filter/filter_declaration.cpp:151
 msgid "Mean (blur) kernel."
 msgstr "Rozost?en? obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:145
+#: avidemux/ADM_filter/filter_declaration.cpp:152
 msgid "Median"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:145
+#: avidemux/ADM_filter/filter_declaration.cpp:152
 msgid "Median kernel 3x3. Remove high frequency noise."
 msgstr "Medi?nov? j?dro 3x3. Odstran? vysokofrekven?n? ?um."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:146
+#: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median (5x5)"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:146
+#: avidemux/ADM_filter/filter_declaration.cpp:153
 msgid "Median kernel 5x5. Good for reducing chroma noise."
 msgstr "Medi?nov? j?dro 5x5. Dobr? pro redukci chrominan?n?ho ?umu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:147
+#: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Forced postprocessing"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:147
+#: avidemux/ADM_filter/filter_declaration.cpp:154
 msgid "Apply blind postprocessing."
 msgstr "Aplikuje dodate?n? zpracov?n? naslepo."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:151
+#: avidemux/ADM_filter/filter_declaration.cpp:159
 msgid "Add srt/sub subtitles to the picture."
 msgstr "P?id? srt/sub titulky do obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:152
+#: avidemux/ADM_filter/filter_declaration.cpp:160
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:95
 msgid "ASS"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:152
+#: avidemux/ADM_filter/filter_declaration.cpp:160
 msgid "Add ASS/SSA subtitles to the picture."
 msgstr "P?id? ASS/SSA titulky do obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:154
+#: avidemux/ADM_filter/filter_declaration.cpp:163
 msgid "VobSub"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:154
+#: avidemux/ADM_filter/filter_declaration.cpp:163
 msgid "Embed VobSub subtitles into picture."
 msgstr "Vlo?en? VobSub titulk? do obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:156
+#: avidemux/ADM_filter/filter_declaration.cpp:165
 msgid "DVB sub"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:156
+#: avidemux/ADM_filter/filter_declaration.cpp:165
 msgid "Embed DVB-T subtitle."
 msgstr "Vlo?en? DVB-T titulk?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:163
+#: avidemux/ADM_filter/filter_declaration.cpp:176
 msgid "Blend remover"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:163
+#: avidemux/ADM_filter/filter_declaration.cpp:176
 msgid "Remove blend between previous and next picture."
 msgstr "Odstran? sm?s p?edchoz?ho a n?sleduj?c?ho obrazu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:164
+#: avidemux/ADM_filter/filter_declaration.cpp:177
 msgid "Hard pulldown removal"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:164
+#: avidemux/ADM_filter/filter_declaration.cpp:177
 msgid "Remove IVTC that has been analog captured or resized."
 msgstr "Odstran? IVTC, kter? bylo zachyceno analogov? nebo byla zm?n?na velikost."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:165
+#: avidemux/ADM_filter/filter_declaration.cpp:178
 msgid "Whirl"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:165
+#: avidemux/ADM_filter/filter_declaration.cpp:178
 msgid "Useless whirlwind effect."
 msgstr "Bez??eln? efekt v?ru."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:166
+#: avidemux/ADM_filter/filter_declaration.cpp:179
 #: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:98
 msgid "Mosaic"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:166
+#: avidemux/ADM_filter/filter_declaration.cpp:179
 msgid "Split the picture into tiny thumbnails."
 msgstr "Rozd?l? obraz do mal?ch n?hled?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:167
+#: avidemux/ADM_filter/filter_declaration.cpp:180
 msgid "MPlayer delogo"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:167
+#: avidemux/ADM_filter/filter_declaration.cpp:180
 msgid "Blend a logo by interpolating its surrounding box."
 msgstr "Vyma?e logo interpolac? jeho okol?."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:168
+#: avidemux/ADM_filter/filter_declaration.cpp:181
 #: avidemux/ADM_videoFilter/ADM_vidLogo.cpp:95
 msgid "Logo"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:168
+#: avidemux/ADM_filter/filter_declaration.cpp:181
 msgid "Add a png as logo."
 msgstr "P?id? PNG obr?zek jako logo."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:169
+#: avidemux/ADM_filter/filter_declaration.cpp:182
 msgid "Animated Menu"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:170
+#: avidemux/ADM_filter/filter_declaration.cpp:183
 msgid "Create a video made of 6 mini windows, very useful to do DVD menus."
 msgstr "Vytvo?? video z 6 mini oken, velmi u?ite?n? pro DVD menu."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:172
+#: avidemux/ADM_filter/filter_declaration.cpp:185
 msgid "Compute Average"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:172
-msgid ""
-"Compute average luma value for each pixel throughout all frames, and save to "
-"file"
+#: avidemux/ADM_filter/filter_declaration.cpp:185
+msgid "Compute average luma value for each pixel throughout all frames, and save to file"
 msgstr "Spo??t? pr?m?rnou hodnotu luminance pro ka?d? pixel ve v?ech sn?mc?ch a ulo?? ji do souboru."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:173
-msgid ""
-"Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling "
-"average, image from file, or constant"
+#: avidemux/ADM_filter/filter_declaration.cpp:186
+msgid "Eraser"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:174
+#: avidemux/ADM_filter/filter_declaration.cpp:186
+msgid "\"Erase\" arbitrary areas of each frame"
+msgstr "\"Vyma?e\" libovoln? m?sta ka?d?ho sn?mku."
+
+#: avidemux/ADM_filter/filter_declaration.cpp:187
+msgid "Swiss Army Knife"
+msgstr ""
+
+#: avidemux/ADM_filter/filter_declaration.cpp:187
+msgid "Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant"
+msgstr ""
+
+#: avidemux/ADM_filter/filter_declaration.cpp:188
 msgid "Force too-bright/too-dim pixels to 0 and the rest to 255 or vice-versa"
 msgstr "Zm?n? p??li? sv?tl?/tmav? pixely na 0 a zbytek na 255 nebo naopak."
 
-#: avidemux/ADM_filter/filter_declaration.cpp:175
+#: avidemux/ADM_filter/filter_declaration.cpp:189
 msgid "Particle List"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_declaration.cpp:175
+#: avidemux/ADM_filter/filter_declaration.cpp:189
 msgid "Identify 'particles' (groups of pixels)"
 msgstr "Identifikuje \"??stice\" (skupiny pixel?)."
 
+#: avidemux/ADM_editor/ADM_edit.cpp:82
+msgid ""
+"Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n"
+"\n"
+"You can do it later with \"Audio -> Build VBR Time Map\"."
+msgstr ""
+"Avidemux v tomto souboru detekoval VBR MP3 audio. Pro udr?en? synchronn?ho obrazu a zvuku je pot?eba ?asov? mapa. M?m ji te? sestavit?\n"
+"\n"
+"M??ete to ud?lat pozd?ji z nab?dky  \"Audio -> Sestavit ?asovou mapu VBR\"."
+
 #: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Identifikov?n typ souboru, ale nedetekov?na podpora na?ten?"
@@ -6237,16 +6282,12 @@
 
 #: avidemux/ADM_editor/ADM_edit.cpp:439
 msgid ""
-"You cannot mix different video dimensions yet. Using the partial video "
-"filter later, will not work around this problem. The workaround is:\n"
-"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same "
-"resolution\n"
+"You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
+"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
 "2.) concatinate them together"
 msgstr ""
-"Zat?m nem??ete m?chat r?zn? rozm?ry obrazu. Pozd?j?? pou?it? ??ste?n?ho "
-"filtru tento probl?m obejde. Do?asn? ?e?en? tedy je:\n"
-"1) Zm?na velikosti, p?id?n? ?ern?ch okraj? nebo o?ez ka?d?ho souboru na "
-"stejn? rozli?en?\n"
+"Zat?m nem??ete m?chat r?zn? rozm?ry obrazu. Pozd?j?? pou?it? ??ste?n?ho filtru tento probl?m obejde. Do?asn? ?e?en? tedy je:\n"
+"1) Zm?na velikosti, p?id?n? ?ern?ch okraj? nebo o?ez ka?d?ho souboru na stejn? rozli?en?\n"
 "2) Spojit je dohromady"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:551
@@ -6258,74 +6299,70 @@
 msgstr "Sestavit ?asovou mapu?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
-msgstr "Pou??t tento re?im"
+msgid "Use safe mode"
+msgstr "Pou??t bezpe?n? re?im"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
+msgid "H.264 detected"
 msgstr "Detekov?no H.264"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or "
-"stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME "
-"ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
-"Pokud soubor pou??v? B sn?mky jako referenci, m??e to v?st k p?du programu "
-"nebo trh?n?.\n"
-"Avidemux m??e pou??t jin? re?im kter? je bezpe?n?, ale <b>p?ijdete o "
-"p?esnost na sn?mky</b>.\n"
+"Pokud soubor pou??v? B sn?mky jako referenci, m??e to v?st k p?du programu nebo trh?n?.\n"
+"Avidemux m??e pou??t jin? re?im, kter? je bezpe?n?, ale <b>p?ijdete o p?esnost na sn?mky</b>.\n"
 "Chcete pou??t tento re?im?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:712
+#: avidemux/ADM_editor/ADM_edit.cpp:715
 msgid "Packed Bitstream detected"
 msgstr "Detekov?n zabalen? bitstream"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:713
+#: avidemux/ADM_editor/ADM_edit.cpp:716
 msgid "Do you want me to unpack it ?"
 msgstr "Chcete jej rozbalit?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:733
+#: avidemux/ADM_editor/ADM_edit.cpp:736
 msgid "Could not unpack the video"
 msgstr "Nelze rozbalit video"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:733
+#: avidemux/ADM_editor/ADM_edit.cpp:736
 msgid "Using backup decoder - not frame accurate."
 msgstr "Pou?ije se z?lo?n? dekod?r - nen? p?esn? na sn?mky."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:738
+#: avidemux/ADM_editor/ADM_edit.cpp:741
 msgid "Weird"
 msgstr "Divn?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:738
+#: avidemux/ADM_editor/ADM_edit.cpp:741
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "Rozbalen? se zda?ilo, ale index st?le nen? aktu?ln?."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:744
+#: avidemux/ADM_editor/ADM_edit.cpp:747
 msgid "Troubles ahead"
 msgstr "P?ijdou probl?my"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:744
+#: avidemux/ADM_editor/ADM_edit.cpp:747
 msgid "This a VOP packed AVI."
 msgstr "Toto je AVI se zabalen?m VOP."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:755
+#: avidemux/ADM_editor/ADM_edit.cpp:758
 msgid "Index is not up to date"
 msgstr "Index nen? aktu?ln?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:755
+#: avidemux/ADM_editor/ADM_edit.cpp:758
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "M?li byste pou??t N?stroje->Sestavit sn?mky. M?m to nyn? ud?lat?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1510
+#: avidemux/ADM_editor/ADM_edit.cpp:1520
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
 msgstr "Vypad? to jako MPEG. Chcete jej indexovat?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1562
+#: avidemux/ADM_editor/ADM_edit.cpp:1572
 msgid "Indexing failed"
 msgstr "Indexace selhala"
 
@@ -6349,15 +6386,15 @@
 msgid "Aborted"
 msgstr "Ukon?eno"
 
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:75
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:74
 msgid "Unsupported"
 msgstr "Nepodporov?no"
 
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:300
 msgid "Old format project file"
 msgstr "Star? form?t souboru s projektem"
 
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:300
 msgid "No more supported."
 msgstr "Ji? nen? podporov?n."
 
@@ -6391,18 +6428,16 @@
 msgstr ""
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:519
-#, fuzzy
 msgid "Float"
-msgstr "_Form?t:"
+msgstr ""
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:537
 msgid "Toggle"
 msgstr ""
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:558
-#, fuzzy
 msgid "No Strategy"
-msgstr "??dn?"
+msgstr "??dn? strategie"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:559
 msgid "3:2 Pulldown"
@@ -6418,9 +6453,8 @@
 msgstr "NTSC konvertovan? z PAL"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:563
-#, fuzzy
 msgid "menu"
-msgstr "m"
+msgstr ""
 
 #: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
 msgid "Metrics"
@@ -6556,14 +6590,84 @@
 msgid "DGBob"
 msgstr ""
 
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:191
+msgid "Erase"
+msgstr "Mazat"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:192
+msgid "Un-Erase"
+msgstr "Obnovovat"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:196
+msgid "1x1"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:197
+msgid "3x3"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:198
+msgid "5x5"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:199
+msgid "7x7"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:200
+msgid "9x9"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:201
+msgid "11x11"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:202
+msgid "15x15"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:203
+msgid "21x21"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:207
+msgid "Brush _Mode:"
+msgstr "_Re?im ?t?tce:"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:211
+msgid "Brush _Size:"
+msgstr "_Velikost ?t?tce:"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:244
+msgid "Output \"_Color\" for all masked pixels:"
+msgstr "_V?stupn? \"barva\" pro v?echny maskovan? pixely:"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:250
+msgid "Eraser _Data File:"
+msgstr "_Datov? soubor Eraseru:"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:250
+msgid "Select data file"
+msgstr "Zvolte datov? soubor"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:255
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:196
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:378
+#: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:159
+msgid "_Debugging settings (bits):"
+msgstr "La_d?c? nastaven? (bity):"
+
+#: avidemux/ADM_videoFilter/ADM_vidEraser.cpp:261
+msgid "Eraser Configuration"
+msgstr "Eraser"
+
 #: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
 msgid "_Try reverse"
 msgstr "Zkusit _opa?n?"
 
 #: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:80
-#, fuzzy
 msgid "Pal Field Shift"
-msgstr "Aktivovat ?asov? posun"
+msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
 msgid "_Luma temporal threshold:"
@@ -6578,18 +6682,16 @@
 msgstr "Postupn? ztmaven?"
 
 #: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-#, fuzzy
 msgid "Fade out"
-msgstr "Ztmaven?/zesv?tlen?"
+msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
 msgid "In"
 msgstr "Postupn? zesv?tlen?"
 
 #: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-#, fuzzy
 msgid "Fade in"
-msgstr "Ztmaven?/zesv?tlen?"
+msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidFade.cpp:71
 msgid "_Fade type:"
@@ -6624,9 +6726,7 @@
 msgstr "Pr?h prolnut?"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:83
-msgid ""
-"If value is smaller than threshold it is considered valid.Smaller value "
-"might mean more false positive."
+msgid "If value is smaller than threshold it is considered valid.Smaller value might mean more false positive."
 msgstr "Pokud je hodnota men?? ne? pr?h, je to pova?ov?no za spr?vn?. Men?? hodnota m??e znamenat v?ce nespr?vn?ch detekc?."
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
@@ -6746,9 +6846,8 @@
 msgstr "_Automatick? ?rovn?"
 
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:81
-#, fuzzy
 msgid "Forced Postprocessing"
-msgstr "_Dodate?n? zpracov?n?"
+msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:163
 msgid "_Mask"
@@ -6759,29 +6858,24 @@
 msgstr "_Vysok? kvalita"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:104
-#, fuzzy
 msgid "Fast"
-msgstr "0-rychl?"
+msgstr "Rychl?"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:105
-#, fuzzy
 msgid "Medium"
-msgstr "_M?dium:"
+msgstr "St?edn?"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:106
-#, fuzzy
 msgid "Slow iterative motion search"
-msgstr "2- pomal?, iterativn? odhah pohybu"
+msgstr "Pomal? iterativn? odhah pohybu"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:107
-#, fuzzy
 msgid "Extra slow (same as 3+multiple reference frames)"
-msgstr "3-extra pomal?, stejn? jako [2] + v?ce referen?n?ch sn?mk?"
+msgstr "Extra pomal? (stejn? jako 3 + v?ce referen?n?ch sn?mk?)"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:114
-#, fuzzy
 msgid "_Field dominance:"
-msgstr "Dominance p?lsn?mk?:"
+msgstr "_Dominance p?lsn?mk?:"
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:115
 msgid "_Qp:"
@@ -6808,35 +6902,40 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:181
 msgid "_Start Frame (first frame # to include in average):"
-msgstr ""
+msgstr "_Po??te?n? sn?mek (prvn?, kter? je zahrnut v pr?m?ru):"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:185
 msgid "_End Frame (last frame # to include), -1 = last:"
-msgstr ""
+msgstr "_Kone?n? sn?mek (posledn? zahrnut? do pr?m?ru):"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:191
+msgid "_Output File:"
+msgstr "V?stupn? s_oubor:"
+
+#: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:189
 msgid "Select output file"
 msgstr "Zvolte v?stupn? soubor"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:192
 msgid "_Bias (only for display; use 0 for average, 128 for frame minus average):"
-msgstr ""
+msgstr "O_dchylka (pouze pro zobrazen?, 0 pro pr?m?r, 128 pro sn?mek m?nus pr?m?r):"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:196
 msgid "Current frame minus average so far"
-msgstr ""
+msgstr "Aktu?ln? sn?mek m?nus dosavadn? pr?m?r"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:197
 msgid "Average so far"
-msgstr ""
+msgstr "Dosavadn? pr?m?r"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:199
 msgid "Display nothing (fast for batch processing)"
-msgstr ""
+msgstr "Nezobrazit nic (rychl? pro d?vkov? zpracov?n?)"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:203
 msgid "Display _Mode:"
-msgstr ""
+msgstr "_Re?im zobrazen?:"
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:208
 msgid "ComputeAverage"
@@ -6864,58 +6963,61 @@
 msgid "_Blend"
 msgstr "_Prolnut?"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:122
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:135
 msgid "New format, preferred, good for Tracker3D"
 msgstr "Nov? form?t, preferovan?, dobr? pro Tracker3D"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:124
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:137
+msgid "DG at UWA format (includes shape info & bounding box)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:139
+msgid "AB at ODU format (includes shape info)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:141
 msgid "Old format that Tracker3D can't read directly"
 msgstr "Star? form?t, kter? Tracker3D neum? ??st p??mo"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:128
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:145
 msgid "Output _Format:"
 msgstr "V?stupn? _form?t:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:153
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:170
 msgid "Mi_nimum area for a particle to be detected:"
-msgstr ""
+msgstr "Mi_nim?ln? plocha pro detekci ??stice:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:156
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:173
 msgid "Ma_ximum area for a particle to be detected:"
-msgstr ""
+msgstr "Ma_xim?ln? plocha pro detekci ??stice:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:160
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:177
 msgid "_Left side crop (ignore particles in):"
-msgstr ""
+msgstr "_Lev? o?ez:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:163
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:180
 msgid "_Right side crop (ignore particles in):"
-msgstr ""
+msgstr "_Prav? o?ez:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:166
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:183
 msgid "_Top crop (ignore particles in):"
-msgstr ""
+msgstr "_Vrchn? o?ez:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:169
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:186
 msgid "_Bottom crop (ignore particles in):"
-msgstr ""
+msgstr "_Spodn? o?ez:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:174
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:322
-#: avidemux/gtk_gui.cpp:2016 avidemux/gtk_gui.cpp:2113
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:191
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
+#: avidemux/gtk_gui.cpp:2039
+#: avidemux/gtk_gui.cpp:2136
 msgid "Select file"
 msgstr "Zvolte soubor"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:177
+#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:194
 msgid "_Camera number:"
-msgstr ""
+msgstr "??slo _kamery:"
 
-#: avidemux/ADM_videoFilter/ADM_vidParticle.cpp:179
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:372
-#: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:159
-msgid "_Debugging settings (bits):"
-msgstr "La_d?c? nastaven? (bity):"
-
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
 msgid "Discard closer"
 msgstr "Zahodit bli???"
@@ -6960,129 +7062,131 @@
 msgid "C_ycle:"
 msgstr "_Cyklus:"
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:259
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
 msgid "P' = A"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:260
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:262
 msgid "P' = P"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:261
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:263
 msgid "P' = P - A"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:262
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:264
 msgid "P' = A - P"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:263
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:265
 msgid "P' = P + A"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:264
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:266
 msgid "P' = P * A"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:265
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:267
 msgid "P' = P / A"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:266
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:268
 msgid "P' = A / P"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:267
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:269
 msgid "P' = min (P, A)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:268
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:270
 msgid "P' = max (P, A)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:273
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:275
 msgid "A = convolve(P); Load convolution kernel from file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:275
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:277
 msgid "A = pixel from image file as float; Load image from file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:277
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:279
 msgid "A = pixel from image file as integer; Load image from file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:279
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:281
 msgid "A = floating point constant value"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:281
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:283
 msgid "A = rolling average of pixel: A = A*(1-alpha)+(P*alpha)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:286
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:288
 msgid "Select _Operation on each pixel P and input A:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:291
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:293
 msgid "Input _Type:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:322
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:324
 msgid "Input _File (image or convolution kernel):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:325
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:327
 msgid ""
 "_Load Bias (added to each pixel\n"
 "in file image when loaded):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:330
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:332
 msgid ""
 "Load _Multiplier (each pixel in\n"
 "file image mult. by this when loaded):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:336
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:338
 msgid "Input _Constant:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:340
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:342
 msgid ""
 "Memory constant _alpha\n"
-"(where A = (1-alpha)*A + alpha*curr_frame):"
+"(where A = (1-alpha)*A + alpha*(curr_frame + lookahead)):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:345
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:347
+msgid "Look ahead _N frames:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:351
 msgid "Init _Start Frame (first frame # to use for head start):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:349
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:355
 msgid "Init _End Frame (last frame # to use for head start):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:353
-msgid ""
-"Init By _Rolling (compute head start using a rolling average rather than a "
-"straight average)"
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:359
+msgid "Init By _Rolling (compute head start using a rolling average rather than a straight average)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:358
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:364
 msgid "_Bias (will be added to result):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:361
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:367
 msgid "_Result Bias (added to each result pixel):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:365
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:371
 msgid ""
 "Result _Multiplier (each result pixel\n"
 "multiplied by this):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:370
+#: avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp:376
 msgid "_Histogram every N frames (0 to disable):"
 msgstr ""
 
@@ -7250,11 +7354,11 @@
 msgid "Cannot identify subtitle format"
 msgstr "Nem??u identifikovat form?t titulk?"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 msgid "_Temporal threshold:"
 msgstr "?_asov? pr?h:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 msgid "_Spatial threshold:"
 msgstr "_Prostorov? pr?h:"
 
@@ -7263,12 +7367,8 @@
 msgstr "P?idat okraje"
 
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
-msgid ""
-"If value is smaller than threshold it is considered valid. Smaller value "
-"might mean more false positive"
-msgstr ""
-"Pokud je hodnota men?? ne? pr?h, je to pova?ov?no za spr?vn?. Men?? hodnota m??e znamenat v?ce "
-"nespr?vn?ch detekc?."
+msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
+msgstr "Pokud je hodnota men?? ne? pr?h, je to pova?ov?no za spr?vn?. Men?? hodnota m??e znamenat v?ce nespr?vn?ch detekc?."
 
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
 msgid "_Identical:"
@@ -7296,7 +7396,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidThreshold.cpp:156
 msgid "Output values:"
-msgstr ""
+msgstr "V?stupn? hodnoty:"
 
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
 msgid "Smaller means more deinterlacing"
@@ -7325,16 +7425,18 @@
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:210
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:236
 msgid "Fatal Error"
-msgstr ""
+msgstr "Fat?ln? chyba"
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:210
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:236
 msgid ""
 "A fatal error has occurred.\n"
 "\n"
-"Click OK to generate debug information. This may take a few minutes to "
-"complete."
+"Click OK to generate debug information. This may take a few minutes to complete."
 msgstr ""
+"Do?lo k z?sadn? chyb?. \n"
+"\n"
+"Kliknut?m na potvrzovac? tla??tko vygenerujete lad?c? informace. To m??e chv?li trvat."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:437
 msgid "Load it"
@@ -7374,65 +7476,101 @@
 msgid "%lu seconds"
 msgstr "%lu s"
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:105
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:129
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:149
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:156
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:167 avidemux/GUI_jobs.cpp:37
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:108
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:132
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:152
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:159
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:170
+#: avidemux/GUI_jobs.cpp:37
 msgid "Oops"
 msgstr "Ouha"
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:105
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:108
 #, c-format
 msgid "can't create custom directory (%s)."
 msgstr "Nelze vytvo?it adres?? (%s)."
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:129
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:132
 #, c-format
 msgid "can't create job directory (%s)."
 msgstr "Nelze vytvo?it adres?? ?loh (%s)."
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:149
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:152
 msgid "can't determine $USERPROFILE."
 msgstr "Nelze ur?it $USERPROFILE."
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:156
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:159
 msgid "can't determine $HOME."
 msgstr "Nelze ur?it $HOME."
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:167
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:170
 msgid "Cannot create the .avidemux directory"
 msgstr "Nelze vytvo?it adres?? .avidemux"
 
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:430
+#: avidemux/gtk_gui.cpp:923
+#, c-format
+msgid "Cannot open \"%s\"."
+msgstr "Nelze otev??t \"%s\"."
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:443
+#, c-format
+msgid ""
+"%s already exists.\n"
+"\n"
+"Do you want to replace it?"
+msgstr ""
+"%s ji? existuje.\n"
+"\n"
+"Chcete jej p?epsat?"
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:470
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:484
+msgid "It is possible that you are trying to overwrite an input file!"
+msgstr "Je mo?n?, ?e se sna??te p?epsat vstupn? soubor!"
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:495
+msgid "Cannot write the file"
+msgstr "Nelze zapsat soubor"
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:495
+#, c-format
+msgid "No write access to \"%s\"."
+msgstr "Nen? povolen z?pis do \"%s\"."
+
 #: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
 msgid "Incompatible settings"
 msgstr "Nekompatibiln? nastaven?"
 
 #: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
 msgid "At the moment, the DV codec only accepts 720*576 at 25"
+msgstr "DV kodek moment?ln? akceptuje jen 720*576, 25 sn?mk? za sekundu."
+
+#: avidemux/ADM_encoder/adm_encRequant.cpp:98
+msgid "Requant"
 msgstr ""
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:192
+#: avidemux/ADM_encoder/adm_encConfig.cpp:191
 msgid "Wrong output format"
 msgstr "?patn? v?stupn? form?t"
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:192
+#: avidemux/ADM_encoder/adm_encConfig.cpp:191
 msgid "Select MPEG as the output."
 msgstr "Jako v?stupn? form?t zvolte MPEG."
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:197
+#: avidemux/ADM_encoder/adm_encConfig.cpp:196
 msgid "Wrong video codec"
 msgstr "Nespr?vn? video kodek"
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:198
+#: avidemux/ADM_encoder/adm_encConfig.cpp:197
 msgid "Select DVD as the video codec for MPEG TS output."
 msgstr "Pro MPEG TS v?stup zvolte jako video kodek DVD."
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:718
+#: avidemux/ADM_encoder/adm_encConfig.cpp:717
 msgid "Only QCIF and subQCIF are allowed for H.263"
 msgstr "Pro H.263 je povoleno pouze QCIF a subQCIF."
 
-#: avidemux/ADM_encoder/adm_encConfig.cpp:910
+#: avidemux/ADM_encoder/adm_encConfig.cpp:909
 msgid "Fatal error"
 msgstr "Fat?ln? chyba"
 
@@ -7462,7 +7600,7 @@
 msgid "No stts table"
 msgstr "Nen? stts tabulka"
 
-#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:583
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:594
 msgid "Problem reading SVQ3 headers"
 msgstr "Chyba ?ten? hlavi?ky SVQ3"
 
@@ -7484,7 +7622,7 @@
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:370
 msgid "Opening MPEG"
-msgstr ""
+msgstr "Otev?r?m MPEG"
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:539
 msgid "MPEG renumbering error"
@@ -7501,7 +7639,7 @@
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
 msgid "Opening Nuppel video"
-msgstr ""
+msgstr "Otev?r?m NuppelVideo"
 
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
 msgid "Sure you want to abort ?"
@@ -7528,19 +7666,36 @@
 msgid "Could not read \"%s\"."
 msgstr "Nelze otev??t \"%s\"."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 msgid "Output file error"
 msgstr "Chyba v?stupn?ho souboru"
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "Nelze otev??t \"%s\" pro z?pis."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:105
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Input file error"
+msgstr "Chyba vstupn?ho souboru"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+msgid "Unknown source type"
+msgstr "Nezn?m? typ zdroje"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Bitmap source failed"
+msgstr "Zdroj bitmapy selhal"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
 msgid "Problem loading sub"
 msgstr "Chyba na??t?n? titulk?"
 
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
+msgid "No subs"
+msgstr "Nejsou titulky"
+
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "Chyba IFO"
@@ -7565,8 +7720,10 @@
 msgid "Generating VobSub file"
 msgstr "Vytv???m VobSub soubor"
 
-#: avidemux/gui_navigate.cpp:73 avidemux/gui_navigate.cpp:111
-#: avidemux/gui_navigate.cpp:387 avidemux/gui_navigate.cpp:423
+#: avidemux/gui_navigate.cpp:73
+#: avidemux/gui_navigate.cpp:111
+#: avidemux/gui_navigate.cpp:393
+#: avidemux/gui_navigate.cpp:429
 msgid "Decompressing error"
 msgstr "Dekomprima?n? chyba"
 
@@ -7574,40 +7731,44 @@
 msgid "Cannot decode next frame."
 msgstr "Nelze dek?dovat dal?? sn?mek."
 
-#: avidemux/gui_navigate.cpp:111 avidemux/gui_navigate.cpp:423
+#: avidemux/gui_navigate.cpp:111
+#: avidemux/gui_navigate.cpp:429
 msgid "Cannot decode keyframe."
 msgstr "Nelze dek?dovat kl??ov? sn?mek."
 
-#: avidemux/gui_navigate.cpp:234
+#: avidemux/gui_navigate.cpp:237
 msgid "Seeking"
-msgstr ""
+msgstr "Vyhled?v?m"
 
-#: avidemux/gui_navigate.cpp:312
+#: avidemux/gui_navigate.cpp:318
 msgid "Finding black frames"
 msgstr "Vyhled?v?m ?ern? sn?mky"
 
-#: avidemux/gui_navigate.cpp:387
+#: avidemux/gui_navigate.cpp:393
 msgid "Cannot decode the frame."
 msgstr "Nelze dek?dovat sn?mek."
 
-#: avidemux/gtk_gui.cpp:249
+#: avidemux/gtk_gui.cpp:247
 msgid "Select ECMAScript to Run"
 msgstr "Vybrat ECMAScript ke spu?t?n?"
 
-#: avidemux/gtk_gui.cpp:296 avidemux/gtk_gui.cpp:335
+#: avidemux/gtk_gui.cpp:294
+#: avidemux/gtk_gui.cpp:333
 msgid "Obsolete"
 msgstr "Zastaral?"
 
-#: avidemux/gtk_gui.cpp:363
+#: avidemux/gtk_gui.cpp:361
 msgid "Not coded in this version"
 msgstr "Nepodporov?no v t?to verzi"
 
-#: avidemux/gtk_gui.cpp:378 avidemux/gtk_gui.cpp:383 avidemux/gtk_gui.cpp:506
-#: avidemux/gtk_gui.cpp:509
+#: avidemux/gtk_gui.cpp:376
+#: avidemux/gtk_gui.cpp:381
+#: avidemux/gtk_gui.cpp:504
+#: avidemux/gtk_gui.cpp:507
 msgid "Select AVI File..."
 msgstr "Zvolte AVI soubor..."
 
-#: avidemux/gtk_gui.cpp:440
+#: avidemux/gtk_gui.cpp:438
 msgid ""
 "This is to be used to undo packed VOP on MPEG-4.\n"
 "Continue ?"
@@ -7615,132 +7776,159 @@
 "T?mto se odstran? zabalen? VOP v MPEG-4 videu.\n"
 "Chcete pokra?ovat? "
 
-#: avidemux/gtk_gui.cpp:442
+#: avidemux/gtk_gui.cpp:440
 msgid "Select AVI File to Write"
 msgstr "Zvolte AVI soubor k z?pisu"
 
-#: avidemux/gtk_gui.cpp:448
+#: avidemux/gtk_gui.cpp:446
 msgid "Select OGM File to Write"
 msgstr "Vyberte OGM soubor k z?pisu"
 
-#: avidemux/gtk_gui.cpp:452 avidemux/gtk_gui.cpp:464
+#: avidemux/gtk_gui.cpp:450
+#: avidemux/gtk_gui.cpp:462
 msgid "Select Workbench to Save"
 msgstr "Zvolte projekt k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:496
+#: avidemux/gtk_gui.cpp:494
 msgid "Select Raw File to Save"
 msgstr "Zvolte soubor k z?pisu"
 
-#: avidemux/gtk_gui.cpp:512
+#: avidemux/gtk_gui.cpp:510
 msgid "Select AVI File to Append..."
 msgstr "Vyberte AVI soubor k p?ipojen?"
 
-#: avidemux/gtk_gui.cpp:516
+#: avidemux/gtk_gui.cpp:514
 msgid "Select File to Save Audio"
 msgstr "Zvolte soubor k ulo?en? zvuku"
 
-#: avidemux/gtk_gui.cpp:550
+#: avidemux/gtk_gui.cpp:548
 msgid "Select JPEG Sequence to Save"
 msgstr "Vyberte sled JPEG soubor? k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:553
+#: avidemux/gtk_gui.cpp:551
 msgid "Select BMP to Save"
 msgstr "Vyberte BMP soubor k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:557
+#: avidemux/gtk_gui.cpp:555
 msgid "Select JPEG to Save"
 msgstr "Vyberte JPEG soubor k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:610 avidemux/gtk_gui.cpp:722
+#: avidemux/gtk_gui.cpp:608
+#: avidemux/gtk_gui.cpp:720
 msgid "Select File to Save"
 msgstr "Zvolte soubor k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:662
+#: avidemux/gtk_gui.cpp:660
 msgid "Select MP3 to Load"
 msgstr "Vyberte MP3 soubor k na?ten?"
 
-#: avidemux/gtk_gui.cpp:665
+#: avidemux/gtk_gui.cpp:663
 msgid "Select AC3 to Load"
 msgstr "Vyberte AC3 soubor k na?ten?"
 
-#: avidemux/gtk_gui.cpp:668
+#: avidemux/gtk_gui.cpp:666
 msgid "Select WAV to Load"
 msgstr "Vyberte WAV soubor k na?ten?"
 
-#: avidemux/gtk_gui.cpp:706
+#: avidemux/gtk_gui.cpp:704
 msgid "Go to Frame"
 msgstr "P?ej?t na sn?mek"
 
-#: avidemux/gtk_gui.cpp:706
+#: avidemux/gtk_gui.cpp:704
 msgid "_Go to frame:"
 msgstr "_P?ej?t na sn?mek:"
 
-#: avidemux/gtk_gui.cpp:716
+#: avidemux/gtk_gui.cpp:714
 msgid "Out of bounds"
 msgstr "Mimo meze"
 
-#: avidemux/gtk_gui.cpp:727 avidemux/gtk_gui.cpp:1915
+#: avidemux/gtk_gui.cpp:725
+#: avidemux/gtk_gui.cpp:1938
 msgid "Marker A > B"
 msgstr "Zna?ka A > B"
 
-#: avidemux/gtk_gui.cpp:727
+#: avidemux/gtk_gui.cpp:725
 msgid "Cannot copy."
 msgstr "Nelze kop?rovat."
 
-#: avidemux/gtk_gui.cpp:739
+#: avidemux/gtk_gui.cpp:737
 msgid "Something bad happened (II))"
 msgstr "P?ihodilo se n?co zl?ho (II)"
 
-#: avidemux/gtk_gui.cpp:753
+#: avidemux/gtk_gui.cpp:751
 msgid "Are you sure?"
 msgstr "Ur?it??"
 
-#: avidemux/gtk_gui.cpp:808
+#: avidemux/gtk_gui.cpp:810
+msgid "Use custom value"
+msgstr "_Pou??t vlastn? hodnotu"
+
+#: avidemux/gtk_gui.cpp:811
 msgid "Frame Rate"
 msgstr "Sn?mkov? frekvence"
 
-#: avidemux/gtk_gui.cpp:808
-msgid "_Frames per second:"
+#: avidemux/gtk_gui.cpp:811
+msgid "_Frames per second"
 msgstr "_Sn?mk? za sekundu:"
 
-#: avidemux/gtk_gui.cpp:831
+#: avidemux/gtk_gui.cpp:814
+msgid "PAL - 25 FPS"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:815
+msgid "FILM- 24 FPS"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:816
+msgid "NTSC- 30 FPS"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:818
+msgid "Standard FrameRate:"
+msgstr "_Standardn? frekvence:"
+
+#: avidemux/gtk_gui.cpp:824
+msgid "Change FrameRate"
+msgstr "Zm?na sn?mkov? frekvence"
+
+#: avidemux/gtk_gui.cpp:855
 msgid "Width is not a multiple of 8"
 msgstr "???ka nen? n?sobkem 8"
 
-#: avidemux/gtk_gui.cpp:832
+#: avidemux/gtk_gui.cpp:856
 msgid "This will make trouble for AVI files."
 msgstr "To bude probl?m u AVI soubor?."
 
-#: avidemux/gtk_gui.cpp:842
+#: avidemux/gtk_gui.cpp:866
 msgid "Rebuild all Keyframes?"
 msgstr "Sestavit v?echny kl??ov? sn?mky?"
 
-#: avidemux/gtk_gui.cpp:900
+#: avidemux/gtk_gui.cpp:923
 msgid "Permission error"
 msgstr "Chyba opr?vn?n?"
 
-#: avidemux/gtk_gui.cpp:903
+#: avidemux/gtk_gui.cpp:926
 #, c-format
 msgid "\"%s\" does not exist."
 msgstr "\"%s\" neexistuje."
 
-#: avidemux/gtk_gui.cpp:945
+#: avidemux/gtk_gui.cpp:968
 msgid "Cannot open project using the video loader."
 msgstr "Otev?en?m videa nelze otev??t projekt."
 
-#: avidemux/gtk_gui.cpp:946
+#: avidemux/gtk_gui.cpp:969
 msgid "Try 'File' -> 'Load/Run Project...'"
 msgstr "Zkuste 'Soubor' -> 'Na??st/spustit projekt...'"
 
-#: avidemux/gtk_gui.cpp:948
+#: avidemux/gtk_gui.cpp:971
 msgid "Could not open the file"
 msgstr "Nelze otev??t soubor"
 
-#: avidemux/gtk_gui.cpp:983
+#: avidemux/gtk_gui.cpp:1005
 msgid "Multiple Audio Tracks"
 msgstr "V?ce zvukov?ch stop"
 
-#: avidemux/gtk_gui.cpp:983
+#: avidemux/gtk_gui.cpp:1005
 msgid ""
 "The file you just loaded contains several audio tracks.\n"
 "Go to Audio->MainTrack to select the active one."
@@ -7748,262 +7936,276 @@
 "Na?ten? soubor obsahuje n?kolik zvukov?ch stop.\n"
 "V nab?dce Audio->Hlavn? stopa vyberte tu aktivn?."
 
-#: avidemux/gtk_gui.cpp:1046
+#: avidemux/gtk_gui.cpp:1068
 msgid "No audio decoder found for this file"
 msgstr "Nenalezen audio dekod?r pro tento soubor"
 
-#: avidemux/gtk_gui.cpp:1047
+#: avidemux/gtk_gui.cpp:1069
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
 msgstr "Ulo?en? souboru vytvo?? ?patn? AVI soubor. Ulo?en? zvuku bude fungovat."
 
-#: avidemux/gtk_gui.cpp:1106
+#: avidemux/gtk_gui.cpp:1128
 msgid "Something failed when appending"
 msgstr "P?i p?ipojov?n? n?co selhalo"
 
-#: avidemux/gtk_gui.cpp:1115 avidemux/gtk_gui.cpp:1934
+#: avidemux/gtk_gui.cpp:1137
+#: avidemux/gtk_gui.cpp:1957
 msgid "Something bad happened (II)"
 msgstr "P?ihodilo se n?co zl?ho (II)"
 
-#: avidemux/gtk_gui.cpp:1179
+#: avidemux/gtk_gui.cpp:1201
 msgid "Cannot save the audio in copy mode"
 msgstr "V kop?rovac?m re?imu toto audio nelze ulo?it"
 
-#: avidemux/gtk_gui.cpp:1179
+#: avidemux/gtk_gui.cpp:1201
 msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr "Jako audio kodek vyberte WAV PCM, jinak bude zvukov? soubor ?ist? PCM."
 
-#: avidemux/gtk_gui.cpp:1187 avidemux/gtk_gui.cpp:1544
+#: avidemux/gtk_gui.cpp:1209
+#: avidemux/gtk_gui.cpp:1567
 msgid "Saving audio"
 msgstr "Ukl?d? se zvuk"
 
-#: avidemux/gtk_gui.cpp:1264
-#, fuzzy
+#: avidemux/gtk_gui.cpp:1286
 msgid "Get Frame"
-msgstr "_N?sleduj?c? sn?mek"
+msgstr "Sn?mek"
 
-#: avidemux/gtk_gui.cpp:1264
-#, fuzzy
+#: avidemux/gtk_gui.cpp:1286
 msgid "Cannot get this frame to save"
-msgstr "Nelze zak?dovat sn?mek"
+msgstr "Nem??u dostat sn?mek k ulo?en?"
 
-#: avidemux/gtk_gui.cpp:1301
+#: avidemux/gtk_gui.cpp:1324
 msgid "Mark A > B"
 msgstr "Zna?ka A > B"
 
-#: avidemux/gtk_gui.cpp:1301
+#: avidemux/gtk_gui.cpp:1324
 msgid "Set your markers correctly."
 msgstr "Nastavte zna?ky spr?vn?."
 
-#: avidemux/gtk_gui.cpp:1310
+#: avidemux/gtk_gui.cpp:1333
 msgid "Saving as set of jpegs"
 msgstr "Ukl?d?m jako sadu JPEG soubor?"
 
-#: avidemux/gtk_gui.cpp:1316
+#: avidemux/gtk_gui.cpp:1339
 msgid "Cannot decode frame"
 msgstr "Nelze dek?dovat sn?mek"
 
-#: avidemux/gtk_gui.cpp:1316
+#: avidemux/gtk_gui.cpp:1339
 msgid "Aborting."
 msgstr "Ukon?eno."
 
-#: avidemux/gtk_gui.cpp:1327 avidemux/gtk_gui.cpp:1346
-#: avidemux/gtk_gui.cpp:2278
+#: avidemux/gtk_gui.cpp:1350
+#: avidemux/gtk_gui.cpp:1369
+#: avidemux/gtk_gui.cpp:2301
 msgid "Done"
 msgstr "Hotovo"
 
-#: avidemux/gtk_gui.cpp:1327
+#: avidemux/gtk_gui.cpp:1350
 #, c-format
 msgid "Saved %d images."
 msgstr "Po?et ulo?en?ch obr?zk?: %d"
 
-#: avidemux/gtk_gui.cpp:1329
+#: avidemux/gtk_gui.cpp:1352
 msgid "Error"
 msgstr "Chyba"
 
-#: avidemux/gtk_gui.cpp:1329
+#: avidemux/gtk_gui.cpp:1352
 msgid "Could not save all images."
 msgstr "Nelze ulo?it v?echny obr?zky"
 
-#: avidemux/gtk_gui.cpp:1346
+#: avidemux/gtk_gui.cpp:1369
 #, c-format
 msgid "Saved \"%s\"."
 msgstr "Ulo?eno \"%s\"."
 
-#: avidemux/gtk_gui.cpp:1348
+#: avidemux/gtk_gui.cpp:1371
 msgid "BMP op failed"
-msgstr ""
+msgstr "BMP operace selhala"
 
-#: avidemux/gtk_gui.cpp:1348
+#: avidemux/gtk_gui.cpp:1371
 #, c-format
 msgid "Saving %s as a BMP file failed."
 msgstr "Ulo?en? %s jako BMP souboru selhalo."
 
-#: avidemux/gtk_gui.cpp:1368 avidemux/gtk_gui.cpp:1434
+#: avidemux/gtk_gui.cpp:1391
+#: avidemux/gtk_gui.cpp:1457
 msgid "Failed to open the file"
 msgstr "Nelze otev??t soubor"
 
-#: avidemux/gtk_gui.cpp:1368 avidemux/gtk_gui.cpp:1434
+#: avidemux/gtk_gui.cpp:1391
+#: avidemux/gtk_gui.cpp:1457
 msgid "Not a WAV file?"
 msgstr "Nen? to WAV soubor?"
 
-#: avidemux/gtk_gui.cpp:1369
+#: avidemux/gtk_gui.cpp:1392
 msgid "WAV open file failed..."
 msgstr "Selhalo otev?en? WAV souboru"
 
-#: avidemux/gtk_gui.cpp:1498
+#: avidemux/gtk_gui.cpp:1521
 msgid "Cannot decompress audio frame"
 msgstr "Nelze dekomprimovat audio"
 
-#: avidemux/gtk_gui.cpp:1512
+#: avidemux/gtk_gui.cpp:1535
 msgid "Memory Error"
 msgstr "Chyba pam?ti"
 
-#: avidemux/gtk_gui.cpp:1565
+#: avidemux/gtk_gui.cpp:1588
 msgid "No frames to encode"
 msgstr "Nejsou ??dn? sn?mky k zak?dov?n?"
 
-#: avidemux/gtk_gui.cpp:1565
+#: avidemux/gtk_gui.cpp:1588
 msgid "Please check markers. Is \"A>\" == \">B\"?"
 msgstr "Zkontrolujte pros?m zna?ky. Je \"A>\" == \">B\"?"
 
-#: avidemux/gtk_gui.cpp:1704
+#: avidemux/gtk_gui.cpp:1727
 msgid "Saving raw video stream"
 msgstr "Ukl?d?m ?ist? video proud"
 
-#: avidemux/gtk_gui.cpp:1850
+#: avidemux/gtk_gui.cpp:1873
 msgid "Checking video"
 msgstr "Kontroluji video"
 
-#: avidemux/gtk_gui.cpp:1866
+#: avidemux/gtk_gui.cpp:1889
 msgid "No error found"
 msgstr "Nenalezena ??dn? chyba"
 
-#: avidemux/gtk_gui.cpp:1870
+#: avidemux/gtk_gui.cpp:1893
 #, c-format
 msgid "Errors found in %u frames"
 msgstr "Po?et sn?mk? s nalezenou chybou: %u"
 
-#: avidemux/gtk_gui.cpp:1888
+#: avidemux/gtk_gui.cpp:1911
 msgid "Cannot decompress the audio stream"
 msgstr "Nelze dekomprimovat audio stopu"
 
-#: avidemux/gtk_gui.cpp:1888
+#: avidemux/gtk_gui.cpp:1911
 msgid "Switch audio codec to Copy."
 msgstr "Zm??te audio kodek na Kopie."
 
-#: avidemux/gtk_gui.cpp:1915
+#: avidemux/gtk_gui.cpp:1938
 msgid "Cannot delete the selection."
 msgstr "Nelze smazat v?b?r."
 
-#: avidemux/gtk_gui.cpp:1920
+#: avidemux/gtk_gui.cpp:1943
 msgid "You can't remove all frames"
 msgstr "Nem??ete odstranit v?echny sn?mky"
 
-#: avidemux/gtk_gui.cpp:1996
+#: avidemux/gtk_gui.cpp:2019
 msgid "Could not get tracks info"
 msgstr "Nelze z?skat informaci o stop?ch"
 
-#: avidemux/gtk_gui.cpp:2004
+#: avidemux/gtk_gui.cpp:2027
 msgid "Take audio from video file"
 msgstr "Vz?t audio z video souboru"
 
-#: avidemux/gtk_gui.cpp:2005 avidemux/gtk_gui.cpp:2104
-#, fuzzy
+#: avidemux/gtk_gui.cpp:2028
+#: avidemux/gtk_gui.cpp:2127
 msgid "No audio"
-msgstr "Chyb? zvukov? stopa"
+msgstr "??dn? audio"
 
-#: avidemux/gtk_gui.cpp:2006 avidemux/gtk_gui.cpp:2105
+#: avidemux/gtk_gui.cpp:2029
+#: avidemux/gtk_gui.cpp:2128
 msgid "External AC3"
 msgstr "Extern? AC3"
 
-#: avidemux/gtk_gui.cpp:2006 avidemux/gtk_gui.cpp:2105
+#: avidemux/gtk_gui.cpp:2029
+#: avidemux/gtk_gui.cpp:2128
 msgid "Take audio from external AC3 file"
 msgstr "Vezme audio z extern?ho AC3 souboru"
 
-#: avidemux/gtk_gui.cpp:2007 avidemux/gtk_gui.cpp:2106
+#: avidemux/gtk_gui.cpp:2030
+#: avidemux/gtk_gui.cpp:2129
 msgid "External MP3"
 msgstr "Extern? MP3"
 
-#: avidemux/gtk_gui.cpp:2007 avidemux/gtk_gui.cpp:2106
+#: avidemux/gtk_gui.cpp:2030
+#: avidemux/gtk_gui.cpp:2129
 msgid "Take audio from external MP3 file"
 msgstr "Vezme audio z extern?ho MP3 souboru"
 
-#: avidemux/gtk_gui.cpp:2008 avidemux/gtk_gui.cpp:2107
+#: avidemux/gtk_gui.cpp:2031
+#: avidemux/gtk_gui.cpp:2130
 msgid "External WAV"
 msgstr "Extern? WAV"
 
-#: avidemux/gtk_gui.cpp:2008 avidemux/gtk_gui.cpp:2107
+#: avidemux/gtk_gui.cpp:2031
+#: avidemux/gtk_gui.cpp:2130
 msgid "Take audio from external WAV file"
 msgstr "Vezme audio z extern?ho WAV souboru"
 
-#: avidemux/gtk_gui.cpp:2012 avidemux/gtk_gui.cpp:2112
+#: avidemux/gtk_gui.cpp:2035
+#: avidemux/gtk_gui.cpp:2135
 msgid "_Audio source:"
 msgstr "Z_droj zvuku:"
 
-#: avidemux/gtk_gui.cpp:2016 avidemux/gtk_gui.cpp:2113
+#: avidemux/gtk_gui.cpp:2039
+#: avidemux/gtk_gui.cpp:2136
 msgid "_External file:"
 msgstr "_Extern? soubor:"
 
-#: avidemux/gtk_gui.cpp:2031
+#: avidemux/gtk_gui.cpp:2054
 msgid "_Track from video:"
 msgstr "_Stopa z videa:"
 
-#: avidemux/gtk_gui.cpp:2041
+#: avidemux/gtk_gui.cpp:2064
 msgid "Main Audio Track"
 msgstr "Hlavn? audio stopa"
 
-#: avidemux/gtk_gui.cpp:2047 avidemux/gtk_gui.cpp:2125
+#: avidemux/gtk_gui.cpp:2070
+#: avidemux/gtk_gui.cpp:2148
 msgid "Cannot load"
 msgstr "Nelze na??st"
 
-#: avidemux/gtk_gui.cpp:2047 avidemux/gtk_gui.cpp:2125
+#: avidemux/gtk_gui.cpp:2070
+#: avidemux/gtk_gui.cpp:2148
 msgid "The selected audio file does not exist."
 msgstr "Vybran? audio soubor neexistuje."
 
-#: avidemux/gtk_gui.cpp:2122
+#: avidemux/gtk_gui.cpp:2145
 msgid "Second Audio Track"
 msgstr "Druh? audio stopa"
 
-#: avidemux/gtk_gui.cpp:2154
+#: avidemux/gtk_gui.cpp:2177
 msgid "Error loading the MP3 file"
 msgstr "Chyba na?ten? MP3 souboru"
 
-#: avidemux/gtk_gui.cpp:2163 avidemux/gtk_gui.cpp:2185
-#: avidemux/gtk_gui.cpp:2207
+#: avidemux/gtk_gui.cpp:2186
+#: avidemux/gtk_gui.cpp:2208
+#: avidemux/gtk_gui.cpp:2230
 msgid "Second track loaded"
 msgstr "Na?tena druh? stopa"
 
-#: avidemux/gtk_gui.cpp:2177
+#: avidemux/gtk_gui.cpp:2200
 msgid "Error loading the AC3 file"
 msgstr "Chyba na?ten? AC3 souboru"
 
-#: avidemux/gtk_gui.cpp:2199
+#: avidemux/gtk_gui.cpp:2222
 msgid "Error loading the WAV file"
 msgstr "Chyba na?ten? WAV souboru"
 
-#: avidemux/gtk_gui.cpp:2266
+#: avidemux/gtk_gui.cpp:2289
 msgid "Saving failed"
 msgstr "Ulo?en? se nezda?ilo"
 
-#: avidemux/gtk_gui.cpp:2266
+#: avidemux/gtk_gui.cpp:2289
 msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
 msgstr "Selhalo ulo?en? ?lohy. Mo?n? je probl?m s p??stupov?mi pr?vy ~/.avidemux"
 
-#: avidemux/gtk_gui.cpp:2278
+#: avidemux/gtk_gui.cpp:2301
 #, c-format
 msgid "File %s has been successfully saved."
 msgstr "Soubor %s byl ?sp??n? ulo?en."
 
-#: avidemux/gtk_gui.cpp:2282
+#: avidemux/gtk_gui.cpp:2305
 #, c-format
 msgid "File %s was NOT saved correctly."
 msgstr "Soubor %s nebyl ??dn? ulo?en."
 
-#: avidemux/gtk_gui.cpp:2445
+#: avidemux/gtk_gui.cpp:2468
 msgid "AvsProxy"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2445
+#: avidemux/gtk_gui.cpp:2468
 msgid ""
 "Failed to connect to avsproxy.\n"
 "Is it running ?"
@@ -8011,19 +8213,19 @@
 "Nelze se p?ipojit k avsproxy.\n"
 "Je spu?t?no?"
 
-#: avidemux/gtk_gui.cpp:2450
+#: avidemux/gtk_gui.cpp:2473
 msgid "avsproxy"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2478
+#: avidemux/gtk_gui.cpp:2501
 msgid "Frame type:"
 msgstr "Typ sn?mku:"
 
-#: avidemux/gtk_gui.cpp:2479
+#: avidemux/gtk_gui.cpp:2502
 msgid "Frame size:"
 msgstr "Velikost sn?mku:"
 
-#: avidemux/gtk_gui.cpp:2481
+#: avidemux/gtk_gui.cpp:2504
 msgid "Frame Hex Dump"
 msgstr "Hex v?pis sn?mk?"
 
@@ -8044,24 +8246,30 @@
 msgstr "Pro vytvo?en? takov?hoto souboru je zvukov? stopa nutn?."
 
 #: avidemux/gui_autodrive.cpp:63
-msgid "You need both Xvid4 and FAAC support for Ipod profile"
-msgstr ""
+msgid "Xvid4 and FAAC support is required for the iPod profile."
+msgstr "Pro iPod profil je pot?eba podpora Xvid4 and FAAC."
 
-#: avidemux/gui_autodrive.cpp:71 avidemux/gui_autodrive.cpp:154
-msgid "Cannot select mpeg4 sp codec."
+#: avidemux/gui_autodrive.cpp:72
+msgid "Cannot select the MPEG-4 SP codec."
 msgstr "Nelze vybrat MPEG-4 SP kodek."
 
-#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:114
 msgid ""
 "You don't have LAME!.\n"
 "It is needed to create FLV  video."
 msgstr ""
+"Nem?te LAME!.\n"
+"Je pot?eba k vytvo?en? FLV videa."
 
-#: avidemux/gui_autodrive.cpp:127
+#: avidemux/gui_autodrive.cpp:128
 msgid "Cannot select FLV1  codec."
-msgstr ""
+msgstr "Nemohu zvolit FLV1 kodek."
 
-#: avidemux/gui_autodrive.cpp:189
+#: avidemux/gui_autodrive.cpp:155
+msgid "Cannot select mpeg4 sp codec."
+msgstr "Nelze vybrat MPEG-4 SP kodek."
+
+#: avidemux/gui_autodrive.cpp:190
 msgid ""
 "You don't have FAAC!.\n"
 "It is needed to create PSP compatible video."
@@ -8081,7 +8289,8 @@
 msgid "Select Copy as the video codec."
 msgstr "Jako video kodek zvolte Kopie."
 
-#: avidemux/gui_savenew.cpp:207 avidemux/gui_savenew.cpp:223
+#: avidemux/gui_savenew.cpp:207
+#: avidemux/gui_savenew.cpp:223
 #: avidemux/gui_savenew.cpp:236
 msgid "Incompatible output format"
 msgstr "Nekompatibiln? v?stupn? form?t"
@@ -8098,11 +8307,13 @@
 msgid "Select dual audio AVI to write"
 msgstr "Zvolte du?ln? AVI k ulo?en?"
 
-#: avidemux/gui_savenew.cpp:280 avidemux/gui_savenew.cpp:298
+#: avidemux/gui_savenew.cpp:280
+#: avidemux/gui_savenew.cpp:298
 msgid "This cannot have packed VOP"
 msgstr "Toto nem??e m?t zabalen? VOP"
 
-#: avidemux/gui_savenew.cpp:280 avidemux/gui_savenew.cpp:298
+#: avidemux/gui_savenew.cpp:280
+#: avidemux/gui_savenew.cpp:298
 msgid "It is not MPEG-4 video. File will not be saved."
 msgstr "Nen? to MPEG-4 video. Soubor se neulo??."
 
@@ -8114,3 +8325,92 @@
 "Mo?n? bude pot?eba Smart Copy.\n"
 "M? se aktivovat?"
 
+#~ msgid "Threshold output"
+#~ msgstr "V?stup prahu"
+#~ msgid "Final output"
+#~ msgstr "Fin?ln? v?stup"
+#~ msgid "Two pass, final size"
+#~ msgstr "Dva pr?chody, fin?ln? velikost"
+#~ msgid "Two pass, average bitrate"
+#~ msgstr "Dva pr?chody, pr?m?rn? datov? tok"
+#~ msgid "Entry input for target file size or bitrate"
+#~ msgstr "C?lov? velikost nebo datov? tok"
+#~ msgid "Quantizer (0-51):"
+#~ msgstr "Kvantiz?r (0-51):"
+#~ msgid ""
+#~ "Uses chroma (color) components for motion for compression and helps the "
+#~ "quality"
+#~ msgstr "Pou?ije chrominanci (barevnou slo?ku) pro pohyb, zlep?uje kvalitu"
+#~ msgid "Interlace"
+#~ msgstr "Prokl?dan?"
+#~ msgid ""
+#~ "Lossless compression method which usually improves the bitrate usage by "
+#~ "15% (especially on high bitrate). Helps the quality a lot but is slower. "
+#~ msgstr ""
+#~ "Bezeztr?tov? kompresn? metoda,kter? obvykle zlep?? datov? tok o 15 % "
+#~ "(zejm?na u vysok?ho datov?ho toku). V?razn? zlep?? kvalitu, ale je "
+#~ "pomalej??."
+#~ msgid ""
+#~ "Set the amount of blurring to use for block edges when they are found"
+#~ msgstr "M?ra rozmaz?n? okraj? blok? kdy? jsou nalezeny"
+#~ msgid "Define the level for when deblocking is applied"
+#~ msgstr "?rove? kdy je aplikov?n deblocking"
+#~ msgid "<i>Threshold</i>"
+#~ msgstr "<i>Pr?h</i>"
+#~ msgid "<i>Strength</i>"
+#~ msgstr "<i>S?la</i>"
+#~ msgid "Reduce fluctuations in QP (after curve compression)"
+#~ msgstr "Sn??en? v?kyvy kvantiz?r? (po kompresi k?ivky)"
+#~ msgid "Custom matrix"
+#~ msgstr "Vlastn? matice"
+
+#, fuzzy
+#~ msgid "straight"
+#~ msgstr "6- ultra vysok?"
+#~ msgid "_Debugging settings (bits):   "
+#~ msgstr "La_d?c? nastaven? (bity):   "
+
+#, fuzzy
+#~ msgid "Enable Preview"
+#~ msgstr "N?hled"
+#~ msgid "Particle Detection"
+#~ msgstr "Detekce ??stic"
+#~ msgid "Mi_nimum area for a particle to be detected:    "
+#~ msgstr "Mi_nim?ln? plocha k detekci ??stice:    "
+#~ msgid "Ma_ximum area for a particle to be detected:   "
+#~ msgstr "Ma_xim?ln? plocha k detekci ??stice:   "
+#~ msgid "_Left side crop (ignore this many pixels on the left):        "
+#~ msgstr "O?ez _lev? strany (ignorovat tolik pixel? vlevo):        "
+#~ msgid "_Right side crop (ignore this many pixels on the right):     "
+#~ msgstr "O?ez p_rav? strany (ignorovat tolik pixel? vpravo):     "
+#~ msgid "_Top crop (ignore this many pixels on the top):                  "
+#~ msgstr "_Horn? o?ez (ignorovat tolik pixel? naho?e):                  "
+#~ msgid "_Bottom crop (ignore this many pixels on the bottom):   "
+#~ msgstr "_Spodn? o?ez (ignorovat tolik pixel? dole):   "
+#~ msgid "Output _Format:   "
+#~ msgstr "V?stupn? _form?t:   "
+#~ msgid "_Camera Number for output file:      "
+#~ msgstr "??slo _kamery pro v?stupn? soubor:      "
+#~ msgid "Reset"
+#~ msgstr "Vr?tit"
+#~ msgid "Invalid filename"
+#~ msgstr "Neplatn? n?zev souboru"
+#~ msgid "Please select or enter a valid filename."
+#~ msgstr "Pros?m zvolte nebo napi?te platn? n?zev souboru."
+#~ msgid "Invalid jobname"
+#~ msgstr "Neplatn? n?zev ?lohy"
+#~ msgid "Please select or enter a valid jobname."
+#~ msgstr "Pros?m zvolte nebo napi?te platn? n?zev ?lohy."
+#~ msgid "Select the output file"
+#~ msgstr "Vyberte v?stupn? soubor"
+#~ msgid "Job name displayed in the job list and used as the script filename"
+#~ msgstr ""
+#~ "N?zev ?lohy zobrazen? v seznamu ?loh a pou?it? jako n?zev souboru se "
+#~ "skriptem"
+#~ msgid "Filename of the audio/video output"
+#~ msgstr "N?zev souboru audio/video v?stupu"
+#~ msgid "Output _file:"
+#~ msgstr "_V?stupn? soubor:"
+#~ msgid "Mjpeg Configuration"
+#~ msgstr "Nastaven? MJPEG"
+



From gruntster at mail.berlios.de  Mon Jun 23 12:39:47 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Jun 2008 12:39:47 +0200
Subject: [Avidemux-svn-commit] r4147 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory
Message-ID: <200806231039.m5NAdlUf015973@sheep.berlios.de>

Author: gruntster
Date: 2008-06-23 12:39:38 +0200 (Mon, 23 Jun 2008)
New Revision: 4147

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp
Log:
[dialogFactory] set OK button to default for GTK (FS#455)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-06-23 10:34:57 UTC (rev 4146)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-06-23 10:39:38 UTC (rev 4147)
@@ -1,306 +1,308 @@
-/***************************************************************************
-  DIA_dialogFactory.cpp
-  (C) 2006 Mean Fixounet at free.fr 
-***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include <config.h>
-
-
-#include <string.h>
-#include <stdio.h>
-#include <math.h>
-
-#include "default.h"
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_commonUI/DIA_factory.h"
-#include "ADM_assert.h"
-
-
-static uint8_t  buildOneTab(GtkWidget *nb,int index, diaElemTabs *tab);
-static uint8_t  readOneTab(int index, diaElemTabs *tab);
-
-
-/**
-    \fn addLine(diaElem *elem, GtkDialog *dialog, GtkWidget *vbox)
-    \brief setup an line with the element given as parameter
-    @return nothing
-
-*/
-void addLine(diaElem *elem, GtkWidget *dialog, GtkWidget *vbox,uint32_t line)
-{
-            elem->setMe( (void *)dialog,(void *)vbox,line);
-  
-}
-/**
-    \fn getLine(diaElem *elem, GtkDialog *dialog, GtkWidget *vbox)
-    \brief read back an line with the element given as parameter
-    @return nothing
-
-*/
-void getLine(diaElem *elem, GtkWidget *dialog, GtkWidget *vbox,uint32_t line)
-{
-  
-             elem->getMe();
-  
-}
-/**
-    \fn diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
-    \brief  Run a dialog made of nb elems, each elem being described in the **elems
-    @return 0 on failure, 1 on success
-*/
-
-uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
-{
-  uint8_t ret=0;
-  ADM_assert(elems);
-  ADM_assert(nb);
-  ADM_assert(title);
-  
-  /* First there was a dialog ...*/
-  GtkWidget *dialog=gtk_dialog_new ();
-  GtkWidget *dialog_vbox1;
-  GtkWidget *table1;
-  GtkWidget *vbox1;
-  
-  gtk_window_set_title (GTK_WINDOW (dialog),title );
-  gtk_window_set_resizable (GTK_WINDOW (dialog), FALSE);
-  gtk_container_set_border_width (GTK_CONTAINER (dialog), 6);
-  gtk_dialog_set_has_separator (GTK_DIALOG (dialog), FALSE);
-  dialog_vbox1 = GTK_DIALOG (dialog)->vbox;
-  gtk_box_set_spacing (GTK_BOX(dialog_vbox1), 12);
-  gtk_widget_show (dialog_vbox1);
-  
-  vbox1 = gtk_vbox_new (0, 18);
-  gtk_container_set_border_width (GTK_CONTAINER (vbox1), 6);
-  gtk_container_add (GTK_CONTAINER (dialog_vbox1), vbox1);
-  gtk_widget_show (vbox1);
-  
-  int line=0;
-  int i=0;  
-  while (i<nb)
-  {
-	  if (elems[i]->mySelf == ELEM_FRAME)
-	  {
-		  addLine(elems[i],dialog,vbox1,line);
-		  i++;
-	  }
-	  else
-	  {
-		  line = 0;
-		  int nbLine=0;
-		  while (i+nbLine<nb && elems[i+nbLine]->mySelf != ELEM_FRAME) 
-			  nbLine++;
-		  table1 = gtk_table_new (nbLine, 2, FALSE);
-		  gtk_table_set_col_spacings (GTK_TABLE (table1), 12);
-		  gtk_table_set_row_spacings (GTK_TABLE (table1), 6);
-		  gtk_box_pack_start (GTK_BOX(vbox1), table1, FALSE, FALSE, 0);
-		  gtk_widget_show (table1);
-                  
-		  while (i<nb && elems[i]->mySelf != ELEM_FRAME)
-		  {
-			  addLine(elems[i],dialog,table1,line);
-			  line+=elems[i]->getSize();
-			  i++;
-		  }
-	  }
-  }
-  
-  // Add a Close button
-  GtkWidget *okbutton1;
-  GtkWidget *cancelbutton1;
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
-  
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-  
+/***************************************************************************
+  DIA_dialogFactory.cpp
+  (C) 2006 Mean Fixounet at free.fr 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include <config.h>
+
+
+#include <string.h>
+#include <stdio.h>
+#include <math.h>
+
+#include "default.h"
+#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_commonUI/DIA_factory.h"
+#include "ADM_assert.h"
+
+
+static uint8_t  buildOneTab(GtkWidget *nb,int index, diaElemTabs *tab);
+static uint8_t  readOneTab(int index, diaElemTabs *tab);
+
+
+/**
+    \fn addLine(diaElem *elem, GtkDialog *dialog, GtkWidget *vbox)
+    \brief setup an line with the element given as parameter
+    @return nothing
+
+*/
+void addLine(diaElem *elem, GtkWidget *dialog, GtkWidget *vbox,uint32_t line)
+{
+            elem->setMe( (void *)dialog,(void *)vbox,line);
+  
+}
+/**
+    \fn getLine(diaElem *elem, GtkDialog *dialog, GtkWidget *vbox)
+    \brief read back an line with the element given as parameter
+    @return nothing
+
+*/
+void getLine(diaElem *elem, GtkWidget *dialog, GtkWidget *vbox,uint32_t line)
+{
+  
+             elem->getMe();
+  
+}
+/**
+    \fn diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
+    \brief  Run a dialog made of nb elems, each elem being described in the **elems
+    @return 0 on failure, 1 on success
+*/
+
+uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
+{
+  uint8_t ret=0;
+  ADM_assert(elems);
+  ADM_assert(nb);
+  ADM_assert(title);
+  
+  /* First there was a dialog ...*/
+  GtkWidget *dialog=gtk_dialog_new ();
+  GtkWidget *dialog_vbox1;
+  GtkWidget *table1;
+  GtkWidget *vbox1;
+  
+  gtk_window_set_title (GTK_WINDOW (dialog),title );
+  gtk_window_set_resizable (GTK_WINDOW (dialog), FALSE);
+  gtk_container_set_border_width (GTK_CONTAINER (dialog), 6);
+  gtk_dialog_set_has_separator (GTK_DIALOG (dialog), FALSE);
+  dialog_vbox1 = GTK_DIALOG (dialog)->vbox;
+  gtk_box_set_spacing (GTK_BOX(dialog_vbox1), 12);
+  gtk_widget_show (dialog_vbox1);
+  
+  vbox1 = gtk_vbox_new (0, 18);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox1), 6);
+  gtk_container_add (GTK_CONTAINER (dialog_vbox1), vbox1);
+  gtk_widget_show (vbox1);
+  
+  int line=0;
+  int i=0;  
+  while (i<nb)
+  {
+	  if (elems[i]->mySelf == ELEM_FRAME)
+	  {
+		  addLine(elems[i],dialog,vbox1,line);
+		  i++;
+	  }
+	  else
+	  {
+		  line = 0;
+		  int nbLine=0;
+		  while (i+nbLine<nb && elems[i+nbLine]->mySelf != ELEM_FRAME) 
+			  nbLine++;
+		  table1 = gtk_table_new (nbLine, 2, FALSE);
+		  gtk_table_set_col_spacings (GTK_TABLE (table1), 12);
+		  gtk_table_set_row_spacings (GTK_TABLE (table1), 6);
+		  gtk_box_pack_start (GTK_BOX(vbox1), table1, FALSE, FALSE, 0);
+		  gtk_widget_show (table1);
+                  
+		  while (i<nb && elems[i]->mySelf != ELEM_FRAME)
+		  {
+			  addLine(elems[i],dialog,table1,line);
+			  line+=elems[i]->getSize();
+			  i++;
+		  }
+	  }
+  }
+  
+  // Add a Close button
+  GtkWidget *okbutton1;
+  GtkWidget *cancelbutton1;
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
+  
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+  gtk_dialog_set_default_response (GTK_DIALOG (dialog), GTK_RESPONSE_OK);
+  
   gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
 										GTK_RESPONSE_OK,
 										GTK_RESPONSE_CANCEL,
-										-1);
-
-  /* Finalize them */
-  for(int i=0;i<nb;i++)
-  {
-    elems[i]->finalize();
-  }
-  
-  // Show it & run
-  gtk_register_dialog(dialog);
-  if(GTK_RESPONSE_OK==gtk_dialog_run(GTK_DIALOG(dialog)))
-  {
-    for(int i=0;i<nb;i++)
-      {
-        getLine(elems[i],dialog,table1,i);
-        
-      }
-    ret=1;  
-  }
-
-  // Cleanup
-  gtk_unregister_dialog(dialog);
-  gtk_widget_destroy(dialog);
-  return ret;
-  
-}
-/**
-    \fn   diaFactoryRun
-    \brief   Same as above but for tabbed dialog
-*/
-uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs)
-{
-  uint8_t ret=0;
-  ADM_assert(tabs);
-  ADM_assert(nb);
-  ADM_assert(title);
-  
-  /* First there was a dialog ...*/
-  GtkWidget *dialog=gtk_dialog_new ();
-  GtkWidget *dialog_vbox1;
-  GtkWidget *table1;
-  GtkWidget *notebook1;
-  
-  gtk_window_set_title (GTK_WINDOW (dialog),title );
-  gtk_window_set_resizable (GTK_WINDOW (dialog), FALSE);
-  gtk_container_set_border_width (GTK_CONTAINER (dialog), 6);
-  gtk_dialog_set_has_separator (GTK_DIALOG (dialog), FALSE);
-  dialog_vbox1 = GTK_DIALOG (dialog)->vbox;
-  gtk_box_set_spacing (GTK_BOX(dialog_vbox1), 12);
-  gtk_widget_show (dialog_vbox1);
-   // Ok  create our tabs
-  notebook1 = gtk_notebook_new ();
-  gtk_widget_show (notebook1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), notebook1, FALSE, FALSE, 0);
-  gtk_container_set_border_width (GTK_CONTAINER (notebook1), 6);
-  
-  // And fill them
-  for(int i=0;i<nb;i++)
-  {
-    buildOneTab(notebook1,i,tabs[i]); 
-  }
-  
-  diaElemTabs *itab;
-  for(int i=0;i<nb;i++)
-  {
-    itab=(tabs[i]);
-    for(int j=0;j<itab->nbElems;j++)
-    {
-      itab->dias[j]->finalize();
-    }
-  }
-  // Add a Close button
-  GtkWidget *okbutton1;
-  GtkWidget *cancelbutton1;
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
-  
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
+										-1);
+
+  /* Finalize them */
+  for(int i=0;i<nb;i++)
+  {
+    elems[i]->finalize();
+  }
+  
+  // Show it & run
+  gtk_register_dialog(dialog);
+  if(GTK_RESPONSE_OK==gtk_dialog_run(GTK_DIALOG(dialog)))
+  {
+    for(int i=0;i<nb;i++)
+      {
+        getLine(elems[i],dialog,table1,i);
+        
+      }
+    ret=1;  
+  }
+
+  // Cleanup
+  gtk_unregister_dialog(dialog);
+  gtk_widget_destroy(dialog);
+  return ret;
+  
+}
+/**
+    \fn   diaFactoryRun
+    \brief   Same as above but for tabbed dialog
+*/
+uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs)
+{
+  uint8_t ret=0;
+  ADM_assert(tabs);
+  ADM_assert(nb);
+  ADM_assert(title);
+  
+  /* First there was a dialog ...*/
+  GtkWidget *dialog=gtk_dialog_new ();
+  GtkWidget *dialog_vbox1;
+  GtkWidget *table1;
+  GtkWidget *notebook1;
+  
+  gtk_window_set_title (GTK_WINDOW (dialog),title );
+  gtk_window_set_resizable (GTK_WINDOW (dialog), FALSE);
+  gtk_container_set_border_width (GTK_CONTAINER (dialog), 6);
+  gtk_dialog_set_has_separator (GTK_DIALOG (dialog), FALSE);
+  dialog_vbox1 = GTK_DIALOG (dialog)->vbox;
+  gtk_box_set_spacing (GTK_BOX(dialog_vbox1), 12);
+  gtk_widget_show (dialog_vbox1);
+   // Ok  create our tabs
+  notebook1 = gtk_notebook_new ();
+  gtk_widget_show (notebook1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), notebook1, FALSE, FALSE, 0);
+  gtk_container_set_border_width (GTK_CONTAINER (notebook1), 6);
+  
+  // And fill them
+  for(int i=0;i<nb;i++)
+  {
+    buildOneTab(notebook1,i,tabs[i]); 
+  }
+  
+  diaElemTabs *itab;
+  for(int i=0;i<nb;i++)
+  {
+    itab=(tabs[i]);
+    for(int j=0;j<itab->nbElems;j++)
+    {
+      itab->dias[j]->finalize();
+    }
+  }
+  // Add a Close button
+  GtkWidget *okbutton1;
+  GtkWidget *cancelbutton1;
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), cancelbutton1, GTK_RESPONSE_CANCEL);
+  
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+  gtk_dialog_set_default_response (GTK_DIALOG (dialog), GTK_RESPONSE_OK);
+
   gtk_dialog_set_alternative_button_order(GTK_DIALOG(dialog),
 										GTK_RESPONSE_OK,
 										GTK_RESPONSE_CANCEL,
-										-1);
-
-  // Show it & run
-  gtk_register_dialog(dialog);
-  if(GTK_RESPONSE_OK==gtk_dialog_run(GTK_DIALOG(dialog)))
-  {
-    for(int i=0;i<nb;i++)
-    {
-      readOneTab(i,tabs[i]);
-    }
-    ret=1;
-  }
-
-  // Cleanup
-  gtk_unregister_dialog(dialog);
-  gtk_widget_destroy(dialog);
-  return ret;
-  
-}
-/**
-
-*/
-uint8_t  buildOneTab(GtkWidget *nb,int index, diaElemTabs *tab)
-{
-  GtkWidget *table1,*vbox1,*label;
-  
-  ADM_assert(tab);
-  vbox1 = gtk_vbox_new (0, 18);
-  gtk_container_set_border_width (GTK_CONTAINER (vbox1), 12);
-  gtk_container_add (GTK_CONTAINER (nb), vbox1);
-  gtk_widget_show (vbox1);
-
-  int line=0;
-  int i=0;
-  while (i<tab->nbElems)
-  {
-	  if (tab->dias[i]->mySelf == ELEM_FRAME)
-	  {
-		  addLine(tab->dias[i],nb,vbox1,line);
-		  i++;
-	  }
-	  else
-	  {
-                  line = 0;
-                  int nbLine=0;
-                   while (i+nbLine<tab->nbElems && tab->dias[i+nbLine]->mySelf != ELEM_FRAME) 
-                    nbLine++;
-                  table1 = gtk_table_new (nbLine, 2, FALSE);
-                  gtk_table_set_col_spacings (GTK_TABLE (table1), 12);
-                  gtk_table_set_row_spacings (GTK_TABLE (table1), 6);
-                  gtk_box_pack_start (GTK_BOX(vbox1), table1, FALSE, FALSE, 0);
-                  gtk_widget_show (table1);
-                  
-                  while (i<tab->nbElems && tab->dias[i]->mySelf != ELEM_FRAME)
-                  {
-                          addLine(tab->dias[i],nb,table1,line);
-						  line+=tab->dias[i]->getSize();
-						  i++;
-                  }
-	  }
-  }
-  
-
-  
-  label = gtk_label_new (tab->title);
-  gtk_widget_show (label);
-  gtk_notebook_set_tab_label (GTK_NOTEBOOK (nb), gtk_notebook_get_nth_page (GTK_NOTEBOOK (nb), index), label);
-
-  
-
-  return 1; 
-}
-/**
-
-*/
-uint8_t  readOneTab(int index, diaElemTabs *tab)
-{
-  for(int i=0;i<tab->nbElems;i++)
-  {
-    tab->dias[i]->getMe();
-  }
-  return 1; 
-}
-
-//EOF
+										-1);
+
+  // Show it & run
+  gtk_register_dialog(dialog);
+  if(GTK_RESPONSE_OK==gtk_dialog_run(GTK_DIALOG(dialog)))
+  {
+    for(int i=0;i<nb;i++)
+    {
+      readOneTab(i,tabs[i]);
+    }
+    ret=1;
+  }
+
+  // Cleanup
+  gtk_unregister_dialog(dialog);
+  gtk_widget_destroy(dialog);
+  return ret;
+  
+}
+/**
+
+*/
+uint8_t  buildOneTab(GtkWidget *nb,int index, diaElemTabs *tab)
+{
+  GtkWidget *table1,*vbox1,*label;
+  
+  ADM_assert(tab);
+  vbox1 = gtk_vbox_new (0, 18);
+  gtk_container_set_border_width (GTK_CONTAINER (vbox1), 12);
+  gtk_container_add (GTK_CONTAINER (nb), vbox1);
+  gtk_widget_show (vbox1);
+
+  int line=0;
+  int i=0;
+  while (i<tab->nbElems)
+  {
+	  if (tab->dias[i]->mySelf == ELEM_FRAME)
+	  {
+		  addLine(tab->dias[i],nb,vbox1,line);
+		  i++;
+	  }
+	  else
+	  {
+                  line = 0;
+                  int nbLine=0;
+                   while (i+nbLine<tab->nbElems && tab->dias[i+nbLine]->mySelf != ELEM_FRAME) 
+                    nbLine++;
+                  table1 = gtk_table_new (nbLine, 2, FALSE);
+                  gtk_table_set_col_spacings (GTK_TABLE (table1), 12);
+                  gtk_table_set_row_spacings (GTK_TABLE (table1), 6);
+                  gtk_box_pack_start (GTK_BOX(vbox1), table1, FALSE, FALSE, 0);
+                  gtk_widget_show (table1);
+                  
+                  while (i<tab->nbElems && tab->dias[i]->mySelf != ELEM_FRAME)
+                  {
+                          addLine(tab->dias[i],nb,table1,line);
+						  line+=tab->dias[i]->getSize();
+						  i++;
+                  }
+	  }
+  }
+  
+
+  
+  label = gtk_label_new (tab->title);
+  gtk_widget_show (label);
+  gtk_notebook_set_tab_label (GTK_NOTEBOOK (nb), gtk_notebook_get_nth_page (GTK_NOTEBOOK (nb), index), label);
+
+  
+
+  return 1; 
+}
+/**
+
+*/
+uint8_t  readOneTab(int index, diaElemTabs *tab)
+{
+  for(int i=0;i<tab->nbElems;i++)
+  {
+    tab->dias[i]->getMe();
+  }
+  return 1; 
+}
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2008-06-23 10:34:57 UTC (rev 4146)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2008-06-23 10:39:38 UTC (rev 4147)
@@ -73,7 +73,7 @@
   gtk_widget_show (hbox1);
   
   entry = gtk_entry_new ();
-  gtk_entry_set_width_chars (GTK_ENTRY (entry), 40);
+  gtk_entry_set_activates_default (GTK_ENTRY(entry), TRUE);
   gtk_widget_show (entry);
   if(param)
   {
@@ -228,6 +228,7 @@
   gtk_widget_show (hbox1);
   
   entry = gtk_entry_new ();
+  gtk_entry_set_activates_default (GTK_ENTRY(entry), TRUE);
   gtk_widget_show (entry);
   if(param)
   {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp	2008-06-23 10:34:57 UTC (rev 4146)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp	2008-06-23 10:39:38 UTC (rev 4147)
@@ -59,6 +59,7 @@
   
   int32_t val=*(int32_t *)param;
   widget = gtk_spin_button_new_with_range(min,max,1);
+  gtk_entry_set_activates_default (GTK_ENTRY(widget), TRUE);
   gtk_spin_button_set_numeric (GTK_SPIN_BUTTON(widget),TRUE);
   gtk_spin_button_set_digits  (GTK_SPIN_BUTTON(widget),0);
   gtk_spin_button_set_value (GTK_SPIN_BUTTON(widget),val);
@@ -129,6 +130,7 @@
   
   uint32_t val=*(uint32_t *)param;
   widget = gtk_spin_button_new_with_range(min,max,1);
+  gtk_entry_set_activates_default (GTK_ENTRY(widget), TRUE);
   gtk_spin_button_set_numeric (GTK_SPIN_BUTTON(widget),TRUE);
   gtk_spin_button_set_digits  (GTK_SPIN_BUTTON(widget),0);
   gtk_spin_button_set_value (GTK_SPIN_BUTTON(widget),val);
@@ -229,6 +231,7 @@
   GtkAdjustment * adj = (GtkAdjustment *) gtk_adjustment_new (val, min, max, incr, incr, 0);
 
   GtkWidget *spinner = gtk_spin_button_new (adj, 1, 0);
+  gtk_entry_set_activates_default (GTK_ENTRY(spinner), TRUE);
   gtk_spin_button_set_numeric (GTK_SPIN_BUTTON(spinner), TRUE);
   gtk_spin_button_set_digits  (GTK_SPIN_BUTTON(spinner), digits);
   

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp	2008-06-23 10:34:57 UTC (rev 4146)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp	2008-06-23 10:39:38 UTC (rev 4147)
@@ -92,6 +92,7 @@
 	spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 0);
 	gtk_widget_show (spinbutton1);
 	gtk_box_pack_start (GTK_BOX (hbox2), spinbutton1, TRUE, TRUE, 0);
+	gtk_entry_set_activates_default (GTK_ENTRY(spinbutton1), TRUE);
 
 	gtk_table_attach (GTK_TABLE (opaque), hbox1, 1, 2, line, line+1,
 					(GtkAttachOptions) (GTK_EXPAND | GTK_FILL),



From gruntster at mail.berlios.de  Mon Jun 23 14:20:53 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Jun 2008 14:20:53 +0200
Subject: [Avidemux-svn-commit] r4148 - in
	branches/avidemux_2.4_branch/avidemux: ADM_audiodevice
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200806231220.m5NCKrJC001363@sheep.berlios.de>

Author: gruntster
Date: 2008-06-23 14:20:39 +0200 (Mon, 23 Jun 2008)
New Revision: 4148

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
[Mac] increase audio output buffer for CoreAudio and SDL

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp	2008-06-23 10:39:38 UTC (rev 4147)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp	2008-06-23 12:20:39 UTC (rev 4148)
@@ -30,7 +30,7 @@
 #define MODULE_NAME  MODULE_ADEVICE
 #include "ADM_osSupport/ADM_debug.h"
 
-#define BUFFER_SIZE (2*48000)
+#define BUFFER_SIZE (500*48000)
 
 static Component comp = NULL;
 static int16_t audioBuffer[BUFFER_SIZE];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp	2008-06-23 10:39:38 UTC (rev 4147)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp	2008-06-23 12:20:39 UTC (rev 4148)
@@ -44,7 +44,13 @@
 {
 static void SDL_callback(void *userdata, Uint8 *stream, int len);
 }
+
+#ifdef __APPLE__
+#define BUFFER_SIZE (500*48000)
+#else
 #define BUFFER_SIZE (2*48000)
+#endif
+
 //_______________________________________________
 //
 //_______________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-23 10:39:38 UTC (rev 4147)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-23 12:20:39 UTC (rev 4148)
@@ -318,7 +318,7 @@
 		#ifdef OSS_SUPPORT
 			{DEVICE_OSS, QT_TR_NOOP("OSS")},
 		#endif
-		#if	defined(USE_SDL) && !defined(ADM_WIN32)
+		#if	defined(USE_SDL)
 			{DEVICE_SDL, QT_TR_NOOP("SDL")},
 		#endif
 		#ifdef ADM_WIN32



From gruntster at mail.berlios.de  Mon Jun 23 14:25:30 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Jun 2008 14:25:30 +0200
Subject: [Avidemux-svn-commit] r4149 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200806231225.m5NCPUS2001678@sheep.berlios.de>

Author: gruntster
Date: 2008-06-23 14:25:24 +0200 (Mon, 23 Jun 2008)
New Revision: 4149

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
[Mac] revert part of r4148 not intended to be committed

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-23 12:20:39 UTC (rev 4148)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-23 12:25:24 UTC (rev 4149)
@@ -318,7 +318,7 @@
 		#ifdef OSS_SUPPORT
 			{DEVICE_OSS, QT_TR_NOOP("OSS")},
 		#endif
-		#if	defined(USE_SDL)
+		#if	defined(USE_SDL) && !defined(ADM_WIN32)
 			{DEVICE_SDL, QT_TR_NOOP("SDL")},
 		#endif
 		#ifdef ADM_WIN32



From mean at mail.berlios.de  Mon Jun 23 19:23:10 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jun 2008 19:23:10 +0200
Subject: [Avidemux-svn-commit] r4150 - in
	branches/avidemux_2.4_branch/avidemux: ADM_filter ADM_video
	ADM_videoFilter
Message-ID: <200806231723.m5NHNAZx028096@sheep.berlios.de>

Author: mean
Date: 2008-06-23 19:23:01 +0200 (Mon, 23 Jun 2008)
New Revision: 4150

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidCNR2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidColorYuv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidEqualizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFieldUnblend.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidMPdelogo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAsharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBSmear.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChroma.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChromaShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidContrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDelta.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDenoise.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDropOut.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidEq2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFade.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLogo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLuma.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMosaic.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPalShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPulldown.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidReverse.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidRotate.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSoften.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidStabilize.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidTdeint.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUnblend.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVlad.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidWhirl.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp
Log:
[Buffer OVerflow] Prevent configuration string from overflowing (FS#343)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -68,10 +68,8 @@
 //********************************************
 char *ADMVideoFlipV::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," V-Flip");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" V-Flip");
+
 }
 
 ADMVideoFlipV::ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-23 17:23:01 UTC (rev 4150)
@@ -110,6 +110,10 @@
                 MAX_FILTER = VF_COUNT - 1,
                 VF_EXTERNAL_START=0xF0000000
           }VF_FILTERS;
+#define ADM_CONF_STRING_SIZE 256
+#define ADM_FILTER_DECLARE_CONF(fmt,...) {static char confString[ADM_CONF_STRING_SIZE];\
+                                    snprintf(confString,ADM_CONF_STRING_SIZE-1,fmt,## __VA_ARGS__);\
+                                    return confString;} 
 
 typedef AVDMGenericVideoStream *(ADM_createT) (AVDMGenericVideoStream *in, CONFcouple *);
 typedef AVDMGenericVideoStream *(ADM_create_from_scriptT) (AVDMGenericVideoStream *in, int n,Arg *args);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidCNR2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidCNR2.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidCNR2.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -111,9 +111,8 @@
 /*************************************/
 char *vidCNR2::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " CNR2 by MarcFD/Tritical");
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" CNR2 by MarcFD/Tritical");
+  
 }
 /*************************************/
 vidCNR2::vidCNR2 (AVDMGenericVideoStream * in, CONFcouple * couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidColorYuv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidColorYuv.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidColorYuv.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -95,9 +95,8 @@
 
 char *ADMVideoColorYuv::printConf( void )
 {
-   static char buf[50];
-   sprintf((char *)buf," ColorYuv ");
-   return buf;
+  ADM_FILTER_DECLARE_CONF(" ColorYuv ");
+   
 }
 
 ADMVideoColorYuv::ADMVideoColorYuv(AVDMGenericVideoStream *in,CONFcouple *couples) 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidEqualizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidEqualizer.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidEqualizer.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -53,9 +53,8 @@
 
 char *vidEqualizer::printConf( void )
 {
- 	static char buf[50];
- 	sprintf((char *)buf," Equalizer");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Equalizer");
+        
 }
 
 vidEqualizer::vidEqualizer(AVDMGenericVideoStream *in,CONFcouple *couples) 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFieldUnblend.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFieldUnblend.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFieldUnblend.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -96,9 +96,8 @@
 /*************************************/
 char *vidHardPDRemoval::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Field Unblend Thresh:%d Noise:%d",_param->threshold,_param->noise);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Field Unblend Thresh:%d Noise:%d",_param->threshold,_param->noise);
+  
 }
 
 #define MAX_BLOCKS 50

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidMPdelogo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidMPdelogo.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidMPdelogo.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -78,11 +78,11 @@
 
 char *ADMVideoMPdelogo::printConf( void )
 {
-        static char buf[50];
+  
 
-        sprintf((char *)buf," MPlayer delogo : at (%d,%d) (%dx%d)",
+        ADM_FILTER_DECLARE_CONF(" MPlayer delogo : at (%d,%d) (%dx%d)",
                                 _param->xoff,_param->yoff,_param->lw,_param->lh);
-        return buf;
+  
 }
 //_______________________________________________________________
 ADMVideoMPdelogo::ADMVideoMPdelogo(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -127,10 +127,8 @@
 //*************************************************************
 char *ADMVideoLavPPDeint::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Lavcodec PP deinterlacer autolev:%d deint:%d",_param->autolevel,_param->deintType);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Lavcodec PP deinterlacer autolev:%d deint:%d",_param->autolevel,_param->deintType);
+
 }
 //*************************************************************
 ADMVideoLavPPDeint::ADMVideoLavPPDeint(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -55,7 +55,7 @@
 
 char *ADMVideoSubASS::printConf() 
 {
-      static char buf[50];
+      static char buf[500];
       sprintf((char *)buf," ASS/SSA Subtitles: ");
       
       char *filename = (char*)_params->subfile;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -44,14 +44,12 @@
 
 char *AVDMVideoAddBorder::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Add Borders %lu x %lu --> %lu x %lu",
+ 	ADM_FILTER_DECLARE_CONF(" Add Borders %lu x %lu --> %lu x %lu",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+        
 }
 
 AVDMVideoAddBorder::AVDMVideoAddBorder(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -64,9 +64,8 @@
 
 char *ADMVideoAnimated::printConf( void )
 {
-   static char buf[50];
-   sprintf((char *)buf," Animated Menu ");
-   return buf;
+   ADM_FILTER_DECLARE_CONF(" Animated Menu ");
+   
 }
 uint8_t ADMVideoAnimated::setup( void)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAsharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAsharp.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAsharp.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -166,11 +166,8 @@
 //________________________________________________________
 char *ASharp::printConf( void )
 {
-        static char buf[50];
-
-        ADM_assert(_param);
-        sprintf((char *)buf," ASharp (MarcFD)");
-        return buf;
+        ADM_FILTER_DECLARE_CONF(" ASharp (MarcFD)");
+        
 }
         
 //________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBSmear.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBSmear.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBSmear.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -49,14 +49,14 @@
 
 char *AVDMVideoStreamBSMear::printConf( void )
 {
- 	static char buf[50];
  	
- 	sprintf((char *)buf," Black l:%lu  r:%lu  u:%lu x d:%lu",
+ 	
+ 	ADM_FILTER_DECLARE_CONF(" Black l:%lu  r:%lu  u:%lu x d:%lu",
  				_param->left,
  					_param->right,
  					_param->top,
  					_param->bottom);
-        return buf;
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -98,9 +98,8 @@
 /*************************************/
 char *vidBlendRemoval::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Blend Removal Thresh:%d Noise:%d Ident:%d",_param->threshold,_param->noise,_param->identical);
-  return buf;
+  ADM_FILTER_DECLARE_CONF( " Blend Removal Thresh:%d Noise:%d Ident:%d",_param->threshold,_param->noise,_param->identical);
+  
 }
 
 #define MAX_BLOCKS 50

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChroma.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChroma.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChroma.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -46,10 +46,8 @@
 
 char *ADMVideoChromaU::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," chroma u only");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" chroma u only");
+        
 }
 
 //_______________________________________________________________
@@ -130,10 +128,8 @@
 
 char *ADMVideoChromaV::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," chroma v only");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" chroma v only");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChromaShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChromaShift.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidChromaShift.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -45,11 +45,9 @@
 
 char *ADMVideoChromaShift::printConf( void )
 {
- 	static char buf[50];
-
- 	snprintf((char *)buf,50," Chroma shift U:%d  V:%d",
+ 	ADM_FILTER_DECLARE_CONF(" Chroma shift U:%d  V:%d",
             _param->u,_param->v);
-        return buf;
+        
 }
 
 ADMVideoChromaShift::ADMVideoChromaShift(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidContrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidContrast.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidContrast.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -46,12 +46,9 @@
 char *
 ADMVideoContrast::printConf (void)
 {
-  static char buf[50];
-
-  ADM_assert (_param);
-  sprintf ((char *) buf, " contrast : %1.2f %d", _param->coef,
+ ADM_FILTER_DECLARE_CONF( " contrast : %1.2f %d", _param->coef,
 	   _param->offset);
-  return buf;
+  
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidCrop.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -46,14 +46,12 @@
 
 char *AVDMVideoStreamCrop::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Crop %lu x %lu --> %lu x %lu",
+ 	ADM_FILTER_DECLARE_CONF(" Crop %lu x %lu --> %lu x %lu",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -104,11 +104,7 @@
 
 char *DGbob::printConf( void )
 {
-        static char buf[50];
-
-        //ADM_assert(_param);
-        sprintf((char *)buf," DGBob mode:%d order:%d thresh:%d\n",_param->mode,_param->order,_param->thresh);
-        return buf;
+    ADM_FILTER_DECLARE_CONF("DGBob mode:%d order:%d thresh:%d\n",_param->mode,_param->order,_param->thresh);
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -221,11 +221,8 @@
 
 char *Decimate::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Decomb Decimate cycle:%d",_param->cycle);
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Decomb Decimate cycle:%d",_param->cycle);
+        
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -147,11 +147,8 @@
 
 char *Telecide::printConf( void )
 {
- 	static char buf[50];
-
-  	ADM_assert(_param); 	
- 	sprintf((char *)buf," Decomb Telecide");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Decomb Telecide");
+        
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDelta.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDelta.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDelta.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -65,9 +65,8 @@
 /*************************************/
 char *vidDelta::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Delta");
-  return buf;
+ ADM_FILTER_DECLARE_CONF( " Delta");
+  
 }
 /*************************************/
 vidDelta::vidDelta (AVDMGenericVideoStream * in, CONFcouple * couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDenoise.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDenoise.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDenoise.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -58,15 +58,13 @@
 BUILD_CREATE(denoise_create,ADMVideoDenoise);
 char *ADMVideoDenoise::printConf( void )
 {
- 	static char buf[50];
-
-  ADM_assert(_param); 	
- 	sprintf((char *)buf," Denoise : Lum :%02ld/:%02ld / Chm :%02ld/%02ld",
+ 	
+ADM_FILTER_DECLARE_CONF(" Denoise : Lum :%02ld/:%02ld / Chm :%02ld/%02ld",
   								_param->lumaLock,
           				_param->lumaThreshold,
               		_param->chromaLock,
                 	_param->chromaThreshold);
-        return buf;
+    
 }
 void buildDistMatrix( void );
 void buildDistMatrix( void )

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDropOut.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDropOut.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDropOut.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -50,10 +50,8 @@
 
 char  *ADMVideoDropOut::printConf(void)
 {
-	static char buf[50];
-
- 	sprintf((char *)buf," DropOut :%ld",*_param);
-        return buf;
+ADM_FILTER_DECLARE_CONF(" DropOut :%ld",*_param);
+        
 }
 uint8_t  GUI_getIntegerValue(int *valye, int min, int max, char *title);	
 uint8_t ADMVideoDropOut::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -59,10 +59,9 @@
 
 char *ADMVideoSubDVB::printConf() 
 {
-      static char buf[50];
-      sprintf((char *)buf," DVB Subtitle ");
+    ADM_FILTER_DECLARE_CONF(" DVB Subtitle ");
       
-      return buf;
+      
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidEq2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidEq2.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidEq2.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -81,11 +81,9 @@
 }
 char *ADMVideoEq2::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Eq2 :Cont:%1.2f Brigh:%1.2f Sat:%1.2f",
+ ADM_FILTER_DECLARE_CONF(" Eq2 :Cont:%1.2f Brigh:%1.2f Sat:%1.2f",
                 _param->contrast,_param->brightness,_param->saturation);
-  return buf;
+  
 }
 
 ADMVideoEq2::ADMVideoEq2(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFade.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFade.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFade.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -94,12 +94,7 @@
 
 char *AVDM_Fade::printConf( void )
 {
-  static char buf[50];
-
-        //ADM_assert(_param);
-  sprintf((char *)buf," Fade : Start %u End %u",_param->startFade,_param->endFade);
-  if(_param->inOut) strcat(buf," In"); else strcat(buf," Out");
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Fade : Start %u End %u",_param->startFade,_param->endFade);
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -44,10 +44,8 @@
 
 char *ADMVideoFlipV::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," V-Flip");
-        return buf;
+    ADM_FILTER_DECLARE_CONF(" V-Flip");
+        
 }
 
 ADMVideoFlipV::ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -105,10 +105,8 @@
 }
 char *ADMVideoForcedPP::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Forced pp : %lu %lu",_param->postProcType,_param->postProcStrength);
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Forced pp : %lu %lu",_param->postProcType,_param->postProcStrength);
+        
 }
 
 ADMVideoForcedPP::~ADMVideoForcedPP()

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -103,9 +103,8 @@
 /*************************************/
 char *vidHardPDRemoval::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Field Unblend Thresh:%d Noise:%d",_param->threshold,_param->noise);
-  return buf;
+ ADM_FILTER_DECLARE_CONF( " Field Unblend Thresh:%d Noise:%d",_param->threshold,_param->noise);
+  
 }
 static void hint(ADMImage *img)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHue.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidHue.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -102,10 +102,8 @@
 }
 char *ADMVideoHue::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Hue :%2.2f %2.2f",_param->hue,_param->saturation);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Hue :%2.2f %2.2f",_param->hue,_param->saturation);
+  
 }
 
 ADMVideoHue::ADMVideoHue(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -114,10 +114,8 @@
 }
 char *ADMVideoKernelDeint::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," D Graft Kernel Deint");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" D Graft Kernel Deint");
+        
 }
 
 ADMVideoKernelDeint::~ADMVideoKernelDeint()

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLogo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLogo.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLogo.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -76,9 +76,8 @@
 //***********************************
 char *ADMVideoLogo::printConf() 
 {
-      static char buf[50];
-      snprintf((char *)buf,50,"Logo at %u %u, alpha %u",_param->x,_param->y);;
-      return buf;
+    ADM_FILTER_DECLARE_CONF("Logo at %u %u, alpha %u",_param->x,_param->y);;
+      
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLuma.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLuma.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidLuma.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -45,10 +45,8 @@
 
 char *ADMVideoLuma::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Luma only");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Luma only");
+        
 }
 
 ADMVideoLuma::ADMVideoLuma(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -52,11 +52,9 @@
 
  char 	*ADMVideoMPD3D::printConf(void)
  {
-	  	static char buf[50];
-
- 				sprintf((char *)buf," MPlayer HQ Denoise 3D (%2.1f - %2.1f - %2.1f)'",
+	  	ADM_FILTER_DECLARE_CONF(" MPlayer HQ Denoise 3D (%2.1f - %2.1f - %2.1f)'",
 						_param->param1,_param->param2,_param->param3);
-        return buf;
+        
 }
 
 uint8_t ADMVideoMPD3D::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -52,11 +52,9 @@
 
  char 	*ADMVideoMPD3Dlow::printConf(void)
  {
-	  	static char buf[50];
-
- 				sprintf((char *)buf," MPlayer Denoise 3D (%2.1f - %2.1f - %2.1f)'",
+	  ADM_FILTER_DECLARE_CONF(" MPlayer Denoise 3D (%2.1f - %2.1f - %2.1f)'",
 						_param->param1,_param->param2,_param->param3);
-        return buf;
+        
 }
 
 uint8_t ADMVideoMPD3Dlow::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -210,17 +210,13 @@
 }
 char *AVDMVideoStreamMPResize::printConf( void )
 {
- 	 #define STRING_BUF 100
- 	static char buf[STRING_BUF+1];
-
-
- 	snprintf((char *)buf,STRING_BUF," MPL Resize %u x %u --> %u x %u (%s)",
+ 	ADM_FILTER_DECLARE_CONF(" MPL Resize %u x %u --> %u x %u (%s)",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height,
 				algs[_param->algo].name);
-        return buf;
+        
 }
 //_______________________________________________________________
 AVDMVideoStreamMPResize::AVDMVideoStreamMPResize(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -180,11 +180,8 @@
 //________________________________________________________
 char *Msharpen::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Donald Graft Msharpen Strength:%d Threshold:%d",_param->strength,_param->threshold);
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Donald Graft Msharpen Strength:%d Threshold:%d",_param->strength,_param->threshold);
+        
 }
 	
 //________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -93,10 +93,8 @@
 
 char *AVDMVideoMCDeint::printConf( void )
 {
-static char buf[50];
-
-        sprintf((char *)buf," MC deinterlacer : Mode %d, qp %d, parity %d ",_param->mode,_param->qp,_param->initial_parity);
-        return buf;
+    ADM_FILTER_DECLARE_CONF(" MC deinterlacer : Mode %d, qp %d, parity %d ",_param->mode,_param->qp,_param->initial_parity);
+        
 }
 uint8_t AVDMVideoMCDeint::configure(AVDMGenericVideoStream * instream)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMosaic.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMosaic.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMosaic.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -179,12 +179,10 @@
 }
 char *ADMVideoMosaic::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," Mosaic : %d hz, %d vz, %d shrink factor",
+     ADM_FILTER_DECLARE_CONF(" Mosaic : %d hz, %d vz, %d shrink factor",
                                 _in->getInfo()->width,
                                 _param->hz,_param->vz,_param->shrink);
-        return buf;
+        
 }
 //_______________________________________________________________
 ADMVideoMosaic::ADMVideoMosaic(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -204,11 +204,8 @@
 //________________________________________________________
 char *Msmooth::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Donald Graft MSmooth");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Donald Graft MSmooth");
+        
 }
 	
 //________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPalShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPalShift.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPalShift.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -44,10 +44,8 @@
 
 char *ADMVideoPalShift::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," PAL field shift");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" PAL field shift");
+        
 }
 
 ADMVideoPalShift::ADMVideoPalShift(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPulldown.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPulldown.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidPulldown.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -51,10 +51,8 @@
 
 char *ADMVideoPullDown::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Pulldown");
-        return buf;
+    ADM_FILTER_DECLARE_CONF(" Pulldown");
+    
 }
 //_______________________________________________________________
 ADMVideoPullDown::ADMVideoPullDown(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -98,11 +98,9 @@
 }
 char *ADMVideoResampleFPS::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Resample to %2.2f fps (blend:%d)",(double)_param->newfps/1000.,
+ ADM_FILTER_DECLARE_CONF(" Resample to %2.2f fps (blend:%d)",(double)_param->newfps/1000.,
                 _param->use_linear);
-  return buf;
+  
 }
 
 ADMVideoResampleFPS::ADMVideoResampleFPS(  AVDMGenericVideoStream *in,uint32_t target)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidResize.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -48,15 +48,12 @@
 
 char *AVDMVideoStreamResize::printConf( void )
 {
-    #define STRING_BUF 100
- 	static char buf[STRING_BUF+1];
-
- 	snprintf((char *)buf,STRING_BUF," Resize %u x %u --> %u x %u ",
+  ADM_FILTER_DECLARE_CONF(" Resize %u x %u --> %u x %u ",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+        
 }
 //_______________________________________________________________
 AVDMVideoStreamResize::AVDMVideoStreamResize(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidReverse.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidReverse.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidReverse.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -60,11 +60,8 @@
 
 char *AVDM_Reverse::printConf( void )
 {
-  static char buf[50];
-
-        //ADM_assert(_param);
-  sprintf((char *)buf," Reverse");
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Reverse");
+  
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidRotate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidRotate.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidRotate.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -63,10 +63,8 @@
 
 char *ADMVideoRotate::printConf( void )
 {
-  static char buf[50];
- 	
-  sprintf((char *)buf," Rotate %u degrees", _param->angle);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Rotate %u degrees", _param->angle);
+  
 }
 
 ADMVideoRotate::ADMVideoRotate(AVDMGenericVideoStream *in, CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -61,10 +61,8 @@
 
 char 								*ADMVideoSubtitle::printConf(void)
  {
-	  	static char buf[50];
- 	
- 				sprintf((char *)buf,"Subtitle ");
-        return buf;
+	  ADM_FILTER_DECLARE_CONF("Subtitle ");
+        
 	}
 
 //--------------------------------------------------------	

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -56,10 +56,8 @@
 
 char *AVDMVideoSeparateField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Separate Fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Separate Fields");
+        
 }
 
 //_______________________________________________________________
@@ -119,10 +117,8 @@
 
 char *AVDMVideoMergeField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Merge fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Merge fields");
+        
 }
 
 //_______________________________________________________________
@@ -181,10 +177,8 @@
 
 char *AVDMVideoStackField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Stack fields");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Stack fields");
+        
 }
 
 //_______________________________________________________________
@@ -230,9 +224,8 @@
 
 char *AVDMVideoHzStackField::printConf( void )
 {
-        static char buf[50];
-        sprintf((char *)buf," Hz Stack fields");
-        return buf;
+       ADM_FILTER_DECLARE_CONF(" Hz Stack fields");
+        
 }
 
 //_______________________________________________________________
@@ -285,10 +278,8 @@
 
 char *AVDMVideoUnStackField::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," UnStack fields");
-        return buf;
+       ADM_FILTER_DECLARE_CONF(" UnStack fields");
+        
 }
 
 //______________________Unstack Fields_________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSoften.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSoften.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSoften.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -86,11 +86,9 @@
 }
 char *ADMVideoMaskedSoften::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Soften : radius: %lu l:%lu c:%lu", 
+ 	ADM_FILTER_DECLARE_CONF(" Soften : radius: %lu l:%lu c:%lu", 
 		_param->radius,_param->luma, _param->chroma);
-        return buf;
+        
 }
 
 ADMVideoMaskedSoften::~ADMVideoMaskedSoften()

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidStabilize.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidStabilize.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidStabilize.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -49,10 +49,8 @@
 
 char 	*ADMVideoStabilize::printConf(void)
 {
-  static char buf[50];
-
- 	sprintf((char *)buf," Stabilize :%ld",*_param);
-        return buf;
+  ADM_FILTER_DECLARE_CONF(" Stabilize :%ld",*_param);
+        
 }
 uint8_t  GUI_getIntegerValue(int *valye, int min, int max, char *title);
 uint8_t ADMVideoStabilize::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -54,23 +54,18 @@
 
 char *AVDMVideoSwapField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Swap fields");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Swap fields");
+        
 }
 char *AVDMVideoKeepEven::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Keep Even Fields");
-        return buf;
-}char *AVDMVideoKeepOdd::printConf( void )
+ ADM_FILTER_DECLARE_CONF(" Keep Even Fields");
+        
+}
+char *AVDMVideoKeepOdd::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Keep Odd Fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Keep Odd Fields");
+        
 }
 //_______________________________________________________________
 AVDMVideoSwapField::AVDMVideoSwapField(

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -52,10 +52,8 @@
 
 char *AVDMVideoSwapSmart::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Smart Swap fields");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Smart Swap fields");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidTdeint.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidTdeint.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidTdeint.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -178,9 +178,8 @@
 /*************************************/
 char *vidTDeint::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Tritical TDeint");
-  return buf;
+ ADM_FILTER_DECLARE_CONF( " Tritical TDeint");
+  
 }
 
 #define MAX_BLOCKS 50

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -43,10 +43,8 @@
 
 char *ADMVideoUVSwap::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," UV Swap");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" UV Swap");
+        
 }
 
 ADMVideoUVSwap::ADMVideoUVSwap(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUnblend.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUnblend.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidUnblend.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -67,9 +67,8 @@
 /*************************************/
 char *vidUnblend::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Unblend by Bach");
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Unblend by Bach");
+  
 }
 uint8_t vidUnblend::getCoupledConf (CONFcouple ** couples)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVlad.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVlad.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVlad.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -85,11 +85,9 @@
 
 char *AVDMVideoVlad::printConf(void)
 {
-	static char buf[50];
- 	
-	sprintf((char *)buf," Temporal Cleaner : Y: %02lu / c: %02lu",_param->ythresholdMask,
+	ADM_FILTER_DECLARE_CONF(" Temporal Cleaner : Y: %02lu / c: %02lu",_param->ythresholdMask,
 				_param->cthresholdMask	);
-        return buf;
+        
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -82,10 +82,8 @@
 //*************************************************************
 char *ADMVideoVobSub::printConf( void )
 {
-        static char buf[50];
+    ADM_FILTER_DECLARE_CONF(" VobSub");
         
-        sprintf((char *)buf," VobSub");
-        return buf;
 }
 //*************************************************************
 ADMVideoVobSub::ADMVideoVobSub(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidWhirl.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidWhirl.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidWhirl.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -73,10 +73,8 @@
 
 char *AVDMVideoWhirl::printConf(void)
 {
-	static char buf[50];
- 	
-	sprintf((char *)buf," Whril");
-        return buf;
+	ADM_FILTER_DECLARE_CONF(" Whril");
+        
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp	2008-06-23 12:25:24 UTC (rev 4149)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidYadif.cpp	2008-06-23 17:23:01 UTC (rev 4150)
@@ -120,10 +120,8 @@
 //***************************************************
 char *ADMVideoYadif::printConf( void )
 {
-  static char buf[50];
- 	
-  sprintf((char *)buf," Yadif : mode %u order %d",_param->mode, _param->order);
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Yadif : mode %u order %d",_param->mode, _param->order);
+ 
 }
 
 ADMVideoYadif::ADMVideoYadif(AVDMGenericVideoStream *in, CONFcouple *couples)



From mean at mail.berlios.de  Mon Jun 23 19:48:43 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jun 2008 19:48:43 +0200
Subject: [Avidemux-svn-commit] r4151 -
	branches/avidemux_2.5_branch_gruntster/avidemux
Message-ID: <200806231748.m5NHmhsj022029@sheep.berlios.de>

Author: mean
Date: 2008-06-23 19:48:42 +0200 (Mon, 23 Jun 2008)
New Revision: 4151

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
Log:
[UI] Allow setting standard fps in change framerate menu (FS#361)


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-23 17:23:01 UTC (rev 4150)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-23 17:48:42 UTC (rev 4151)
@@ -796,23 +796,46 @@
 
     case ACT_ChangeFPS:
     	{
-      	float  fps;
-	 aviInfo info;
-	 video_body->getVideoInfo (&info);
-       	fps=info.fps1000;
-	fps/=1000.;
+         float  fps;
+         aviInfo info;
+         uint32_t useDefined=0;
+         uint32_t defaultFps[3]={25000,23976,29970};
+         uint32_t index=0;
+         video_body->getVideoInfo (&info);
+         fps=info.fps1000;
+         fps/=1000.;
 
 
-      	if (DIA_GetFloatValue (&fps, 1., 60., QT_TR_NOOP("Frame Rate"),QT_TR_NOOP("_Frames per second:")))
-	{
-	
-	  info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
-	  video_body->updateVideoInfo (&info);
-	  // update display
-	  video_body->getVideoInfo (avifileinfo);
+
+        diaElemToggle togUsePredefined(&useDefined,QT_TR_NOOP("Use custom value"));
+        diaElemFloat  fpsFloatValue(&fps,QT_TR_NOOP("Frame Rate"),1.,200.,QT_TR_NOOP("_Frames per second"));
+
+        diaMenuEntry menuFps[]={
+              {0,QT_TR_NOOP("PAL - 25 FPS")},
+              {1,QT_TR_NOOP("FILM- 24 FPS")},
+              {2,QT_TR_NOOP("NTSC- 30 FPS")}};
+
+         diaElemMenu      stdFps(&index,QT_TR_NOOP("Standard FrameRate:"),3,menuFps);
+
+        togUsePredefined.link(0,&fpsFloatValue);
+        togUsePredefined.link(1,&stdFps);
+        diaElem *elems[3]={&togUsePredefined,&fpsFloatValue,&stdFps};
+        if(diaFactoryRun(QT_TR_NOOP("Change FrameRate"),3,elems))
+        {
+          if(!useDefined)
+          {
+            info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
+          }else
+          {
+            info.fps1000=defaultFps[index];
+          }
+          video_body->updateVideoInfo (&info);
+          // update display
+          video_body->getVideoInfo (avifileinfo);
           rebuild_status_bar();
-	 }
-	}
+
+        }
+	   }
       break;
       // set decoder option (post processing ...)
     case ACT_DecoderOption:



From mean at mail.berlios.de  Mon Jun 23 19:48:46 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jun 2008 19:48:46 +0200
Subject: [Avidemux-svn-commit] r4153 -
	branches/avidemux_2.5_branch_gruntster/avidemux
Message-ID: <200806231748.m5NHmkg4022050@sheep.berlios.de>

Author: mean
Date: 2008-06-23 19:48:45 +0200 (Mon, 23 Jun 2008)
New Revision: 4153

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp
Log:
[Code] Missing include (FS#349)


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp	2008-06-23 17:48:44 UTC (rev 4152)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp	2008-06-23 17:48:45 UTC (rev 4153)
@@ -1,5 +1,6 @@
-#include <stdio.h>
-#include <strings.h>
+#include "default.h"
+#include <strings.h>
+
 #include <vector>
 using std::vector;
 #include <utility>



From mean at mail.berlios.de  Mon Jun 23 19:48:44 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jun 2008 19:48:44 +0200
Subject: [Avidemux-svn-commit] r4152 -
	branches/avidemux_2.5_branch_gruntster/avidemux
Message-ID: <200806231748.m5NHmiY4022039@sheep.berlios.de>

Author: mean
Date: 2008-06-23 19:48:44 +0200 (Mon, 23 Jun 2008)
New Revision: 4152

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
Log:
[UI] std framerate pulldown fix


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-23 17:48:42 UTC (rev 4151)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-23 17:48:44 UTC (rev 4152)
@@ -798,7 +798,7 @@
     	{
          float  fps;
          aviInfo info;
-         uint32_t useDefined=0;
+         uint32_t useDefined=1;
          uint32_t defaultFps[3]={25000,23976,29970};
          uint32_t index=0;
          video_body->getVideoInfo (&info);
@@ -817,12 +817,12 @@
 
          diaElemMenu      stdFps(&index,QT_TR_NOOP("Standard FrameRate:"),3,menuFps);
 
-        togUsePredefined.link(0,&fpsFloatValue);
-        togUsePredefined.link(1,&stdFps);
+        togUsePredefined.link(1,&fpsFloatValue);
+        togUsePredefined.link(0,&stdFps);
         diaElem *elems[3]={&togUsePredefined,&fpsFloatValue,&stdFps};
         if(diaFactoryRun(QT_TR_NOOP("Change FrameRate"),3,elems))
         {
-          if(!useDefined)
+          if(useDefined)
           {
             info.fps1000 = (uint32_t) (floor (fps * 1000.+0.49));
           }else



From mean at mail.berlios.de  Mon Jun 23 19:48:56 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jun 2008 19:48:56 +0200
Subject: [Avidemux-svn-commit] r4154 - in
 branches/avidemux_2.5_branch_gruntster: avidemux/ADM_coreImage/include
 plugins/ADM_videoFilters/ASharp plugins/ADM_videoFilters/AddBorders
 plugins/ADM_videoFilters/Ass plugins/ADM_videoFilters/AvisynthResize
 plugins/ADM_videoFilters/BlackenBorders
 plugins/ADM_videoFilters/BlendRemover plugins/ADM_videoFilters/CNR2
 plugins/ADM_videoFilters/Chroma plugins/ADM_videoFilters/ChromaShift
 plugins/ADM_videoFilters/Contrast plugins/ADM_videoFilters/Crop
 plugins/ADM_videoFilters/Crop/gtk plugins/ADM_videoFilters/Crop/qt4
 plugins/ADM_videoFilters/Decimate plugins/ADM_videoFilters/Delta
 plugins/ADM_videoFilters/Denoise plugins/ADM_videoFilters/DgBob
 plugins/ADM_videoFilters/DropOut plugins/ADM_videoFilters/Eq2
 plugins/ADM_videoFilters/Equalizer plugins/ADM_videoFilters/Fade
 plugins/ADM_videoFilters/ForcedPP plugins/ADM_videoFilters/Hue
 plugins/ADM_videoFilters/KeepField plugins/ADM_videoFilters/KernelDeint
 plugins/ADM_videoFilters/LumaOnly plugins/ADM_videoFilters/MP! Delogo
 plugins/ADM_videoFilters/MSharpen plugins/ADM_videoFilters/MSmooth
 plugins/ADM_videoFilters/McDeint plugins/ADM_videoFilters/Mosaic
 plugins/ADM_videoFilters/MplayerDenoise3D
 plugins/ADM_videoFilters/MplayerResize plugins/ADM_videoFilters/PalShift
 plugins/ADM_videoFilters/Pulldown plugins/ADM_videoFilters/ResampleFps
 plugins/ADM_videoFilters/Reverse plugins/ADM_videoFilters/Rotate
 plugins/ADM_videoFilters/Soften plugins/ADM_videoFilters/Srt
 plugins/ADM_videoFilters/Stabilize plugins/ADM_videoFilters/SwapField
 plugins/ADM_videoFilters/SwapUV plugins/ADM_videoFilters/TIsophote
 plugins/ADM_videoFilters/Tdeint plugins/ADM_videoFilters/Telecide
 plugins/ADM_videoFilters/TemporalCleaner
 plugins/ADM_videoFilters/VerticalFlip plugins/ADM_videoFilters/Whirl
 plugins/ADM_videoFilters/Yadif plugins/ADM_videoFilters/colorYUV
 plugins/ADM_videoFilters/lavDeinterlace
Message-ID: <200806231748.m5NHmu40022109@sheep.berlios.de>

Author: mean
Date: 2008-06-23 19:48:51 +0200 (Mon, 23 Jun 2008)
New Revision: 4154

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ASharp/ADM_vidAsharp.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AddBorders/ADM_vidAddBorder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_vidASS.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlackenBorders/ADM_vidBlackenBorders.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlendRemover/ADM_vidBlendRemoval.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CNR2/ADM_vidCNR2.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaU.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaV.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/ADM_vidContrast.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Decimate/ADM_vidDecDec.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Delta/ADM_vidDelta.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Denoise/ADM_vidDenoise.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DgBob/ADM_vidDGbob.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DropOut/ADM_vidDropOut.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/ADM_vidEq2.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Equalizer/ADM_vidEqualizer.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Fade/ADM_vidFade.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/ADM_vidForcedPP.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Hue/ADM_vidHue.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidHzStackField.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidMergeField.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidSeparateField.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidStackField.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidUnstackField.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KernelDeint/ADM_vidKernelDeint.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/LumaOnly/ADM_vidLuma.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MPDelogo/ADM_vidMPdelogo.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen_param.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMSmooth_param.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMsmooth.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/ADM_vidMcDeint.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/ADM_vidMosaic.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3D.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3Dlow.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/ADM_vidMPLResize.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/PalShift/ADM_vidPalShift.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Pulldown/ADM_vidPulldown.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/ADM_vidResampleFPS.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Reverse/ADM_vidReverse.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Rotate/ADM_vidRotate.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Soften/ADM_vidSoften.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Stabilize/ADM_vidStabilize.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapFields.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapSmart.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapUV/ADM_vidUVSwap.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Tdeint/ADM_vidTdeint.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTel_param.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTelecide.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Whirl/ADM_vidWhirl.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Yadif/ADM_vidYadif.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/colorYUV/ADM_vidColorYuv.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/ADM_lavpp_deint.cpp
Log:
[Filter] Make sure we dont overflow in ::printConf, same fix as in 2.4


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h	2008-06-23 17:48:51 UTC (rev 4154)
@@ -68,4 +68,9 @@
 #define QT_TR_NOOP(String) String //translate ("avidemux", String)
 #define ADM_MINIMAL_UI_INTERFACE
 
+#define ADM_CONF_STRING_SIZE 256
+#define ADM_FILTER_DECLARE_CONF(fmt,...) {static char confString[ADM_CONF_STRING_SIZE];\
+                                    snprintf(confString,ADM_CONF_STRING_SIZE-1,fmt,## __VA_ARGS__);\
+                                    return confString;} 
+
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ASharp/ADM_vidAsharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ASharp/ADM_vidAsharp.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ASharp/ADM_vidAsharp.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -155,11 +155,8 @@
 //________________________________________________________
 char *ASharp::printConf( void )
 {
-        static char buf[50];
-
-        ADM_assert(_param);
-        sprintf((char *)buf," ASharp (MarcFD)");
-        return buf;
+       ADM_FILTER_DECLARE_CONF(" ASharp (MarcFD)");
+        
 }
         
 //________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AddBorders/ADM_vidAddBorder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AddBorders/ADM_vidAddBorder.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AddBorders/ADM_vidAddBorder.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -36,14 +36,12 @@
 
 char *AVDMVideoAddBorder::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Add Borders %lu x %lu --> %lu x %lu",
+ 	ADM_FILTER_DECLARE_CONF(" Add Borders %lu x %lu --> %lu x %lu",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+        
 }
 
 AVDMVideoAddBorder::AVDMVideoAddBorder(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_vidASS.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_vidASS.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Ass/ADM_vidASS.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -52,7 +52,7 @@
 
 char *ADMVideoSubASS::printConf() 
 {
-      static char buf[50];
+      static char buf[150];
       sprintf((char *)buf," ASS/SSA Subtitles: ");
       
       char *filename = (char*)_params->subfile;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -44,14 +44,12 @@
 
 char *AVDMVideoStreamResize::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Resize %lu x %lu --> %lu x %lu",
+ 	ADM_FILTER_DECLARE_CONF(" Resize %lu x %lu --> %lu x %lu",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+        
 }
 //_______________________________________________________________
 AVDMVideoStreamResize::AVDMVideoStreamResize(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlackenBorders/ADM_vidBlackenBorders.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlackenBorders/ADM_vidBlackenBorders.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlackenBorders/ADM_vidBlackenBorders.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -62,14 +62,12 @@
 //********************************************
 char *AVDMVideoStreamBSMear::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Black l:%lu  r:%lu  u:%lu x d:%lu",
+ 	ADM_FILTER_DECLARE_CONF(" Black l:%lu  r:%lu  u:%lu x d:%lu",
  				_param->left,
  					_param->right,
  					_param->top,
  					_param->bottom);
-        return buf;
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlendRemover/ADM_vidBlendRemoval.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlendRemover/ADM_vidBlendRemoval.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/BlendRemover/ADM_vidBlendRemoval.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -84,9 +84,8 @@
 /*************************************/
 char *vidBlendRemoval::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Blend Removal Thresh:%d Noise:%d Ident:%d",_param->threshold,_param->noise,_param->identical);
-  return buf;
+  ADM_FILTER_DECLARE_CONF( " Blend Removal Thresh:%d Noise:%d Ident:%d",_param->threshold,_param->noise,_param->identical);
+  
 }
 
 #define MAX_BLOCKS 50

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CNR2/ADM_vidCNR2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CNR2/ADM_vidCNR2.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/CNR2/ADM_vidCNR2.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -99,9 +99,8 @@
 /*************************************/
 char *vidCNR2::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " CNR2 by MarcFD/Tritical");
-  return buf;
+  ADM_FILTER_DECLARE_CONF( " CNR2 by MarcFD/Tritical");
+  
 }
 /*************************************/
 vidCNR2::vidCNR2 (AVDMGenericVideoStream * in, CONFcouple * couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaU.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaU.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaU.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -34,10 +34,8 @@
 
 char *ADMVideoChromaU::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," chroma u only");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" chroma u only");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaV.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaV.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Chroma/ADM_vidChromaV.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -36,10 +36,8 @@
 
 char *ADMVideoChromaV::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," chroma v only");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" chroma v only");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -39,11 +39,9 @@
                 QT_TR_NOOP("Shift chroma U/V to fix badly synced luma/chroma."));
 char *ADMVideoChromaShift::printConf( void )
 {
- 	static char buf[50];
-
- 	snprintf((char *)buf,50," Chroma shift U:%d  V:%d",
+ 	ADM_FILTER_DECLARE_CONF(" Chroma shift U:%d  V:%d",
             _param->u,_param->v);
-        return buf;
+        
 }
 
 ADMVideoChromaShift::ADMVideoChromaShift(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/ADM_vidContrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/ADM_vidContrast.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/ADM_vidContrast.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -34,12 +34,9 @@
 char *
 ADMVideoContrast::printConf (void)
 {
-  static char buf[50];
-
-  ADM_assert (_param);
-  sprintf ((char *) buf, " contrast : %1.2f %d", _param->coef,
+    ADM_FILTER_DECLARE_CONF( " contrast : %1.2f %d", _param->coef,
 	   _param->offset);
-  return buf;
+  
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -57,14 +57,12 @@
 
 char *AVDMVideoStreamCrop::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Crop %lu x %lu --> %lu x %lu",
+ 	ADM_FILTER_DECLARE_CONF(" Crop %lu x %lu --> %lu x %lu",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height);
-        return buf;
+ 
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -51,7 +51,7 @@
 //	Video is in YV12 Colorspace
 //
 //
-int DIA_getCropParams(char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
+int DIA_getCropParams(const char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
 {
 	uint32_t width, height;
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -153,7 +153,7 @@
       \fn     DIA_getCropParams
       \brief  Handle crop dialog
 */
-int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
+int DIA_getCropParams(	const char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
 {
         uint8_t ret=0;
         

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Decimate/ADM_vidDecDec.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Decimate/ADM_vidDecDec.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Decimate/ADM_vidDecDec.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -201,11 +201,8 @@
 
 char *Decimate::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Decomb Decimate cycle:%d",_param->cycle);
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Decomb Decimate cycle:%d",_param->cycle);
+ 
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Delta/ADM_vidDelta.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Delta/ADM_vidDelta.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Delta/ADM_vidDelta.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -51,9 +51,8 @@
 /*************************************/
 char *vidDelta::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Delta");
-  return buf;
+ ADM_FILTER_DECLARE_CONF( " Delta");
+  
 }
 /*************************************/
 vidDelta::vidDelta (AVDMGenericVideoStream * in, CONFcouple * couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Denoise/ADM_vidDenoise.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Denoise/ADM_vidDenoise.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Denoise/ADM_vidDenoise.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -50,15 +50,12 @@
 
 char *ADMVideoDenoise::printConf( void )
 {
- 	static char buf[50];
-
-  ADM_assert(_param); 	
- 	sprintf((char *)buf," Denoise : Lum :%02ld/:%02ld / Chm :%02ld/%02ld",
+ 	ADM_FILTER_DECLARE_CONF(" Denoise : Lum :%02ld/:%02ld / Chm :%02ld/%02ld",
   								_param->lumaLock,
           				_param->lumaThreshold,
               		_param->chromaLock,
                 	_param->chromaThreshold);
-        return buf;
+        
 }
 static uint8_t distMatrix[256][256];
 static uint32_t fixMul[16];

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DgBob/ADM_vidDGbob.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DgBob/ADM_vidDGbob.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DgBob/ADM_vidDGbob.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -98,11 +98,8 @@
 
 char *DGbob::printConf( void )
 {
-        static char buf[50];
-
-        //ADM_assert(_param);
-        sprintf((char *)buf," DGBob mode:%d order:%d thresh:%d\n",_param->mode,_param->order,_param->thresh);
-        return buf;
+      ADM_FILTER_DECLARE_CONF(" DGBob mode:%d order:%d thresh:%d\n",_param->mode,_param->order,_param->thresh);
+        
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DropOut/ADM_vidDropOut.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DropOut/ADM_vidDropOut.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/DropOut/ADM_vidDropOut.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -40,10 +40,8 @@
 
 char  *ADMVideoDropOut::printConf(void)
 {
-	static char buf[50];
-
- 	sprintf((char *)buf," DropOut :%ld",*_param);
-        return buf;
+	ADM_FILTER_DECLARE_CONF(" DropOut :%ld",*_param);
+        
 }
 uint8_t  GUI_getIntegerValue(int *valye, int min, int max, char *title);	
 uint8_t ADMVideoDropOut::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/ADM_vidEq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/ADM_vidEq2.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/ADM_vidEq2.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -70,11 +70,9 @@
 }
 char *ADMVideoEq2::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Eq2 :Cont:%1.2f Brigh:%1.2f Sat:%1.2f",
+  ADM_FILTER_DECLARE_CONF(" Eq2 :Cont:%1.2f Brigh:%1.2f Sat:%1.2f",
                 _param->contrast,_param->brightness,_param->saturation);
-  return buf;
+  
 }
 
 ADMVideoEq2::ADMVideoEq2(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Equalizer/ADM_vidEqualizer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Equalizer/ADM_vidEqualizer.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Equalizer/ADM_vidEqualizer.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -42,9 +42,8 @@
 
 char *vidEqualizer::printConf( void )
 {
- 	static char buf[50];
- 	sprintf((char *)buf," Equalizer");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Equalizer");
+        
 }
 
 vidEqualizer::vidEqualizer(AVDMGenericVideoStream *in,CONFcouple *couples) 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Fade/ADM_vidFade.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Fade/ADM_vidFade.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Fade/ADM_vidFade.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -80,7 +80,7 @@
 
 char *AVDM_Fade::printConf( void )
 {
-  static char buf[50];
+  static char buf[150];
 
         //ADM_assert(_param);
   sprintf((char *)buf," Fade : Start %u End %u",_param->startFade,_param->endFade);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/ADM_vidForcedPP.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/ADM_vidForcedPP.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/ADM_vidForcedPP.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -89,10 +89,8 @@
 }
 char *ADMVideoForcedPP::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Forced pp : %lu %lu",_param->postProcType,_param->postProcStrength);
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Forced pp : %lu %lu",_param->postProcType,_param->postProcStrength);
+        
 }
 
 ADMVideoForcedPP::~ADMVideoForcedPP()

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Hue/ADM_vidHue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Hue/ADM_vidHue.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Hue/ADM_vidHue.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -88,10 +88,8 @@
 }
 char *ADMVideoHue::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Hue :%2.2f %2.2f",_param->hue,_param->saturation);
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Hue :%2.2f %2.2f",_param->hue,_param->saturation);
+  
 }
 
 ADMVideoHue::ADMVideoHue(  AVDMGenericVideoStream *in,CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidHzStackField.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidHzStackField.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidHzStackField.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -40,9 +40,8 @@
 
 char *AVDMVideoHzStackField::printConf( void )
 {
-        static char buf[50];
-        sprintf((char *)buf," Hz Stack fields");
-        return buf;
+        ADM_FILTER_DECLARE_CONF(" Hz Stack fields");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidMergeField.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidMergeField.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidMergeField.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -42,10 +42,8 @@
 
 char *AVDMVideoMergeField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Merge fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Merge fields");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidSeparateField.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidSeparateField.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidSeparateField.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -38,10 +38,8 @@
 
 char *AVDMVideoSeparateField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Separate Fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Separate Fields");
+ 
 }
 
 //_______________________________________________________________
@@ -101,10 +99,8 @@
 
 char *AVDMVideoMergeField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Merge fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Merge fields");
+        
 }
 
 //_______________________________________________________________
@@ -163,10 +159,8 @@
 
 char *AVDMVideoStackField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Stack fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Stack fields");
+        
 }
 
 //_______________________________________________________________
@@ -212,9 +206,8 @@
 
 char *AVDMVideoHzStackField::printConf( void )
 {
-        static char buf[50];
-        sprintf((char *)buf," Hz Stack fields");
-        return buf;
+       ADM_FILTER_DECLARE_CONF(" Hz Stack fields");
+        
 }
 
 //_______________________________________________________________
@@ -267,10 +260,8 @@
 
 char *AVDMVideoUnStackField::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," UnStack fields");
-        return buf;
+        ADM_FILTER_DECLARE_CONF(" UnStack fields");
+        
 }
 
 //______________________Unstack Fields_________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidStackField.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidStackField.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidStackField.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -43,10 +43,8 @@
 
 char *AVDMVideoStackField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Stack fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Stack fields");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidUnstackField.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidUnstackField.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KeepField/ADM_vidUnstackField.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -41,10 +41,8 @@
 
 char *AVDMVideoUnStackField::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," UnStack fields");
-        return buf;
+        ADM_FILTER_DECLARE_CONF(" UnStack fields");
+        
 }
 
 //______________________Unstack Fields_________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KernelDeint/ADM_vidKernelDeint.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KernelDeint/ADM_vidKernelDeint.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/KernelDeint/ADM_vidKernelDeint.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -96,10 +96,8 @@
 }
 char *ADMVideoKernelDeint::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," D Graft Kernel Deint");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" D Graft Kernel Deint");
+        
 }
 
 ADMVideoKernelDeint::~ADMVideoKernelDeint()

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/LumaOnly/ADM_vidLuma.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/LumaOnly/ADM_vidLuma.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/LumaOnly/ADM_vidLuma.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -32,10 +32,8 @@
 //****************************************
 char *ADMVideoLuma::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Luma only");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Luma only");
+        
 }
 
 ADMVideoLuma::ADMVideoLuma(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MPDelogo/ADM_vidMPdelogo.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MPDelogo/ADM_vidMPdelogo.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MPDelogo/ADM_vidMPdelogo.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -67,11 +67,9 @@
 
 char *ADMVideoMPdelogo::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," MPlayer delogo : at (%d,%d) (%dx%d)",
+        ADM_FILTER_DECLARE_CONF(" MPlayer delogo : at (%d,%d) (%dx%d)",
                                 _param->xoff,_param->yoff,_param->lw,_param->lh);
-        return buf;
+        
 }
 //_______________________________________________________________
 ADMVideoMPdelogo::ADMVideoMPdelogo(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -173,11 +173,8 @@
 //________________________________________________________
 char *Msharpen::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Donald Graft Msharpen Strength:%d Threshold:%d",_param->strength,_param->threshold);
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Donald Graft Msharpen Strength:%d Threshold:%d",_param->strength,_param->threshold);
+        
 }
 	
 //________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen_param.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen_param.h	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSharpen/ADM_vidMSharpen_param.h	2008-06-23 17:48:51 UTC (rev 4154)
@@ -1,7 +1,7 @@
-typedef struct MSHARPEN_PARAM
+typedef struct 
 {
 	uint32_t  mask;
 	uint32_t  highq;
 	uint32_t  threshold;
         uint32_t  strength;
-};
+}MSHARPEN_PARAM;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMSmooth_param.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMSmooth_param.h	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMSmooth_param.h	2008-06-23 17:48:51 UTC (rev 4154)
@@ -1,6 +1,6 @@
-typedef struct MSMOOTH_PARAM
+typedef struct 
 {
 	uint32_t  showmask, highq;
 	uint32_t  threshold, strength;
 
-};
+}MSMOOTH_PARAM;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMsmooth.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMsmooth.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MSmooth/ADM_vidMsmooth.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -191,11 +191,8 @@
 //________________________________________________________
 char *Msmooth::printConf( void )
 {
- 	static char buf[50];
-
-	ADM_assert(_param);
- 	sprintf((char *)buf," Donald Graft MSmooth");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Donald Graft MSmooth");
+        
 }
 	
 //________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/ADM_vidMcDeint.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/ADM_vidMcDeint.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/ADM_vidMcDeint.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -82,10 +82,8 @@
 
 char *AVDMVideoMCDeint::printConf( void )
 {
-static char buf[50];
-
-        sprintf((char *)buf," MC deinterlacer : Mode %d, qp %d, parity %d ",_param->mode,_param->qp,_param->initial_parity);
-        return buf;
+    ADM_FILTER_DECLARE_CONF(" MC deinterlacer : Mode %d, qp %d, parity %d ",_param->mode,_param->qp,_param->initial_parity);
+        
 }
 uint8_t AVDMVideoMCDeint::configure(AVDMGenericVideoStream * instream)
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/ADM_vidMosaic.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/ADM_vidMosaic.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/ADM_vidMosaic.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -166,12 +166,10 @@
 }
 char *ADMVideoMosaic::printConf( void )
 {
-        static char buf[50];
-
-        sprintf((char *)buf," Mosaic : %d hz, %d vz, %d shrink factor",
+        ADM_FILTER_DECLARE_CONF(" Mosaic : %d hz, %d vz, %d shrink factor",
                                 _in->getInfo()->width,
                                 _param->hz,_param->vz,_param->shrink);
-        return buf;
+        
 }
 //_______________________________________________________________
 ADMVideoMosaic::ADMVideoMosaic(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3D.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3D.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3D.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -40,11 +40,9 @@
 
  char 	*ADMVideoMPD3D::printConf(void)
  {
-	  	static char buf[50];
-
- 				sprintf((char *)buf," MPlayer HQ Denoise 3D (%2.1f - %2.1f - %2.1f)'",
+	  ADM_FILTER_DECLARE_CONF(" MPlayer HQ Denoise 3D (%2.1f - %2.1f - %2.1f)'",
 						_param->param1,_param->param2,_param->param3);
-        return buf;
+        
 }
 
 uint8_t ADMVideoMPD3D::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3Dlow.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3Dlow.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerDenoise3D/ADM_vidMPLD3Dlow.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -40,11 +40,9 @@
 
  char 	*ADMVideoMPD3Dlow::printConf(void)
  {
-	  	static char buf[50];
-
- 				sprintf((char *)buf," MPlayer Denoise 3D (%2.1f - %2.1f - %2.1f)'",
+	  ADM_FILTER_DECLARE_CONF(" MPlayer Denoise 3D (%2.1f - %2.1f - %2.1f)'",
 						_param->param1,_param->param2,_param->param3);
-        return buf;
+        
 }
 
 uint8_t ADMVideoMPD3Dlow::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/ADM_vidMPLResize.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/ADM_vidMPLResize.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/ADM_vidMPLResize.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -197,15 +197,13 @@
 }
 char *AVDMVideoStreamMPResize::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," MPL Resize %lu x %lu --> %lu x %lu (%s)",
+ 	ADM_FILTER_DECLARE_CONF(" MPL Resize %lu x %lu --> %lu x %lu (%s)",
  				_in->getInfo()->width,
  				_in->getInfo()->height,
  				_info.width,
  				_info.height,
 				algs[_param->algo].name);
-        return buf;
+        
 }
 //_______________________________________________________________
 AVDMVideoStreamMPResize::AVDMVideoStreamMPResize(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/PalShift/ADM_vidPalShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/PalShift/ADM_vidPalShift.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/PalShift/ADM_vidPalShift.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -37,10 +37,8 @@
 
 char *ADMVideoPalShift::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," PAL field shift");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" PAL field shift");
+        
 }
 
 ADMVideoPalShift::ADMVideoPalShift(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Pulldown/ADM_vidPulldown.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Pulldown/ADM_vidPulldown.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Pulldown/ADM_vidPulldown.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -43,10 +43,8 @@
 
 char *ADMVideoPullDown::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Pulldown");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Pulldown");
+        
 }
 //_______________________________________________________________
 ADMVideoPullDown::ADMVideoPullDown(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/ADM_vidResampleFPS.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/ADM_vidResampleFPS.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/ADM_vidResampleFPS.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -84,11 +84,9 @@
 }
 char *ADMVideoResampleFPS::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Resample to %2.2f fps (blend:%d)",(double)_param->newfps/1000.,
+ ADM_FILTER_DECLARE_CONF(" Resample to %2.2f fps (blend:%d)",(double)_param->newfps/1000.,
                 _param->use_linear);
-  return buf;
+  
 }
 
 ADMVideoResampleFPS::ADMVideoResampleFPS(  AVDMGenericVideoStream *in,uint32_t target)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Reverse/ADM_vidReverse.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Reverse/ADM_vidReverse.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Reverse/ADM_vidReverse.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -45,11 +45,8 @@
 
 char *AVDM_Reverse::printConf( void )
 {
-  static char buf[50];
-
-        //ADM_assert(_param);
-  sprintf((char *)buf," Reverse");
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Reverse");
+  
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Rotate/ADM_vidRotate.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Rotate/ADM_vidRotate.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Rotate/ADM_vidRotate.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -60,10 +60,8 @@
 
 char *ADMVideoRotate::printConf( void )
 {
-  static char buf[50];
- 	
-  sprintf((char *)buf," Rotate %u degrees", _param->angle);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Rotate %u degrees", _param->angle);
+  
 }
 
 ADMVideoRotate::ADMVideoRotate(AVDMGenericVideoStream *in, CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Soften/ADM_vidSoften.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Soften/ADM_vidSoften.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Soften/ADM_vidSoften.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -87,11 +87,9 @@
 }
 char *ADMVideoMaskedSoften::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," Soften : radius: %lu l:%lu c:%lu", 
+ 	ADM_FILTER_DECLARE_CONF(" Soften : radius: %lu l:%lu c:%lu", 
 		_param->radius,_param->luma, _param->chroma);
-        return buf;
+        
 }
 
 ADMVideoMaskedSoften::~ADMVideoMaskedSoften()

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -44,10 +44,8 @@
 
 char 								*ADMVideoSubtitle::printConf(void)
  {
-	  	static char buf[50];
-
- 				sprintf((char *)buf,"Subtitle ");
-        return buf;
+	  	ADM_FILTER_DECLARE_CONF("Subtitle ");
+        
 	}
 
 //--------------------------------------------------------

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Stabilize/ADM_vidStabilize.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Stabilize/ADM_vidStabilize.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Stabilize/ADM_vidStabilize.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -58,10 +58,8 @@
 
 char 	*ADMVideoStabilize::printConf(void)
 {
-  static char buf[50];
-
- 	sprintf((char *)buf," Stabilize :%ld",*_param);
-        return buf;
+  ADM_FILTER_DECLARE_CONF(" Stabilize :%ld",*_param);
+        
 }
 uint8_t  GUI_getIntegerValue(int *valye, int min, int max, char *title);
 uint8_t ADMVideoStabilize::configure(AVDMGenericVideoStream *instream)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapFields.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapFields.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapFields.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -38,10 +38,8 @@
 
 char *AVDMVideoSwapField::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Swap fields");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Swap fields");
+ 
 }
 //_______________________________________________________________
 AVDMVideoSwapField::AVDMVideoSwapField(

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapSmart.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapSmart.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapField/ADM_vidSwapSmart.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -42,10 +42,8 @@
 
 char *AVDMVideoSwapSmart::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," Smart Swap fields");
-        return buf;
+ ADM_FILTER_DECLARE_CONF(" Smart Swap fields");
+        
 }
 
 //_______________________________________________________________

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapUV/ADM_vidUVSwap.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapUV/ADM_vidUVSwap.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/SwapUV/ADM_vidUVSwap.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -32,10 +32,8 @@
 //*********************************
 char *ADMVideoUVSwap::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," UV Swap");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" UV Swap");
+        
 }
 
 ADMVideoUVSwap::ADMVideoUVSwap(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TIsophote/ADM_vidTisophote.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -85,10 +85,8 @@
 }
 char *ADMVideoTIsophote::printConf( void )
 {
- 	static char buf[50];
-
- 	sprintf((char *)buf," TIsoPhote by Tritical");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" TIsoPhote by Tritical");
+        
 }
 
 ADMVideoTIsophote::~ADMVideoTIsophote()

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Tdeint/ADM_vidTdeint.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Tdeint/ADM_vidTdeint.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Tdeint/ADM_vidTdeint.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -168,9 +168,8 @@
 /*************************************/
 char *vidTDeint::printConf (void)
 {
-  static char buf[50];
-  sprintf ((char *) buf, " Tritical TDeint");
-  return buf;
+ ADM_FILTER_DECLARE_CONF( " Tritical TDeint");
+  
 }
 
 #define MAX_BLOCKS 50

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTel_param.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTel_param.h	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTel_param.h	2008-06-23 17:48:51 UTC (rev 4154)
@@ -11,7 +11,7 @@
 //
 
 
-typedef struct TelecideParam
+typedef struct 
 {
 	uint32_t 	order;           /* Field Order 0 BFF, 1TFF */
 	uint32_t 	back;            // Try backward field :0 Never, 1 when bad, 2 always tried MUST Have post !=0
@@ -31,4 +31,4 @@
 	uint32_t 	hints;           // ignore
 	uint32_t 	show;            // Toggle
 	uint32_t 	debug;           // Toggle
-};
+}TelecideParam;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTelecide.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTelecide.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Telecide/ADM_vidDecTelecide.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -139,11 +139,8 @@
 
 char *Telecide::printConf( void )
 {
- 	static char buf[50];
-
-  	ADM_assert(_param); 	
- 	sprintf((char *)buf," Decomb Telecide");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" Decomb Telecide");
+ 
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -77,11 +77,9 @@
 
 char *AVDMVideoVlad::printConf(void)
 {
-	static char buf[50];
- 	
-	sprintf((char *)buf," Temporal Cleaner : Y: %02lu / c: %02lu",_param->ythresholdMask,
+	ADM_FILTER_DECLARE_CONF(" Temporal Cleaner : Y: %02lu / c: %02lu",_param->ythresholdMask,
 				_param->cthresholdMask	);
-        return buf;
+        
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -51,10 +51,8 @@
 //************************************
 char *ADMVideoFlipV::printConf( void )
 {
- 	static char buf[50];
- 	
- 	sprintf((char *)buf," V-Flip");
-        return buf;
+ 	ADM_FILTER_DECLARE_CONF(" V-Flip");
+        
 }
 
 ADMVideoFlipV::ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Whirl/ADM_vidWhirl.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Whirl/ADM_vidWhirl.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Whirl/ADM_vidWhirl.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -64,10 +64,8 @@
 
 char *AVDMVideoWhirl::printConf(void)
 {
-	static char buf[50];
- 	
-	sprintf((char *)buf," Whril");
-        return buf;
+	ADM_FILTER_DECLARE_CONF(" Whril");
+        
 }
 
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Yadif/ADM_vidYadif.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Yadif/ADM_vidYadif.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Yadif/ADM_vidYadif.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -87,10 +87,8 @@
 //***************************************************
 char *ADMVideoYadif::printConf( void )
 {
-  static char buf[50];
- 	
-  sprintf((char *)buf," Yadif : mode %u order %d",_param->mode, _param->order);
-  return buf;
+  ADM_FILTER_DECLARE_CONF(" Yadif : mode %u order %d",_param->mode, _param->order);
+  
 }
 
 ADMVideoYadif::ADMVideoYadif(AVDMGenericVideoStream *in, CONFcouple *couples)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/colorYUV/ADM_vidColorYuv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/colorYUV/ADM_vidColorYuv.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/colorYUV/ADM_vidColorYuv.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -86,9 +86,8 @@
 
 char *ADMVideoColorYuv::printConf( void )
 {
-   static char buf[50];
-   sprintf((char *)buf," ColorYuv ");
-   return buf;
+  ADM_FILTER_DECLARE_CONF(" ColorYuv ");
+   
 }
 
 ADMVideoColorYuv::ADMVideoColorYuv(AVDMGenericVideoStream *in,CONFcouple *couples) 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/ADM_lavpp_deint.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/ADM_lavpp_deint.cpp	2008-06-23 17:48:45 UTC (rev 4153)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/ADM_lavpp_deint.cpp	2008-06-23 17:48:51 UTC (rev 4154)
@@ -128,10 +128,8 @@
 //*************************************************************
 char *ADMVideoLavPPDeint::printConf( void )
 {
-  static char buf[50];
-        
-  sprintf((char *)buf," Lavcodec PP deinterlacer autolev:%d deint:%d",_param->autolevel,_param->deintType);
-  return buf;
+ ADM_FILTER_DECLARE_CONF(" Lavcodec PP deinterlacer autolev:%d deint:%d",_param->autolevel,_param->deintType);
+  
 }
 //*************************************************************
 ADMVideoLavPPDeint::ADMVideoLavPPDeint(  AVDMGenericVideoStream *in,CONFcouple *couples)



From gruntster at mail.berlios.de  Tue Jun 24 03:02:45 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jun 2008 03:02:45 +0200
Subject: [Avidemux-svn-commit] r4155 - in
	branches/avidemux_2.4_branch/avidemux: ADM_osSupport winInstaller
Message-ID: <200806240102.m5O12jkJ030887@sheep.berlios.de>

Author: gruntster
Date: 2008-06-24 03:02:36 +0200 (Tue, 24 Jun 2008)
New Revision: 4155

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
Log:
[Win32] use AppData folder to store settings instead of User Profile folder (FS#445)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-23 17:48:51 UTC (rev 4154)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-24 01:02:36 UTC (rev 4155)
@@ -22,6 +22,10 @@
 #include <sys/stat.h>
 #include <unistd.h>
 
+#ifdef __WIN32__
+#include <shlobj.h>
+#endif
+
 #include "default.h"
 #include "ADM_misc.h"
 #include "ADM_toolkit/filesel.h"
@@ -142,18 +146,20 @@
 {
 char *dirname=NULL;
 DIR *dir=NULL;
-char *home;
-//
+
         if(baseDirDone) return basedir;
 // Get the base directory
 #if defined(ADM_WIN32)
-        if( ! (home=getenv("USERPROFILE")) )
-        {
-          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $USERPROFILE."));
-                    home="c:\\";
-        }
+	char home[MAX_PATH];
 
+	if (SHGetFolderPath(NULL, CSIDL_APPDATA, NULL, 0, home) != S_OK)
+	{
+		GUI_Error_HIG(QT_TR_NOOP("Oops"), QT_TR_NOOP("Can't determine the Application Data folder."));
+		strcpy(home, "c:\\");
+	}
 #else
+		char *home;
+
         if( ! (home=getenv("HOME")) )
         {
           GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $HOME."));

Modified: branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
===================================================================
--- branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2008-06-23 17:48:51 UTC (rev 4154)
+++ branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2008-06-24 01:02:36 UTC (rev 4155)
@@ -6,7 +6,7 @@
 !include WinMessages.nsh
 !include revision.nsh
 
-Name "Avidemux 2.4 r${REVISION}"
+Name "Avidemux 2.4.1 r${REVISION}"
 
 SetCompressor /SOLID lzma
 SetCompressorDictSize 96
@@ -17,7 +17,7 @@
 !define INTERNALNAME "Avidemux 2.4"
 !define REGKEY "SOFTWARE\${INTERNALNAME}"
 !define UNINST_REGKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${INTERNALNAME}"
-!define VERSION 2.4.0.${REVISION}
+!define VERSION 2.4.1.${REVISION}
 !define COMPANY "Free Software Foundation"
 !define URL "http://www.avidemux.org"
 
@@ -93,7 +93,7 @@
 CRCCheck on
 XPStyle on
 ShowInstDetails nevershow
-VIProductVersion 2.4.0.${REVISION}
+VIProductVersion 2.4.1.${REVISION}
 VIAddVersionKey ProductName Avidemux
 VIAddVersionKey ProductVersion "${VERSION}"
 VIAddVersionKey FileVersion ""
@@ -189,6 +189,14 @@
     File ..\..\..\avidemux_2.4_build\xvidcore.dll
     SetOutPath $INSTDIR\etc\fonts
     File /r ..\..\..\avidemux_2.4_build\etc\fonts\*
+
+    # if $PROFILE\avidemux exists and $APPDATA\avidemux doesn't, then move it
+    IfFileExists "$PROFILE\avidemux" 0 end
+    IfFileExists "$APPDATA\avidemux" end
+
+    Rename "$PROFILE\avidemux" "$APPDATA\avidemux"
+
+end:
     WriteRegStr HKLM "${REGKEY}\Components" "Core files (required)" 1
 SectionEnd
 



From gruntster at mail.berlios.de  Tue Jun 24 19:47:30 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jun 2008 19:47:30 +0200
Subject: [Avidemux-svn-commit] r4156 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_userInterfaces/ADM_GTK
	avidemux/ADM_userInterfaces/ADM_QT4 plugins/ADM_videoFilters/Crop
Message-ID: <200806241747.m5OHlUWJ006898@sheep.berlios.de>

Author: gruntster
Date: 2008-06-24 19:44:25 +0200 (Tue, 24 Jun 2008)
New Revision: 4156

Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp
Log:
[Merge] fix compilation errors

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp	2008-06-24 01:02:36 UTC (rev 4155)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.cpp	2008-06-24 17:44:25 UTC (rev 4156)
@@ -1,5 +1,5 @@
-#include "default.h"
-#include <strings.h>
+#include "ADM_default.h"
+#include <strings.h>
 
 #include <vector>
 using std::vector;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp	2008-06-24 01:02:36 UTC (rev 4155)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Crop/ADM_vidCrop.cpp	2008-06-24 17:44:25 UTC (rev 4156)
@@ -195,7 +195,7 @@
 			return 1;
 
 }
-extern int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in);
+extern int DIA_getCropParams(const char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in);
 uint8_t AVDMVideoStreamCrop::configure( AVDMGenericVideoStream *instream)
 
 {



From gruntster at mail.berlios.de  Tue Jun 24 21:46:50 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jun 2008 21:46:50 +0200
Subject: [Avidemux-svn-commit] r4157 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_audiocodec avidemux/ADM_audiofilter
	avidemux/ADM_core/include avidemux/ADM_core/src
	avidemux/ADM_editor avidemux/ADM_encoder
	avidemux/ADM_inputs/ADM_amv avidemux/ADM_inputs/ADM_asf
	avidemux/ADM_inputs/ADM_avsproxy avidemux/ADM_inputs/ADM_flv
	avidemux/ADM_inputs/ADM_h263 avidemux/ADM_inputs/ADM_inpics
	avidemux/ADM_inputs/ADM_matroska avidemux/ADM_inputs/ADM_mp4
	avidemux/ADM_inputs/ADM_mpegdemuxer
	avidemux/ADM_inputs/ADM_nuv avidemux/ADM_inputs/ADM_ogm
	avidemux/ADM_inputs/ADM_openDML
	avidemux/ADM_libraries/ADM_libmpeg2enc avidemux/ADM_osSupport
	avidemux/ADM_script avidemux/ADM_toolkit
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/xpm po
Message-ID: <200806241946.m5OJkos4020326@sheep.berlios.de>

Author: gruntster
Date: 2008-06-24 21:46:05 +0200 (Tue, 24 Jun 2008)
New Revision: 4157

Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_assert.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_crashdump.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_misc.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edIdentify.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edLoadSave.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/ADM_crashHook.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux_icon.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/begin.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/end.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator_small.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/stop.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray.xpm
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray2.xpm
   branches/avidemux_2.5_branch_gruntster/po/es.po
Log:
[Merge] integrate changes from 2.4 branch (r4106)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -226,3 +226,5 @@
         return 1;
   
 }
+
+// EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -56,7 +56,7 @@
 typedef struct externalSource
 {
  AudioSource type;
- const char *name;       
+ const char *name;
 }externalSource;
 
 static const externalSource Sources[]=
@@ -69,7 +69,7 @@
 };
 typedef struct Mixer_String
 {
-  const char   *name;
+  const char         *name;
   CHANNEL_CONF conf;
 };
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_assert.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_assert.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_assert.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -99,7 +99,7 @@
         #define LLX "I64x"
         #define LLU "I64u"
         
-		char *ADM_slashToBackSlash(char *in);
+		char *ADM_slashToBackSlash(const char *in);
         #define ADM_cleanupPath(x) ADM_slashToBackSlash(x)
 #else
         #define LLX "llx"

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -19,7 +19,7 @@
 
 void            TLK_getDate(ADM_date *date);
 // /dir/file.ext -> /dir/file and ext returned values are copies
-void            ADM_PathSplit(char *str, char **root, char **ext);
+void            ADM_PathSplit(const char *str, char **root, char **ext);
 // Returns path only /foo/bar.avi -> /foo INPLACE, no copy done
 void	        ADM_PathStripName(char *str);
 // Get the filename without path. /foo/bar.avi -> bar.avi INPLACE, NO COPY

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_crashdump.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_crashdump.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_crashdump.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -29,9 +29,6 @@
 
 #include "ADM_default.h"
 
-
-#define CRASH_FILE "crash.js"
-
 // Our callback to give UI formatted informations....
 static ADM_saveFunction *mysaveFunction=NULL;
 static ADM_fatalFunction *myFatalFunction=NULL;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -497,7 +497,7 @@
     \brief Split path into absolute path+name and extention i.e. /foo/bar/zee.avi -> /foo/bar/zee,avi.             Copy are returned
 
 */
-void ADM_PathSplit(char *str, char **root, char **ext)
+void ADM_PathSplit(const char *str, char **root, char **ext)
 {
 	char *full;
 	uint32_t l;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_misc.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_misc.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_misc.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -236,7 +236,7 @@
     This function convert the later to the former
 
 */
-extern char *ADM_slashToBackSlash(char *in)
+extern char *ADM_slashToBackSlash(const char *in)
 {
     char *out,*cout;
     int n;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -102,7 +102,7 @@
   return 1;
 }
 
-uint8_t vidHeader::setMyName (char *name)
+uint8_t vidHeader::setMyName (const char *name)
 {
   _name = new char[strlen (name) + 1];
   ADM_assert (_name);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_Video.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -73,7 +73,7 @@
 virtual   void 			Dump(void)=0;
 virtual	  uint8_t		getExtraHeaderData(uint32_t *len, uint8_t **data);
 // AVI io
-virtual 	uint8_t		open(char *name)=0;
+virtual 	uint8_t		open(const char *name)=0;
 virtual 	uint8_t		close(void)=0;
 virtual	uint8_t			reorder( void ) { return 0;} // by default we don"t do frame re-ordering
 virtual	uint8_t			isReordered( void ) { return 0;} // by default we don"t do frame re-ordering
@@ -83,7 +83,7 @@
   uint8_t			getVideoInfo(aviInfo *info);
   uint32_t			getWidth( void ) { return _mainaviheader.dwWidth;};
   uint32_t			getHeight( void ) { return _mainaviheader.dwHeight;};
-  uint8_t			setMyName( char *name);
+  uint8_t			setMyName( const char *name);
   char				*getMyName( void);
   //__________________________
   //				 Audio

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edIdentify.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edIdentify.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edIdentify.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -43,7 +43,7 @@
 /**
 	Read the magic of a file i.e. its 16 first bytes
 */
-uint8_t ADM_Composer::getMagic (char *name, uint32_t * magic)
+uint8_t ADM_Composer::getMagic (const char *name, uint32_t * magic)
 {
   FILE *    tmp;
   uint8_t    ret =    1;
@@ -66,7 +66,7 @@
 
 */
 
-uint8_t ADM_Composer::identify (char *name, fileType * type)
+uint8_t ADM_Composer::identify (const char *name, fileType * type)
 {
   uint32_t magic[4];
   uint32_t id;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edLoadSave.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edLoadSave.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edLoadSave.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -65,7 +65,7 @@
 // Save the config, including name, segment etc...
 //______________________________________________
 
-uint8_t ADM_Composer::saveWorbench (char *name)
+uint8_t ADM_Composer::saveWorbench (const char *name)
 {
         GUI_Error_HIG(QT_TR_NOOP("Unsupported"), NULL);
         return 0;
@@ -73,7 +73,7 @@
 /*______________________________________________
         Save the project as a script
 ______________________________________________*/
-uint8_t ADM_Composer::saveAsScript (char *name, char *outputname)
+uint8_t ADM_Composer::saveAsScript (const char *name, const char *outputname)
 {
 const char *truefalse[]={"false","true"};
 printf("\n **Saving script project **\n");
@@ -293,7 +293,7 @@
 // Save the config, including name, segment etc...
 //______________________________________________
 
-uint8_t ADM_Composer::loadWorbench (char *name)
+uint8_t ADM_Composer::loadWorbench (const char *name)
 {
   GUI_Error_HIG(QT_TR_NOOP("Old format project file"),QT_TR_NOOP( "No more supported."));
  return 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -66,7 +66,7 @@
 void DIA_indexerPrefill(char *name);
 extern uint8_t indexMpeg (char *mpeg, char *file, uint8_t aid);
 
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern uint8_t parseScript(char *name);
 uint8_t UI_SetCurrentFormat( ADM_OUT_FORMAT fmt );
 const char *VBR_MSG = QT_TR_NOOP("Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n\nYou can do it later with \"Audio -> Build VBR Time Map\".");
@@ -252,7 +252,7 @@
         
 
 */
-uint8_t ADM_Composer::addFile (char *name, uint8_t mode,fileType forcedType)
+uint8_t ADM_Composer::addFile (const char *name, uint8_t mode,fileType forcedType)
 {
   uint8_t    ret =    0;
   aviInfo    info;
@@ -582,23 +582,26 @@
 
                 }
 		printf("\n checking for B-Frames...\n");
-		if( vid->_nb_video_frames >12) // 12
+		if( vid->_nb_video_frames > 12)
 		{
 				uint8_t 		*bufferin;
 				uint32_t 		len,flags;
 				uint8_t 		bframe=0, bconsistency=1;
-				uint32_t		scanned=12;
+				uint32_t		scanned;
                                 ADMImage                *buffer=NULL;
-				//buffer=new uint8_t [info.width* info.height*2];
-				if(vid->_nb_video_frames>50) scanned=50;
+
+				if(vid->_nb_video_frames > (info.fps1000 * 5) / 1000)
+					scanned = (info.fps1000 * 5) / 1000;
 				else				scanned=vid->_nb_video_frames;
+
+				printf(" scanning %lu frames\n", scanned);
 				
 				bufferin=new uint8_t [info.width* info.height*2];
                                 if(vid->decoder->dontcopy())
                                         buffer=new ADMImage(info.width,info.height,1);
                                 else
 				        buffer=new ADMImage(info.width,info.height);
-				// we decode 5 frames..should be enough to get an opinion
+
                                 ADMCompressedImage img;
                                 img.data=bufferin;
 				for(uint32_t i=0;i<scanned;i++)  //10
@@ -1498,7 +1501,7 @@
 //              0 else
 //_________________________________________
 //
-uint8_t         ADM_Composer::tryIndexing(char *name,char *idxname)
+uint8_t         ADM_Composer::tryIndexing(const char *name, const char *idxname)
 {
  unsigned int autoidx = 0;
       prefs->get(FEATURE_TRYAUTOIDX,&autoidx);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx	2008-06-24 19:46:05 UTC (rev 4157)
@@ -153,10 +153,10 @@
 				       		uint8_t  	updateAudioTrack(uint32_t seg);			   	
 						void 		deleteAllVideos(void );
 
-						uint8_t 	getMagic(char *name,uint32_t *magic);
-						uint8_t 	identify(char *name, fileType *type);
+						uint8_t 	getMagic(const char *name,uint32_t *magic);
+						uint8_t 	identify(const char *name, fileType *type);
 						uint32_t 	searchForwardSeg(uint32_t startframe);
-                                                uint8_t         tryIndexing(char *name,char *idxname=NULL);
+                                                uint8_t         tryIndexing(const char *name, const char *idxname=NULL);
 
   public:
                                                 uint8_t hasVBRVideos(void);
@@ -170,9 +170,9 @@
   				virtual 			~ADM_Composer();
   						void		clean( void );
   						void		dumpSeg(void);
-                                                uint8_t         saveAsScript (char *name,char *out);
-						uint8_t 	saveWorbench(char *name)      ;
-						uint8_t 	loadWorbench(char *name)      ;
+                                                uint8_t         saveAsScript (const char *name, const char *out);
+						uint8_t 	saveWorbench(const char *name);
+						uint8_t 	loadWorbench(const char *name);
 						uint8_t     resetSeg( void );
 						uint8_t	reorder( void );
 						uint8_t	isReordered( uint32_t framenum );
@@ -180,7 +180,7 @@
   				//_______________________
   				// specific to composer
   				//_______________________
-  						uint8_t 	addFile (char *name, uint8_t mode=0,fileType forcedType=Unknown_FileType);
+  						uint8_t 	addFile (const char *name, uint8_t mode=0,fileType forcedType=Unknown_FileType);
   						uint8_t 	cleanup( void);
 			   			uint8_t 	isMultiSeg( void) { if(_nb_segment>1) return 1; else return 0;}
   						uint8_t 	removeFrames(uint32_t start,uint32_t end);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -638,7 +638,8 @@
 	(given as sole argument)
 
 */
-uint8_t loadVideoCodecConf (char *name)
+uint8_t
+loadVideoCodecConf (const char *name)
 {
 	if (currentCodecType == CodecExternal)
 		videoCodecSetConf(strlen(name), (uint8_t*)name);
@@ -690,7 +691,8 @@
 	return 1;
 }
 
-uint8_t loadVideoCodecConfString(char *cmd)
+uint8_t
+loadVideoCodecConfString (const char *cmd)
 {
 #define MAX_STRING 4000
 	char str[MAX_STRING * 3];

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -83,7 +83,7 @@
       \brief open the flv file, gather infos and build index(es).
 */
 
-uint8_t amvHeader::open(char *name)
+uint8_t amvHeader::open(const char *name)
 {
   uint32_t prevLen, type, size, pts,pos=0;
   

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_amv/ADM_amv.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -105,7 +105,7 @@
             amvHeader( void );
    virtual  ~amvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -141,7 +141,7 @@
     __________________________________________________________
 */
 
-uint8_t asfHeader::open(char *name)
+uint8_t asfHeader::open(const char *name)
 {
   _fd=fopen(name,"rb");
   if(!_fd)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_asf/ADM_asf.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -166,7 +166,7 @@
              asfHeader( void );
     virtual  ~asfHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -36,7 +36,7 @@
 }
 
 
-uint8_t avsHeader::open(char *name)
+uint8_t avsHeader::open(const char *name)
 {
     mySocket=0;
     if(!bindMe(9999))

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -30,7 +30,7 @@
         avsHeader( void );
         ~avsHeader(  );
 // AVI io
-        virtual 	uint8_t			open(char *name);
+        virtual 	uint8_t			open(const char *name);
         virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -86,7 +86,7 @@
       \brief open the flv file, gather infos and build index(es).
 */
 
-uint8_t flvHeader::open(char *name)
+uint8_t flvHeader::open(const char *name)
 {
   uint32_t prevLen, type, size, pts,pos=0;
   

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_flv/ADM_flv.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -110,7 +110,7 @@
             flvHeader( void );
    virtual  ~flvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -104,7 +104,7 @@
 // Open and index the (small) h263
 //
 //______________________________________
-uint8_t    h263Header::open(char *name)
+uint8_t    h263Header::open(const char *name)
 {
 	uint32_t w,h,res=255,nbImg=0;
 	uint32_t word;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/ADM_h263.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -49,7 +49,7 @@
 			h263Header( void ) {_fd=NULL;};
        		    	~h263Header(  ) { };
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -28,7 +28,6 @@
 #include "ADM_h263.h"
 #include "bitsRead.h"
 
-#include "bitsRead.h"
 const int mask[9]={
 0,
 1,
@@ -125,7 +124,7 @@
 
 			}
 }
-uint8_t bitsReader::open(char *name)
+uint8_t bitsReader::open(const char *name)
 {
 	_fd=fopen(name,"rb");
 	if(!_fd) return 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_h263/bitsRead.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -15,7 +15,7 @@
 
 public:
 			bitsReader(void);
-	uint8_t		open(char *name);
+	uint8_t		open(const char *name);
 			~bitsReader();
 	uint8_t 	forward(uint32_t nbBits);
 	uint8_t 	read(uint32_t nbBits,uint32_t *val);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -124,7 +124,7 @@
     return i;
 }
 //****************************************************************
-uint8_t picHeader::open(char *inname)
+uint8_t picHeader::open(const char *inname)
 {
     uint32_t nnum;
     uint32_t *fcc;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_inpics/ADM_pics.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -57,7 +57,7 @@
 			picHeader( void );
        		    ~picHeader(  ) { };
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -29,7 +29,7 @@
     __________________________________________________________
 */
 
-uint8_t mkvHeader::open(char *name)
+uint8_t mkvHeader::open(const char *name)
 {
 
   ADM_ebml_file ebml;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -134,7 +134,7 @@
             mkvHeader( void );
    virtual  ~mkvHeader(  ) ;
 // AVI io
-    virtual uint8_t  open(char *name);
+    virtual uint8_t  open(const char *name);
     virtual uint8_t  close(void) ;
   //__________________________
   //  Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -198,7 +198,7 @@
 // other stuff which are pretty useless on
 // 3gp file anyway.
 //______________________________________
-uint8_t    MP4Header::open(char *name)
+uint8_t    MP4Header::open(const char *name)
 {
         printf("** opening 3gpp files **");	
         _fd=fopen(name,"rb");

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -157,7 +157,7 @@
                                 MP4Header( void ) ;
 virtual	                        ~MP4Header(  ) ;
 // AVI io
-virtual 	uint8_t	       open(char *name);
+virtual 	uint8_t	       open(const char *name);
 virtual 	uint8_t	       close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -75,7 +75,7 @@
   _index=NULL;
 }
 uint8_t
-dmxAudioStream::open (char *name)
+dmxAudioStream::open (const char *name)
 {
   FILE *file;
   uint32_t dummy;		//,audio=0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -56,7 +56,7 @@
                 public:
                 uint32_t        currentTrack;
                                 dmxAudioStream( void);
-                uint8_t         open(char *name);
+                uint8_t         open(const char *name);
         virtual                 ~dmxAudioStream() ;                    
         virtual uint8_t         goTo(uint32_t offset);
         virtual uint32_t        read(uint32_t size,uint8_t *ptr);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -171,7 +171,7 @@
 
 */
 #define MAX_LINE 4096
-uint8_t                 dmxHeader::open(char *name)
+uint8_t                 dmxHeader::open(const char *name)
 {
                 FILE *file;
         

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -42,7 +42,7 @@
 
 
 // AVI io
-        virtual         uint8_t                 open(char *name);
+        virtual         uint8_t                 open(const char *name);
         virtual         uint8_t                 close(void);
   //__________________________
   //                             Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -421,7 +421,7 @@
 
 
 */
-uint8_t    nuvHeader::open(char *name)
+uint8_t    nuvHeader::open(const char *name)
 {
 uint32_t a=0,v=0,t=0;
 uint32_t max=0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -107,7 +107,7 @@
 					nuvHeader( void ) ;
 		   virtual  		~nuvHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -149,7 +149,7 @@
 
 
 
-uint8_t oggHeader::open(char *name)
+uint8_t oggHeader::open(const char *name)
 {
 #ifdef ADM_BIG_ENDIAN
 	#define SWAP64(x) { uint64_t y=x;x=R32((y>>16)>>16)+((R32(y&0x0ffffffff)<<16)<<16);}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -61,7 +61,7 @@
  			
 				
 		public:
-					oggAudio( char *name,OgAudioTrack *tracks,uint8_t trkidx );
+					oggAudio(const char *name,OgAudioTrack *tracks,uint8_t trkidx );
 			virtual 	~oggAudio() ;
 			virtual uint8_t goTo(uint32_t offset);
 			virtual uint32_t read(uint32_t size,uint8_t *ptr);
@@ -101,7 +101,7 @@
 					oggHeader( void ) ;
 		   virtual  		~oggHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -50,7 +50,7 @@
 
 }
 
-oggAudio::oggAudio( char *name,OgAudioTrack *tracks,uint8_t trkidx )
+oggAudio::oggAudio(const char *name,OgAudioTrack *tracks,uint8_t trkidx )
 {
 uint64_t f;
 	_tracks=tracks;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -40,7 +40,7 @@
 
 }
 
-uint8_t OGMDemuxer::open(char *name)
+uint8_t OGMDemuxer::open(const char *name)
 {
 		_fd=fopen(name,"rb");
 		if(!_fd) return 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -36,7 +36,7 @@
 						OGMDemuxer(void);
 						~OGMDemuxer();
 			uint8_t		dumpHeaders(uint8_t *ptr,uint32_t *size);
-			uint8_t 		open(char *file);			
+			uint8_t 		open(const char *file);			
 			uint8_t		setPos( uint64_t pos );
 			uint8_t		readHeader(uint32_t *paySize, uint32_t *flag,uint64_t *frame,
 							uint8_t *id);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -179,7 +179,7 @@
 // Open and get the headears/index built
 // along way
 //______________________________________
-uint8_t    OpenDMLHeader::open(char *name)
+uint8_t    OpenDMLHeader::open(const char *name)
 {
 uint8_t badAvi=0;
 uint32_t rd;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -123,7 +123,7 @@
 					OpenDMLHeader( void ) ;
        		    			~OpenDMLHeader(  ) ;
 // AVI io
-virtual 	uint8_t			open(char *name);
+virtual 	uint8_t			open(const char *name);
 virtual 	uint8_t			close(void) ;
   //__________________________
   //				 Info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -78,7 +78,7 @@
 		
 	}
 }
-riffParser::riffParser(char *name)
+riffParser::riffParser(const char *name)
 {
 	ADM_assert(fd=fopen(name,"rb"));
 	startPos=0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_openDML/ADM_riff.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -9,7 +9,7 @@
 	uint64_t curPos;
 	uint8_t  _root;
 
-	riffParser(char *name);
+	riffParser(const char *name);
 	riffParser(riffParser *o, uint32_t size);
 	~riffParser();
 	uint64_t getPos( void );

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ad_layer.cc	2008-06-24 19:46:05 UTC (rev 4157)
@@ -36,4 +36,4 @@
 	}
 	nb_alloc=0;
 
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.cc	2008-06-24 19:46:05 UTC (rev 4157)
@@ -25,4 +25,4 @@
    work properly if the same thread does the locking and unlocking. Gaah!
  */
 
-// MEANX : removed, not used & cause problem on cygwin
\ No newline at end of file
+// MEANX : removed, not used & cause problem on cygwin

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/ADM_crashHook.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/ADM_crashHook.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/ADM_crashHook.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -33,7 +33,7 @@
 void saveCrashProject(void)
 {
   char *baseDir=ADM_getBaseDir();
-  char *name=CRASH_FILE;
+  const char *name=CRASH_FILE;
   static int crashCount=0;
   if(crashCount) return ; // avoid endless looping
   crashCount++;
@@ -53,7 +53,7 @@
 void checkCrashFile(void)
 {
   char *baseDir=ADM_getBaseDir();
-  char *name=CRASH_FILE;
+  const char *name=CRASH_FILE;
   static int crashCount=0;
   char *where=new char[strlen(baseDir)+strlen(name)+2];
   strcpy(where,baseDir);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -31,10 +31,10 @@
 
 extern VF_FILTERS filterGetTagFromName(const char *inname);
 extern uint8_t A_ListAllBlackFrames( char *file );
-extern uint8_t loadVideoCodecConfString( char *name);
+extern uint8_t loadVideoCodecConfString( const char *name);
 extern uint8_t ADM_saveRaw (const char *name);
 extern int A_saveJpg (char *name);
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern void filterCleanUp( void );
 
 JSPropertySpec ADM_JSAvidemuxVideo::avidemuxvideo_properties[] = 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -47,7 +47,7 @@
 
 extern void filterListAll(void );
 
-extern uint8_t loadVideoCodecConf( char *name);
+extern uint8_t loadVideoCodecConf( const char *name);
 extern int A_saveJpg (char *name);
 extern void filterLoadXml(char *n);
 extern int A_openAvi(char *name);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -92,20 +92,21 @@
 
         gtk_widget_show(dialog);
 
-        if(useTray)
-        {
-              gtk_window_iconify(GTK_WINDOW(dialog));
-              UI_iconify();
-        }
+		if (useTray)
+		{
+			gtk_window_iconify(GTK_WINDOW(dialog));
+			UI_iconify();
+			tray = new ADM_tray(dialog);
+		}
+		else
+			tray = NULL;
+
         _lastTime=0;
         _lastFrame=0;
         _fps_average=0;
-        tray=NULL;
         _total=1000;
-        if(useTray)
-                tray=new ADM_tray("Encoding");
+}
 
-}
 void DIA_encoding::setFps(uint32_t fps)
 {
         _roundup=(uint32_t )floor( (fps+999)/1000);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,13 +1,11 @@
 /***************************************************************************
-                          adm_encdivx.cpp  -  description
-                             -------------------
+                              ADM_tray_gtk.cpp
+                              ----------------
+
     begin                : Sun Jul 14 2002
-    copyright            : (C) 2002 by mean
+    copyright            : (C) 2002 by mean/gruntster
     email                : fixounet at free.fr
 
-
-Derived from MLdonkey systray code
-http://savannah.nongnu.org/cvs/?group=mldonkey
  ***************************************************************************/
 
 /***************************************************************************
@@ -19,76 +17,108 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "config.h"
+
+#include <string.h>
+#include <stdio.h>
+
 #include "ADM_toolkitGtk.h"
 #include "ADM_tray.h"
-extern "C"
+
+extern void UI_deiconify(void);
+
+static GdkPixbuf **pixbuf = NULL;
+static int lastIcon;
+
+static const char *animated[] = {
+	"film1.png","film3.png","film5.png","film7.png","film9.png",
+	"film11.png","film13.png","film15.png","film17.png","film19.png",
+	"film21.png","film23.png"};
+
+void tray_icon_on_click(GtkStatusIcon *status_icon, gpointer user_data)
 {
-#include "systray.h"
+	gtk_window_deiconify(GTK_WINDOW(user_data));
+	UI_deiconify();
 }
-static int nbTray=0;
-static  GdkPixbuf   **pixbuf=NULL;
 
-extern GdkPixbuf        *create_pixbuf                  (const gchar     *filename);
-/*
-class ADM_tray
+static void tray_menu_open_avidemux(GtkStatusIcon *status_icon, gpointer user_data)
 {
-protected:
+	gtk_window_deiconify(GTK_WINDOW(user_data));
+	UI_deiconify();
+}
 
-public:
-        ADM_tray(char *name);
-        ~ADM_tray();
-        setPercent(int percent);
-        setStatus(int working);
+static void tray_icon_popup_menu(GtkStatusIcon *status_icon, guint button, guint activate_time, gpointer user_data)
+{
+	GtkWidget *popupMenu = gtk_menu_new();
+	GtkWidget *item = gtk_menu_item_new_with_label(QT_TR_NOOP("Open Avidemux"));
 
-};*/
-static const char *animated[]={
-    "film1.png","film3.png","film5.png","film7.png","film9.png",
-    "film11.png","film13.png","film15.png","film17.png","film19.png",
-    "film21.png","film23.png"};
-ADM_tray::ADM_tray(char *name)
+	gtk_menu_append(popupMenu, item);
+	g_signal_connect(G_OBJECT(item), "activate", G_CALLBACK(tray_menu_open_avidemux), user_data);
+
+	gtk_widget_show_all(popupMenu);
+	gtk_menu_popup(GTK_MENU(popupMenu), NULL, NULL, gtk_status_icon_position_menu, status_icon, button, activate_time);
+}
+
+ADM_tray::ADM_tray(void* parent)
 {
-        ADM_assert(!nbTray);
-        nbTray++;
+	_parent = parent;
+	lastIcon = 0;
+	int nb = sizeof(animated) / sizeof(char *);
 
+	if (!pixbuf)
+	{
+		pixbuf = new GdkPixbuf*[nb];
 
-  int nb=sizeof(animated)/sizeof(char *);
-  if(!pixbuf)
-  {
-      pixbuf=new GdkPixbuf*[nb];
-      for(int i=0;i<nb;i++)
-      {
-        pixbuf[i]=create_pixbuf(animated[i]);
-        if(!pixbuf[i])
-        {
-          printf("Failed to create <%s>\n",animated[i]);
-          ADM_assert(0);
-        }
-      }
+		for (int i = 0; i < nb; i++)
+		{
+			pixbuf[i] = create_pixbuf(animated[i]);
 
-  }
-  sys=adm_new_systray(pixbuf,nb,name);
+			if (!pixbuf[i])
+			{
+				printf("Failed to create <%s>\n", animated[i]);
+				ADM_assert(0);
+			}
+		}
+	}
 
+	sys = gtk_status_icon_new_from_pixbuf(pixbuf[0]);
+
+	g_signal_connect(G_OBJECT(sys), "activate", G_CALLBACK(tray_icon_on_click), _parent);
+	g_signal_connect(G_OBJECT(sys), "popup-menu", G_CALLBACK(tray_icon_popup_menu), _parent);
+	gtk_status_icon_set_tooltip((GtkStatusIcon*)sys, "Avidemux");
+	gtk_status_icon_set_visible((GtkStatusIcon*)sys, TRUE);
 }
+
 ADM_tray::~ADM_tray()
 {
-        nbTray--;
-        ADM_assert(!nbTray);
-        if(sys)
-                adm_delete_systray(sys);
-        sys=NULL;
+	if (sys)
+		gtk_status_icon_set_visible((GtkStatusIcon*)sys, FALSE);
+
+	sys = NULL;
 }
+
 uint8_t ADM_tray::setPercent(int percent)
 {
-char percentS[40];
-        sprintf(percentS,"%d %%",percent);
-        if(sys)
-        {
-                adm_changeIcon_systray();
-                adm_change_tooltip(sys,percentS);
-        }
-        return 1;
+	char percentS[40];
+
+	sprintf(percentS, "Avidemux [%d%%]", percent);
+
+	if (sys)
+	{
+		int maxIcons = sizeof(animated) / sizeof(char *);
+		lastIcon++;
+
+		if (lastIcon >= maxIcons)
+			lastIcon = 0;
+
+		gtk_status_icon_set_from_pixbuf((GtkStatusIcon*)sys, pixbuf[lastIcon]);
+		gtk_status_icon_set_tooltip((GtkStatusIcon*)sys, percentS);
+	}
+
+	return 1;
 }
+
 uint8_t ADM_tray::setStatus(int working)
 {
-        return 1;
+	return 1;
 }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2008-06-24 19:46:05 UTC (rev 4157)
@@ -2,7 +2,7 @@
 
 SET(${ADM_LIB}_SRCS
 	ADM_tray_gtk.cpp  
-    eggtrayicon.c eggtray_win32.c gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp  mediactrl.c
+    gtkmarkscale.c jogshuttle.c ADM_jogshuttle.cpp  mediactrl.c
 ADM_icons.cpp
 
 )

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtray_win32.c	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,287 +0,0 @@
-/*
-    Borrowed from mldonkey
-*/
-/* Copyright 2004 b8_bavard, INRIA */
-/*
-    This file is part of mldonkey.
-
-    mldonkey is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; either version 2 of the License, or
-    (at your option) any later version.
-
-    mldonkey is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License
-    along with mldonkey; if not, write to the Free Software
-    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-
-/* Stub code to interface with Shell_NotifyIcon */
-#include "config.h"
-#ifdef __WIN32
-#include <windows.h>
-#include <wingdi.h>
-
-#include <gdk/gdk.h> 
-#include <gdk/gdkwin32.h>
-#include <gdk-pixbuf/gdk-pixbuf.h>
-
-#include <stdio.h>
-#include <systray.h>
-#define WM_TRAYMESSAGE           WM_USER /* User defined WM Message */
-#define SYSTRAY_LBUTTONDBLCLK    0
-#define SYSTRAY_LBUTTONCLK       1
-#define SYSTRAY_RBUTTONCLK       2
-
-static UINT timerID = 3;
-static NOTIFYICONDATA nid;
-static HWND systray_hwnd=0;
-static HICON systray_hicon=0;
-static int  win32egg_nb=0;
-static GdkPixbuf **win32egg_pixbuf;
-static int flipflop=0;
-LRESULT msg_handler(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
-{
-  static UINT taskbarRestartMsg; /* static here means value is kept across multiple calls to this func */
-
-  switch(msg) {
-    case WM_CREATE:
-      taskbarRestartMsg = RegisterWindowMessage("TaskbarCreated");
-      break;
-
-    case WM_TIMER:
-        #if 0
-      KillTimer(hWnd, timerID);
-      call_caml_systray_clicked(SYSTRAY_LBUTTONCLK);
-      #endif
-      break;
-
-    case WM_DESTROY:
-      break;
-
-    case WM_TRAYMESSAGE:
-#if 0
-      switch (lParam) {
-        case WM_RBUTTONUP:
-          call_caml_systray_clicked(SYSTRAY_RBUTTONCLK);
-          break;
-
-        case WM_LBUTTONDBLCLK:
-          KillTimer(hWnd, timerID);
-          call_caml_systray_clicked(SYSTRAY_LBUTTONDBLCLK);
-          break;
-
-        case WM_LBUTTONDOWN:
-          SetTimer(hWnd, timerID, GetDoubleClickTime(), NULL);
-          break;
-
-      }
-#endif
-    default: 
-      if (msg == taskbarRestartMsg) {
-        /* explorer crashed and left us hanging... 
-           This will put the systray icon back in it's place, when it restarts */
-        Shell_NotifyIcon(NIM_ADD,&nid);
-      }
-      break;
-
-  }/* end switch */
-
-  return DefWindowProc(hWnd, msg, wParam, lParam);
-
-} 
-/* Create hidden window to process systray messages */
-
-static HWND systray_create_hiddenwin(void)
-{
-
-  WNDCLASSEX wcex;
-  TCHAR wname[32];
-
-  strcpy(wname, "Win");
-
-  wcex.cbSize = sizeof(WNDCLASSEX);
-
-  wcex.style = 0;
-  wcex.lpfnWndProc = (WNDPROC)msg_handler;
-  wcex.cbClsExtra = 0;
-  wcex.cbWndExtra = 0;
-  wcex.hInstance = GetModuleHandle(NULL);
-  wcex.hIcon = NULL;
-  wcex.hCursor = NULL,
-  wcex.hbrBackground = NULL;
-  wcex.lpszMenuName = NULL;
-  wcex.lpszClassName = wname;
-  wcex.hIconSm = NULL;
-
-  RegisterClassEx(&wcex);
-
-  /* Create the window */
-  return (CreateWindow(wname, "", 0, 0, 0, 0, 0, GetDesktopWindow(), NULL, GetModuleHandle(NULL), 0));
-}
-
-/* taken and modified from gdk/win32/gdkwindow-win32.c */
-
-HICON pixmap_to_hicon (GdkPixmap *pixmap, GdkBitmap *mask)
-{
-  ICONINFO ii;
-  HICON hIcon;
-  gint w = 0, h = 0;
-  HANDLE hpixmap = NULL;
-  HBITMAP hbitmap = NULL;
-
-  /* Create Drawing Context */
-  HDC hdc1 = NULL;
-  HBITMAP hbitmaptmp1 = NULL;
-
-    if (!pixmap) {
-      return NULL;
-    }
-
-    gdk_drawable_get_size (GDK_DRAWABLE (pixmap), &w, &h);
-
-    hpixmap = gdk_win32_drawable_get_handle (pixmap); 
-
-    /* we need the inverted mask for the XOR op */
-    hdc1 = CreateCompatibleDC (NULL);
-    hbitmap = CreateCompatibleBitmap (hdc1, w, h);
-    hbitmaptmp1 = SelectObject (hdc1, hbitmap);
-
-    if (mask) {
-      HANDLE hmask = NULL;
-      HDC hdc2 = NULL;
-      HBITMAP hbitmaptmp2 = NULL;
-
-      hmask = gdk_win32_drawable_get_handle (mask); 
-
-      hdc2 = CreateCompatibleDC (NULL);
-      hbitmaptmp2 = SelectObject (hdc2, hmask);
-
-      BitBlt (hdc1, 0,0,w,h, hdc2, 0,0, NOTSRCCOPY);    
-
-      SelectObject (hdc2, hbitmaptmp2);
-      DeleteDC (hdc2);
-    } else {
-      RECT rect;
-      GetClipBox (hdc1, &rect);
-      FillRect (hdc1, &rect, GetStockObject (WHITE_BRUSH));
-    }
-
-    SelectObject (hdc1, hbitmaptmp1); 
-    DeleteDC (hdc1); 
- 
-    ii.fIcon = TRUE;
-    ii.xHotspot = ii.yHotspot = 0; /* ignored for icons */
-    ii.hbmMask = hbitmap;
-    ii.hbmColor = hpixmap; 
-
-    hIcon = CreateIconIndirect (&ii);
-    if (!hIcon) {
-      return NULL;
-    }
-
-    DeleteObject (hbitmap);
-
-    return hIcon;
-}
-
-NOTIFYICONDATA systray_init(GdkPixbuf *pixbuf,  char* text) 
-{
-  GdkPixmap *pm;
-  GdkBitmap *mask;
-
-  gdk_pixbuf_render_pixmap_and_mask(pixbuf, &pm, &mask, 128);
-
-  char* locenc=NULL;
-
-  ZeroMemory(&nid,sizeof(nid));
-  systray_hicon = pixmap_to_hicon (pm, mask);
-  systray_hwnd = systray_create_hiddenwin();
-
-  nid.cbSize=sizeof(NOTIFYICONDATA);
-  nid.hWnd=systray_hwnd;
-  nid.uID=0;
-  nid.uFlags=NIF_ICON | NIF_MESSAGE | NIF_TIP ;
-  nid.uCallbackMessage=WM_TRAYMESSAGE;
-  nid.hIcon=systray_hicon;
-
-  if(text) {
-    locenc = g_locale_from_utf8(text, -1, NULL, NULL, NULL);
-    lstrcpy(nid.szTip, locenc);
-    g_free(locenc);
-  }
-
-  Shell_NotifyIcon(NIM_ADD,&nid);
-  return nid;
-}
-
-void systray_modify_icon (GdkPixmap *pm, GdkBitmap *mask) 
-{
-
-  systray_hicon = pixmap_to_hicon (pm, mask);
-  nid.hIcon = systray_hicon;
-  Shell_NotifyIcon(NIM_MODIFY,&nid);
-}
-
-void systray_modify_tooltip (const char* text) 
-{
-  char *locenc=NULL;
-
-  if(text) {
-    locenc = g_locale_from_utf8(text, -1, NULL, NULL, NULL);
-    lstrcpy(nid.szTip, locenc);
-    g_free(locenc);
-  }
-  Shell_NotifyIcon(NIM_MODIFY,&nid);
-}
-
-void systray_remove_nid(void) 
-{
-  DestroyWindow(nid.hWnd);
-  Shell_NotifyIcon(NIM_DELETE,&nid);
-}
-//*********************************************************
-//*********************************************************
-//*********************************************************
-void *adm_new_systray(GdkPixbuf *zpixbuf[],int nb, char *name)
-{
-void *r;
-	flipflop=0;
-	win32egg_pixbuf=zpixbuf;
-	win32egg_nb=nb;
-  systray_init(win32egg_pixbuf[0],  name);
-  r=(void *)0xdead;
-  return r;
-
-}
-void adm_delete_systray(void *systray)
-{
- systray_remove_nid() ;
-}
-void adm_change_tooltip(void *systray, const char *tips)
-{
-    systray_modify_tooltip (tips ) ;
-}
-void adm_changeIcon_systray(void)
-{
-  GdkPixmap *pm;
-  GdkBitmap *mask;
-  GdkPixbuf *icon;
-	flipflop=flipflop%win32egg_nb;
-	icon=win32egg_pixbuf[flipflop];
-	//ADM_assert(icon);
-
-  	gdk_pixbuf_render_pixmap_and_mask(icon, &pm, &mask, 128);
-
-
-	systray_modify_icon (pm, mask) ;
-
-		
-	flipflop++;
-	flipflop=flipflop%win32egg_nb;
-}
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.c	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,520 +0,0 @@
-/* -*- Mode: C; tab-width: 8; indent-tabs-mode: t; c-basic-offset: 8 -*- */
-/* eggtrayicon.c
- * Copyright (C) 2002 Anders Carlsson <andersca at gnu.org>
- *
- * This library is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2 of the License, or (at your option) any later version.
- *
- * This library is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with this library; if not, write to the
- * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
- * Boston, MA 02111-1307, USA.
- */
-#include "config.h"
-
-#ifndef __WIN32
-#ifndef HAVE_GTK_X11
-#include <gtk/gtk.h>
-
-void *adm_new_systray(GdkPixbuf *pixbufA[], int nb, char *name) {}
-void adm_delete_systray(void *systray) {}
-void adm_change_tooltip(void *systray, const char *tips) {}
-void adm_changeIcon_systray(void) {}
-#else
-#include <gtk/gtk.h>
-#include <gtk/gtkversion.h>
-
-#include "eggtrayicon.h"
-#include <string.h>
-#include "systray.h"
-#include "ADM_assert.h"
-#define SYSTEM_TRAY_REQUEST_DOCK    0
-#define SYSTEM_TRAY_BEGIN_MESSAGE   1
-#define SYSTEM_TRAY_CANCEL_MESSAGE  2
-
-#define SYSTEM_TRAY_ORIENTATION_HORZ 0
-#define SYSTEM_TRAY_ORIENTATION_VERT 1
-
-enum {
-  PROP_0,
-  PROP_ORIENTATION
-};
-         
-static GtkPlugClass *parent_class = NULL;
-
-static void egg_tray_icon_init (EggTrayIcon *icon);
-static void egg_tray_icon_class_init (EggTrayIconClass *klass);
-
-static void egg_tray_icon_get_property (GObject    *object,
-                                        guint       prop_id,
-                                        GValue     *value,
-                                        GParamSpec *pspec);
-
-static void egg_tray_icon_realize   (GtkWidget *widget);
-static void egg_tray_icon_unrealize (GtkWidget *widget);
-
-static void egg_tray_icon_update_manager_window (EggTrayIcon *icon);
-
-static GtkWidget   *img=NULL;
-
-static GdkPixbuf **listOfIcons=NULL;
-static int nbListOfIcons=0;
-static int flipflop=0;
-
-GType egg_tray_icon_get_type (void)
-{
-  static GType our_type = 0;
-
-  if (our_type == 0)
-    {
-      static const GTypeInfo our_info =
-      {
-	sizeof (EggTrayIconClass),
-	(GBaseInitFunc) NULL,
-	(GBaseFinalizeFunc) NULL,
-	(GClassInitFunc) egg_tray_icon_class_init,
-	NULL, /* class_finalize */
-	NULL, /* class_data */
-	sizeof (EggTrayIcon),
-	0,    /* n_preallocs */
-	(GInstanceInitFunc) egg_tray_icon_init
-      };
-
-      our_type = g_type_register_static (GTK_TYPE_PLUG, "EggTrayIcon", &our_info, 0);
-    }
-
-  return our_type;
-}
-
-static void egg_tray_icon_init (EggTrayIcon *icon)
-{
-  icon->stamp = 1;
-  icon->orientation = GTK_ORIENTATION_HORIZONTAL;
-  
-  gtk_widget_add_events (GTK_WIDGET (icon), GDK_PROPERTY_CHANGE_MASK);
-}
-
-static void egg_tray_icon_class_init (EggTrayIconClass *klass)
-{
-  GObjectClass *gobject_class = (GObjectClass *)klass;
-  GtkWidgetClass *widget_class = (GtkWidgetClass *)klass;
-
-  parent_class = g_type_class_peek_parent (klass);
-
-  gobject_class->get_property = egg_tray_icon_get_property;
-
-  widget_class->realize   = egg_tray_icon_realize;
-  widget_class->unrealize = egg_tray_icon_unrealize;
-
-  g_object_class_install_property (gobject_class,
-				   PROP_ORIENTATION,
-				   g_param_spec_enum ("orientation",
-						      "Orientation",
-						      "The orientation of the tray.",
-						      GTK_TYPE_ORIENTATION,
-						      GTK_ORIENTATION_HORIZONTAL,
-						      G_PARAM_READABLE));
-}
-
-static void egg_tray_icon_get_property (GObject    *object,
-                            guint       prop_id,
-                            GValue     *value,
-                            GParamSpec *pspec)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (object);
-
-  switch (prop_id)
-    {
-    case PROP_ORIENTATION:
-      g_value_set_enum (value, icon->orientation);
-      break;
-    default:
-      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);
-      break;
-    }
-}
-
-static void egg_tray_icon_get_orientation_property (EggTrayIcon *icon)
-{
-  Display *xdisplay;
-  Atom type;
-  int format;
-	union {
-	  gulong *prop;
-		guchar *prop_ch;
-	} prop = { NULL };
-  gulong nitems;
-  gulong bytes_after;
-  int error, result;
-
-  g_assert (icon->manager_window != None);
-
-  xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-
-  gdk_error_trap_push ();
-  type = None;
-  result = XGetWindowProperty (xdisplay,
-			       icon->manager_window,
-			       icon->orientation_atom,
-			       0, G_MAXLONG, FALSE,
-			       XA_CARDINAL,
-			       &type, &format, &nitems,
-			       &bytes_after, &(prop.prop_ch));
-  error = gdk_error_trap_pop ();
-
-  if (error || result != Success)
-    return;
-
-  if (type == XA_CARDINAL)
-    {
-      GtkOrientation orientation;
-
-      orientation = (prop.prop [0] == SYSTEM_TRAY_ORIENTATION_HORZ) ?
-					GTK_ORIENTATION_HORIZONTAL :
-					GTK_ORIENTATION_VERTICAL;
-
-      if (icon->orientation != orientation)
-	{
-	  icon->orientation = orientation;
-
-	  g_object_notify (G_OBJECT (icon), "orientation");
-	}
-    }
-
-  if (prop.prop)
-    XFree (prop.prop);
-}
-
-static GdkFilterReturn egg_tray_icon_manager_filter (GdkXEvent *xevent, GdkEvent *event, gpointer user_data)
-{
-  EggTrayIcon *icon = user_data;
-  XEvent *xev = (XEvent *)xevent;
-
-  if (xev->xany.type == ClientMessage &&
-      xev->xclient.message_type == icon->manager_atom &&
-      xev->xclient.data.l[1] == icon->selection_atom)
-    {
-      egg_tray_icon_update_manager_window (icon);
-    }
-  else if (xev->xany.window == icon->manager_window)
-    {
-      if (xev->xany.type == PropertyNotify &&
-	  xev->xproperty.atom == icon->orientation_atom)
-	{
-	  egg_tray_icon_get_orientation_property (icon);
-	}
-      if (xev->xany.type == DestroyNotify)
-	{
-	  egg_tray_icon_update_manager_window (icon);
-	}
-    }
-  
-  return GDK_FILTER_CONTINUE;
-}
-
-static void egg_tray_icon_unrealize (GtkWidget *widget)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (widget);
-  GdkWindow *root_window;
-
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (widget),
-                                              icon->manager_window);
-
-      gdk_window_remove_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-    }
-
-  root_window = gdk_screen_get_root_window (gtk_widget_get_screen (widget));
-
-  gdk_window_remove_filter (root_window, egg_tray_icon_manager_filter, icon);
-
-  if (GTK_WIDGET_CLASS (parent_class)->unrealize)
-    (* GTK_WIDGET_CLASS (parent_class)->unrealize) (widget);
-}
-
-static void egg_tray_icon_send_manager_message (EggTrayIcon *icon,
-				    long         message,
-				    Window       window,
-				    long         data1,
-				    long         data2,
-				    long         data3)
-{
-  XClientMessageEvent ev;
-  Display *display;
-  
-  ev.type = ClientMessage;
-  ev.window = window;
-  ev.message_type = icon->system_tray_opcode_atom;
-  ev.format = 32;
-  ev.data.l[0] = gdk_x11_get_server_time (GTK_WIDGET (icon)->window);
-  ev.data.l[1] = message;
-  ev.data.l[2] = data1;
-  ev.data.l[3] = data2;
-  ev.data.l[4] = data3;
-
-  display = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-  
-  gdk_error_trap_push ();
-  XSendEvent (display,
-	      icon->manager_window, False, NoEventMask, (XEvent *)&ev);
-  XSync (display, False);
-  gdk_error_trap_pop ();
-}
-
-static void egg_tray_icon_send_dock_request (EggTrayIcon *icon)
-{
-  egg_tray_icon_send_manager_message (icon,
-				      SYSTEM_TRAY_REQUEST_DOCK,
-				      icon->manager_window,
-				      gtk_plug_get_id (GTK_PLUG (icon)),
-				      0, 0);
-}
-
-static void egg_tray_icon_update_manager_window (EggTrayIcon *icon)
-{
-  Display *xdisplay;
-
-  xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-  
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (GTK_WIDGET (icon)),
-					      icon->manager_window);
-      
-      gdk_window_remove_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-    }
-  
-  XGrabServer (xdisplay);
-  
-  icon->manager_window = XGetSelectionOwner (xdisplay,
-					     icon->selection_atom);
-
-  if (icon->manager_window != None)
-    XSelectInput (xdisplay,
-		  icon->manager_window, StructureNotifyMask|PropertyChangeMask);
-
-  XUngrabServer (xdisplay);
-  XFlush (xdisplay);
-  
-  if (icon->manager_window != None)
-    {
-      GdkWindow *gdkwin;
-
-      gdkwin = gdk_window_lookup_for_display (gtk_widget_get_display (GTK_WIDGET (icon)),
-					      icon->manager_window);
-      
-      gdk_window_add_filter (gdkwin, egg_tray_icon_manager_filter, icon);
-
-      /* Send a request that we'd like to dock */
-      egg_tray_icon_send_dock_request (icon);
-
-      egg_tray_icon_get_orientation_property (icon);
-    }
-}
-
-static void egg_tray_icon_realize (GtkWidget *widget)
-{
-  EggTrayIcon *icon = EGG_TRAY_ICON (widget);
-  GdkScreen *screen;
-  GdkDisplay *display;
-  Display *xdisplay;
-  char buffer[256];
-  GdkWindow *root_window;
-
-  if (GTK_WIDGET_CLASS (parent_class)->realize)
-    GTK_WIDGET_CLASS (parent_class)->realize (widget);
-
-  screen = gtk_widget_get_screen (widget);
-  display = gdk_screen_get_display (screen);
-  xdisplay = gdk_x11_display_get_xdisplay (display);
-
-  /* Now see if there's a manager window around */
-  g_snprintf (buffer, sizeof (buffer),
-	      "_NET_SYSTEM_TRAY_S%d",
-	      gdk_screen_get_number (screen));
-
-  icon->selection_atom = XInternAtom (xdisplay, buffer, False);
-  
-  icon->manager_atom = XInternAtom (xdisplay, "MANAGER", False);
-  
-  icon->system_tray_opcode_atom = XInternAtom (xdisplay,
-						   "_NET_SYSTEM_TRAY_OPCODE",
-						   False);
-
-  icon->orientation_atom = XInternAtom (xdisplay,
-					"_NET_SYSTEM_TRAY_ORIENTATION",
-					False);
-
-  egg_tray_icon_update_manager_window (icon);
-
-  root_window = gdk_screen_get_root_window (screen);
-
-  /* Add a root window filter so that we get changes on MANAGER */
-  gdk_window_add_filter (root_window,
-			 egg_tray_icon_manager_filter, icon);
-}
-
-EggTrayIcon *egg_tray_icon_new_for_xscreen (Screen *xscreen, const char *name)
-{
-  GdkDisplay *display;
-  GdkScreen *screen;
-
-  display = gdk_x11_lookup_xdisplay (DisplayOfScreen (xscreen));
-  screen = gdk_display_get_screen (display, XScreenNumberOfScreen (xscreen));
-
-  return egg_tray_icon_new_for_screen (screen, name);
-}
-
-EggTrayIcon *egg_tray_icon_new_for_screen (GdkScreen *screen, const char *name)
-{
-  g_return_val_if_fail (GDK_IS_SCREEN (screen), NULL);
-
-  return g_object_new (EGG_TYPE_TRAY_ICON, "screen", screen, "title", name, NULL);
-}
-
-EggTrayIcon *egg_tray_icon_new (const gchar *name)
-{
-  return g_object_new (EGG_TYPE_TRAY_ICON, "title", name, NULL);
-}
-
-guint egg_tray_icon_send_message (EggTrayIcon *icon,
-			    gint         timeout,
-			    const gchar *message,
-			    gint         len)
-{
-  guint stamp;
-  
-  g_return_val_if_fail (EGG_IS_TRAY_ICON (icon), 0);
-  g_return_val_if_fail (timeout >= 0, 0);
-  g_return_val_if_fail (message != NULL, 0);
-		     
-  if (icon->manager_window == None)
-    return 0;
-
-  if (len < 0)
-    len = strlen (message);
-
-  stamp = icon->stamp++;
-  
-  /* Get ready to send the message */
-  egg_tray_icon_send_manager_message (icon, SYSTEM_TRAY_BEGIN_MESSAGE,
-				      (Window)gtk_plug_get_id (GTK_PLUG (icon)),
-				      timeout, len, stamp);
-
-  /* Now to send the actual message */
-  gdk_error_trap_push ();
-  while (len > 0)
-    {
-      XClientMessageEvent ev;
-      Display *xdisplay;
-
-      xdisplay = GDK_DISPLAY_XDISPLAY (gtk_widget_get_display (GTK_WIDGET (icon)));
-      
-      ev.type = ClientMessage;
-      ev.window = (Window)gtk_plug_get_id (GTK_PLUG (icon));
-      ev.format = 8;
-      ev.message_type = XInternAtom (xdisplay,
-				     "_NET_SYSTEM_TRAY_MESSAGE_DATA", False);
-      if (len > 20)
-	{
-	  memcpy (&ev.data, message, 20);
-	  len -= 20;
-	  message += 20;
-	}
-      else
-	{
-	  memcpy (&ev.data, message, len);
-	  len = 0;
-	}
-
-      XSendEvent (xdisplay,
-		  icon->manager_window, False, StructureNotifyMask, (XEvent *)&ev);
-      XSync (xdisplay, False);
-    }
-  gdk_error_trap_pop ();
-
-  return stamp;
-}
-
-void egg_tray_icon_cancel_message (EggTrayIcon *icon,
-			      guint        id)
-{
-  g_return_if_fail (EGG_IS_TRAY_ICON (icon));
-  g_return_if_fail (id > 0);
-  
-  egg_tray_icon_send_manager_message (icon, SYSTEM_TRAY_CANCEL_MESSAGE,
-				      (Window)gtk_plug_get_id (GTK_PLUG (icon)),
-				      id, 0, 0);
-}
-
-GtkOrientation egg_tray_icon_get_orientation (EggTrayIcon *icon)
-{
-  g_return_val_if_fail (EGG_IS_TRAY_ICON (icon), GTK_ORIENTATION_HORIZONTAL);
-
-  return icon->orientation;
-}
-/**************************************************************/
-static GtkWidget   *systray_icon = NULL;
-static GtkWidget   *evbox = NULL;
-static GtkTooltips *systray_icon_tooltips = NULL;
-
-void *adm_new_systray(GdkPixbuf *pixbufA[],int nb , char *name)
-{
-	flipflop=0;
-  systray_icon = GTK_WIDGET (egg_tray_icon_new ("Avidemux"));
-  nbListOfIcons=nb;
-  if(listOfIcons) ADM_dealloc(listOfIcons);
-  listOfIcons=NULL;
-  listOfIcons=ADM_alloc(sizeof( GdkPixbuf *)*nb);
-  memcpy(listOfIcons,pixbufA,sizeof(GdkPixbuf *)*nb);
-  img = gtk_image_new_from_pixbuf (listOfIcons[0]);
-  
-
-  evbox = gtk_event_box_new ();
-  gtk_container_add (GTK_CONTAINER (systray_icon), evbox);
-  gtk_container_add (GTK_CONTAINER (evbox), img);
-  gtk_widget_show_all (systray_icon);
-  gtk_widget_realize (systray_icon);
-  gtk_widget_show (systray_icon);
-
-  systray_icon_tooltips = gtk_tooltips_new ();
-  gtk_tooltips_enable (systray_icon_tooltips);
-
-  gtk_tooltips_set_tip (systray_icon_tooltips, systray_icon, "avidemux", "");
-  return (void *)systray_icon;
-}
-void adm_delete_systray(void *systray)
-{
- ADM_assert( (void*)systray_icon==systray);
- gtk_widget_destroy(systray_icon);
-}
-void adm_change_tooltip(void *systray, const char *tips)
-{
- ADM_assert( (void*)systray_icon==systray);
- gtk_tooltips_set_tip (systray_icon_tooltips, systray_icon, tips, "");
-}
-void adm_changeIcon_systray(void)
-{
-GdkPixbuf *cur;
-	flipflop%=nbListOfIcons; // Double check
-	cur=listOfIcons[flipflop];
-		ADM_assert(cur);
-	flipflop++;
-	flipflop%=nbListOfIcons; // Double check
-  	gtk_image_set_from_pixbuf( GTK_IMAGE(img), GDK_PIXBUF(cur));
-
-}
-#endif	// HAVE_GTK_X11
-#endif	// __WIN32

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,82 +0,0 @@
-/* -*- Mode: C; tab-width: 8; indent-tabs-mode: t; c-basic-offset: 8 -*- */
-/* eggtrayicon.h
- * Copyright (C) 2002 Anders Carlsson <andersca at gnu.org>
- *
- * This library is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2 of the License, or (at your option) any later version.
- *
- * This library is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with this library; if not, write to the
- * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
- * Boston, MA 02111-1307, USA.
- */
-
-#ifndef __EGG_TRAY_ICON_H__
-#define __EGG_TRAY_ICON_H__
-
-#include <gtk/gtkplug.h>
-#include <gdk/gdkx.h>
-#include <X11/Xatom.h>
-
-G_BEGIN_DECLS
-
-#define EGG_TYPE_TRAY_ICON		(egg_tray_icon_get_type ())
-#define EGG_TRAY_ICON(obj)		(G_TYPE_CHECK_INSTANCE_CAST ((obj), EGG_TYPE_TRAY_ICON, EggTrayIcon))
-#define EGG_TRAY_ICON_CLASS(klass)	(G_TYPE_CHECK_CLASS_CAST ((klass), EGG_TYPE_TRAY_ICON, EggTrayIconClass))
-#define EGG_IS_TRAY_ICON(obj)		(G_TYPE_CHECK_INSTANCE_TYPE ((obj), EGG_TYPE_TRAY_ICON))
-#define EGG_IS_TRAY_ICON_CLASS(klass)	(G_TYPE_CHECK_CLASS_TYPE ((klass), EGG_TYPE_TRAY_ICON))
-#define EGG_TRAY_ICON_GET_CLASS(obj)	(G_TYPE_INSTANCE_GET_CLASS ((obj), EGG_TYPE_TRAY_ICON, EggTrayIconClass))
-
-typedef struct _EggTrayIcon	  EggTrayIcon;
-typedef struct _EggTrayIconClass  EggTrayIconClass;
-
-struct _EggTrayIcon
-{
-  GtkPlug parent_instance;
-
-  guint stamp;
-
-  Atom selection_atom;
-  Atom manager_atom;
-  Atom system_tray_opcode_atom;
-  Atom orientation_atom;
-  Window manager_window;
-
-  GtkOrientation orientation;
-};
-
-struct _EggTrayIconClass
-{
-  GtkPlugClass parent_class;
-};
-
-
-GType        egg_tray_icon_get_type       (void);
-
-EggTrayIcon *egg_tray_icon_new_for_screen (GdkScreen   *screen,
-					   const gchar *name);
-
-
-
-guint        egg_tray_icon_send_message   (EggTrayIcon *icon,
-					   gint         timeout,
-					   const char  *message,
-					   gint         len);
-void         egg_tray_icon_cancel_message (EggTrayIcon *icon,
-					   guint        id);
-
-GtkOrientation egg_tray_icon_get_orientation (EggTrayIcon *icon);
-
-EggTrayIcon *egg_tray_icon_new            (const gchar *name);
-
-G_END_DECLS
-#endif /* __EGG_TRAY_ICON_H__ */
-
-

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h	2008-06-24 19:46:05 UTC (rev 4157)
@@ -22,8 +22,9 @@
 {
 protected:
         void    *sys;
+		void *_parent;
 public:
-                ADM_tray(char *name);
+                ADM_tray(void *parent);
                 ~ADM_tray();
         uint8_t setPercent(int percent);
         uint8_t setStatus(int working);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_action.names	2008-06-24 19:46:05 UTC (rev 4157)
@@ -162,4 +162,4 @@
 ACT(AVS_PROXY)
 ACT(JOG)
 ACT(GLYPHEDIT)
-ACT(PLUGIN_INFO)
\ No newline at end of file
+ACT(PLUGIN_INFO)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux_icon.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux_icon.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux_icon.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * avidemux_icon_xpm[] = {
+static const char * avidemux_icon_xpm[] = {
 "64 64 824 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/begin.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/begin.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/begin.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-const char * xpm_begin[] = {
+static const char * xpm_begin[] = {
 "32 20 56 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/end.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/end.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/end.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-const char * xpm_end[] = {
+static const char * xpm_end[] = {
 "32 20 55 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * gnome_calculator_xpm[] = {
+static const char * gnome_calculator_xpm[] = {
 "24 24 175 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator_small.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator_small.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/gnome-calculator_small.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * gnome_calculator_small_xpm[] = {
+static const char * gnome_calculator_small_xpm[] = {
 "16 16 94 2",
 "  	c None",
 ". 	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/stop.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/stop.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/stop.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * xpm_stop[] = {
+static const char * xpm_stop[] = {
 "32 20 30 1",
 " 	c None",
 ".	c #000000",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * systray_xpm[] = {
+static const char * systray_xpm[] = {
 "22 23 288 2",
 "  	c None",
 ". 	c #DDD4DC",

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray2.xpm
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray2.xpm	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/xpm/systray2.xpm	2008-06-24 19:46:05 UTC (rev 4157)
@@ -1,5 +1,5 @@
 /* XPM */
-static char * systray2_xpm[] = {
+static const char * systray2_xpm[] = {
 "22 23 288 2",
 "  	c None",
 ". 	c #F2D8DF",

Modified: branches/avidemux_2.5_branch_gruntster/po/es.po
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/es.po	2008-06-24 17:44:25 UTC (rev 4156)
+++ branches/avidemux_2.5_branch_gruntster/po/es.po	2008-06-24 19:46:05 UTC (rev 4157)
@@ -2,8 +2,8 @@
 msgstr ""
 "Project-Id-Version: Avidemux 2.4\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2008-04-24 20:19+0100\n"
-"PO-Revision-Date: 2008-05-03 07:10+0100\n"
+"POT-Creation-Date: 2008-06-12 15:04+0100\n"
+"PO-Revision-Date: 2008-06-16 01:17+0100\n"
 "Last-Translator: Festor Wailon Dacoba <festor90 at gmail.com>\n"
 "Language-Team:  <juliocesarmartin at msn.com>\n"
 "MIME-Version: 1.0\n"
@@ -62,8 +62,8 @@
 msgstr "PSP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:52
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:194
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:283
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:277
 msgid "FLV"
 msgstr "FLV"
 
@@ -89,9 +89,8 @@
 msgstr "H.263+ (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:143
-#, fuzzy
 msgid "MPEG-4 ASP (lavc)"
-msgstr "MPEG-PS (A+V)"
+msgstr "MPEG-4 ASP (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:159
 msgid "DV (lavc)"
@@ -134,9 +133,8 @@
 msgstr "SVCD (lavc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:461
-#, fuzzy
 msgid "VCD (mpeg2enc)"
-msgstr "IPOD (mpeg4)"
+msgstr "VCD (mpeg2enc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:493
 msgid "SVCD (mpeg2enc)"
@@ -148,18 +146,16 @@
 msgstr "Cuantizador MPEG"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:539
-#, fuzzy
 msgid "DVD (mpeg2enc)"
-msgstr "IPOD (mpeg4)"
+msgstr "DVD (mpeg2enc)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:671
 msgid "MPEG-4 ASP (Xvid4)"
 msgstr "MPEG-4 ASP (Xvid4)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:812
-#, fuzzy
 msgid "MPEG-4 AVC (x264)"
-msgstr "MPEG-PS (A+V)"
+msgstr "MPEG-4 AVC (x264)"
 
 #: avidemux/ADM_encoder/ADM_encCodecDesc.h:829
 msgid "dummy"
@@ -171,9 +167,9 @@
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:367
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:143
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:265
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:286
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:191
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:259
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:280
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:166
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:264
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:285
@@ -192,14 +188,12 @@
 msgstr "DivX"
 
 #: avidemux/ADM_encoder/adm_encffmpeg.h:47
-#, fuzzy
 msgid "LavCodec"
-msgstr "Codec:"
+msgstr "LavCodec"
 
 #: avidemux/ADM_encoder/adm_encmjpeg.h:60
-#, fuzzy
 msgid "MJPEG"
-msgstr "MPEG"
+msgstr "MJPEG"
 
 #: avidemux/ADM_encoder/adm_encmpeg2enc.h:57
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
@@ -218,9 +212,8 @@
 msgstr "Xvid"
 
 #: avidemux/ADM_encoder/adm_encXvid4.h:62
-#, fuzzy
 msgid "Xvid4"
-msgstr "Xvid"
+msgstr "Xvid4"
 
 #: avidemux/ADM_encoder/adm_encyv12.h:69
 msgid "YV12"
@@ -332,11 +325,11 @@
 
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 #: avidemux/gui_autodrive.cpp:62
-#: avidemux/gui_autodrive.cpp:74
-#: avidemux/gui_autodrive.cpp:120
-#: avidemux/gui_autodrive.cpp:135
-#: avidemux/gui_autodrive.cpp:162
-#: avidemux/gui_autodrive.cpp:196
+#: avidemux/gui_autodrive.cpp:72
+#: avidemux/gui_autodrive.cpp:113
+#: avidemux/gui_autodrive.cpp:128
+#: avidemux/gui_autodrive.cpp:155
+#: avidemux/gui_autodrive.cpp:189
 msgid "Codec Error"
 msgstr "Error de codec"
 
@@ -389,6 +382,13 @@
 msgid "Aborted"
 msgstr "Abortado"
 
+#: avidemux/ADM_editor/ADM_edit.cpp:82
+msgid ""
+"Avidemux detected VBR MP3 audio in this file. For keeping audio/video in sync, time map is needed. Build it now?\n"
+"\n"
+"You can do it later with \"Audio -> Build VBR Time Map\"."
+msgstr ""
+
 #: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Tipo de archivo identificado pero no se ha detectado soporte para cargarlo..."
@@ -421,18 +421,20 @@
 msgstr "?Construir mapa de tiempo VBR?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "Use that mode"
+#, fuzzy
+msgid "Use safe mode"
 msgstr "Utilizar este modo"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
-msgid "H264 detected"
-msgstr "H264 detectado"
+msgid "H.264 detected"
+msgstr "H.264 detectado"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:585
+#, fuzzy
 msgid ""
-"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
-"Do you want to use that mode ?"
+"If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
+"Avidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode?"
 msgstr ""
 "Si el archivo utiliza el imagen B como referencia, puede llevar a un cuelgue o malfuncionamiento.\n"
 "Avidemux puede utilizar otro modo de forma segura pero <b>PERDER? LA EXACTITUD DE IMAGEN</b>.\n"
@@ -911,16 +913,15 @@
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 #: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:80
-#, fuzzy
 msgid "MPlayer hqdn3d"
-msgstr "MPlayer eq2"
+msgstr "MPlayer hqdn3d"
 
 #: avidemux/ADM_filter/filter_declaration.cpp:131
 msgid "High quality version of denoise3d. Slower but more precise."
 msgstr "Versi?n de alta calidad de denoise3d. M?s lento pero preciso."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:132
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:138
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:139
 msgid "FluxSmooth"
 msgstr ""
 
@@ -1297,7 +1298,7 @@
 msgid "Indexing"
 msgstr "Indexando"
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:376
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:379
 msgid "Incompatible frame rate"
 msgstr "Framerate incompatible"
 
@@ -1349,14 +1350,14 @@
 #: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:325
 #: avidemux/gtk_gui.cpp:903
 #: avidemux/gtk_gui.cpp:1505
@@ -1410,19 +1411,37 @@
 msgid "Could not read \"%s\"."
 msgstr "No se pudo leer \"%s\"."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 msgid "Output file error"
 msgstr "Error de archivo de salida"
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:87
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:78
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "No se pudo abrir \"%s\" para escritura."
 
-#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:105
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+#, fuzzy
+msgid "Input file error"
+msgstr "Error de archivo de salida"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:86
+msgid "Unknown source type"
+msgstr "Tipo de fuente desconocida"
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:92
+msgid "Bitmap source failed"
+msgstr ""
+
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
 msgid "Problem loading sub"
 msgstr "Problema cargando sub"
 
+#: avidemux/ADM_ocr/ADM_ocrEngine.cpp:100
+msgid "No subs"
+msgstr ""
+
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "Error en Ifo"
@@ -1577,8 +1596,8 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:256
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:141
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:195
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:269
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:263
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:164
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:268
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
@@ -1619,38 +1638,32 @@
 msgstr "PCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:487
-#, fuzzy
 msgid "MP2"
-msgstr "MP4"
+msgstr "MP2"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:488
-#, fuzzy
 msgid "MP3"
-msgstr "MP4"
+msgstr "MP3"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:489
-#, fuzzy
 msgid "WMA"
-msgstr "MAD"
+msgstr "WMA"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:490
-#, fuzzy
 msgid "LPCM"
-msgstr "PCM"
+msgstr "LPCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:491
 msgid "AC3"
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:492
-#, fuzzy
 msgid "Ogg Vorbis"
-msgstr "Vorbis"
+msgstr "Ogg Vorbis"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:494
-#, fuzzy
 msgid "AAC"
-msgstr "FAAC"
+msgstr "AAC"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:495
 msgid "QDM2"
@@ -1661,9 +1674,8 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:497
-#, fuzzy
 msgid "MSADPCM"
-msgstr "MAD"
+msgstr "MSADPCM"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:498
 msgid "ULAW"
@@ -1678,17 +1690,15 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:502
-#, fuzzy
 msgid "Unknown codec"
-msgstr "Desconocido"
+msgstr "Codec desconocido"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:109
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:134
 #: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:111
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:223
-#, fuzzy
 msgid "Saving"
-msgstr "Guardando audio"
+msgstr "Guardando"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
 msgid ""
@@ -1700,7 +1710,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:149
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:203
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:197
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:176
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
 msgid "Filter init failed"
@@ -1728,26 +1738,24 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:246
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:153
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:207
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:201
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:188
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:143
-#, fuzzy
 msgid "Encoding"
-msgstr "Codificando:"
+msgstr "Codificando"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:250
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:467
-#, fuzzy
 msgid "2nd Pass"
-msgstr "Segunda pasada"
+msgstr "2nd pasada"
 
 #: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
 msgid "Smart Copy"
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:135
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:189
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:183
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:156
 msgid "Cannot initialize the video stream"
 msgstr "No se puede iniciar la pista de v?deo"
@@ -1758,8 +1766,8 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:179
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:215
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:233
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:332
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:227
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:326
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:214
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:337
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:421
@@ -1768,13 +1776,13 @@
 msgstr "Error durante la codificaci?n"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid "KeyFrame error"
 msgstr "Error de Imagen-Clave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:190
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:244
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:238
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:226
 msgid ""
 "The beginning frame is not a key frame.\n"
@@ -1783,28 +1791,28 @@
 "La imagen inicial no es un Imagen-Clave\n"
 "Desplace el marcador A."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Unsupported video"
 msgstr "V?deo no soportado"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:145
 msgid "Only FLV1 and VP6 video are supported"
 msgstr "S?lo los v?deos FLV1 y VP6 son soportados"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Unsupported audio"
 msgstr "Audio no soportado"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:167
 msgid "Audio must be mp3 for flv output."
 msgstr "El formato de audio debe ser MP3 para el formato de salida FVL"
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:172
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
 msgstr "La frecuencia debe ser 44100, 22050 o 11025 Hz."
 
-#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
+#: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:248
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:253
 msgid "Cannot initialize the audio stream"
 msgstr "No se puede inicializar la pista de audio"
@@ -1851,27 +1859,23 @@
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:230
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:287
-#, fuzzy
 msgid "MPEG TS"
-msgstr "MPEG"
+msgstr "MPEG TS"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:231
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:288
-#, fuzzy
 msgid "MPEG VCD"
-msgstr "MPEG"
+msgstr "MPEG VCD"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:232
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:289
-#, fuzzy
 msgid "MPEG SVCD"
-msgstr "MPEG"
+msgstr "MPEG SVCD"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:233
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:290
-#, fuzzy
 msgid "MPEG DVD"
-msgstr "MPEG"
+msgstr "MPEG DVD"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:193
 msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
@@ -1902,14 +1906,12 @@
 msgstr ""
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:278
-#, fuzzy
 msgid "MPEG Requantizer"
-msgstr "Cuantizador MPEG"
+msgstr "Recuantizador MPEG"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:286
-#, fuzzy
 msgid "MPEG ES"
-msgstr "MPEG"
+msgstr "MPEG ES"
 
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:305
 msgid "Reuse log file ?"
@@ -1940,9 +1942,8 @@
 msgstr "No se pudo inicializar audio"
 
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp:70
-#, fuzzy
 msgid "Saving..."
-msgstr "Guardar"
+msgstr "Guardando..."
 
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:111
 msgid "Pass one"
@@ -2390,9 +2391,8 @@
 msgstr "Entrelazando:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:88
-#, fuzzy
 msgid "libavcodec MPEG-2 Configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n libavcodec MPEG-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flv1.cpp:44
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:109
@@ -2413,15 +2413,32 @@
 msgstr "_Minutos:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
-#, fuzzy
 msgid "_Seconds:"
-msgstr "Segunda pasada"
+msgstr "Segunda pasada:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:32
 #, fuzzy
 msgid "Go to Time"
 msgstr "Saltar a _tiempo..."
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:6
+msgid "_Job name:"
+msgstr "Nombre de tarea"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+#, fuzzy
+msgid "Output _File:"
+msgstr "Archivo de Salida"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:7
+#, fuzzy
+msgid "Select Video To Write"
+msgstr "Seleccione archivo AVI para escribir"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_jobs_save.cpp:10
+msgid "Save Job"
+msgstr "Guardar tarea"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
 msgid "Full"
 msgstr "Completo"
@@ -2544,9 +2561,8 @@
 msgstr "Control de Frecuencia"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:120
-#, fuzzy
 msgid "libavcodec MPEG-4 configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n libavcodec MPEG-4"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:26
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
@@ -2568,97 +2584,96 @@
 msgstr "_Swap U&V:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:39
-#, fuzzy
 msgid "MJPEG Configuration"
-msgstr "Configuraci?n MPEG-2"
+msgstr "Configuraci?n MJPEG"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:85
 msgid "Select idx file:"
 msgstr "Seleccionar archivo idx:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
 msgid "Use GlyphSet (optional):"
 msgstr "Usar GliphSet (opcional):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:367
 #, fuzzy
 msgid "Select GlyphSet file"
 msgstr "Seleccionar archivo de salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 msgid "Output SRT file"
 msgstr "Archivo SRT de salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:203
 #, fuzzy
 msgid "Save SRT file"
 msgstr "Guardar el archivo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:214
 msgid "Select input and ouput files"
 msgstr "Seleccionar archivos de entrada y salida"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:119
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:238
 msgid "The idx/sub file does not exist."
 msgstr "El archivo idx/sub no existe."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:231
 msgid "Please Select a valid output SRT file."
 msgstr "Seleccione o introduzca un archivo SRT v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:128
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:247
 msgid "Cannot load the glyphset file."
 msgstr "No se puede cargar el archivo glyphset."
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 #, fuzzy
 msgid "GlyphSet filename"
 msgstr "Nombre no v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:268
 #, fuzzy
 msgid "Save GlyphSet file"
 msgstr "Guardar el archivo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:149
 msgid "Save Glyph"
 msgstr "Guardar Glyph"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 #, fuzzy
 msgid "Input TS:"
 msgstr "Entrada"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:200
 #, fuzzy
 msgid "Select TS file"
 msgstr "Seleccionar archivo TTF"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:201
 msgid "Subtitle PID:"
 msgstr "Subt?tulos PID:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:202
 msgid "Use glyphset (optional):"
 msgstr "Usar glyphset (opcional):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:225
 #, fuzzy
 msgid "Please Select a valid TS file."
 msgstr "Seleccione o introduzca un archivo SRT v?lido"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:270
 #, fuzzy
 msgid "Save GlyphSet"
 msgstr "Guardar Glyph"
@@ -3066,7 +3081,6 @@
 msgstr "Codificando:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
-#, fuzzy
 msgid "S_elect C_olor"
 msgstr "Seleccionar color"
 
@@ -4668,57 +4682,6 @@
 msgid "Run Job"
 msgstr "Ejecutar tarea"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-#, fuzzy
-msgid "Select Video to Write"
-msgstr "Seleccione archivo AVI para escribir"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Invalid filename"
-msgstr "Nombre no v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename."
-msgstr "Seleccione o introduzca un nombre v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Invalid jobname"
-msgstr "Nombre no v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname."
-msgstr "Seleccione o introduzca un nombre v?lido"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
-msgid "Save Job"
-msgstr "Guardar tarea"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
-msgid "Select the output file"
-msgstr "Seleccionar archivo de salida"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
-msgid "_Browse..."
-msgstr "Buscar..."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
-msgid "Job name displayed in the job list and used as the script filename"
-msgstr "Nombre de tarea mostrado en la lista de tareas y utilizado como nombre del script"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
-msgid "Filename of the audio/video output"
-msgstr "Nombre del archivo de salida"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
-msgid "_Job name:"
-msgstr "Nombre de tarea"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
-msgid "Output _file:"
-msgstr "Archivo de Salida"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:379
 msgid "Mplayer Delogo"
 msgstr "Mplayer Delogo"
@@ -5115,7 +5078,7 @@
 msgid "Configure"
 msgstr "Configurar"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:89
 msgid "none"
 msgstr "ninguno"
 
@@ -5123,6 +5086,16 @@
 msgid "Select .idx file"
 msgstr "Seleccionar archivo .idx"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+#, fuzzy
+msgid "Wrong VobSub parametering"
+msgstr "Configuraci?n VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:109
+#, fuzzy
+msgid "The idx/sub file does not set."
+msgstr "El archivo idx/sub no existe."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
 msgid "VobSub Settings"
 msgstr "Configuraci?n VobSub"
@@ -6323,6 +6296,11 @@
 msgid "Select Color"
 msgstr "Seleccionar color"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:90
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp:244
+msgid "_Browse..."
+msgstr "Buscar..."
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:99
 #, fuzzy
 msgid "_Encoding mode:"
@@ -7793,12 +7771,12 @@
 msgid "Blend Threshold"
 msgstr "Umbral de cambio de escena"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:133
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
 #, fuzzy
 msgid "_Temporal threshold:"
 msgstr "Umbral:"
 
-#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:134
+#: avidemux/ADM_videoFilter/ADM_vidFlux.cpp:135
 #, fuzzy
 msgid "_Spatial threshold:"
 msgstr "Umbral:"
@@ -8743,14 +8721,14 @@
 msgstr "Es necesaria una pista de audio para crear ese tipo de archivo"
 
 #: avidemux/gui_autodrive.cpp:63
-msgid "You need Xvid4 and either LAME or FAAC support for the iPod profile"
+msgid "Xvid4 and FAAC support is required for the iPod profile."
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:74
+#: avidemux/gui_autodrive.cpp:72
 msgid "Cannot select the MPEG-4 SP codec."
 msgstr "No se puede seleccionar el codec MPEG4 SP."
 
-#: avidemux/gui_autodrive.cpp:121
+#: avidemux/gui_autodrive.cpp:114
 msgid ""
 "You don't have LAME!.\n"
 "It is needed to create FLV  video."
@@ -8758,15 +8736,15 @@
 "Sin soporte para LAME.\n"
 "Es necesario para crear v?deos FLV."
 
-#: avidemux/gui_autodrive.cpp:135
+#: avidemux/gui_autodrive.cpp:128
 msgid "Cannot select FLV1  codec."
 msgstr "No se puede seleccionar el codec FLV1."
 
-#: avidemux/gui_autodrive.cpp:162
+#: avidemux/gui_autodrive.cpp:155
 msgid "Cannot select mpeg4 sp codec."
 msgstr "No se puede seleccionar el codec MPEG4 SP."
 
-#: avidemux/gui_autodrive.cpp:197
+#: avidemux/gui_autodrive.cpp:190
 msgid ""
 "You don't have FAAC!.\n"
 "It is needed to create PSP compatible video."
@@ -8854,3 +8832,20 @@
 "Puede necesitar copia inteligente.\n"
 " ?Activar?"
 
+#~ msgid "Invalid filename"
+#~ msgstr "Nombre no v?lido"
+#~ msgid "Please select or enter a valid filename."
+#~ msgstr "Seleccione o introduzca un nombre v?lido"
+#~ msgid "Invalid jobname"
+#~ msgstr "Nombre no v?lido"
+#~ msgid "Please select or enter a valid jobname."
+#~ msgstr "Seleccione o introduzca un nombre v?lido"
+#~ msgid "Select the output file"
+#~ msgstr "Seleccionar archivo de salida"
+#~ msgid "Job name displayed in the job list and used as the script filename"
+#~ msgstr ""
+#~ "Nombre de tarea mostrado en la lista de tareas y utilizado como nombre "
+#~ "del script"
+#~ msgid "Filename of the audio/video output"
+#~ msgstr "Nombre del archivo de salida"
+



From gruntster at mail.berlios.de  Tue Jun 24 23:23:33 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jun 2008 23:23:33 +0200
Subject: [Avidemux-svn-commit] r4158 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_core/src avidemux/ADM_coreImage/include
	avidemux/ADM_coreUI/include avidemux/ADM_coreUI/src
	avidemux/ADM_filter avidemux/ADM_libraries/ADM_utilities
	avidemux/ADM_script avidemux/ADM_toolkit
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2
	avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
	plugins/ADM_videoFilters/Srt
Message-ID: <200806242123.m5OLNXGl031072@sheep.berlios.de>

Author: gruntster
Date: 2008-06-24 23:23:15 +0200 (Tue, 24 Jun 2008)
New Revision: 4158

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_win32.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_fileSel.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_saveload.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemux.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/TLK_filesel.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/gtkgui.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/DIA_srt.cpp
Log:
[Merge] integrate changes from 2.4 branch (r4124)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -49,7 +49,11 @@
 #undef fopen
 #undef fclose
 
-size_t ADM_fread(void *ptr, size_t size, size_t n, FILE *sstream)
+#ifdef __MINGW32__
+extern int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString);
+#endif
+
+size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
 {
 	return fread(ptr,size,n,sstream);
 }
@@ -62,15 +66,16 @@
 FILE *ADM_fopen(const char *file, const char *mode)
 {
 #ifdef __MINGW32__
-	int nFileLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, file, -1, NULL, 0);
-	int nModeLen = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, mode, -1, NULL, 0);
-	wchar_t wFile[nFileLen + 1];
-	wchar_t wMode[nModeLen + 1];
+	int fileNameLength = utf8StringToWideChar(file, -1, NULL);
+	int modeLength = utf8StringToWideChar(mode, -1, NULL);
 
-	MultiByteToWideChar(CP_UTF8, 0, mode, -1, wMode, nModeLen + 1);
-	MultiByteToWideChar(CP_UTF8, 0, file, -1, wFile, nFileLen + 1);
+	wchar_t wcFile[fileNameLength];
+	wchar_t wcMode[modeLength];
 
-	return _wfopen(wFile, wMode);
+	utf8StringToWideChar(file, -1, wcFile);
+	utf8StringToWideChar(mode, -1, wcMode);
+
+	return _wfopen(wcFile, wcMode);
 #else
 	return fopen(file, mode);
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_win32.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_win32.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_win32.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -394,8 +394,6 @@
 	return true;
 }
 
-#define MONITOR_DEFAULTTONEAREST    0x00000002
-
 void redirectStdoutToFile(void)
 {
 	// Don't redirect stdout and stderr if SDL hasn't already hijacked it.
@@ -448,4 +446,31 @@
 
 	delete[] logPath;
 }
+
+// Convert string from ANSI code page to UTF-8
+int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String)
+{
+	int wideCharStringLen = MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, NULL, 0);
+	wchar_t wideCharString[wideCharStringLen];
+
+	MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, wideCharString, wideCharStringLen);
+
+	int multiByteStringLen = WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, NULL, 0, NULL, NULL);
+
+	if (utf8String)
+		WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, utf8String, multiByteStringLen, NULL, NULL);
+
+	return multiByteStringLen;
+}
+
+// Convert UTF-8 string to wide char
+int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
+{
+	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
+
+	if (wideCharString)
+		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
+
+	return wideCharStringLength;
+}
 #endif	// __WIN32

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h	2008-06-24 21:23:15 UTC (rev 4158)
@@ -107,10 +107,10 @@
 		const char *descText);
 
 /* Save / load filters */
-void filterSaveXml(char *name);
-void filterSaveXml(char *name,uint8_t silent);
-void filterLoadXml(char *name);
-int  filterLoadXml(char *name,uint8_t silent);
+void filterSaveXml(const char *name);
+void filterSaveXml(const char *name,uint8_t silent);
+void filterLoadXml(const char *name);
+int  filterLoadXml(const char *name,uint8_t silent);
 void filterSaveScriptJS(FILE *f);
 
  #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_fileSel.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_fileSel.h	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_fileSel.h	2008-06-24 21:23:15 UTC (rev 4158)
@@ -15,17 +15,17 @@
 
 #ifndef DIA_FILESEL_H
 #define DIA_FILESEL_H
-typedef void SELFILE_CB(char *);
+typedef void SELFILE_CB(const char *);
 
 // Associated functions type
-typedef void    DIA_FILE_SEL_CB(const char *label,SELFILE_CB cb);
+typedef void    DIA_FILE_SEL_CB(const char *label,SELFILE_CB *cb);
 typedef void    DIA_FILE_SEL_NAME(const char *label, char * * name);
 typedef uint8_t DIA_FILE_SELECT(const char *title,char *target,uint32_t max, const char *source);
 typedef void	DIA_FILE_INIT(void);
 
 // Old FileSel interface
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) ;
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) ;
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) ;
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) ;
 void GUI_FileSelRead(const char *label, char * * name);
 void GUI_FileSelWrite(const char *label, char * * name);
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -1,111 +1,202 @@
-/***************************************************************************
-                          DIA_fileSel.cpp
-  
-  (C) Mean 2008 fixounet at free.fr
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ADM_default.h"
-#include "DIA_coreToolkit.h"
-#include "DIA_coreUI_internal.h"
-
-static DIA_FILESEL_DESC_T *fileSelDescriptor=NULL;
-/**
- * 	\fn DIA_fileSelInit
- *  \brief Hook the fileDialog
- */
-uint8_t DIA_fileSelInit(DIA_FILESEL_DESC_T *d)
-{
-	fileSelDescriptor=d;
-	fileSelDescriptor->fileInit();
-	return 1;
-}
-
-// A bunch of boomerang functions
-/**
- * \fn GUI_FileSelRead
- * \brief Select a file for reading, when ok the CB callback is called with the name as argument
- */	
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) 
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileReadCb(label,cb);	
-}
-/**
- * \fn GUI_FileSelWrite
- * \brief Select a file for Writing, when ok the CB callback is called with the name as argument
- */	
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) 
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileWriteCb(label,cb);	
-}
-/**
- * \fn GUI_FileSelRead
- * \brief Select a file for reading, name is allocated with a copy of the name, null if fail.
- */	
-void GUI_FileSelRead(const char *label,char * * name) 
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileReadName(label,name);	
-}
-/**
- * \fn GUI_FileSelWrite
- * \brief Select a file for Writing, name is allocated with a copy of the name, null if fail.
- */	
-
-void GUI_FileSelWrite(const char *label,char * * name) 
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileWriteName(label,name);	
-}
-/**
- * \fn FileSel_SelectWrite
- * \brief Select a file for Writing, name is allocated with a copy of the name, null if fail.
- * @param title : [in] Title of the dialog box
- * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
- * @param max : [in] Max number of bytes the buffer will hold
- * @param source : [in] Initial value for the file, can be null
- */	
-uint8_t FileSel_SelectWrite(const char *title,char *target,uint32_t max, const char *source)
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileSelectWrite(title,target,max, source);
-}
-/**
- * \fn FileSel_SelectRead
- * \brief Select a file for Reading, name is allocated with a copy of the name, null if fail.
- * @param title : [in] Title of the dialog box
- * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
- * @param max : [in] Max number of bytes the buffer will hold
- * @param source : [in] Initial value for the file, can be null
- */	
-uint8_t FileSel_SelectRead(const char *title,char *target,uint32_t max, const char *source)
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileSelectRead(title,target,max, source);
-}
-/**
- * \fn FileSel_SelectDir
- * \brief Select a directory, name is allocated with a copy of the name, null if fail.
- * @param title : [in] Title of the dialog box
- * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
- * @param max : [in] Max number of bytes the buffer will hold
- * @param source : [in] Initial value for the file, can be null
- */	
-uint8_t FileSel_SelectDir(const char *title,char *target,uint32_t max, const char *source)
-{
-	ADM_assert(fileSelDescriptor);
-	return fileSelDescriptor->fileSelectDirectory(title,target,max, source);
-}
-
-// EOF
+/***************************************************************************
+                          DIA_fileSel.cpp
+  
+  (C) Mean 2008 fixounet at free.fr
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include <sys/stat.h>
+
+#include "ADM_default.h"
+#include "DIA_coreToolkit.h"
+#include "DIA_coreUI_internal.h"
+
+static DIA_FILESEL_DESC_T *fileSelDescriptor=NULL;
+/**
+ * 	\fn DIA_fileSelInit
+ *  \brief Hook the fileDialog
+ */
+uint8_t DIA_fileSelInit(DIA_FILESEL_DESC_T *d)
+{
+	fileSelDescriptor=d;
+	fileSelDescriptor->fileInit();
+	return 1;
+}
+
+// A bunch of boomerang functions
+/**
+ * \fn GUI_FileSelRead
+ * \brief Select a file for reading, when ok the CB callback is called with the name as argument
+ */	
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) 
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileReadCb(label,cb);	
+}
+/**
+ * \fn GUI_FileSelWrite
+ * \brief Select a file for Writing, when ok the CB callback is called with the name as argument
+ */	
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) 
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileWriteCb(label,cb);	
+}
+/**
+ * \fn GUI_FileSelRead
+ * \brief Select a file for reading, name is allocated with a copy of the name, null if fail.
+ */	
+void GUI_FileSelRead(const char *label,char * * name) 
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileReadName(label,name);	
+}
+/**
+ * \fn GUI_FileSelWrite
+ * \brief Select a file for Writing, name is allocated with a copy of the name, null if fail.
+ */	
+
+void GUI_FileSelWrite(const char *label,char * * name) 
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileWriteName(label,name);	
+}
+/**
+ * \fn FileSel_SelectWrite
+ * \brief Select a file for Writing, name is allocated with a copy of the name, null if fail.
+ * @param title : [in] Title of the dialog box
+ * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
+ * @param max : [in] Max number of bytes the buffer will hold
+ * @param source : [in] Initial value for the file, can be null
+ */	
+uint8_t FileSel_SelectWrite(const char *title,char *target,uint32_t max, const char *source)
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileSelectWrite(title,target,max, source);
+}
+/**
+ * \fn FileSel_SelectRead
+ * \brief Select a file for Reading, name is allocated with a copy of the name, null if fail.
+ * @param title : [in] Title of the dialog box
+ * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
+ * @param max : [in] Max number of bytes the buffer will hold
+ * @param source : [in] Initial value for the file, can be null
+ */	
+uint8_t FileSel_SelectRead(const char *title,char *target,uint32_t max, const char *source)
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileSelectRead(title,target,max, source);
+}
+/**
+ * \fn FileSel_SelectDir
+ * \brief Select a directory, name is allocated with a copy of the name, null if fail.
+ * @param title : [in] Title of the dialog box
+ * @param target: [in/out] Buffer that will hold the name, must be at least max bytes big
+ * @param max : [in] Max number of bytes the buffer will hold
+ * @param source : [in] Initial value for the file, can be null
+ */	
+uint8_t FileSel_SelectDir(const char *title,char *target,uint32_t max, const char *source)
+{
+	ADM_assert(fileSelDescriptor);
+	return fileSelDescriptor->fileSelectDirectory(title,target,max, source);
+}
+
+#warning QT_TR_NOOP
+#define QT_TR_NOOP
+
+void FileSel_ReadWrite(SELFILE_CB *cb, int rw, const char *name, const char *actual_workbench_file)
+{
+	if(name)
+	{
+		if(cb)
+		{
+			FILE *fd;
+			fd=ADM_fopen(name,"rb");
+			if(rw==0) // read
+			{
+				// try to open it..
+				if(!fd)
+				{
+					GUI_Error_HIG(QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\"."), name);
+					return;
+				}
+			}
+			else // write
+			{
+				if(fd){
+					struct stat buf;
+					int fdino;
+					ADM_fclose(fd);
+
+					char msg[300];
+
+					snprintf(msg, 300, QT_TR_NOOP("%s already exists.\n\nDo you want to replace it?"), ADM_GetFileName(name));
+
+					if(!GUI_Question(msg))
+						return;
+					/*
+					** JSC Fri Feb 10 00:07:30 CET 2006
+					** compare existing output file inode against each current open files inode
+					** i'm ignoring st_dev, so we may get false positives
+					** i'm testing until fd=1024, should be MAXFD computed by configure
+					** keep in mind:
+					** you can overwrite .idx files, they are loaded into memory and closed soon
+					** you cannot overwrite segment data files, all files are kept open and
+					** are detected here
+					*/
+#ifndef __WIN32
+					if( stat(name,&buf) == -1 ){
+						fprintf(stderr,"stat(%s) failed\n",name);
+						return;
+					}
+#endif
+					fdino = buf.st_ino;
+					for(int i=0;i<1024;i++){
+						if( fstat(i,&buf) != -1 ){
+							if( buf.st_ino == fdino ){
+								char str[512];
+								snprintf(str,512,"File \"%s\" exists and is opened by Avidemux",name);
+								GUI_Error_HIG(str,
+									QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
+								return;
+							}
+						}
+					}
+					/*
+					** compare output file against actual EMCAscript file
+					** need to stat() to avoid symlink (/home/x.js) vs. real file (/export/home/x.js) case
+					*/
+					if( actual_workbench_file ){
+						if( stat(actual_workbench_file,&buf) != -1 ){
+							if( buf.st_ino == fdino ){
+								char str[512];
+								snprintf(str,512,"File \"%s\" exists and is the actual ECMAscript file",name);
+								GUI_Error_HIG(str,QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
+								return;
+							}
+						}
+					}
+				}
+
+				// check we have right access to it
+				fd=ADM_fopen(name,"wb");
+				if(!fd)
+				{
+					GUI_Error_HIG(QT_TR_NOOP("Cannot write the file"),QT_TR_NOOP( "No write access to \"%s\"."), name);
+					return;
+				}
+			}
+			ADM_fclose(fd);
+			cb(name);
+		} // no callback -> return value
+	}
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_saveload.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_saveload.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_saveload.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -57,12 +57,12 @@
 /**
 	Xml Read/write ConfCouple from files
 */
-void filterSaveXml(char *docname)
+void filterSaveXml(const char *docname)
 {
 	filterSaveXml(docname,0);
 }
 
-void filterSaveXml(char *docname,uint8_t silent)
+void filterSaveXml(const char *docname,uint8_t silent)
 {
  xmlDocPtr xdoc;
  xmlNodePtr node;
@@ -130,12 +130,12 @@
 		xmlFreeDoc(xdoc);
 	return ;
 }
-void filterLoadXml(char *docname)
+void filterLoadXml(const char *docname)
 {
 	filterLoadXml(docname,0);
 }
 
-int filterLoadXml(char *docname,uint8_t silent)
+int filterLoadXml(const char *docname,uint8_t silent)
 {
  xmlDocPtr xdoc;
  xmlNodePtr node,subnode;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_gettext.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -11,7 +11,10 @@
 	char *local = setlocale(LC_ALL, "");
 
 #ifdef __WIN32
-	bindtextdomain("avidemux", "./share/locale");
+	char *localeDir = ADM_getInstallRelativePath("share", "locale");
+
+	bindtextdomain("avidemux", localeDir);
+	delete [] localeDir;
 #elif defined(__APPLE__)
 	char *localeDir = ADM_getInstallRelativePath("..", "Resources", "locale");
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemux.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemux.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemux.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -24,12 +24,12 @@
 #define MODULE_NAME MODULE_SCRIPT
 #include "ADM_osSupport/ADM_debug.h"
 
-extern int A_openAvi (char *name);
+extern int A_openAvi (const char *name);
 extern int A_Save (const char *name);
-extern int A_appendAvi (char *name);
+extern int A_appendAvi (const char *name);
 extern uint8_t ogmSave(char *name);
 extern int GUI_GoToFrame(uint32_t frame);
-extern int filterLoadXml(char *docname,uint8_t silent);
+extern int filterLoadXml(const char *docname,uint8_t silent);
 extern int A_delete(uint32_t start, uint32_t end);
 
 extern uint8_t A_ListAllBlackFrames( char *file );

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -49,9 +49,8 @@
 
 extern uint8_t loadVideoCodecConf( const char *name);
 extern int A_saveJpg (char *name);
-extern void filterLoadXml(char *n);
-extern int A_openAvi(char *name);
-extern int A_appendAvi (char *name);
+extern void filterLoadXml(const char *n);
+extern int A_appendAvi (const char *name);
 extern void A_saveAudio(char *name);
 extern int A_loadNone( void );
 extern void A_saveAudioDecodedTest(char *name);
@@ -100,12 +99,16 @@
 extern int A_SaveUnpackedVop(const char *name);
 extern int A_SavePackedVop(const char *name);
 extern int A_saveDVDPS(char *name);
-extern void A_saveWorkbench (char *name);
+extern void A_saveWorkbench (const char *name);
 extern uint8_t A_rebuildKeyFrame (void);
 extern uint8_t A_setContainer(const char *cont);
 uint8_t scriptAddVar(char *var,char *value);
 extern uint8_t ADM_vob2vobsub(char *nameVob, char *nameVobSub, char *nameIfo);
-//
+
+#ifdef __WIN32
+	extern int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String);
+#endif
+
 static int call_bframe(void);
 static int call_x264(void);
 static int call_packedvop(void);
@@ -145,7 +148,7 @@
         {"run",			1,"load and run a script",		(one_arg_type)A_parseECMAScript},
         {"audio-normalize",	1,"activate normalization",		call_normalize},
         {"audio-resample",	1,"resample to x hz",			call_resample},
-        {"filters",		1,"load a filter preset",		filterLoadXml}   ,
+        {"filters",		1,"load a filter preset",		(one_arg_type)filterLoadXml}   ,
         {"codec-conf",		1,"load a codec configuration",		(one_arg_type )loadVideoCodecConf}   ,
         {"vcd-res",		0,"set VCD resolution",			(one_arg_type)setVCD}              ,
         {"svcd-res",		0,"set SVCD resolution",		(one_arg_type)setSVCD}              ,
@@ -160,8 +163,8 @@
         {"save-raw-audio",	1,"save audio as-is ",			A_saveAudio},
         {"save-raw-video",	1,"save raw video stream (mpeg/... ) ",	(one_arg_type)ADM_saveRaw},
         {"save-uncompressed-audio",1,"save uncompressed audio",A_saveAudioDecodedTest},
-        {"load",		1,"load video or workbench",		(one_arg_type )A_openAvi},
-        {"load-workbench",	1,"load workbench file",		(one_arg_type)A_openAvi},
+        {"load",		1,"load video or workbench", (one_arg_type)A_openAvi},
+        {"load-workbench",	1,"load workbench file", (one_arg_type)A_openAvi},
         {"append",		1,"append video",			(one_arg_type)A_appendAvi},
         {"save",		1,"save avi",				save},		
         {"save-workbench",	1,"save workbench file",		(one_arg_type)A_saveWorkbench},
@@ -238,7 +241,17 @@
                       {
                             if(cur==1) 
                             {
-                                A_openAvi(argv[cur]);
+#ifdef __WIN32
+								int utf8StringLength = ansiStringToUtf8(argv[cur], -1, NULL);
+								char utf8FileName[utf8StringLength];
+
+								ansiStringToUtf8(argv[cur], -1, utf8FileName);
+
+								A_openAvi(utf8FileName);
+#else
+								A_openAvi(argv[cur]);
+#endif
+	
                             }
                             else
                                 printf("\n Found garbage %s\n",argv[cur]);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -28,8 +28,9 @@
     "JSC",
     "Anish Mistry",
     "Jakub Misak",
-    "Kuisathaverat \t",
-    "And all the others.",
+    "Kuisathaverat",
+	"Gruntster",
+    QT_TR_NOOP("and all the others."),
     NULL
   };
   const gchar *artists[] = {
@@ -50,12 +51,12 @@
   aboutdialog1 = gtk_about_dialog_new ();
   gtk_about_dialog_set_version (GTK_ABOUT_DIALOG (aboutdialog1), subversion);
 // /MEANX
-  gtk_about_dialog_set_name (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Avidemux"));
-  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("\302\251 2001-2007 Mean"));
-  gtk_about_dialog_set_comments (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Multiplatform video editor"));
+  gtk_about_dialog_set_name (GTK_ABOUT_DIALOG (aboutdialog1), "Avidemux");
+  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), "\302\251 2001 - 2008 Mean");
+  gtk_about_dialog_set_comments (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Multi-platform Video Editor"));
   gtk_about_dialog_set_license (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Avidemux is free software; you can redistribute it and/or modify it\nunder the terms of the GNU General Public License version 2\nas published by the Free Software Foundation.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any othe!
 r program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Library General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you m!
 ust give the recipients all the rights that\nyou have.  You mu!
 st make 
sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be l!
 icensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; !
 they are outside its scope.  The act of\nrunning the Program i!
 s not re
stricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work unde!
 r the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Excep!
 tion: if the Program itself is interactive but\n    does not n!
 ormally 
print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn add!
 ition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections !
 1 and 2 above on a medium\n    customarily used for software i!
 nterchan
ge; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable!
 .\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\npr!
 ohibited by law if you do not accept this License.  Therefore,!
  by\nmod
ifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this !
 License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which!
  is\nimplemented by public license practices.  Many people hav!
 e made\n
generous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Pu!
 blic License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goa!
 ls\nof preserving the free status of all derivatives of our fr!
 ee softw
are and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENT!
 IAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's !
 name and a brief idea of what it does.>\n    Copyright (C) <ye!
 ar>  <na
me of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) ye!
 ar name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating !
 your program into\nproprietary programs.  If your program is a!
  subrout
ine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Library General\nPublic License instead of this License."));
   gtk_about_dialog_set_website (GTK_ABOUT_DIALOG (aboutdialog1), "http://www.avidemux.org");
-  gtk_about_dialog_set_website_label (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("http://www.avidemux.org"));
+  gtk_about_dialog_set_website_label (GTK_ABOUT_DIALOG (aboutdialog1), "http://www.avidemux.org");
   gtk_about_dialog_set_authors (GTK_ABOUT_DIALOG (aboutdialog1), authors);
   gtk_about_dialog_set_artists (GTK_ABOUT_DIALOG (aboutdialog1), artists);
   gtk_about_dialog_set_translator_credits (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("translator-credits"));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -195,14 +195,14 @@
 GtkTreeIter iter;
 char *str;
 ADM_date  *date;
-char str1[200],str2[200],str3[200];
+char *str1,str2[200],str3[200];
 
         gtk_list_store_clear (jobs.store);
         for (uint32_t i = 0; i < jobs.nb; i++)
         {
-                sprintf(str1,"<span weight=\"heavy\"> %s </span>\n" 
-               "<span size=\"smaller\" style=\"oblique\" > %s </span> "
-                ,ADM_GetFileName(jobs.name[i]),QT_TR_NOOP(StringStatus[jobs.status[i].status]));
+               str1 = g_markup_printf_escaped("<span weight=\"heavy\">%s</span>\n" 
+               "<span size=\"smaller\" style=\"oblique\">%s</span>"
+                , ADM_GetFileName(jobs.name[i]), StringStatus[jobs.status[i].status]);
 
                 date=&(jobs.status[i].startDate);
                 sprintf(str2,"%02d:%02d:%02d",date->hours,
@@ -218,7 +218,8 @@
                 gtk_list_store_set (jobs.store, &iter, 0,str1,1,str2,2,str3,-1);
                 printf("Start : %s\n",str2);
                 printf("End : %s\n",str3);
-                
+
+				g_free(str1);
         }
 }
 //*************************************

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/TLK_filesel.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/TLK_filesel.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -1,21 +1,21 @@
 /***************************************************************************
-TLK_filesel.cpp  -  description
--------------------
-New version of file selector
+                          TLK_filesel.cpp  -  description
+                             -------------------
+	New version of file selector
 
-begin                : Fri Sep 20 2002
-copyright            : (C) 2002 by mean
-email                : fixounet at free.fr
-***************************************************************************/
+    begin                : Fri Sep 20 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
 
 /***************************************************************************
-*                                                                         *
-*   This program is free software; you can redistribute it and/or modify  *
-*   it under the terms of the GNU General Public License as published by  *
-*   the Free Software Foundation; either version 2 of the License, or     *
-*   (at your option) any later version.                                   *
-*                                                                         *
-***************************************************************************/
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
 
 #include "ADM_toolkitGtk.h"
 #include "DIA_coreToolkit.h"
@@ -34,11 +34,12 @@
 
 #define TH_READ 1
 #define TH_WRITE 2
+
 extern char *actual_workbench_file;
+extern void FileSel_ReadWrite(SELFILE_CB *cb, int rw, const char *name, const char *actual_workbench_file);
 
 namespace ADM_GTK_fileSel 
 {
-
 static void GUI_FileSel(const char *label, SELFILE_CB cb, int rw, char **name = NULL);
 uint8_t initFileSelector(void);
 
@@ -300,113 +301,6 @@
 	GUI_FileSel(label, NULL, 1, name);
 }
 
-// CYB 2005.02.23: DND
-void fileReadWrite(SELFILE_CB cb, int rw, char *name)
-{
-	if (name)
-	{
-		if (cb)
-		{
-			FILE *fd;
-			fd = fopen(name, "rb");
-
-			if (rw == 0) // read
-			{
-				// try to open it..
-				if (!fd)
-				{
-					GUI_Error_HIG(QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\"."), name);
-					return;
-				}
-			}
-			else // write
-			{
-				if (fd)
-				{
-					struct stat buf;
-					int fdino;
-					char msg[300];
-
-					fclose(fd);
-
-					snprintf(msg, 300, QT_TR_NOOP("%s already exists.\n\nDo you want to replace it?"), ADM_GetFileName(name));
-
-					if (!GUI_Question(msg))
-						return;
-
-					/*
-					** JSC Fri Feb 10 00:07:30 CET 2006
-					** compare existing output file inode against each current open files inode
-					** i'm ignoring st_dev, so we may get false positives
-					** i'm testing until fd=1024, should be MAXFD computed by configure
-					** keep in mind:
-					** you can overwrite .idx files, they are loaded into memory and closed soon
-					** you cannot overwrite segment data files, all files are kept open and
-					** are detected here
-					*/
-#ifndef __WIN32
-					if (stat(name,&buf) == -1)
-					{
-						fprintf(stderr, "stat(%s) failed\n", name);
-						return;
-					}
-#endif
-					fdino = buf.st_ino;
-					for (int i = 0; i < 1024; i++)
-					{
-						if (fstat(i, &buf) != -1)
-						{
-							if (buf.st_ino == fdino)
-							{
-								char str[512];
-
-								snprintf(str, 512, "File \"%s\" exists and is opened by Avidemux", name);
-								GUI_Error_HIG(str, QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
-
-								return;
-							}
-						}
-					}
-					/*
-					** compare output file against actual EMCAscript file
-					** need to stat() to avoid symlink (/home/x.js) vs. real file (/export/home/x.js) case
-					*/
-					if (actual_workbench_file)
-					{
-						if (stat(actual_workbench_file, &buf) != -1)
-						{
-							if (buf.st_ino == fdino)
-							{
-								char str[512];
-
-								snprintf(str, 512, "File \"%s\" exists and is the actual ECMAscript file", name);
-								GUI_Error_HIG(str, QT_TR_NOOP("It is possible that you are trying to overwrite an input file!"));
-
-								return;
-							}
-						}
-					}
-				}
-
-				// check we have right access to it
-				fd = fopen(name, "wb");
-
-				if (!fd)
-				{
-					GUI_Error_HIG(QT_TR_NOOP("Cannot write the file"), QT_TR_NOOP("No write access to \"%s\"."), name);
-
-					return;
-				}
-			}
-
-			fclose(fd);
-			cb(name);
-		} // no callback -> return value
-	}
-}
-// CYB 2005.02.23: DND
-
-
 void GUI_FileSel(const char *label, SELFILE_CB cb, int rw,char **rname)
 {
 	/* Create the selector */
@@ -492,7 +386,7 @@
 	// CYB 2005.02.23
 	if (cb)
 	{
-		fileReadWrite(cb, rw, name);
+		FileSel_ReadWrite(cb, rw, name, actual_workbench_file);
 		ADM_dealloc(name);
 	}
 	else

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -86,7 +86,6 @@
 
         dialog=create_dialogYN();
         gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
         gtk_register_dialog(dialog);
         if(gtk_dialog_run(GTK_DIALOG(dialog))==GTK_RESPONSE_YES)
         {
@@ -116,7 +115,6 @@
         }
         dialog=create_dialogInfo();
         gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
         gtk_register_dialog(dialog);
         gtk_dialog_run(GTK_DIALOG(dialog));
         gtk_unregister_dialog(dialog);
@@ -157,7 +155,7 @@
 			printf("Info: %s\n%s\n", primary, secondary_format);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary_format, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary_format);
 	}
 	else
 	{	
@@ -166,7 +164,7 @@
 			printf("Info: %s\n", primary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	
@@ -213,7 +211,7 @@
 			printf("Info: %s\n%s\n", primary, secondary_format);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary_format, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary_format);
 	}
 	else
 	{	
@@ -222,7 +220,7 @@
 			printf("Info: %s\n", primary);
 			return;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 	
@@ -266,7 +264,7 @@
 			printf("Info: %s\n%s\n", primary, secondary_format);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary_format, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary_format);
 	}
 	else
 	{	
@@ -275,7 +273,7 @@
 			printf("Info: %s\n", primary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 
@@ -323,7 +321,7 @@
 			printf("Info: %s\n%s\n", primary, secondary_format);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>\n\n", secondary_format, NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>\n\n%s", primary, secondary_format);
 	}
 	else
 	{	
@@ -332,7 +330,7 @@
 			printf("Info: %s\n", primary);
 			return 0;
 		}
-		alertstring = g_strconcat("<span size=\"larger\" weight=\"bold\">", primary, "</span>", NULL);
+		alertstring = g_markup_printf_escaped("<span size=\"larger\" weight=\"bold\">%s</span>", primary);
 	}
 	
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -72,7 +72,7 @@
 static uint32_t ADM_nbCustom=0;
 // Needed for DND
 // extern int A_openAvi (char *name);
-extern void A_appendAvi (char *name);
+extern int A_appendAvi (const char *name);
 
 
 static void on_audio_change(void);
@@ -98,10 +98,6 @@
         TARGET_ROOTWIN,
         TARGET_URL
 };
-enum 
-{
-   TARGET_URI_LIST
-};
  
 static GtkTargetEntry target_table[] = 
 {
@@ -120,10 +116,8 @@
 extern void guiCallback(GtkMenuItem * menuitem, gpointer user_data);
 extern void HandleAction(Action act);
 extern gboolean UI_on_key_press(GtkWidget *widget, GdkEventKey* event, gpointer user_data);
-namespace ADM_GTK_fileSel
-{
-extern void fileReadWrite(SELFILE_CB cb, int rw, char *name);
-};
+extern char *actual_workbench_file;
+extern void FileSel_ReadWrite(SELFILE_CB *cb, int rw, const char *name, const char *actual_workbench_file);
 
 // To build vcodec
 extern int encoderGetEncoderCount(void);
@@ -1117,21 +1111,25 @@
     \fn DNDmerge
     \brief Extract the actual filename from the DNDstring file://abcd and store it into where
 */
-static void DNDmerge(char **where, char *start,char *end)
+static void DNDmerge(char **where, char *start, char *end)
 {
-  int len=end-start;
-  ADM_assert(len>7); // file:// = 7 bytes
-  len-=7;
-  *where=(char *)ADM_alloc(end-start+1);  // 7 more but who cares ?
-  memcpy(*where,start+7,len);
-  
-  // chomp it
-  char *tail=(*where)+len;
-  do
-  { 
-      *tail=0;
-      tail--;
-  }while(*tail==0xA || *tail==0xd);
+	char urlFile[end - start + 1];
+	char *tail = urlFile + (end - start);
+
+	memcpy(urlFile, start, end - start);
+
+	do
+	{
+		*tail = 0;
+		tail--;
+	} while (*tail == '\r' || *tail == '\n');
+
+	gchar *filename = g_filename_from_uri(urlFile, NULL, NULL);
+
+	*where = new char[strlen(filename) + 1];
+	strcpy(*where, filename);
+
+	g_free(filename);
 }
 // DND CYB
 #define MAX_DND_FILES 20
@@ -1147,7 +1145,7 @@
    char *names[MAX_DND_FILES];
    
     memset(names,0,sizeof(char *)*MAX_DND_FILES);
-    if (info != TARGET_URI_LIST)
+    if (info != TARGET_STRING && info != TARGET_URL)
     {
       gtk_drag_finish(dc,TRUE,FALSE,t);
       return;
@@ -1181,15 +1179,14 @@
     for(int i=0;i<current-1;i++)
     {
       printf("DND : %d %s\n",i,names[i]);
-      char *filename=names[i];
-      if (avifileinfo) 
-              {
-    	  		   ADM_GTK_fileSel::fileReadWrite(A_appendAvi, 0, (char*)filename);
-               }
-               else
-               {
-            	   ADM_GTK_fileSel::fileReadWrite(reinterpret_cast <void (*)(char *)> (A_openAvi), 0, (char*)filename);
-               }
+
+      const char *filename = names[i];
+
+	  if (avifileinfo)
+		  FileSel_ReadWrite(reinterpret_cast <void (*)(const char *)> (A_appendAvi), 0, filename, actual_workbench_file);
+	  else
+		  FileSel_ReadWrite(reinterpret_cast <void (*)(const char *)> (A_openAvi), 0, filename, actual_workbench_file);
+
       ADM_dealloc(names[i]); 
     }
     gtk_drag_finish(dc,TRUE,FALSE,t);
@@ -1221,6 +1218,8 @@
 }
 uint8_t UI_setTimeShift(int onoff,int value)
 {
+	if (!value)
+		onoff = 0;
 
         gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (lookup_widget(guiRootWindow,"CheckButtonTimeshift")),onoff);
         gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(guiRootWindow,"spinbuttonTimeShift")),value) ;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -28,9 +28,9 @@
 static uint8_t FileSel_SelectRead(const char *title,char *target,uint32_t max, const char *source);
 static void init(void);
 //********************
-void GUI_FileSelRead(const char *label,SELFILE_CB cb) 
+void GUI_FileSelRead(const char *label,SELFILE_CB *cb) 
 {}
-void GUI_FileSelWrite(const char *label,SELFILE_CB cb) 
+void GUI_FileSelWrite(const char *label,SELFILE_CB *cb) 
 {}
 void GUI_FileSelRead(const char *label, char * * name)
 {}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -27,6 +27,7 @@
 #include "DIA_fileSel.h"
 #include "ADM_video/ADM_vidMisc.h"
 #include "prefs.h"
+#include "avi_vars.h"
 
 #include "ADM_userInterfaces/ADM_render/GUI_renderInternal.h"
 extern int global_argc;
@@ -45,7 +46,10 @@
 extern void initTranslator(void);
 extern void destroyTranslator(void);
 extern ADM_RENDER_TYPE UI_getPreferredRender(void);
-extern int A_openAvi2(char *name, uint8_t mode);
+extern int A_openAvi(const char *name);
+extern int A_appendAvi(const char *name);
+extern char *actual_workbench_file;
+extern void FileSel_ReadWrite(SELFILE_CB *cb, int rw, const char *name, const char *actual_workbench_file);
 
 int SliderIsShifted=0;
 static void setupMenus(void);
@@ -291,6 +295,8 @@
 	ui.lineEdit_2->installEventFilter(this);
 
 	this->setFocus(Qt::OtherFocusReason);
+
+	setAcceptDrops(true);
 }
 /**
 \fn     custom
@@ -447,13 +453,18 @@
 	{
 		urlList = event->mimeData()->urls();
 
-		if (urlList.size() > 0)
+		for (int fileIndex = 0; fileIndex < urlList.size(); fileIndex++)
 		{
-			fileName = urlList[0].toLocalFile();
+			fileName = urlList[fileIndex].toLocalFile();
 			info.setFile(fileName);
 
 			if (info.isFile())
-				A_openAvi2(fileName.toUtf8().data(), 0);
+			{
+				if (avifileinfo)
+					FileSel_ReadWrite(reinterpret_cast <void (*)(const char *)> (A_appendAvi), 0, fileName.toUtf8().data(), actual_workbench_file);
+				else
+					FileSel_ReadWrite(reinterpret_cast <void (*)(const char *)> (A_openAvi), 0, fileName.toUtf8().data(), actual_workbench_file);
+			}
 		}
 	}
 
@@ -992,7 +1003,7 @@
 
 uint8_t UI_setTimeShift(int onoff,int value)
 {
-	if(onoff)
+	if (onoff && value)
 		WIDGET(checkBox_TimeShift)->setCheckState(Qt::Checked);
 	else
 		WIDGET(checkBox_TimeShift)->setCheckState(Qt::Unchecked);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -64,8 +64,8 @@
 #include "ADM_preview.h"
 void A_handleSecondTrack (int tracktype);
 int A_delete(uint32_t start, uint32_t end);
-void A_saveImg (char *name);
-void A_saveBunchJpg( char *name);
+void A_saveImg (const char *name);
+void A_saveBunchJpg( const char *name);
 void A_requantize(void);
 int A_saveJpg (char *name);
 int A_loadWave (char *name);
@@ -73,9 +73,9 @@
 int A_loadMP3 (char *name);
 int A_loadNone( void );
 void A_saveAudioDecodedTest (char *name);
-void A_openBrokenAvi (char *name);
-int A_openAvi2 (char *name, uint8_t mode);
-int A_appendAvi (char *name);
+void A_openBrokenAvi (const char *name);
+int A_openAvi2 (const char *name, uint8_t mode);
+int A_appendAvi (const char *name);
 void A_externalAudioTrack( void );
 
 void HandleAction (Action action);
@@ -111,7 +111,7 @@
 void ADM_cutWizard (void);
 uint8_t  ADM_saveRaw (const char *name);
 char * actual_workbench_file;
-void A_saveWorkbench (char *name);
+void A_saveWorkbench (const char *name);
 void updateLoaded (void);
 extern void encoderSetLogFile (char *name);
 extern void videoCodecSelect (void);
@@ -211,11 +211,8 @@
                                 name=prefs->get_lastfiles();
                                 rank=(int)action-ACT_RECENT0;
                                 ADM_assert(name[rank]);
+                                A_openAvi2 (name[rank], 0);
 
-								fileName = ADM_strdup(name[rank]);
-                                A_openAvi2(fileName, 0);
-								ADM_dealloc(fileName);
-
                 return;
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
@@ -893,18 +890,18 @@
 //_____________________________________________________________
 
 void
-A_openBrokenAvi (char *name)
+A_openBrokenAvi (const char *name)
 {
   A_openAvi2 (name, 1);
 }
 
 int
-A_openAvi (char *name)
+A_openAvi (const char *name)
 {
   return A_openAvi2 (name, 0);
 }
 extern void GUI_PreviewEnd (void);
-int A_openAvi2 (char *name, uint8_t mode)
+int A_openAvi2 (const char *name, uint8_t mode)
 {
   uint8_t res;
   char *longname;
@@ -1113,7 +1110,7 @@
 //  Append an AVI to the existing one
 //___________________________________________
 int
-A_appendAvi (char *name)
+A_appendAvi (const char *name)
 {
 
 
@@ -1308,11 +1305,12 @@
       \brief Save the selection  as a bunch of jpeg 95% qual
 
 */
-void A_saveBunchJpg(char *name)
+void A_saveBunchJpg(const char *name)
 {
   ADMImage *src=NULL;
   uint32_t curImg;
   char	 fullName[2048],*ext;
+  char *baseName;
   DIA_working *working;
   uint8_t success=0;
   
@@ -1322,7 +1320,7 @@
                         return;
                 }
         // Split name into base + extension
-        ADM_PathSplit(name,&name,&ext);
+        ADM_PathSplit(name,&baseName,&ext);
         
         src=new ADMImage(avifileinfo->width,avifileinfo->height);
         ADM_assert(src);
@@ -1337,7 +1335,7 @@
                         goto _bunch_abort;
                 }
                 if(!working->isAlive()) goto _bunch_abort;
-                sprintf(fullName,"%s%04d.jpg",name,curImg-frameStart);
+                sprintf(fullName,"%s%04d.jpg",baseName,curImg-frameStart);
                 if(!src->saveAsJpg(fullName)) goto _bunch_abort;
         }
         success=1;
@@ -1357,7 +1355,7 @@
       \fn A_saveImg
       \brief Save current displayed image as a BMP file
 */
-void A_saveImg (char *name)
+void A_saveImg (const char *name)
 {
   
   ADMImage image(avifileinfo->width,avifileinfo->height);
@@ -1798,7 +1796,7 @@
 }
 
 void
-A_saveWorkbench (char *name)
+A_saveWorkbench (const char *name)
 {
 #if 0
   video_body->saveWorbench (name);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtkgui.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtkgui.h	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtkgui.h	2008-06-24 21:23:15 UTC (rev 4158)
@@ -15,7 +15,7 @@
  *                                                                         *
  ***************************************************************************/
 
-int 			A_openAvi		(char *name);
+int 			A_openAvi		(const char *name);
 void 			A_saveAudio	(char *name);
 void 			A_saveAudioDecoded	(char *name);
 void 			A_saveAVI		(char *name);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/DIA_srt.cpp	2008-06-24 19:46:05 UTC (rev 4157)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Srt/DIA_srt.cpp	2008-06-24 21:23:15 UTC (rev 4158)
@@ -28,21 +28,21 @@
 /*****************************************************************/
 typedef struct unicd
 {
-	char *display,*name;
+	const char *display;
+	const char *name;
 }unicd;
 
   static unicd  names[]=
 {
-	{(char *)"Ascii"	,(char *)"ISO-8859-1"},
-	{(char *)"Cyrillic"	,(char *)"WINDOWS-1251"}, // ru
-	{(char *)"Czech"	,(char *)"ISO-8859-2"},	// cz
-	{(char *)"German"	,(char *)"ISO-8859-9"}		// german ?
-	,{(char *)"Slovene"	,(char *)"CP1250"}		// UTF8
-
-        ,{(char *)"UTF16"	,(char *)"UTF16"}		// UTF8
-	,{(char *)"UTF8"	,(char *)"UTF8"}		// UTF8
-	,{(char *)"Chinese Traditionnal(Big5)"	,(char *)"CP950"}		// UTF8
-	,{(char *)"Chinese Simplified (GB2312)"	,(char *)"CP936"}		// UTF8
+	{QT_TR_NOOP("Chinese Simplified (GB2312)"), "CP936"},		// UTF8
+	{QT_TR_NOOP("Chinese Traditional (Big5)"), "CP950"}	,	// UTF8
+	{QT_TR_NOOP("Cyrillic"), "WINDOWS-1251"}, // ru
+	{QT_TR_NOOP("Czech"), "ISO-8859-2"},	// cz
+	{QT_TR_NOOP("German"), "ISO-8859-9"},		// german ?
+	{QT_TR_NOOP("Latin-1"), "ISO-8859-1"},
+	{QT_TR_NOOP("Slovene"), "CP1250"},		// UTF8
+	{QT_TR_NOOP("UTF-8"), "UTF-8"},		// UTF8
+	{QT_TR_NOOP("UTF-16"), "UTF-16"}		// UTF16
 };
 typedef struct
 {
@@ -57,7 +57,7 @@
 */
 uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param)
 {
-#define item(x) QT_TR_NOOP(names[x].display)
+#define item(x) names[x].display
 #define Mitem(x) {x,item(x)}
 diaMenuEntry encoding[]={
   Mitem(0),
@@ -68,6 +68,7 @@
   Mitem(5),
   Mitem(6),
   Mitem(7),
+  Mitem(8)
 };
 
 #define PX(x) &(param->x)
@@ -87,7 +88,7 @@
       {
           if(!strcmp(param->_charset,names[i].name)) myEncoding=i;
       }
-      diaElemMenu      encodingM(&myEncoding,QT_TR_NOOP("_Encoding:"),8,encoding);
+      diaElemMenu      encodingM(&myEncoding,QT_TR_NOOP("_Encoding:"),9,encoding);
     //  diaElemUInteger  fontSize(PX(_fontsize),QT_TR_NOOP("Font Si_Ze:"),8,120);
       diaElemButton    color(QT_TR_NOOP("S_elect C_olor"), colorCallBack,&(colors[0]));
       diaElemButton    setBase(QT_TR_NOOP("Set Size and _Position"), sizePositionCallback,&sizePos);



From gruntster at mail.berlios.de  Wed Jun 25 01:49:12 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Jun 2008 01:49:12 +0200
Subject: [Avidemux-svn-commit] r4159 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200806242349.m5ONnCv8006785@sheep.berlios.de>

Author: gruntster
Date: 2008-06-25 01:49:05 +0200 (Wed, 25 Jun 2008)
New Revision: 4159

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
Log:
[Qt4] add Close menu item

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2008-06-24 21:23:15 UTC (rev 4158)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2008-06-24 23:49:05 UTC (rev 4159)
@@ -1511,6 +1511,7 @@
     <addaction name="menuRecent_Files" />
     <addaction name="actionAppend" />
     <addaction name="menuSave" />
+    <addaction name="actionClose" />
     <addaction name="separator" />
     <addaction name="actionProperties" />
     <addaction name="separator" />
@@ -2495,6 +2496,14 @@
     <string>IPOD (mpeg4)</string>
    </property>
   </action>
+  <action name="actionClose" >
+   <property name="text" >
+    <string>&amp;Close</string>
+   </property>
+   <property name="shortcut" >
+    <string>Ctrl+W</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-24 21:23:15 UTC (rev 4158)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2008-06-24 23:49:05 UTC (rev 4159)
@@ -1,5 +1,6 @@
 #define LIST_OF_OBJECTS     \
 PROCESS(actionOpen,ACT_OpenAvi) \
+PROCESS(actionClose,ACT_CLOSE) \
 PROCESS(actionAppend,ACT_AppendAvi) \
 PROCESS(actionQuit,ACT_Exit) \
 PROCESS(actionCut,ACT_Cut) \



From gruntster at mail.berlios.de  Wed Jun 25 01:55:49 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Jun 2008 01:55:49 +0200
Subject: [Avidemux-svn-commit] r4160 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_editor
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200806242355.m5ONtnVj007224@sheep.berlios.de>

Author: gruntster
Date: 2008-06-25 01:55:40 +0200 (Wed, 25 Jun 2008)
New Revision: 4160

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[GUI] clear window title and preview when closing video (FS#394)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-24 23:49:05 UTC (rev 4159)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2008-06-24 23:55:40 UTC (rev 4160)
@@ -582,7 +582,7 @@
 		}
                 if(isH264Compatible(info.fcc))
                 {
-                  if(getEnv(ENV_EDITOR_X264) || GUI_Confirmation_HIG(QT_TR_NOOP("Use safe mode"),QT_TR_NOOP("H.264 detected"),QT_TR_NOOP("If the file is using B-frames as reference it can lead to a crash or stuttering.\nAvidemux can use another mode which is safe but <b>YOU WILL LOSE FRAME ACCURACY</b>.\nDo you want to use that mode?")))
+                  if(getEnv(ENV_EDITOR_X264) || GUI_Confirmation_HIG(QT_TR_NOOP("Use safe mode"),QT_TR_NOOP("H.264 detected"),QT_TR_NOOP("If the file is using B-frames as reference it can lead to a crash or stuttering.\nAvidemux can use another mode which is safe but YOU WILL LOSE FRAME ACCURACY.\nDo you want to use that mode?")))
                     {
                               printf("Switching to non low delay codec\n");
                               _videos[_nb_video-1].decoder = getDecoderH264noLogic (info.fcc,  info.width, info.height, l, d);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-24 23:49:05 UTC (rev 4159)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-24 23:55:40 UTC (rev 4160)
@@ -695,15 +695,26 @@
 
 void UI_setTitle(const char *name)
 {
-        char title[1024];
+	char *title;
+	const char* defaultTitle = "Avidemux";
 
-        strncpy(title,name,200);
-        title[200] = 0;
-        strncat(title," - Avidemux", 11);
+	if (name && strlen(name) > 0)
+	{
+		title = new char[strlen(defaultTitle) + strlen(name) + 3 + 1];
 
+		strcpy(title, name);
+		strcat(title, " - ");
+		strcat(title, defaultTitle);
+	}
+	else
+	{
+		title = new char[strlen(defaultTitle) + 1];
 
-        gtk_window_set_title (GTK_WINDOW (guiRootWindow), title);
+		strcpy(title, defaultTitle);
+	}
 
+	gtk_window_set_title(GTK_WINDOW (guiRootWindow), title);
+	delete [] title;
 }
 void UI_setFrameType( uint32_t frametype,uint32_t qp)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-24 23:49:05 UTC (rev 4159)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-24 23:55:40 UTC (rev 4160)
@@ -834,13 +834,28 @@
 */
 void UI_setTitle(const char *name)
 {
-    char title[300];
+	char *title;
+	const char* defaultTitle = "Avidemux";
 
-    strncpy(title,name,200);
-    strncat(title," - Avidemux", 11);
+	if (name && strlen(name) > 0)
+	{
+		title = new char[strlen(defaultTitle) + strlen(name) + 3 + 1];
 
+		strcpy(title, name);
+		strcat(title, " - ");
+		strcat(title, defaultTitle);
+	}
+	else
+	{
+		title = new char[strlen(defaultTitle) + 1];
+
+		strcpy(title, defaultTitle);
+	}
+
 	QuiMainWindows->setWindowTitle(QString::fromUtf8(title));
+	delete [] title;
 }
+
 /**
     \fn     UI_setFrameType( uint32_t frametype,uint32_t qp)
     \brief  Display frametype (I/P/B) and associated quantizer

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-24 23:49:05 UTC (rev 4159)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-24 23:55:40 UTC (rev 4160)
@@ -22,9 +22,7 @@
 
 #include <time.h>
 #include <sys/time.h>
-#include <fcntl.h>	/* O_RDONLY */
 #include <errno.h>
-#include <glib.h>
 
 #include "ADM_lavcodec.h"
 
@@ -158,7 +156,7 @@
 renderZoom currentZoom=ZOOM_1_1;
 uint8_t A_setSecondAudioTrack(const AudioSource nw,char *name);
 extern const char * GUI_getCustomScript(uint32_t nb);
-extern gboolean SliderIsShifted;
+extern bool SliderIsShifted;
 
 void GUI_showCurrentFrameHex(void);
 void GUI_avsProxy(void);
@@ -2416,6 +2414,7 @@
   if (avifileinfo)		// already opened ?
     {				// delete everything
       // if preview is on
+      admPreview::setMainDimension(0, 0);
       if(getPreviewMode()!=ADM_PREVIEW_NONE)
       {
 	admPreview::stop();
@@ -2439,6 +2438,8 @@
 	  secondaudiostream=NULL;
 
       filterCleanUp ();
+	  UI_setTitle(NULL);
+
       return 1;
     }
     return 0;



From gruntster at mail.berlios.de  Wed Jun 25 12:42:42 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Jun 2008 12:42:42 +0200
Subject: [Avidemux-svn-commit] r4161 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_GTK/ADM_dialogFactory
	ADM_QT4/ADM_dialog ADM_QT4/ADM_dialogFactory ADM_commonUI
Message-ID: <200806251042.m5PAggrx017155@sheep.berlios.de>

Author: gruntster
Date: 2008-06-25 12:42:24 +0200 (Wed, 25 Jun 2008)
New Revision: 4161

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
Log:
[Xvid] allow a quantiser value of 1 (FS#393) and display quantiser as an integer

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp	2008-06-24 23:55:40 UTC (rev 4160)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp	2008-06-25 10:42:24 UTC (rev 4161)
@@ -167,11 +167,8 @@
 					incoming->mode = COMPRESS_CQ;		      			
 					value = (uint32_t) gtk_spin_button_get_value_as_int(
 								GTK_SPIN_BUTTON(WID(spinbuttonQuant)));
-		      			if (value >= 2 && value <= 32)
-						{
-			    			incoming->qz = value;
-		      				}
-		      			break;
+					incoming->qz = value;
+					break;
 
 				case 2:
 		     				incoming->mode = COMPRESS_2PASS;		       				
@@ -795,8 +792,8 @@
   gtk_tooltips_set_tip (tooltips, entryEntry, QT_TR_NOOP("Target video bitrate"), NULL);
   gtk_entry_set_width_chars (GTK_ENTRY (entryEntry), 10);
 
-  spinbuttonQuant_adj = gtk_adjustment_new (4, 1, 31, 0.1, 10, 10);
-  spinbuttonQuant = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuant_adj), 1, 1);
+  spinbuttonQuant_adj = gtk_adjustment_new (4, 1, 31, 1, 10, 10);
+  spinbuttonQuant = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonQuant_adj), 1, 0);
   gtk_widget_show (spinbuttonQuant);
   gtk_box_pack_start (GTK_BOX (vbox22), spinbuttonQuant, FALSE, FALSE, 0);
   gtk_tooltips_set_tip (tooltips, spinbuttonQuant, QT_TR_NOOP("Constant quantizer - each frame will get the same compression"), NULL);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2008-06-24 23:55:40 UTC (rev 4160)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2008-06-25 10:42:24 UTC (rev 4161)
@@ -64,8 +64,15 @@
   paramTitle=toggleTitle;
   this->tip=tip;
   setSize(2);
+  minQ=2;
   maxQ=31;
 }
+
+void diaElemBitrate::setMinQz(uint32_t qz)
+{
+  minQ=qz;
+}
+
 void diaElemBitrate::setMaxQz(uint32_t qz)
 {
   maxQ=qz; 
@@ -271,7 +278,7 @@
           break; 
     case COMPRESS_CQ:// CQ
           gtk_label_set_text_with_mnemonic(GTK_LABEL(label),QT_TR_NOOP("_Quantizer:"));
-          M(2,maxQ);
+          M(minQ,maxQ);
           S(copy.qz);
           break;
     case COMPRESS_AQ:// CQ

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp	2008-06-24 23:55:40 UTC (rev 4160)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp	2008-06-25 10:42:24 UTC (rev 4161)
@@ -44,6 +44,7 @@
          // Our tabs
          /* Tab 1 main */
            diaElemBitrate bitrate(incoming,NULL);
+		   bitrate.setMinQz(1);
 #define MKTOGGLE(y,x)           diaElemToggle  t_##x(PX(x),y)
         MKTOGGLE(QT_TR_NOOP("_Interlaced"),	    interlaced);
         MKTOGGLE(QT_TR_NOOP("Ca_rtoon mode"),      cartoon);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp	2008-06-24 23:55:40 UTC (rev 4160)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp	2008-06-25 10:42:24 UTC (rev 4161)
@@ -49,13 +49,15 @@
         QLabel          *text1;
         QLabel          *text2;
         COMPRES_PARAMS  *compress;
+		uint32_t		_minQ;
         uint32_t        maxQ;
-        ADM_Qbitrate(QWidget *z,COMPRES_PARAMS *p,uint32_t mq,QGridLayout *layout,int line) : QWidget(z) 
+        ADM_Qbitrate(QWidget *z,COMPRES_PARAMS *p,uint32_t minQ, uint32_t mq,QGridLayout *layout,int line) : QWidget(z) 
         {
           
            compress=p;
            combo=new QComboBox(z);
            
+		   _minQ=minQ;
            maxQ=mq;
            int index=0,set=-1;
 #define add(x,z,y) if(compress->capabilities & ADM_ENC_CAP_##x) {combo->addItem(QString::fromUtf8(y));\
@@ -163,7 +165,7 @@
           break; 
     case COMPRESS_CQ:// CQ
           P(QT_TR_NOOP("Quantizer"));
-          M(2,maxQ);
+          M(_minQ,maxQ);
           S(compress->qz);
           break;
     case COMPRESS_2PASS : // 2pass Filesize
@@ -182,7 +184,7 @@
           break;
     case COMPRESS_AQ : // AQ
           P(QT_TR_NOOP("Quantizer"));
-          M(2,maxQ);
+          M(_minQ,maxQ);
           S(compress->qz);
           break;
     default:ADM_assert(0);
@@ -209,8 +211,15 @@
   paramTitle=NULL;
   this->tip=tip;
   setSize(2);
+  minQ=2;
   maxQ=31;
 }
+
+void diaElemBitrate::setMinQz(uint32_t qz)
+{
+  minQ=qz;
+}
+
 void diaElemBitrate::setMaxQz(uint32_t qz)
 {
   maxQ=qz; 
@@ -231,7 +240,7 @@
 {
   QGridLayout *layout=(QGridLayout*) opaque;
   
-  ADM_Qbitrate *b=new ADM_Qbitrate( (QWidget *)dialog,(COMPRES_PARAMS *)&copy,maxQ,layout,line);
+  ADM_Qbitrate *b=new ADM_Qbitrate( (QWidget *)dialog,(COMPRES_PARAMS *)&copy,minQ,maxQ,layout,line);
   myWidget=(void *)b;
   
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2008-06-24 23:55:40 UTC (rev 4160)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2008-06-25 10:42:24 UTC (rev 4161)
@@ -312,7 +312,7 @@
 {
   protected:
     COMPRES_PARAMS    copy;
-    uint32_t maxQ;
+    uint32_t maxQ, minQ;
 public:
   
   diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
@@ -320,6 +320,7 @@
   void setMe(void *dialog, void *opaque,uint32_t line);
   void getMe(void);
   void setMaxQz(uint32_t qz);
+  void setMinQz(uint32_t qz);
   
   void updateMe(void);
 };



From gruntster at mail.berlios.de  Wed Jun 25 13:16:34 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Jun 2008 13:16:34 +0200
Subject: [Avidemux-svn-commit] r4162 -
	branches/avidemux_2.4_branch/avidemux/ADM_codecs
Message-ID: <200806251116.m5PBGYBZ026569@sheep.berlios.de>

Author: gruntster
Date: 2008-06-25 13:16:27 +0200 (Wed, 25 Jun 2008)
New Revision: 4162

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
Log:
[MPEG-2] memory allocation fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2008-06-25 10:42:24 UTC (rev 4161)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2008-06-25 11:16:27 UTC (rev 4162)
@@ -165,8 +165,8 @@
 	_decoder = mpeg2_init();
 	dec = &((MPEG2DEC)->decoder);
 
-	wmb = (roundWidth) >> 4;;
-	hmb = (roundWidth) >> 4;;
+	wmb = (roundWidth) >> 4;
+	hmb = (roundHeight) >> 4;
 
 	dec->quant_stride = wmb;
 	dec->quant = (int8_t *)ADM_alloc ((wmb * hmb) * sizeof (int8_t));



From gruntster at mail.berlios.de  Thu Jun 26 15:40:23 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jun 2008 15:40:23 +0200
Subject: [Avidemux-svn-commit] r4164 -
	branches/avidemux_2.4_branch/avidemux/ADM_osSupport
Message-ID: <200806261340.m5QDeNZI016264@sheep.berlios.de>

Author: gruntster
Date: 2008-06-26 15:40:12 +0200 (Thu, 26 Jun 2008)
New Revision: 4164

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
Log:
[Win32] open files with exclusive access when writing to prevent overwriting source (FS#253)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-25 13:18:30 UTC (rev 4163)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-26 13:40:12 UTC (rev 4164)
@@ -54,19 +54,40 @@
   return fwrite(ptr,size,n,sstream); 
   
 }
+
 FILE  *ADM_fopen (const char *file, const char *mode)
 {
 #ifdef __MINGW32__
 	int fileNameLength = utf8StringToWideChar(file, -1, NULL);
-	int modeLength = utf8StringToWideChar(mode, -1, NULL);
-
 	wchar_t wcFile[fileNameLength];
-	wchar_t wcMode[modeLength];
 
 	utf8StringToWideChar(file, -1, wcFile);
-	utf8StringToWideChar(mode, -1, wcMode);
 
-	return _wfopen(wcFile, wcMode);
+	if (strchr(mode, 'w') == NULL)
+	{
+		// open file normally for reading or appending
+		int modeLength = utf8StringToWideChar(mode, -1, NULL);
+		wchar_t wcMode[modeLength];
+
+		utf8StringToWideChar(mode, -1, wcMode);
+
+		return _wfopen(wcFile, wcMode);
+	}
+	else
+	{
+		// open file exclusively for writing (and reading if need be)
+		int access = GENERIC_WRITE;
+
+		if (strstr(mode, "w+") != NULL)
+			access |= GENERIC_READ;
+
+		HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);
+
+		if (hFile == INVALID_HANDLE_VALUE)
+			return NULL;
+		else
+			return _fdopen(_open_osfhandle((intptr_t)hFile, 0), mode);
+	}
 #else
 	return fopen(file, mode);
 #endif



From gruntster at mail.berlios.de  Thu Jun 26 19:35:39 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jun 2008 19:35:39 +0200
Subject: [Avidemux-svn-commit] r4165 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_libraries/ADM_lavformat ADM_osSupport
Message-ID: <200806261735.m5QHZdiK018840@sheep.berlios.de>

Author: gruntster
Date: 2008-06-26 19:35:31 +0200 (Thu, 26 Jun 2008)
New Revision: 4165

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
Log:
[Win32] support Unicode filenames and enforce exclusive write access when using libavformat muxers

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c	2008-06-26 13:40:12 UTC (rev 4164)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c	2008-06-26 17:35:31 UTC (rev 4165)
@@ -24,6 +24,12 @@
 #include <unistd.h>
 #include <sys/time.h>
 
+// GRUNTSTER start
+#ifdef __WIN32
+extern int ADM_open(const char *path, int oflag, ...);
+#define open ADM_open
+#endif
+// GRUNTSTER end
 
 /* standard file protocol */
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-26 13:40:12 UTC (rev 4164)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-26 17:35:31 UTC (rev 4165)
@@ -24,6 +24,7 @@
 
 #ifdef __WIN32__
 #include <shlobj.h>
+#include <fcntl.h>
 #endif
 
 #include "default.h"
@@ -93,6 +94,49 @@
 #endif
 }
 
+#if __WIN32
+extern "C"
+{
+	// libavformat uses open (in the file_open function) so we need to override that too
+	int ADM_open(const char *path, int oflag, ...)
+	{
+		int fileNameLength = utf8StringToWideChar(path, -1, NULL);
+		wchar_t wcFile[fileNameLength];
+
+		utf8StringToWideChar(path, -1, wcFile);
+
+		if ((oflag & O_WRONLY || oflag & O_RDWR) && (oflag & O_TRUNC))
+		{
+			// open file exclusively for writing (and reading if need be)
+			int access = GENERIC_WRITE;
+
+			if (oflag & O_RDWR == O_RDWR)
+				access |= GENERIC_READ;
+
+			HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);
+
+			printf("CreateFile %s\n", path);
+
+			if (hFile == INVALID_HANDLE_VALUE)
+				return -1;
+			else
+				return _open_osfhandle((intptr_t)hFile, 0);
+		}
+		else
+		{
+			va_list mode;
+			va_start(mode, oflag);
+
+			int file = open(path, oflag, mode);
+
+			va_end(mode);
+
+			return file;
+		}
+	}
+}
+#endif
+
 int    ADM_fclose (FILE *file)
 {
   return fclose(file); 



From mean at mail.berlios.de  Thu Jun 26 19:39:50 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 26 Jun 2008 19:39:50 +0200
Subject: [Avidemux-svn-commit] r4166 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer
Message-ID: <200806261739.m5QHdosu029299@sheep.berlios.de>

Author: mean
Date: 2008-06-26 19:39:48 +0200 (Thu, 26 Jun 2008)
New Revision: 4166

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
Log:
[Mpeg] if an audio track has no data, pick the next one (FS#456)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-26 17:35:31 UTC (rev 4165)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp	2008-06-26 17:39:48 UTC (rev 4166)
@@ -44,7 +44,7 @@
 #include "ADM_audio/ADM_aacinfo.h"
 #define MAX_LINE 4096
 #define PROBE_SIZE (4096*4)
-
+#define DMX_MIN_AUDIO_DETECTED PROBE_SIZE //we must have at least that bytes to consider the audio as valid
 //___________________________________________________
 //___________________________________________________
 //___________________________________________________
@@ -308,7 +308,23 @@
   _pos = 0;
   printf ("\n DMX audio initialized (%lu bytes)\n", _length);
   printf ("With %lu sync point\n", nbIndex);
-  changeAudioTrack(mainAudio);
+  int found=-1;
+  // Only take the audio track if it has enough bytes
+  // else we can have a track present in the PMT that is not actually present
+  for(int i=0;i<nbTrack;i++)
+  {
+        int test=(mainAudio+i)%nbTrack;
+        if(_index[nbIndex-1].count[test]>DMX_MIN_AUDIO_DETECTED)
+        {
+            found=test;
+            break;
+        }
+        else printf("[DmxAudio] Skipping track %d, not enough audio\n",test);
+  }
+    if(found!=-1)
+        mainAudio=found;
+    changeAudioTrack(found);
+  
   return 1;
 }
 // __________________________________________________________
@@ -409,7 +425,7 @@
         if(PROBE_SIZE!=(blocksize=demuxer->read(buffer,PROBE_SIZE)))
         {
            printf("DmxAudio: Reading for track %d failed (%u/%u)\n",i,blocksize,PROBE_SIZE);
-           return 0;
+           continue;
         }
         myPes=_tracks[i].myPes;
         // Try mp2/3



From gruntster at mail.berlios.de  Thu Jun 26 20:17:19 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jun 2008 20:17:19 +0200
Subject: [Avidemux-svn-commit] r4167 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs ADM_osSupport
Message-ID: <200806261817.m5QIHJbt006095@sheep.berlios.de>

Author: gruntster
Date: 2008-06-26 20:17:09 +0200 (Thu, 26 Jun 2008)
New Revision: 4167

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
Log:
[lavc] close 2-pass log file after reading

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2008-06-26 17:39:48 UTC (rev 4166)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2008-06-26 18:17:09 UTC (rev 4167)
@@ -582,6 +582,7 @@
   _context->stats_in = (char *) ADM_alloc (statSize + 1);
   _context->stats_in[statSize] = 0;
   fread (_context->stats_in, statSize, 1, _statfile);
+  fclose(_statfile);
 
   _context->bit_rate = val;	// bitrate
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-26 17:39:48 UTC (rev 4166)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-26 18:17:09 UTC (rev 4167)
@@ -110,7 +110,7 @@
 			// open file exclusively for writing (and reading if need be)
 			int access = GENERIC_WRITE;
 
-			if (oflag & O_RDWR == O_RDWR)
+			if (oflag & O_RDWR)
 				access |= GENERIC_READ;
 
 			HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);



From gruntster at mail.berlios.de  Thu Jun 26 20:48:39 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jun 2008 20:48:39 +0200
Subject: [Avidemux-svn-commit] r4168 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806261848.m5QImdKR011090@sheep.berlios.de>

Author: gruntster
Date: 2008-06-26 20:48:32 +0200 (Thu, 26 Jun 2008)
New Revision: 4168

Modified:
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[leak] fix memory leak and close file after using external audio

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-26 18:17:09 UTC (rev 4167)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-26 18:48:32 UTC (rev 4168)
@@ -66,6 +66,11 @@
 
 #include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
 
+static AudioSource currentAudioSource = AudioAvi;
+static AudioSource secondAudioSource = AudioNone;
+static char *currentAudioName = NULL;
+static char *secondAudioName = NULL;
+
 void A_handleSecondTrack (int tracktype);
 int A_delete(uint32_t start, uint32_t end);
 void A_saveImg (const char *name);
@@ -959,9 +964,6 @@
 		return 0;
 	}
 
-	currentaudiostream = NULL;
-	avifileinfo = NULL;
-
 	if( fourCC::check(id,(uint8_t *)"//AD") ){
           GUI_Error_HIG(QT_TR_NOOP("Cannot open project using the video loader."),
                         QT_TR_NOOP(  "Try 'File' -> 'Load/Run Project...'"));
@@ -1026,23 +1028,15 @@
 
 void  updateLoaded ()
 {
-  if (avifileinfo)
-    {
-      delete avifileinfo;
-      avifileinfo = NULL;
-    }
   avifileinfo = new aviInfo;
   if (!video_body->getVideoInfo (avifileinfo))
     {
 //      err1:
       printf ("\n get info failed...cancelling load...\n");
       delete avifileinfo;
-      avifileinfo = (aviInfo *) NULL;
-      currentaudiostream = aviaudiostream = NULL;
+      avifileinfo = NULL;
 
-
       return;
-
     }
 
   curframe = 0;
@@ -1054,7 +1048,6 @@
     {
       printf ("\n *** NO AUDIO ***\n");
       wavinfo = (WAVHeader *) NULL;
-      currentaudiostream = aviaudiostream = (AVDMGenericAudioStream *) NULL;
     }
   else
     {
@@ -1400,18 +1393,9 @@
 {
  	A_changeAudioStream ((AVDMGenericAudioStream *) NULL, AudioNone,NULL);
 }
+
 //_____________________________________________________________
 //
-//              Load wave
-//
-//
-//_____________________________________________________________
-AudioSource currentAudioSource=AudioAvi;
-AudioSource secondAudioSource=AudioNone;
-char *currentAudioName=NULL;
-char *secondAudioName=NULL;
-//_____________________________________________________________
-//
 //              Load MP3 and identify wavfmt infos to fill avi header
 //              -> use mad ?
 //
@@ -1472,12 +1456,18 @@
 //________________________________________________________
 uint8_t A_changeAudioStream (AVDMGenericAudioStream * newaudio, AudioSource nwsource,char *myname)
 {
-  if (currentaudiostream)
-    {
-      currentAudioSource=AudioNone;
-      if(currentAudioName) ADM_dealloc(currentAudioName);
-      currentAudioName=NULL;
-    }
+	if (currentaudiostream)
+	{
+		if (currentaudiostream != aviaudiostream)
+			delete currentaudiostream;
+
+		if(currentAudioName)
+			ADM_dealloc(currentAudioName);
+
+		currentAudioName = NULL;
+		currentAudioSource = AudioNone;
+	}
+
   currentaudiostream = newaudio;
 
   if (currentaudiostream)
@@ -2422,8 +2412,8 @@
       }
       delete avifileinfo;
       //delete wavinfo;
-      wavinfo = (WAVHeader *) NULL;
-      avifileinfo = (aviInfo *) NULL;
+      wavinfo = NULL;
+      avifileinfo = NULL;
       video_body->cleanup ();
       curframe = 0;
       A_changeAudioStream (NULL, AudioNone,NULL);



From gruntster at mail.berlios.de  Fri Jun 27 02:35:37 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 27 Jun 2008 02:35:37 +0200
Subject: [Avidemux-svn-commit] r4169 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv
Message-ID: <200806270035.m5R0ZbQg018700@sheep.berlios.de>

Author: gruntster
Date: 2008-06-27 02:35:27 +0200 (Fri, 27 Jun 2008)
New Revision: 4169

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
Log:
[FLV] open FLVs that don't contain audio

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-26 18:48:32 UTC (rev 4168)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2008-06-27 00:35:27 UTC (rev 4169)
@@ -242,7 +242,11 @@
     videoTrack->_index[0].flags=AVI_KEY_FRAME;
     
     // audio track
-    _audioStream=new flvAudio(name,audioTrack,&wavHeader);
+	if(_isaudiopresent)
+		_audioStream = new flvAudio(name, audioTrack, &wavHeader);
+	else
+		_audioStream = NULL;
+
   printf("[FLV]FLV successfully read\n");
   
   return 1;



From mean at mail.berlios.de  Sat Jun 28 10:20:39 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 28 Jun 2008 10:20:39 +0200
Subject: [Avidemux-svn-commit] r4171 - in branches/avidemux_2.4_branch: .
	avidemux avidemux/ADM_audiodevice
	avidemux/ADM_userInterfaces/ADM_commonUI cmake
Message-ID: <200806280820.m5S8Kdmg002798@sheep.berlios.de>

Author: mean
Date: 2008-06-28 10:20:38 +0200 (Sat, 28 Jun 2008)
New Revision: 4171

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.h
   branches/avidemux_2.4_branch/cmake/FindPulseAudioSimple.cmake
Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
   branches/avidemux_2.4_branch/cmake/conf_summary.cmake
   branches/avidemux_2.4_branch/config.h.cmake
Log:
[Audio] Simple pulseaudio support

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2008-06-28 08:20:38 UTC (rev 4171)
@@ -343,7 +343,14 @@
 IF (NOT ADM_OS_WINDOWS)
 	INCLUDE(FindArts)
 ENDIF (NOT ADM_OS_WINDOWS)
+########################################
+# PulseAudioSimple
+########################################
+IF (NOT ADM_OS_WINDOWS)
+	INCLUDE(FindPulseAudioSimple)
+ENDIF (NOT ADM_OS_WINDOWS)
 
+
 ########################################
 # ESD
 ########################################

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp	2008-06-28 08:20:38 UTC (rev 4171)
@@ -26,6 +26,8 @@
 
 #include "avi_vars.h"
 #include "prefs.h"
+
+
 #ifdef HAVE_AUDIO
 #include "ADM_assert.h"
 #include "ADM_audiodevice.h"
@@ -56,10 +58,16 @@
 #include "ADM_deviceJack.h"
 #endif
 
+#ifdef USE_PULSE_SIMPLE
+#include "ADM_devicePulseSimple.h"
+#endif
+
 #ifdef __APPLE__
 #include "ADM_audiodevice/ADM_deviceAudioCore.h"
 #endif
 
+
+
 #include "gui_action.hxx"
 #include "audio_out.h"
 
@@ -144,6 +152,7 @@
 			case DEVICE_WIN32:
 			case DEVICE_ESD:
 			case DEVICE_JACK:
+            case DEVICE_PULSE_SIMPLE:
 			
 						printf("Using real audio device\n");
 						AVDM_switch(id);
@@ -208,6 +217,13 @@
 								break;
 
 #endif
+#ifdef USE_PULSE_SIMPLE
+		  case  DEVICE_PULSE_SIMPLE :
+								device=new 	 pulseSimpleAudioDevice;
+								currentDevice=DEVICE_PULSE_SIMPLE;;
+								break;
+
+#endif
 #if defined(OSS_SUPPORT) && !defined(ADM_WIN32)
 		  case  DEVICE_OSS :
 								device=new 	 ossAudioDevice;

Added: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.cpp	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.cpp	2008-06-28 08:20:38 UTC (rev 4171)
@@ -0,0 +1,139 @@
+/***************************************************************************
+                          ADM_devicePulseSimple.cpp  -  description
+
+  Simple Pulse audio out
+                          
+    copyright            : (C) 2008 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
+#if defined( USE_PULSE_SIMPLE ) && !defined(ADM_WIN32)
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <unistd.h>
+#include <errno.h>
+
+#include <fcntl.h>
+#include <sys/ioctl.h>
+
+ 
+
+#include "default.h"
+#include "ADM_audiodevice.h"
+#include <ADM_assert.h>
+#include "ADM_audiodevice/ADM_deviceoss.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include  "ADM_audiodevice/ADM_devicePulseSimple.h"
+
+#include "pulse/simple.h"
+//#define ADM_PULSE_INT16
+/**
+    \fn pulseSimpleAudioDevice
+    \brief Constructor
+
+*/
+pulseSimpleAudioDevice::pulseSimpleAudioDevice()
+{
+    instance=NULL;
+}
+
+#define INSTANCE  ((pa_simple *)instance)
+/**
+    \fn stop
+    \brief stop & release device
+
+*/
+
+uint8_t  pulseSimpleAudioDevice::stop(void) 
+{
+int er;
+    ADM_assert(instance);
+    pa_simple_flush(INSTANCE,&er);
+    pa_simple_free(INSTANCE);
+    instance=NULL;
+    printf("[PulseAudio] Stopped\n");
+    return 1;
+}
+
+/**
+    \fn init
+    \brief Take & initialize the device
+
+*/
+uint8_t pulseSimpleAudioDevice::init(uint8_t channels, uint32_t fq) 
+{
+
+pa_simple *s;
+pa_sample_spec ss;
+int er;
+ 
+#ifdef ADM_PULSE_INT16
+  ss.format = PA_SAMPLE_S16NE;
+#else
+    ss.format = PA_SAMPLE_FLOAT32NE;//PA_SAMPLE_S16NE; //FIXME big endian
+#endif
+  ss.channels = channels;
+  ss.rate =fq;
+ 
+  instance= pa_simple_new(NULL,               // Use the default server.
+                    "Avidemux2",           // Our application's name.
+                    PA_STREAM_PLAYBACK,
+                    NULL,               // Use the default device.
+                    "Sound",            // Description of our stream.
+                    &ss,                // Our sample format.
+                    NULL,               // Use default channel map
+                    NULL ,             // Use default buffering attributes.
+                    &er               // Ignore error code.
+                    );
+  if(!instance)
+    {
+        printf("[PulseSimple] open failed\n");
+        return 0;
+    }
+    printf("[PulseSimple] open ok\n");
+    return 1;
+
+}
+
+/**
+    \fn play
+    \brief Playback samples
+
+*/
+uint8_t pulseSimpleAudioDevice::play(uint32_t len, float *data)
+{
+int er;
+#ifdef ADM_PULSE_INT16
+	dither16(data, len, _channels);
+    pa_simple_write(INSTANCE,data,len*2,&er);
+#else
+    pa_simple_write(INSTANCE,data,len*4,&er);
+#endif
+	return 1;
+}
+/**
+    \fn setVolume
+    \brief Cannot be done with pulse simple
+*/
+uint8_t pulseSimpleAudioDevice::setVolume(int volume)
+{
+	return 1;
+}
+
+#else
+void dummy_pulseSimple_func( void);
+void dummy_pulseSimple_func( void)
+ {
+}
+
+#endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.h	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_devicePulseSimple.h	2008-06-28 08:20:38 UTC (rev 4171)
@@ -0,0 +1,29 @@
+/***************************************************************************
+                          ADM_deviceEsd.h  -  description
+                             -------------------
+                             Audio device for ESD sound daemon
+    copyright            : (C) 2005 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifdef USE_PULSE_SIMPLE
+class pulseSimpleAudioDevice : public audioDevice
+	 {
+		 protected :
+                    void  *instance;
+		  public:
+		  			pulseSimpleAudioDevice(void);
+		     		virtual uint8_t init(uint8_t channels, uint32_t fq);
+	    			virtual uint8_t play(uint32_t len, float *data);
+		      		virtual uint8_t stop(void);
+				uint8_t setVolume(int volume);
+		 }     ;
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt	2008-06-28 08:20:38 UTC (rev 4171)
@@ -1,9 +1,15 @@
 
 SET(ADM_audiodevice_SRCS 
 ADM_audiodevice.cpp  ADM_deviceArts.cpp       ADM_deviceEsd.cpp  ADM_deviceSDL.cpp    oss_out.cpp
-ADM_deviceALSA.cpp   ADM_deviceAudioCore.cpp  ADM_deviceoss.cpp  ADM_deviceWin32.cpp  ADM_deviceJack.cpp)
+ADM_deviceALSA.cpp   ADM_deviceAudioCore.cpp  ADM_deviceoss.cpp  ADM_deviceWin32.cpp  ADM_deviceJack.cpp
+ADM_devicePulseSimple.cpp
+)
 ADD_LIBRARY(ADM_audiodevice STATIC ${ADM_audiodevice_SRCS})
 SDLify(ADM_deviceSDL.cpp)
 if(USE_ARTS)
   add_definitions(${ARTS_CFLAGS})
 endif(USE_ARTS)
+if(USE_PULSE_SIMPLE)
+  add_definitions(${PULSEAUDIOSIMPLE_DEFINITIONS})
+  include_directories(${PULSEAUDIOSIMPLE_INCLUDE_DIR})
+endif(USE_ARTS)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2008-06-28 08:20:38 UTC (rev 4171)
@@ -14,7 +14,6 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
 #ifndef AUDIOOUPUT_H
 #define AUDIOOUPUT_H
 //#include "avi_vars.h"
@@ -29,7 +28,9 @@
 	DEVICE_SDL,
 	DEVICE_WIN32,
 	DEVICE_ESD,
-	DEVICE_JACK
+	DEVICE_JACK,
+    DEVICE_PULSE_SIMPLE,
+    DEVICE_LIMIT
 }AUDIO_DEVICE;
 
 typedef struct 
@@ -65,6 +66,9 @@
 #ifdef USE_JACK	
 	MKADID(JACK),
 #endif	
+#ifdef USE_PULSE_SIMPLE	
+	MKADID(PULSE_SIMPLE),
+#endif	
 
 	MKADID(DUMMY)
 };

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2008-06-28 08:20:38 UTC (rev 4171)
@@ -38,7 +38,9 @@
 extern void 		AVDM_audioPref( void );
 
 
+// FIXME
 
+
 uint8_t DIA_Preferences(void);
 
 /**
@@ -318,6 +320,10 @@
 		#ifdef OSS_SUPPORT
 			{DEVICE_OSS, QT_TR_NOOP("OSS")},
 		#endif
+		#ifdef USE_PULSE_SIMPLE
+			{DEVICE_PULSE_SIMPLE, QT_TR_NOOP("Pulse Audio")},
+		#endif
+
 		#if	defined(USE_SDL) && !defined(ADM_WIN32)
 			{DEVICE_SDL, QT_TR_NOOP("SDL")},
 		#endif

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2008-06-28 08:20:38 UTC (rev 4171)
@@ -247,7 +247,8 @@
 if(NEED_LIBICONV)
 	add_libs_all_targets(iconv)
 endif(NEED_LIBICONV)
-
+# Pulse audio
+	add_libs_all_targets(pulse-simple)
 #gettext
 if(ADM_GETTEXT_LIB)
 	INCLUDE_DIRECTORIES(${ADM_GETTEXT_INCLUDE})

Added: branches/avidemux_2.4_branch/cmake/FindPulseAudioSimple.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/FindPulseAudioSimple.cmake	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/cmake/FindPulseAudioSimple.cmake	2008-06-28 08:20:38 UTC (rev 4171)
@@ -0,0 +1,58 @@
+# - Try to find PulseAudioSimple
+# Once done this will define
+#
+#  PULSEAUDIOSIMPLE_FOUND - system has PulseAudioSimple
+#  PULSEAUDIOSIMPLE_INCLUDE_DIR - the PulseAudioSimple include directory
+#  PULSEAUDIOSIMPLE_LIBRARIES - the libraries needed to use PulseAudioSimple
+#  PULSEAUDIOSIMPLE_DEFINITIONS - Compiler switches required for using PulseAudioSimple
+#
+MESSAGE(STATUS "<** PulseAudio **>")
+MESSAGE(STATUS "<---------------->")
+
+IF(NO_PULSE_SIMPLE)
+        message(status "<disabled per request>")
+ELSE(NO_PULSE_SIMPLE)
+
+IF (PULSEAUDIOSIMPLE_INCLUDE_DIR AND PULSEAUDIOSIMPLE_LIBRARIES)
+   # in cache already
+   SET(PULSEAUDIOSIMPLE_FIND_QUIETLY TRUE)
+ENDIF (PULSEAUDIOSIMPLE_INCLUDE_DIR AND PULSEAUDIOSIMPLE_LIBRARIES)
+
+IF (NOT WIN32)
+   # use pkg-config to get the directories and then use these values
+   # in the FIND_PATH() and FIND_LIBRARY() calls
+   INCLUDE(UsePkgConfig)
+   PKGCONFIG(libpulse-simple _PASIncDir _PASLinkDir _PASLinkFlags _PASCflags)
+   SET(PULSEAUDIOSIMPLE_DEFINITIONS ${_PASCflags})
+ENDIF (NOT WIN32)
+
+FIND_PATH(PULSEAUDIOSIMPLE_INCLUDE_DIR pulse/simple.h
+   PATHS
+   ${_PASIncDir}
+   PATH_SUFFIXES pulse
+   )
+
+FIND_LIBRARY(PULSEAUDIOSIMPLE_LIBRARIES NAMES pulse-simple libpulse-simple
+   PATHS
+   ${_PASLinkDir}
+   )
+
+IF (PULSEAUDIOSIMPLE_INCLUDE_DIR AND PULSEAUDIOSIMPLE_LIBRARIES)
+   SET(PULSEAUDIOSIMPLE_FOUND TRUE)
+ELSE (PULSEAUDIOSIMPLE_INCLUDE_DIR AND PULSEAUDIOSIMPLE_LIBRARIES)
+   SET(PULSEAUDIOSIMPLE_FOUND FALSE)
+ENDIF (PULSEAUDIOSIMPLE_INCLUDE_DIR AND PULSEAUDIOSIMPLE_LIBRARIES)
+
+IF (PULSEAUDIOSIMPLE_FOUND)
+   IF (NOT PULSEAUDIOSIMPLE_FIND_QUIETLY)
+      MESSAGE(STATUS "Found PulseAudio Simple: ${PULSEAUDIOSIMPLE_LIBRARIES}")
+   ENDIF (NOT PULSEAUDIOSIMPLE_FIND_QUIETLY)
+   SET(USE_PULSE_SIMPLE 1)
+ELSE (PULSEAUDIOSIMPLE_FOUND)
+      MESSAGE(STATUS "Could NOT find LibXml2")
+ENDIF (PULSEAUDIOSIMPLE_FOUND)
+
+MARK_AS_ADVANCED(PULSEAUDIOSIMPLE_INCLUDE_DIR PULSEAUDIOSIMPLE_LIBRARIES)
+
+ENDIf(NO_PULSE_SIMPLE)
+

Modified: branches/avidemux_2.4_branch/cmake/conf_summary.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/conf_summary.cmake	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/cmake/conf_summary.cmake	2008-06-28 08:20:38 UTC (rev 4171)
@@ -32,6 +32,7 @@
 ADM_DISPLAY("OSS       " OSS_SUPPORT)
 ADM_DISPLAY("ARTS      " USE_ARTS)
 ADM_DISPLAY("JACK      " USE_JACK)
+ADM_DISPLAY("PULSE SIMP" USE_PULSE_SIMPLE)
 
 MESSAGE("*** Misc       ***")
 ADM_DISPLAY("SDL       " USE_SDL)

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2008-06-27 19:35:24 UTC (rev 4170)
+++ branches/avidemux_2.4_branch/config.h.cmake	2008-06-28 08:20:38 UTC (rev 4171)
@@ -190,6 +190,9 @@
 /* aRts detected */
 #cmakedefine USE_ARTS
 
+/* PulseAudioSimple detected */
+#cmakedefine USE_PULSE_SIMPLE
+
 /* ESD detected */
 #cmakedefine USE_ESD
 



From mean at mail.berlios.de  Sat Jun 28 10:21:32 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 28 Jun 2008 10:21:32 +0200
Subject: [Avidemux-svn-commit] r4172 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200806280821.m5S8LWr6002876@sheep.berlios.de>

Author: mean
Date: 2008-06-28 10:21:32 +0200 (Sat, 28 Jun 2008)
New Revision: 4172

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
Log:
[MKV] Better duration computation for audio frames

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-28 08:20:38 UTC (rev 4171)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2008-06-28 08:21:32 UTC (rev 4172)
@@ -127,7 +127,7 @@
         if(track->_defaultFrameDuration) return 1; // No need to change
         float samples=1000.;
         samples*=durationMs;
-        samples/=track->nbPackets;  // 1000 * sample per packet
+        samples/=track->nbFrames;  // 1000 * sample per packet
         track->_defaultFrameDuration=(uint32_t)samples;
         return 1;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-28 08:20:38 UTC (rev 4171)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h	2008-06-28 08:21:32 UTC (rev 4172)
@@ -40,7 +40,8 @@
 
   /* Used for audio */
   WAVHeader wavHeader;
-  uint32_t  nbPackets;
+  uint32_t  nbPackets; // number of blocks (used for audio)
+  uint32_t  nbFrames;  // number of distinct frames
   uint32_t  length;
   /* Used for both */
   uint8_t    *extraData;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-28 08:20:38 UTC (rev 4171)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2008-06-28 08:21:32 UTC (rev 4172)
@@ -160,6 +160,7 @@
               {
                 _tracks[track]._sizeInBytes+=remaining; // keep some stat, useful for audio
                 _tracks[track].nbPackets++;
+                _tracks[track].nbFrames++;
               }
               break;
         case 2 : // Constant size lacing
@@ -183,6 +184,7 @@
                     {
                        _tracks[track]._sizeInBytes+=remaining;
                        _tracks[track].nbPackets++;
+                       _tracks[track].nbFrames+=nbLaces;
                     }
                     //printf("tid:%u track %u Remaining : %llu laces %u blksize %d er%d\n",tid,track,remaining,nbLaces,remaining/nbLaces,remaining-(remaining/nbLaces)*nbLaces);
             }
@@ -205,6 +207,7 @@
                                 {
                                     _tracks[track]._sizeInBytes+=tail-parser->tell();
                                     _tracks[track].nbPackets++;
+                                    _tracks[track].nbFrames+=nbLaces+1;
                                 }
 
                               }
@@ -226,6 +229,7 @@
                                 ADM_assert(track); // Not video!
                                 _tracks[track]._sizeInBytes+=(tail-parser->tell());
                                 _tracks[track].nbPackets++;
+                                _tracks[track].nbFrames+=nbLaces+1;
                                 //printf("This round %lld total:%lld\n",tail-parser->tell(),    _tracks[track]._sizeInBytes);
                                 break;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-28 08:20:38 UTC (rev 4171)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2008-06-28 08:21:32 UTC (rev 4172)
@@ -83,6 +83,7 @@
   ADM_MKV_TYPE type;
   const char *ss;
   vprintf("Enter: Currently at :%llx\n",_clusterParser->tell());
+  *samples=_frameDurationInSample;
     // Have we still lace to go ?
     if(_currentLace<_maxLace)
     {
@@ -90,22 +91,7 @@
       *packlen= _Laces[_currentLace];
       vprintf("Continuing lacing : %u bytes, lacing %u/%u\n",*packlen,_currentLace,_maxLace);
 
-      if(_currentLace==_maxLace-1)
-      {
-          float f;
-          f=_frameDurationInSample;
-          f/=_maxLace;
-          uint32_t total=(uint32_t)floor(f);
-          total*=(_maxLace-1);
-          *samples=_frameDurationInSample-total;
-          ADM_assert(_frameDurationInSample>=total);
-      }else
-      {
-          float f;
-          f=_frameDurationInSample;
-          f/=_maxLace;
-          *samples=(uint32_t )floor(f);
-      }
+     
       *timecode=_curTimeCode;
       _currentLace++;
       return 1;
@@ -175,7 +161,7 @@
                               vprintf("No lacing :%d bytes\n",remaining);
                               _clusterParser->readBin(dest,remaining);
                               *packlen=remaining;
-                              *samples=_frameDurationInSample;
+                              
                               _currentLace=_maxLace=0;
 
                               return 1;
@@ -315,6 +301,7 @@
   _wavheader=new WAVHeader;
   memcpy(_wavheader,&(_track->wavHeader),sizeof(WAVHeader));
   printf("[MKVAUDIO] found %lu packets\n",track->nbPackets);
+  printf("[MKVAUDIO] found %lu frames\n",track->nbFrames);
   printf("[MKVAUDIO] Default duration %u us\n",_track->_defaultFrameDuration);
   printf("[MKVAUDIO] found %lu bytes, %u samples per frame\n",_length,_frameDurationInSample);
   _currentLace=_maxLace=0;



From gruntster at mail.berlios.de  Sat Jun 28 12:21:56 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 28 Jun 2008 12:21:56 +0200
Subject: [Avidemux-svn-commit] r4173 -
	branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4
Message-ID: <200806281021.m5SALuow012143@sheep.berlios.de>

Author: gruntster
Date: 2008-06-28 12:21:48 +0200 (Sat, 28 Jun 2008)
New Revision: 4173

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
Log:
[MP4] warn if audio stream appears invalid for MP4 container (FS#212)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2008-06-28 08:21:32 UTC (rev 4172)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2008-06-28 10:21:48 UTC (rev 4173)
@@ -121,7 +121,7 @@
 uint32_t skipping=1;
 pthread_t     audioThread;
 audioQueueMT context;
-PacketQueue   *pq;//("MP4 audioQ",50,2*1024*1024);
+PacketQueue   *pq = NULL;//("MP4 audioQ",50,2*1024*1024);
 uint32_t    totalAudioSize=0;
 uint32_t sent=0;
 const char *containerTitle;
@@ -257,6 +257,22 @@
           if(audio)
           {
                 audioinfo=audio->getInfo();
+
+				if (muxerType == MUXER_MP4)
+				{
+					switch (audioinfo->encoding)
+					{
+						case WAV_MP2:
+						case WAV_MP3:
+						case WAV_AAC:
+						case WAV_AAC_HE:
+							break;
+						default:
+							if (!GUI_YesNo(QT_TR_NOOP("Invalid audio stream detected"), QT_TR_NOOP("The audio stream may be invalid for this container.\n\nContinue anyway?")))
+								goto stopit;
+					}
+				}
+
                 audio->extraData(&extraDataSize,&extraData);
                 if(audioProcessMode())
                         encoding_gui->setAudioCodec(getStrFromAudioCodec(audio->getInfo()->encoding));
@@ -360,7 +376,7 @@
 stopit:
     printf("2nd pass, sent %u frames\n",sent);
     // Flush slave Q
-    if(audio)
+    if(pq)
     {
         context.audioAbort=1;
         pq->Abort();



From gruntster at mail.berlios.de  Sat Jun 28 14:04:44 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 28 Jun 2008 14:04:44 +0200
Subject: [Avidemux-svn-commit] r4174 - in
	branches/avidemux_2.4_branch/avidemux: ADM_libraries/ADM_smjs
	ADM_osSupport ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200806281204.m5SC4iVi011215@sheep.berlios.de>

Author: gruntster
Date: 2008-06-28 14:04:31 +0200 (Sat, 28 Jun 2008)
New Revision: 4174

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
Log:
[Win32] better support for user profiles and custom scripts with Unicode paths (FS#418)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt	2008-06-28 10:21:48 UTC (rev 4173)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/CMakeLists.txt	2008-06-28 12:04:31 UTC (rev 4174)
@@ -24,3 +24,4 @@
 	add_definitions(-Drealloc=ADM_realloc)
 	add_definitions(-Dfree=ADM_dezalloc)
 	add_definitions(-Dcalloc=ADM_calloc -I/usr/include/nspr)
+    add_definitions(-Dfopen=ADM_fopen)
\ No newline at end of file

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 10:21:48 UTC (rev 4173)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 12:04:31 UTC (rev 4174)
@@ -23,6 +23,7 @@
 #include <unistd.h>
 
 #ifdef __WIN32__
+#include <direct.h>
 #include <shlobj.h>
 #include <fcntl.h>
 #endif
@@ -42,6 +43,7 @@
 
 #ifdef __WIN32
 extern int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString);
+extern int wideCharStringToUtf8(const wchar_t *wideCharString, int wideCharStringLength, char *utf8String);
 #endif
 
 size_t ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream)
@@ -115,8 +117,6 @@
 
 			HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);
 
-			printf("CreateFile %s\n", path);
-
 			if (hFile == INVALID_HANDLE_VALUE)
 				return -1;
 			else
@@ -209,31 +209,43 @@
 ******************************************************/
 char *ADM_getBaseDir(void)
 {
-char *dirname=NULL;
-DIR *dir=NULL;
+	char *home;
 
-        if(baseDirDone) return basedir;
-// Get the base directory
+	if(baseDirDone)
+		return basedir;
+
+	// Get the base directory
 #if defined(ADM_WIN32)
-	char home[MAX_PATH];
+	wchar_t wcHome[MAX_PATH];
 
-	if (SHGetFolderPath(NULL, CSIDL_APPDATA, NULL, 0, home) != S_OK)
+	if (SHGetFolderPathW(NULL, CSIDL_APPDATA, NULL, 0, wcHome) == S_OK)
 	{
+		int len = wideCharStringToUtf8(wcHome, -1, NULL);
+		home = new char[len];
+
+		wideCharStringToUtf8(wcHome, -1, home);
+	}
+	else
+	{
 		GUI_Error_HIG(QT_TR_NOOP("Oops"), QT_TR_NOOP("Can't determine the Application Data folder."));
-		strcpy(home, "c:\\");
+		home = ADM_strdup("c:\\");
 	}
 #else
-		char *home;
+	const char* homeEnv = getenv("HOME");
 
-        if( ! (home=getenv("HOME")) )
-        {
-          GUI_Error_HIG(QT_TR_NOOP("Oops"),QT_TR_NOOP("can't determine $HOME."));
-                return NULL;
-        }
+	if (homeEnv)
+		home = ADM_strdup(homeEnv);
+	else
+	{
+		GUI_Error_HIG(QT_TR_NOOP("Oops"), QT_TR_NOOP("can't determine $HOME."));
+
+		return NULL;
+	}
 #endif
 
  // Try to open the .avidemux directory
-        dirname=new char[strlen(home)+strlen(ADM_DIR_NAME)+2];
+		char *dirname = new char[strlen(home)+strlen(ADM_DIR_NAME)+2];
+
         strcpy(dirname,home);
         strcat(dirname,ADM_DIR_NAME);
         if(!ADM_mkdir(dirname))
@@ -248,9 +260,21 @@
         strncpy(basedir,home,1023);
         strncat(basedir,ADM_DIR_NAME,1023-strlen(basedir));
         baseDirDone=1;
+		delete [] home;
+
         printf("Using %s as base directory for prefs/jobs/...\n",basedir);
+
         return basedir;
 }
+
+#ifdef __WIN32
+#define DIR _WDIR
+#define dirent _wdirent
+#define opendir _wopendir
+#define readdir _wreaddir
+#define closedir _wclosedir
+#endif
+
 /*----------------------------------------
       Create a directory
       If it already exists, do nothing
@@ -258,8 +282,18 @@
 uint8_t ADM_mkdir(const char *dirname)
 {
 DIR *dir=NULL;
+
+#ifdef __WIN32
+	int dirNameLength = utf8StringToWideChar(dirname, -1, NULL);
+	wchar_t dirname2[dirNameLength];
+
+	utf8StringToWideChar(dirname, -1, dirname2);
+#else
+	const char* dirname2 = dirname;
+#endif
+
               // Check it already exists ?
-              dir=opendir(dirname);
+              dir=opendir(dirname2);
               if(dir)
               { 
                   printf("Directory %s exists.Good.\n",dirname);
@@ -267,27 +301,28 @@
                   return 1;
               }
 #if defined(ADM_WIN32)
-                if(mkdir(dirname))
+                if(_wmkdir(dirname2))
                 {
                     printf("Oops: mkdir failed on %s\n",dirname);   
                     return 0;
                 }
                 
 #else    
-                char *sys=new char[strlen(dirname)+strlen("mkdir ")+2];
+                char *sys=new char[strlen(dirname2)+strlen("mkdir ")+2];
                 strcpy(sys,"mkdir ");
-                strcat(sys,dirname);
+                strcat(sys,dirname2);
                 printf("Creating dir :%s\n",sys);
                 system(sys);
                 delete [] sys;
 #endif		
-              if((dir=opendir(dirname))==NULL)
+              if((dir=opendir(dirname2))==NULL)
                 {
                         return 0;
                 }
               closedir(dir); 
               return 1;
 }
+
 uint8_t buildDirectoryContent(uint32_t *outnb,const char *base, char *jobName[],int maxElems,const char *ext)
 {
 
@@ -296,27 +331,44 @@
 int dirmax=0,len;
 int extlen=strlen(ext);
     ADM_assert(extlen);
-    
-         dir=opendir(base);
+
+#ifdef __WIN32
+	int dirNameLength = utf8StringToWideChar(base, -1, NULL);
+	wchar_t base2[dirNameLength];
+
+	utf8StringToWideChar(base, -1, base2);
+#else
+	const char *base2 = base;
+#endif
+
+         dir=opendir(base2);
         if(!dir)
-        {
                 return 0;
-        }
+
         while((direntry=readdir(dir)))
         {
-                len=strlen(direntry->d_name);
+#ifdef __WIN32
+		int dirLength = wideCharStringToUtf8(direntry->d_name, -1, NULL);
+		char d_name[dirLength];
+
+		wideCharStringToUtf8(direntry->d_name, -1, d_name);
+#else
+		const char *d_name = direntry->d_name;
+#endif
+
+                len=strlen(d_name);
                 if(len<(extlen+1)) continue;
                 int xbase=len-extlen;
-                if(memcmp(direntry->d_name+xbase,ext,extlen))
+                if(memcmp(d_name+xbase,ext,extlen))
                 //if(direntry->d_name[len-1]!='s' || direntry->d_name[len-2]!='j' || direntry->d_name[len-3]!='.')
                 {
-                        printf("ignored:%s\n",direntry->d_name);
+                        printf("ignored:%s\n",d_name);
                         continue;
                 }
-                jobName[dirmax]=(char *)ADM_alloc(strlen(base)+strlen(direntry->d_name)+2);
+                jobName[dirmax]=(char *)ADM_alloc(strlen(base)+strlen(d_name)+2);
                 strcpy(jobName[dirmax],base);
                 strcat(jobName[dirmax],"/");
-                strcat(jobName[dirmax],direntry->d_name);
+                strcat(jobName[dirmax],d_name);
                 dirmax++;
                 if(dirmax>=maxElems)
                 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2008-06-28 10:21:48 UTC (rev 4173)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2008-06-28 12:04:31 UTC (rev 4174)
@@ -437,9 +437,17 @@
 	strcat(logPath, "/");
 	strcat(logPath, logFile);
 
-	stream = freopen(logPath, "w", stdout);
-	*stderr = *stream;
+	fclose(stdout);
+	fclose(stderr);
 
+	stream = fopen(logPath, "w");
+
+	if (stream)
+	{
+		*stdout = *stream;
+		*stderr = *stream;
+	}
+
 	// Line buffering
 	setvbuf(stdout, NULL, _IOLBF, BUFSIZ); 
 	setvbuf(stderr, NULL, _IOLBF, BUFSIZ);
@@ -448,20 +456,15 @@
 #endif
 }
 
-// Convert string from ANSI code page to UTF-8
-int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String)
+// Convert string from ANSI code page to wide char
+int ansiStringToWideChar(const char *ansiString, int ansiStringLength, wchar_t *wideCharString)
 {
 	int wideCharStringLen = MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, NULL, 0);
-	wchar_t wideCharString[wideCharStringLen];
 
-	MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, wideCharString, wideCharStringLen);
+	if (wideCharString)
+		MultiByteToWideChar(CP_ACP, 0, ansiString, ansiStringLength, wideCharString, wideCharStringLen);
 
-	int multiByteStringLen = WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, NULL, 0, NULL, NULL);
-
-	if (utf8String)
-		WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLen, utf8String, multiByteStringLen, NULL, NULL);
-
-	return multiByteStringLen;
+	return wideCharStringLen;
 }
 
 // Convert UTF-8 string to wide char
@@ -474,4 +477,31 @@
 
 	return wideCharStringLength;
 }
+
+// Convert Wide Char string to UTF-8
+int wideCharStringToUtf8(const wchar_t *wideCharString, int wideCharStringLength, char *utf8String)
+{
+	int utf8StringLen = WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLength, NULL, 0, NULL, NULL);
+
+	if (utf8String)
+		WideCharToMultiByte(CP_UTF8, 0, wideCharString, wideCharStringLength, utf8String, utf8StringLen, NULL, NULL);
+
+	return utf8StringLen;
+}
+
+// Convert string from ANSI code page to UTF-8
+int ansiStringToUtf8(const char *ansiString, int ansiStringLength, char *utf8String)
+{
+	int wideCharStringLen = ansiStringToWideChar(ansiString, ansiStringLength, NULL);
+	wchar_t wideCharString[wideCharStringLen];
+
+	ansiStringToWideChar(ansiString, ansiStringLength, wideCharString);
+
+	int multiByteStringLen = wideCharStringToUtf8(wideCharString, wideCharStringLen, NULL);
+
+	if (utf8String)
+		wideCharStringToUtf8(wideCharString, wideCharStringLen, utf8String);
+
+	return multiByteStringLen;
+}
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-28 10:21:48 UTC (rev 4173)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-28 12:04:31 UTC (rev 4174)
@@ -566,7 +566,7 @@
 
 		for(int i=0; i < ADM_nbCustom; i++)
 		{
-			customActions[i] = new QAction(GetFileName(customNames[i]), NULL);
+			customActions[i] = new QAction(QString::fromUtf8(GetFileName(customNames[i])), NULL);
 			ui.menuCustom->addAction(customActions[i]);
 			connect(customActions[i], SIGNAL(triggered()), this, SLOT(custom()));
 		}



From gruntster at mail.berlios.de  Sat Jun 28 15:03:57 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 28 Jun 2008 15:03:57 +0200
Subject: [Avidemux-svn-commit] r4175 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice
Message-ID: <200806281303.m5SD3v2x017758@sheep.berlios.de>

Author: gruntster
Date: 2008-06-28 15:03:51 +0200 (Sat, 28 Jun 2008)
New Revision: 4175

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
Log:
[CMake] pulseaudio fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt	2008-06-28 12:04:31 UTC (rev 4174)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/CMakeLists.txt	2008-06-28 13:03:51 UTC (rev 4175)
@@ -12,4 +12,4 @@
 if(USE_PULSE_SIMPLE)
   add_definitions(${PULSEAUDIOSIMPLE_DEFINITIONS})
   include_directories(${PULSEAUDIOSIMPLE_INCLUDE_DIR})
-endif(USE_ARTS)
+endif(USE_PULSE_SIMPLE)

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2008-06-28 12:04:31 UTC (rev 4174)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2008-06-28 13:03:51 UTC (rev 4175)
@@ -247,8 +247,12 @@
 if(NEED_LIBICONV)
 	add_libs_all_targets(iconv)
 endif(NEED_LIBICONV)
+
 # Pulse audio
+if(USE_PULSE_SIMPLE)
 	add_libs_all_targets(pulse-simple)
+endif(USE_PULSE_SIMPLE)
+
 #gettext
 if(ADM_GETTEXT_LIB)
 	INCLUDE_DIRECTORIES(${ADM_GETTEXT_INCLUDE})



From gruntster at mail.berlios.de  Sat Jun 28 16:49:03 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 28 Jun 2008 16:49:03 +0200
Subject: [Avidemux-svn-commit] r4176 -
	branches/avidemux_2.4_branch/avidemux/ADM_osSupport
Message-ID: <200806281449.m5SEn3fM024727@sheep.berlios.de>

Author: gruntster
Date: 2008-06-28 16:48:41 +0200 (Sat, 28 Jun 2008)
New Revision: 4176

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
Log:
[Win32] re-enable shared reading (lost in r4164; now open all files read/write but request exclusive write access when writing)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 13:03:51 UTC (rev 4175)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 14:48:41 UTC (rev 4176)
@@ -61,36 +61,39 @@
 FILE  *ADM_fopen (const char *file, const char *mode)
 {
 #ifdef __MINGW32__
+	// Open everything read/write since _open_osfhandle will restrict I/O calls
+	// to the mode that's passed in anyway.
+	// Always allow shared reading.  Only allow shared writing when in reading
+	// mode so write locks will be denied.
+
 	int fileNameLength = utf8StringToWideChar(file, -1, NULL);
 	wchar_t wcFile[fileNameLength];
+	int creation = 0, share = 0;
 
 	utf8StringToWideChar(file, -1, wcFile);
 
-	if (strchr(mode, 'w') == NULL)
+	if (strchr(mode, 'w'))
 	{
-		// open file normally for reading or appending
-		int modeLength = utf8StringToWideChar(mode, -1, NULL);
-		wchar_t wcMode[modeLength];
-
-		utf8StringToWideChar(mode, -1, wcMode);
-
-		return _wfopen(wcFile, wcMode);
+		creation = CREATE_ALWAYS;
+		share = FILE_SHARE_READ;
 	}
-	else
+	else if (strchr(mode, 'r'))
 	{
-		// open file exclusively for writing (and reading if need be)
-		int access = GENERIC_WRITE;
+		creation = OPEN_EXISTING;
+		share = FILE_SHARE_READ | FILE_SHARE_WRITE;
+	}
+	else if (strchr(mode, 'a'))
+	{
+		creation = OPEN_ALWAYS;
+		share = FILE_SHARE_READ;
+	}
 
-		if (strstr(mode, "w+") != NULL)
-			access |= GENERIC_READ;
+	HANDLE hFile = CreateFileW(wcFile, GENERIC_READ | GENERIC_WRITE, share, NULL, creation, 0, NULL);
 
-		HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);
-
-		if (hFile == INVALID_HANDLE_VALUE)
-			return NULL;
-		else
-			return _fdopen(_open_osfhandle((intptr_t)hFile, 0), mode);
-	}
+	if (hFile == INVALID_HANDLE_VALUE)
+		return NULL;
+	else
+		return _fdopen(_open_osfhandle((intptr_t)hFile, 0), mode);
 #else
 	return fopen(file, mode);
 #endif
@@ -99,40 +102,44 @@
 #if __WIN32
 extern "C"
 {
-	// libavformat uses open (in the file_open function) so we need to override that too
+	// libavformat uses open (in the file_open function) so we need to override that too.
+	// Following the same rules as ADM_fopen.
 	int ADM_open(const char *path, int oflag, ...)
 	{
 		int fileNameLength = utf8StringToWideChar(path, -1, NULL);
 		wchar_t wcFile[fileNameLength];
+		int creation = 0, share = 0;
 
 		utf8StringToWideChar(path, -1, wcFile);
 
-		if ((oflag & O_WRONLY || oflag & O_RDWR) && (oflag & O_TRUNC))
+		if (oflag & O_WRONLY || oflag & O_RDWR)
 		{
-			// open file exclusively for writing (and reading if need be)
-			int access = GENERIC_WRITE;
+			if (oflag & O_CREAT)
+			{
+				if (oflag & O_EXCL)
+					creation = CREATE_NEW;
+				else if (oflag & O_TRUNC)
+					creation = CREATE_ALWAYS;
+				else
+					creation = OPEN_ALWAYS;
+			}
+			else if (oflag & O_TRUNC)
+				creation = TRUNCATE_EXISTING;
 
-			if (oflag & O_RDWR)
-				access |= GENERIC_READ;
-
-			HANDLE hFile = CreateFileW(wcFile, access, 0, NULL, CREATE_ALWAYS, 0, NULL);
-
-			if (hFile == INVALID_HANDLE_VALUE)
-				return -1;
-			else
-				return _open_osfhandle((intptr_t)hFile, 0);
+			share = FILE_SHARE_READ;
 		}
-		else
+		else if (oflag & O_RDONLY)
 		{
-			va_list mode;
-			va_start(mode, oflag);
+			creation = OPEN_EXISTING;
+			share = FILE_SHARE_READ | FILE_SHARE_WRITE;
+		}
 
-			int file = open(path, oflag, mode);
+		HANDLE hFile = CreateFileW(wcFile, GENERIC_READ | GENERIC_WRITE, share, NULL, creation, 0, NULL);
 
-			va_end(mode);
-
-			return file;
-		}
+		if (hFile == INVALID_HANDLE_VALUE)
+			return -1;
+		else
+			return _open_osfhandle((intptr_t)hFile, oflag);
 	}
 }
 #endif



From gruntster at mail.berlios.de  Sun Jun 29 00:34:41 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 29 Jun 2008 00:34:41 +0200
Subject: [Avidemux-svn-commit] r4177 -
	branches/avidemux_2.4_branch/avidemux/ADM_osSupport
Message-ID: <200806282234.m5SMYfOu023435@sheep.berlios.de>

Author: gruntster
Date: 2008-06-29 00:34:26 +0200 (Sun, 29 Jun 2008)
New Revision: 4177

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
Log:
[Win32] third crack at making sure source files cannot be overridden

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 14:48:41 UTC (rev 4176)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_fileio.cpp	2008-06-28 22:34:26 UTC (rev 4177)
@@ -61,35 +61,51 @@
 FILE  *ADM_fopen (const char *file, const char *mode)
 {
 #ifdef __MINGW32__
-	// Open everything read/write since _open_osfhandle will restrict I/O calls
-	// to the mode that's passed in anyway.
-	// Always allow shared reading.  Only allow shared writing when in reading
-	// mode so write locks will be denied.
-
+	// Override fopen to handle Unicode filenames and to ensure exclusive access when initially writing to a file.
 	int fileNameLength = utf8StringToWideChar(file, -1, NULL);
 	wchar_t wcFile[fileNameLength];
-	int creation = 0, share = 0;
+	int creation = 0, access = 0;
+	HANDLE hFile;
 
 	utf8StringToWideChar(file, -1, wcFile);
 
 	if (strchr(mode, 'w'))
 	{
 		creation = CREATE_ALWAYS;
-		share = FILE_SHARE_READ;
+		access = GENERIC_WRITE;
+
+		if (strchr(mode, '+'))
+			access |= GENERIC_READ;
 	}
 	else if (strchr(mode, 'r'))
 	{
 		creation = OPEN_EXISTING;
-		share = FILE_SHARE_READ | FILE_SHARE_WRITE;
+		access = GENERIC_READ;
+
+		if (strchr(mode, '+'))
+			access = GENERIC_WRITE;
 	}
 	else if (strchr(mode, 'a'))
 	{
 		creation = OPEN_ALWAYS;
-		share = FILE_SHARE_READ;
+		access = GENERIC_WRITE;
+
+		if (strchr(mode, '+'))
+			access |= GENERIC_READ;
 	}
 
-	HANDLE hFile = CreateFileW(wcFile, GENERIC_READ | GENERIC_WRITE, share, NULL, creation, 0, NULL);
+	if (creation & GENERIC_WRITE)
+	{
+		hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
 
+		if (hFile == INVALID_HANDLE_VALUE)
+			return NULL;
+		else
+			CloseHandle(hFile);
+	}
+
+	hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
+
 	if (hFile == INVALID_HANDLE_VALUE)
 		return NULL;
 	else
@@ -108,12 +124,18 @@
 	{
 		int fileNameLength = utf8StringToWideChar(path, -1, NULL);
 		wchar_t wcFile[fileNameLength];
-		int creation = 0, share = 0;
+		int creation = 0, access = 0;
+		HANDLE hFile;
 
 		utf8StringToWideChar(path, -1, wcFile);
 
 		if (oflag & O_WRONLY || oflag & O_RDWR)
 		{
+			access = GENERIC_WRITE;
+
+			if (oflag & O_RDWR)
+				access |= GENERIC_READ;
+
 			if (oflag & O_CREAT)
 			{
 				if (oflag & O_EXCL)
@@ -125,16 +147,21 @@
 			}
 			else if (oflag & O_TRUNC)
 				creation = TRUNCATE_EXISTING;
-
-			share = FILE_SHARE_READ;
 		}
 		else if (oflag & O_RDONLY)
+			creation = OPEN_EXISTING;
+
+		if (creation & GENERIC_WRITE)
 		{
-			creation = OPEN_EXISTING;
-			share = FILE_SHARE_READ | FILE_SHARE_WRITE;
+			hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
+
+			if (hFile == INVALID_HANDLE_VALUE)
+				return -1;
+			else
+				CloseHandle(hFile);
 		}
 
-		HANDLE hFile = CreateFileW(wcFile, GENERIC_READ | GENERIC_WRITE, share, NULL, creation, 0, NULL);
+		hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
 
 		if (hFile == INVALID_HANDLE_VALUE)
 			return -1;
@@ -241,7 +268,10 @@
 	const char* homeEnv = getenv("HOME");
 
 	if (homeEnv)
-		home = ADM_strdup(homeEnv);
+	{
+		home = new char[strlen(homeEnv) + 1];
+		strcpy(home, homeEnv);
+	}
 	else
 	{
 		GUI_Error_HIG(QT_TR_NOOP("Oops"), QT_TR_NOOP("can't determine $HOME."));



From gruntster at mail.berlios.de  Sun Jun 29 01:13:53 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 29 Jun 2008 01:13:53 +0200
Subject: [Avidemux-svn-commit] r4178 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2
Message-ID: <200806282313.m5SNDrP9008448@sheep.berlios.de>

Author: gruntster
Date: 2008-06-29 01:13:40 +0200 (Sun, 29 Jun 2008)
New Revision: 4178

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
Log:
[GTK] allow 8 and 9 to be entered into timeshift spinbox on Linux (FS#353)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-28 22:34:26 UTC (rev 4177)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-28 23:13:40 UTC (rev 4178)
@@ -107,10 +107,6 @@
         TARGET_ROOTWIN,
         TARGET_URL
 };
-enum 
-{
-   TARGET_URI_LIST
-};
  
 static GtkTargetEntry target_table[] = 
 {
@@ -822,6 +818,8 @@
 	RM(buttonPrevKFrame, GDK_KP_2);
 
 	RM(delete1, GDK_Delete);
+	RM(set_marker_a1,GDK_bracketleft);
+	RM(set_marker_b1,GDK_bracketright);
 
 	RMCTRL(paste1,GDK_V);
 	RMCTRL(copy1,GDK_C);
@@ -845,13 +843,16 @@
 	ADD_ACT(previous_frame1, GDK_KP_4);
 	ADD_ACT(next_intra_frame1, GDK_KP_8);
 	ADD_ACT(previous_intra_frame1, GDK_KP_2);
-	ADD_ACT(delete1, GDK_Delete);
 
 	ADD(buttonNextFrame, GDK_KP_6);
 	ADD(buttonPrevFrame, GDK_KP_4);
 	ADD(buttonNextKFrame, GDK_KP_8);
 	ADD(buttonPrevKFrame, GDK_KP_2);
-	
+
+	ADD_ACT(delete1, GDK_Delete);
+	ADD_ACT(set_marker_a1,GDK_bracketleft);
+	ADD_ACT(set_marker_b1,GDK_bracketright);
+
 	ADDCTRL(paste1,GDK_V);
 	ADDCTRL(copy1,GDK_C);
 	ADDCTRL(cut1,GDK_X);
@@ -1289,6 +1290,8 @@
 
 gboolean UI_SliderPressed(GtkWidget *widget, GdkEventButton *event, gpointer user_data)
 {
+	gtk_widget_grab_focus(lookup_widget(guiRootWindow, "menuBar"));
+
 	if(event->state&GDK_SHIFT_MASK) SliderIsShifted=TRUE;
 	return FALSE;
 



From mean at mail.berlios.de  Sun Jun 29 16:02:04 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 29 Jun 2008 16:02:04 +0200
Subject: [Avidemux-svn-commit] r4179 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200806291402.m5TE24wf030363@sheep.berlios.de>

Author: mean
Date: 2008-06-29 16:02:04 +0200 (Sun, 29 Jun 2008)
New Revision: 4179

Modified:
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
[Main] Call initmemcpy earlier to prevent a crash in prefs

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2008-06-28 23:13:40 UTC (rev 4178)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2008-06-29 14:02:04 UTC (rev 4179)
@@ -184,7 +184,7 @@
    // Start counting memory
 	ADM_memStatInit();
 	ADM_intFloatInit();
-
+    ADM_InitMemcpy();
 	printf("\nInitialising prefs\n");
 	initPrefs();
 	prefs->load();
@@ -210,8 +210,8 @@
 #endif
 
     initFileSelector();
-    ADM_InitMemcpy();
 
+
 	// Load .avidemuxrc
     quotaInit();
 



From gruntster at mail.berlios.de  Mon Jun 30 03:56:01 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 30 Jun 2008 03:56:01 +0200
Subject: [Avidemux-svn-commit] r4180 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_NONE/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_gui ADM_userInterfaces/ADM_commonUI
Message-ID: <200806300156.m5U1u1xU005966@sheep.berlios.de>

Author: gruntster
Date: 2008-06-30 03:55:48 +0200 (Mon, 30 Jun 2008)
New Revision: 4180

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[GUI] enable jumping to frame 0

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-29 14:02:04 UTC (rev 4179)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-06-30 01:55:48 UTC (rev 4180)
@@ -953,13 +953,14 @@
 
 
 }
-uint32_t UI_readCurFrame( void )
+int UI_readCurFrame( void )
 {
-int i;
-	i=gtk_read_entry(guiCurFrame);
-	if(i<0) i=0;
-	return  (uint32_t)i;
-	 
+	int i = gtk_read_entry(guiCurFrame);
+
+	if(i < 0)
+		i = 0;
+
+	return i;
 }
 
 int UI_readCurTime(uint16_t &hh, uint16_t &mm, uint16_t &ss, uint16_t &ms)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2008-06-29 14:02:04 UTC (rev 4179)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2008-06-30 01:55:48 UTC (rev 4180)
@@ -99,7 +99,7 @@
 void UI_deiconify( void )
 {}
 
-uint32_t UI_readCurFrame( void )
+int UI_readCurFrame( void )
 {
     return 0;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-29 14:02:04 UTC (rev 4179)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2008-06-30 01:55:48 UTC (rev 4180)
@@ -788,11 +788,11 @@
 	_upd_in_progres--;
 }
 
-uint32_t UI_readCurFrame(void)
+int UI_readCurFrame(void)
 {
 	bool ok;
 	
-	return WIDGET(lineEdit)->text().toUInt(&ok);
+	return WIDGET(lineEdit)->text().toInt(&ok);
 }
 
 int UI_readCurTime(uint16_t &hh, uint16_t &mm, uint16_t &ss, uint16_t &ms)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2008-06-29 14:02:04 UTC (rev 4179)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2008-06-30 01:55:48 UTC (rev 4180)
@@ -22,7 +22,7 @@
 void UI_iconify( void );
 void UI_deiconify( void );
 
-uint32_t UI_readCurFrame( void );
+int UI_readCurFrame( void );
 int UI_readCurTime(uint16_t &hh, uint16_t &mm, uint16_t &ss, uint16_t &ms);
 void UI_JumpDone(void);
 

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-29 14:02:04 UTC (rev 4179)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2008-06-30 01:55:48 UTC (rev 4180)
@@ -469,10 +469,8 @@
         case ACT_JumpToFrame:
                 // read value
                 nf=UI_readCurFrame();
-                if(nf>0 && nf< avifileinfo->nb_frames)
-                {
-                        GUI_GoToFrame(nf);
-                }
+				if(nf< avifileinfo->nb_frames)
+					GUI_GoToFrame(nf);
                 UI_JumpDone();
                 break;
 	case ACT_JumpToTime:
@@ -706,16 +704,10 @@
       fn=curframe;
       if (DIA_GetIntegerValue ((int *)&fn,0,avifileinfo->nb_frames,QT_TR_NOOP("Go to Frame"),QT_TR_NOOP("_Go to frame:")))
 	{
-	  if (fn)
-	    {			// 0 probably means garbage
-	      if (fn < avifileinfo->nb_frames)
-		{
-		  curframe = fn;
-		  GUI_GoToFrame (curframe);
-		}
-	      else
-                GUI_Error_HIG (QT_TR_NOOP("Out of bounds"), NULL);
-	    }
+		if (fn < avifileinfo->nb_frames)
+			GUI_GoToFrame (curframe);
+		else
+			GUI_Error_HIG (QT_TR_NOOP("Out of bounds"), NULL);
 	}
       break;
 //----------------------test-----------------------



From mean at mail.berlios.de  Mon Jun 30 07:51:09 2008
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 30 Jun 2008 07:51:09 +0200
Subject: [Avidemux-svn-commit] r4181 - in
	branches/avidemux_2.4_branch/avidemux: ADM_filter ADM_videoFilter
Message-ID: <200806300551.m5U5p9Or025387@sheep.berlios.de>

Author: mean
Date: 2008-06-30 07:51:01 +0200 (Mon, 30 Jun 2008)
New Revision: 4181

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidNumber.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
Log:
[Filter] Put framenumber in video

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2008-06-30 01:55:48 UTC (rev 4180)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2008-06-30 05:51:01 UTC (rev 4181)
@@ -187,6 +187,7 @@
 	REGISTERX("swissarmyknife",QT_TR_NOOP("Swiss Army Knife"),QT_TR_NOOP("Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant"),VF_SWISSARMYKNIFE,1,swissarmyknife_create,swissarmyknife_script);
 	REGISTERX("threshold",QT_TR_NOOP("Threshold"),QT_TR_NOOP("Force too-bright/too-dim pixels to 0 and the rest to 255 or vice-versa"),VF_THRESHOLD,1,threshold_create,threshold_script);
 	REGISTERX("particlelist",QT_TR_NOOP("Particle List"),QT_TR_NOOP("Identify 'particles' (groups of pixels)"),VF_PARTICLELIST,1,particle_create,particle_script);
+    REGISTERX("framenum",QT_TR_NOOP("Add Framenumber"),QT_TR_NOOP("Print frame number directly in image"),VF_FRAMENUM,1,number_create,number_script);
 
 // Does not work
 //        REGISTERX("unblend","Unblend by Bach",VF_UNBLEND,1,unblend_create,unblend_script);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-30 01:55:48 UTC (rev 4180)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2008-06-30 05:51:01 UTC (rev 4181)
@@ -105,6 +105,7 @@
                 VF_SWISSARMYKNIFE,
                 VF_THRESHOLD,
                 VF_PARTICLELIST,
+                VF_FRAMENUM,
                 VF_DUMMY,
                 VF_COUNT,
                 MAX_FILTER = VF_COUNT - 1,

Added: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidNumber.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidNumber.cpp	2008-06-30 01:55:48 UTC (rev 4180)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidNumber.cpp	2008-06-30 05:51:01 UTC (rev 4181)
@@ -0,0 +1,95 @@
+/***************************************************************************
+                          ADM_vidNumber.cpp  -  Add frame number 
+                             -------------------
+
+    copyright            : (C) 2008 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+ #include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <ADM_assert.h>
+
+#include "config.h"
+#include "fourcc.h"
+#include "avio.hxx"
+#include "config.h"
+#include "avi_vars.h"
+#ifdef HAVE_ENCODER
+
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_filter/video_filters.h"
+
+
+static FILTER_PARAM flipParam={0,{""}};
+
+ class  ADMVideoNumber:public AVDMGenericVideoStream
+ {
+
+ protected:
+    		AVDMGenericVideoStream 	*_in;    	
+           virtual char 									*printConf(void);
+          
+ public:
+ 		
+  					ADMVideoNumber(  AVDMGenericVideoStream *in,CONFcouple *setup);
+  					virtual ~ADMVideoNumber();
+		          virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+          																	ADMImage *data,uint32_t *flags);
+					virtual uint8_t configure( AVDMGenericVideoStream *instream) { UNUSED_ARG(instream); return 1;};          																	
+
+
+ }     ;
+SCRIPT_CREATE(number_script,ADMVideoNumber,flipParam);
+BUILD_CREATE(number_create,ADMVideoNumber);
+ 
+
+char *ADMVideoNumber::printConf( void )
+{
+    ADM_FILTER_DECLARE_CONF(" Add Frame Number");
+        
+}
+
+ADMVideoNumber::ADMVideoNumber(  AVDMGenericVideoStream *in,CONFcouple *setup)
+{
+    UNUSED_ARG(setup);
+ 	_in=in;		
+   	memcpy(&_info,_in->getInfo(),sizeof(_info)); 	
+  	_info.encoding=1;	
+}
+ADMVideoNumber::~ADMVideoNumber()
+{
+  
+}
+uint8_t ADMVideoNumber::getFrameNumberNoAlloc(uint32_t frame,
+				uint32_t *len,
+   				ADMImage *data,
+				uint32_t *flags)
+{
+
+	if(frame>= _info.nb_frames) return 0;
+	// read uncompressed frame
+	if(!_in->getFrameNumberNoAlloc(frame, len,data,flags)) return 0;
+    char f[50];
+    snprintf(f,49,"%08u",frame);
+    drawString(data, 2, 2, f); 
+        
+	return 1;
+}
+
+
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2008-06-30 01:55:48 UTC (rev 4180)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2008-06-30 05:51:01 UTC (rev 4181)
@@ -43,6 +43,7 @@
 ADM_vidThreshold.cpp
 ADM_vidParticle.cpp
 ADM_vidEraser.cpp
+ADM_vidNumber.cpp
 
 )
 ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2008-06-30 01:55:48 UTC (rev 4180)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2008-06-30 05:51:01 UTC (rev 4181)
@@ -81,7 +81,8 @@
  ADM_vidSwissArmyKnife.cpp \
  ADM_vidThreshold.cpp \
  ADM_vidParticle.cpp       \
- ADM_vidEraser.cpp
+ ADM_vidEraser.cpp \
+ ADM_vidNumber.cpp
 
 
 INCLUDES = $(all_includes) -I../ADM_libraries -I../ADM_libraries/ADM_utilities -I../ADM_libraries/ADM_lavutil \



From gruntster at mail.berlios.de  Mon Jun 30 20:30:18 2008
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 30 Jun 2008 20:30:18 +0200
Subject: [Avidemux-svn-commit] r4182 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs ADM_encoder
Message-ID: <200806301830.m5UIUIXF002798@sheep.berlios.de>

Author: gruntster
Date: 2008-06-30 20:30:09 +0200 (Mon, 30 Jun 2008)
New Revision: 4182

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.h
Log:
[x264] flush encoder so last few frames aren't dropped (FS#367)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp	2008-06-30 05:51:01 UTC (rev 4181)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp	2008-06-30 18:30:09 UTC (rev 4182)
@@ -246,13 +246,22 @@
   PICS->img.i_stride[2] = _w >> 1;
 
   PICS->i_type = X264_TYPE_AUTO;
-  PICS->i_pts = curFrame++;
+  PICS->i_pts = curFrame;
+
   if (x264_encoder_encode (HANDLE, &nal, &nbNal, PICS, &pic_out) < 0)
-    {
-      printf ("[x264] Error encoding\n");
-      return 0;
-    }
+  {
+	  printf ("[x264] Error encoding\n");
+	  return 0;
+  }
+  curFrame++;
 
+  if (nbNal == 0)
+  {
+      printf("[X264] No Nal for frame %u (delay ?)\n",curFrame);
+      out->len=0;
+	  return 1;
+  }
+
   // Write
 
   uint32_t    size = 0, thisnal = 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.cpp	2008-06-30 05:51:01 UTC (rev 4181)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.cpp	2008-06-30 18:30:09 UTC (rev 4182)
@@ -92,6 +92,9 @@
   ADM_assert (_vbuffer);
   _in = instream;
   _fps1000 = info->fps1000;
+  _availableFrames = instream->getInfo()->nb_frames;
+  _delayed = 0;
+
   switch (_param.mode)
     {
 
@@ -193,38 +196,58 @@
 uint8_t
         EncoderX264::encode (uint32_t frame, ADMBitstream *out)
 {
-  uint32_t l, f, q;
-  uint8_t r = 0;
-  //ENC_RESULT enc;
+	ADM_assert (_codec);
+	ADM_assert (_in);
 
-  ADM_assert (_codec);
-  ADM_assert (_in);
+	uint32_t l, f;
+	bool firstFrame = !frame;
+	bool success = false;
+	int maxDelay = _codecParam.MaxRefFrames + _codecParam.MaxBFrame;
 
-  if (!_in->getFrameNumberNoAlloc (frame, &l, _vbuffer, &f))
-    {
-      printf ("\n[x264] Error: Cannot read incoming frame!");
-      return 0;
-    }
+	if (maxDelay < 7)
+		maxDelay = 7;
 
-  //   return _codec->encode (_vbuffer, out, len, flags);
-  switch (_state)
-    {
+	frame += _delayed;
 
+	while (!success)
+	{
+		if (frame >= _availableFrames)
+		{
+			frame = _availableFrames - 1;
+			printf("[x264] Repeating last frame %u (delay=%u)\n",frame,_delayed);
+		}
+		//printf("[x264] Getting frame :%u delay :%u\n",frame,_delayed);
+		if (!_in->getFrameNumberNoAlloc(frame, &l, _vbuffer, &f))
+		{
+			printf ("\n[x264] Error: Cannot read incoming frame!");
+			return 0;
+		}
 
-    case enc_CBR:
-    case enc_CQ:
-    case enc_Pass1:
-    case enc_Pass2:
-      r = _codec->encode (_vbuffer, out );
-      return r;
-      break;
+		switch (_state)
+		{
+			case enc_CBR:
+			case enc_CQ:
+			case enc_Pass1:
+			case enc_Pass2:
+				if (_codec->encode(_vbuffer, out))
+				{
+					if (out->len == 0 && _delayed < maxDelay && firstFrame)
+					{
+						_delayed++;
+						frame++;
+						printf("[x264] Delay so far :%u\n",_delayed);
+					}
+					else
+						success = true;
+				}
 
-    default:
-      ADM_assert (0);
-    }
-  return 1;
+				break;
+			default:
+				ADM_assert(0);
+		}
+	}
 
-
+	return 1;
 }
 
 //_______________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.h	2008-06-30 05:51:01 UTC (rev 4181)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encx264.h	2008-06-30 18:30:09 UTC (rev 4182)
@@ -36,6 +36,8 @@
 
   X264Encoder * _codec;
   char *_logfile;
+  uint32_t _delayed;
+  uint32_t _availableFrames;
   uint32_t _q;
   uint32_t _pass1Done;
   uint32_t _fps1000;



