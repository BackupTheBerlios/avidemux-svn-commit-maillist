<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3797 - in	branches/avidemux_2.5_branch_mean/avidemux: ADM_editor	ADM_inputs/ADM_asf ADM_inputs/ADM_inpics	ADM_inputs/ADM_matroska ADM_libraries/ADM_utilities	ADM_outputs/oplug_avi ADM_toolkit
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3797%20-%20in%0A%09branches/avidemux_2.5_branch_mean/avidemux%3A%20ADM_editor%0A%09ADM_inputs/ADM_asf%20ADM_inputs/ADM_inpics%0A%09ADM_inputs/ADM_matroska%20ADM_libraries/ADM_utilities%0A%09ADM_outputs/oplug_avi%20ADM_toolkit&In-Reply-To=%3C200802221910.m1MJA5be028232%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001063.html">
   <LINK REL="Next"  HREF="001065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3797 - in	branches/avidemux_2.5_branch_mean/avidemux: ADM_editor	ADM_inputs/ADM_asf ADM_inputs/ADM_inpics	ADM_inputs/ADM_matroska ADM_libraries/ADM_utilities	ADM_outputs/oplug_avi ADM_toolkit</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3797%20-%20in%0A%09branches/avidemux_2.5_branch_mean/avidemux%3A%20ADM_editor%0A%09ADM_inputs/ADM_asf%20ADM_inputs/ADM_inpics%0A%09ADM_inputs/ADM_matroska%20ADM_libraries/ADM_utilities%0A%09ADM_outputs/oplug_avi%20ADM_toolkit&In-Reply-To=%3C200802221910.m1MJA5be028232%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3797 - in	branches/avidemux_2.5_branch_mean/avidemux: ADM_editor	ADM_inputs/ADM_asf ADM_inputs/ADM_inpics	ADM_inputs/ADM_matroska ADM_libraries/ADM_utilities	ADM_outputs/oplug_avi ADM_toolkit">mean at mail.berlios.de
       </A><BR>
    <I>Fri Feb 22 20:10:05 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001063.html">[Avidemux-svn-commit] r3796 -	branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics
</A></li>
        <LI>Next message: <A HREF="001065.html">[Avidemux-svn-commit] r3798 - in	branches/avidemux_2.5_branch_mean/avidemux: ADM_audio	ADM_audiocodec ADM_editor ADM_encoder ADM_filter	ADM_libraries/ADM_libswscale ADM_libraries/ADM_utilities	ADM_ocr ADM_outputs/oplug_avi ADM_outputs/oplug_ogm	ADM_toolkit ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_ocr	ADM_userInterfaces/ADM_NONE/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_gui	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1064">[ date ]</a>
              <a href="thread.html#1064">[ thread ]</a>
              <a href="subject.html#1064">[ subject ]</a>
              <a href="author.html#1064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-02-22 20:10:04 +0100 (Fri, 22 Feb 2008)
New Revision: 3797

Modified:
   branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_Video.h
   branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edStub.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avifmt2.h
   branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_avisave.h
   branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
   branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx
   branches/avidemux_2.5_branch_mean/avidemux/ADM_toolkit/bitmap.h
Log:
[Cleanup] cleanup the BITMAPINFOHEADER mess


Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_Video.h
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_Video.h	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_Video.h	2008-02-22 19:10:04 UTC (rev 3797)
@@ -56,7 +56,7 @@
           MainAVIHeader 	_mainaviheader;
           uint8_t		_isvideopresent;
           AVIStreamHeader 	_videostream;
-          BITMAPINFOHEADER  	_video_bih;
+          ADM_BITMAPINFOHEADER  _video_bih;
           uint8_t		_isaudiopresent;
           AVIStreamHeader 	_audiostream;
           void			*_audiostreaminfo;
@@ -121,7 +121,7 @@
 // New write avi engine
           AVIStreamHeader           *getVideoStreamHeader(void ) { return &amp;_videostream;}
           MainAVIHeader             *getMainHeader(void ) { return &amp;_mainaviheader;}
-          BITMAPINFOHEADER          *getBIH(void ) { return &amp;_video_bih;}
+          ADM_BITMAPINFOHEADER      *getBIH(void ) { return &amp;_video_bih;}
 
 };
 #endif

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edStub.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edStub.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edStub.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -369,8 +369,7 @@
   return STUBB-&gt;getMainHeader ();
 }
 
-BITMAPINFOHEADER *
-ADM_Composer::getBIH (void)
+ADM_BITMAPINFOHEADER *ADM_Composer::getBIH (void)
 {
   return STUBB-&gt;getBIH ();
 };

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2008-02-22 19:10:04 UTC (rev 3797)
@@ -221,7 +221,7 @@
 			     		uint8_t 			setDecodeParam( uint32_t frame );
 	 				AVIStreamHeader 	*getVideoStreamHeader(void ) ;
 	 				MainAVIHeader 		*getMainHeader(void );
-	 				BITMAPINFOHEADER 	*getBIH(void ) ;
+	 				ADM_BITMAPINFOHEADER 	*getBIH(void ) ;
 	  				uint8_t			getVideoInfo(aviInfo *info);
 					WAVHeader 		*getAudioInfo(void )  ;
 					uint32_t 			getAudioLength(void);

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -488,8 +488,8 @@
             trk-&gt;streamIndex=sid;
             s-&gt;read((uint8_t *)&amp;(trk-&gt;wavHeader),sizeof(WAVHeader));
 
-		#ifdef ADM_BIG_ENDIAN
-			Endian_WavHeader(&amp;(trk-&gt;wavHeader));
+		#ifdef ADM_BIG_ENDIAN
+			Endian_WavHeader(&amp;(trk-&gt;wavHeader));
 		#endif
 
             trk-&gt;extraDataLen=s-&gt;read16();
@@ -560,11 +560,11 @@
             _video_bih.biHeight=h;
             printf(&quot;Pic Width  %04d\n&quot;,w);
             printf(&quot;Pic Height %04d\n&quot;,h);
-            printf(&quot; BMP size  %04d (%04d)\n&quot;,x,sizeof(BITMAPINFOHEADER));
-            s-&gt;read((uint8_t *)&amp;_video_bih,sizeof(BITMAPINFOHEADER));
+            printf(&quot; BMP size  %04d (%04d)\n&quot;,x,sizeof(ADM_BITMAPINFOHEADER));
+            s-&gt;read((uint8_t *)&amp;_video_bih,sizeof(ADM_BITMAPINFOHEADER));
 
-		#ifdef ADM_BIG_ENDIAN
-			Endian_BitMapInfo(&amp;_video_bih);
+		#ifdef ADM_BIG_ENDIAN
+			Endian_BitMapInfo(&amp;_video_bih);
 		#endif
 
             _videostream.dwScale=1000;
@@ -581,9 +581,9 @@
               return 0; 
             }
             printBih(&amp;_video_bih);
-            if(x&gt;sizeof(BITMAPINFOHEADER))
+            if(x&gt;sizeof(ADM_BITMAPINFOHEADER))
             {
-              _extraDataLen=x-sizeof(BITMAPINFOHEADER);
+              _extraDataLen=x-sizeof(ADM_BITMAPINFOHEADER);
               _extraData=new uint8_t[_extraDataLen];
               s-&gt;read(_extraData,_extraDataLen);
             }

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -35,7 +35,7 @@
 
 #include &quot;fourcc.h&quot;
 #include &quot;ADM_inpics/ADM_pics.h&quot;
-#include &quot;ADM_inpics/bitmap.h&quot;
+#include &quot;ADM_toolkit/bitmap.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &lt;ADM_assert.h&gt;
 #include &quot;ADM_toolkit/filesel.h&quot;
@@ -232,7 +232,7 @@
     switch (_type) {
     case PIC_BMP:
 	{
-	    BITMAPHEADER bmph;
+	    ADM_BITMAPINFOHEADER bmph;
 
 	    fread(&amp;s16, 2, 1, _fd[0]);
 	    if (s16 != 0x4D42) {
@@ -243,14 +243,14 @@
 	    fread(&amp;s32, 4, 1, _fd[0]);
 	    fread(&amp;s32, 4, 1, _fd[0]);
 	    fread(&amp;bmph, sizeof(bmph), 1, _fd[0]);
-	    if (bmph.compressionScheme != 0) {
+	    if (bmph.biCompression != 0) {
 		printf(&quot;\ncannot handle compressed bmp\n&quot;);
 		return 0;
 	    }
-	    _offset = bmph.size + 14;
-	    w = bmph.width;
-	    h = bmph.height;
-		bpp = bmph.numBitsPerPlane;
+	    _offset = bmph.biSize + 14;
+	    w = bmph.biWidth;
+	    h = bmph.biHeight;
+		bpp = bmph.biBitCount;
 	}
 	break;
 
@@ -300,7 +300,7 @@
 
     case PIC_BMP2:
 	{
-	    BITMAPINFOHEADER bmph;
+	    ADM_BITMAPINFOHEADER bmph;
 
 	    fseek(_fd[0], 10, SEEK_SET);
 

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -130,9 +130,9 @@
         _videostream.fccHandler=_video_bih.biCompression=entry.fcc;
         
         // if it is vfw...
-        if(fourCC::check(entry.fcc,(uint8_t *)&quot;VFWX&quot;) &amp;&amp; entry.extraData &amp;&amp; entry.extraDataLen&gt;=sizeof(BITMAPINFOHEADER))
+        if(fourCC::check(entry.fcc,(uint8_t *)&quot;VFWX&quot;) &amp;&amp; entry.extraData &amp;&amp; entry.extraDataLen&gt;=sizeof(ADM_BITMAPINFOHEADER))
         {
-          memcpy(&amp; _video_bih,entry.extraData,sizeof(BITMAPINFOHEADER));
+          memcpy(&amp; _video_bih,entry.extraData,sizeof(ADM_BITMAPINFOHEADER));
           delete [] _tracks[0].extraData;
           entry.extraData=NULL;
           entry.extraDataLen=0;

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -218,7 +218,7 @@
 
 		//Retrieve width &amp; height
 		//_______________________
-		   		BITMAPHEADER bmph;
+		   		ADM_BITMAPINFOHEADER bmph;
 
 			    fread(&amp;s16, 2, 1, fd);
 			    if (s16 != 0x4D42) 
@@ -231,15 +231,15 @@
 			    fread(&amp;s32, 4, 1, fd);
 			    fread(&amp;s32, 4, 1, fd);
 			    fread(&amp;bmph, sizeof(bmph), 1, fd);
-			    if (bmph.compressionScheme != 0) 
+			    if (bmph.biCompression != 0) 
 			    {
 			    	printf(&quot;[imageLoader]cannot handle compressed bmp\n&quot;);
 			    	fclose(fd);
 			    	return NULL;
 			    }
 			    
-			    w = bmph.width;
-			    h = bmph.height;
+			    w = bmph.biWidth;
+			    h = bmph.biHeight;
 			    
 			    
 			    printf(&quot;[ImageLoader] BMP %u * %u\n&quot;,w,h);
@@ -264,7 +264,7 @@
 ADMImage *createImageFromFile_Bmp2(const char *filename)
 {
     
-	BITMAPINFOHEADER bmph;
+	ADM_BITMAPINFOHEADER bmph;
     uint8_t fcc_tab[4];
     uint32_t offset;
     FILE *fd=NULL;
@@ -313,7 +313,7 @@
 ADMImage *createImageFromFile_png(const char *filename)
 {
     
-	BITMAPHEADER bmph;
+	ADM_BITMAPINFOHEADER bmph;
     uint8_t fcc_tab[4];
     uint32_t offset,size;
     FILE *fd=NULL;
@@ -430,7 +430,7 @@
 		    // BMP2?
 		    if (fcc_tab[0] == 'B' &amp;&amp; fcc_tab[1] == 'M') 
 		    {
-		    	    BITMAPINFOHEADER bmph;
+		    	    ADM_BITMAPINFOHEADER bmph;
 
 		     	    fseek(fd, 10, SEEK_SET);
 		     	    fread(fcc_tab, 4, 1, fd);

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -347,8 +347,8 @@
 #endif
         return tinySubstract(YPLANE(this),YPLANE(src1),YPLANE(src2),src1-&gt;_width*src1-&gt;_height);
 }
- BITMAPFILEHEADER bmfh;
-  BITMAPINFOHEADER bmph;
+ ADM_BITMAPFILEHEADER bmfh;
+ ADM_BITMAPINFOHEADER bmph;
   FILE *fd;
   uint32_t sz;
   uint16_t s16;
@@ -361,8 +361,8 @@
 */
 uint8_t  ADMImage::saveAsBmp(const char *filename)
 {
-  BITMAPFILEHEADER bmfh;
-  BITMAPINFOHEADER bmph;
+  ADM_BITMAPFILEHEADER bmfh;
+  ADM_BITMAPINFOHEADER bmph;
   FILE *fd;
   uint32_t sz;
   uint16_t s16;

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -141,7 +141,7 @@
 
 }
 
-void Endian_BitMapInfo( BITMAPINFOHEADER *b)
+void Endian_BitMapInfo( ADM_BITMAPINFOHEADER *b)
 {
 #ifdef ADM_BIG_ENDIAN
 	#define SWAP32(x) b-&gt;x=R32(b-&gt;x)
@@ -286,7 +286,7 @@
       return (uint32_t) floor(f);
 
 }
-void printBih(BITMAPINFOHEADER *bi)
+void printBih(ADM_BITMAPINFOHEADER *bi)
 {
 #undef X_DUMP
 #define X_DUMP(x) printf(#x&quot;:\t\t:%ld\n&quot;,(long int)bi-&gt;x);

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avifmt2.h
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avifmt2.h	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_libraries/ADM_utilities/avifmt2.h	2008-02-22 19:10:04 UTC (rev 3797)
@@ -21,62 +21,36 @@
 #ifndef __AVIFMT2__
 #define __AVIFMT2__
 
-#if !defined( WIN32_CLASH) || !defined(ADM_WIN32)
-typedef struct
-{
-    uint32_t 		biSize;
-    uint32_t  	biWidth;
-    uint32_t  	biHeight;
-    uint16_t 		biPlanes;
-    uint16_t 		biBitCount;
-    uint32_t 		biCompression;
-    uint32_t 		biSizeImage;
-    uint32_t  	biXPelsPerMeter;
-    uint32_t  	biYPelsPerMeter;
-    uint32_t 		biClrUsed;
-    uint32_t 		biClrImportant;
-} BITMAPINFOHEADER, *PBITMAPINFOHEADER, *LPBITMAPINFOHEADER;
-typedef struct {
-	BITMAPINFOHEADER bmiHeader;
-	int	bmiColors[1];
-} BITMAPINFO, *LPBITMAPINFO;
-#endif //win32clash
+#include &quot;ADM_toolkit/bitmap.h&quot;
 
-void printBih(BITMAPINFOHEADER *bi);
-/* Borrowed from vdub
-	Thanks to avery lee */
-#define AVI_INDEX_OF_CHUNKS 0X01
+void printBih(ADM_BITMAPINFOHEADER *bi);
 
 
 
-typedef struct _avistdindex_chunk {
-/*	uint32_t 		fcc;					// &#65533;ix##&#65533;
-	DWORD 			cb;
-*/
-	uint16_t 	wLongsPerEntry;		// must be sizeof(aIndex[0])/sizeof(DWORD)
-	uint8_t 	bIndexSubType;			// must be 0
-	uint8_t 	bIndexType;			// must be AVI_INDEX_OF_CHUNKS
-	uint32_t 	nEntriesInUse;		//
-	uint32_t 	dwChunkId;			// &#65533;##dc&#65533; or &#65533;##db&#65533; or &#65533;##wb&#65533; etc..
-/*	QUADWORD 	qwBaseOffset;		// all dwOffsets in aIndex array are
-														// relative to this
-*/
-	uint32_t  qw1,qw2;			// MN.
-	uint32_t 	dwReserved3;				// must be 0
+typedef struct _avistdindex_chunk 
+{
+        uint16_t 	wLongsPerEntry;		// must be sizeof(aIndex[0])/sizeof(DWORD)
+        uint8_t 	bIndexSubType;			// must be 0
+        uint8_t 	bIndexType;			// must be AVI_INDEX_OF_CHUNKS
+        uint32_t 	nEntriesInUse;		//
+        uint32_t 	dwChunkId;			// &#65533;##dc&#65533; or &#65533;##db&#65533; or &#65533;##wb&#65533; etc..
+        uint32_t        qw1,qw2;			// MN.
+        uint32_t 	dwReserved3;				// must be 0
 	
 } AVISTDINDEX, * PAVISTDINDEX;
 
 
 
-#define AVI_KEY_FRAME 0x10
- #define AVI_B_FRAME		 0x4000	 // hopefully it is not used..
-#endif
+#define AVI_KEY_FRAME   0x10
+#define AVI_B_FRAME	0x4000	 // hopefully it is not used..
 
 #include &quot;../ADM_audio/ADM_audiodef.h&quot;
 
 void Endian_AviMainHeader(MainAVIHeader *m);
-void Endian_BitMapInfo( BITMAPINFOHEADER *b);
+void Endian_BitMapInfo( ADM_BITMAPINFOHEADER *b);
 void Endian_AviStreamHeader(AVIStreamHeader *s);
 void Endian_WavHeader(WAVHeader *w);
-//void Endian_BitMapHeader( BITMAPHEADER *b);
 
+#endif
+//EOF
+

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_avisave.h
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_avisave.h	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_avisave.h	2008-02-22 19:10:04 UTC (rev 3797)
@@ -72,7 +72,7 @@
 
 						//
 						AVIStreamHeader 	_videostreamheader;
-						BITMAPINFOHEADER  _bih;
+						ADM_BITMAPINFOHEADER  _bih;
 						MainAVIHeader			_mainaviheader;
      public:
      						GenericAviSave( void );

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2008-02-22 19:10:04 UTC (rev 3797)
@@ -219,7 +219,7 @@
 		 0x1000);
 #else
   	setStreamInfo (_file, (uint8_t *) &amp;_videostream,
-		  (uint8_t *)&amp;_bih,sizeof(BITMAPINFOHEADER),
+		  (uint8_t *)&amp;_bih,sizeof(ADM_BITMAPINFOHEADER),
 		// MOD Feb 2005 by GMV: ODML support
 		odml_video_super_idx_size,0,
 		// END MOD Feb 2005 by GMV
@@ -467,7 +467,7 @@
 		     MainAVIHeader 	*inmainheader, 
 		     uint32_t 		nb_frame,
 		     AVIStreamHeader * invideostream,
-		     BITMAPINFOHEADER	*bih,
+		     ADM_BITMAPINFOHEADER	*bih,
 		     uint8_t 		*videoextra,
 		     uint32_t  		videoextraLen,
 		     AVDMGenericAudioStream * inaudiostream,

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_outputs/oplug_avi/op_aviwrite.hxx	2008-02-22 19:10:04 UTC (rev 3797)
@@ -29,7 +29,7 @@
                 
 		MainAVIHeader	_mainheader;
 		AVIStreamHeader _videostream;
-		BITMAPINFOHEADER _bih;
+		ADM_BITMAPINFOHEADER _bih;
 		AVIStreamHeader _audio1,_audio2;
 		uint32_t nb_audio;
 		uint32_t asize;
@@ -113,7 +113,7 @@
 							MainAVIHeader *mainheader,
 							uint32_t nb_frame,
 			AVIStreamHeader 	*invideostream,
-			BITMAPINFOHEADER	*bitmap,	
+			ADM_BITMAPINFOHEADER	*bitmap,	
 			uint8_t 		*videoextra,
 			uint32_t		videoextraLen,
 			AVDMGenericAudioStream 	*audiostream,

Modified: branches/avidemux_2.5_branch_mean/avidemux/ADM_toolkit/bitmap.h
===================================================================
--- branches/avidemux_2.5_branch_mean/avidemux/ADM_toolkit/bitmap.h	2008-02-22 19:10:01 UTC (rev 3796)
+++ branches/avidemux_2.5_branch_mean/avidemux/ADM_toolkit/bitmap.h	2008-02-22 19:10:04 UTC (rev 3797)
@@ -15,38 +15,38 @@
  *                                                                         *
  ***************************************************************************/
 
+#ifndef ADM_BITMAP_H
+#define ADM_BITMAP_H
 
+typedef struct
+{
+    uint32_t 	biSize;
+    uint32_t  	biWidth;
+    uint32_t  	biHeight;
+    uint16_t 	biPlanes;
+    uint16_t 	biBitCount;
+    uint32_t 	biCompression;
+    uint32_t 	biSizeImage;
+    uint32_t  	biXPelsPerMeter;
+    uint32_t  	biYPelsPerMeter;
+    uint32_t 	biClrUsed;
+    uint32_t 	biClrImportant;
+} ADM_BITMAPINFOHEADER;
 
-typedef struct BITMAPHEADER
+typedef struct 
 {
-    uint32_t size;
-    int32_t  width;
-    int32_t  height;
-    uint16_t numBitPlanes;
-    uint16_t numBitsPerPlane;
-    uint32_t compressionScheme;
-    uint32_t sizeOfImageData;
-    uint32_t xResolution;
-    uint32_t yResolution;
-    uint32_t numColorsUsed;
-    uint32_t numImportantColors;
-/*
-    uint16_t resolutionUnits;
-    uint16_t padding;
-    uint16_t origin;
-    uint16_t halftoning;
-    uint32_t halftoningParam1;
-    uint32_t halftoningParam2;
-    uint32_t colorEncoding;
-    uint32_t identifier;
-*/
-} BITMAPHEADER;
+        ADM_BITMAPINFOHEADER bmiHeader;
+        int	bmiColors[1];
+} ADM_BITMAPINFO;
 
-typedef struct BITMAPFILEHEADER
+
+typedef struct 
 {
    uint16_t    type;
-	 uint32_t    size;
+   uint32_t    size;
    int16_t     xHotspot;
    int16_t     yHotspot;
    uint32_t    offsetToBits;
-}  BITMAPFILEHEADER;
+}  ADM_BITMAPFILEHEADER;
+
+#endif
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001063.html">[Avidemux-svn-commit] r3796 -	branches/avidemux_2.5_branch_mean/avidemux/ADM_inputs/ADM_inpics
</A></li>
	<LI>Next message: <A HREF="001065.html">[Avidemux-svn-commit] r3798 - in	branches/avidemux_2.5_branch_mean/avidemux: ADM_audio	ADM_audiocodec ADM_editor ADM_encoder ADM_filter	ADM_libraries/ADM_libswscale ADM_libraries/ADM_utilities	ADM_ocr ADM_outputs/oplug_avi ADM_outputs/oplug_ogm	ADM_toolkit ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_ocr	ADM_userInterfaces/ADM_NONE/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_gui	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1064">[ date ]</a>
              <a href="thread.html#1064">[ thread ]</a>
              <a href="subject.html#1064">[ subject ]</a>
              <a href="author.html#1064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
