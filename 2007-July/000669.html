<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3393 - in	branches/avidemux_2.4_branch/avidemux/ADM_libraries:	ADM_lavcodec ADM_lavcodec/i386 ADM_lavformat
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3393%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_libraries%3A%0A%09ADM_lavcodec%20ADM_lavcodec/i386%20ADM_lavformat&In-Reply-To=%3C200707161817.l6GIHD0I010838%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000668.html">
   <LINK REL="Next"  HREF="000670.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3393 - in	branches/avidemux_2.4_branch/avidemux/ADM_libraries:	ADM_lavcodec ADM_lavcodec/i386 ADM_lavformat</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3393%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_libraries%3A%0A%09ADM_lavcodec%20ADM_lavcodec/i386%20ADM_lavformat&In-Reply-To=%3C200707161817.l6GIHD0I010838%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3393 - in	branches/avidemux_2.4_branch/avidemux/ADM_libraries:	ADM_lavcodec ADM_lavcodec/i386 ADM_lavformat">mean at mail.berlios.de
       </A><BR>
    <I>Mon Jul 16 20:17:13 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000668.html">[Avidemux-svn-commit] r3392 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
</A></li>
        <LI>Next message: <A HREF="000670.html">[Avidemux-svn-commit] r3394 - in	branches/avidemux_2.4_branch/avidemux/ADM_libraries:	ADM_lavcodec ADM_lavutil
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#669">[ date ]</a>
              <a href="thread.html#669">[ thread ]</a>
              <a href="subject.html#669">[ subject ]</a>
              <a href="author.html#669">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-07-16 20:17:13 +0200 (Mon, 16 Jul 2007)
New Revision: 3393

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h
Log:
lost files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,518 @@
+/*
+ * Chinese AVS video (AVS1-P2, JiZhun profile) decoder.
+ * Copyright (c) 2006  Stefan Gehrer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">stefan.gehrer at gmx.de</A>&gt;
+ *
+ * MMX optimised DSP functions, based on H.264 optimisations by
+ * Michael Niedermayer and Loren Merritt
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include &quot;dsputil.h&quot;
+#include &quot;common.h&quot;
+
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_4 ) = 0x0004000400040004ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_5 ) = 0x0005000500050005ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_7 ) = 0x0007000700070007ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_42) = 0x002A002A002A002AULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_64) = 0x0040004000400040ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_96) = 0x0060006000600060ULL;
+
+/*****************************************************************************
+ *
+ * inverse transform
+ *
+ ****************************************************************************/
+
+#define SUMSUB_BA( a, b ) \
+    &quot;paddw &quot;#b&quot;, &quot;#a&quot; \n\t&quot;\
+    &quot;paddw &quot;#b&quot;, &quot;#b&quot; \n\t&quot;\
+    &quot;psubw &quot;#a&quot;, &quot;#b&quot; \n\t&quot;
+
+#define SBUTTERFLY(a,b,t,n)\
+    &quot;movq &quot; #a &quot;, &quot; #t &quot;              \n\t&quot; /* abcd */\
+    &quot;punpckl&quot; #n &quot; &quot; #b &quot;, &quot; #a &quot;     \n\t&quot; /* aebf */\
+    &quot;punpckh&quot; #n &quot; &quot; #b &quot;, &quot; #t &quot;     \n\t&quot; /* cgdh */
+
+#define TRANSPOSE4(a,b,c,d,t)\
+    SBUTTERFLY(a,b,t,wd) /* a=aebf t=cgdh */\
+    SBUTTERFLY(c,d,b,wd) /* c=imjn b=kolp */\
+    SBUTTERFLY(a,c,d,dq) /* a=aeim d=bfjn */\
+    SBUTTERFLY(t,b,c,dq) /* t=cgko c=dhlp */
+
+static inline void cavs_idct8_1d(int16_t *block, uint64_t bias)
+{
+    asm volatile(
+        &quot;movq 112(%0), %%mm4  \n\t&quot; /* mm4 = src7 */
+        &quot;movq  16(%0), %%mm5  \n\t&quot; /* mm5 = src1 */
+        &quot;movq  80(%0), %%mm2  \n\t&quot; /* mm2 = src5 */
+        &quot;movq  48(%0), %%mm7  \n\t&quot; /* mm7 = src3 */
+        &quot;movq   %%mm4, %%mm0  \n\t&quot;
+        &quot;movq   %%mm5, %%mm3  \n\t&quot;
+        &quot;movq   %%mm2, %%mm6  \n\t&quot;
+        &quot;movq   %%mm7, %%mm1  \n\t&quot;
+
+        &quot;paddw  %%mm4, %%mm4  \n\t&quot; /* mm4 = 2*src7 */
+        &quot;paddw  %%mm3, %%mm3  \n\t&quot; /* mm3 = 2*src1 */
+        &quot;paddw  %%mm6, %%mm6  \n\t&quot; /* mm6 = 2*src5 */
+        &quot;paddw  %%mm1, %%mm1  \n\t&quot; /* mm1 = 2*src3 */
+        &quot;paddw  %%mm4, %%mm0  \n\t&quot; /* mm0 = 3*src7 */
+        &quot;paddw  %%mm3, %%mm5  \n\t&quot; /* mm5 = 3*src1 */
+        &quot;paddw  %%mm6, %%mm2  \n\t&quot; /* mm2 = 3*src5 */
+        &quot;paddw  %%mm1, %%mm7  \n\t&quot; /* mm7 = 3*src3 */
+        &quot;psubw  %%mm4, %%mm5  \n\t&quot; /* mm5 = 3*src1 - 2*src7 = a0 */
+        &quot;paddw  %%mm6, %%mm7  \n\t&quot; /* mm7 = 3*src3 + 2*src5 = a1 */
+        &quot;psubw  %%mm2, %%mm1  \n\t&quot; /* mm1 = 2*src3 - 3*src5 = a2 */
+        &quot;paddw  %%mm0, %%mm3  \n\t&quot; /* mm3 = 2*src1 + 3*src7 = a3 */
+
+        &quot;movq   %%mm5, %%mm4  \n\t&quot;
+        &quot;movq   %%mm7, %%mm6  \n\t&quot;
+        &quot;movq   %%mm3, %%mm0  \n\t&quot;
+        &quot;movq   %%mm1, %%mm2  \n\t&quot;
+        SUMSUB_BA( %%mm7, %%mm5 )   /* mm7 = a0 + a1  mm5 = a0 - a1 */
+        &quot;paddw  %%mm3, %%mm7  \n\t&quot; /* mm7 = a0 + a1 + a3 */
+        &quot;paddw  %%mm1, %%mm5  \n\t&quot; /* mm5 = a0 - a1 + a2 */
+        &quot;paddw  %%mm7, %%mm7  \n\t&quot;
+        &quot;paddw  %%mm5, %%mm5  \n\t&quot;
+        &quot;paddw  %%mm6, %%mm7  \n\t&quot; /* mm7 = b4 */
+        &quot;paddw  %%mm4, %%mm5  \n\t&quot; /* mm5 = b5 */
+
+        SUMSUB_BA( %%mm1, %%mm3 )   /* mm1 = a3 + a2  mm3 = a3 - a2 */
+        &quot;psubw  %%mm1, %%mm4  \n\t&quot; /* mm4 = a0 - a2 - a3 */
+        &quot;movq   %%mm4, %%mm1  \n\t&quot; /* mm1 = a0 - a2 - a3 */
+        &quot;psubw  %%mm6, %%mm3  \n\t&quot; /* mm3 = a3 - a2 - a1 */
+        &quot;paddw  %%mm1, %%mm1  \n\t&quot;
+        &quot;paddw  %%mm3, %%mm3  \n\t&quot;
+        &quot;psubw  %%mm2, %%mm1  \n\t&quot; /* mm1 = b7 */
+        &quot;paddw  %%mm0, %%mm3  \n\t&quot; /* mm3 = b6 */
+
+        &quot;movq  32(%0), %%mm2  \n\t&quot; /* mm2 = src2 */
+        &quot;movq  96(%0), %%mm6  \n\t&quot; /* mm6 = src6 */
+        &quot;movq   %%mm2, %%mm4  \n\t&quot;
+        &quot;movq   %%mm6, %%mm0  \n\t&quot;
+        &quot;psllw  $2,    %%mm4  \n\t&quot; /* mm4 = 4*src2 */
+        &quot;psllw  $2,    %%mm6  \n\t&quot; /* mm6 = 4*src6 */
+        &quot;paddw  %%mm4, %%mm2  \n\t&quot; /* mm2 = 5*src2 */
+        &quot;paddw  %%mm6, %%mm0  \n\t&quot; /* mm0 = 5*src6 */
+        &quot;paddw  %%mm2, %%mm2  \n\t&quot;
+        &quot;paddw  %%mm0, %%mm0  \n\t&quot;
+        &quot;psubw  %%mm0, %%mm4  \n\t&quot; /* mm4 = 4*src2 - 10*src6 = a7 */
+        &quot;paddw  %%mm2, %%mm6  \n\t&quot; /* mm6 = 4*src6 + 10*src2 = a6 */
+
+        &quot;movq    (%0), %%mm2  \n\t&quot; /* mm2 = src0 */
+        &quot;movq  64(%0), %%mm0  \n\t&quot; /* mm0 = src4 */
+        SUMSUB_BA( %%mm0, %%mm2 )   /* mm0 = src0+src4  mm2 = src0-src4 */
+        &quot;psllw  $3,    %%mm0  \n\t&quot;
+        &quot;psllw  $3,    %%mm2  \n\t&quot;
+        &quot;paddw  %1,    %%mm0  \n\t&quot; /* add rounding bias */
+        &quot;paddw  %1,    %%mm2  \n\t&quot; /* add rounding bias */
+
+        SUMSUB_BA( %%mm6, %%mm0 )   /* mm6 = a4 + a6  mm0 = a4 - a6 */
+        SUMSUB_BA( %%mm4, %%mm2 )   /* mm4 = a5 + a7  mm2 = a5 - a7 */
+        SUMSUB_BA( %%mm7, %%mm6 )   /* mm7 = dst0  mm6 = dst7 */
+        SUMSUB_BA( %%mm5, %%mm4 )   /* mm5 = dst1  mm4 = dst6 */
+        SUMSUB_BA( %%mm3, %%mm2 )   /* mm3 = dst2  mm2 = dst5 */
+        SUMSUB_BA( %%mm1, %%mm0 )   /* mm1 = dst3  mm0 = dst4 */
+        :: &quot;r&quot;(block), &quot;m&quot;(bias)
+    );
+}
+
+static void cavs_idct8_add_mmx(uint8_t *dst, int16_t *block, int stride)
+{
+    int i;
+    DECLARE_ALIGNED_8(int16_t, b2[64]);
+
+    for(i=0; i&lt;2; i++){
+        DECLARE_ALIGNED_8(uint64_t, tmp);
+
+        cavs_idct8_1d(block+4*i, ff_pw_4);
+
+        asm volatile(
+            &quot;psraw     $3, %%mm7  \n\t&quot;
+            &quot;psraw     $3, %%mm6  \n\t&quot;
+            &quot;psraw     $3, %%mm5  \n\t&quot;
+            &quot;psraw     $3, %%mm4  \n\t&quot;
+            &quot;psraw     $3, %%mm3  \n\t&quot;
+            &quot;psraw     $3, %%mm2  \n\t&quot;
+            &quot;psraw     $3, %%mm1  \n\t&quot;
+            &quot;psraw     $3, %%mm0  \n\t&quot;
+            &quot;movq   %%mm7,    %0   \n\t&quot;
+            TRANSPOSE4( %%mm0, %%mm2, %%mm4, %%mm6, %%mm7 )
+            &quot;movq   %%mm0,  8(%1)  \n\t&quot;
+            &quot;movq   %%mm6, 24(%1)  \n\t&quot;
+            &quot;movq   %%mm7, 40(%1)  \n\t&quot;
+            &quot;movq   %%mm4, 56(%1)  \n\t&quot;
+            &quot;movq    %0,    %%mm7  \n\t&quot;
+            TRANSPOSE4( %%mm7, %%mm5, %%mm3, %%mm1, %%mm0 )
+            &quot;movq   %%mm7,   (%1)  \n\t&quot;
+            &quot;movq   %%mm1, 16(%1)  \n\t&quot;
+            &quot;movq   %%mm0, 32(%1)  \n\t&quot;
+            &quot;movq   %%mm3, 48(%1)  \n\t&quot;
+            : &quot;=m&quot;(tmp)
+            : &quot;r&quot;(b2+32*i)
+            : &quot;memory&quot;
+        );
+    }
+
+    for(i=0; i&lt;2; i++){
+        cavs_idct8_1d(b2+4*i, ff_pw_64);
+
+        asm volatile(
+            &quot;psraw     $7, %%mm7  \n\t&quot;
+            &quot;psraw     $7, %%mm6  \n\t&quot;
+            &quot;psraw     $7, %%mm5  \n\t&quot;
+            &quot;psraw     $7, %%mm4  \n\t&quot;
+            &quot;psraw     $7, %%mm3  \n\t&quot;
+            &quot;psraw     $7, %%mm2  \n\t&quot;
+            &quot;psraw     $7, %%mm1  \n\t&quot;
+            &quot;psraw     $7, %%mm0  \n\t&quot;
+            &quot;movq   %%mm7,    (%0)  \n\t&quot;
+            &quot;movq   %%mm5,  16(%0)  \n\t&quot;
+            &quot;movq   %%mm3,  32(%0)  \n\t&quot;
+            &quot;movq   %%mm1,  48(%0)  \n\t&quot;
+            &quot;movq   %%mm0,  64(%0)  \n\t&quot;
+            &quot;movq   %%mm2,  80(%0)  \n\t&quot;
+            &quot;movq   %%mm4,  96(%0)  \n\t&quot;
+            &quot;movq   %%mm6, 112(%0)  \n\t&quot;
+            :: &quot;r&quot;(b2+4*i)
+            : &quot;memory&quot;
+        );
+    }
+
+    add_pixels_clamped_mmx(b2, dst, stride);
+
+    /* clear block */
+    asm volatile(
+            &quot;pxor %%mm7, %%mm7   \n\t&quot;
+            &quot;movq %%mm7, (%0)    \n\t&quot;
+            &quot;movq %%mm7, 8(%0)   \n\t&quot;
+            &quot;movq %%mm7, 16(%0)  \n\t&quot;
+            &quot;movq %%mm7, 24(%0)  \n\t&quot;
+            &quot;movq %%mm7, 32(%0)  \n\t&quot;
+            &quot;movq %%mm7, 40(%0)  \n\t&quot;
+            &quot;movq %%mm7, 48(%0)  \n\t&quot;
+            &quot;movq %%mm7, 56(%0)  \n\t&quot;
+            &quot;movq %%mm7, 64(%0)  \n\t&quot;
+            &quot;movq %%mm7, 72(%0)  \n\t&quot;
+            &quot;movq %%mm7, 80(%0)  \n\t&quot;
+            &quot;movq %%mm7, 88(%0)  \n\t&quot;
+            &quot;movq %%mm7, 96(%0)  \n\t&quot;
+            &quot;movq %%mm7, 104(%0) \n\t&quot;
+            &quot;movq %%mm7, 112(%0) \n\t&quot;
+            &quot;movq %%mm7, 120(%0) \n\t&quot;
+            :: &quot;r&quot; (block)
+    );
+}
+
+/*****************************************************************************
+ *
+ * motion compensation
+ *
+ ****************************************************************************/
+
+/* vertical filter [-1 -2 96 42 -7  0]  */
+#define QPEL_CAVSV1(A,B,C,D,E,F,OP)      \
+        &quot;movd (%0), &quot;#F&quot;            \n\t&quot;\
+        &quot;movq &quot;#C&quot;, %%mm6           \n\t&quot;\
+        &quot;pmullw %5, %%mm6           \n\t&quot;\
+        &quot;movq &quot;#D&quot;, %%mm7           \n\t&quot;\
+        &quot;pmullw %6, %%mm7           \n\t&quot;\
+        &quot;psllw $3, &quot;#E&quot;             \n\t&quot;\
+        &quot;psubw &quot;#E&quot;, %%mm6          \n\t&quot;\
+        &quot;psraw $3, &quot;#E&quot;             \n\t&quot;\
+        &quot;paddw %%mm7, %%mm6         \n\t&quot;\
+        &quot;paddw &quot;#E&quot;, %%mm6          \n\t&quot;\
+        &quot;paddw &quot;#B&quot;, &quot;#B&quot;           \n\t&quot;\
+        &quot;pxor %%mm7, %%mm7          \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;punpcklbw %%mm7, &quot;#F&quot;      \n\t&quot;\
+        &quot;psubw &quot;#B&quot;, %%mm6          \n\t&quot;\
+        &quot;psraw $1, &quot;#B&quot;             \n\t&quot;\
+        &quot;psubw &quot;#A&quot;, %%mm6          \n\t&quot;\
+        &quot;paddw %4, %%mm6            \n\t&quot;\
+        &quot;psraw $7, %%mm6            \n\t&quot;\
+        &quot;packuswb %%mm6, %%mm6      \n\t&quot;\
+        OP(%%mm6, (%1), A, d)            \
+        &quot;add %3, %1                 \n\t&quot;
+
+/* vertical filter [ 0 -1  5  5 -1  0]  */
+#define QPEL_CAVSV2(A,B,C,D,E,F,OP)      \
+        &quot;movd (%0), &quot;#F&quot;            \n\t&quot;\
+        &quot;movq &quot;#C&quot;, %%mm6           \n\t&quot;\
+        &quot;paddw &quot;#D&quot;, %%mm6          \n\t&quot;\
+        &quot;pmullw %5, %%mm6           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;punpcklbw %%mm7, &quot;#F&quot;      \n\t&quot;\
+        &quot;psubw &quot;#B&quot;, %%mm6          \n\t&quot;\
+        &quot;psubw &quot;#E&quot;, %%mm6          \n\t&quot;\
+        &quot;paddw %4, %%mm6            \n\t&quot;\
+        &quot;psraw $3, %%mm6            \n\t&quot;\
+        &quot;packuswb %%mm6, %%mm6      \n\t&quot;\
+        OP(%%mm6, (%1), A, d)            \
+        &quot;add %3, %1                 \n\t&quot;
+
+/* vertical filter [ 0 -7 42 96 -2 -1]  */
+#define QPEL_CAVSV3(A,B,C,D,E,F,OP)      \
+        &quot;movd (%0), &quot;#F&quot;            \n\t&quot;\
+        &quot;movq &quot;#C&quot;, %%mm6           \n\t&quot;\
+        &quot;pmullw %6, %%mm6           \n\t&quot;\
+        &quot;movq &quot;#D&quot;, %%mm7           \n\t&quot;\
+        &quot;pmullw %5, %%mm7           \n\t&quot;\
+        &quot;psllw $3, &quot;#B&quot;             \n\t&quot;\
+        &quot;psubw &quot;#B&quot;, %%mm6          \n\t&quot;\
+        &quot;psraw $3, &quot;#B&quot;             \n\t&quot;\
+        &quot;paddw %%mm7, %%mm6         \n\t&quot;\
+        &quot;paddw &quot;#B&quot;, %%mm6          \n\t&quot;\
+        &quot;paddw &quot;#E&quot;, &quot;#E&quot;           \n\t&quot;\
+        &quot;pxor %%mm7, %%mm7          \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;punpcklbw %%mm7, &quot;#F&quot;      \n\t&quot;\
+        &quot;psubw &quot;#E&quot;, %%mm6          \n\t&quot;\
+        &quot;psraw $1, &quot;#E&quot;             \n\t&quot;\
+        &quot;psubw &quot;#F&quot;, %%mm6          \n\t&quot;\
+        &quot;paddw %4, %%mm6            \n\t&quot;\
+        &quot;psraw $7, %%mm6            \n\t&quot;\
+        &quot;packuswb %%mm6, %%mm6      \n\t&quot;\
+        OP(%%mm6, (%1), A, d)            \
+        &quot;add %3, %1                 \n\t&quot;
+
+
+#define QPEL_CAVSVNUM(VOP,OP,ADD,MUL1,MUL2)\
+    int w= 2;\
+    src -= 2*srcStride;\
+    \
+    while(w--){\
+      asm volatile(\
+        &quot;pxor %%mm7, %%mm7          \n\t&quot;\
+        &quot;movd (%0), %%mm0           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;movd (%0), %%mm1           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;movd (%0), %%mm2           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;movd (%0), %%mm3           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;movd (%0), %%mm4           \n\t&quot;\
+        &quot;add %2, %0                 \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm0     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm1     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm2     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm3     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm4     \n\t&quot;\
+        VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+        VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+        VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+        VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+        VOP(%%mm4, %%mm5, %%mm0, %%mm1, %%mm2, %%mm3, OP)\
+        VOP(%%mm5, %%mm0, %%mm1, %%mm2, %%mm3, %%mm4, OP)\
+        VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+        VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+        \
+        : &quot;+a&quot;(src), &quot;+c&quot;(dst)\
+        : &quot;S&quot;((long)srcStride), &quot;D&quot;((long)dstStride), &quot;m&quot;(ADD), &quot;m&quot;(MUL1), &quot;m&quot;(MUL2)\
+        : &quot;memory&quot;\
+     );\
+     if(h==16){\
+        asm volatile(\
+            VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+            VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+            VOP(%%mm4, %%mm5, %%mm0, %%mm1, %%mm2, %%mm3, OP)\
+            VOP(%%mm5, %%mm0, %%mm1, %%mm2, %%mm3, %%mm4, OP)\
+            VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+            VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+            VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+            VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+            \
+           : &quot;+a&quot;(src), &quot;+c&quot;(dst)\
+           : &quot;S&quot;((long)srcStride), &quot;D&quot;((long)dstStride), &quot;m&quot;(ADD),  &quot;m&quot;(MUL1), &quot;m&quot;(MUL2)\
+           : &quot;memory&quot;\
+        );\
+     }\
+     src += 4-(h+5)*srcStride;\
+     dst += 4-h*dstStride;\
+   }
+
+#define QPEL_CAVS(OPNAME, OP, MMX)\
+static void OPNAME ## cavs_qpel8_h_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    int h=8;\
+    asm volatile(\
+        &quot;pxor %%mm7, %%mm7          \n\t&quot;\
+        &quot;movq %5, %%mm6             \n\t&quot;\
+        &quot;1:                         \n\t&quot;\
+        &quot;movq    (%0), %%mm0        \n\t&quot;\
+        &quot;movq   1(%0), %%mm2        \n\t&quot;\
+        &quot;movq %%mm0, %%mm1          \n\t&quot;\
+        &quot;movq %%mm2, %%mm3          \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm0     \n\t&quot;\
+        &quot;punpckhbw %%mm7, %%mm1     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm2     \n\t&quot;\
+        &quot;punpckhbw %%mm7, %%mm3     \n\t&quot;\
+        &quot;paddw %%mm2, %%mm0         \n\t&quot;\
+        &quot;paddw %%mm3, %%mm1         \n\t&quot;\
+        &quot;pmullw %%mm6, %%mm0        \n\t&quot;\
+        &quot;pmullw %%mm6, %%mm1        \n\t&quot;\
+        &quot;movq   -1(%0), %%mm2       \n\t&quot;\
+        &quot;movq    2(%0), %%mm4       \n\t&quot;\
+        &quot;movq %%mm2, %%mm3          \n\t&quot;\
+        &quot;movq %%mm4, %%mm5          \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm2     \n\t&quot;\
+        &quot;punpckhbw %%mm7, %%mm3     \n\t&quot;\
+        &quot;punpcklbw %%mm7, %%mm4     \n\t&quot;\
+        &quot;punpckhbw %%mm7, %%mm5     \n\t&quot;\
+        &quot;paddw %%mm4, %%mm2         \n\t&quot;\
+        &quot;paddw %%mm3, %%mm5         \n\t&quot;\
+        &quot;psubw %%mm2, %%mm0         \n\t&quot;\
+        &quot;psubw %%mm5, %%mm1         \n\t&quot;\
+        &quot;movq %6, %%mm5             \n\t&quot;\
+        &quot;paddw %%mm5, %%mm0         \n\t&quot;\
+        &quot;paddw %%mm5, %%mm1         \n\t&quot;\
+        &quot;psraw $3, %%mm0            \n\t&quot;\
+        &quot;psraw $3, %%mm1            \n\t&quot;\
+        &quot;packuswb %%mm1, %%mm0      \n\t&quot;\
+        OP(%%mm0, (%1),%%mm5, q)         \
+        &quot;add %3, %0                 \n\t&quot;\
+        &quot;add %4, %1                 \n\t&quot;\
+        &quot;decl %2                    \n\t&quot;\
+        &quot; jnz 1b                    \n\t&quot;\
+        : &quot;+a&quot;(src), &quot;+c&quot;(dst), &quot;+m&quot;(h)\
+        : &quot;d&quot;((long)srcStride), &quot;S&quot;((long)dstStride), &quot;m&quot;(ff_pw_5), &quot;m&quot;(ff_pw_4)\
+        : &quot;memory&quot;\
+    );\
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV1,OP,ff_pw_64,ff_pw_96,ff_pw_42)      \
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV2,OP,ff_pw_4,ff_pw_5,ff_pw_5)         \
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV3,OP,ff_pw_64,ff_pw_96,ff_pw_42)      \
+}\
+\
+static void OPNAME ## cavs_qpel8_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel8_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel8_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel16_h_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst  , src  , dstStride, srcStride);\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst+8, src+8, dstStride, srcStride);\
+    src += 8*srcStride;\
+    dst += 8*dstStride;\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst  , src  , dstStride, srcStride);\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst+8, src+8, dstStride, srcStride);\
+}\
+
+#define CAVS_MC(OPNAME, SIZE, MMX) \
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc20_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _h_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc01_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v1_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc02_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v2_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc03_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v3_ ## MMX(dst, src, stride, stride);\
+}\
+
+#define PUT_OP(a,b,temp, size) &quot;mov&quot; #size &quot; &quot; #a &quot;, &quot; #b &quot;    \n\t&quot;
+#define AVG_3DNOW_OP(a,b,temp, size) \
+&quot;mov&quot; #size &quot; &quot; #b &quot;, &quot; #temp &quot;   \n\t&quot;\
+&quot;pavgusb &quot; #temp &quot;, &quot; #a &quot;        \n\t&quot;\
+&quot;mov&quot; #size &quot; &quot; #a &quot;, &quot; #b &quot;      \n\t&quot;
+#define AVG_MMX2_OP(a,b,temp, size) \
+&quot;mov&quot; #size &quot; &quot; #b &quot;, &quot; #temp &quot;   \n\t&quot;\
+&quot;pavgb &quot; #temp &quot;, &quot; #a &quot;          \n\t&quot;\
+&quot;mov&quot; #size &quot; &quot; #a &quot;, &quot; #b &quot;      \n\t&quot;
+
+QPEL_CAVS(put_,       PUT_OP, 3dnow)
+QPEL_CAVS(avg_, AVG_3DNOW_OP, 3dnow)
+QPEL_CAVS(put_,       PUT_OP, mmx2)
+QPEL_CAVS(avg_,  AVG_MMX2_OP, mmx2)
+
+CAVS_MC(put_, 8, 3dnow)
+CAVS_MC(put_, 16,3dnow)
+CAVS_MC(avg_, 8, 3dnow)
+CAVS_MC(avg_, 16,3dnow)
+CAVS_MC(put_, 8, mmx2)
+CAVS_MC(put_, 16,mmx2)
+CAVS_MC(avg_, 8, mmx2)
+CAVS_MC(avg_, 16,mmx2)
+
+void ff_put_cavs_qpel8_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_avg_cavs_qpel8_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_put_cavs_qpel16_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_avg_cavs_qpel16_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+
+void ff_cavsdsp_init_mmx2(DSPContext* c, AVCodecContext *avctx) {
+#define dspfunc(PFX, IDX, NUM) \
+    c-&gt;PFX ## _pixels_tab[IDX][ 0] = ff_ ## PFX ## NUM ## _mc00_mmx2; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 2] = ff_ ## PFX ## NUM ## _mc20_mmx2; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 4] = ff_ ## PFX ## NUM ## _mc01_mmx2; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 8] = ff_ ## PFX ## NUM ## _mc02_mmx2; \
+    c-&gt;PFX ## _pixels_tab[IDX][12] = ff_ ## PFX ## NUM ## _mc03_mmx2; \
+
+    dspfunc(put_cavs_qpel, 0, 16);
+    dspfunc(put_cavs_qpel, 1, 8);
+    dspfunc(avg_cavs_qpel, 0, 16);
+    dspfunc(avg_cavs_qpel, 1, 8);
+#undef dspfunc
+    c-&gt;cavs_idct8_add = cavs_idct8_add_mmx;
+}
+
+void ff_cavsdsp_init_3dnow(DSPContext* c, AVCodecContext *avctx) {
+#define dspfunc(PFX, IDX, NUM) \
+    c-&gt;PFX ## _pixels_tab[IDX][ 0] = ff_ ## PFX ## NUM ## _mc00_mmx2; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 2] = ff_ ## PFX ## NUM ## _mc20_3dnow; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 4] = ff_ ## PFX ## NUM ## _mc01_3dnow; \
+    c-&gt;PFX ## _pixels_tab[IDX][ 8] = ff_ ## PFX ## NUM ## _mc02_3dnow; \
+    c-&gt;PFX ## _pixels_tab[IDX][12] = ff_ ## PFX ## NUM ## _mc03_3dnow; \
+
+    dspfunc(put_cavs_qpel, 0, 16);
+    dspfunc(put_cavs_qpel, 1, 8);
+    dspfunc(avg_cavs_qpel, 0, 16);
+    dspfunc(avg_cavs_qpel, 1, 8);
+#undef dspfunc
+    c-&gt;cavs_idct8_add = cavs_idct8_add_mmx;
+}

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,102 @@
+/*
+ * DSP utils : QNS functions are compiled 3 times for mmx/3dnow/ssse3
+ * Copyright (c) 2004 Michael Niedermayer
+ *
+ * MMX optimization by Michael Niedermayer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">michaelni at gmx.at</A>&gt;
+ * 3DNow! and SSSE3 optimization by Zuxy Meng &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">zuxy.meng at gmail.com</A>&gt;
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#define MAX_ABS (512 &gt;&gt; (SCALE_OFFSET&gt;0 ? SCALE_OFFSET : 0))
+
+static int DEF(try_8x8basis)(int16_t rem[64], int16_t weight[64], int16_t basis[64], int scale)
+{
+    long i=0;
+
+    assert(FFABS(scale) &lt; MAX_ABS);
+    scale&lt;&lt;= 16 + SCALE_OFFSET - BASIS_SHIFT + RECON_SHIFT;
+
+    SET_RND(mm6);
+    asm volatile(
+        &quot;pxor %%mm7, %%mm7              \n\t&quot;
+        &quot;movd  %4, %%mm5                \n\t&quot;
+        &quot;punpcklwd %%mm5, %%mm5         \n\t&quot;
+        &quot;punpcklwd %%mm5, %%mm5         \n\t&quot;
+        ASMALIGN(4)
+        &quot;1:                             \n\t&quot;
+        &quot;movq  (%1, %0), %%mm0          \n\t&quot;
+        &quot;movq  8(%1, %0), %%mm1         \n\t&quot;
+        PMULHRW(%%mm0, %%mm1, %%mm5, %%mm6)
+        &quot;paddw (%2, %0), %%mm0          \n\t&quot;
+        &quot;paddw 8(%2, %0), %%mm1         \n\t&quot;
+        &quot;psraw $6, %%mm0                \n\t&quot;
+        &quot;psraw $6, %%mm1                \n\t&quot;
+        &quot;pmullw (%3, %0), %%mm0         \n\t&quot;
+        &quot;pmullw 8(%3, %0), %%mm1        \n\t&quot;
+        &quot;pmaddwd %%mm0, %%mm0           \n\t&quot;
+        &quot;pmaddwd %%mm1, %%mm1           \n\t&quot;
+        &quot;paddd %%mm1, %%mm0             \n\t&quot;
+        &quot;psrld $4, %%mm0                \n\t&quot;
+        &quot;paddd %%mm0, %%mm7             \n\t&quot;
+        &quot;add $16, %0                    \n\t&quot;
+        &quot;cmp $128, %0                   \n\t&quot; //FIXME optimize &amp; bench
+        &quot; jb 1b                         \n\t&quot;
+        PHADDD(%%mm7, %%mm6)
+        &quot;psrld $2, %%mm7                \n\t&quot;
+        &quot;movd %%mm7, %0                 \n\t&quot;
+
+        : &quot;+r&quot; (i)
+        : &quot;r&quot;(basis), &quot;r&quot;(rem), &quot;r&quot;(weight), &quot;g&quot;(scale)
+    );
+    return i;
+}
+
+static void DEF(add_8x8basis)(int16_t rem[64], int16_t basis[64], int scale)
+{
+    long i=0;
+
+    if(FFABS(scale) &lt; MAX_ABS){
+        scale&lt;&lt;= 16 + SCALE_OFFSET - BASIS_SHIFT + RECON_SHIFT;
+        SET_RND(mm6);
+        asm volatile(
+                &quot;movd  %3, %%mm5        \n\t&quot;
+                &quot;punpcklwd %%mm5, %%mm5 \n\t&quot;
+                &quot;punpcklwd %%mm5, %%mm5 \n\t&quot;
+                ASMALIGN(4)
+                &quot;1:                     \n\t&quot;
+                &quot;movq  (%1, %0), %%mm0  \n\t&quot;
+                &quot;movq  8(%1, %0), %%mm1 \n\t&quot;
+                PMULHRW(%%mm0, %%mm1, %%mm5, %%mm6)
+                &quot;paddw (%2, %0), %%mm0  \n\t&quot;
+                &quot;paddw 8(%2, %0), %%mm1 \n\t&quot;
+                &quot;movq %%mm0, (%2, %0)   \n\t&quot;
+                &quot;movq %%mm1, 8(%2, %0)  \n\t&quot;
+                &quot;add $16, %0            \n\t&quot;
+                &quot;cmp $128, %0           \n\t&quot; // FIXME optimize &amp; bench
+                &quot; jb 1b                 \n\t&quot;
+
+                : &quot;+r&quot; (i)
+                : &quot;r&quot;(basis), &quot;r&quot;(rem), &quot;g&quot;(scale)
+        );
+    }else{
+        for(i=0; i&lt;8*8; i++){
+            rem[i] += (basis[i]*scale + (1&lt;&lt;(BASIS_SHIFT - RECON_SHIFT-1)))&gt;&gt;(BASIS_SHIFT - RECON_SHIFT);
+        }
+    }
+}
+

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,32 @@
+/*
+ * vp3dsp MMX function declarations
+ * Copyright (c) 2007 Aurelien Jacobs &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">aurel at gnuage.org</A>&gt;
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef VP3DSP_MMX_H
+#define VP3DSP_MMX_H
+
+#include &quot;dsputil.h&quot;
+
+void ff_vp3_idct_mmx(int16_t *data);
+void ff_vp3_idct_put_mmx(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_idct_add_mmx(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_dsp_init_mmx(void);
+
+#endif /* VP3DSP_MMX_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,31 @@
+/*
+ * vp3dsp SSE2 function declarations
+ * Copyright (c) 2007 Aurelien Jacobs &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">aurel at gnuage.org</A>&gt;
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef VP3DSP_SSE2_H
+#define VP3DSP_SSE2_H
+
+#include &quot;dsputil.h&quot;
+
+void ff_vp3_idct_sse2(int16_t *input_data);
+void ff_vp3_idct_put_sse2(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_idct_add_sse2(uint8_t *dest, int line_size, DCTELEM *block);
+
+#endif /* VP3DSP_SSE2_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,41 @@
+/*
+ * JPEG-LS decoder
+ * Copyright (c) 2003 Michael Niedermayer
+ * Copyright (c) 2006 Konstantin Shishkov
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file jpeglsdec.h
+ * JPEG-LS decoder.
+ */
+
+#ifndef JPEGLSDEC_H
+#define JPEGLSDEC_H
+
+#include &quot;mjpeg.h&quot;
+#include &quot;mjpegdec.h&quot;
+
+/**
+ * Decode LSE block with initialization parameters
+ */
+int ff_jpegls_decode_lse(MJpegDecodeContext *s);
+
+int ff_jpegls_decode_picture(MJpegDecodeContext *s, int near, int point_transform, int ilv);
+
+#endif /* JPEGLSDEC_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,196 @@
+/*
+ * Matroska constants
+ * Copyright (c) 2003-2004 The ffmpeg Project
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef MATROSKA_H
+#define MATROSKA_H
+
+#include &quot;avcodec.h&quot;
+
+/* EBML version supported */
+#define EBML_VERSION 1
+
+/* top-level master-IDs */
+#define EBML_ID_HEADER             0x1A45DFA3
+
+/* IDs in the HEADER master */
+#define EBML_ID_EBMLVERSION        0x4286
+#define EBML_ID_EBMLREADVERSION    0x42F7
+#define EBML_ID_EBMLMAXIDLENGTH    0x42F2
+#define EBML_ID_EBMLMAXSIZELENGTH  0x42F3
+#define EBML_ID_DOCTYPE            0x4282
+#define EBML_ID_DOCTYPEVERSION     0x4287
+#define EBML_ID_DOCTYPEREADVERSION 0x4285
+
+/* general EBML types */
+#define EBML_ID_VOID               0xEC
+
+/*
+ * Matroska element IDs. max. 32-bit.
+ */
+
+/* toplevel segment */
+#define MATROSKA_ID_SEGMENT    0x18538067
+
+/* matroska top-level master IDs */
+#define MATROSKA_ID_INFO       0x1549A966
+#define MATROSKA_ID_TRACKS     0x1654AE6B
+#define MATROSKA_ID_CUES       0x1C53BB6B
+#define MATROSKA_ID_TAGS       0x1254C367
+#define MATROSKA_ID_SEEKHEAD   0x114D9B74
+#define MATROSKA_ID_CLUSTER    0x1F43B675
+
+/* IDs in the info master */
+#define MATROSKA_ID_TIMECODESCALE 0x2AD7B1
+#define MATROSKA_ID_DURATION   0x4489
+#define MATROSKA_ID_TITLE      0x7BA9
+#define MATROSKA_ID_WRITINGAPP 0x5741
+#define MATROSKA_ID_MUXINGAPP  0x4D80
+#define MATROSKA_ID_DATEUTC    0x4461
+
+/* ID in the tracks master */
+#define MATROSKA_ID_TRACKENTRY 0xAE
+
+/* IDs in the trackentry master */
+#define MATROSKA_ID_TRACKNUMBER 0xD7
+#define MATROSKA_ID_TRACKUID   0x73C5
+#define MATROSKA_ID_TRACKTYPE  0x83
+#define MATROSKA_ID_TRACKAUDIO 0xE1
+#define MATROSKA_ID_TRACKVIDEO 0xE0
+#define MATROSKA_ID_CODECID    0x86
+#define MATROSKA_ID_CODECPRIVATE 0x63A2
+#define MATROSKA_ID_CODECNAME  0x258688
+#define MATROSKA_ID_CODECINFOURL 0x3B4040
+#define MATROSKA_ID_CODECDOWNLOADURL 0x26B240
+#define MATROSKA_ID_TRACKNAME  0x536E
+#define MATROSKA_ID_TRACKLANGUAGE 0x22B59C
+#define MATROSKA_ID_TRACKFLAGENABLED 0xB9
+#define MATROSKA_ID_TRACKFLAGDEFAULT 0x88
+#define MATROSKA_ID_TRACKFLAGLACING 0x9C
+#define MATROSKA_ID_TRACKMINCACHE 0x6DE7
+#define MATROSKA_ID_TRACKMAXCACHE 0x6DF8
+#define MATROSKA_ID_TRACKDEFAULTDURATION 0x23E383
+
+/* IDs in the trackvideo master */
+#define MATROSKA_ID_VIDEOFRAMERATE 0x2383E3
+#define MATROSKA_ID_VIDEODISPLAYWIDTH 0x54B0
+#define MATROSKA_ID_VIDEODISPLAYHEIGHT 0x54BA
+#define MATROSKA_ID_VIDEOPIXELWIDTH 0xB0
+#define MATROSKA_ID_VIDEOPIXELHEIGHT 0xBA
+#define MATROSKA_ID_VIDEOFLAGINTERLACED 0x9A
+#define MATROSKA_ID_VIDEOSTEREOMODE 0x53B9
+#define MATROSKA_ID_VIDEOASPECTRATIO 0x54B3
+#define MATROSKA_ID_VIDEOCOLOURSPACE 0x2EB524
+
+/* IDs in the trackaudio master */
+#define MATROSKA_ID_AUDIOSAMPLINGFREQ 0xB5
+#define MATROSKA_ID_AUDIOOUTSAMPLINGFREQ 0x78B5
+
+#define MATROSKA_ID_AUDIOBITDEPTH 0x6264
+#define MATROSKA_ID_AUDIOCHANNELS 0x9F
+
+/* ID in the cues master */
+#define MATROSKA_ID_POINTENTRY 0xBB
+
+/* IDs in the pointentry master */
+#define MATROSKA_ID_CUETIME    0xB3
+#define MATROSKA_ID_CUETRACKPOSITION 0xB7
+
+/* IDs in the cuetrackposition master */
+#define MATROSKA_ID_CUETRACK   0xF7
+#define MATROSKA_ID_CUECLUSTERPOSITION 0xF1
+
+/* IDs in the tags master */
+/* TODO */
+
+/* IDs in the seekhead master */
+#define MATROSKA_ID_SEEKENTRY  0x4DBB
+
+/* IDs in the seekpoint master */
+#define MATROSKA_ID_SEEKID     0x53AB
+#define MATROSKA_ID_SEEKPOSITION 0x53AC
+
+/* IDs in the cluster master */
+#define MATROSKA_ID_CLUSTERTIMECODE 0xE7
+#define MATROSKA_ID_BLOCKGROUP 0xA0
+#define MATROSKA_ID_SIMPLEBLOCK 0xA3
+
+/* IDs in the blockgroup master */
+#define MATROSKA_ID_BLOCK      0xA1
+#define MATROSKA_ID_BLOCKDURATION 0x9B
+#define MATROSKA_ID_BLOCKREFERENCE 0xFB
+
+typedef enum {
+  MATROSKA_TRACK_TYPE_VIDEO    = 0x1,
+  MATROSKA_TRACK_TYPE_AUDIO    = 0x2,
+  MATROSKA_TRACK_TYPE_COMPLEX  = 0x3,
+  MATROSKA_TRACK_TYPE_LOGO     = 0x10,
+  MATROSKA_TRACK_TYPE_SUBTITLE = 0x11,
+  MATROSKA_TRACK_TYPE_CONTROL  = 0x20,
+} MatroskaTrackType;
+
+typedef enum {
+  MATROSKA_EYE_MODE_MONO  = 0x0,
+  MATROSKA_EYE_MODE_RIGHT = 0x1,
+  MATROSKA_EYE_MODE_LEFT  = 0x2,
+  MATROSKA_EYE_MODE_BOTH  = 0x3,
+} MatroskaEyeMode;
+
+typedef enum {
+  MATROSKA_ASPECT_RATIO_MODE_FREE  = 0x0,
+  MATROSKA_ASPECT_RATIO_MODE_KEEP  = 0x1,
+  MATROSKA_ASPECT_RATIO_MODE_FIXED = 0x2,
+} MatroskaAspectRatioMode;
+
+/*
+ * These aren't in any way &quot;matroska-form&quot; things,
+ * it's just something I use in the muxer/demuxer.
+ */
+
+typedef enum {
+  MATROSKA_TRACK_ENABLED = (1&lt;&lt;0),
+  MATROSKA_TRACK_DEFAULT = (1&lt;&lt;1),
+  MATROSKA_TRACK_LACING  = (1&lt;&lt;2),
+  MATROSKA_TRACK_REAL_V  = (1&lt;&lt;4),
+  MATROSKA_TRACK_SHIFT   = (1&lt;&lt;16)
+} MatroskaTrackFlags;
+
+typedef enum {
+  MATROSKA_VIDEOTRACK_INTERLACED = (MATROSKA_TRACK_SHIFT&lt;&lt;0)
+} MatroskaVideoTrackFlags;
+
+/*
+ * Matroska Codec IDs. Strings.
+ */
+
+typedef struct CodecTags{
+    const char *str;
+    enum CodecID id;
+}CodecTags;
+
+#define MATROSKA_CODEC_ID_VIDEO_VFW_FOURCC   &quot;V_MS/VFW/FOURCC&quot;
+#define MATROSKA_CODEC_ID_AUDIO_ACM          &quot;A_MS/ACM&quot;
+
+/* max. depth in the EBML tree structure */
+#define EBML_MAX_DEPTH 16
+
+extern CodecTags ff_mkv_codec_tags[];
+
+#endif /* MATROSKA_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,60 @@
+/*
+ * MPEG1/2 muxer and demuxer common defines
+ * Copyright (c) 2000, 2001, 2002 Fabrice Bellard.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVFORMAT_MPEG_H
+#define AVFORMAT_MPEG_H
+
+#define PACK_START_CODE             ((unsigned int)0x000001ba)
+#define SYSTEM_HEADER_START_CODE    ((unsigned int)0x000001bb)
+#define SEQUENCE_END_CODE           ((unsigned int)0x000001b7)
+#define PACKET_START_CODE_MASK      ((unsigned int)0xffffff00)
+#define PACKET_START_CODE_PREFIX    ((unsigned int)0x00000100)
+#define ISO_11172_END_CODE          ((unsigned int)0x000001b9)
+
+/* mpeg2 */
+#define PROGRAM_STREAM_MAP 0x1bc
+#define PRIVATE_STREAM_1   0x1bd
+#define PADDING_STREAM     0x1be
+#define PRIVATE_STREAM_2   0x1bf
+
+#define AUDIO_ID 0xc0
+#define VIDEO_ID 0xe0
+#define AC3_ID   0x80
+#define DTS_ID   0x8a
+#define LPCM_ID  0xa0
+#define SUB_ID   0x20
+
+#define STREAM_TYPE_VIDEO_MPEG1     0x01
+#define STREAM_TYPE_VIDEO_MPEG2     0x02
+#define STREAM_TYPE_AUDIO_MPEG1     0x03
+#define STREAM_TYPE_AUDIO_MPEG2     0x04
+#define STREAM_TYPE_PRIVATE_SECTION 0x05
+#define STREAM_TYPE_PRIVATE_DATA    0x06
+#define STREAM_TYPE_AUDIO_AAC       0x0f
+#define STREAM_TYPE_VIDEO_MPEG4     0x10
+#define STREAM_TYPE_VIDEO_H264      0x1b
+
+#define STREAM_TYPE_AUDIO_AC3       0x81
+#define STREAM_TYPE_AUDIO_DTS       0x8a
+
+static const int lpcm_freq_tab[4] = { 48000, 96000, 44100, 32000 };
+
+#endif /* AVFORMAT_MPEG_H */


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000668.html">[Avidemux-svn-commit] r3392 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
</A></li>
	<LI>Next message: <A HREF="000670.html">[Avidemux-svn-commit] r3394 - in	branches/avidemux_2.4_branch/avidemux/ADM_libraries:	ADM_lavcodec ADM_lavutil
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#669">[ date ]</a>
              <a href="thread.html#669">[ thread ]</a>
              <a href="subject.html#669">[ subject ]</a>
              <a href="author.html#669">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
