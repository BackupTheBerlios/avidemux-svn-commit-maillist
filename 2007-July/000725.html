<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3450 - in	branches/avidemux_2.4_branch/avidemux: . ADM_codecs ADM_ocr	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3450%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_codecs%20ADM_ocr%0A%09ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200707271657.l6RGvnoj020410%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000724.html">
   <LINK REL="Next"  HREF="000726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3450 - in	branches/avidemux_2.4_branch/avidemux: . ADM_codecs ADM_ocr	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3450%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_codecs%20ADM_ocr%0A%09ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200707271657.l6RGvnoj020410%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3450 - in	branches/avidemux_2.4_branch/avidemux: . ADM_codecs ADM_ocr	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter">mean at mail.berlios.de
       </A><BR>
    <I>Fri Jul 27 18:57:49 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000724.html">[Avidemux-svn-commit] r3449 - in	branches/avidemux_2.4_branch/avidemux: ADM_ocr	ADM_userInterfaces/ADM_GTK/ADM_ocr
</A></li>
        <LI>Next message: <A HREF="000726.html">[Avidemux-svn-commit] r3451 - branches/avidemux_2.4_branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#725">[ date ]</a>
              <a href="thread.html#725">[ thread ]</a>
              <a href="subject.html#725">[ subject ]</a>
              <a href="author.html#725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-07-27 18:57:44 +0200 (Fri, 27 Jul 2007)
New Revision: 3450

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gui_action.hxx
Log:
[OCR] More on mpeg TS ocr, still incomplete

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -18,7 +18,7 @@
  *                                                                         *
  ***************************************************************************/
 #ifdef USE_FFMPEG
-
+#include &quot;ADM_lavcodec.h&quot;
 class decoderFFSubs
 {
   protected:

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -21,9 +21,10 @@
  #include &quot;ADM_video/ADM_genvideo.hxx&quot;
 
  #include &quot;ADM_ocr.h&quot;
-#include &quot;ADM_ocrInternal.h&quot;
+ #include &quot;ADM_ocrInternal.h&quot;
  #include &quot;ADM_toolkit/toolkit.hxx&quot;
  #include &quot;ADM_userInterfaces/ADM_commonUI/DIA_enter.h&quot;
+ #include &quot;ADM_videoFilter/ADM_vidDvbSub.h&quot;
 
 /*  *****************************
  * 	**** Case 1 : Vobsub ********
@@ -80,11 +81,14 @@
  * 	**** Case 2 : TsSub  ********
  *  *****************************
  */
-
+#define TS_WIDTH  720
+#define TS_HEIGHT 576
 class ADM_BitmapSource_TsSub : public ADM_BitmapSource
 {
 protected:
 			uint32_t		_nbPics;
+			ADMVideoSubDVB  *_dvb;
+			vobSubBitmap    *_bitmap;
 public: 
 								ADM_BitmapSource_TsSub(void);
 			virtual uint8_t     init(ADM_OCR_SOURCE *source);
@@ -96,15 +100,22 @@
 ADM_BitmapSource_TsSub::ADM_BitmapSource_TsSub(void)
 {
 	_nbPics=0x7FFFF;
+	_dvb=NULL;
+	_bitmap=new vobSubBitmap(TS_WIDTH,TS_HEIGHT);
 }
 ADM_BitmapSource_TsSub::~ADM_BitmapSource_TsSub()
 {
-
+	if(_dvb) delete _dvb;
+	_dvb=NULL;
+	if(_bitmap) delete _bitmap;
+	_bitmap=NULL;
 }
 uint8_t     ADM_BitmapSource_TsSub::init(ADM_OCR_SOURCE *source)
 {
+	_dvb=new ADMVideoSubDVB(&quot;/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg&quot;,0x96,TS_WIDTH,TS_HEIGHT);
 	
-		return 0;
+	ADM_assert(_dvb);
+	return _dvb-&gt;init(&quot;/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg&quot;);
 }
 uint32_t 	ADM_BitmapSource_TsSub::getNbImages(void)
 {
@@ -113,10 +124,68 @@
 /**
  * 		\fn getBitmap
  * 		\brief returns a bitmap in black &amp; white (luma+alpha)
+ *      @param nb : unused
+ *      @start : Timecode of start (ms)
+ * 		@end   : Timecode of end (ms)
+ * 		@first : First non empty line
+ * 		@last  : Last non empty line
  * */
 vobSubBitmap *ADM_BitmapSource_TsSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
 {
-	return NULL;
+	uint32_t pts;
+	// First get our bitmap
+	  if(! _dvb-&gt;getNextBitmap(_bitmap,&amp;pts))
+	  {
+		  printf(&quot;[BitmapSource] cannot get next bitmap\n&quot;);
+		  return NULL;
+	  }
+	  // Now build it
+	  // First &amp; last are the 1st and last non empty lines
+	  *first=0;
+	  *last=TS_HEIGHT-1;
+	  
+	  // Lookup the actual beginning /end
+	  uint32_t top=0;
+	   while(top&lt;TS_HEIGHT &amp;&amp; !_bitmap-&gt;isDirty(top) ) top++;
+	        
+	        if(top==TS_HEIGHT)
+	        {
+	                printf(&quot;[BitmapSource]Empty bitmap\n&quot;);
+	                return NULL; 
+	        }
+	  // 
+	        *first=top;
+	        
+	  // Now bottom
+	        uint32_t bottom=TS_HEIGHT-1;
+	        while(bottom&gt;top &amp;&amp; !_bitmap-&gt;isDirty(bottom) ) bottom--;
+	        if(bottom==top)
+	        {
+	        	   printf(&quot;[BitmapSource]Empty bitmap\n&quot;);
+	        	   return NULL; 
+	        }
+	        *last=bottom;
+	        
+	  // start &amp; end are timecodes
+	  *start=pts/90;
+	  *end=*start+1000;
+			  
+	  // Set alpha as luma
+	  uint8_t *in,*out;
+	  in=_bitmap-&gt;_bitmap;
+	  out=_bitmap-&gt;_alphaMask;
+	  for(uint32_t yy=0;yy&lt;TS_HEIGHT;yy++)
+		  for(uint32_t xx=0;xx&lt;TS_WIDTH;xx++)
+		  {
+			  if(*in) *out=255;
+			  else *out=0;
+			  
+			  in++;
+			  out++;
+			  
+		  }
+		  
+	return _bitmap;
 }
 //**********************************************************
 //**********************************************************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -36,11 +36,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8323;
+  GtkWidget *image8373;
   GtkWidget *append_video1;
-  GtkWidget *image8324;
+  GtkWidget *image8374;
   GtkWidget *save_stuff;
-  GtkWidget *image8325;
+  GtkWidget *image8375;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -50,41 +50,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8326;
+  GtkWidget *image8376;
   GtkWidget *save_project_as1;
-  GtkWidget *image8327;
+  GtkWidget *image8377;
   GtkWidget *run_script1;
-  GtkWidget *image8328;
+  GtkWidget *image8378;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8329;
+  GtkWidget *image8379;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8330;
+  GtkWidget *image8380;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8331;
+  GtkWidget *image8381;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8332;
+  GtkWidget *image8382;
   GtkWidget *copy1;
-  GtkWidget *image8333;
+  GtkWidget *image8383;
   GtkWidget *paste1;
-  GtkWidget *image8334;
+  GtkWidget *image8384;
   GtkWidget *delete1;
-  GtkWidget *image8335;
+  GtkWidget *image8385;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8336;
+  GtkWidget *image8386;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -113,13 +113,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8337;
+  GtkWidget *image8387;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8338;
+  GtkWidget *image8388;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -128,6 +128,7 @@
   GtkWidget *separator13;
   GtkWidget *v2v;
   GtkWidget *ocr_vobsub_2_srt;
+  GtkWidget *ocr_dvb;
   GtkWidget *edit_glyph1;
   GtkWidget *separator17;
   GtkWidget *see_hex1;
@@ -141,35 +142,35 @@
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8339;
+  GtkWidget *image8389;
   GtkWidget *previous_frame1;
-  GtkWidget *image8340;
+  GtkWidget *image8390;
   GtkWidget *next_frame1;
-  GtkWidget *image8341;
+  GtkWidget *image8391;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8342;
+  GtkWidget *image8392;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8343;
+  GtkWidget *image8393;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8344;
+  GtkWidget *image8394;
   GtkWidget *last_frame1;
-  GtkWidget *image8345;
+  GtkWidget *image8395;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8346;
+  GtkWidget *image8396;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8347;
+  GtkWidget *image8397;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8348;
+  GtkWidget *image8398;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -300,9 +301,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8323 = gtk_image_new_from_stock (&quot;gtk-open&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8323);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8323);
+  image8373 = gtk_image_new_from_stock (&quot;gtk-open&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8373);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8373);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Append...&quot;));
   gtk_widget_show (append_video1);
@@ -311,17 +312,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8324 = gtk_image_new_from_stock (&quot;gtk-add&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8324);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8324);
+  image8374 = gtk_image_new_from_stock (&quot;gtk-add&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8374);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8374);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Save&quot;));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8325 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8325);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8325);
+  image8375 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8375);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8375);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -363,25 +364,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8326 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8326);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8326);
+  image8376 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8376);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8376);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Save P_roject As...&quot;));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8327 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8327);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8327);
+  image8377 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8377);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8377);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Load/Run Project...&quot;));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8328 = gtk_image_new_from_stock (&quot;gtk-execute&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8328);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8328);
+  image8378 = gtk_image_new_from_stock (&quot;gtk-execute&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8378);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8378);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (_(&quot;A_dd to Joblist...&quot;));
   gtk_widget_show (add_to_joblist1);
@@ -415,9 +416,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8329 = gtk_image_new_from_stock (&quot;gtk-properties&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8329);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8329);
+  image8379 = gtk_image_new_from_stock (&quot;gtk-properties&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8379);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8379);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (_(&quot;AVI _Muxer Options&quot;));
   gtk_widget_show (avi_muxer_options1);
@@ -435,9 +436,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8330 = gtk_image_new_from_stock (&quot;gtk-quit&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8330);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8330);
+  image8380 = gtk_image_new_from_stock (&quot;gtk-quit&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8380);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8380);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (_(&quot;_Edit&quot;));
   gtk_widget_show (menuitem2);
@@ -450,9 +451,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8331 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8331);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8331);
+  image8381 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8381);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8381);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -466,9 +467,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8332 = gtk_image_new_from_stock (&quot;gtk-cut&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8332);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8332);
+  image8382 = gtk_image_new_from_stock (&quot;gtk-cut&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8382);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8382);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Copy&quot;));
   gtk_widget_show (copy1);
@@ -477,9 +478,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8333 = gtk_image_new_from_stock (&quot;gtk-copy&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8333);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8333);
+  image8383 = gtk_image_new_from_stock (&quot;gtk-copy&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8383);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8383);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Paste&quot;));
   gtk_widget_show (paste1);
@@ -488,9 +489,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8334 = gtk_image_new_from_stock (&quot;gtk-paste&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8334);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8334);
+  image8384 = gtk_image_new_from_stock (&quot;gtk-paste&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8384);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8384);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Delete&quot;));
   gtk_widget_show (delete1);
@@ -499,9 +500,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8335 = gtk_image_new_from_stock (&quot;gtk-remove&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8335);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8335);
+  image8385 = gtk_image_new_from_stock (&quot;gtk-remove&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8385);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8385);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -531,9 +532,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8336 = gtk_image_new_from_stock (&quot;gtk-preferences&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8336);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8336);
+  image8386 = gtk_image_new_from_stock (&quot;gtk-preferences&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8386);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8386);
 
   view1 = gtk_menu_item_new_with_mnemonic (_(&quot;_View&quot;));
   gtk_widget_show (view1);
@@ -687,9 +688,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8337 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8337);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8337);
+  image8387 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8387);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8387);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Encoder&quot;));
   gtk_widget_show (audio_encoder1);
@@ -716,9 +717,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8338 = create_pixmap (mainWindow, &quot;gnome-calculator_small.xpm&quot;);
-  gtk_widget_show (image8338);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8338);
+  image8388 = create_pixmap (mainWindow, &quot;gnome-calculator_small.xpm&quot;);
+  gtk_widget_show (image8388);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8388);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -754,6 +755,10 @@
   gtk_widget_show (ocr_vobsub_2_srt);
   gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_vobsub_2_srt);
 
+  ocr_dvb = gtk_menu_item_new_with_mnemonic (_(&quot;OCR (TS-&gt;srt)&quot;));
+  gtk_widget_show (ocr_dvb);
+  gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_dvb);
+
   edit_glyph1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Edit Glyph&quot;));
   gtk_widget_show (edit_glyph1);
   gtk_container_add (GTK_CONTAINER (tools1_menu), edit_glyph1);
@@ -808,9 +813,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8339 = gtk_image_new_from_stock (&quot;gtk-media-play&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8339);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8339);
+  image8389 = gtk_image_new_from_stock (&quot;gtk-media-play&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8389);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8389);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;P_revious Frame&quot;));
   gtk_widget_show (previous_frame1);
@@ -819,9 +824,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8340 = gtk_image_new_from_stock (&quot;gtk-media-previous&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8340);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8340);
+  image8390 = gtk_image_new_from_stock (&quot;gtk-media-previous&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8390);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8390);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Next Frame&quot;));
   gtk_widget_show (next_frame1);
@@ -830,9 +835,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8341 = gtk_image_new_from_stock (&quot;gtk-media-next&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8341);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8341);
+  image8391 = gtk_image_new_from_stock (&quot;gtk-media-next&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8391);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8391);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Pr_evious Intra Frame&quot;));
   gtk_widget_show (previous_intra_frame1);
@@ -841,9 +846,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8342 = gtk_image_new_from_stock (&quot;gtk-media-rewind&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8342);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8342);
+  image8392 = gtk_image_new_from_stock (&quot;gtk-media-rewind&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8392);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8392);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Next _Intra Frame&quot;));
   gtk_widget_show (next_intra_frame1);
@@ -852,9 +857,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8343 = gtk_image_new_from_stock (&quot;gtk-media-forward&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8343);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8343);
+  image8393 = gtk_image_new_from_stock (&quot;gtk-media-forward&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8393);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8393);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (_(&quot;Previou_s Black Frame&quot;));
   gtk_widget_show (search_previous_black_frame1);
@@ -871,9 +876,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8344 = gtk_image_new_from_stock (&quot;gtk-goto-first&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8344);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8344);
+  image8394 = gtk_image_new_from_stock (&quot;gtk-goto-first&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8394);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8394);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Last Frame&quot;));
   gtk_widget_show (last_frame1);
@@ -882,9 +887,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8345 = gtk_image_new_from_stock (&quot;gtk-goto-last&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8345);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8345);
+  image8395 = gtk_image_new_from_stock (&quot;gtk-goto-last&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8395);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8395);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -917,9 +922,9 @@
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8346 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8346);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8346);
+  image8396 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8396);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8396);
 
   jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Go to _Time...&quot;));
   gtk_widget_show (jump_to_time1);
@@ -928,9 +933,9 @@
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8347 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8347);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8347);
+  image8397 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8397);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8397);
 
   custom1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Custom&quot;));
   gtk_widget_show (custom1);
@@ -951,9 +956,9 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8348 = gtk_image_new_from_stock (&quot;gtk-about&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8348);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8348);
+  image8398 = gtk_image_new_from_stock (&quot;gtk-about&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8398);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8398);
 
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
@@ -1475,11 +1480,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, &quot;menuitem1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, &quot;menuitem1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, &quot;open_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8323, &quot;image8323&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8373, &quot;image8373&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, &quot;append_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8324, &quot;image8324&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8374, &quot;image8374&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, &quot;save_stuff&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8325, &quot;image8325&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8375, &quot;image8375&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, &quot;save_stuff_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, &quot;save_as_avi1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, &quot;separator1&quot;);
@@ -1489,41 +1494,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, &quot;close1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, &quot;separator3&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, &quot;save_project1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8326, &quot;image8326&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8376, &quot;image8376&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, &quot;save_project_as1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8327, &quot;image8327&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8377, &quot;image8377&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, &quot;run_script1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8328, &quot;image8328&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8378, &quot;image8378&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, &quot;add_to_joblist1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, &quot;joblist1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, &quot;separator16&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, &quot;connect_to_avsproxy1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, &quot;separator18&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, &quot;video_informations1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8329, &quot;image8329&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8379, &quot;image8379&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, &quot;avi_muxer_options1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, &quot;separator4&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, &quot;quit1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8330, &quot;image8330&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8380, &quot;image8380&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, &quot;menuitem2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, &quot;menuitem2_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, &quot;reset_edits1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8331, &quot;image8331&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8381, &quot;image8381&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, &quot;separator5&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, &quot;cut1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8332, &quot;image8332&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8382, &quot;image8382&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, &quot;copy1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8333, &quot;image8333&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8383, &quot;image8383&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, &quot;paste1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8334, &quot;image8334&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8384, &quot;image8384&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, &quot;delete1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8335, &quot;image8335&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8385, &quot;image8385&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, &quot;separator6&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, &quot;set_marker_a1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, &quot;set_marker_b1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, &quot;separator7&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, &quot;preferences1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8336, &quot;image8336&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8386, &quot;image8386&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, view1, &quot;view1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, &quot;view1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, &quot;toolbar1&quot;);
@@ -1552,13 +1557,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, &quot;build_vbr_time_map1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, &quot;separator11&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, &quot;save_audio1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8337, &quot;image8337&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8387, &quot;image8387&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, &quot;audio_encoder1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, &quot;filters2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, &quot;tools1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, &quot;tools1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, &quot;calculator1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8338, &quot;image8338&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8388, &quot;image8388&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, &quot;separator12&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, &quot;rebuild_frames&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, &quot;check_frames&quot;);
@@ -1567,6 +1572,7 @@
   GLADE_HOOKUP_OBJECT (mainWindow, separator13, &quot;separator13&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, v2v, &quot;v2v&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, ocr_vobsub_2_srt, &quot;ocr_vobsub_2_srt&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, ocr_dvb, &quot;ocr_dvb&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, edit_glyph1, &quot;edit_glyph1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator17, &quot;separator17&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, see_hex1, &quot;see_hex1&quot;);
@@ -1580,35 +1586,35 @@
   GLADE_HOOKUP_OBJECT (mainWindow, go1, &quot;go1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, &quot;go1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, &quot;play_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8339, &quot;image8339&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8389, &quot;image8389&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, &quot;previous_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8340, &quot;image8340&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8390, &quot;image8390&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, &quot;next_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8341, &quot;image8341&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8391, &quot;image8391&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, &quot;previous_intra_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8342, &quot;image8342&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8392, &quot;image8392&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, &quot;next_intra_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8343, &quot;image8343&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8393, &quot;image8393&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, &quot;search_previous_black_frame1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, &quot;search_next_black_frame1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, &quot;first_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8344, &quot;image8344&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8394, &quot;image8394&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, &quot;last_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8345, &quot;image8345&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8395, &quot;image8395&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, &quot;separator14&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, &quot;go_to_marker_a1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, &quot;go_to_marker_b1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, &quot;separator15&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, &quot;jum_to_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8346, &quot;image8346&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8396, &quot;image8396&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, &quot;jump_to_time1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8347, &quot;image8347&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8397, &quot;image8397&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, &quot;custom1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, help2, &quot;help2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, &quot;help2_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, &quot;show_builtin_support1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, about1, &quot;about1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8348, &quot;image8348&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8398, &quot;image8398&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, &quot;toolbar2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, &quot;menutoolbuttonOpen&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, &quot;toolitem11&quot;);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -75,6 +75,10 @@
  
  CALLBACK(run_script1		   	        ,ACT_RunScript);
  CALLBACK( ocr_vobsub_2_srt                     ,ACT_Ocr);
+ 
+ CALLBACK( ocr_dvb                     ,ACT_DVB_Ocr);
+ 
+ 
 CALLBACK(item1                                 ,ACT_AllBlackFrames);
 
 CALLBACK(first_frame1                          ,ACT_Begin);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -137,7 +137,6 @@
         ADM_ocr_engine(source,srtFileName,&amp;head);
         
         // Save glyph set 
-_save:
         if(globalGlyph)
         {
           uint32_t nb=1;
@@ -154,7 +153,7 @@
             }
             if(save) ADM_dezalloc(save);
         }
-cleanup:
+
   cleanupSub(&amp;subparam);
   if(srtFileName )ADM_dezalloc(srtFileName);
   srtFileName=NULL;
@@ -162,7 +161,112 @@
   return 1;  
 }
 /**
+    \fn DIA_ocrDvb
+    \brief Dialog to select input &amp; output files before calling the actual ocr engine
+*/
+uint8_t DIA_ocrDvb(void)
+{
 
+  vobSubParam subparam={NULL,0,0};
+  char *srtFileName=NULL;
+  char *glyphFileName=NULL;
+  admGlyph head(16,16);
+  char *globalGlyph=NULL;
+  uint32_t globalGlyphOn=0;
+  prefs-&gt;get(FEATURE_GLOBAL_GLYPH_ACTIVE,&amp;globalGlyphOn);
+  if(globalGlyphOn)
+  {
+     prefs-&gt;get(FEATURE_GLOBAL_GLYPH_NAME,&amp;globalGlyph);
+     if(!*globalGlyph)
+     {
+        ADM_dezalloc(globalGlyph);
+        globalGlyph=NULL; 
+     }
+  }
+
+  if(globalGlyph)
+  {
+    glyphFileName=globalGlyph;
+  }
+_againX:  
+  // Fist build a dialogFactory to get input and output files
+  diaElemFile     selectGlyph(1,&amp;glyphFileName,_(&quot;Use glyphset (optional):&quot;),NULL);  
+  diaElemFile     selectSrt(1,&amp;srtFileName,_(&quot;Output SRT file&quot;),NULL);
+  
+  diaElem *elems[]={&amp;selectSrt,&amp;selectGlyph};
+  
+  
+   uint32_t n=2;
+   if(globalGlyph)
+   {
+     n--; // Remove glyph from dialog
+   }
+  
+        if( !diaFactoryRun(_(&quot;Select input and ouput files&quot;),n,elems))
+        {
+          cleanupSub(&amp;subparam);
+          if(srtFileName )ADM_dezalloc(srtFileName);
+          srtFileName=NULL;
+          destroyGlyphTree(&amp;head);
+          return 0;
+        }
+       // TODO Check input TS file
+        if(!srtFileName || !*srtFileName)
+        {
+          GUI_Error_HIG(_(&quot;File error&quot;),_(&quot;Please Select a valid output SRT file.&quot;));
+          goto _againX; 
+        }
+         if(glyphFileName &amp;&amp; *glyphFileName)
+         {
+           if(!ADM_fileExist(glyphFileName))
+            {
+              GUI_Error_HIG(_(&quot;File error&quot;),_(&quot;The idx/sub file does not exist.&quot;));
+              goto _againX; 
+            }
+            // Purge previous glyph set if any
+            destroyGlyphTree(&amp;head);
+            uint32_t nb;
+            printf(&quot;[OCR] Loading glyphset :&lt;%s&gt;\n&quot;,glyphFileName);
+            if(!loadGlyph(glyphFileName,&amp;head,&amp;nb))
+            {
+              GUI_Error_HIG(_(&quot;File error&quot;),_(&quot;Cannot load the glyphset file.&quot;));
+              goto _againX;               
+            }
+            printf(&quot;[GLYPH] Found %u glyph\n&quot;);
+         }
+        // We have our SRT and our idx/sub files : Go go go
+         ADM_OCR_SOURCE source;
+         source.type=ADM_OCR_TYPE_TS;
+         source.TsFile=NULL;
+         ADM_ocr_engine(source,srtFileName,&amp;head);
+        
+        // Save glyph set 
+
+        if(globalGlyph)
+        {
+          uint32_t nb=1;
+           saveGlyph(globalGlyph,&amp;head,nb);
+        }else
+        {
+            char *save=NULL;
+            uint32_t nb=1;
+              diaElemFile     selectSave(1,&amp;save,_(&quot;Glyphset filename&quot;),NULL);
+              diaElem *elems2[]={&amp;selectSave};
+            if( diaFactoryRun(_(&quot;Save Glyph&quot;),1,elems2))
+            {
+              saveGlyph(save,&amp;head,nb);
+            }
+            if(save) ADM_dezalloc(save);
+        }
+
+  cleanupSub(&amp;subparam);
+  if(srtFileName )ADM_dezalloc(srtFileName);
+  srtFileName=NULL;
+  destroyGlyphTree(&amp;head);
+  return 1;  
+}
+/**
+
 */
 void cleanupSub(vobSubParam *p)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -25,31 +25,7 @@
         int32_t         subShift;
 }vobSubParam;
 //************************************
-class vobSubBitmap
-{
-  protected:
-        uint8_t                         *_dirty;                   /// Dirty lines (non transparent)
-  public:
-        uint8_t                         isDirty(uint32_t line);
-        uint8_t                         setDirty(uint32_t line);
-
-        uint32_t                        _width,_height;
-        uint32_t                        placeTop, placeHeight;     /// Position of the sub
-      
-        uint8_t                         *_bitmap;                  /// YUV image
-        uint8_t                         *_alphaMask;               /// alpha mask 
-        
- 
-                                        vobSubBitmap(uint32_t w, uint32_t h); 
-                                        ~vobSubBitmap();
-        void                            clear(void);
-        
-                                        /// Convert palette bitmap to yuv&amp;mask bitmap
-        uint8_t                         buildYUV( int16_t *palette ); 
-                                        /// Generate the final bitmap (resized)
-        uint8_t                         subResize(vobSubBitmap **tgt,uint32_t newx,uint32_t newy,
-                                                uint32_t oldtop, uint32_t oldheight);
-};
+#include &quot;ADM_video/ADM_vidVobSubBitmap.h&quot;
 //************************************
 class  ADMVideoVobSub:public AVDMGenericVideoStream
  {

Copied: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h (from rev 3449, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -0,0 +1,40 @@
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _VOBSUB_BITMAP_H
+#define _VOBSUB_BITMAP_H
+//************************************
+class vobSubBitmap
+{
+  protected:
+        uint8_t                         *_dirty;                   /// Dirty lines (non transparent)
+  public:
+        uint8_t                         isDirty(uint32_t line);
+        uint8_t                         setDirty(uint32_t line);
+
+        uint32_t                        _width,_height;
+        uint32_t                        placeTop, placeHeight;     /// Position of the sub
+      
+        uint8_t                         *_bitmap;                  /// YUV image
+        uint8_t                         *_alphaMask;               /// alpha mask 
+        
+ 
+                                        vobSubBitmap(uint32_t w, uint32_t h); 
+                                        ~vobSubBitmap();
+        void                            clear(void);
+        
+                                        /// Convert palette bitmap to yuv&amp;mask bitmap
+        uint8_t                         buildYUV( int16_t *palette ); 
+                                        /// Generate the final bitmap (resized)
+        uint8_t                         subResize(vobSubBitmap **tgt,uint32_t newx,uint32_t newy,
+                                                uint32_t oldtop, uint32_t oldheight);
+};
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -1,6 +1,10 @@
 /***************************************************************************
                          DVB-T subtitle filter
     
+    This is a dummy DVB-T Filter and should be only used through OCR
+    The filter exists just for debugging purpose and should not be exposed
+    to end user at all.
+    
     copyright            : (C) 2007 by mean
     email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
  ***************************************************************************/
@@ -37,37 +41,10 @@
 #include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot;
 
 #include &quot;DIA_factory.h&quot;
-#include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h&quot;
-#include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h&quot;
 
 #include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;ADM_codecs/ADM_codec.h&quot;
-#include &quot;ADM_codecs/ADM_ffmp43.h&quot;
-
-#define READ_BUFFER_SIZE (64*1024)
-
-class ADMVideoSubDVB : public AVDMGenericVideoStream 
-{
-protected:
-        virtual char* printConf(void);
-       
-        uint8_t init(void);
-        
-        decoderFFSubs *decoder;
-        ADMCompressedImage *binary;
-        dmx_demuxerTS *demuxer;
-        AVSubtitle  sub;
-        uint8_t     readBuffer[READ_BUFFER_SIZE];
-        uint32_t    _inited;
-        
-public:
-        ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf);
-        virtual ~ADMVideoSubDVB();
-        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data,uint32_t *flags);
-        uint8_t configure(AVDMGenericVideoStream *instream);
-        uint8_t	getCoupledConf(CONFcouple **conf);
-};
-
+#include &quot;ADM_vidDvbSub.h&quot;
 static FILTER_PARAM assParam={7,
         { /* float */ &quot;font_scale&quot;,
           /*float*/ &quot;line_spacing&quot;,
@@ -94,7 +71,34 @@
   
    return 1;
 }
+//_______________________________________________________________
 
+ADMVideoSubDVB::ADMVideoSubDVB(const char *ts, uint32_t pid,uint32_t w, uint32_t h) 
+{
+        _in=NULL;		
+        memset(&amp;_info,0,sizeof(_info));
+        _info.width=w;
+        _info.height=h;
+        _inited=0;
+        
+      
+        _uncompressed=new ADMImage(getInfo()-&gt;width,getInfo()-&gt;height);
+        ADM_assert(_uncompressed);
+        _info.encoding=1;
+        
+        decoder=new decoderFFSubs(1);
+        binary=new ADMCompressedImage;
+        binary-&gt;data=readBuffer+2;
+        
+        MPEG_TRACK track;
+        track.pid=pid;
+
+        
+        demuxer=new dmx_demuxerTS(1,&amp;track,0,DMX_MPG_TS);
+      
+
+      
+}
 //_______________________________________________________________
 
 ADMVideoSubDVB::ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf) 
@@ -117,14 +121,17 @@
 
         
         demuxer=new dmx_demuxerTS(1,&amp;track,0,DMX_MPG_TS);
-        _inited=init();
+        _inited=init(NULL);
 
       
 }
 // **********************************
-uint8_t ADMVideoSubDVB::init(void)
+uint8_t ADMVideoSubDVB::init(const char  *tsFileName)
 {
-const char  *tsFileName=&quot;/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg&quot;;
+	// For test only!
+#ifdef ADM_DEBUG
+	if(!tsFileName) tsFileName=&quot;/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg&quot;;
+#endif
     // First create our demuxer
      
      if(!demuxer-&gt;open(tsFileName))
@@ -133,7 +140,7 @@
         return 0; 
      }
       memset(&amp;sub,0,sizeof(sub));
-     
+      _inited=1;
      return 1;
 } 
 
@@ -244,7 +251,6 @@
                       }
               
                       // Merge Luma
-                      
                       for(int yy=0;yy&lt;clipH;yy++)
                       {
                           org=data-&gt;data+(yy+r-&gt;y)*_info.width+r-&gt;x;
@@ -324,22 +330,124 @@
         
         return 1;
 }
+/**
+ * \fn 			getNextBitmap
+ * \brief 		Decode a bitmap and store the result (luma only) in the caller supplied vobSubBitmap
+ * @param data  (in) Vobsubbitmap to put image in
+ * @param pts   Raw pts in 90 Khz Tick
+ * @return      0 on failure, 1 on success 
+ * */
+uint8_t ADMVideoSubDVB::getNextBitmap(vobSubBitmap *data,uint32_t *pts) 
+{
+uint8_t *org=NULL;
 
+        uint32_t packetLen,dts; //,pts;
+        // Clear incoming picture
+        	data-&gt;clear();
+        
+          if(!demuxer-&gt;readPes(readBuffer,&amp;packetLen, &amp;dts,pts)) return 0;
+          binary-&gt;dataLength=packetLen-3; // -2 for stream iD, -1 for ????
+          if(packetLen&lt;=5) return 1;
+          // And decompress...
+          decoder-&gt;uncompress(binary,&amp;sub);
+            
+          // Process All rectangles
+          
+            printf(&quot;Found %d rects to process\n&quot;,sub.num_rects);
+            for(int i=0;i&lt;sub.num_rects;i++)
+            {
+              AVSubtitleRect *r=&amp;(sub.rects[i]);
+              // First convert RGB to Y+ALPHA
+              for(int col=0;col&lt;r-&gt;nb_colors;col++)
+              {
+                    // Color is RGB, convert to YUV
+                    uint32_t y,u,v,a;
+                    uint32_t rgb=r-&gt;rgba_palette[col];
+                
+                          y=rgba2y(rgb);
+                          u=rgba2u(rgb)&amp;0xff;
+                          v=rgba2v(rgb)&amp;0xff;
+                          a=_a(rgb);
+                          r-&gt;rgba_palette[col]=y+(u&lt;&lt;8)+(v&lt;&lt;16)+(a&lt;&lt;24);
+                          printf(&quot;Color %d, alpha %u luma %u rgb:%x\n&quot;,col,a,y,rgb);
+              }
+              // Palette is ready, display !
+              if(r-&gt;x&gt;_info.width || r-&gt;y&gt;_info.height)
+              {
+                  printf(&quot;[DVBSUB]Box is outside image\n&quot;);
+                  goto _skipX;
+              }
+                  printf(&quot;x :%d\n&quot;,r-&gt;x);
+                  printf(&quot;y :%d\n&quot;,r-&gt;y);
+                  printf(&quot;w :%d\n&quot;,r-&gt;w);
+                  printf(&quot;h :%d\n&quot;,r-&gt;h);
+
+                  {
+                      uint32_t clipW,clipH;
+                      
+                      clipW=FFMIN(_info.width,r-&gt;x+r-&gt;w)-r-&gt;x;
+                      clipH=FFMIN(_info.height,r-&gt;y+r-&gt;h)-r-&gt;y;
+                      
+                      ADMImage image(r-&gt;w,r-&gt;h);
+                      ADMImage alphaImage(r-&gt;w,r-&gt;h);
+                      
+                      uint8_t *ptr=image.data;
+                      uint8_t *ptrAlpha=alphaImage.data;
+                      uint8_t *in=r-&gt;bitmap;
+                      for(int yy=0;yy&lt;r-&gt;h;yy++)
+                      {
+                          for(int xx=0;xx&lt;r-&gt;w;xx++)
+                          {
+                            uint32_t alpha,valout;
+                            uint32_t val=*in++;
+                            
+                                  val=r-&gt;rgba_palette[val];
+                                  
+                                  *ptrAlpha++=(val&gt;&gt;24)&amp;0xff;
+                                  *ptr++=(val&amp;0xff);;
+                          }
+                      }
+              
+                      // Merge Luma
+                      
+                      for(int yy=0;yy&lt;clipH;yy++)
+                      {
+                          org=data-&gt;_bitmap+(yy+r-&gt;y)*_info.width+r-&gt;x;
+                          
+                          ptrAlpha=alphaImage.data+yy*r-&gt;w;
+                          ptr=image.data+yy*r-&gt;w;
+                          int clean=0;
+                          for(int xx=0;xx&lt;clipW;xx++)
+                          {
+                            uint32_t val,before,alpha;
+                            
+                                  //before=*org;
+                                  val=*ptr++;
+                                  alpha=*ptrAlpha++;
+                                  
+                                  val=val*alpha;//+(255-alpha)*before;
+                                  val=val&gt;&gt;8;
+                                  if(val&gt;10) clean=1; // Remove noise
+                                  *org++=val;
+                                  
+                          }
+                          if(clean) data-&gt;setDirty(r-&gt;y+yy);
+                      }
+                  }
+                   // We dont need chroma here...
+               // Delete palette &amp; data
+_skipX:
+               av_free(r-&gt;rgba_palette);
+               av_free(r-&gt;bitmap);
+            } // Next rec..
+            memset(&amp;sub,0,sizeof(sub));
+        
+        return 1;
+}
 uint8_t	ADMVideoSubDVB::getCoupledConf(CONFcouple **conf) 
 {
 
         *conf=new CONFcouple(0);
-#if 0
-#define _COUPLE_SET(x) (*conf)-&gt;setCouple(#x, _params-&gt;x);
-        _COUPLE_SET(font_scale)
-        _COUPLE_SET(line_spacing)
-        _COUPLE_SET(top_margin)
-        _COUPLE_SET(bottom_margin)
-        _COUPLE_SET(subfile)
-        _COUPLE_SET(fonts_dir)
-        _COUPLE_SET(extract_embedded_fonts)
-#endif
-     
         return 1;
 }
 /************************************************/

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h (from rev 3449, branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -0,0 +1,53 @@
+/***************************************************************************
+                         DVB-T subtitle filter
+    
+    copyright            : (C) 2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADM_VIDDVBSUB_H
+#define ADM_VIDDVBSUB_H
+#include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h&quot;
+#include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h&quot;
+
+#include &quot;ADM_codecs/ADM_ffmp43.h&quot;
+#include &quot;ADM_video/ADM_vidVobSubBitmap.h&quot;
+
+
+#define READ_BUFFER_SIZE (64*1024)
+
+class ADMVideoSubDVB : public AVDMGenericVideoStream 
+{
+protected:
+        virtual char* printConf(void);
+       
+       
+        
+        decoderFFSubs *decoder;
+        ADMCompressedImage *binary;
+        dmx_demuxerTS *demuxer;
+        AVSubtitle  sub;
+        uint8_t     readBuffer[READ_BUFFER_SIZE];
+        uint32_t    _inited;
+        
+public:
+        ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf);
+        ADMVideoSubDVB(const char *fileName, uint32_t pid,uint32_t w,uint32_t h);
+        virtual ~ADMVideoSubDVB();
+        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data,uint32_t *flags);
+        uint8_t configure(AVDMGenericVideoStream *instream);
+        uint8_t	getCoupledConf(CONFcouple **conf);
+        uint8_t getNextBitmap(vobSubBitmap *data,uint32_t *pts);
+        uint8_t init(const char  *tsFileName);
+};
+#endif
+/************************************************/

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -147,6 +147,7 @@
 int ignore_change;
 
 extern uint8_t DIA_ocrGen(void);
+extern uint8_t DIA_ocrDvb(void);
 uint8_t A_TimeShift(void);
 PARAM_MUX muxMode = MUX_REGULAR;
 int muxParam = 0;
@@ -224,6 +225,9 @@
                 return;
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
+        case ACT_DVB_Ocr:
+        		DIA_ocrDvb();
+        		break;
       case ACT_Ocr:
                 DIA_ocrGen(); //
                 return;

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-27 16:57:44 UTC (rev 3450)
@@ -164,6 +164,7 @@
 ACT_PreviewChanged,
 ACT_Bitrate,
 ACT_Ocr,
+ACT_DVB_Ocr,
 ACT_SelectTrack1,
 ACT_ViewMain,
 ACT_ViewSide,


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000724.html">[Avidemux-svn-commit] r3449 - in	branches/avidemux_2.4_branch/avidemux: ADM_ocr	ADM_userInterfaces/ADM_GTK/ADM_ocr
</A></li>
	<LI>Next message: <A HREF="000726.html">[Avidemux-svn-commit] r3451 - branches/avidemux_2.4_branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#725">[ date ]</a>
              <a href="thread.html#725">[ thread ]</a>
              <a href="subject.html#725">[ subject ]</a>
              <a href="author.html#725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
