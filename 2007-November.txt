From mean at mail.berlios.de  Thu Nov  1 11:15:55 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 1 Nov 2007 11:15:55 +0100
Subject: [Avidemux-svn-commit] r3677 - branches/avidemux_2.4_branch/po
Message-ID: <200711011015.lA1AFt6o010531@sheep.berlios.de>

Author: mean
Date: 2007-11-01 11:15:55 +0100 (Thu, 01 Nov 2007)
New Revision: 3677

Modified:
   branches/avidemux_2.4_branch/po/fr.po
Log:
[I18N] French update

Modified: branches/avidemux_2.4_branch/po/fr.po
===================================================================
--- branches/avidemux_2.4_branch/po/fr.po	2007-10-30 22:04:46 UTC (rev 3676)
+++ branches/avidemux_2.4_branch/po/fr.po	2007-11-01 10:15:55 UTC (rev 3677)
@@ -1,5 +1,4 @@
-# translation of fr.po to Mean
-# translation of avidemux2.po to Mean
+# translation of fr.po to
 # This file is distributed under the same license as the avidemux2 package.
 # Copyright (C) 2003, Mean <fixounet at free.fr>
 msgid ""
@@ -7,13 +6,13 @@
 "Project-Id-Version: fr\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2007-09-26 14:47+0100\n"
-"PO-Revision-Date: 2007-05-26 12:38+0100\n"
+"PO-Revision-Date: 2007-11-01 12:17+0100\n"
 "Last-Translator: \n"
-"Language-Team: Mean <fr at li.org>\n"
+"Language-Team:  <en at li.org>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
-"X-Generator: KBabel 1.3\n"
+"X-Generator: KBabel 1.11.4\n"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:42
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
@@ -72,7 +71,7 @@
 #: avidemux/ADM_audio/audiotimeline.cpp:85
 #: avidemux/ADM_audio/audiotimeline.cpp:96
 msgid "Building VBR map"
-msgstr "Construire le Time Map VBR"
+msgstr "Construction de l'index"
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:75
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:183
@@ -93,7 +92,7 @@
 
 #: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
 msgid "Check the permissions for /dev/dsp."
-msgstr "Lister permissions pour /dev/dsp."
+msgstr "V?rifier les permissions pour /dev/dsp."
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:220
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
@@ -147,7 +146,7 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:252
 msgid "_Disable reservoir:"
-msgstr ""
+msgstr "D?sactiver le bitrate r?servoir"
 
 #: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
 msgid "VBR"
@@ -178,7 +177,7 @@
 "Either change codec or use the mixer filter to have less channels."
 msgstr ""
 "Le nombre de canaux est plus grand que ce que le codec audio peut accepter.\n"
-"Changer de codec ou utiliser le filtre mixer pour avoir moins de canaux."
+"Changez de codec ou utilisez le filtre mixer pour avoir moins de canaux."
 
 #: avidemux/ADM_codecs/ADM_ffmp43.cpp:45
 msgid "Internal error finding codec"
@@ -196,7 +195,7 @@
 msgid ""
 ".\n"
 " Did you use too low / too high target for 2 pass ?"
-msgstr ""
+msgstr "<br>Avez vous sp?cific? un bitrate trop haut ou trop bas ?"
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:58
 msgid "No video loaded"
@@ -212,7 +211,7 @@
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:93
 msgid "Rebuilding Frames"
-msgstr "Reconstuire images "
+msgstr "Reconstuire un index"
 
 #: avidemux/ADM_editor/ADM_edFrameType.cpp:129
 msgid "Aborted"
@@ -270,6 +269,8 @@
 "ACCURACY</b>.\n"
 "Do you want to use that mode ?"
 msgstr ""
+"Si le fichier utilise l'option b-frame as reference, cela peut conduire ? un crash ou ? des saccades.\nAvidemux peut utilier un autre mode qui est plus stable, mais <b>cela fera perdre la pr?cision ? l'image pr?s</b>\n"
+"Voulez vous utiliser ce mode ?"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:712
 msgid "Packed Bitstream detected"
@@ -285,7 +286,7 @@
 
 #: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Using backup decoder - not frame accurate."
-msgstr "Utilisation du d?codeur de secours - pas pr?cis sur les images."
+msgstr "Utilisation du d?codeur de secours - La navigation ne sera pas pr?cise."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "Weird"
@@ -293,7 +294,7 @@
 
 #: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "The unpacking succeedeed but the index is still not up to date."
-msgstr "Le d?paquetage a r?eussi mais l'index n'est toujours pas jour."
+msgstr "Le d?paquetage a r?eussi mais l'index n'est toujours pas ? our."
 
 #: avidemux/ADM_editor/ADM_edit.cpp:744
 msgid "Troubles ahead"
@@ -309,8 +310,7 @@
 
 #: avidemux/ADM_editor/ADM_edit.cpp:755
 msgid "You should use Tool->Rebuild frame. Do it now ?"
-msgstr ""
-"Vous devriez utiliser ??Outils->Reconstruire image??. Le faire maintenant??"
+msgstr "Vous devriez utiliser ??Outils->Reconstruire image??. Le faire maintenant??"
 
 #: avidemux/ADM_editor/ADM_edit.cpp:1510
 msgid ""
@@ -354,7 +354,7 @@
 
 #: avidemux/ADM_encoder/adm_encConfig.cpp:718
 msgid "Only QCIF and subQCIF are allowed for H.263"
-msgstr "Seulement QCIF et subQCIF autoris?s pour H.263"
+msgstr "Seulement le QCIF et le subQCIF sont autoris?s pour le H.263"
 
 #: avidemux/ADM_encoder/adm_encConfig.cpp:910
 msgid "Fatal error"
@@ -362,7 +362,7 @@
 
 #: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
 msgid "Incompatible settings"
-msgstr "R?glage incomptaible"
+msgstr "R?glages incomptaibles"
 
 #: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
 msgid "At the moment, the DV codec only accepts 720*576 at 25"
@@ -406,7 +406,7 @@
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:250
 msgid "Can't determine aspect ratio"
-msgstr "Impossible de d?terminer le radio d'aspect"
+msgstr "Impossible de d?terminer le rapport H/L"
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:355
 msgid "Out of memory"
@@ -414,7 +414,7 @@
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:370
 msgid "Opening MPEG"
-msgstr ""
+msgstr "Ouverture du mpeg"
 
 #: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:539
 msgid "MPEG renumbering error"
@@ -423,7 +423,7 @@
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
 msgid "Opening Nuppel video"
-msgstr ""
+msgstr "Ouverture du nuppel video"
 
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
 msgid "Sure you want to abort ?"
@@ -461,7 +461,7 @@
 
 #: avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reindex.cpp:68
 msgid "Indexing"
-msgstr ""
+msgstr "Indexation"
 
 #: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:373
 msgid "Incompatible frame rate"
@@ -488,11 +488,11 @@
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:191
 msgid "Wrong Colorspace"
-msgstr ""
+msgstr "Colorspace incomatible"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp:191
 msgid "Only YV12/I420 or YUY2/I422 JPegs are supported"
-msgstr ""
+msgstr "Seuls le YV12/I420 and YUY2/I422 sont accept?s"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:403
 msgid "Memory error"
@@ -526,7 +526,7 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:328
 #: avidemux/gtk_gui.cpp:896 avidemux/gtk_gui.cpp:1498
 msgid "File error"
-msgstr "Erreur Fichier"
+msgstr "Erreur de fichier"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:366
@@ -608,12 +608,12 @@
 
 #: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:300
 msgid "Generating VobSub file"
-msgstr ""
+msgstr "G?n?ration du fichier vobub"
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:210
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:236
 msgid "Fatal Error"
-msgstr ""
+msgstr "Erreur fatale"
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:210
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:236
@@ -623,6 +623,9 @@
 "Click OK to generate debug information. This may take a few minutes to "
 "complete."
 msgstr ""
+"Une erreur fatale est survenue.\n"
+"\n"
+"Choisir OK pour generer un rapport. Cela peut prendre quelques minutes."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:437
 msgid "Load it"
@@ -630,7 +633,7 @@
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:437
 msgid "Crash file"
-msgstr "Crash fichier"
+msgstr "Fichier de crash."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:438
 msgid ""
@@ -638,7 +641,7 @@
 "Do you want to load it  ?\n"
 "(It will be deleted in all cases, you should save it if you want to keep it)"
 msgstr ""
-"J'ai d?tect? un crash de fichier. \n"
+"J'ai d?tect? un fichier de crash"
 "Voulez le charger ?\n"
 "(Il sera supprim? dans tous les cas, vous devriez le sauver si vous voulez "
 "le garder)"
@@ -717,11 +720,11 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:82
 msgid "Mux _every x video frames:"
-msgstr "Multiplexer _toutes les x images vid?os:"
+msgstr "Multiplexer _toutes les x images"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:83
 msgid "Mux in _blocks of x bytes:"
-msgstr ""
+msgstr "Muxer en block de X octets"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:90
 msgid "AVI Muxer Options"
@@ -808,24 +811,24 @@
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
 msgid "Unsupported video"
-msgstr ""
+msgstr "Video non support?e"
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:151
 msgid "Only FLV1 and VP6 video are supported"
-msgstr ""
+msgstr "Seulement le FLV1 et le VP6 sont accept?s."
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
 msgid "Unsupported audio"
-msgstr ""
+msgstr "Audio non accept?"
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:173
 msgid "Audio must be mp3 for flv output."
-msgstr ""
+msgstr "L'audio doit etre en MP3 pour le format FLV."
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:178
 msgid "Frequency must be 44100, 22050 or 11025 Hz."
-msgstr ""
+msgstr "La frequence doit etre 44100, 22050 ou 11025 Hz"
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:254
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:251
@@ -834,7 +837,7 @@
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
 msgid "This is not MPEG compatible"
-msgstr "Ce n'est pas un MPEG compatible"
+msgstr "Ce n'est pas compatible avec le MPEG"
 
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
 msgid "You can't use the Copy codec."
@@ -935,7 +938,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:36
 msgid "_Background Image:"
-msgstr ""
+msgstr "Image de fond:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
 msgid "_NTSC(default is Pal):"
@@ -943,19 +946,19 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
 msgid "Vignette _Width:"
-msgstr ""
+msgstr "Largeur des imagettes "
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:39
 msgid "Vignette _Height:"
-msgstr ""
+msgstr "Hauteur des imagettes :"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:42
 msgid "Vignette frame number"
-msgstr ""
+msgstr "Num?ro d'image pour l'imagette"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:46
 msgid "Timecode:"
-msgstr ""
+msgstr "Temps :"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:62
 msgid "_Dynamic range compression"
@@ -963,19 +966,19 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
 msgid "_Time shift (ms):"
-msgstr ""
+msgstr "D?calage temporel (ms) :"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
 msgid "Time shift value (ms)"
-msgstr ""
+msgstr "Valeur du d?calage (ms)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "R_esampling (Hz):"
-msgstr ""
+msgstr "R??echantillonage(Hz) :"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "Resampling frequency (Hz)"
-msgstr ""
+msgstr "Frequence (Hz)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
@@ -1297,15 +1300,15 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
 msgid "_Hours:"
-msgstr ""
+msgstr "Heures:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
 msgid "_Minutes:"
-msgstr ""
+msgstr "Minutes:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
 msgid "_Seconds:"
-msgstr ""
+msgstr "Secondes:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
 msgid "Full"
@@ -1438,15 +1441,15 @@
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
 msgid "_Swap U and V"
-msgstr ""
+msgstr "Inverser U et V"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:46
 msgid "Show motion _vectors"
-msgstr ""
+msgstr "Montrer les vecteurs de mouvements"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
 msgid "Decoder Options"
-msgstr ""
+msgstr "Options de d?codage"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:41
 msgid "_Swap U&V:"
@@ -1454,60 +1457,60 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:92
 msgid "Select idx file:"
-msgstr ""
+msgstr "Choisir le fichier idx"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:93
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:210
 msgid "Use glyphset (optional):"
-msgstr ""
+msgstr "Utiliser un dictionnaire de symbole (optionnel):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:94
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:211
 msgid "Output SRT file"
-msgstr ""
+msgstr "Fichier de sortie (SRT)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:222
 msgid "Select input and ouput files"
-msgstr ""
+msgstr "Choisir les fichiers"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:115
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:127
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:246
 msgid "The idx/sub file does not exist."
-msgstr ""
+msgstr "Le couple idx/sub n'existe pas"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:120
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:239
 msgid "Please Select a valid output SRT file."
-msgstr ""
+msgstr "Choisissez un fichier SRT de sortie valide."
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:136
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:255
 msgid "Cannot load the glyphset file."
-msgstr ""
+msgstr "Echec du chargement du dictionnaire"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:156
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:276
 msgid "Glyphset filename"
-msgstr ""
+msgstr "Nom du fichier dictionnaire"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:158
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:278
 msgid "Save Glyph"
-msgstr ""
+msgstr "Sauver le dictionnaire"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:208
 msgid "Input TS:"
-msgstr ""
+msgstr "Fichier TS d'entr?e"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:209
 msgid "Subtitle PID:"
-msgstr ""
+msgstr "PID de la piste de sous titre"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:233
 msgid "Please Select a valid TS file."
-msgstr ""
+msgstr "S?lectionnez un fichier TS valide"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
@@ -1768,11 +1771,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:368
 msgid "Use _Global GlyphSet"
-msgstr ""
+msgstr "Utiliser un dictionnaire de symbol global"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:369
 msgid "Gl_yphSet:"
-msgstr ""
+msgstr "Dictionnaire"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:378
 msgid "Automation"
@@ -1805,11 +1808,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:414
 msgid "Global GlyphSet"
-msgstr ""
+msgstr "Dictionnaire global"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:418
 msgid "External Filters"
-msgstr ""
+msgstr "Filtres externes"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:422
 msgid "Preferences"
@@ -1821,43 +1824,43 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
 msgid "_Target type:"
-msgstr ""
+msgstr "Type de cible"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
 msgid "_Source aspect ratio:"
-msgstr ""
+msgstr "Rapport H/L source:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
 msgid "_Destination aspect ratio:"
-msgstr ""
+msgstr "Rapport H/L destination:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
 msgid "_Subtitle file:"
-msgstr ""
+msgstr "Fichier de sous titres:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
 msgid "_Font (TTF):"
-msgstr ""
+msgstr "Fontes (TTF):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
 msgid "_Encoding:"
-msgstr ""
+msgstr "Encodage:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
 msgid "S_elect C_olor"
-msgstr ""
+msgstr "Choisir la couleur"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
 msgid "Set Size and _Position"
-msgstr ""
+msgstr "Choisir la taille et la position"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
 msgid "_Auto split"
-msgstr ""
+msgstr "D?coupe automatique"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
 msgid "_Delay (ms):"
-msgstr ""
+msgstr "Retard (ms)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
 msgid "Subtitler"
@@ -1866,7 +1869,7 @@
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
 msgid "Auto (might not work)"
-msgstr "Auto (ne devrait pas fonctionner)"
+msgstr "Auto (peut ne pas fonctionner)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:46
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
@@ -4041,8 +4044,7 @@
 msgstr "Imposer un niveau maximum de quantificateur"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
-msgid ""
-"Define how much the quantizer rate can change between two consecutive frames"
+msgid "Define how much the quantizer rate can change between two consecutive frames"
 msgstr ""
 "D?finir combien le taux de quantificateur peut changer entre deux frames "
 "cons?cutives"
@@ -4452,8 +4454,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:823
 msgid "Enables special motion estimation features for cartoons/anime"
-msgstr ""
-"Permet l'option d'estimation sp?ciale des mouvement pour les cartoons/anime"
+msgstr "Permet l'option d'estimation sp?ciale des mouvement pour les cartoons/anime"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:825
 msgid "C_hroma optimizer"
@@ -4492,8 +4493,7 @@
 msgstr "Mode VHQ:?"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:880
-msgid ""
-"Higher settings give higher quality results, at the cost of slower encoding"
+msgid "Higher settings give higher quality results, at the cost of slower encoding"
 msgstr ""
 "Plus les r?glages sont haut meilleur sera la qualit?, mais au prix d'un "
 "encodage plus lent"
@@ -4524,8 +4524,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:917
 msgid "VHQ enables an additional search process to increase quality"
-msgstr ""
-"VHQ permet ? un processus de recherche compl?mentaire d'augmenter la qualit?"
+msgstr "VHQ permet ? un processus de recherche compl?mentaire d'augmenter la qualit?"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:921
 msgid "0 - Off"
@@ -4620,8 +4619,7 @@
 "plus pr?cise"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1021
-msgid ""
-"Global Motion Compensation can save bits on camera pans, zooming and rotation"
+msgid "Global Motion Compensation can save bits on camera pans, zooming and rotation"
 msgstr ""
 "La compensation de Mouvement Globale peut ?conomiser des bits sur des prises "
 "de cam?ra, zooms et rotations"
@@ -5840,8 +5838,7 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:198
-msgid ""
-"_Bias (only for display; use 0 for average, 128 for frame minus average):"
+msgid "_Bias (only for display; use 0 for average, 128 for frame minus average):"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp:202
@@ -6636,8 +6633,7 @@
 
 #: avidemux/gtk_gui.cpp:1040
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
-msgstr ""
-"Sauvegarder (A+V) g?n?rera un mauvais AVI. Sauvegarder l'audio fonctionnera."
+msgstr "Sauvegarder (A+V) g?n?rera un mauvais AVI. Sauvegarder l'audio fonctionnera."
 
 #: avidemux/gtk_gui.cpp:1099
 msgid "Something failed when appending"
@@ -6652,8 +6648,7 @@
 msgstr "Ne peut pas sauvegarder l'audio en mode copie"
 
 #: avidemux/gtk_gui.cpp:1172
-msgid ""
-"Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
+msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr ""
 "Choisissez WAV PCM comme codec audio, autrement le fichier audio sera en raw "
 "PCM."
@@ -7018,1371 +7013,3 @@
 "Vous pouvez avoir besoin de la copie intelligente.\n"
 "La permettez-vous??"
 
-#~ msgid "AVI, unp. VOP"
-#~ msgstr "AVI, sans VOP"
-
-#~ msgid "MPEG Video"
-#~ msgstr "MPEG vid?o "
-
-#~ msgid "Unpacking packed bitstream"
-#~ msgstr "Enlever Packed bitstream"
-
-#~ msgid "Select Glyphfile to save to"
-#~ msgstr "S?lection fichier Glyph ? sauvegarder"
-
-#~ msgid "Erase current glyphs ?"
-#~ msgstr "Effacer Glyphe actuel ?"
-
-#~ msgid "Enable _time shift"
-#~ msgstr "Permet le d?calage "
-
-#~ msgid "Time shift _value (ms):"
-#~ msgstr "Valeur d?calage (ms):"
-
-#~ msgid "_Enable resampling"
-#~ msgstr "_Active le r?-?chantillonage"
-
-#~ msgid "_Resampling frequency (Hz):"
-#~ msgstr "_R?-?chantillonage fr?quence (Hz):"
-
-#~ msgid "Video codecs:"
-#~ msgstr "Codecs Vid?o:"
-
-#~ msgid "Audio codecs:"
-#~ msgstr "Codecs audio:"
-
-#~ msgid "Ogg Vorbis"
-#~ msgstr "Ogg Vorbis"
-
-#~ msgid "Miscellaneous libraries:"
-#~ msgstr "Librairies divers:"
-
-#~ msgid "CPU:"
-#~ msgstr "CPU:"
-
-#~ msgid "Hour"
-#~ msgstr "Heure"
-
-#~ msgid "Minutes"
-#~ msgstr "Minutes"
-
-#~ msgid "Seconds"
-#~ msgstr "Seconde "
-
-#~ msgid "Swap U & V:"
-#~ msgstr "Echanger U & V:"
-
-#~ msgid "Show _Vectors:"
-#~ msgstr "Montrer les vecteurs de mouvement:"
-
-#~ msgid "Lavcodec Decoder Configuration"
-#~ msgstr "Configuration Lavcodec Decoder"
-
-#~ msgid "_Swap U & V"
-#~ msgstr "_Echanger U & V:"
-
-#~ msgid "_Number of threads:"
-#~ msgstr "Nombre de fils:"
-
-#~ msgid "Target type"
-#~ msgstr "Type de cible"
-
-#~ msgid "Source aspect ratio"
-#~ msgstr "Ratio de la source"
-
-#~ msgid "Dest. aspect ratio"
-#~ msgstr "Ratio d'Aspect"
-
-#~ msgid "Top Field First"
-#~ msgstr "Trame haute en premier"
-
-#~ msgid "Bottom Field First"
-#~ msgstr "Trame basse en premier"
-
-#~ msgid "Bottom Field (keep top)"
-#~ msgstr "Trame basse (garder le haut)"
-
-#~ msgid "Top Field (keep Bottom)"
-#~ msgstr "Trame haute (garder le bas) "
-
-#~ msgid "Cubic Interpolation"
-#~ msgstr "Interpolation cubique"
-
-#~ msgid "Kernel Interpolation"
-#~ msgstr "Interpolation kernel"
-
-#~ msgid "4 Fields Check"
-#~ msgstr "Contr?le 4 trames "
-
-#~ msgid "5 Fields Check"
-#~ msgstr "Contr?le 5 trames "
-
-#~ msgid "4 Fields Check (no avg)"
-#~ msgstr "Contr?le 4 trames (pas de moyenne) "
-
-#~ msgid "5 Fields Check (no avg)"
-#~ msgstr "Contr?le 5 trames (pas de moyenne) "
-
-#~ msgid "No Link"
-#~ msgstr "Pas de lien "
-
-#~ msgid "Full Link"
-#~ msgstr "Lien complet "
-
-#~ msgid "Use Chroma to evalute"
-#~ msgstr "Utiliser Chroma pour ?valuer"
-
-#~ msgid "Try weave"
-#~ msgstr "Armature d'essai"
-
-#~ msgid "Sharp"
-#~ msgstr "Sharp"
-
-#~ msgid "Evalute all frames"
-#~ msgstr "Evaluer toutes les images"
-
-#~ msgid "Motion threshold, Luma:"
-#~ msgstr "Seuil mouvement, Luma:"
-
-#~ msgid "Motion threshold, Chroma:"
-#~ msgstr "Seuil mouvement, Chroma:"
-
-#~ msgid "Area combing threshold:"
-#~ msgstr "Seuil zone de madrure:"
-
-#~ msgid "Combed threshold:"
-#~ msgstr "Seuil Madrure:"
-
-#~ msgid "Artefact prot. threshold:"
-#~ msgstr "Seuil protection des artefacts:"
-
-#~ msgid "TDEint Configuration"
-#~ msgstr "Configuration TDEint"
-
-#~ msgid "Vob file(s):"
-#~ msgstr "Fichier(s) Vob"
-
-#~ msgid "IFO file:"
-#~ msgstr "Fichier?IFO:"
-
-#~ msgid "Vobsub file:"
-#~ msgstr "Fichier sous-titres Vob:"
-
-#~ msgid "Vob 2 Vobsub"
-#~ msgstr "Vob vers sous-titres Vob"
-
-#~ msgid "VOB file"
-#~ msgstr "Fichier Vob"
-
-#~ msgid "The selected vobfile does not exist."
-#~ msgstr "Le fichier Vob s?lectionn? n'existe pas."
-
-#~ msgid "IFO file"
-#~ msgstr "Fichier IFO"
-
-#~ msgid "The selected IFO file does not exist."
-#~ msgstr "Le fichier IFO s?lection? n'existe pas."
-
-#~ msgid "VobSub file"
-#~ msgstr "Fichier sous-titres vob"
-
-#~ msgid "Select a correct vobsub path/dir."
-#~ msgstr "S?lectionner un chemin correct pour les sous-titres Vob."
-
-#~ msgid "? 2001-2006 Mean"
-#~ msgstr "? 2001-2006 Mean"
-
-#~ msgid ""
-#~ "Avidemux is free software; you can redistribute it and/or modify it \n"
-#~ "under the terms of the GNU General Public License version 2 \n"
-#~ "as published by the Free Software Foundation.\n"
-#~ "\n"
-#~ "\t\t    GNU GENERAL PUBLIC LICENSE\n"
-#~ "\t\t       Version 2, June 1991\n"
-#~ "\n"
-#~ " Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
-#~ "                       51 Franklin St, Fifth Floor, Boston, MA  02110-"
-#~ "1301  USA\n"
-#~ " Everyone is permitted to copy and distribute verbatim copies\n"
-#~ " of this license document, but changing it is not allowed.\n"
-#~ "\n"
-#~ "\t\t\t    Preamble\n"
-#~ "\n"
-#~ "  The licenses for most software are designed to take away your\n"
-#~ "freedom to share and change it.  By contrast, the GNU General Public\n"
-#~ "License is intended to guarantee your freedom to share and change free\n"
-#~ "software--to make sure the software is free for all its users.  This\n"
-#~ "General Public License applies to most of the Free Software\n"
-#~ "Foundation's software and to any other program whose authors commit to\n"
-#~ "using it.  (Some other Free Software Foundation software is covered by\n"
-#~ "the GNU Library General Public License instead.)  You can apply it to\n"
-#~ "your programs, too.\n"
-#~ "\n"
-#~ "  When we speak of free software, we are referring to freedom, not\n"
-#~ "price.  Our General Public Licenses are designed to make sure that you\n"
-#~ "have the freedom to distribute copies of free software (and charge for\n"
-#~ "this service if you wish), that you receive source code or can get it\n"
-#~ "if you want it, that you can change the software or use pieces of it\n"
-#~ "in new free programs; and that you know you can do these things.\n"
-#~ "\n"
-#~ "  To protect your rights, we need to make restrictions that forbid\n"
-#~ "anyone to deny you these rights or to ask you to surrender the rights.\n"
-#~ "These restrictions translate to certain responsibilities for you if you\n"
-#~ "distribute copies of the software, or if you modify it.\n"
-#~ "\n"
-#~ "  For example, if you distribute copies of such a program, whether\n"
-#~ "gratis or for a fee, you must give the recipients all the rights that\n"
-#~ "you have.  You must make sure that they, too, receive or can get the\n"
-#~ "source code.  And you must show them these terms so they know their\n"
-#~ "rights.\n"
-#~ "\n"
-#~ "  We protect your rights with two steps: (1) copyright the software, and\n"
-#~ "(2) offer you this license which gives you legal permission to copy,\n"
-#~ "distribute and/or modify the software.\n"
-#~ "\n"
-#~ "  Also, for each author's protection and ours, we want to make certain\n"
-#~ "that everyone understands that there is no warranty for this free\n"
-#~ "software.  If the software is modified by someone else and passed on, we\n"
-#~ "want its recipients to know that what they have is not the original, so\n"
-#~ "that any problems introduced by others will not reflect on the original\n"
-#~ "authors' reputations.\n"
-#~ "\n"
-#~ "  Finally, any free program is threatened constantly by software\n"
-#~ "patents.  We wish to avoid the danger that redistributors of a free\n"
-#~ "program will individually obtain patent licenses, in effect making the\n"
-#~ "program proprietary.  To prevent this, we have made it clear that any\n"
-#~ "patent must be licensed for everyone's free use or not licensed at all.\n"
-#~ "\n"
-#~ "  The precise terms and conditions for copying, distribution and\n"
-#~ "modification follow.\n"
-#~ "\n"
-#~ "\t\t    GNU GENERAL PUBLIC LICENSE\n"
-#~ "   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
-#~ "\n"
-#~ "  0. This License applies to any program or other work which contains\n"
-#~ "a notice placed by the copyright holder saying it may be distributed\n"
-#~ "under the terms of this General Public License.  The \"Program\", below,\n"
-#~ "refers to any such program or work, and a \"work based on the Program\"\n"
-#~ "means either the Program or any derivative work under copyright law:\n"
-#~ "that is to say, a work containing the Program or a portion of it,\n"
-#~ "either verbatim or with modifications and/or translated into another\n"
-#~ "language.  (Hereinafter, translation is included without limitation in\n"
-#~ "the term \"modification\".)  Each licensee is addressed as \"you\".\n"
-#~ "\n"
-#~ "Activities other than copying, distribution and modification are not\n"
-#~ "covered by this License; they are outside its scope.  The act of\n"
-#~ "running the Program is not restricted, and the output from the Program\n"
-#~ "is covered only if its contents constitute a work based on the\n"
-#~ "Program (independent of having been made by running the Program).\n"
-#~ "Whether that is true depends on what the Program does.\n"
-#~ "\n"
-#~ "  1. You may copy and distribute verbatim copies of the Program's\n"
-#~ "source code as you receive it, in any medium, provided that you\n"
-#~ "conspicuously and appropriately publish on each copy an appropriate\n"
-#~ "copyright notice and disclaimer of warranty; keep intact all the\n"
-#~ "notices that refer to this License and to the absence of any warranty;\n"
-#~ "and give any other recipients of the Program a copy of this License\n"
-#~ "along with the Program.\n"
-#~ "\n"
-#~ "You may charge a fee for the physical act of transferring a copy, and\n"
-#~ "you may at your option offer warranty protection in exchange for a fee.\n"
-#~ "\n"
-#~ "  2. You may modify your copy or copies of the Program or any portion\n"
-#~ "of it, thus forming a work based on the Program, and copy and\n"
-#~ "distribute such modifications or work under the terms of Section 1\n"
-#~ "above, provided that you also meet all of these conditions:\n"
-#~ "\n"
-#~ "    a) You must cause the modified files to carry prominent notices\n"
-#~ "    stating that you changed the files and the date of any change.\n"
-#~ "\n"
-#~ "    b) You must cause any work that you distribute or publish, that in\n"
-#~ "    whole or in part contains or is derived from the Program or any\n"
-#~ "    part thereof, to be licensed as a whole at no charge to all third\n"
-#~ "    parties under the terms of this License.\n"
-#~ "\n"
-#~ "    c) If the modified program normally reads commands interactively\n"
-#~ "    when run, you must cause it, when started running for such\n"
-#~ "    interactive use in the most ordinary way, to print or display an\n"
-#~ "    announcement including an appropriate copyright notice and a\n"
-#~ "    notice that there is no warranty (or else, saying that you provide\n"
-#~ "    a warranty) and that users may redistribute the program under\n"
-#~ "    these conditions, and telling the user how to view a copy of this\n"
-#~ "    License.  (Exception: if the Program itself is interactive but\n"
-#~ "    does not normally print such an announcement, your work based on\n"
-#~ "    the Program is not required to print an announcement.)\n"
-#~ "\n"
-#~ "These requirements apply to the modified work as a whole.  If\n"
-#~ "identifiable sections of that work are not derived from the Program,\n"
-#~ "and can be reasonably considered independent and separate works in\n"
-#~ "themselves, then this License, and its terms, do not apply to those\n"
-#~ "sections when you distribute them as separate works.  But when you\n"
-#~ "distribute the same sections as part of a whole which is a work based\n"
-#~ "on the Program, the distribution of the whole must be on the terms of\n"
-#~ "this License, whose permissions for other licensees extend to the\n"
-#~ "entire whole, and thus to each and every part regardless of who wrote "
-#~ "it.\n"
-#~ "\n"
-#~ "Thus, it is not the intent of this section to claim rights or contest\n"
-#~ "your rights to work written entirely by you; rather, the intent is to\n"
-#~ "exercise the right to control the distribution of derivative or\n"
-#~ "collective works based on the Program.\n"
-#~ "\n"
-#~ "In addition, mere aggregation of another work not based on the Program\n"
-#~ "with the Program (or with a work based on the Program) on a volume of\n"
-#~ "a storage or distribution medium does not bring the other work under\n"
-#~ "the scope of this License.\n"
-#~ "\n"
-#~ "  3. You may copy and distribute the Program (or a work based on it,\n"
-#~ "under Section 2) in object code or executable form under the terms of\n"
-#~ "Sections 1 and 2 above provided that you also do one of the following:\n"
-#~ "\n"
-#~ "    a) Accompany it with the complete corresponding machine-readable\n"
-#~ "    source code, which must be distributed under the terms of Sections\n"
-#~ "    1 and 2 above on a medium customarily used for software interchange; "
-#~ "or,\n"
-#~ "\n"
-#~ "    b) Accompany it with a written offer, valid for at least three\n"
-#~ "    years, to give any third party, for a charge no more than your\n"
-#~ "    cost of physically performing source distribution, a complete\n"
-#~ "    machine-readable copy of the corresponding source code, to be\n"
-#~ "    distributed under the terms of Sections 1 and 2 above on a medium\n"
-#~ "    customarily used for software interchange; or,\n"
-#~ "\n"
-#~ "    c) Accompany it with the information you received as to the offer\n"
-#~ "    to distribute corresponding source code.  (This alternative is\n"
-#~ "    allowed only for noncommercial distribution and only if you\n"
-#~ "    received the program in object code or executable form with such\n"
-#~ "    an offer, in accord with Subsection b above.)\n"
-#~ "\n"
-#~ "The source code for a work means the preferred form of the work for\n"
-#~ "making modifications to it.  For an executable work, complete source\n"
-#~ "code means all the source code for all modules it contains, plus any\n"
-#~ "associated interface definition files, plus the scripts used to\n"
-#~ "control compilation and installation of the executable.  However, as a\n"
-#~ "special exception, the source code distributed need not include\n"
-#~ "anything that is normally distributed (in either source or binary\n"
-#~ "form) with the major components (compiler, kernel, and so on) of the\n"
-#~ "operating system on which the executable runs, unless that component\n"
-#~ "itself accompanies the executable.\n"
-#~ "\n"
-#~ "If distribution of executable or object code is made by offering\n"
-#~ "access to copy from a designated place, then offering equivalent\n"
-#~ "access to copy the source code from the same place counts as\n"
-#~ "distribution of the source code, even though third parties are not\n"
-#~ "compelled to copy the source along with the object code.\n"
-#~ "\n"
-#~ "  4. You may not copy, modify, sublicense, or distribute the Program\n"
-#~ "except as expressly provided under this License.  Any attempt\n"
-#~ "otherwise to copy, modify, sublicense or distribute the Program is\n"
-#~ "void, and will automatically terminate your rights under this License.\n"
-#~ "However, parties who have received copies, or rights, from you under\n"
-#~ "this License will not have their licenses terminated so long as such\n"
-#~ "parties remain in full compliance.\n"
-#~ "\n"
-#~ "  5. You are not required to accept this License, since you have not\n"
-#~ "signed it.  However, nothing else grants you permission to modify or\n"
-#~ "distribute the Program or its derivative works.  These actions are\n"
-#~ "prohibited by law if you do not accept this License.  Therefore, by\n"
-#~ "modifying or distributing the Program (or any work based on the\n"
-#~ "Program), you indicate your acceptance of this License to do so, and\n"
-#~ "all its terms and conditions for copying, distributing or modifying\n"
-#~ "the Program or works based on it.\n"
-#~ "\n"
-#~ "  6. Each time you redistribute the Program (or any work based on the\n"
-#~ "Program), the recipient automatically receives a license from the\n"
-#~ "original licensor to copy, distribute or modify the Program subject to\n"
-#~ "these terms and conditions.  You may not impose any further\n"
-#~ "restrictions on the recipients' exercise of the rights granted herein.\n"
-#~ "You are not responsible for enforcing compliance by third parties to\n"
-#~ "this License.\n"
-#~ "\n"
-#~ "  7. If, as a consequence of a court judgment or allegation of patent\n"
-#~ "infringement or for any other reason (not limited to patent issues),\n"
-#~ "conditions are imposed on you (whether by court order, agreement or\n"
-#~ "otherwise) that contradict the conditions of this License, they do not\n"
-#~ "excuse you from the conditions of this License.  If you cannot\n"
-#~ "distribute so as to satisfy simultaneously your obligations under this\n"
-#~ "License and any other pertinent obligations, then as a consequence you\n"
-#~ "may not distribute the Program at all.  For example, if a patent\n"
-#~ "license would not permit royalty-free redistribution of the Program by\n"
-#~ "all those who receive copies directly or indirectly through you, then\n"
-#~ "the only way you could satisfy both it and this License would be to\n"
-#~ "refrain entirely from distribution of the Program.\n"
-#~ "\n"
-#~ "If any portion of this section is held invalid or unenforceable under\n"
-#~ "any particular circumstance, the balance of the section is intended to\n"
-#~ "apply and the section as a whole is intended to apply in other\n"
-#~ "circumstances.\n"
-#~ "\n"
-#~ "It is not the purpose of this section to induce you to infringe any\n"
-#~ "patents or other property right claims or to contest validity of any\n"
-#~ "such claims; this section has the sole purpose of protecting the\n"
-#~ "integrity of the free software distribution system, which is\n"
-#~ "implemented by public license practices.  Many people have made\n"
-#~ "generous contributions to the wide range of software distributed\n"
-#~ "through that system in reliance on consistent application of that\n"
-#~ "system; it is up to the author/donor to decide if he or she is willing\n"
-#~ "to distribute software through any other system and a licensee cannot\n"
-#~ "impose that choice.\n"
-#~ "\n"
-#~ "This section is intended to make thoroughly clear what is believed to\n"
-#~ "be a consequence of the rest of this License.\n"
-#~ "\n"
-#~ "  8. If the distribution and/or use of the Program is restricted in\n"
-#~ "certain countries either by patents or by copyrighted interfaces, the\n"
-#~ "original copyright holder who places the Program under this License\n"
-#~ "may add an explicit geographical distribution limitation excluding\n"
-#~ "those countries, so that distribution is permitted only in or among\n"
-#~ "countries not thus excluded.  In such case, this License incorporates\n"
-#~ "the limitation as if written in the body of this License.\n"
-#~ "\n"
-#~ "  9. The Free Software Foundation may publish revised and/or new "
-#~ "versions\n"
-#~ "of the General Public License from time to time.  Such new versions will\n"
-#~ "be similar in spirit to the present version, but may differ in detail to\n"
-#~ "address new problems or concerns.\n"
-#~ "\n"
-#~ "Each version is given a distinguishing version number.  If the Program\n"
-#~ "specifies a version number of this License which applies to it and \"any\n"
-#~ "later version\", you have the option of following the terms and "
-#~ "conditions\n"
-#~ "either of that version or of any later version published by the Free\n"
-#~ "Software Foundation.  If the Program does not specify a version number "
-#~ "of\n"
-#~ "this License, you may choose any version ever published by the Free "
-#~ "Software\n"
-#~ "Foundation.\n"
-#~ "\n"
-#~ "  10. If you wish to incorporate parts of the Program into other free\n"
-#~ "programs whose distribution conditions are different, write to the "
-#~ "author\n"
-#~ "to ask for permission.  For software which is copyrighted by the Free\n"
-#~ "Software Foundation, write to the Free Software Foundation; we sometimes\n"
-#~ "make exceptions for this.  Our decision will be guided by the two goals\n"
-#~ "of preserving the free status of all derivatives of our free software "
-#~ "and\n"
-#~ "of promoting the sharing and reuse of software generally.\n"
-#~ "\n"
-#~ "\t\t\t    NO WARRANTY\n"
-#~ "\n"
-#~ "  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO "
-#~ "WARRANTY\n"
-#~ "FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
-#~ "OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
-#~ "PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER "
-#~ "EXPRESSED\n"
-#~ "OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
-#~ "MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK "
-#~ "AS\n"
-#~ "TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
-#~ "PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
-#~ "REPAIR OR CORRECTION.\n"
-#~ "\n"
-#~ "  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN "
-#~ "WRITING\n"
-#~ "WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
-#~ "REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR "
-#~ "DAMAGES,\n"
-#~ "INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES "
-#~ "ARISING\n"
-#~ "OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT "
-#~ "LIMITED\n"
-#~ "TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
-#~ "YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY "
-#~ "OTHER\n"
-#~ "PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
-#~ "POSSIBILITY OF SUCH DAMAGES.\n"
-#~ "\n"
-#~ "\t\t     END OF TERMS AND CONDITIONS\n"
-#~ "\n"
-#~ "\t    How to Apply These Terms to Your New Programs\n"
-#~ "\n"
-#~ "  If you develop a new program, and you want it to be of the greatest\n"
-#~ "possible use to the public, the best way to achieve this is to make it\n"
-#~ "free software which everyone can redistribute and change under these "
-#~ "terms.\n"
-#~ "\n"
-#~ "  To do so, attach the following notices to the program.  It is safest\n"
-#~ "to attach them to the start of each source file to most effectively\n"
-#~ "convey the exclusion of warranty; and each file should have at least\n"
-#~ "the \"copyright\" line and a pointer to where the full notice is found.\n"
-#~ "\n"
-#~ "    <one line to give the program's name and a brief idea of what it does."
-#~ ">\n"
-#~ "    Copyright (C) <year>  <name of author>\n"
-#~ "\n"
-#~ "    This program is free software; you can redistribute it and/or modify\n"
-#~ "    it under the terms of the GNU General Public License as published by\n"
-#~ "    the Free Software Foundation; either version 2 of the License, or\n"
-#~ "    (at your option) any later version.\n"
-#~ "\n"
-#~ "    This program is distributed in the hope that it will be useful,\n"
-#~ "    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
-#~ "    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
-#~ "    GNU General Public License for more details.\n"
-#~ "\n"
-#~ "    You should have received a copy of the GNU General Public License\n"
-#~ "    along with this program; if not, write to the Free Software\n"
-#~ "    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-"
-#~ "1301  USA\n"
-#~ "\n"
-#~ "\n"
-#~ "Also add information on how to contact you by electronic and paper mail.\n"
-#~ "\n"
-#~ "If the program is interactive, make it output a short notice like this\n"
-#~ "when it starts in an interactive mode:\n"
-#~ "\n"
-#~ "    Gnomovision version 69, Copyright (C) year name of author\n"
-#~ "    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show "
-#~ "w'.\n"
-#~ "    This is free software, and you are welcome to redistribute it\n"
-#~ "    under certain conditions; type `show c' for details.\n"
-#~ "\n"
-#~ "The hypothetical commands `show w' and `show c' should show the "
-#~ "appropriate\n"
-#~ "parts of the General Public License.  Of course, the commands you use "
-#~ "may\n"
-#~ "be called something other than `show w' and `show c'; they could even be\n"
-#~ "mouse-clicks or menu items--whatever suits your program.\n"
-#~ "\n"
-#~ "You should also get your employer (if you work as a programmer) or your\n"
-#~ "school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
-#~ "necessary.  Here is a sample; alter the names:\n"
-#~ "\n"
-#~ "  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
-#~ "  `Gnomovision' (which makes passes at compilers) written by James "
-#~ "Hacker.\n"
-#~ "\n"
-#~ "  <signature of Ty Coon>, 1 April 1989\n"
-#~ "  Ty Coon, President of Vice\n"
-#~ "\n"
-#~ "This General Public License does not permit incorporating your program "
-#~ "into\n"
-#~ "proprietary programs.  If your program is a subroutine library, you may\n"
-#~ "consider it more useful to permit linking proprietary applications with "
-#~ "the\n"
-#~ "library.  If this is what you want to do, use the GNU Library General\n"
-#~ "Public License instead of this License."
-#~ msgstr ""
-#~ "Avidemux est un logiciel gratuit et open source; vous pouvez le "
-#~ "redistribuer ou le modifer \n"
-#~ "Sous les termes de la GNU General Public License version 2 \n"
-#~ "est publi? par la Free Software Fondation.\n"
-#~ "\n"
-#~ "\t\t    GNU GENERAL PUBLIC LICENSE\n"
-#~ "\t\t       Version 2, June 1991\n"
-#~ "\n"
-#~ " Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
-#~ "                       51 Franklin St, Fifth Floor, Boston, MA  02110-"
-#~ "1301  USA\n"
-#~ " Everyone is permitted to copy and distribute verbatim copies\n"
-#~ " of this license document, but changing it is not allowed.\n"
-#~ "\n"
-#~ "\t\t\t    Preamble\n"
-#~ "\n"
-#~ "  The licenses for most software are designed to take away your\n"
-#~ "freedom to share and change it.  By contrast, the GNU General Public\n"
-#~ "License is intended to guarantee your freedom to share and change free\n"
-#~ "software--to make sure the software is free for all its users.  This\n"
-#~ "General Public License applies to most of the Free Software\n"
-#~ "Foundation's software and to any other program whose authors commit to\n"
-#~ "using it.  (Some other Free Software Foundation software is covered by\n"
-#~ "the GNU Library General Public License instead.)  You can apply it to\n"
-#~ "your programs, too.\n"
-#~ "\n"
-#~ "  When we speak of free software, we are referring to freedom, not\n"
-#~ "price.  Our General Public Licenses are designed to make sure that you\n"
-#~ "have the freedom to distribute copies of free software (and charge for\n"
-#~ "this service if you wish), that you receive source code or can get it\n"
-#~ "if you want it, that you can change the software or use pieces of it\n"
-#~ "in new free programs; and that you know you can do these things.\n"
-#~ "\n"
-#~ "  To protect your rights, we need to make restrictions that forbid\n"
-#~ "anyone to deny you these rights or to ask you to surrender the rights.\n"
-#~ "These restrictions translate to certain responsibilities for you if you\n"
-#~ "distribute copies of the software, or if you modify it.\n"
-#~ "\n"
-#~ "  For example, if you distribute copies of such a program, whether\n"
-#~ "gratis or for a fee, you must give the recipients all the rights that\n"
-#~ "you have.  You must make sure that they, too, receive or can get the\n"
-#~ "source code.  And you must show them these terms so they know their\n"
-#~ "rights.\n"
-#~ "\n"
-#~ "  We protect your rights with two steps: (1) copyright the software, and\n"
-#~ "(2) offer you this license which gives you legal permission to copy,\n"
-#~ "distribute and/or modify the software.\n"
-#~ "\n"
-#~ "  Also, for each author's protection and ours, we want to make certain\n"
-#~ "that everyone understands that there is no warranty for this free\n"
-#~ "software.  If the software is modified by someone else and passed on, we\n"
-#~ "want its recipients to know that what they have is not the original, so\n"
-#~ "that any problems introduced by others will not reflect on the original\n"
-#~ "authors' reputations.\n"
-#~ "\n"
-#~ "  Finally, any free program is threatened constantly by software\n"
-#~ "patents.  We wish to avoid the danger that redistributors of a free\n"
-#~ "program will individually obtain patent licenses, in effect making the\n"
-#~ "program proprietary.  To prevent this, we have made it clear that any\n"
-#~ "patent must be licensed for everyone's free use or not licensed at all.\n"
-#~ "\n"
-#~ "  The precise terms and conditions for copying, distribution and\n"
-#~ "modification follow.\n"
-#~ "\n"
-#~ "\t\t    GNU GENERAL PUBLIC LICENSE\n"
-#~ "   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
-#~ "\n"
-#~ "  0. This License applies to any program or other work which contains\n"
-#~ "a notice placed by the copyright holder saying it may be distributed\n"
-#~ "under the terms of this General Public License.  The \"Program\", below,\n"
-#~ "refers to any such program or work, and a \"work based on the Program\"\n"
-#~ "means either the Program or any derivative work under copyright law:\n"
-#~ "that is to say, a work containing the Program or a portion of it,\n"
-#~ "either verbatim or with modifications and/or translated into another\n"
-#~ "language.  (Hereinafter, translation is included without limitation in\n"
-#~ "the term \"modification\".)  Each licensee is addressed as \"you\".\n"
-#~ "\n"
-#~ "Activities other than copying, distribution and modification are not\n"
-#~ "covered by this License; they are outside its scope.  The act of\n"
-#~ "running the Program is not restricted, and the output from the Program\n"
-#~ "is covered only if its contents constitute a work based on the\n"
-#~ "Program (independent of having been made by running the Program).\n"
-#~ "Whether that is true depends on what the Program does.\n"
-#~ "\n"
-#~ "  1. You may copy and distribute verbatim copies of the Program's\n"
-#~ "source code as you receive it, in any medium, provided that you\n"
-#~ "conspicuously and appropriately publish on each copy an appropriate\n"
-#~ "copyright notice and disclaimer of warranty; keep intact all the\n"
-#~ "notices that refer to this License and to the absence of any warranty;\n"
-#~ "and give any other recipients of the Program a copy of this License\n"
-#~ "along with the Program.\n"
-#~ "\n"
-#~ "You may charge a fee for the physical act of transferring a copy, and\n"
-#~ "you may at your option offer warranty protection in exchange for a fee.\n"
-#~ "\n"
-#~ "  2. You may modify your copy or copies of the Program or any portion\n"
-#~ "of it, thus forming a work based on the Program, and copy and\n"
-#~ "distribute such modifications or work under the terms of Section 1\n"
-#~ "above, provided that you also meet all of these conditions:\n"
-#~ "\n"
-#~ "    a) You must cause the modified files to carry prominent notices\n"
-#~ "    stating that you changed the files and the date of any change.\n"
-#~ "\n"
-#~ "    b) You must cause any work that you distribute or publish, that in\n"
-#~ "    whole or in part contains or is derived from the Program or any\n"
-#~ "    part thereof, to be licensed as a whole at no charge to all third\n"
-#~ "    parties under the terms of this License.\n"
-#~ "\n"
-#~ "    c) If the modified program normally reads commands interactively\n"
-#~ "    when run, you must cause it, when started running for such\n"
-#~ "    interactive use in the most ordinary way, to print or display an\n"
-#~ "    announcement including an appropriate copyright notice and a\n"
-#~ "    notice that there is no warranty (or else, saying that you provide\n"
-#~ "    a warranty) and that users may redistribute the program under\n"
-#~ "    these conditions, and telling the user how to view a copy of this\n"
-#~ "    License.  (Exception: if the Program itself is interactive but\n"
-#~ "    does not normally print such an announcement, your work based on\n"
-#~ "    the Program is not required to print an announcement.)\n"
-#~ "\n"
-#~ "These requirements apply to the modified work as a whole.  If\n"
-#~ "identifiable sections of that work are not derived from the Program,\n"
-#~ "and can be reasonably considered independent and separate works in\n"
-#~ "themselves, then this License, and its terms, do not apply to those\n"
-#~ "sections when you distribute them as separate works.  But when you\n"
-#~ "distribute the same sections as part of a whole which is a work based\n"
-#~ "on the Program, the distribution of the whole must be on the terms of\n"
-#~ "this License, whose permissions for other licensees extend to the\n"
-#~ "entire whole, and thus to each and every part regardless of who wrote "
-#~ "it.\n"
-#~ "\n"
-#~ "Thus, it is not the intent of this section to claim rights or contest\n"
-#~ "your rights to work written entirely by you; rather, the intent is to\n"
-#~ "exercise the right to control the distribution of derivative or\n"
-#~ "collective works based on the Program.\n"
-#~ "\n"
-#~ "In addition, mere aggregation of another work not based on the Program\n"
-#~ "with the Program (or with a work based on the Program) on a volume of\n"
-#~ "a storage or distribution medium does not bring the other work under\n"
-#~ "the scope of this License.\n"
-#~ "\n"
-#~ "  3. You may copy and distribute the Program (or a work based on it,\n"
-#~ "under Section 2) in object code or executable form under the terms of\n"
-#~ "Sections 1 and 2 above provided that you also do one of the following:\n"
-#~ "\n"
-#~ "    a) Accompany it with the complete corresponding machine-readable\n"
-#~ "    source code, which must be distributed under the terms of Sections\n"
-#~ "    1 and 2 above on a medium customarily used for software interchange; "
-#~ "or,\n"
-#~ "\n"
-#~ "    b) Accompany it with a written offer, valid for at least three\n"
-#~ "    years, to give any third party, for a charge no more than your\n"
-#~ "    cost of physically performing source distribution, a complete\n"
-#~ "    machine-readable copy of the corresponding source code, to be\n"
-#~ "    distributed under the terms of Sections 1 and 2 above on a medium\n"
-#~ "    customarily used for software interchange; or,\n"
-#~ "\n"
-#~ "    c) Accompany it with the information you received as to the offer\n"
-#~ "    to distribute corresponding source code.  (This alternative is\n"
-#~ "    allowed only for noncommercial distribution and only if you\n"
-#~ "    received the program in object code or executable form with such\n"
-#~ "    an offer, in accord with Subsection b above.)\n"
-#~ "\n"
-#~ "The source code for a work means the preferred form of the work for\n"
-#~ "making modifications to it.  For an executable work, complete source\n"
-#~ "code means all the source code for all modules it contains, plus any\n"
-#~ "associated interface definition files, plus the scripts used to\n"
-#~ "control compilation and installation of the executable.  However, as a\n"
-#~ "special exception, the source code distributed need not include\n"
-#~ "anything that is normally distributed (in either source or binary\n"
-#~ "form) with the major components (compiler, kernel, and so on) of the\n"
-#~ "operating system on which the executable runs, unless that component\n"
-#~ "itself accompanies the executable.\n"
-#~ "\n"
-#~ "If distribution of executable or object code is made by offering\n"
-#~ "access to copy from a designated place, then offering equivalent\n"
-#~ "access to copy the source code from the same place counts as\n"
-#~ "distribution of the source code, even though third parties are not\n"
-#~ "compelled to copy the source along with the object code.\n"
-#~ "\n"
-#~ "  4. You may not copy, modify, sublicense, or distribute the Program\n"
-#~ "except as expressly provided under this License.  Any attempt\n"
-#~ "otherwise to copy, modify, sublicense or distribute the Program is\n"
-#~ "void, and will automatically terminate your rights under this License.\n"
-#~ "However, parties who have received copies, or rights, from you under\n"
-#~ "this License will not have their licenses terminated so long as such\n"
-#~ "parties remain in full compliance.\n"
-#~ "\n"
-#~ "  5. You are not required to accept this License, since you have not\n"
-#~ "signed it.  However, nothing else grants you permission to modify or\n"
-#~ "distribute the Program or its derivative works.  These actions are\n"
-#~ "prohibited by law if you do not accept this License.  Therefore, by\n"
-#~ "modifying or distributing the Program (or any work based on the\n"
-#~ "Program), you indicate your acceptance of this License to do so, and\n"
-#~ "all its terms and conditions for copying, distributing or modifying\n"
-#~ "the Program or works based on it.\n"
-#~ "\n"
-#~ "  6. Each time you redistribute the Program (or any work based on the\n"
-#~ "Program), the recipient automatically receives a license from the\n"
-#~ "original licensor to copy, distribute or modify the Program subject to\n"
-#~ "these terms and conditions.  You may not impose any further\n"
-#~ "restrictions on the recipients' exercise of the rights granted herein.\n"
-#~ "You are not responsible for enforcing compliance by third parties to\n"
-#~ "this License.\n"
-#~ "\n"
-#~ "  7. If, as a consequence of a court judgment or allegation of patent\n"
-#~ "infringement or for any other reason (not limited to patent issues),\n"
-#~ "conditions are imposed on you (whether by court order, agreement or\n"
-#~ "otherwise) that contradict the conditions of this License, they do not\n"
-#~ "excuse you from the conditions of this License.  If you cannot\n"
-#~ "distribute so as to satisfy simultaneously your obligations under this\n"
-#~ "License and any other pertinent obligations, then as a consequence you\n"
-#~ "may not distribute the Program at all.  For example, if a patent\n"
-#~ "license would not permit royalty-free redistribution of the Program by\n"
-#~ "all those who receive copies directly or indirectly through you, then\n"
-#~ "the only way you could satisfy both it and this License would be to\n"
-#~ "refrain entirely from distribution of the Program.\n"
-#~ "\n"
-#~ "If any portion of this section is held invalid or unenforceable under\n"
-#~ "any particular circumstance, the balance of the section is intended to\n"
-#~ "apply and the section as a whole is intended to apply in other\n"
-#~ "circumstances.\n"
-#~ "\n"
-#~ "It is not the purpose of this section to induce you to infringe any\n"
-#~ "patents or other property right claims or to contest validity of any\n"
-#~ "such claims; this section has the sole purpose of protecting the\n"
-#~ "integrity of the free software distribution system, which is\n"
-#~ "implemented by public license practices.  Many people have made\n"
-#~ "generous contributions to the wide range of software distributed\n"
-#~ "through that system in reliance on consistent application of that\n"
-#~ "system; it is up to the author/donor to decide if he or she is willing\n"
-#~ "to distribute software through any other system and a licensee cannot\n"
-#~ "impose that choice.\n"
-#~ "\n"
-#~ "This section is intended to make thoroughly clear what is believed to\n"
-#~ "be a consequence of the rest of this License.\n"
-#~ "\n"
-#~ "  8. If the distribution and/or use of the Program is restricted in\n"
-#~ "certain countries either by patents or by copyrighted interfaces, the\n"
-#~ "original copyright holder who places the Program under this License\n"
-#~ "may add an explicit geographical distribution limitation excluding\n"
-#~ "those countries, so that distribution is permitted only in or among\n"
-#~ "countries not thus excluded.  In such case, this License incorporates\n"
-#~ "the limitation as if written in the body of this License.\n"
-#~ "\n"
-#~ "  9. The Free Software Foundation may publish revised and/or new "
-#~ "versions\n"
-#~ "of the General Public License from time to time.  Such new versions will\n"
-#~ "be similar in spirit to the present version, but may differ in detail to\n"
-#~ "address new problems or concerns.\n"
-#~ "\n"
-#~ "Each version is given a distinguishing version number.  If the Program\n"
-#~ "specifies a version number of this License which applies to it and \"any\n"
-#~ "later version\", you have the option of following the terms and "
-#~ "conditions\n"
-#~ "either of that version or of any later version published by the Free\n"
-#~ "Software Foundation.  If the Program does not specify a version number "
-#~ "of\n"
-#~ "this License, you may choose any version ever published by the Free "
-#~ "Software\n"
-#~ "Foundation.\n"
-#~ "\n"
-#~ "  10. If you wish to incorporate parts of the Program into other free\n"
-#~ "programs whose distribution conditions are different, write to the "
-#~ "author\n"
-#~ "to ask for permission.  For software which is copyrighted by the Free\n"
-#~ "Software Foundation, write to the Free Software Foundation; we sometimes\n"
-#~ "make exceptions for this.  Our decision will be guided by the two goals\n"
-#~ "of preserving the free status of all derivatives of our free software "
-#~ "and\n"
-#~ "of promoting the sharing and reuse of software generally.\n"
-#~ "\n"
-#~ "\t\t\t    NO WARRANTY\n"
-#~ "\n"
-#~ "  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO "
-#~ "WARRANTY\n"
-#~ "FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
-#~ "OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
-#~ "PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER "
-#~ "EXPRESSED\n"
-#~ "OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
-#~ "MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK "
-#~ "AS\n"
-#~ "TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
-#~ "PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
-#~ "REPAIR OR CORRECTION.\n"
-#~ "\n"
-#~ "  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN "
-#~ "WRITING\n"
-#~ "WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
-#~ "REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR "
-#~ "DAMAGES,\n"
-#~ "INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES "
-#~ "ARISING\n"
-#~ "OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT "
-#~ "LIMITED\n"
-#~ "TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
-#~ "YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY "
-#~ "OTHER\n"
-#~ "PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
-#~ "POSSIBILITY OF SUCH DAMAGES.\n"
-#~ "\n"
-#~ "\t\t     END OF TERMS AND CONDITIONS\n"
-#~ "\n"
-#~ "\t    How to Apply These Terms to Your New Programs\n"
-#~ "\n"
-#~ "  If you develop a new program, and you want it to be of the greatest\n"
-#~ "possible use to the public, the best way to achieve this is to make it\n"
-#~ "free software which everyone can redistribute and change under these "
-#~ "terms.\n"
-#~ "\n"
-#~ "  To do so, attach the following notices to the program.  It is safest\n"
-#~ "to attach them to the start of each source file to most effectively\n"
-#~ "convey the exclusion of warranty; and each file should have at least\n"
-#~ "the \"copyright\" line and a pointer to where the full notice is found.\n"
-#~ "\n"
-#~ "    <one line to give the program's name and a brief idea of what it does."
-#~ ">\n"
-#~ "    Copyright (C) <year>  <name of author>\n"
-#~ "\n"
-#~ "    This program is free software; you can redistribute it and/or modify\n"
-#~ "    it under the terms of the GNU General Public License as published by\n"
-#~ "    the Free Software Foundation; either version 2 of the License, or\n"
-#~ "    (at your option) any later version.\n"
-#~ "\n"
-#~ "    This program is distributed in the hope that it will be useful,\n"
-#~ "    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
-#~ "    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
-#~ "    GNU General Public License for more details.\n"
-#~ "\n"
-#~ "    You should have received a copy of the GNU General Public License\n"
-#~ "    along with this program; if not, write to the Free Software\n"
-#~ "    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-"
-#~ "1301  USA\n"
-#~ "\n"
-#~ "\n"
-#~ "Also add information on how to contact you by electronic and paper mail.\n"
-#~ "\n"
-#~ "If the program is interactive, make it output a short notice like this\n"
-#~ "when it starts in an interactive mode:\n"
-#~ "\n"
-#~ "    Gnomovision version 69, Copyright (C) year name of author\n"
-#~ "    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show "
-#~ "w'.\n"
-#~ "    This is free software, and you are welcome to redistribute it\n"
-#~ "    under certain conditions; type `show c' for details.\n"
-#~ "\n"
-#~ "The hypothetical commands `show w' and `show c' should show the "
-#~ "appropriate\n"
-#~ "parts of the General Public License.  Of course, the commands you use "
-#~ "may\n"
-#~ "be called something other than `show w' and `show c'; they could even be\n"
-#~ "mouse-clicks or menu items--whatever suits your program.\n"
-#~ "\n"
-#~ "You should also get your employer (if you work as a programmer) or your\n"
-#~ "school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
-#~ "necessary.  Here is a sample; alter the names:\n"
-#~ "\n"
-#~ "  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
-#~ "  `Gnomovision' (which makes passes at compilers) written by James "
-#~ "Hacker.\n"
-#~ "\n"
-#~ "  <signature of Ty Coon>, 1 April 1989\n"
-#~ "  Ty Coon, President of Vice\n"
-#~ "\n"
-#~ "This General Public License does not permit incorporating your program "
-#~ "into\n"
-#~ "proprietary programs.  If your program is a subroutine library, you may\n"
-#~ "consider it more useful to permit linking proprietary applications with "
-#~ "the\n"
-#~ "library.  If this is what you want to do, use the GNU Library General\n"
-#~ "Public License instead of this License."
-
-#~ msgid "Select background picture"
-#~ msgstr "S?lectionner une image de fond"
-
-#~ msgid "Animated Menu"
-#~ msgstr "Menu anim?"
-
-#~ msgid "BackGround Image :"
-#~ msgstr "Image de fond?:"
-
-#~ msgid "Standard"
-#~ msgstr "Standard"
-
-#~ msgid "NTSC (default is PAL)"
-#~ msgstr "NTSC (PAL par d?faut)"
-
-#~ msgid "Vignette Width"
-#~ msgstr "Largeur vignette"
-
-#~ msgid "Vignette Height"
-#~ msgstr "Hauteur vignette"
-
-#~ msgid "<b>General</b>"
-#~ msgstr "<b>G?n?ral</b>"
-
-#~ msgid "Chapter 1"
-#~ msgstr "Chapitre 1"
-
-#~ msgid "Chapter 2"
-#~ msgstr "Chapitre 2"
-
-#~ msgid "Chapter 3"
-#~ msgstr "Chapitre 3"
-
-#~ msgid "Chapter 4"
-#~ msgstr "Chapitre 4"
-
-#~ msgid "Chapter 5"
-#~ msgstr "Chapitre 5"
-
-#~ msgid "Chapter 6"
-#~ msgstr "Chapitre 6"
-
-#~ msgid "Start frame for this vignette."
-#~ msgstr "Image de d?but pour cette vignette"
-
-#~ msgid "<b>TimeCode</b>"
-#~ msgstr "<b>TimeCode</b>"
-
-#~ msgid "Bitrate Calculator"
-#~ msgstr "Calculateur Bitrate"
-
-#~ msgid "Select video to write"
-#~ msgstr "S?lectionner la vid?o ? ecrire"
-
-#~ msgid "Please select or enter a valid filename"
-#~ msgstr "SVP s?lectionner ou entrer un nom de fichier valide"
-
-#~ msgid "Please select or enter a valid jobname"
-#~ msgstr "SVP s?lectionner ou entrer un nom de t?che valide"
-
-#~ msgid "<b>Glyphs</b>"
-#~ msgstr "<b>Glyphes</b>"
-
-#~ msgid "  "
-#~ msgstr "??"
-
-#~ msgid "VobSub"
-#~ msgstr "Sous-titres vob"
-
-#~ msgid "Output Srt"
-#~ msgstr "Tri sortie"
-
-#~ msgid "<b>Files</b>"
-#~ msgstr "<b>Fichier</b>"
-
-#~ msgid "StartOcr"
-#~ msgstr "D?marrer Ocr"
-
-#~ msgid "Calibrate"
-#~ msgstr "Calibrer"
-
-#~ msgid "Skip all"
-#~ msgstr "Sauter tout"
-
-#~ msgid "Ignore glyph"
-#~ msgstr "Ignorer Glyphe"
-
-#~ msgid "Stack Field"
-#~ msgstr "Empiler les champs"
-
-#~ msgid "Subtitle to load"
-#~ msgstr "Sous-Titres ? charger"
-
-#~ msgid "TTF font to use"
-#~ msgstr "Utiliser la police TTF"
-
-#~ msgid "Subtitle selector"
-#~ msgstr "S?lecteur sous-titres"
-
-#~ msgid "Subtitle file "
-#~ msgstr "Fichier sous-titres"
-
-#~ msgid "Font (TTF)"
-#~ msgstr "Police (TTF)"
-
-#~ msgid "Encoding "
-#~ msgstr "Encodage"
-
-#~ msgid "Font Size"
-#~ msgstr "Taille police"
-
-#~ msgid "sub"
-#~ msgstr "sub"
-
-#~ msgid "font"
-#~ msgstr "police"
-
-#~ msgid "Ascii"
-#~ msgstr "ASCII"
-
-#~ msgid "Select color"
-#~ msgstr "S?lectionner couleur"
-
-#~ msgid "Select"
-#~ msgstr "Choisir"
-
-#~ msgid "Auto split"
-#~ msgstr "Auto coupe"
-
-#~ msgid "Delay in ms"
-#~ msgstr "D?lai en ms"
-
-#~ msgid "Force background"
-#~ msgstr "Forcer le fond"
-
-#~ msgid "XVCD encoding"
-#~ msgstr "Encodage XVCD"
-
-#~ msgid "Constant Bitrate"
-#~ msgstr "Bitrate constant"
-
-#~ msgid "Dual pass"
-#~ msgstr "Double passe"
-
-#~ msgid "Min bitrate (kbps) :"
-#~ msgstr "Bitrate Min (kbps)?:"
-
-#~ msgid "Max bitrate (kbps) :"
-#~ msgstr "Bitrate Max (kbps)?:"
-
-#~ msgid "Default mpeg"
-#~ msgstr "MPEG par d?faut"
-
-#~ msgid "Tmpeng "
-#~ msgstr "Tmpeng "
-
-#~ msgid "Anim?"
-#~ msgstr "Anim?"
-
-#~ msgid "K-VCD"
-#~ msgstr "K-VCD"
-
-#~ msgid "Gop Size  (12):"
-#~ msgstr "Taille GOP (12)?:"
-
-#~ msgid "Use Xvid ratecontrol"
-#~ msgstr "Utilise le contr?le du bitrate du XviD"
-
-#~ msgid "Zoom _4:1"
-#~ msgstr "Zoom _4:1"
-
-#~ msgid "_Jump to Frame..."
-#~ msgstr "_Aller ? l'image..."
-
-#~ msgid "Jump to _Time..."
-#~ msgstr "Aller au _temps..."
-
-#~ msgid "/0000000"
-#~ msgstr "/0000000"
-
-#~ msgid "/00:00:00,000"
-#~ msgstr "/00:00:00,000"
-
-#~ msgid "Incorrect output file"
-#~ msgstr "Fichier de sortie incorrect"
-
-#~ msgid "Select SRT to save"
-#~ msgstr "S?lection SRT ? enregistrer"
-
-#~ msgid "Select Glyoh to save"
-#~ msgstr "S?lection Glyphe ? enregistrer"
-
-#~ msgid "No glyphs to save"
-#~ msgstr "Pas de glyphe ? enregistrer"
-
-#~ msgid "Very Low"
-#~ msgstr "Tr?s bas"
-
-#~ msgid "Very High"
-#~ msgstr "Tr?s haut"
-
-#~ msgid "Ultra High"
-#~ msgstr " Ultra haut"
-
-#~ msgid "Motion Search Precision"
-#~ msgstr "Pr?cision recherche de mouvement"
-
-#~ msgid "Off"
-#~ msgstr "Off"
-
-#~ msgid "Mode Decision"
-#~ msgstr " Mode d?cision"
-
-#~ msgid "Limited Search"
-#~ msgstr " Recherche limit?e"
-
-#~ msgid "Medium Search"
-#~ msgstr "Recherche moyenne"
-
-#~ msgid "Wide Search"
-#~ msgstr "Recherche large"
-
-#~ msgid "VHQ Mode"
-#~ msgstr "Mode VHQ"
-
-#~ msgid "Max B Frames"
-#~ msgstr "Image-B max"
-
-#~ msgid "Quarter Pixel"
-#~ msgstr "Quarter Pixel"
-
-#~ msgid "GMC"
-#~ msgstr "GMC"
-
-#~ msgid "BVHQ"
-#~ msgstr "BVHQ"
-
-#~ msgid "4MV"
-#~ msgstr "4MV"
-
-#~ msgid "HQ AC"
-#~ msgstr "HQ AC"
-
-#~ msgid "More Search"
-#~ msgstr "Plus de Recherche"
-
-#~ msgid "Min Gop Size"
-#~ msgstr "Taille GOP min"
-
-#~ msgid "Max Gop Size"
-#~ msgstr "Taille GOP max"
-
-#~ msgid "GOP Size"
-#~ msgstr "Taille GOP"
-
-#~ msgid "H263"
-#~ msgstr "H.263"
-
-#~ msgid "Mpeg"
-#~ msgstr "Mpeg"
-
-#~ msgid "Quantization Matrix"
-#~ msgstr "Matrice de Quantisation"
-
-#~ msgid "Trellis Quantization"
-#~ msgstr "Quantification de treillis"
-
-#~ msgid "Two Pass Tuning"
-#~ msgstr "Deux passes tun?e"
-
-#~ msgid "Curve Compression"
-#~ msgstr "Courbe compression"
-
-#~ msgid "Xvid4 Configuration"
-#~ msgstr "Configuration XviD"
-
-#~ msgid "# Images :%0lu"
-#~ msgstr "# Images :%0lu"
-
-#~ msgid "Time Left :%02d:%02d:%02d"
-#~ msgstr "Temps pass? :%02d:%02d:%02d"
-
-#~ msgid "Select File to Read"
-#~ msgstr "S?lection du fichier ? lire"
-
-#~ msgid "Select File to Write"
-#~ msgstr "S?lectionner le fichier ? ecrire"
-
-#~ msgid "Select Directory"
-#~ msgstr "S?lectionner chemin"
-
-#~ msgid "_Subtitle file (ass/ssa)"
-#~ msgstr "Fichier sous-titres (ass/ssa)"
-
-#~ msgid "_Line spacing"
-#~ msgstr "_Espacement lignes"
-
-#~ msgid "_Font scale"
-#~ msgstr "_Echelle police"
-
-#~ msgid "_Top margin"
-#~ msgstr "_Marge haute"
-
-#~ msgid "_Bottom margin"
-#~ msgstr "_Marge basse"
-
-#~ msgid "threshold"
-#~ msgstr "seuil"
-
-#~ msgid "noise"
-#~ msgstr "bruit"
-
-#~ msgid "If pixel are closer than noise, they are considered to be the same"
-#~ msgstr ""
-#~ "Si les pixels sont proches du seuil de bruit, ils sont consid?r? comme "
-#~ "identiques"
-
-#~ msgid "show"
-#~ msgstr "Montrer"
-
-#~ msgid "Mode"
-#~ msgstr "Mode"
-
-#~ msgid "Quality"
-#~ msgstr "Qualit?"
-
-#~ msgid "Threshold 1"
-#~ msgstr "Seuil 1"
-
-#~ msgid "Threshold 2"
-#~ msgstr "Seuil 2"
-
-#~ msgid "Strategy"
-#~ msgstr "Strat?gie"
-
-#~ msgid "Field Order"
-#~ msgstr "Ordre trame"
-
-#~ msgid "Post Processing"
-#~ msgstr "Post Traitement"
-
-#~ msgid "Try backward"
-#~ msgstr "Essayer champ arri?re"
-
-#~ msgid "Direct Threshold"
-#~ msgstr "Seuil Direct"
-
-#~ msgid "Backward Threshold"
-#~ msgstr "Seuil Arri?re"
-
-#~ msgid "Noise Threshold"
-#~ msgstr "Seuil de bruit"
-
-#~ msgid "Post Proc Threshold"
-#~ msgstr "Post trait. Seuil"
-
-#~ msgid "Use Chroma to decide"
-#~ msgstr "Utiliser chroma pour d?cider"
-
-#~ msgid "Show info"
-#~ msgstr "Montrer info"
-
-#~ msgid "Debug"
-#~ msgstr "Debug"
-
-#~ msgid "Blend"
-#~ msgstr "M?lange"
-
-#~ msgid "Try reverse"
-#~ msgstr "Essayer ? l'envers"
-
-#~ msgid "Angle"
-#~ msgstr "Angle"
-
-#~ msgid "Rotate Params"
-#~ msgstr "Param?tre Rotation"
-
-#~ msgid "Luma Temporal Threshold"
-#~ msgstr "Seuil Temporal Luma"
-
-#~ msgid "Chroma Temporal Threshold"
-#~ msgstr "Seuil Temporal Chroma"
-
-#~ msgid "Bottom Field first"
-#~ msgstr "Trame basse d'abord"
-
-#~ msgid "Order"
-#~ msgstr "Ordre"
-
-#~ msgid "Select ECMAScript to run "
-#~ msgstr "S?lection ECMAscript ? lancer"
-
-#~ msgid "Select AVI file..."
-#~ msgstr "S?lectionner un fichier AVI..."
-
-#~ msgid "Select AVI file to write"
-#~ msgstr "S?lection fichier AVI ? ?crire"
-
-#~ msgid "Select OGM file to write"
-#~ msgstr "S?lection du fichier OGM ? ?crire"
-
-#~ msgid "Select workbench to save"
-#~ msgstr "S?lection projet ? enregistrer"
-
-#~ msgid "Select raw file to save"
-#~ msgstr "S?lection fichier raw ? enregistrer"
-
-#~ msgid "Select AVI file to append..."
-#~ msgstr "S?lection du fichier AVI ? ajouter..."
-
-#~ msgid "Select file to save audio"
-#~ msgstr "S?lection du fichier audio ? enregistrer"
-
-#~ msgid "Select JPEG sequence to save"
-#~ msgstr "S?lection s?quence JPEG ? enregistrer"
-
-#~ msgid "Select BMP to save"
-#~ msgstr "S?lection fichier BMP ? enregistrer"
-
-#~ msgid "Select JPEG to save"
-#~ msgstr "S?lection fichier JPEG ? enregistrer"
-
-#~ msgid "Select file to save"
-#~ msgstr "S?lection du fichier ? enregistrer"
-
-#~ msgid "Select MP3 to load"
-#~ msgstr "S?lection fichier MP3 ? charger"
-
-#~ msgid "Select AC3 to load"
-#~ msgstr "S?lection fichier AC3 ? charger"
-
-#~ msgid "Select WAV to load"
-#~ msgstr "S?lection fichier WAV ? charger"
-
-#~ msgid "Change Frames per Second"
-#~ msgstr "Changer Images par Seconde"
-
-#~ msgid "New FPS?"
-#~ msgstr "Nouveau FPS?"
-
-#~ msgid "Something very wrong happened when buildint joblist"
-#~ msgstr ""
-#~ "Quelque chose de tr?s mauvais c'est pass? duant la construction de la "
-#~ "liste des t?ches"
-
-#~ msgid "Nothing to do."
-#~ msgstr "Rien ? faire."
-
-#~ msgid "There is no jobs stored, nothing to do"
-#~ msgstr "Il n'y a aucune t?che stock?e, donc rien ? faire"



From mean at mail.berlios.de  Fri Nov  2 09:47:05 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 2 Nov 2007 09:47:05 +0100
Subject: [Avidemux-svn-commit] r3678 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs
	ADM_inputs/ADM_mp4 ADM_libraries/ADM_lavcodec
Message-ID: <200711020847.lA28l5F8010288@sheep.berlios.de>

Author: mean
Date: 2007-11-02 09:47:03 +0100 (Fri, 02 Nov 2007)
New Revision: 3678

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
Log:
[Codec] Support for mjpegb

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-11-02 08:47:03 UTC (rev 3678)
@@ -323,7 +323,12 @@
       //    return(decoders *)( new decoderDIVX(w,h));
     }
 
-  if (fourCC::check (fcc, (uint8_t *) "MJPG")
+  if (fourCC::check (fcc, (uint8_t *) "MJPB"))
+    {
+      printf ("\n using FF mjpeg codec\n");
+      return (decoders *) (new decoderFFMjpegB (w, h,extraLen,extraData));
+    }
+if (fourCC::check (fcc, (uint8_t *) "MJPG")
       || fourCC::check (fcc, (uint8_t *) "mjpa"))
     {
 #if  0

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-11-02 08:47:03 UTC (rev 3678)
@@ -644,6 +644,11 @@
   WRAP_Open (CODEC_ID_AMV);
   //_context->codec_id=CODEC_ID_AMV;
 }
+decoderFFMjpegB::decoderFFMjpegB (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,   h)
+{
+  WRAP_Open (CODEC_ID_MJPEGB);
+  //_context->codec_id=CODEC_ID_AMV;
+}
 decoderFFDVBSub::decoderFFDVBSub (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,	   h)
 {
   _context->sub_id=1;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-11-02 08:47:03 UTC (rev 3678)
@@ -327,5 +327,11 @@
 public:
   decoderFFAMV (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
 };
+class decoderFFMjpegB:public decoderFF
+{
+protected:
+public:
+  decoderFFMjpegB (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
+};
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-11-02 08:47:03 UTC (rev 3678)
@@ -553,8 +553,14 @@
                                 //
                                 switch(entryName)
                                 {
-                                  case MKFCCR('s','2','6','3'):  //s263 d263
+                                  case MKFCCR('m','j','p','b'):  //mjpegb
                                   {
+                                        commonPart(MJPB);
+                                        left=0;
+                                  }
+                                  break;
+                                case MKFCCR('s','2','6','3'):  //s263 d263
+                                  {
                                         commonPart(H263);
                                          adm_atom d263(&son);
                                          printf("Reading s253, got %s\n",fourCC::tostringBE(d263.getFCC()));

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-02 08:47:03 UTC (rev 3678)
@@ -31,7 +31,7 @@
                 dvbsub_parser.c
                 dvbsubdec.c
                 dvbsub.c xiph.c
-                sp5xdec.c nellymoserdec.c
+                sp5xdec.c nellymoserdec.c mjpegbdec.c
 )
 # ADD x86 ones
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-11-01 10:15:55 UTC (rev 3677)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-11-02 08:47:03 UTC (rev 3678)
@@ -69,7 +69,7 @@
                 wma.c \
                 dvbsub_parser.c \
                 dvbsubdec.c \
-                dvbsub.c xiph.c sp5xdec.c nellymoserdec.c
+                dvbsub.c xiph.c sp5xdec.c nellymoserdec.c mjpegbdec.c
 
 	
 



From gruntster at mail.berlios.de  Fri Nov  2 11:58:28 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 2 Nov 2007 11:58:28 +0100
Subject: [Avidemux-svn-commit] r3679 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_libraries
Message-ID: <200711021058.lA2AwSGZ022720@sheep.berlios.de>

Author: gruntster
Date: 2007-11-02 11:58:20 +0100 (Fri, 02 Nov 2007)
New Revision: 3679

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
Log:
[Mac] permit build without SDL

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/CMakeLists.txt	2007-11-02 08:47:03 UTC (rev 3678)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/CMakeLists.txt	2007-11-02 10:58:20 UTC (rev 3679)
@@ -23,6 +23,6 @@
 	subdirs (PREORDER ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE)
+if (ADM_OS_APPLE AND USE_SDL)
 	subdirs (PREORDER ADM_libsdl)
-endif (ADM_OS_APPLE)
\ No newline at end of file
+endif (ADM_OS_APPLE AND USE_SDL)
\ No newline at end of file

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-11-02 08:47:03 UTC (rev 3678)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-11-02 10:58:20 UTC (rev 3679)
@@ -192,9 +192,9 @@
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE)
+if (ADM_OS_APPLE AND USE_SDL)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libsdl)
-endif (ADM_OS_APPLE)
+endif (ADM_OS_APPLE AND USE_SDL)
 
 FOREACH(_current ${ADM_LIBRARIES})
 	add_libs_all_targets(${_current})



From gruntster at mail.berlios.de  Fri Nov  2 21:18:33 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 2 Nov 2007 21:18:33 +0100
Subject: [Avidemux-svn-commit] r3680 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_libraries/ADM_lavcodec ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200711022018.lA2KIX05024846@sheep.berlios.de>

Author: gruntster
Date: 2007-11-02 21:18:25 +0100 (Fri, 02 Nov 2007)
New Revision: 3680

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
Log:
[Qt4] different resizing strategy to improve cross-platform compatibility

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-02 10:58:20 UTC (rev 3679)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-02 20:18:25 UTC (rev 3680)
@@ -31,7 +31,7 @@
                 dvbsub_parser.c
                 dvbsubdec.c
                 dvbsub.c xiph.c
-                sp5xdec.c nellymoserdec.c mjpegbdec.c
+                sp5xdec.c nellymoserdec.c
 )
 # ADD x86 ones
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-11-02 10:58:20 UTC (rev 3679)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-11-02 20:18:25 UTC (rev 3680)
@@ -69,7 +69,7 @@
                 wma.c \
                 dvbsub_parser.c \
                 dvbsubdec.c \
-                dvbsub.c xiph.c sp5xdec.c nellymoserdec.c mjpegbdec.c
+                dvbsub.c xiph.c sp5xdec.c nellymoserdec.c
 
 	
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-11-02 10:58:20 UTC (rev 3679)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-11-02 20:18:25 UTC (rev 3680)
@@ -237,6 +237,7 @@
 	ui.setupUi(this);
 
 	this->setStatusBar(0);
+	this->adjustSize();
 
 	// Preview modes
 	QActionGroup *groupPreviewModes = new QActionGroup(this);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-11-02 10:58:20 UTC (rev 3679)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-11-02 20:18:25 UTC (rev 3680)
@@ -163,13 +163,20 @@
 
 	hostFrame->resize(displayW, displayH);
 	videoWindow->resize(displayW, displayH);
+	UI_purge();
 
+	QuiMainWindows->adjustSize();
 	UI_purge();
 
-	// Resize only works every second time so both calls are necessary - don't know why ???
-	QuiMainWindows->resize(1, 1);
-	UI_purge();	
-	QuiMainWindows->resize(1, 1);
+// Trolltech need to get their act together.  Resizing doesn't work well or the same on all platforms.
+#if defined(__APPLE__)
+	// Hack required for Mac to resize properly.  adjustSize() just doesn't cut the mustard.
+	QuiMainWindows->resize(QuiMainWindows->width() + 1, QuiMainWindows->height() + 1);
+#else
+	// resizing doesn't work unless called twice on Windows and Linux.
+	QuiMainWindows->adjustSize();
+#endif
+
 	UI_purge();
 
 	printf("[RDR] Resizing to %u x %u\n", displayW, displayH);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-11-02 10:58:20 UTC (rev 3679)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-11-02 20:18:25 UTC (rev 3680)
@@ -6,8 +6,8 @@
    <rect>
     <x>0</x>
     <y>0</y>
-    <width>828</width>
-    <height>589</height>
+    <width>838</width>
+    <height>543</height>
    </rect>
   </property>
   <property name="windowTitle" >
@@ -456,6 +456,9 @@
             <property name="orientation" >
              <enum>Qt::Vertical</enum>
             </property>
+            <property name="sizeType" >
+             <enum>QSizePolicy::Expanding</enum>
+            </property>
             <property name="sizeHint" >
              <size>
               <width>20</width>
@@ -516,8 +519,8 @@
           </property>
           <property name="sizeHint" >
            <size>
-            <width>1</width>
-            <height>20</height>
+            <width>0</width>
+            <height>0</height>
            </size>
           </property>
          </spacer>
@@ -527,19 +530,6 @@
      </layout>
     </item>
     <item>
-     <spacer>
-      <property name="orientation" >
-       <enum>Qt::Vertical</enum>
-      </property>
-      <property name="sizeHint" >
-       <size>
-        <width>20</width>
-        <height>16777215</height>
-       </size>
-      </property>
-     </spacer>
-    </item>
-    <item>
      <layout class="QHBoxLayout" >
       <property name="margin" >
        <number>0</number>
@@ -556,11 +546,27 @@
          <number>6</number>
         </property>
         <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Vertical</enum>
+          </property>
+          <property name="sizeType" >
+           <enum>QSizePolicy::Expanding</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>0</width>
+            <height>0</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+        <item>
          <widget class="ADM_QSlider" name="horizontalSlider" >
           <property name="sizePolicy" >
            <sizepolicy>
             <hsizetype>7</hsizetype>
-            <vsizetype>1</vsizetype>
+            <vsizetype>0</vsizetype>
             <horstretch>0</horstretch>
             <verstretch>0</verstretch>
            </sizepolicy>
@@ -571,22 +577,6 @@
          </widget>
         </item>
         <item>
-         <spacer>
-          <property name="orientation" >
-           <enum>Qt::Vertical</enum>
-          </property>
-          <property name="sizeType" >
-           <enum>QSizePolicy::Fixed</enum>
-          </property>
-          <property name="sizeHint" >
-           <size>
-            <width>599</width>
-            <height>4</height>
-           </size>
-          </property>
-         </spacer>
-        </item>
-        <item>
          <layout class="QHBoxLayout" >
           <property name="margin" >
            <number>0</number>
@@ -838,22 +828,6 @@
          </layout>
         </item>
         <item>
-         <spacer>
-          <property name="orientation" >
-           <enum>Qt::Vertical</enum>
-          </property>
-          <property name="sizeType" >
-           <enum>QSizePolicy::Fixed</enum>
-          </property>
-          <property name="sizeHint" >
-           <size>
-            <width>599</width>
-            <height>2</height>
-           </size>
-          </property>
-         </spacer>
-        </item>
-        <item>
          <layout class="QHBoxLayout" >
           <property name="margin" >
            <number>0</number>
@@ -1115,12 +1089,12 @@
            <enum>Qt::Vertical</enum>
           </property>
           <property name="sizeType" >
-           <enum>QSizePolicy::MinimumExpanding</enum>
+           <enum>QSizePolicy::Expanding</enum>
           </property>
           <property name="sizeHint" >
            <size>
-            <width>20</width>
-            <height>5</height>
+            <width>0</width>
+            <height>0</height>
            </size>
           </property>
          </spacer>
@@ -1302,6 +1276,22 @@
          <number>4</number>
         </property>
         <item>
+         <spacer>
+          <property name="orientation" >
+           <enum>Qt::Vertical</enum>
+          </property>
+          <property name="sizeType" >
+           <enum>QSizePolicy::Expanding</enum>
+          </property>
+          <property name="sizeHint" >
+           <size>
+            <width>0</width>
+            <height>0</height>
+           </size>
+          </property>
+         </spacer>
+        </item>
+        <item>
          <widget class="QToolButton" name="toolButtonAudioToggle" >
           <property name="enabled" >
            <bool>true</bool>
@@ -1358,8 +1348,8 @@
     <rect>
      <x>0</x>
      <y>0</y>
-     <width>828</width>
-     <height>25</height>
+     <width>838</width>
+     <height>23</height>
     </rect>
    </property>
    <widget class="QMenu" name="menuHelp" >



From mean at mail.berlios.de  Sat Nov  3 16:31:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 3 Nov 2007 16:31:25 +0100
Subject: [Avidemux-svn-commit] r3681 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs
	ADM_libraries/ADM_lavcodec
Message-ID: <200711031531.lA3FVPd0006625@sheep.berlios.de>

Author: mean
Date: 2007-11-03 16:31:25 +0100 (Sat, 03 Nov 2007)
New Revision: 3681

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.c
Log:
[Codec] Try to find a correct middleground for padding bug

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-11-02 20:18:25 UTC (rev 3680)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-11-03 15:31:25 UTC (rev 3681)
@@ -44,7 +44,7 @@
 AVCodec *codec=avcodec_find_decoder(x);\
 if(!codec) {GUI_Alert(QT_TR_NOOP("Internal error finding codec"#x));ADM_assert(0);} \
   codecId=x; \
-  _context->workaround_bugs=0; /* 1*FF_BUG_AUTODETECT+1*FF_BUG_NO_PADDING;*/ \
+  _context->workaround_bugs=1*FF_BUG_AUTODETECT +1*FF_BUG_NO_PADDING;/**/ \
   _context->error_concealment=3; \
   if (avcodec_open(_context, codec) < 0)  \
                       { \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.c	2007-11-02 20:18:25 UTC (rev 3680)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.c	2007-11-03 15:31:25 UTC (rev 3681)
@@ -3122,7 +3122,15 @@
     int bits_count= get_bits_count(&s->gb);
     int v= show_bits(&s->gb, 16);
 
-    if(s->workaround_bugs&FF_BUG_NO_PADDING){
+    // MEANX if( s->workaround_bugs&FF_BUG_NO_PADDING){
+    if(s->lavc_build==4655) // Breaks multithreaded decoding meanx
+    {
+    #if 0
+    #undef printf
+    printf("bugs: %X lavc_build:%d xvid_build:%d divx_version:%d divx_build:%d %s\n",
+               s->workaround_bugs, s->lavc_build, s->xvid_build, s->divx_version, s->divx_build,
+               s->divx_packed ? "p" : "");
+    #endif
         return 0;
     }
 



From gruntster at mail.berlios.de  Mon Nov  5 19:24:26 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 5 Nov 2007 19:24:26 +0100
Subject: [Avidemux-svn-commit] r3682 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200711051824.lA5IOQt1022534@sheep.berlios.de>

Author: gruntster
Date: 2007-11-05 19:24:16 +0100 (Mon, 05 Nov 2007)
New Revision: 3682

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
[Mac] fix Core Audio output

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp	2007-11-03 15:31:25 UTC (rev 3681)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp	2007-11-05 18:24:16 UTC (rev 3682)
@@ -15,131 +15,86 @@
  *                                                                         *
  ***************************************************************************/
 #include "config.h"
-#include <stdio.h>
-#include <stdlib.h>
 
-#include <errno.h>
-  
-#include "fourcc.h" 
- 
 #ifdef __APPLE__
-#include "default.h"
+#include <stdio.h>
+#include <stdlib.h>
 #include <pthread.h>
-
-#include "ADM_toolkit/toolkit.hxx"
-#include <CoreServices/CoreServices.h>
-#include <CoreAudio/CoreAudio.h>
 #include <AudioUnit/AudioUnit.h>
-#include <AudioToolbox/DefaultAudioOutput.h>
 
-#include <ADM_assert.h>
+#include "default.h"
+#include "ADM_assert.h"
 #include "ADM_audiodevice.h"
 #include "ADM_audiodevice/ADM_deviceAudioCore.h"
 #include "ADM_osSupport/ADM_debugID.h"
 #define MODULE_NAME  MODULE_ADEVICE
 #include "ADM_osSupport/ADM_debug.h"
 
-static Component 		comp=NULL;
-static int16_t  		*audioBuffer=NULL;
-static uint32_t 		frameCount=0;
-static AudioUnit 		theOutputUnit;
-static uint32_t			rd_ptr=0;
-static uint32_t			wr_ptr=0;
-static pthread_mutex_t		lock;
 #define BUFFER_SIZE (2*48000)
-//_______________________________________________
-//
-//_______________________________________________
 
-static OSStatus	MyRenderer(void *inRefCon, AudioUnitRenderActionFlags inActionFlags, 
-	const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, 
-	AudioBuffer *ioData);
-static OSStatus OverloadListenerProc(	AudioDeviceID			inDevice,
-		UInt32					inChannel,
-		Boolean					isInput,
-		AudioDevicePropertyID			inPropertyID,
-		void*					inClientData);
+static Component comp = NULL;
+static int16_t audioBuffer[BUFFER_SIZE];
+static AudioUnit theOutputUnit;
+static uint32_t rd_ptr = 0;
+static uint32_t wr_ptr = 0;
+static pthread_mutex_t lock;
 
-//_______________________________________________
-//
-//_______________________________________________
-	
-OSStatus OverloadListenerProc(	AudioDeviceID			inDevice,
-		UInt32					inChannel,
-		Boolean					isInput,
-		AudioDevicePropertyID			inPropertyID,
-		void*					inClientData)
+static OSStatus MyRenderer(void *inRefCon, AudioUnitRenderActionFlags inActionFlags, 
+	const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, AudioBuffer *ioData);
+static OSStatus OverloadListenerProc(AudioDeviceID inDevice, UInt32 inChannel, Boolean isInput,
+	AudioDevicePropertyID inPropertyID, void* inClientData);
+
+OSStatus OverloadListenerProc(AudioDeviceID inDevice, UInt32 inChannel, Boolean isInput,
+	AudioDevicePropertyID inPropertyID, void* inClientData)
 {
-	printf ("* * * * * Overload detected on device playing audio\n");
+	printf ("[CoreAudio] *** Overload detected on device playing audio ***\n");
 	return noErr;
 }
-//_______________________________________________
-//
-//_______________________________________________
 
-uint8_t coreAudioDevice::setVolume(int volume)
-{
-	//TODO
-}
+uint8_t coreAudioDevice::setVolume(int volume) {}
 
-//_______________________________________________
-//
-//_______________________________________________
-
 coreAudioDevice::coreAudioDevice(void) 
 {
-	printf("Creating Darwin coreAudio device\n");
+	printf("[CoreAudio] Creating CoreAudio device\n");
 	_inUse=0;
-	pthread_mutex_init(&lock,NULL);
+	pthread_mutex_init(&lock, NULL);
 	pthread_mutex_unlock(&lock);
 }
-//_______________________________________________
-//
-//_______________________________________________
-uint8_t  coreAudioDevice::stop(void) 
+
+uint8_t coreAudioDevice::stop(void) 
 {
-	if(audioBuffer)
-	{
-		delete [] audioBuffer;
-		audioBuffer=NULL;
-	}
-	if(_inUse)
-	{
+	if (_inUse)
 		verify_noerr(AudioOutputUnitStop(theOutputUnit));
-	}
+
 	// Clean up
 	CloseComponent(theOutputUnit);
 	_inUse=0;
-    	return 1;
+
+	return 1;
 }
-//_______________________________________________
-//
-//_______________________________________________
 
-
-
-OSStatus	MyRenderer(	void 				*inRefCon, 
-				AudioUnitRenderActionFlags 	inActionFlags, 
-				const AudioTimeStamp 		*inTimeStamp, 
-				UInt32 				inBusNumber, 
-				AudioBuffer  			*ioData)
+OSStatus MyRenderer(void *inRefCon, AudioUnitRenderActionFlags inActionFlags, const AudioTimeStamp *inTimeStamp, 
+	UInt32 inBusNumber, AudioBuffer *ioData)
 {
 	pthread_mutex_lock(&lock);
-	uint32_t nb_sample=ioData->mDataByteSize>>1;
-	uint32_t left=0;
-	uint8_t *in,*out;
+	uint32_t nb_sample = ioData->mDataByteSize >> 1;
+	uint32_t left = 0;
+	uint8_t *in, *out;
 
-	in=(uint8_t *)&audioBuffer[rd_ptr];
-	out=(uint8_t *)ioData->mData;
-	aprintf("Audio Core: Fill : rd %lu wr:%lu nb asked:%lu \n",rd_ptr,wr_ptr,nb_sample);
+	in = (uint8_t*)&audioBuffer[rd_ptr];
+	out = (uint8_t*)ioData->mData;
+	aprintf("[CoreAudio] Fill: rd %lu, wr %lu, nb asked %lu\n", rd_ptr, wr_ptr, nb_sample);
+
 	if(wr_ptr>rd_ptr)
 	{
-		left=wr_ptr-rd_ptr-1;	
+		left=wr_ptr-rd_ptr-1;
+
 		if(left>nb_sample)
 		{
 			memcpy(out,in,nb_sample*2);
 			rd_ptr+=nb_sample;
 		}
+
 		else
 		{
 			memcpy(out,in,left*2);
@@ -168,113 +123,89 @@
 			rd_ptr=nb_sample;	
 		}
 	}
+
 	pthread_mutex_unlock(&lock);
 	return 0;
 }
-//_______________________________________________
-//
-//
-//_______________________________________________
+
+#define CHECK_RESULT(msg) \
+    if (err != noErr) \
+	{ \
+		printf("[CoreAudio] Failed to initialise CoreAudio: " msg "\n"); \
+        return 0; \
+    }
+
 uint8_t coreAudioDevice::init(uint8_t channels, uint32_t fq) 
 {
-_channels = channels;
-OSStatus 		err;
-ComponentDescription 	desc;
-AudioUnitInputCallback 	input;
-AudioStreamBasicDescription streamFormat;
-AudioDeviceID 		theDevice;
-UInt32			sz=0;
-UInt32			kFramesPerSlice=512; 
+	_channels = channels;
 
-	desc.componentType = 'aunt';
+	OSStatus err;
+	ComponentDescription desc;
+	AudioUnitInputCallback input;
+	AudioStreamBasicDescription streamFormat;
+	AudioDeviceID theDevice;
+
+	desc.componentType = kAudioUnitComponentType;
 	desc.componentSubType = kAudioUnitSubType_Output;
 	desc.componentManufacturer = kAudioUnitID_DefaultOutput;
 	desc.componentFlags = 0;
 	desc.componentFlagsMask = 0;
-		
-	comp= FindNextComponent(NULL, &desc);
+
+	comp = FindNextComponent(NULL, &desc);
+
 	if (comp == NULL)
 	{
-		printf("coreAudio: Cannot find component\n");
+		printf("[CoreAudio] Failed to find component\n");
 		return 0;
 	}
-		
+
 	err = OpenAComponent(comp, &theOutputUnit);
-	if(err)
-	{
-		printf("coreAudio: Cannot open component\n");
-		return 0;
-	}
-	// Initialize it
-	verify_noerr(AudioUnitInitialize(theOutputUnit));
+	CHECK_RESULT("OpenAComponent")
+
+	err = AudioUnitInitialize(theOutputUnit);
+	CHECK_RESULT("AudioUnitInitialize")
 	
 	// Set up a callback function to generate output to the output unit
-#if 1
 	input.inputProc = MyRenderer;
 	input.inputProcRefCon = NULL;
 	
-	verify_noerr(AudioUnitSetProperty(theOutputUnit, 
+	err = AudioUnitSetProperty(theOutputUnit, 
 					kAudioUnitProperty_SetInputCallback, 
 					kAudioUnitScope_Global,
 					0,
 					&input, 
-					sizeof(input)));
-#endif
-	streamFormat.mSampleRate = fq;		
-	streamFormat.mFormatID = kAudioFormatLinearPCM;	
-	streamFormat.mFormatFlags = kLinearPCMFormatFlagIsSignedInteger 
-								| kLinearPCMFormatFlagIsBigEndian
-								| kLinearPCMFormatFlagIsPacked;
+					sizeof(input));
+	CHECK_RESULT("AudioUnitSetProperty [SetInputCallback]")
 
-	streamFormat.mBytesPerPacket = channels * sizeof (UInt16);	
-	streamFormat.mFramesPerPacket = 1;	
-	streamFormat.mBytesPerFrame = channels * sizeof (UInt16);		
-	streamFormat.mChannelsPerFrame = channels;	
-	streamFormat.mBitsPerChannel = sizeof (UInt16) * 8;	
+	streamFormat.mSampleRate = fq;
+	streamFormat.mFormatID = kAudioFormatLinearPCM;
+	streamFormat.mFormatFlags = kLinearPCMFormatFlagIsSignedInteger | kLinearPCMFormatFlagIsPacked;
+
+	streamFormat.mBytesPerPacket = channels * sizeof (UInt16);
+	streamFormat.mFramesPerPacket = 1;
+	streamFormat.mBytesPerFrame = channels * sizeof (UInt16);
+	streamFormat.mChannelsPerFrame = channels;
+	streamFormat.mBitsPerChannel = sizeof (UInt16) * 8;
 	
-	verify_noerr(AudioUnitSetProperty(
-		theOutputUnit,
+	err = AudioUnitSetProperty(theOutputUnit,
 		kAudioUnitProperty_StreamFormat,
 		kAudioUnitScope_Input,
 		0,
 		&streamFormat,
-		sizeof(AudioStreamBasicDescription)));
+		sizeof(streamFormat));
+	CHECK_RESULT("AudioUnitSetProperty [StreamFormat]")
 	
-	printf("Rendering source:\n\t");
-	printf ("SampleRate=%f,", streamFormat.mSampleRate);
-	printf ("BytesPerPacket=%ld,", streamFormat.mBytesPerPacket);
-	printf ("FramesPerPacket=%ld,", streamFormat.mFramesPerPacket);
-	printf ("BytesPerFrame=%ld,", streamFormat.mBytesPerFrame);
-	printf ("BitsPerChannel=%ld,", streamFormat.mBitsPerChannel);
-	printf ("ChannelsPerFrame=%ld\n", streamFormat.mChannelsPerFrame);
+	printf("[CoreAudio] Rendering source:\n");
+	printf("[CoreAudio] \tSampleRate = %f,\n", streamFormat.mSampleRate);
+	printf("[CoreAudio] \tBytesPerPacket = %ld,\n", streamFormat.mBytesPerPacket);
+	printf("[CoreAudio] \tFramesPerPacket = %ld,\n", streamFormat.mFramesPerPacket);
+	printf("[CoreAudio] \tBytesPerFrame = %ld,\n", streamFormat.mBytesPerFrame);
+	printf("[CoreAudio] \tBitsPerChannel = %ld,\n", streamFormat.mBitsPerChannel);
+	printf("[CoreAudio] \tChannelsPerFrame = %ld\n", streamFormat.mChannelsPerFrame);
 
-	sz=sizeof (theDevice);
-	verify_noerr(AudioUnitGetProperty 
-		(theOutputUnit, kAudioOutputUnitProperty_CurrentDevice, 0, 0, &theDevice, &sz));
-	sz = sizeof (kFramesPerSlice);
-	verify_noerr(AudioDeviceSetProperty(theDevice, 0, 0, false,
-		kAudioDevicePropertyBufferFrameSize, sz, &kFramesPerSlice));
-
-	sz = sizeof (kFramesPerSlice);
-	verify_noerr(AudioDeviceGetProperty(theDevice, 0, false, 
-		kAudioDevicePropertyBufferFrameSize, &sz, &kFramesPerSlice));
-
-	verify_noerr (AudioDeviceAddPropertyListener(theDevice, 0, false,
-		kAudioDeviceProcessorOverload, OverloadListenerProc, 0));
-
-	printf ("size of the device's buffer = %ld frames\n", kFramesPerSlice);
-	
-	frameCount=0;
-	
-	audioBuffer=new int16_t[BUFFER_SIZE]; // between hald a sec and a sec should be enough :)
-	
     return 1;
 }
 
-//_______________________________________________
-//
-//
-//_______________________________________________
 uint8_t coreAudioDevice::play(uint32_t len, float *data)
  {
  	// First put stuff into the buffer
@@ -287,22 +218,20 @@
 
 	// Check we have room left
 	if(wr_ptr>=rd_ptr)
-	{
 		left=BUFFER_SIZE-(wr_ptr-rd_ptr);
-	}
 	else
-	{
 		left=rd_ptr-wr_ptr;
-	}
+
 	if(len+1>left)
 	{
-		printf("AudioCore:Buffer full!\n");
+		printf("[CoreAudio] Buffer full!\n");
 		pthread_mutex_unlock(&lock);
 		return 0;
 	}
 
 	// We have room left, copy it
 	src=(uint8_t *)&audioBuffer[wr_ptr];
+
 	if(wr_ptr+len<BUFFER_SIZE)
 	{
 		memcpy(src,data,len*2);
@@ -317,18 +246,15 @@
 	}
 	//aprintf("AudioCore: Putting %lu bytes rd:%lu wr:%lu \n",len*2,rd_ptr,wr_ptr);
 	pthread_mutex_unlock(&lock);	
- 	if(!frameCount)
-	{
-		_inUse=1;
-		verify_noerr(AudioOutputUnitStart(theOutputUnit));
-	}
+
+	_inUse=1;
+	verify_noerr(AudioOutputUnitStart(theOutputUnit));
+
 	return 1;
 }
 #else
-void dummy_ac_func( void);
-void dummy_ac_func( void)
- {
+void dummy_ac_func(void);
+void dummy_ac_func(void)
+{
 }
-
 #endif
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-11-03 15:31:25 UTC (rev 3681)
+++ branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-11-05 18:24:16 UTC (rev 3682)
@@ -34,8 +34,8 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
-#include <ADM_assert.h>
-#include <ADM_assert.h>
+
+#include "ADM_assert.h"
 #include "config.h"
 
 #include "default.h"
@@ -45,7 +45,6 @@
 #include "ADM_video/ADM_genvideo.hxx"
 #include "ADM_filter/video_filters.h"
 
-
 #include "GUI_render.h"
 
 #include "ADM_osSupport/ADM_debugID.h"

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-11-03 15:31:25 UTC (rev 3681)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-11-05 18:24:16 UTC (rev 3682)
@@ -19,8 +19,7 @@
 #include <string.h>
 #include <stdio.h>
 
-# include <config.h>
-
+#include "config.h"
 #include "default.h"
 
 # include "prefs.h"
@@ -298,37 +297,36 @@
                               ,{3,      QT_TR_NOOP("Pro Logic II"),NULL}
          };
         diaElemMenu menuMixer(&downmix,QT_TR_NOOP("_Local playback downmixing:"), sizeof(mixerEntries)/sizeof(diaMenuEntry),mixerEntries,"");
-#undef MKADID        
-#define MKADID(x) {DEVICE_##x,QT_TR_NOOP(#x),NULL}
-        diaMenuEntry audioEntries[]=
-{
-	
-#ifdef OSS_SUPPORT	
-	MKADID(OSS),
-#endif	
-#ifdef USE_ARTS
-	MKADID(ARTS),
-#endif	
-#ifdef ALSA_SUPPORT
-	MKADID(ALSA),
-#endif	
-#ifdef CONFIG_DARWIN
-	MKADID(COREAUDIO),
-#endif
-#if	defined(USE_SDL) && !defined(ADM_WIN32)	
-	MKADID(SDL),
-#endif	
-#ifdef ADM_WIN32	
-	MKADID(WIN32),
-#endif	
-#ifdef USE_ESD	
-	MKADID(ESD),
-#endif	
-#ifdef USE_JACK
-	MKADID(JACK),
-#endif	
-        MKADID(DUMMY)
-};
+
+		diaMenuEntry audioEntries[] =
+		{
+		#ifdef ALSA_SUPPORT
+			{DEVICE_ALSA, QT_TR_NOOP("ALSA")},
+		#endif
+		#ifdef USE_ARTS
+			{DEVICE_ARTS, QT_TR_NOOP("aRts")},
+		#endif
+		#ifdef CONFIG_DARWIN
+			{DEVICE_COREAUDIO, QT_TR_NOOP("Core Audio")},
+		#endif
+		#ifdef USE_ESD
+			{DEVICE_ESD, QT_TR_NOOP("ESD")},
+		#endif
+		#ifdef USE_JACK
+			{DEVICE_JACK, QT_TR_NOOP("JACK")},
+		#endif
+		#ifdef OSS_SUPPORT
+			{DEVICE_OSS, QT_TR_NOOP("OSS")},
+		#endif
+		#if	defined(USE_SDL) && !defined(ADM_WIN32)
+			{DEVICE_SDL, QT_TR_NOOP("SDL")},
+		#endif
+		#ifdef ADM_WIN32
+			{DEVICE_WIN32, QT_TR_NOOP("Win32")},
+		#endif
+			{DEVICE_DUMMY, QT_TR_NOOP("None")}
+		};
+
         diaElemMenu menuAudio(&newdevice,QT_TR_NOOP("_Audio output:"), sizeof(audioEntries)/sizeof(diaMenuEntry),audioEntries,"");
                 
 #ifdef ALSA_SUPPORT



From mean at mail.berlios.de  Tue Nov  6 19:58:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 6 Nov 2007 19:58:25 +0100
Subject: [Avidemux-svn-commit] r3683 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200711061858.lA6IwPYY024235@sheep.berlios.de>

Author: mean
Date: 2007-11-06 19:58:24 +0100 (Tue, 06 Nov 2007)
New Revision: 3683

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
   branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
Log:
[UI] Repair search black frame

Modified: branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-11-05 18:24:16 UTC (rev 3682)
+++ branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-11-06 18:58:24 UTC (rev 3683)
@@ -87,7 +87,13 @@
 
 /*************************************/
 extern ADM_Composer *video_body;
+/**
 
+*/
+ADMImage *admPreview::getBuffer(void)
+{
+    return rdrImage;
+}
 /**
       \fn admPreview::setMainDimension
       \brief Update width & height of input video

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-11-05 18:24:16 UTC (rev 3682)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-11-06 18:58:24 UTC (rev 3683)
@@ -61,7 +61,8 @@
       static void updateFilters(AVDMGenericVideoStream *first,AVDMGenericVideoStream *last);
       static void deferDisplay(uint32_t onoff,uint32_t startat);
       static void displayNow(uint32_t framenum);
-	  static void cleanUp(void);  
+      static void cleanUp(void);  
+      static ADMImage *getBuffer(void);
 };
 
 uint8_t renderInit( void );

Modified: branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-11-05 18:24:16 UTC (rev 3682)
+++ branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-11-06 18:58:24 UTC (rev 3683)
@@ -158,24 +158,23 @@
 //**********************************************************************
 
 static const int  sliceOrder[8]={3,4,2,5,1,6,0,7};
-
-static int sliceScanNotBlack(int darkness, int maxnonb, int sliceNum)
+/**
+        \fn sliceScanNotBlack
+        \brief The image is split into 8 slices, returns if the given slice is black or not
+*/
+static int sliceScanNotBlack(int darkness, int maxnonb, int sliceNum,ADMImage *img)
 {
 
-  return 0;
-#warning FIXME
-#warning FIXME
-#warning FIXME
-#if 0
-    uint32_t width = avifileinfo->width;
-    uint32_t height = avifileinfo->height>>3;
+
+    uint32_t width = img->_width;
+    uint32_t height = img->_height>>3;
     uint32_t sz = width * height ;    
 
     uint8_t *buff,*start;
 
     int cnt4=0;
 
-    start=rdr_decomp_buffer->data+ sz*sliceNum;
+    start=img->data+ sz*sliceNum;
     buff=start+sz;
 
     while(--buff>start)
@@ -187,16 +186,18 @@
           return(1);
       }
     }
-    //printf("Slice : %d count:%d max:%d\n",sliceNum,cnt4,maxnonb);
     return(0);
-#endif
 
 }
-uint8_t  fastIsNotBlack(int darkness)
+/**
+    \fn fastIsNotBlack
+    \brief Quickly check if the frame is black or not
+*/
+uint8_t  fastIsNotBlack(int darkness,ADMImage *img)
 {
 
-    uint32_t width = avifileinfo->width;
-    uint32_t height = avifileinfo->height;    
+    uint32_t width = img->_width;
+    uint32_t height = img->_height;    
     uint32_t maxnonb=(width* height)>>8;
     
         maxnonb>>=3;
@@ -204,11 +205,11 @@
         // Scan 2 & 3 first, if still good, go on
         for(uint32_t i=0;i<6;i++)
         {
-                if(sliceScanNotBlack(darkness,maxnonb,sliceOrder[i])) return 1;
+                if(sliceScanNotBlack(darkness,maxnonb,sliceOrder[i],img)) return 1;
         }
         // The slice 0 & 7 are particular and we admit twice as much
-        if(sliceScanNotBlack(darkness,maxnonb*2,0)) return 1;
-        if(sliceScanNotBlack(darkness,maxnonb*2,7)) return 1;
+        if(sliceScanNotBlack(darkness,maxnonb*2,0,img)) return 1;
+        if(sliceScanNotBlack(darkness,maxnonb*2,7,img)) return 1;
 
     return(0);
 }
@@ -222,26 +223,32 @@
    uint32_t flags;
    uint16_t reresh_count=0;
    uint32_t orgFrame;
-   uint32_t r=1; 
-#if 0
-    if (playing)
+   uint32_t r=1;
+  if (playing)
 		return;
     if (! avifileinfo)
        return;
 
+    ADMImage *buffer=admPreview::getBuffer();
+    if(!buffer) return;
+
    const int darkness=40;
 
    DIA_working *work=new DIA_working(QT_TR_NOOP("Seeking"));
    orgFrame=curframe;
+   int total;
+    // Avoid it being 0
+    if(dir=1) total=avifileinfo->nb_frames-curframe+1;
+        else total=curframe+1;
    while(1)
    {
-
+        int current=abs(curframe-orgFrame);
       f=curframe+dir;
-      if(work->update(f,avifileinfo->nb_frames)) break;
+      if(work->update(current,total)) break;
 
       if((f==0 && dir==-1)|| (f==avifileinfo->nb_frames-1&&dir==1)) break;
 
-     if( !video_body->getUncompressedFrame(f ,rdr_decomp_buffer,&flags))
+     if( !video_body->getUncompressedFrame(f ,buffer,&flags))
        {
           r=0;
           break;
@@ -253,11 +260,11 @@
     }
         curframe=f;
 
-        if(!fastIsNotBlack(darkness)) break;
+        if(!fastIsNotBlack(darkness,buffer)) break;
         reresh_count++;
         if(reresh_count>100)
         {
-                update_status_bar(rdr_decomp_buffer);
+                update_status_bar();
                 reresh_count=0;
         }       
    }
@@ -265,13 +272,11 @@
    if(!r)
    {
       curframe=orgFrame;
-      video_body->getUncompressedFrame(orgFrame ,rdr_decomp_buffer);
    }
-    admPreview::update( curframe,rdr_decomp_buffer) ;
-    update_status_bar(rdr_decomp_buffer);
+    admPreview::update( curframe) ;
+    update_status_bar();
 
    return ;
-#endif
 }
 uint8_t A_ListAllBlackFrames(char *name)
 {



From mean at mail.berlios.de  Thu Nov  8 19:23:57 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 8 Nov 2007 19:23:57 +0100
Subject: [Avidemux-svn-commit] r3684 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv
Message-ID: <200711081823.lA8INvlI002272@sheep.berlios.de>

Author: mean
Date: 2007-11-08 19:23:57 +0100 (Thu, 08 Nov 2007)
New Revision: 3684

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
Log:
[FLV] ignore no video flag

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2007-11-06 18:58:24 UTC (rev 3683)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2007-11-08 18:23:57 UTC (rev 3684)
@@ -129,7 +129,11 @@
   {
     _isvideopresent=1;
     printf("[FLV] Video flag\n");
-  }else return 0;
+  }else 
+    {
+    GUI_Info_HIG(ADM_LOG_INFO,"Warning","This FLV file says it has no video.\nI will assume it has and try to continue");
+    _isvideopresent=1;
+    }   
   if(flags & 4) // Audio
   {
     _isaudiopresent=1;



From mean at mail.berlios.de  Thu Nov  8 19:37:49 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 8 Nov 2007 19:37:49 +0100
Subject: [Avidemux-svn-commit] r3685 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200711081837.lA8IbnMV003549@sheep.berlios.de>

Author: mean
Date: 2007-11-08 19:37:49 +0100 (Thu, 08 Nov 2007)
New Revision: 3685

Modified:
   branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
Log:
[UI] Repair scan for all black frames too

Modified: branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-11-08 18:23:57 UTC (rev 3684)
+++ branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-11-08 18:37:49 UTC (rev 3685)
@@ -278,12 +278,12 @@
 
    return ;
 }
+/**
+    \fn A_ListAllBlackFrames
+    \brief Scan for all black frames and output that in a separate (text) file
+*/
 uint8_t A_ListAllBlackFrames(char *name)
 {
-  return 0;
-#if 0
-// Print a list of all black frames
-//_____________________________________________________________
     uint32_t f;
     uint32_t flags;
     uint32_t startframe;
@@ -300,7 +300,8 @@
         return 0;
     if ( !avifileinfo )
         return 0;
-
+   ADMImage *buffer=admPreview::getBuffer();
+    if(!buffer) return 0;
    
     if ( !outfile )
         return 0;
@@ -320,14 +321,14 @@
     for (f=0; f<avifileinfo->nb_frames; f++) {
        if( work->update( 100 * f / avifileinfo->nb_frames ) ) 
             break;
-        if ( !video_body->getUncompressedFrame(f,rdr_decomp_buffer,&flags) ) {
-            curframe=0;
-            video_body->getUncompressedFrame(0,rdr_decomp_buffer);
+        if ( !video_body->getUncompressedFrame(f,buffer,&flags) ) 
+        {
             break;
         }
 
         curframe=f;
-        if ( !fastIsNotBlack(darkness) ) {
+        if ( !fastIsNotBlack(darkness,buffer) ) 
+        {
             frame2time(curframe,avifileinfo->fps1000,&hh,&mm,&ss,&ms);
             printf("\tBlack frame: frame %d  time %02d:%02d:%02d.%03d\n", curframe, hh, mm, ss, ms);
             fprintf(fd, "\tBlack frame: frame %d  time %02d:%02d:%02d.%03d\n", curframe, hh, mm, ss, ms);
@@ -335,7 +336,7 @@
         reresh_count++;
         if(reresh_count>100)
         {
-                update_status_bar(rdr_decomp_buffer);
+                update_status_bar();
                 reresh_count=0;
         }
     }
@@ -343,16 +344,8 @@
     printf("** done **\n\n");
     fclose(fd);
     delete work;
-    curframe=startframe;
-    if ( !video_body->getUncompressedFrame(curframe,rdr_decomp_buffer,&flags) ) {
-        curframe=0;
-        video_body->getUncompressedFrame(0,rdr_decomp_buffer);
-    }
-     admPreview::update( curframe,rdr_decomp_buffer) ;
-     update_status_bar(rdr_decomp_buffer);
-
+    GUI_GoToFrame(startframe);
     return 1;
-#endif
 }
 //**********************************************************************
 



From mean at mail.berlios.de  Thu Nov  8 19:38:18 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 8 Nov 2007 19:38:18 +0100
Subject: [Avidemux-svn-commit] r3686 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiodevice
Message-ID: <200711081838.lA8IcIEm003599@sheep.berlios.de>

Author: mean
Date: 2007-11-08 19:38:18 +0100 (Thu, 08 Nov 2007)
New Revision: 3686

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
Log:
[Audio] Kill a bunch of warning

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2007-11-08 18:37:49 UTC (rev 3685)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2007-11-08 18:38:18 UTC (rev 3686)
@@ -35,7 +35,7 @@
 typedef struct 
 {
 	AUDIO_DEVICE id;
-	char	     *name;
+	const char	     *name;
 }DEVICELIST;
 #define MKADID(x) {DEVICE_##x,#x}
 static const DEVICELIST audioDeviceList[]=



From gruntster at mail.berlios.de  Fri Nov  9 17:34:08 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 9 Nov 2007 17:34:08 +0100
Subject: [Avidemux-svn-commit] r3687 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200711091634.lA9GY8oI029283@sheep.berlios.de>

Author: gruntster
Date: 2007-11-09 17:34:00 +0100 (Fri, 09 Nov 2007)
New Revision: 3687

Modified:
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
Log:
[Mac] fix libpng when using MacPorts Qt4

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-11-08 18:38:18 UTC (rev 3686)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-11-09 16:34:00 UTC (rev 3687)
@@ -276,9 +276,13 @@
 		TARGET_LINK_LIBRARIES(avidemux2_gtk png)
 	endif(GTK_FOUND)
 	
-	if(QT4_FOUND AND NOT ADM_OS_APPLE)
-		TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
-	endif(QT4_FOUND AND NOT ADM_OS_APPLE)
+	if (QT4_FOUND)
+		if (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
+		elseif (NOT ADM_OS_APPLE)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
+		endif (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
+	endif (QT4_FOUND)
 endif(USE_PNG)
 
 # Xml2



From gruntster at mail.berlios.de  Fri Nov  9 19:18:24 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 9 Nov 2007 19:18:24 +0100
Subject: [Avidemux-svn-commit] r3688 -
	branches/avidemux_2.4_branch/avidemux/ADM_videoFilter
Message-ID: <200711091818.lA9IIOpj020033@sheep.berlios.de>

Author: gruntster
Date: 2007-11-09 19:18:17 +0100 (Fri, 09 Nov 2007)
New Revision: 3688

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
Log:
[Mac] surfer: subtitle fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2007-11-09 16:34:00 UTC (rev 3687)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2007-11-09 18:18:17 UTC (rev 3688)
@@ -450,8 +450,8 @@
   	}
 	// Get the amound of utf16...
 	done=(ADM_RAW-sout)>>1;
-// For win32 we swap le and be
-#ifdef ADM_WIN32
+// For Win32 and Mac we swap le and be
+#if defined(ADM_WIN32) || defined(__APPLE__)
        ADM_GLYPH_T glyph;
        for(uint32_t w=0;w<done;w++)
        {



From gruntster at mail.berlios.de  Mon Nov 12 13:29:39 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 12 Nov 2007 13:29:39 +0100
Subject: [Avidemux-svn-commit] r3689 - branches
Message-ID: <200711121229.lACCTdQe005704@sheep.berlios.de>

Author: gruntster
Date: 2007-11-12 13:29:32 +0100 (Mon, 12 Nov 2007)
New Revision: 3689

Added:
   branches/avidemux_2.5_branch_gruntster/
Log:
branch creation

Copied: branches/avidemux_2.5_branch_gruntster (from rev 3688, branches/avidemux_2.4_branch)



From gruntster at mail.berlios.de  Wed Nov 14 17:59:48 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 14 Nov 2007 17:59:48 +0100
Subject: [Avidemux-svn-commit] r3690 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux
	avidemux/ADM_libraries avidemux/ADM_libraries/ADM_libass
	avidemux/ADM_libraries/ADM_libswscale
	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video
	avidemux/ADM_videoFilter cmake
Message-ID: <200711141659.lAEGxmTr018686@sheep.berlios.de>

Author: gruntster
Date: 2007-11-14 17:59:14 +0100 (Wed, 14 Nov 2007)
New Revision: 3690

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
Removed:
   branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake
   branches/avidemux_2.5_branch_gruntster/config.h.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
Log:
[CMake] restructured, improved detection of libs and headers, config options now available via CMake GUI, added caching of variables, added verbosity mode

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,212 +1,199 @@
-##########################################################
-# main cmake file for avidemux
-# Derived from the one available in sim-im & kde4
-##########################################################
-MESSAGE("#####################################")
-MESSAGE("Configure Started")
-MESSAGE("#####################################")
-PROJECT(Avidemux2)
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.4)
-SET(CMAKE_COLOR_MAKEFILE ON)
-
-# where to look first for cmake modules, before ${CMAKE_ROOT}/Modules/ is checked
-SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
-# XMingw ?
-OPTION(XMINGW FALSE)
-if(XMINGW)
-MESSAGE(STATUS "Xmingw set, forcing win32 target")
-SET(WIN32 1)
-endif(XMINGW)
-
-#**************************************************
-# MESSAGE
-#**************************************************
-SET(CMAKE_C_FLAGS $ENV{CFLAGS})
-SET(CMAKE_CXX_FLAGS $ENV{CXXFLAGS})
-
-MESSAGE("EXTRA Cflags:${CMAKE_C_FLAGS}")
-MESSAGE("EXTRA CXXflags:${CMAKE_CXX_FLAGS}")
-#*************************************************
-include(UsePkgConfig)
-include(MacroEnsureOutOfSourceBuild)
-include(CheckCXXCompilerFlag)
-
-#**************************************************
-# Subversion
-#**************************************************
-if(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
-	MESSAGE(STATUS "<Checking for Subversion>")
-	MESSAGE(STATUS "<***********************>")
-	include(FindSubversion)
-
-	FIND_PACKAGE(Subversion)
-	IF(Subversion_FOUND)
-		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-		MESSAGE(STATUS "Current revision is ${Project_WC_REVISION}")
-		SET(ADM_SUBVERSION ${Project_WC_REVISION})
-	ELSE(Subversion_FOUND)
-		MESSAGE(STATUS "Could not find Subversion")
-	ENDIF(Subversion_FOUND)
-ENDIF(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
-
-IF(NOT Subversion_FOUND)
-	SET(ADM_SUBVERSION 0)
-ENDIF(NOT Subversion_FOUND)
-
-#**************************************************
-# PKG Config
-#**************************************************
-MESSAGE(STATUS "<Checking for PKG-CONFIG>")
-MESSAGE(STATUS "<***********************>")
-if(NOT PKGCONFIG_EXECUTABLE)
-             MESSAGE(FATAL_ERROR "Could not find pkg-config")
-endif(NOT PKGCONFIG_EXECUTABLE)
-MESSAGE(STATUS "OK ${PKGCONFIG_EXECUTABLE}")
-
-#**************************************************
-# libxml2
-#**************************************************
-MESSAGE(STATUS "<Checking for LibXML2>")
-MESSAGE(STATUS "<*********************>")
-include(FindLibXml2)
-if(NOT LIBXML2_FOUND)
-  MESSAGE(FATAL_ERROR "Could not find Libxml2")
-endif(NOT LIBXML2_FOUND)
-MESSAGE(STATUS "LibXML2 OK")
-
-#**************************************************
-# Search for FREETYPE
-#**************************************************
-MESSAGE(STATUS "<Checking for FreeType through PKG-CONFIG>")
-MESSAGE(STATUS "<****************************************>")
-if(NO_FREETYPE)
-message(status "<disabled per request>")
-else(NO_FREETYPE)
-PKGCONFIG(freetype2 FT_INCLUDE FT_LIB FT_LDFLAGS FT_CFLAGS)
-
-IF(NOT FT_INCLUDE)
-    MESSAGE(STATUS "Could not find Freetype ")
-ELSE(NOT FT_INCLUDE)
-    SET(FT_FOUND TRUE)
-    MESSAGE(STATUS "LDFLAGS <${FT_LDFLAGS}>")
-    MESSAGE(STATUS "LIBS <${FT_LIB}>")
-    MESSAGE(STATUS OK)
-    MESSAGE(STATUS "FreeType Found ("${FT_CFLAGS} ${FT_INCLUDE}")")
-    
-ENDIF(NOT FT_INCLUDE)
-endif(NO_FREETYPE)
-#**************************************************
-# Search for  X11 (not on windows)
-#**************************************************
-if(NOT WIN32)
-        MESSAGE(STATUS "<Checking for X11>")
-        MESSAGE(STATUS "<******************************>")
-        include(FindX11)
-        if(NOT X11_FOUND)
-             MESSAGE(FATAL_ERROR "Could not find X11")
-        endif(NOT X11_FOUND)
-        MESSAGE(STATUS OK)
-endif(NOT WIN32)
-#**************************************************
-# Search for GLIB through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for GLIB>")
-MESSAGE(STATUS "<******************************>")
-PKGCONFIG(glib-2.0 GLIB_INCLUDE GLIB_LIB GLIB_LDFLAGS GLIB_CFLAGS)
-
-IF(NOT GLIB_INCLUDE)
-    MESSAGE(STATUS "Could not find GLIB - cannot compile avidemux2_gtk here")
-ELSE(NOT GLIB_INCLUDE)
-    SET(GLIB_FOUND,TRUE)
-    MESSAGE(STATUS OK)
-    MESSAGE("GLIB Found ("${GLIB_CFLAGS}")")
-    
-ENDIF(NOT GLIB_INCLUDE)
-#**************************************************
-# Search for GTK through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for GTK>")
-MESSAGE(STATUS "<******************************>")
-if(NO_GTK)
-message(status "<disabled per request>")
-else(NO_GTK)
-PKGCONFIG(gtk+-2.0 GTK_INCLUDE GTK_LIB GTK_LDFLAGS GTK_CFLAGS)
-
-IF(NOT GTK_CFLAGS)
-    MESSAGE(STATUS "Could not find GTK - cannot compile avidemux2_gtk here")
-ELSE(NOT GTK_CFLAGS)
-    SET(GTK_FOUND TRUE)
-    MESSAGE(STATUS OK)
-ENDIF(NOT GTK_CFLAGS)
-endif(NO_GTK)
-#**************************************************
-# Search for Gthread through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for Gthread>")
-MESSAGE(STATUS "<******************************>")
-PKGCONFIG(gthread-2.0 GTHREAD_INCLUDE GTHREAD_LIB GTHREAD_LDFLAGS GTHREAD_CFLAGS)
-
-IF(NOT GTHREAD_CFLAGS)
-    MESSAGE(STATUS "Could not find GTHREAD")
-    SET(GTK_FOUND FALSE)
-ELSE(NOT GTHREAD_CFLAGS)
-    SET(GTHREAD_LDFLAGS,${GTHREAD_LDFLAGS})
-    MESSAGE(STATUS "OK ${GTHREAD_LDFLAGS}")
-ENDIF(NOT GTHREAD_CFLAGS)
-#**************************************************
-# Search for QT4 
-#**************************************************
-MESSAGE(STATUS "<Checking for QT4>")
-MESSAGE(STATUS "<******************************>")
-if(NO_QT4)
-message(status "<disabled per request>")
-else(NO_QT4)
-include(FindQt4)
-if(QT4_FOUND AND MINGW)
-if(XMINGW) # Cross compile ?
-        SET(QTXM /rot2/qt_4.3)
-        #
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic-qt4)
-	SET(QT_MOC_EXECUTABLE moc-qt4)
-	SET(QT_RCC_EXECUTABLE rcc)
-	SET(QT_QTGUI_LIBRARY QtGui4 ) # FIXME
-        SET(QT_QTCORE_LIBRARY QtCore4 ) # FIXME
-
-        SET(CMAKE_CXX_FLAGS "-I${QTXM}/include ${CMAKE_CXX_FLAGS}")
-        LINK_DIRECTORIES(${QTXM}/bin)
-        LINK_DIRECTORIES(${QTXM}/lib)
-
-else(XMINGW)
-	MESSAGE(STATUS "** MINGW ** OVERRIDING PATH FOR QT4 You may have to edit CMakeLists.txt!!!")
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic)
-	SET(QT_MOC_EXECUTABLE moc)
-	SET(QT_RCC_EXECUTABLE rcc)
-endif(XMINGW)
-endif(QT4_FOUND AND MINGW)
-endif(NO_QT4)
-
-# do config checks
-include(ConfigureChecks.cmake)
-
-# create config.h
-CONFIGURE_FILE(config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)
-
-include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
-include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
-include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
-
-#**********************************************
-# Some CFLAGS
-#**********************************************
-add_definitions (-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
-add_definitions( -DHAVE_CONFIG_H )
-
-ADD_SUBDIRECTORY(avidemux)
-ADD_SUBDIRECTORY(po)
-
-###############################
-# Summary
-###############################
-include(conf_summary)
+MESSAGE("#####################################")
+MESSAGE("Configure Started")
+MESSAGE("#####################################")
+MESSAGE("")
+
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
+SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
+
+PROJECT(Avidemux)
+
+IF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+	MESSAGE("Please do an out-of-tree build:")
+	MESSAGE("rm CMakeCache.txt; mkdir build; cd build; cmake ..; make")
+	MESSAGE(FATAL_ERROR "in-tree-build detected")
+ENDIF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+
+INCLUDE(CheckCCompilerFlag)
+INCLUDE(CheckCXXCompilerFlag)
+INCLUDE(admConfigHelper)
+
+MESSAGE("")
+
+########################################
+# Global options
+########################################
+OPTION(XMINGW "" OFF)
+OPTION(VERBOSE "" OFF)
+OPTION(LATE_BINDING "" OFF)
+
+IF (XMINGW)
+	SET(WIN32 1)
+ENDIF (XMINGW)
+
+IF (LATE_BINDING)
+	SET(USE_LATE_BINDING 1)
+ENDIF (LATE_BINDING)
+
+########################################
+# Avidemux OS specific tweaks
+########################################
+INCLUDE(admDetermineSystem)
+
+IF (ADM_OS_WINDOWS)
+	SET(CYG_MANGLING 1)
+	SET(ADM_WIN32 1)		# needs to be removed one day...
+	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
+ENDIF (ADM_OS_WINDOWS)
+
+IF (ADM_OS_DARWIN)
+	SET(CMAKE_INCLUDE_PATH "/opt/local/include ${CMAKE_INCLUDE_PATH}")
+	SET(CMAKE_LIBRARY_PATH "/opt/local/lib ${CMAKE_LIBRARY_PATH}")
+
+	SET(CYG_MANGLING 1)
+	SET(ADM_BSD_FAMILY 1)
+ENDIF (ADM_OS_DARWIN)
+
+IF (ADM_OS_LINUX)
+	SET(USE_JOG 1)			# jog shuttle is only available on Linux due to its interface
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# Standard Avidemux defines
+########################################
+SET(VERSION 2.5)
+
+SET(HAVE_BUILTIN_VECTOR 1)
+SET(HAVE_AUDIO 1)
+
+SET(USE_MP3 1)
+SET(USE_AC3 1)
+SET(USE_FFMPEG 1)
+SET(USE_MJPEG 1)
+
+# ARCH_XXX need to be removed from Avidemux code one day and made library specific...
+IF (ADM_CPU_X86)
+	SET(ARCH_X86 1)
+	SET(ARCH_X86_32 1)
+ELSEIF (ADM_CPU_X86_64)
+	SET(ARCH_X86 1)
+	SET(ARCH_X86_64 1)
+	SET(ARCH_64_BITS 1)
+ENDIF (ADM_CPU_X86)
+
+# LibMad
+IF (ADM_CPU_X86)
+	SET(FPM_INTEL 1)
+ELSEIF (ADM_CPU_X86_64)
+	SET(FPM_DEFAULT 1)
+ENDIF (ADM_CPU_X86)
+
+# Libavcodec
+INCLUDE(admSetLavcodecFlags)
+
+# LibMpeg2Dec
+SET(ACCEL_DETECT 1)
+
+########################################
+# Subversion
+########################################
+OPTION(SVN "" ON)
+
+IF (SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
+	MESSAGE(STATUS "Checking for Subversion")
+	MESSAGE(STATUS "***********************")
+
+	FIND_PACKAGE(Subversion)
+
+	IF (Subversion_FOUND)
+		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+		MESSAGE(STATUS "  revision: ${Project_WC_REVISION}")
+		SET(ADM_SUBVERSION ${Project_WC_REVISION})
+	ELSE (Subversion_FOUND)
+		MESSAGE(STATUS "Could not find Subversion")
+	ENDIF (Subversion_FOUND)
+	
+	MESSAGE("")
+ENDIF (SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
+
+IF (NOT Subversion_FOUND)
+	SET(ADM_SUBVERSION 0)
+ENDIF (NOT Subversion_FOUND)
+
+########################################
+# Check for libraries
+########################################
+# Define internal flags for GTK+ and Qt4 builds.  These are turned off
+# if a showstopper is found.  CLI is automatically assumed as possible
+# since it uses the minimum set of required libraries and CMake will 
+# fail if these aren't met.
+SET(ADM_UI_GTK 1)
+SET(ADM_UI_QT4 1)
+
+INCLUDE(admCheckRequiredLibs)
+INCLUDE(admCheckUserInterfaceLibs)
+INCLUDE(admCheckVideoCodecLibs)
+INCLUDE(admCheckAudioCodecLibs)
+INCLUDE(admCheckAudioDeviceLibs)
+INCLUDE(admCheckMiscLibs)
+
+########################################
+# Check functions and includes
+########################################
+MESSAGE(STATUS "Checking system headers")
+MESSAGE(STATUS "***********************")
+
+INCLUDE(CheckIncludeFiles)
+INCLUDE(CheckFunctionExists)
+
+CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
+
+CHECK_INCLUDE_FILES(inttypes.h   HAVE_INTTYPES_H)	# internal use, mpeg2enc, mplex
+CHECK_INCLUDE_FILES(stdint.h     HAVE_STDINT_H)		# internal use, mpeg2enc, mplex
+CHECK_INCLUDE_FILES(sys/types.h  HAVE_SYS_TYPES_H)	# mad, mpeg2enc
+CHECK_INCLUDE_FILES(unistd.h     HAVE_UNISTD_H)		# internal use, ass, mad
+CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# libavcodec, libavutil, libpostproc, libswscale, mplex
+
+MESSAGE("")
+
+########################################
+# Compiler Flags
+########################################
+IF (NOT CMAKE_BUILD_TYPE)
+	SET(CMAKE_BUILD_TYPE "Release")
+ENDIF (NOT CMAKE_BUILD_TYPE)
+
+IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	SET(ADM_DEBUG 1)
+	ADD_DEFINITIONS(-DADM_DEBUG)
+ENDIF(CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+add_definitions(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
+add_definitions(-DHAVE_CONFIG_H)
+
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
+INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
+INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec)
+
+########################################
+# Print Summary
+########################################
+IF (VERBOSE)
+	INCLUDE(adm_log)
+	MESSAGE("")
+ENDIF (VERBOSE)
+
+INCLUDE(admConfigSummary)
+MESSAGE("")
+
+########################################
+# Generate config.h
+########################################
+CONFIGURE_FILE("${CMAKE_MODULE_PATH}/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config.h")
+MESSAGE(STATUS "config.h generated")
+
+########################################
+# Directories to build
+########################################
+ADD_SUBDIRECTORY(avidemux)
+ADD_SUBDIRECTORY(po)
\ No newline at end of file

Deleted: branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,516 +0,0 @@
-########################################
-# CPU and Host
-########################################
-MESSAGE(STATUS "Checking CPU and OS")
-INCLUDE(CMakeDetermineSystem)
-
-IF (WIN32)
-	SET(ADM_OS_WINDOWS 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
-		SET(ADM_CPU_X86 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
-ELSEIF (APPLE)
-	SET(ADM_OS_APPLE 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
-		SET(ADM_CPU_X86 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
-ELSEIF (UNIX)
-	SET(ADM_OS_UNIX 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
-		SET(ADM_CPU_X86 1)
-	ELSEIF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
-		SET(ADM_CPU_X86_64 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
-ENDIF (WIN32)
-
-# Various defines (needs to be removed from Avidemux code one day and be library specific...)
-IF (ADM_CPU_X86)
-	SET(ARCH_X86 1)
-	SET(ARCH_X86_32 1)
-ELSEIF (ADM_CPU_X86_64)
-	SET(ARCH_X86 1)
-	SET(ARCH_X86_64 1)
-	SET(ARCH_64_BITS 1)
-ENDIF (ADM_CPU_X86)
-
-########################################
-# Include CMake scripts
-########################################
-INCLUDE(CheckIncludeFiles)
-INCLUDE(CheckSymbolExists)
-INCLUDE(CheckFunctionExists)
-INCLUDE(CheckLibraryExists)
-INCLUDE(lavcodec)
-INCLUDE(adm_checkHeaderLib)
-INCLUDE(adm_compile)
-
-########################################
-# Mangling
-########################################
-IF (ADM_OS_WINDOWS OR ADM_OS_APPLE)
-	SET(CYG_MANGLING 1)
-ENDIF (ADM_OS_WINDOWS OR ADM_OS_APPLE)
-
-########################################
-# Avidemux OS specific tweaks
-########################################
-IF (ADM_OS_WINDOWS)
-	SET(ADM_WIN32 1)		# needs to be removed one day...
-	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
-ELSE (ADM_OS_WINDOWS)
-	IF (ADM_OS_APPLE)
-		SET(CFLAGS_ORIG $ENV{CFLAGS})
-		SET(CXXFLAGS_ORIG $ENV{CXXFLAGS})
-		
-		SET(ENV{CFLAGS} "-I/opt/local/include -L/opt/local/lib $ENV{CFLAGS}")
-		SET(ENV{CXXFLAGS} "-I/opt/local/include -L/opt/local/lib $ENV{CXXFLAGS}")
-
-		LINK_DIRECTORIES(/opt/local/lib)
-
-		SET(ADM_BSD_FAMILY 1)
-	ENDIF (ADM_OS_APPLE)
-
-	CHECK_FUNCTION_EXISTS(chmod HAVE_CHMOD)         # __homedir/homedir.cpp, gpg/gpg.cpp
-ENDIF (ADM_OS_WINDOWS)
-
-# Jog shuttle is only available on linux due to its interface
-IF(CMAKE_SYSTEM_NAME STREQUAL "Linux")
-        SET(USE_JOG 1)
-ENDIF(CMAKE_SYSTEM_NAME STREQUAL "Linux")
-
-########################################
-# Standard Avidemux defines
-########################################
-SET(VERSION 2.4)
-SET(PACKAGE_VERSION 2.4)
-
-SET(HAVE_BUILTIN_VECTOR 1)
-SET(HAVE_AUDIO 1)
-
-SET(USE_MP3 1)
-SET(USE_AC3 1)
-SET(USE_FFMPEG 1)
-SET(USE_MJPEG 1)
-SET(USE_LIBXML2 1)
-
-########################################
-# Check functions, includes, symbols
-########################################
-CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
-
-CHECK_INCLUDE_FILES(inttypes.h      HAVE_INTTYPES_H)                    # simapi.h
-CHECK_INCLUDE_FILES(stddef.h        HAVE_STDDEF_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdint.h        HAVE_STDINT_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdlib.h        HAVE_STDLIB_H)                      # simapi.h
-CHECK_INCLUDE_FILES(string.h        HAVE_STRING_H)                      # _core/libintl.cpp
-CHECK_INCLUDE_FILES(sys/stat.h      HAVE_SYS_STAT_H)                    # gpg/gpg.cpp
-CHECK_INCLUDE_FILES(sys/types.h     HAVE_SYS_TYPES_H)                   # simapi.h
-CHECK_INCLUDE_FILES(unistd.h        HAVE_UNISTD_H)                      # simapi.h
-CHECK_INCLUDE_FILES(malloc.h        HAVE_MALLOC_H)                      # simapi.h
-
-CHECK_SYMBOL_EXISTS(strcasecmp  "strings.h"         HAVE_STRCASECMP)    # simapi.h, various
-
-########################################
-# LibMad
-########################################
-IF (ADM_CPU_X86)
-	SET(FPM_INTEL 1)
-ELSEIF (ADM_CPU_X86_64)
-	SET(FPM_DEFAULT 1)
-ENDIF (ADM_CPU_X86)
-
-########################################
-# Libavcodec
-########################################
-SET_LAVCODEC_FLAGS()
-
-########################################
-# LibMpeg2Dec
-########################################
-SET(ACCEL_DETECT 1)
-
-########################################
-# Gettext
-########################################
-MESSAGE(STATUS "<Checking gettext>")
-MESSAGE(STATUS "<****************>")
-
-IF (NO_NLS)
-	MESSAGE(STATUS "<disabled per request>")
-ELSE (NO_NLS)
-	FIND_PATH(LIBINTL_H_DIR libintl.h $ENV{CXXFLAGS})
-	MESSAGE(STATUS "libintl Header Path: ${LIBINTL_H_DIR}")
-
-	IF (NOT LIBINTL_H_DIR STREQUAL "LIBINTL_H-NOTFOUND")
-		FIND_LIBRARY(LIBINTL_LIB_DIR intl $ENV{CXXFLAGS})
-		MESSAGE(STATUS "libintl Library Path: ${LIBINTL_LIB_DIR}")
-
-		# Try linking without -lintl
-		ADM_COMPILE(gettext.cpp -I${LIBINTL_H_DIR} "" WITHOUT_LIBINTL outputWithoutLibintl)
-		
-		IF (WITHOUT_LIBINTL)
-			SET(HAVE_GETTEXT 1)
-			MESSAGE(STATUS "Ok, No lib needed (${ADM_GETTEXT_LIB})")
-		ELSE (WITHOUT_LIBINTL)
-			ADM_COMPILE(gettext.cpp -I${LIBINTL_H_DIR} ${LIBINTL_LIB_DIR} WITH_LIBINTL outputWithLibintl)
-			
-			IF (WITH_LIBINTL)
-				SET(ADM_GETTEXT_LIB ${LIBINTL_LIB_DIR})
-				SET(HAVE_GETTEXT 1)
-				
-				MESSAGE(STATUS "Ok, libintl needed")
-			ELSE (WITH_LIBINTL)
-				MESSAGE(STATUS "Does not work, without ${outputWithoutLibintl}")
-				MESSAGE(STATUS "Does not work, with ${outputWithLibintl}")
-			ENDIF (WITH_LIBINTL)
-		ENDIF (WITHOUT_LIBINTL)
-	ENDIF (NOT LIBINTL_H_DIR STREQUAL "LIBINTL_H-NOTFOUND")
-
-	IF (HAVE_GETTEXT)
-		SET(ADM_GETTEXT_INCLUDE -I${LIBINTL_H_DIR})
-	ENDIF(HAVE_GETTEXT)
-ENDIF (NO_NLS)
-
-########################################
-# Locale
-########################################
-SET(ADM_LOCALE "${CMAKE_INSTALL_PREFIX}/share/locale")
-
-########################################
-# ALSA
-########################################
-IF (ADM_OS_UNIX)
-	MESSAGE(STATUS "<Checking for ALSA>")
-	MESSAGE(STATUS "<*****************>")
-	IF (NO_ALSA)
-		MESSAGE(STATUS "<disabled per request>")
-	ELSE (NO_ALSA)
-		INCLUDE(FindAlsa)
-		
-		IF (ALSA_FOUND)
-			ALSA_VERSION_STRING(alsaVersion)
-			
-			MESSAGE("Found alsa version :${alsaVersion}") 
-			MESSAGE("Found alsa lib     :${ASOUND_LIBRARY}")
-			
-			SET(ALSA_SUPPORT 1)
-			SET(ALSA_1_0_SUPPORT 1)
-		ENDIF (ALSA_FOUND)
-	ENDIF (NO_ALSA)
-ENDIF (ADM_OS_UNIX)
-
-########################################
-# SDL
-########################################
-MESSAGE(STATUS "<Checking for SDL>")
-MESSAGE(STATUS "<*****************>")
-
-INCLUDE(admSDL)
-
-IF (NO_SDL)
-	MESSAGE(STATUS "<disabled per request>")
-ELSE (NO_SDL)
-	include(FindSDL)
-
-	IF (SDL_FOUND)
-		SET(USE_SDL 1)
-		
-		MESSAGE(STATUS "Found")
-	ELSE (SDL_FOUND)
-		MESSAGE(STATUS "Not Found")
-	ENDIF (SDL_FOUND)
-	
-	MESSAGE(STATUS "Flags: -I${SDL_INCLUDE_DIR}")
-	MESSAGE(STATUS "Libraries: ${SDL_LIBRARY}")
-ENDIF (NO_SDL)
-
-########################################
-# FONTCONFIG
-########################################
-ADM_CHECK_HL(FontConfig fontconfig/fontconfig.h fontconfig FcStrSetCreate USE_FONTCONFIG)
-
-IF (USE_FONTCONFIG)
-	SET(HAVE_FONTCONFIG 1)
-ENDIF (USE_FONTCONFIG)
-
-########################################
-# Xvideo
-########################################
-IF (NOT NO_XV AND NOT ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS "-include X11/Xlib.h")
-	SET(CMAKE_REQUIRED_LIBRARIES "${X11_LIBRARIES}")
-	SET(CMAKE_REQUIRED_INCLUDE "${X11_INCLUDE_DIR}")
-
-	ADM_CHECK_HL(Xvideo X11/extensions/Xvlib.h Xv XvShmPutImage USE_XV)
-	
-	MESSAGE(STATUS "Flags: ${CMAKE_REQUIRED_FLAGS} ${X11_INCLUDE_DIR}")
-	MESSAGE(STATUS "Libraries: ${X11_LIBRARIES}")
-
-	SET(CMAKE_REQUIRED_FLAGS)
-	SET(CMAKE_REQUIRED_LIBRARIES)
-	SET(CMAKE_REQUIRED_INCLUDE)
-ENDIF (NOT NO_XV AND NOT ADM_OS_WINDOWS)
-
-########################################
-# OSS
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	MESSAGE(STATUS "<Checking for OSS>")
-	MESSAGE(STATUS "<*****************>")
-	
-	IF (NO_OSS)
-		MESSAGE(STATUS "<disabled per request>")
-	ELSE (NO_OSS)
-		CHECK_INCLUDE_FILES(sys/soundcard.h OSS_SUPPORT)
-		
-		IF (OSS_SUPPORT)
-			MESSAGE(STATUS "Found")
-		ELSE (OSS_SUPPORT)
-			MESSAGE(STATUS "Not found")
-		ENDIF (OSS_SUPPORT)
-	ENDIF (NO_OSS)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# ARTS
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	INCLUDE(FindArts)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# ESD
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	ADM_CHECK_HL(Esd esd.h  esd esd_close USE_ESD)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# JACK
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	ADM_CHECK_HL(Jack jack/jack.h  jack jack_client_close USE_JACK)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# Aften
-########################################
-IF (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS "-lm -lpthreadGC2")
-ELSE (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS "-lm -lpthread")
-ENDIF (ADM_OS_WINDOWS)
-
-ADM_CHECK_HL(Aften aften/aften.h aften aften_encode_init USE_AFTEN)
-
-IF (USE_AFTEN)
-	FIND_LIBRARY(AFTEN_LIB_PATH NAMES aften $ENV{CXXFLAGS})
-
-	TRY_RUN(AFTEN_TEST_RUN_RESULT
-		AFTEN_TEST_COMPILE_RESULT
-		${CMAKE_BINARY_DIR}
-		"${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp"
-		CMAKE_FLAGS -DLINK_LIBRARIES=${AFTEN_LIB_PATH})
-
-	IF (AFTEN_TEST_RUN_RESULT EQUAL 8)
-		MESSAGE(STATUS "Aften Version: 0.0.8")
-		SET(USE_AFTEN_08 1)
-	ELSEIF (AFTEN_TEST_RUN_RESULT EQUAL 7)
-		MESSAGE(STATUS "Aften Version: 0.07")
-		SET(USE_AFTEN_07 1)
-	ELSE (AFTEN_TEST_RUN_RESULT EQUAL 8)
-		MESSAGE(STATUS "Warning: Unable to determine Aften version - support for Aften will be turned off")
-		SET(USE_AFTEN 0)
-	ENDIF (AFTEN_TEST_RUN_RESULT EQUAL 8)
-ENDIF (USE_AFTEN)
-
-SET(CMAKE_REQUIRED_FLAGS "")
-
-########################################
-# Secret Rabbit Code
-########################################
-ADM_CHECK_HL(libsamplerate samplerate.h samplerate src_get_version USE_SRC)
-
-########################################
-# ICONV
-########################################
-MESSAGE(STATUS "<Checking for iconv.h>")
-MESSAGE(STATUS "<******************************>")
-
-CHECK_INCLUDE_FILES(iconv.h HAVE_ICONV_H)
-
-IF (NOT HAVE_ICONV_H)
-	MESSAGE(FATAL "iconv.h not found")
-ENDIF (NOT HAVE_ICONV_H)
-
-# need libiconv ?
-CHECK_LIBRARY_EXISTS(iconv libiconv "" LINK_WITH_ICONV)
-
-IF (LINK_WITH_ICONV)
-	SET(NEED_LIBICONV 1)
-	MESSAGE(STATUS "libiconv found, probably needed")
-ELSE (LINK_WITH_ICONV)
-	MESSAGE(STATUS "libiconv not found, probably not needed")
-ENDIF (LINK_WITH_ICONV)
-
-MESSAGE(STATUS "<Checking if iconv needs const>")
-
-IF (NEED_LIBICONV)
-	ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-liconv" ICONV_WITH)
-ELSE (NEED_LIBICONV)
-	ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-lm" ICONV_WITH)
-ENDIF (NEED_LIBICONV)
-
-IF (ICONV_WITH)
-	MESSAGE(STATUS "Yes")
-	SET(ICONV_NEED_CONST 1)
-ELSE (ICONV_WITH)
-    MESSAGE(STATUS "No")
-ENDIF(ICONV_WITH)
-
-########################################
-# LAME
-########################################
-SET(CMAKE_REQUIRED_LIBRARIES "-lm")
-ADM_CHECK_HL(Lame lame/lame.h mp3lame lame_init HAVE_LIBMP3LAME)
-SET(CMAKE_REQUIRED_LIBRARIES)
-
-########################################
-# Xvid
-########################################
-ADM_CHECK_HL(Xvid xvid.h xvidcore xvid_plugin_single USE_XVID_4)
-
-########################################
-# AMR_NB
-########################################
-IF (USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(amrnb/interf_dec.h USE_AMR_NB)
-ELSE (USE_LATE_BINDING)
-	ADM_CHECK_HL(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode USE_AMR_NB)
-ENDIF (USE_LATE_BINDING)
-
-IF (USE_AMR_NB)
-	SET(CONFIG_AMR_NB 1)
-ENDIF (USE_AMR_NB)
-
-########################################
-# Libdca
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-SET(CMAKE_REQUIRED_LIBRARIES "-lm")
-
-IF (USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(dts.h USE_LIBDCA)
-ELSE (USE_LATE_BINDING)
-	ADM_CHECK_HL(libdca dts.h dts dts_init USE_LIBDCA)
-ENDIF (USE_LATE_BINDING)
-
-SET(CMAKE_REQUIRED_LIBRARIES)
-SET(CMAKE_REQUIRED_FLAGS)
-
-########################################
-# X264
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-
-IF (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthreadGC2")
-ELSE (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthread")
-ENDIF (ADM_OS_WINDOWS)
-
-ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
-SET(CMAKE_REQUIRED_FLAGS)
-SET(CMAKE_REQUIRED_LIBRARIES)
-
-########################################
-# PNG
-########################################
-ADM_CHECK_HL(libPNG png.h png png_malloc USE_PNG)
-
-########################################
-# FAAD
-########################################
-ADM_CHECK_HL(FAAD faad.h faad faacDecInit USE_FAAD_P)
-
-IF(NOT USE_FAAD_P)
-	MESSAGE(STATUS "Trying neaac variant")
-	ADM_CHECK_HL(NeAAC faad.h faad NeAACDecInit USE_FAAD_A)
-ENDIF(NOT USE_FAAD_P)
-
-IF(USE_FAAD_P OR USE_FAAD_A)
-	SET(USE_FAAD  1)
-ENDIF(USE_FAAD_P OR USE_FAAD_A)
-
-# See if we need old FAAD or new
-IF (USE_FAAD)
-	FIND_PATH(FAAD_H_DIR faad.h $ENV{CXXFLAGS})
-	FIND_LIBRARY(FAAD_LIB_DIR faad $ENV{CXXFLAGS})
-	
-	MESSAGE(STATUS "<Checking if faad needs old proto>")
-	ADM_COMPILE_WITH_WITHOUT(faad_check.cpp "-DOLD_FAAD_PROTO -I${FAAD_H_DIR}" "${FAAD_LIB_DIR}" FAAD_WITH)
-	
-	IF(FAAD_WITH)
-		MESSAGE(STATUS "Yes")
-		SET(OLD_FAAD_PROTO 1)
-	ELSE (FAAD_WITH)
-		MESSAGE(STATUS "No")
-	ENDIF (FAAD_WITH)
-ENDIF(USE_FAAD)
-
-########################################
-# FAAC
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-ADM_CHECK_HL(FAAC faac.h faac faacEncClose USE_FAAC)
-SET(CMAKE_REQUIRED_FLAGS)
-
-########################################
-# FreeType
-########################################
-IF (FT_FOUND)
-	SET(USE_FREETYPE 1)
-ENDIF (FT_FOUND)
-
-########################################
-# Vorbis
-########################################
-ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbis vorbis_info_init USE_VORBIS1)
-ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbisenc vorbis_encode_init USE_VORBIS2)
-
-IF (USE_VORBIS1 AND USE_VORBIS2)
-	SET(USE_VORBIS 1)
-ENDIF (USE_VORBIS1 AND USE_VORBIS2)
-
-########################################
-# End test
-########################################
-ADM_CHECK_HL(Invalid dummy_header.h dummy_libxyz dummy_func_tyu DUMMY_TEST)
-ADM_CHECK_HL(Invalid stdio.h dummy_libxyz dummy_func_tyu DUMMY_TEST2)
-
-IF (DUMMY_TEST OR DUMMY_TEST2)
-	MESSAGE(FATAL "This test should have failed!!!")
-	MESSAGE(FATAL "This test should have failed!!!")
-	MESSAGE(FATAL "This test should have failed!!!")
-ENDIF (DUMMY_TEST OR DUMMY_TEST2)
-
-INCLUDE(adm_log)
-
-IF (NOT CMAKE_BUILD_TYPE)
-	SET(CMAKE_BUILD_TYPE "Release")
-ENDIF (NOT CMAKE_BUILD_TYPE)
-
-IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
-	MESSAGE(STATUS "** DEBUG BUILD (${CMAKE_BUILD_TYPE})**")
-	
-	SET(ADM_DEBUG 1)
-	ADD_DEFINITIONS(-DADM_DEBUG)
-ELSE (CMAKE_BUILD_TYPE STREQUAL "Debug")
-	MESSAGE(STATUS "** RELEASE BUILD (${CMAKE_BUILD_TYPE})**")
-ENDIF(CMAKE_BUILD_TYPE STREQUAL "Debug")
-
-MESSAGE("LINK_FLAGS ${CMAKE_LD_FLAGS}")
-# EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -3,15 +3,16 @@
 ################################
 include(AdmLib)
 SET(ADM_LIB ADM_libass)
-#
-if(FT_FOUND)
-SET(${ADM_LIB}_SRCS 
-ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
-ass_font.c
-)
-ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
-ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
-endif(FT_FOUND)
 
-################################
-ADD_definitions(${FT_CFLAGS} )
+if(USE_FREETYPE)
+	SET(${ADM_LIB}_SRCS 
+	ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
+	ass_font.c
+	)
+	ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+	ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
+	
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
+################################
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -11,12 +11,12 @@
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
 ADD_DEFINITIONS(-DCONFIG_GPL -fomit-frame-pointer)
 
-IF (ADM_OS_APPLE)
+IF (ADM_OS_DARWIN)
 	ADD_DEFINITIONS(-DPIC)
 	
 	IF (ADM_DEBUG)
 		ADD_DEFINITIONS(-O2)
 	ENDIF (ADM_DEBUG)
-ENDIF (ADM_OS_APPLE)
+ENDIF (ADM_OS_DARWIN)
 
 ################################

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -23,6 +23,6 @@
 	subdirs (PREORDER ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE AND USE_SDL)
+if (ADM_OS_DARWIN AND USE_SDL)
 	subdirs (PREORDER ADM_libsdl)
-endif (ADM_OS_APPLE AND USE_SDL)
\ No newline at end of file
+endif (ADM_OS_DARWIN AND USE_SDL)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-11-14 16:59:14 UTC (rev 3690)
@@ -31,8 +31,6 @@
 #undef HAVE_INTTYPES_H
 #undef HAVE_MALLOC_H
 #undef HAVE_STDINT_H
-#undef HAVE_STDLIB_H
-#undef HAVE_STRING_H
 #undef HAVE_SYS_TYPES_H
 #include "SDL.h"
 #include "SDL_syswm.h"

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -17,7 +17,9 @@
 ADM_vidNull.cpp          
 )
 ADD_LIBRARY(ADM_video STATIC ${ADM_video_SRCS})
-if(FT_FOUND)
-add_definitions(${FT_CFLAGS})
-endif(FT_FOUND)
+
+if(USE_FREETYPE)
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
 include_directories(../ADM_inputs)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,55 +1,57 @@
-
-SET(ADM_videoFilter_SRCS 
-ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp    
-ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
-ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp     
-ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
-ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp     
-ADM_vidReverse.cpp        ADM_vidVlad.cpp
-ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp  
-ADM_vidRotate.cpp         ADM_vidWhirl.cpp
-ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp   
-ADM_vidSeparateField.cpp  ADM_vidYadif.cpp
-ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp    
-ADM_vidSoften.cpp
-ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp   
-ADM_vidStabilize.cpp
-ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp   
-ADM_vidSwapFields.cpp
-ADM_vidYadif_asm.c
-ADM_guiResize.cpp  ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
-ADM_vidMPLResize.cpp  
-ADM_vidResize25.cpp
-ADM_vidTdeint.cpp
-ADM_vidChromaShift.cpp  
-ADM_vidAnimated.cpp
-ADM_vidDvbSub.cpp
-ADM_vidLogo.cpp
-ADM_vidHue.cpp
-ADM_vidSRT.cpp
-ADM_vidSRTload.cpp
-ADM_vidSRTRender.cpp
-ADM_vidCrop.cpp       
-ADM_vidEq2.cpp      
-ADM_vidContrast.cpp 
-ADM_vidDelta.cpp 
-ADM_vidUnblend.cpp 
-ADM_vidAsharp.cpp
-ADM_vidVobsub.cpp
-ADM_vidVobSubRender.cpp
-ADM_vobsubinfo.cpp
-ADM_vidComputeAverage.cpp
-ADM_vidSwissArmyKnife.cpp
-ADM_vidThreshold.cpp
-ADM_vidParticle.cpp
-
-)
-ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})
-if(FT_FOUND)
-add_definitions(${FT_CFLAGS})
-endif(FT_FOUND)
-include_directories(../ADM_inputs)
-
-IF (ADM_OS_APPLE AND ADM_DEBUG)
+
+SET(ADM_videoFilter_SRCS 
+ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp    
+ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
+ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp     
+ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
+ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp     
+ADM_vidReverse.cpp        ADM_vidVlad.cpp
+ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp  
+ADM_vidRotate.cpp         ADM_vidWhirl.cpp
+ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp   
+ADM_vidSeparateField.cpp  ADM_vidYadif.cpp
+ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp    
+ADM_vidSoften.cpp
+ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp   
+ADM_vidStabilize.cpp
+ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp   
+ADM_vidSwapFields.cpp
+ADM_vidYadif_asm.c
+ADM_guiResize.cpp  ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
+ADM_vidMPLResize.cpp  
+ADM_vidResize25.cpp
+ADM_vidTdeint.cpp
+ADM_vidChromaShift.cpp  
+ADM_vidAnimated.cpp
+ADM_vidDvbSub.cpp
+ADM_vidLogo.cpp
+ADM_vidHue.cpp
+ADM_vidSRT.cpp
+ADM_vidSRTload.cpp
+ADM_vidSRTRender.cpp
+ADM_vidCrop.cpp       
+ADM_vidEq2.cpp      
+ADM_vidContrast.cpp 
+ADM_vidDelta.cpp 
+ADM_vidUnblend.cpp 
+ADM_vidAsharp.cpp
+ADM_vidVobsub.cpp
+ADM_vidVobSubRender.cpp
+ADM_vobsubinfo.cpp
+ADM_vidComputeAverage.cpp
+ADM_vidSwissArmyKnife.cpp
+ADM_vidThreshold.cpp
+ADM_vidParticle.cpp
+
+)
+ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})
+
+if(USE_FREETYPE)
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
+include_directories(../ADM_inputs)
+
+IF (ADM_OS_DARWIN AND ADM_DEBUG)
 	SET_SOURCE_FILES_PROPERTIES(ADM_vidYadif_asm.c PROPERTIES COMPILE_FLAGS "-O2")
-ENDIF (ADM_OS_APPLE AND ADM_DEBUG)
\ No newline at end of file
+ENDIF (ADM_OS_DARWIN AND ADM_DEBUG)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -24,18 +24,6 @@
 	endif(QT4_FOUND)
 ENDMACRO (add_libs_all_targets _libName)
 
-MACRO (add_link_flags _target _flg)
-	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
-
-	if (_flags)
-		set(_flags "${_flags} ${_flg}")
-	else (_flags)
-		set(_flags "${_flg}")
-	endif (_flags)
-
-	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS "${_flags}")
-ENDMACRO (add_link_flags)
-
 MACRO (add_ldflags_all_targets _libName)
 	add_link_flags(avidemux2_cli ${_libName})
 
@@ -48,18 +36,6 @@
 	endif(QT4_FOUND)
 ENDMACRO (add_ldflags_all_targets _libName)
 
-MACRO (add_compile_flags _target _flg)
-	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
-
-	if (_flags)
-		set(_flags "${_flags} ${_flg}")
-	else (_flags)
-		set(_flags "${_flg}")
-	endif (_flags)
-   
-	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")   
-ENDMACRO (add_compile_flags)
-
 ########################################################
 # Our exectuables
 ########################################################
@@ -192,9 +168,9 @@
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE AND USE_SDL)
+if (ADM_OS_DARWIN AND USE_SDL)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libsdl)
-endif (ADM_OS_APPLE AND USE_SDL)
+endif (ADM_OS_DARWIN AND USE_SDL)
 
 FOREACH(_current ${ADM_LIBRARIES})
 	add_libs_all_targets(${_current})
@@ -244,54 +220,52 @@
 # Add external libs
 ###########################################
 #iconv
-if(NEEED_LIBICONV)
-	add_libs_all_targets(iconv)
-endif(NEEED_LIBICONV)
+add_libs_all_targets("${LIBICONV_LIBRARY_DIR}")
 
 #gettext
-if(ADM_GETTEXT_LIB)
-	INCLUDE_DIRECTORIES(${ADM_GETTEXT_INCLUDE})
-	TARGET_LINK_LIBRARIES(avidemux2_cli ${ADM_GETTEXT_LIB})
+if (GETTEXT_FOUND)
+	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
+	TARGET_LINK_LIBRARIES(avidemux2_cli "${GETTEXT_LIBRARY_DIR}")
 
 	if(GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ADM_GETTEXT_LIB})
+		TARGET_LINK_LIBRARIES(avidemux2_gtk "${GETTEXT_LIBRARY_DIR}")
 	endif(GTK_FOUND)
-endif(ADM_GETTEXT_LIB)
+endif (GETTEXT_FOUND)
 
 #freetype
 if(USE_FREETYPE)
-	add_libs_all_targets(${FT_LDFLAGS})
+	add_libs_all_targets("${FREETYPE2_LDFLAGS}")
 endif(USE_FREETYPE)
 
 #fontconfig
 if(USE_FONTCONFIG)
-	add_libs_all_targets(fontconfig)
+	add_libs_all_targets("${FONTCONFIG_LIBRARY_DIR}")
 endif(USE_FONTCONFIG)
 
 # png
 if(USE_PNG)
-	TARGET_LINK_LIBRARIES(avidemux2_cli png)
+	TARGET_LINK_LIBRARIES(avidemux2_cli ${PNG_LIBRARIES})
 	
 	if(GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk png)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${PNG_LIBRARIES})
 	endif(GTK_FOUND)
 	
 	if (QT4_FOUND)
-		if (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
-			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
-		elseif (NOT ADM_OS_APPLE)
-			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
-		endif (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
+		if (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
+		elseif (NOT ADM_OS_DARWIN)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
+		endif (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
 	endif (QT4_FOUND)
 endif(USE_PNG)
 
 # Xml2
-add_libs_all_targets(xml2)
+add_libs_all_targets("${LIBXML2_LIBRARIES}")
 
 #XVideo 
 if(USE_XV)
 	add_libs_all_targets("${X11_LIBRARIES}")
-	add_libs_all_targets(Xv)
+	add_libs_all_targets("{$XVIDEO_LIBRARY}")
 endif(USE_XV)
 
 # SDL
@@ -311,63 +285,63 @@
 
 # ESD
 if(USE_ESD)
-	add_libs_all_targets(esd)
+	add_libs_all_targets("${ESD_LIBRARY}")
 endif(USE_ESD)
 
 # JACK
 if(USE_JACK)
-	add_libs_all_targets(jack)
+	add_libs_all_targets("${JACK_LIBRARY_DIR}")
 endif(USE_JACK)
 
 # libAMRNB
 if(USE_AMR_NB AND NOT USE_LATE_BINDING)
-	add_libs_all_targets(amrnb)
+	add_libs_all_targets("${AMRNB_LIBRARY_DIR}")
 endif(USE_AMR_NB AND NOT USE_LATE_BINDING)
 
 #libdts
 if(USE_LIBDCA AND NOT USE_LATE_BINDING)
-	add_libs_all_targets(dts)
+	add_libs_all_targets("${LIBDCA_LIBRARY_DIR}")
 endif(USE_LIBDCA AND NOT USE_LATE_BINDING)
 
 # Lame
 if(HAVE_LIBMP3LAME)
-	add_libs_all_targets(mp3lame)
+	add_libs_all_targets("${LAME_LIBRARY_DIR}")
 endif(HAVE_LIBMP3LAME)
 
 # Vorbis
 if(USE_VORBIS)
-	add_libs_all_targets(vorbis)
-	add_libs_all_targets(vorbisenc)
+	add_libs_all_targets("${VORBIS_LIBRARY_DIR}")
+	add_libs_all_targets("${VORBISENC_LIBRARY_DIR}")
 endif(USE_VORBIS)
 
 #faac
 if(USE_FAAC)
-	add_libs_all_targets(faac)
+	add_libs_all_targets("${FAAC_LIBRARY_DIR}")
 endif(USE_FAAC)
 
 #aften
 if(USE_AFTEN)
-	add_libs_all_targets(aften)
+	add_libs_all_targets("${AFTEN_LIBRARY_DIR}")
 endif(USE_AFTEN)
 
 #faad
 if(USE_FAAD)
-	add_libs_all_targets(faad)
+	add_libs_all_targets("${FAAD_LIBRARY_DIR}")
 endif(USE_FAAD)
 
 #libsamplerate
 if(USE_SRC)
-	add_libs_all_targets(samplerate)
+	add_libs_all_targets("${SRC_LIBRARY_DIR}")
 endif(USE_SRC)
 
 # xvid
 if(USE_XVID_4)
-	add_libs_all_targets(xvidcore)
+	add_libs_all_targets("${XVID_LIBRARY_DIR}")
 endif(USE_XVID_4)
 
 # x264
 if(USE_X264)
-	add_libs_all_targets(x264)
+	add_libs_all_targets("${X264_LIBRARY_DIR}")
 endif(USE_X264)
 
 ###########################################
@@ -394,7 +368,6 @@
 # Win32
 ########################
 IF (ADM_OS_WINDOWS)
-	add_libs_all_targets(z)
 	add_libs_all_targets(ADM_osSupport)
 	add_libs_all_targets(pthreadGC2)
 	add_libs_all_targets(winmm)
@@ -411,16 +384,15 @@
 ########################
 # MacOsX
 ########################
-if (ADM_OS_APPLE)
-	add_libs_all_targets(z)
+if (ADM_OS_DARWIN)
 	add_libs_all_targets("-framework CoreServices -framework CoreAudio -framework AudioUnit")
-endif (ADM_OS_APPLE)
+endif (ADM_OS_DARWIN)
 
 ########################
 # all
 ########################
 SDLify(main.cpp)
-add_compile_flags(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
+add_source_compile_flags(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
 
 ###############
 # INSTALL

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,27 +1,16 @@
 # Find arts CFLAGS etc
 
-MESSAGE(STATUS "<** ARTS **>")
-MESSAGE(STATUS "<---------->")
-if(NO_ARTS)
-message(status "<disabled per request>")
-else(NO_ARTS)
 FIND_PROGRAM(ARTS_CONFIG_EXECUTABLE artsc-config)
 MARK_AS_ADVANCED(ARTS_CONFIG_EXECUTABLE)
 
-IF(ARTS_CONFIG_EXECUTABLE)
+IF (ARTS_CONFIG_EXECUTABLE)
     EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --cflags
       OUTPUT_VARIABLE ARTS_CFLAGS
       OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Arts cflags : ${ARTS_CFLAGS}")
+      
     EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --libs
       OUTPUT_VARIABLE ARTS_LDFLAGS
       OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Arts ldflags : ${ARTS_LDFLAGS}")
-    SET(USE_ARTS 1)
-ELSE(ARTS_CONFIG_EXECUTABLE)
-MESSAGE(STATUS "Not found")
-ENDIF(ARTS_CONFIG_EXECUTABLE)
-endif(NO_ARTS)
 
-
-# FindSubversion.cmake ends here.
+    SET(ARTS_FOUND TRUE)
+ENDIF(ARTS_CONFIG_EXECUTABLE)

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,58 @@
+# - Find the native PNG includes and library
+#
+
+# This module defines
+#  PNG_INCLUDE_DIR, where to find png.h, etc.
+#  PNG_LIBRARIES, the libraries to link against to use PNG.
+#  PNG_DEFINITIONS - You should ADD_DEFINITONS(${PNG_DEFINITIONS}) before compiling code that includes png library files.
+#  PNG_FOUND, If false, do not try to use PNG.
+# also defined, but not for general use are
+#  PNG_LIBRARY, where to find the PNG library.
+# None of the above will be defined unles zlib can be found.
+# PNG depends on Zlib
+INCLUDE(FindZLIB)
+
+SET(PNG_FOUND "NO")
+
+IF(ZLIB_FOUND)
+  FIND_PATH(PNG_PNG_INCLUDE_DIR png.h
+  /usr/local/include
+  /usr/include
+  /usr/local/include/libpng             # OpenBSD
+  )
+
+  SET(PNG_NAMES ${PNG_NAMES} png libpng)
+  FIND_LIBRARY(PNG_LIBRARY
+    NAMES ${PNG_NAMES}
+    PATHS /usr/lib /usr/local/lib
+  )
+
+  IF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
+      # png.h includes zlib.h. Sigh.
+      SET(PNG_INCLUDE_DIR ${PNG_PNG_INCLUDE_DIR} ${ZLIB_INCLUDE_DIR} )
+      SET(PNG_LIBRARIES ${PNG_LIBRARY} ${ZLIB_LIBRARY})
+      SET(PNG_FOUND "YES")
+
+      IF (CYGWIN)
+        IF(BUILD_SHARED_LIBS)
+           # No need to define PNG_USE_DLL here, because it's default for Cygwin.
+        ELSE(BUILD_SHARED_LIBS)
+          SET (PNG_DEFINITIONS -DPNG_STATIC)
+        ENDIF(BUILD_SHARED_LIBS)
+      ENDIF (CYGWIN)
+
+  ENDIF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
+
+ENDIF(ZLIB_FOUND)
+
+IF (PNG_FOUND)
+  IF (NOT PNG_FIND_QUIETLY)
+    MESSAGE(STATUS "Found PNG: ${PNG_LIBRARY}")
+  ENDIF (NOT PNG_FIND_QUIETLY)
+ELSE (PNG_FOUND)
+  IF (PNG_FIND_REQUIRED)
+    MESSAGE(FATAL_ERROR "Could not find PNG library")
+  ENDIF (PNG_FIND_REQUIRED)
+ENDIF (PNG_FOUND)
+
+MARK_AS_ADVANCED(PNG_PNG_INCLUDE_DIR PNG_LIBRARY )

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,360 @@
+# - a pkg-config module for CMake
+#
+# Usage:
+#   pkg_check_modules(<PREFIX> [REQUIRED] <MODULE> [<MODULE>]*)
+#     checks for all the given modules
+#
+#   pkg_search_module(<PREFIX> [REQUIRED] <MODULE> [<MODULE>]*)
+#     checks for given modules and uses the first working one
+#
+# When the 'REQUIRED' argument was set, macros will fail with an error
+# when module(s) could not be found
+#
+# It sets the following variables:
+#   PKG_CONFIG_FOUND         ... true iff pkg-config works on the system
+#   PKG_CONFIG_EXECUTABLE    ... pathname of the pkg-config program
+#   <PREFIX>_FOUND           ... set to 1 iff module(s) exist
+#
+# For the following variables two sets of values exist; first one is the
+# common one and has the given PREFIX. The second set contains flags
+# which are given out when pkgconfig was called with the '--static'
+# option.
+#   <XPREFIX>_LIBRARIES      ... only the libraries (w/o the '-l')
+#   <XPREFIX>_LIBRARY_DIRS   ... the paths of the libraries (w/o the '-L')
+#   <XPREFIX>_LDFLAGS        ... all required linker flags
+#   <XPREFIX>_LDFLAGS_OTHERS ... all other linker flags
+#   <XPREFIX>_INCLUDE_DIRS   ... the '-I' preprocessor flags (w/o the '-I')
+#   <XPREFIX>_CFLAGS         ... all required cflags
+#   <XPREFIX>_CFLAGS_OTHERS  ... the other compiler flags
+#
+#   <XPREFIX> = <PREFIX>        for common case
+#   <XPREFIX> = <PREFIX>_STATIC for static linking
+#
+# There are some special variables whose prefix depends on the count
+# of given modules. When there is only one module, <PREFIX> stays
+# unchanged. When there are multiple modules, the prefix will be
+# changed to <PREFIX>_<MODNAME>:
+#   <XPREFIX>_VERSION    ... version of the module
+#   <XPREFIX>_PREFIX     ... prefix-directory of the module
+#   <XPREFIX>_INCLUDEDIR ... include-dir of the module
+#   <XPREFIX>_LIBDIR     ... lib-dir of the module
+#
+#   <XPREFIX> = <PREFIX>  when |MODULES| == 1, else
+#   <XPREFIX> = <PREFIX>_<MODNAME>
+#
+# A <MODULE> parameter can have the following formats:
+#   {MODNAME}            ... matches any version
+#   {MODNAME}>={VERSION} ... at least version <VERSION> is required
+#   {MODNAME}={VERSION}  ... exactly version <VERSION> is required
+#   {MODNAME}<={VERSION} ... modules must not be newer than <VERSION>
+#
+# Examples
+#   pkg_check_modules (GLIB2   glib-2.0)
+#
+#   pkg_check_modules (GLIB2   glib-2.0>=2.10)
+#     requires at least version 2.10 of glib2 and defines e.g.
+#       GLIB2_VERSION=2.10.3
+#
+#   pkg_check_modules (FOO     glib-2.0>=2.10 gtk+-2.0)
+#     requires both glib2 and gtk2, and defines e.g.
+#       FOO_glib-2.0_VERSION=2.10.3
+#       FOO_gtk+-2.0_VERSION=2.8.20
+#
+#   pkg_check_modules (XRENDER REQUIRED xrender)
+#     defines e.g.:
+#       XRENDER_LIBRARIES=Xrender;X11
+#       XRENDER_STATIC_LIBRARIES=Xrender;X11;pthread;Xau;Xdmcp
+#
+#   pkg_search_module (BAR     libxml-2.0 libxml2 libxml>=2)
+
+
+# Copyright (C) 2006 Enrico Scholz <enrico.scholz at informatik.tu-chemnitz.de>
+#
+# Redistribution and use, with or without modification, are permitted
+# provided that the following conditions are met:
+# 
+#    1. Redistributions must retain the above copyright notice, this
+#       list of conditions and the following disclaimer.
+#    2. The name of the author may not be used to endorse or promote
+#       products derived from this software without specific prior
+#       written permission.
+# 
+# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
+# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
+# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
+# IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
+# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
+# IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+
+### Common stuff ####
+set(PKG_CONFIG_VERSION 1)
+set(PKG_CONFIG_FOUND   0)
+
+find_program(PKG_CONFIG_EXECUTABLE NAMES pkg-config DOC "pkg-config executable")
+mark_as_advanced(PKG_CONFIG_EXECUTABLE)
+
+if(PKG_CONFIG_EXECUTABLE)
+  set(PKG_CONFIG_FOUND 1)
+endif(PKG_CONFIG_EXECUTABLE)
+
+
+# Unsets the given variables
+macro(_pkgconfig_unset var)
+  set(${var} "" CACHE INTERNAL "")
+endmacro(_pkgconfig_unset)
+
+macro(_pkgconfig_set var value)
+  set(${var} ${value} CACHE INTERNAL "")
+endmacro(_pkgconfig_set)
+
+# Invokes pkgconfig, cleans up the result and sets variables
+macro(_pkgconfig_invoke _pkglist _prefix _varname _regexp)
+  set(_pkgconfig_invoke_result)
+
+  execute_process(
+    COMMAND ${PKG_CONFIG_EXECUTABLE} ${ARGN} ${_pkglist}
+    OUTPUT_VARIABLE _pkgconfig_invoke_result
+    RESULT_VARIABLE _pkgconfig_failed)
+
+  if (_pkgconfig_failed)
+    set(_pkgconfig_${_varname} "")
+    _pkgconfig_unset(${_prefix}_${_varname})
+  else(_pkgconfig_failed)
+    string(REGEX REPLACE "[\r\n]"                  " " _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
+    string(REGEX REPLACE " +$"                     ""  _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
+
+    if (NOT ${_regexp} STREQUAL "")
+      string(REGEX REPLACE "${_regexp}" " " _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
+    endif(NOT ${_regexp} STREQUAL "")
+
+    separate_arguments(_pkgconfig_invoke_result)
+
+    #message(STATUS "  ${_varname} ... ${_pkgconfig_invoke_result}")
+    set(_pkgconfig_${_varname} ${_pkgconfig_invoke_result})
+    _pkgconfig_set(${_prefix}_${_varname} "${_pkgconfig_invoke_result}")
+  endif(_pkgconfig_failed)
+endmacro(_pkgconfig_invoke)
+
+# Invokes pkgconfig two times; once without '--static' and once with
+# '--static'
+macro(_pkgconfig_invoke_dyn _pkglist _prefix _varname cleanup_regexp)
+  _pkgconfig_invoke("${_pkglist}" ${_prefix}        ${_varname} "${cleanup_regexp}" ${ARGN})
+  _pkgconfig_invoke("${_pkglist}" ${_prefix} STATIC_${_varname} "${cleanup_regexp}" --static  ${ARGN})
+endmacro(_pkgconfig_invoke_dyn)
+
+# Splits given arguments into options and a package list
+macro(_pkgconfig_parse_options _result _is_req)
+  set(${_is_req} 0)
+  
+  foreach(_pkg ${ARGN})
+    if (_pkg STREQUAL "REQUIRED")
+      set(${_is_req} 1)
+    endif (_pkg STREQUAL "REQUIRED")
+  endforeach(_pkg ${ARGN})
+
+  set(${_result} ${ARGN})
+  list(REMOVE_ITEM ${_result} "REQUIRED")
+endmacro(_pkgconfig_parse_options)
+
+###
+macro(_pkg_check_modules_internal _is_required _is_silent _prefix)
+  _pkgconfig_unset(${_prefix}_FOUND)
+  _pkgconfig_unset(${_prefix}_VERSION)
+  _pkgconfig_unset(${_prefix}_PREFIX)
+  _pkgconfig_unset(${_prefix}_INCLUDEDIR)
+  _pkgconfig_unset(${_prefix}_LIBDIR)
+  _pkgconfig_unset(${_prefix}_LIBS)
+  _pkgconfig_unset(${_prefix}_LIBS_L)
+  _pkgconfig_unset(${_prefix}_LIBS_PATHS)
+  _pkgconfig_unset(${_prefix}_LIBS_OTHER)
+  _pkgconfig_unset(${_prefix}_CFLAGS)
+  _pkgconfig_unset(${_prefix}_CFLAGS_I)
+  _pkgconfig_unset(${_prefix}_CFLAGS_OTHER)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBDIR)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_L)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_PATHS)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_OTHER)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_I)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_OTHER)
+
+  # create a better addressable variable of the modules and calculate its size
+  set(_pkg_check_modules_list ${ARGN})
+  list(LENGTH _pkg_check_modules_list _pkg_check_modules_cnt)
+
+  if(PKG_CONFIG_EXECUTABLE)
+    # give out status message telling checked module
+    if (NOT ${_is_silent})
+      if (_pkg_check_modules_cnt EQUAL 1)
+        message(STATUS "checking for module '${_pkg_check_modules_list}'")
+      else(_pkg_check_modules_cnt EQUAL 1)
+        message(STATUS "checking for modules '${_pkg_check_modules_list}'")
+      endif(_pkg_check_modules_cnt EQUAL 1)
+    endif(NOT ${_is_silent})
+    
+    set(_pkg_check_modules_packages)
+    set(_pkg_check_modules_failed)
+
+    # iterate through module list and check whether they exist and match the required version
+    foreach (_pkg_check_modules_pkg ${_pkg_check_modules_list})
+      set(_pkg_check_modules_exist_query)
+
+      # check whether version is given
+      if (_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
+        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\1" _pkg_check_modules_pkg_name "${_pkg_check_modules_pkg}")
+        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\2" _pkg_check_modules_pkg_op   "${_pkg_check_modules_pkg}")
+        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\3" _pkg_check_modules_pkg_ver  "${_pkg_check_modules_pkg}")
+      else(_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
+        set(_pkg_check_modules_pkg_name "${_pkg_check_modules_pkg}")
+        set(_pkg_check_modules_pkg_op)
+        set(_pkg_check_modules_pkg_ver)
+      endif(_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
+
+      # handle the operands
+      if (_pkg_check_modules_pkg_op STREQUAL ">=")
+        list(APPEND _pkg_check_modules_exist_query --atleast-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL ">=")
+
+      if (_pkg_check_modules_pkg_op STREQUAL "=")
+        list(APPEND _pkg_check_modules_exist_query --exact-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL "=")
+      
+      if (_pkg_check_modules_pkg_op STREQUAL "<=")
+        list(APPEND _pkg_check_modules_exist_query --max-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL "<=")
+
+      # create the final query which is of the format:
+      # * --atleast-version <version> <pkg-name>
+      # * --exact-version <version> <pkg-name>      
+      # * --max-version <version> <pkg-name>
+      # * --exists <pkg-name>
+      if (_pkg_check_modules_pkg_op)
+        list(APPEND _pkg_check_modules_exist_query "${_pkg_check_modules_pkg_ver}")
+      else(_pkg_check_modules_pkg_op)
+        list(APPEND _pkg_check_modules_exist_query --exists)
+      endif(_pkg_check_modules_pkg_op)
+
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_VERSION)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_PREFIX)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_INCLUDEDIR)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_LIBDIR)
+
+      list(APPEND _pkg_check_modules_exist_query "${_pkg_check_modules_pkg_name}")
+      list(APPEND _pkg_check_modules_packages    "${_pkg_check_modules_pkg_name}")
+
+      # execute the query
+      execute_process(
+        COMMAND ${PKG_CONFIG_EXECUTABLE} ${_pkg_check_modules_exist_query}
+        RESULT_VARIABLE _pkgconfig_retval)
+
+      # evaluate result and tell failures
+      if (_pkgconfig_retval)
+        if(NOT ${_is_silent})
+          message(STATUS "  package '${_pkg_check_modules_pkg}' not found")
+        endif(NOT ${_is_silent})
+
+        set(_pkg_check_modules_failed 1)
+      endif(_pkgconfig_retval)
+    endforeach(_pkg_check_modules_pkg)
+
+    if(_pkg_check_modules_failed)
+      # fail when requested
+      if (${_is_required})
+        message(SEND_ERROR "A required package was not found")
+      endif (${_is_required})
+    else(_pkg_check_modules_failed)
+      # when we are here, we checked whether requested modules
+      # exist. Now, go through them and set variables
+      
+      _pkgconfig_set(${_prefix}_FOUND 1)
+      list(LENGTH _pkg_check_modules_packages pkg_count)
+
+      # iterate through all modules again and set individual variables
+      foreach (_pkg_check_modules_pkg ${_pkg_check_modules_packages})
+        # handle case when there is only one package required
+        if (pkg_count EQUAL 1)
+          set(_pkg_check_prefix "${_prefix}")
+        else(pkg_count EQUAL 1)
+          set(_pkg_check_prefix "${_prefix}_${_pkg_check_modules_pkg}")
+        endif(pkg_count EQUAL 1)
+        
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" VERSION    ""   --modversion )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" PREFIX     ""   --variable=prefix )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" INCLUDEDIR ""   --variable=includedir )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" LIBDIR     ""   --variable=libdir )
+
+        message(STATUS "  found ${_pkg_check_modules_pkg}, version ${_pkgconfig_VERSION}")
+      endforeach(_pkg_check_modules_pkg)
+
+      # set variables which are combined for multiple modules
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LIBRARIES           "(^| )-l" --libs-only-l )
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LIBRARY_DIRS        "(^| )-L" --libs-only-L )
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LDFLAGS             ""        --libs )
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LDFLAGS_OTHER       ""        --libs-only-other )
+
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" INCLUDE_DIRS        "(^| )-I" --cflags-only-I )
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" CFLAGS              ""        --cflags )
+      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" CFLAGS_OTHER        ""        --cflags-only-other )
+    endif(_pkg_check_modules_failed)
+  else(PKG_CONFIG_EXECUTABLE)
+    if (${_is_required})
+      message(SEND_ERROR "pkg-config tool not found")
+    endif (${_is_required})
+  endif(PKG_CONFIG_EXECUTABLE)
+endmacro(_pkg_check_modules_internal)
+
+###
+### User visible macros start here
+###
+
+###
+macro(pkg_check_modules _prefix _module0)
+  # check cached value
+  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+    _pkgconfig_parse_options   (_pkg_modules _pkg_is_required "${_module0}" ${ARGN})
+    _pkg_check_modules_internal("${_pkg_is_required}" 0 "${_prefix}" ${_pkg_modules})
+
+    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
+  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+endmacro(pkg_check_modules)
+
+###
+macro(pkg_search_module _prefix _module0)
+  # check cached value
+  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+    set(_pkg_modules_found 0)
+    _pkgconfig_parse_options(_pkg_modules_alt _pkg_is_required "${_module0}" ${ARGN})
+
+    message(STATUS "checking for one of the modules '${_pkg_modules_alt}'")
+
+    # iterate through all modules and stop at the first working one.
+    foreach(_pkg_alt ${_pkg_modules_alt})
+      if(NOT _pkg_modules_found)
+        _pkg_check_modules_internal(0 1 "${_prefix}" "${_pkg_alt}")
+      endif(NOT _pkg_modules_found)
+
+      if (${_prefix}_FOUND)
+        set(_pkg_modules_found 1)
+      endif(${_prefix}_FOUND)
+    endforeach(_pkg_alt)
+
+    if (NOT ${_prefix}_FOUND)
+      if(${_pkg_is_required})
+        message(SEND_ERROR "None of the required '${_pkg_modules_alt}' found")
+      endif(${_pkg_is_required})
+    endif(NOT ${_prefix}_FOUND)
+    
+    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
+  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})  
+endmacro(pkg_search_module)
+
+### Local Variables:
+### mode: cmake
+### End:

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,1201 +1,1030 @@
-# - Find QT 4
-# This module can be used to find Qt4.
-# The most important issue is that the Qt4 qmake is available via the system path.
-# This qmake is then used to detect basically everything else.
-# This module defines a number of key variables and macros. First is 
-# QT_USE_FILE which is the path to a CMake file that can be included to compile
-# Qt 4 applications and libraries.  By default, the QtCore and QtGui 
-# libraries are loaded. This behavior can be changed by setting one or more 
-# of the following variables to true:
-#                    QT_DONT_USE_QTCORE
-#                    QT_DONT_USE_QTGUI
-#                    QT_USE_QT3SUPPORT
-#                    QT_USE_QTASSISTANT
-#                    QT_USE_QTDESIGNER
-#                    QT_USE_QTMOTIF
-#                    QT_USE_QTMAIN
-#                    QT_USE_QTNETWORK
-#                    QT_USE_QTNSPLUGIN
-#                    QT_USE_QTOPENGL
-#                    QT_USE_QTSQL
-#                    QT_USE_QTXML
-#                    QT_USE_QTSVG
-#                    QT_USE_QTTEST
-#                    QT_USE_QTUITOOLS
-#                    QT_USE_QTDBUS
-#
-# All the libraries required are stored in a variable called QT_LIBRARIES.  
-# Add this variable to your TARGET_LINK_LIBRARIES.
-#  
-#  macro QT4_WRAP_CPP(outfiles inputfile ... )
-#  macro QT4_WRAP_UI(outfiles inputfile ... )
-#  macro QT4_ADD_RESOURCE(outfiles inputfile ... )
-#  macro QT4_AUTOMOC(inputfile ... )
-#  macro QT4_GENERATE_MOC(inputfile outputfile )
-#
-#  macro QT4_ADD_DBUS_INTERFACE(outfiles interface basename)
-#        create a the interface header and implementation files with the 
-#        given basename from the given interface xml file and add it to 
-#        the list of sources
-#
-#  macro QT4_ADD_DBUS_INTERFACES(outfiles inputfile ... )
-#        create the interface header and implementation files 
-#        for all listed interface xml files
-#        the name will be automatically determined from the name of the xml file
-#
-#  macro QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE(outfiles interface basename)
-#        create a the interface without namespace header and implementation files with the
-#        given basename from the given interface xml file and add it to
-#        the list of sources
-#
-#  macro QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE(outfiles inputfile ... )
-#        create the interface header without namespace and implementation files
-#        for all listed interface xml files
-#        the name will be automatically determined from the name of the xml file
-#
-#  macro QT4_ADD_DBUS_ADAPTOR(outfiles xmlfile parentheader parentclassname [basename] )
-#        create a dbus adaptor (header and implementation file) from the xml file
-#        describing the interface, and add it to the list of sources. The adaptor
-#        forwards the calls to a parent class, defined in parentheader and named
-#        parentclassname. The name of the generated files will be
-#        <basename>adaptor.{cpp,h} where basename is the basename of the xml file.
-#
-#  macro QT4_GENERATE_DBUS_INTERFACE( header [interfacename] )
-#        generate the xml interface file from the given header.
-#        If the optional argument interfacename is omitted, the name of the 
-#        interface file is constructed from the basename of the header with
-#        the suffix .xml appended.
-#
-#  QT_FOUND         If false, don't try to use Qt.
-#  QT4_FOUND        If false, don't try to use Qt 4.
-#
-#  QT_QTCORE_FOUND        True if QtCore was found.
-#  QT_QTGUI_FOUND         True if QtGui was found.
-#  QT_QT3SUPPORT_FOUND    True if Qt3Support was found.
-#  QT_QTASSISTANT_FOUND   True if QtAssistant was found.
-#  QT_QTDBUS_FOUND        True if QtDBus was found.
-#  QT_QTDESIGNER_FOUND    True if QtDesigner was found.
-#  QT_QTDESIGNERCOMPONENTS True if QtDesignerComponents was found.
-#  QT_QTMOTIF_FOUND       True if QtMotif was found.
-#  QT_QTNETWORK_FOUND     True if QtNetwork was found.
-#  QT_QTNSPLUGIN_FOUND    True if QtNsPlugin was found.
-#  QT_QTOPENGL_FOUND      True if QtOpenGL was found.
-#  QT_QTSQL_FOUND         True if QtSql was found.
-#  QT_QTXML_FOUND         True if QtXml was found.
-#  QT_QTSVG_FOUND         True if QtSvg was found.
-#  QT_QTSCRIPT_FOUND      True if QtScript was found.
-#  QT_QTTEST_FOUND        True if QtTest was found.
-#  QT_QTUITOOLS_FOUND     True if QtUiTools was found.
-#                      
-#  QT_DEFINITIONS   Definitions to use when compiling code that uses Qt.
-#                  
-#  QT_INCLUDES      List of paths to all include directories of 
-#                   Qt4 QT_INCLUDE_DIR and QT_QTCORE_INCLUDE_DIR are
-#                   always in this variable even if NOTFOUND,
-#                   all other INCLUDE_DIRS are
-#                   only added if they are found.
-#   
-#  QT_INCLUDE_DIR              Path to "include" of Qt4
-#  QT_QT_INCLUDE_DIR           Path to "include/Qt" 
-#  QT_QT3SUPPORT_INCLUDE_DIR   Path to "include/Qt3Support" 
-#  QT_QTASSISTANT_INCLUDE_DIR  Path to "include/QtAssistant" 
-#  QT_QTCORE_INCLUDE_DIR       Path to "include/QtCore"         
-#  QT_QTDESIGNER_INCLUDE_DIR   Path to "include/QtDesigner" 
-#  QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR   Path to "include/QtDesigner"
-#  QT_QTDBUS_INCLUDE_DIR       Path to "include/QtDBus" 
-#  QT_QTGUI_INCLUDE_DIR        Path to "include/QtGui" 
-#  QT_QTMOTIF_INCLUDE_DIR      Path to "include/QtMotif" 
-#  QT_QTNETWORK_INCLUDE_DIR    Path to "include/QtNetwork" 
-#  QT_QTNSPLUGIN_INCLUDE_DIR   Path to "include/QtNsPlugin" 
-#  QT_QTOPENGL_INCLUDE_DIR     Path to "include/QtOpenGL" 
-#  QT_QTSQL_INCLUDE_DIR        Path to "include/QtSql" 
-#  QT_QTXML_INCLUDE_DIR        Path to "include/QtXml" 
-#  QT_QTSVG_INCLUDE_DIR        Path to "include/QtSvg"
-#  QT_QTSCRIPT_INCLUDE_DIR     Path to "include/QtScript"
-#  QT_QTTEST_INCLUDE_DIR       Path to "include/QtTest"
-#                            
-#  QT_LIBRARY_DIR              Path to "lib" of Qt4
-# 
-#  QT_PLUGINS_DIR              Path to "plugins" for Qt4
-#                            
-# For every library of Qt, a QT_QTFOO_LIBRARY variable is defined, with the full path to the library.
-#
-# So there are the following variables:
-# The Qt3Support library:     QT_QT3SUPPORT_LIBRARY
-#
-# The QtAssistant library:    QT_QTASSISTANT_LIBRARY
-#
-# The QtCore library:         QT_QTCORE_LIBRARY
-#
-# The QtDBus library:         QT_QTDBUS_LIBRARY
-#
-# The QtDesigner library:     QT_QTDESIGNER_LIBRARY
-#
-# The QtDesignerComponents library:     QT_QTDESIGNERCOMPONENTS_LIBRARY
-#
-# The QtGui library:          QT_QTGUI_LIBRARY
-#
-# The QtMotif library:        QT_QTMOTIF_LIBRARY
-#
-# The QtNetwork library:      QT_QTNETWORK_LIBRARY
-#
-# The QtNsPLugin library:     QT_QTNSPLUGIN_LIBRARY
-#
-# The QtOpenGL library:       QT_QTOPENGL_LIBRARY
-#
-# The QtSql library:          QT_QTSQL_LIBRARY
-#
-# The QtXml library:          QT_QTXML_LIBRARY
-#
-# The QtSvg library:          QT_QTSVG_LIBRARY
-#
-# The QtScript library:       QT_QTSCRIPT_LIBRARY
-#
-# The QtTest library:         QT_QTTEST_LIBRARY
-#
-# The qtmain library for Windows QT_QTMAIN_LIBRARY
-#
-# The QtUiTools library:      QT_QTUITOOLS_LIBRARY
-#  
-# also defined, but NOT for general use are
-#  QT_MOC_EXECUTABLE          Where to find the moc tool.
-#  QT_UIC_EXECUTABLE          Where to find the uic tool.
-#  QT_UIC3_EXECUTABLE         Where to find the uic3 tool.
-#  QT_RCC_EXECUTABLE          Where to find the rcc tool
-#  QT_DBUSCPP2XML_EXECUTABLE  Where to find the qdbuscpp2xml tool.
-#  QT_DBUSXML2CPP_EXECUTABLE  Where to find the qdbusxml2cpp tool.
-#  
-#  QT_DOC_DIR                 Path to "doc" of Qt4
-#  QT_MKSPECS_DIR             Path to "mkspecs" of Qt4
-#
-#
-# These are around for backwards compatibility 
-# they will be set
-#  QT_WRAP_CPP  Set true if QT_MOC_EXECUTABLE is found
-#  QT_WRAP_UI   Set true if QT_UIC_EXECUTABLE is found
-#  
-# These variables do _NOT_ have any effect anymore (compared to FindQt.cmake)
-#  QT_MT_REQUIRED         Qt4 is now always multithreaded
-#  
-# These variables are set to "" Because Qt structure changed 
-# (They make no sense in Qt4)
-#  QT_QT_LIBRARY        Qt-Library is now split
-
-# Copyright (c) 2002 Kitware, Inc., Insight Consortium.  All rights reserved.
-# See Copyright.txt or http://www.cmake.org/HTML/Copyright.html for details.
-
-
-INCLUDE(CheckSymbolExists)
-INCLUDE(MacroAddFileDependencies)
-
-SET(QT_USE_FILE ${CMAKE_ROOT}/Modules/UseQt4.cmake)
-
-SET( QT_DEFINITIONS "")
-
-IF (WIN32)
-  SET(QT_DEFINITIONS -DQT_DLL)
-ENDIF(WIN32)
-
-SET(QT4_INSTALLED_VERSION_TOO_OLD FALSE)
-
-#  macro for asking qmake to process pro files
-MACRO(QT_QUERY_QMAKE outvar invar)
-  FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake/tmp.pro
-    "message(CMAKE_MESSAGE<$$${invar}>)")
-
-  EXECUTE_PROCESS(COMMAND ${QT_QMAKE_EXECUTABLE}
-    WORKING_DIRECTORY  
-    ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake
-    OUTPUT_VARIABLE _qmake_query_output
-    ERROR_VARIABLE _qmake_query_output )
-
-  FILE(REMOVE_RECURSE 
-    "${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake")
-
-  STRING(REGEX REPLACE ".*CMAKE_MESSAGE<([^>]*).*" "\\1" ${outvar} "${_qmake_query_output}")
-ENDMACRO(QT_QUERY_QMAKE)
-
-# check for qmake
-FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake4 qmake-qt4 PATHS
-  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
-  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
-  $ENV{QTDIR}/bin
-)
-
-IF (QT_QMAKE_EXECUTABLE)
-
-  SET(QT4_QMAKE_FOUND FALSE)
-  
-  EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
-
-  # check for qt3 qmake and then try and find qmake4 or qmake-qt4 in the path
-  IF("${QTVERSION}" MATCHES "Unknown")
-    SET(QT_QMAKE_EXECUTABLE NOTFOUND CACHE FILEPATH "" FORCE)
-    FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake4 qmake-qt4 PATHS
-      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
-      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
-      $ENV{QTDIR}/bin
-      )
-    IF(QT_QMAKE_EXECUTABLE)
-      EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} 
-        ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
-    ENDIF(QT_QMAKE_EXECUTABLE)
-  ENDIF("${QTVERSION}" MATCHES "Unknown")
-
-  # check that we found the Qt4 qmake, Qt3 qmake output won't match here
-  STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" qt_version_tmp "${QTVERSION}")
-  IF (qt_version_tmp)
-
-    # we need at least version 4.0.0
-    IF (NOT QT_MIN_VERSION)
-      SET(QT_MIN_VERSION "4.0.0")
-    ENDIF (NOT QT_MIN_VERSION)
-
-    #now parse the parts of the user given version string into variables
-    STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" req_qt_major_vers "${QT_MIN_VERSION}")
-    IF (NOT req_qt_major_vers)
-      MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", expected e.g. \"4.0.1\"")
-    ENDIF (NOT req_qt_major_vers)
-
-    # now parse the parts of the user given version string into variables
-    STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+" "\\1" req_qt_major_vers "${QT_MIN_VERSION}")
-    STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+" "\\1" req_qt_minor_vers "${QT_MIN_VERSION}")
-    STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+)" "\\1" req_qt_patch_vers "${QT_MIN_VERSION}")
-
-    IF (NOT req_qt_major_vers EQUAL 4)
-      MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", major version 4 is required, e.g. \"4.0.1\"")
-    ENDIF (NOT req_qt_major_vers EQUAL 4)
-
-    # and now the version string given by qmake
-    STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+.*" "\\1" found_qt_major_vers "${QTVERSION}")
-    STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+.*" "\\1" found_qt_minor_vers "${QTVERSION}")
-    STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+).*" "\\1" found_qt_patch_vers "${QTVERSION}")
-
-    # compute an overall version number which can be compared at once
-    MATH(EXPR req_vers "${req_qt_major_vers}*10000 + ${req_qt_minor_vers}*100 + ${req_qt_patch_vers}")
-    MATH(EXPR found_vers "${found_qt_major_vers}*10000 + ${found_qt_minor_vers}*100 + ${found_qt_patch_vers}")
-
-    IF (found_vers LESS req_vers)
-      SET(QT4_QMAKE_FOUND FALSE)
-      SET(QT4_INSTALLED_VERSION_TOO_OLD TRUE)
-    ELSE (found_vers LESS req_vers)
-      SET(QT4_QMAKE_FOUND TRUE)
-    ENDIF (found_vers LESS req_vers)
-  ENDIF (qt_version_tmp)
-
-ENDIF (QT_QMAKE_EXECUTABLE)
-
-IF (QT4_QMAKE_FOUND)
-
-  # ask qmake for the library dir
-  # Set QT_LIBRARY_DIR
-  IF (NOT QT_LIBRARY_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_LIBS"
-      OUTPUT_VARIABLE QT_LIBRARY_DIR_TMP )
-    IF(EXISTS "${QT_LIBRARY_DIR_TMP}")
-      SET(QT_LIBRARY_DIR ${QT_LIBRARY_DIR_TMP} CACHE PATH "Qt library dir")
-    ELSE(EXISTS "${QT_LIBRARY_DIR_TMP}")
-      MESSAGE("Warning: QT_QMAKE_EXECUTABLE reported QT_INSTALL_LIBS as ${QT_LIBRARY_DIR_TMP}")
-      MESSAGE("Warning: ${QT_LIBRARY_DIR_TMP} does NOT exist, Qt must NOT be installed correctly.")
-    ENDIF(EXISTS "${QT_LIBRARY_DIR_TMP}")
-  ENDIF(NOT QT_LIBRARY_DIR)
-  
-  IF (APPLE)
-    IF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS ON
-        CACHE BOOL "Set to ON if Qt build uses frameworks.")
-    ELSE (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS OFF
-        CACHE BOOL "Set to ON if Qt build uses frameworks.")
-    ENDIF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-    
-    MARK_AS_ADVANCED(QT_USE_FRAMEWORKS)
-  ENDIF (APPLE)
-  
-  # ask qmake for the binary dir
-  IF (NOT QT_BINARY_DIR)
-     EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE}
-        ARGS "-query QT_INSTALL_BINS"
-        OUTPUT_VARIABLE qt_bins )
-     SET(QT_BINARY_DIR ${qt_bins} CACHE INTERNAL "")
-  ENDIF (NOT QT_BINARY_DIR)
-
-  # ask qmake for the include dir
-  IF (NOT QT_HEADERS_DIR)
-      EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-        ARGS "-query QT_INSTALL_HEADERS" 
-        OUTPUT_VARIABLE qt_headers )
-      SET(QT_HEADERS_DIR ${qt_headers} CACHE INTERNAL "")
-  ENDIF(NOT QT_HEADERS_DIR)
-
-
-  # ask qmake for the documentation directory
-  IF (NOT QT_DOC_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_DOCS"
-      OUTPUT_VARIABLE qt_doc_dir )
-    SET(QT_DOC_DIR ${qt_doc_dir} CACHE PATH "The location of the Qt docs")
-  ENDIF (NOT QT_DOC_DIR)
-
-  # ask qmake for the mkspecs directory
-  IF (NOT QT_MKSPECS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QMAKE_MKSPECS"
-      OUTPUT_VARIABLE qt_mkspecs_dir )
-    SET(QT_MKSPECS_DIR ${qt_mkspecs_dir} CACHE PATH "The location of the Qt mkspecs")
-  ENDIF (NOT QT_MKSPECS_DIR)
-
-  # ask qmake for the plugins directory
-  IF (NOT QT_PLUGINS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_PLUGINS"
-      OUTPUT_VARIABLE qt_plugins_dir )
-    SET(QT_PLUGINS_DIR ${qt_plugins_dir} CACHE PATH "The location of the Qt plugins")
-  ENDIF (NOT QT_PLUGINS_DIR)
-  ########################################
-  #
-  #       Setting the INCLUDE-Variables
-  #
-  ########################################
-
-  FIND_PATH(QT_QTCORE_INCLUDE_DIR QtGlobal
-    ${QT_HEADERS_DIR}/QtCore
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_INCLUDE_DIR by removine "/QtCore" in the string ${QT_QTCORE_INCLUDE_DIR}
-  IF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-    IF (QT_USE_FRAMEWORKS)
-      SET(QT_INCLUDE_DIR ${QT_HEADERS_DIR})
-    ELSE (QT_USE_FRAMEWORKS)
-      STRING( REGEX REPLACE "/QtCore$" "" qt4_include_dir ${QT_QTCORE_INCLUDE_DIR})
-      SET( QT_INCLUDE_DIR ${qt4_include_dir} CACHE PATH "")
-    ENDIF (QT_USE_FRAMEWORKS)
-  ENDIF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-
-  IF( NOT QT_INCLUDE_DIR)
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR "Could NOT find QtGlobal header")
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_INCLUDE_DIR)
-
-  #############################################
-  #
-  # Find out what window system we're using
-  #
-  #############################################
-  # Save required includes variable
-  SET(CMAKE_REQUIRED_INCLUDES_SAVE ${CMAKE_REQUIRED_INCLUDES})
-  # Add QT_INCLUDE_DIR to CMAKE_REQUIRED_INCLUDES
-  SET(CMAKE_REQUIRED_INCLUDES "${CMAKE_REQUIRED_INCLUDES};${QT_INCLUDE_DIR}")
-  # Check for Window system symbols (note: only one should end up being set)
-  CHECK_SYMBOL_EXISTS(Q_WS_X11 "QtCore/qglobal.h" Q_WS_X11)
-  CHECK_SYMBOL_EXISTS(Q_WS_MAC "QtCore/qglobal.h" Q_WS_MAC)
-  CHECK_SYMBOL_EXISTS(Q_WS_WIN "QtCore/qglobal.h" Q_WS_WIN)
-
-  IF (QT_QTCOPY_REQUIRED)
-     CHECK_SYMBOL_EXISTS(QT_IS_QTCOPY "QtCore/qglobal.h" QT_KDE_QT_COPY)
-     IF (NOT QT_IS_QTCOPY)
-        MESSAGE(FATAL_ERROR "qt-copy is required, but hasn't been found")
-     ENDIF (NOT QT_IS_QTCOPY)
-  ENDIF (QT_QTCOPY_REQUIRED)
-
-  # Restore CMAKE_REQUIRED_INCLUDES variable
-  SET(CMAKE_REQUIRED_INCLUDES ${CMAKE_REQUIRED_INCLUDES_SAVE})
-  #
-  #############################################
-
-  IF (QT_USE_FRAMEWORKS)
-    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -F${QT_LIBRARY_DIR} -L${QT_LIBRARY_DIR} )
-  ENDIF (QT_USE_FRAMEWORKS)
-
-  # Set QT_QT3SUPPORT_INCLUDE_DIR
-  FIND_PATH(QT_QT3SUPPORT_INCLUDE_DIR Qt3Support
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt3Support
-    ${QT_LIBRARY_DIR}/Qt3Support.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QT_INCLUDE_DIR
-  FIND_PATH(QT_QT_INCLUDE_DIR qglobal.h
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTGUI_INCLUDE_DIR
-  FIND_PATH(QT_QTGUI_INCLUDE_DIR QtGui
-    PATHS
-    ${QT_INCLUDE_DIR}/QtGui
-    ${QT_LIBRARY_DIR}/QtGui.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSVG_INCLUDE_DIR
-  FIND_PATH(QT_QTSVG_INCLUDE_DIR QtSvg
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSvg
-    ${QT_LIBRARY_DIR}/QtSvg.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSVG_INCLUDE_DIR
-  FIND_PATH(QT_QTSCRIPT_INCLUDE_DIR QtScript
-    PATHS
-    ${QT_INCLUDE_DIR}/QtScript
-    ${QT_LIBRARY_DIR}/QtScript.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTTEST_INCLUDE_DIR
-  FIND_PATH(QT_QTTEST_INCLUDE_DIR QtTest
-    PATHS
-    ${QT_INCLUDE_DIR}/QtTest
-    ${QT_LIBRARY_DIR}/QtTest.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTUITOOLS_INCLUDE_DIR
-  FIND_PATH(QT_QTUITOOLS_INCLUDE_DIR QtUiTools
-    PATHS
-    ${QT_INCLUDE_DIR}/QtUiTools
-    ${QT_LIBRARY_DIR}/QtUiTools.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-
-
-  # Set QT_QTMOTIF_INCLUDE_DIR
-  IF(Q_WS_X11)
-    FIND_PATH(QT_QTMOTIF_INCLUDE_DIR QtMotif PATHS ${QT_INCLUDE_DIR}/QtMotif NO_DEFAULT_PATH )
-  ENDIF(Q_WS_X11)
-
-  # Set QT_QTNETWORK_INCLUDE_DIR
-  FIND_PATH(QT_QTNETWORK_INCLUDE_DIR QtNetwork
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNetwork
-    ${QT_LIBRARY_DIR}/QtNetwork.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTNSPLUGIN_INCLUDE_DIR
-  FIND_PATH(QT_QTNSPLUGIN_INCLUDE_DIR QtNsPlugin
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNsPlugin
-    ${QT_LIBRARY_DIR}/QtNsPlugin.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTOPENGL_INCLUDE_DIR
-  FIND_PATH(QT_QTOPENGL_INCLUDE_DIR QtOpenGL
-    PATHS
-    ${QT_INCLUDE_DIR}/QtOpenGL
-    ${QT_LIBRARY_DIR}/QtOpenGL.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSQL_INCLUDE_DIR
-  FIND_PATH(QT_QTSQL_INCLUDE_DIR QtSql
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSql
-    ${QT_LIBRARY_DIR}/QtSql.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTXML_INCLUDE_DIR
-  FIND_PATH(QT_QTXML_INCLUDE_DIR QtXml
-    PATHS
-    ${QT_INCLUDE_DIR}/QtXml
-    ${QT_LIBRARY_DIR}/QtXml.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTASSISTANT_INCLUDE_DIR
-  FIND_PATH(QT_QTASSISTANT_INCLUDE_DIR QtAssistant
-    PATHS
-    ${QT_INCLUDE_DIR}/QtAssistant
-    ${QT_HEADERS_DIR}/QtAssistant
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTDESIGNER_INCLUDE_DIR
-  FIND_PATH(QT_QTDESIGNER_INCLUDE_DIR QDesignerComponents
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDesigner
-    ${QT_HEADERS_DIR}/QtDesigner
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR
-  FIND_PATH(QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR QDesignerComponents
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDesigner
-    ${QT_HEADERS_DIR}/QtDesigner
-    NO_DEFAULT_PATH
-    )
-
-
-  # Set QT_QTDBUS_INCLUDE_DIR
-  FIND_PATH(QT_QTDBUS_INCLUDE_DIR QtDBus
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDBus
-    ${QT_HEADERS_DIR}/QtDBus
-    NO_DEFAULT_PATH
-    )
-
-  # Make variables changeble to the advanced user
-  MARK_AS_ADVANCED( QT_LIBRARY_DIR QT_INCLUDE_DIR QT_QT_INCLUDE_DIR QT_DOC_DIR QT_MKSPECS_DIR QT_PLUGINS_DIR)
-
-  # Set QT_INCLUDES
-  SET( QT_INCLUDES ${QT_INCLUDE_DIR} ${QT_QT_INCLUDE_DIR} ${QT_MKSPECS_DIR}/default )
-
-
-  ########################################
-  #
-  #       Setting the LIBRARY-Variables
-  #
-  ########################################
-
-  IF (QT_USE_FRAMEWORKS)
-    # If FIND_LIBRARY found libraries in Apple frameworks, we would NOT have
-    # to jump through these hoops.
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_QTCORE_FOUND TRUE)
-      SET(QT_QTCORE_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtCore" CACHE STRING "The QtCore library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_QTCORE_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-      SET(QT_QTGUI_FOUND TRUE)
-      SET(QT_QTGUI_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtGui" CACHE STRING "The QtGui library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-      SET(QT_QTGUI_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-      SET(QT_QT3SUPPORT_FOUND TRUE)
-      SET(QT_QT3SUPPORT_LIBRARY "-F${QT_LIBRARY_DIR} -framework Qt3Support" CACHE STRING "The Qt3Support library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-      SET(QT_QT3SUPPORT_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-      SET(QT_QTNETWORK_FOUND TRUE)
-      SET(QT_QTNETWORK_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtNetwork" CACHE STRING "The QtNetwork library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-      SET(QT_QTNETWORK_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-      SET(QT_QTOPENGL_FOUND TRUE)
-      SET(QT_QTOPENGL_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtOpenGL" CACHE STRING "The QtOpenGL library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-      SET(QT_QTOPENGL_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-      SET(QT_QTSQL_FOUND TRUE)
-      SET(QT_QTSQL_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtSql" CACHE STRING "The QtSql library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-      SET(QT_QTSQL_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-      SET(QT_QTXML_FOUND TRUE)
-      SET(QT_QTXML_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtXml" CACHE STRING "The QtXml library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-      SET(QT_QTXML_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-      SET(QT_QTSVG_FOUND TRUE)
-      SET(QT_QTSVG_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtSvg" CACHE STRING "The QtSvg library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-      SET(QT_QTSVG_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-      SET(QT_QTDBUS_FOUND TRUE)
-      SET(QT_QTDBUS_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtDBus" CACHE STRING "The QtDBus library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-      SET(QT_QTDBUS_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-      SET(QT_QTTEST_FOUND TRUE)
-      SET(QT_QTTEST_LIBRARY "-F${QT_LIBRARY_DIR} -framework QtTest" CACHE STRING "The QtTest library.")
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-      SET(QT_QTTEST_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-
-    # WTF?  why don't we have frameworks?  :P
-    # Set QT_QTUITOOLS_LIBRARY
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR} )
-    # Set QT_QTSCRIPT_LIBRARY
-    FIND_LIBRARY(QT_QTSCRIPT_LIBRARY NAMES QtScript QtScript4    PATHS ${QT_LIBRARY_DIR} )
-
-  ELSE (QT_USE_FRAMEWORKS)
-    
-    # Set QT_QTCORE_LIBRARY by searching for a lib with "QtCore."  as part of the filename
-    FIND_LIBRARY(QT_QTCORE_LIBRARY NAMES QtCore QtCore4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH )
-
-    # Set QT_QT3SUPPORT_LIBRARY
-    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY NAMES Qt3Support Qt3Support4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTGUI_LIBRARY
-    FIND_LIBRARY(QT_QTGUI_LIBRARY NAMES QtGui QtGui4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTMOTIF_LIBRARY
-    IF(Q_WS_X11)
-      FIND_LIBRARY(QT_QTMOTIF_LIBRARY NAMES QtMotif              PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-    ENDIF(Q_WS_X11)
-
-    # Set QT_QTNETWORK_LIBRARY
-    FIND_LIBRARY(QT_QTNETWORK_LIBRARY NAMES QtNetwork QtNetwork4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTNSPLUGIN_LIBRARY
-    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY NAMES QtNsPlugin          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTOPENGL_LIBRARY
-    FIND_LIBRARY(QT_QTOPENGL_LIBRARY NAMES QtOpenGL QtOpenGL4    PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSQL_LIBRARY
-    FIND_LIBRARY(QT_QTSQL_LIBRARY NAMES QtSql QtSql4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTXML_LIBRARY
-    FIND_LIBRARY(QT_QTXML_LIBRARY NAMES QtXml QtXml4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSVG_LIBRARY
-    FIND_LIBRARY(QT_QTSVG_LIBRARY NAMES QtSvg QtSvg4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSCRIPT_LIBRARY
-    FIND_LIBRARY(QT_QTSCRIPT_LIBRARY NAMES QtScript QtScript4    PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTUITOOLS_LIBRARY
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTTEST_LIBRARY
-    FIND_LIBRARY(QT_QTTEST_LIBRARY NAMES QtTest QtTest4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    FIND_LIBRARY(QT_QTDBUS_LIBRARY NAMES QtDBus QtDBus4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    IF(MSVC)
-      FIND_LIBRARY(QT_QTCORE_LIBRARY_DEBUG      NAMES QtCored4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_DEBUG  NAMES Qt3Supportd4        PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTGUI_LIBRARY_DEBUG       NAMES QtGuid4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTNETWORK_LIBRARY_DEBUG   NAMES QtNetworkd4         PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTOPENGL_LIBRARY_DEBUG    NAMES QtOpenGLd4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSQL_LIBRARY_DEBUG       NAMES QtSqld4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTXML_LIBRARY_DEBUG       NAMES QtXmld4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSVG_LIBRARY_DEBUG       NAMES QtSvgd4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSCRIPT_LIBRARY_DEBUG    NAMES QtScriptd4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_DEBUG   NAMES QtUiToolsd QtUiToolsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTTEST_LIBRARY_DEBUG      NAMES QtTestd4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDBUS_LIBRARY_DEBUG      NAMES QtDBusd4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_DEBUG NAMES QtAssistantClientd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_DEBUG           NAMES QtDesigner4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDESIGNERCOMPONENTS_LIBRARY_DEBUG NAMES QtDesignerComponentsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTMAIN_LIBRARY_DEBUG      NAMES qtmaind             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-    ENDIF(MSVC)
-
-  ENDIF (QT_USE_FRAMEWORKS)
-
-  IF( NOT QT_QTCORE_LIBRARY )
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR "Could NOT find QtCore. Check CMakeFiles/CMakeError.log for more details.")
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_QTCORE_LIBRARY )
-
-  # Set QT_QTASSISTANT_LIBRARY
-  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY NAMES QtAssistantClient QtAssistantClient4 QtAssistant QtAssistant4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-  # Set QT_QTDESIGNER_LIBRARY
-  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY NAMES QtDesigner QtDesigner4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-
-  # Set QT_QTDESIGNERCOMPONENTS_LIBRARY
-  FIND_LIBRARY(QT_QTDESIGNERCOMPONENTS_LIBRARY NAMES QtDesignerComponents QtDesignerComponents4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-
-  # Set QT_QTMAIN_LIBRARY
-  IF(WIN32)
-    FIND_LIBRARY(QT_QTMAIN_LIBRARY NAMES qtmain PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-  ENDIF(WIN32)
-
-  ############################################
-  #
-  # Check the existence of the libraries.
-  #
-  ############################################
-
-  MACRO (_QT4_ADJUST_LIB_VARS basename)
-    IF (QT_${basename}_LIBRARY OR QT_${basename}_LIBRARY_DEBUG)
-
-      IF(MSVC)
-
-        # Both set
-        IF (QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-          SET(QT_${basename}_LIBRARY optimized ${QT_${basename}_LIBRARY} debug ${QT_${basename}_LIBRARY_DEBUG})
-        ENDIF (QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-
-        # Only debug was found
-        IF (NOT QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-          SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY_DEBUG})
-        ENDIF (NOT QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-
-        # Hmm, is this used anywhere ? Yes, in UseQt4.cmake. We are currently incompatible :-(
-        SET(QT_${basename}_LIBRARIES optimized ${QT_${basename}_LIBRARY} debug ${QT_${basename}_LIBRARY_DEBUG})
-
-      ENDIF(MSVC)
-
-      SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY} CACHE FILEPATH "The Qt ${basename} library")
-
-      IF (QT_${basename}_LIBRARY)
-        SET(QT_${basename}_FOUND 1)
-      ENDIF (QT_${basename}_LIBRARY)
-      
-    ENDIF (QT_${basename}_LIBRARY OR QT_${basename}_LIBRARY_DEBUG)
-    
-    IF (QT_${basename}_INCLUDE_DIR)
-      #add the include directory to QT_INCLUDES
-      SET(QT_INCLUDES ${QT_INCLUDES} "${QT_${basename}_INCLUDE_DIR}")
-    ENDIF (QT_${basename}_INCLUDE_DIR)
-
-    # Make variables changeble to the advanced user
-    MARK_AS_ADVANCED(QT_${basename}_LIBRARY QT_${basename}_INCLUDE_DIR)
-  ENDMACRO (_QT4_ADJUST_LIB_VARS)
-
-
-  # Set QT_xyz_LIBRARY variable and add 
-  # library include path to QT_INCLUDES
-  _QT4_ADJUST_LIB_VARS(QTCORE)
-  _QT4_ADJUST_LIB_VARS(QTGUI)
-  _QT4_ADJUST_LIB_VARS(QT3SUPPORT)
-  _QT4_ADJUST_LIB_VARS(QTASSISTANT)
-  _QT4_ADJUST_LIB_VARS(QTDESIGNER)
-  _QT4_ADJUST_LIB_VARS(QTDESIGNERCOMPONENTS)
-  _QT4_ADJUST_LIB_VARS(QTNETWORK)
-  _QT4_ADJUST_LIB_VARS(QTNSPLUGIN)
-  _QT4_ADJUST_LIB_VARS(QTOPENGL)
-  _QT4_ADJUST_LIB_VARS(QTSQL)
-  _QT4_ADJUST_LIB_VARS(QTXML)
-  _QT4_ADJUST_LIB_VARS(QTSVG)
-  _QT4_ADJUST_LIB_VARS(QTSCRIPT)
-  _QT4_ADJUST_LIB_VARS(QTUITOOLS)
-  _QT4_ADJUST_LIB_VARS(QTTEST)
-  _QT4_ADJUST_LIB_VARS(QTDBUS)
-  
-  
-  # platform dependent libraries
-  IF(Q_WS_X11)
-    _QT4_ADJUST_LIB_VARS(QTMOTIF)
-  ENDIF(Q_WS_X11)
-  IF(WIN32)
-    _QT4_ADJUST_LIB_VARS(QTMAIN)
-  ENDIF(WIN32)
-
-  IF(QT_QTSCRIPT_LIBRARY AND QT_QTUITOOLS_LIBRARY)
-    SET(QT_QTUITOOLS_LIBRARY ${QT_QTUITOOLS_LIBRARY} ${QT_QTSCRIPT_LIBRARY} )
-  ENDIF(QT_QTSCRIPT_LIBRARY AND QT_QTUITOOLS_LIBRARY)
-
-  #######################################
-  #
-  #       Check the executables of Qt 
-  #          ( moc, uic, rcc )
-  #
-  #######################################
-
-
-  # find moc and uic using qmake
-  QT_QUERY_QMAKE(QT_MOC_EXECUTABLE_INTERNAL "QMAKE_MOC")
-  QT_QUERY_QMAKE(QT_UIC_EXECUTABLE_INTERNAL "QMAKE_UIC")
-
-  FILE(TO_CMAKE_PATH 
-    "${QT_MOC_EXECUTABLE_INTERNAL}" QT_MOC_EXECUTABLE_INTERNAL)
-  FILE(TO_CMAKE_PATH 
-    "${QT_UIC_EXECUTABLE_INTERNAL}" QT_UIC_EXECUTABLE_INTERNAL)
-
-  SET(QT_MOC_EXECUTABLE 
-    ${QT_MOC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The moc executable")
-  SET(QT_UIC_EXECUTABLE 
-    ${QT_UIC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The uic executable")
-
-  FIND_PROGRAM(QT_UIC3_EXECUTABLE
-    NAMES uic3
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_RCC_EXECUTABLE 
-    NAMES rcc
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_DBUSCPP2XML_EXECUTABLE 
-    NAMES qdbuscpp2xml
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_DBUSXML2CPP_EXECUTABLE 
-    NAMES qdbusxml2cpp
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  IF (QT_MOC_EXECUTABLE)
-     SET(QT_WRAP_CPP "YES")
-  ENDIF (QT_MOC_EXECUTABLE)
-
-  IF (QT_UIC_EXECUTABLE)
-     SET(QT_WRAP_UI "YES")
-  ENDIF (QT_UIC_EXECUTABLE)
-
-
-
-  MARK_AS_ADVANCED( QT_UIC_EXECUTABLE QT_UIC3_EXECUTABLE QT_MOC_EXECUTABLE QT_RCC_EXECUTABLE QT_DBUSXML2CPP_EXECUTABLE QT_DBUSCPP2XML_EXECUTABLE)
-
-  ######################################
-  #
-  #       Macros for building Qt files
-  #
-  ######################################
-
-  MACRO (QT4_GET_MOC_INC_DIRS _moc_INC_DIRS)
-     SET(${_moc_INC_DIRS})
-     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
-
-     FOREACH(_current ${_inc_DIRS})
-        SET(${_moc_INC_DIRS} ${${_moc_INC_DIRS}} "-I" ${_current})
-     ENDFOREACH(_current ${_inc_DIRS})
-  ENDMACRO(QT4_GET_MOC_INC_DIRS)
-
-
-  MACRO (QT4_GENERATE_MOC infile outfile )
-  # get include dirs
-     QT4_GET_MOC_INC_DIRS(moc_includes)
-
-     GET_FILENAME_COMPONENT(abs_infile ${infile} ABSOLUTE)
-
-     ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${abs_infile}
-        DEPENDS ${abs_infile})
-
-     SET_SOURCE_FILES_PROPERTIES(${outfile} PROPERTIES SKIP_AUTOMOC TRUE)  # dont run automoc on this file
-
-     MACRO_ADD_FILE_DEPENDENCIES(${abs_infile} ${outfile})
-  ENDMACRO (QT4_GENERATE_MOC)
-
-
-  # QT4_WRAP_CPP(outfiles inputfile ... )
-  # TODO  perhaps add support for -D, -U and other minor options
-
-  MACRO (QT4_WRAP_CPP outfiles )
-    # get include dirs
-    QT4_GET_MOC_INC_DIRS(moc_includes)
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/moc_${outfile}.cxx)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${it}
-        DEPENDS ${it})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH(it)
-
-  ENDMACRO (QT4_WRAP_CPP)
-
-
-  # QT4_WRAP_UI(outfiles inputfile ... )
-
-  MACRO (QT4_WRAP_UI outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_UIC_EXECUTABLE}
-        ARGS -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_WRAP_UI)
-
-
-  # QT4_ADD_RESOURCE(outfiles inputfile ... )
-  # TODO  perhaps consider adding support for compression and root options to rcc
-
-  MACRO (QT4_ADD_RESOURCES outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
-      #  parse file for dependencies
-      FILE(READ "${infile}" _RC_FILE_CONTENTS)
-      STRING(REGEX MATCHALL "<file[^<]+" _RC_FILES "${_RC_FILE_CONTENTS}")
-      
-      SET(_RC_DEPENDS)
-      FOREACH(_RC_FILE ${_RC_FILES})
-        STRING(REGEX REPLACE "^<file[^>]*>" "" _RC_FILE "${_RC_FILE}")
-        SET(_RC_DEPENDS ${_RC_DEPENDS} "${rc_path}/${_RC_FILE}")
-      ENDFOREACH(_RC_FILE)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_RCC_EXECUTABLE}
-        ARGS -name ${outfilename} -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile}
-        DEPENDS ${_RC_DEPENDS})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_ADD_RESOURCES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACE _sources _interface _basename)
-    GET_FILENAME_COMPONENT(_infile ${_interface} ABSOLUTE)
-    SET(_header ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.h)
-    SET(_impl   ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.cpp)
-    SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.moc)
-
-    GET_SOURCE_FILE_PROPERTY(_nonamespace ${_infile} NO_NAMESPACE)
-    IF ( _nonamespace )
-        SET(_params -N -m -p)
-    ELSE ( _nonamespace )
-        SET(_params -m -p)
-    ENDIF ( _nonamespace )
-
-     ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-        COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} ${_params} ${_basename} ${_infile}
-        DEPENDS ${_infile})
-
-    SET_SOURCE_FILES_PROPERTIES(${_impl} PROPERTIES SKIP_AUTOMOC TRUE)
-    
-    QT4_GENERATE_MOC(${_header} ${_moc})
-  
-    SET(${_sources} ${${_sources}} ${_impl} ${_header} ${_moc})
-    MACRO_ADD_FILE_DEPENDENCIES(${_impl} ${_moc})
-  
-  ENDMACRO(QT4_ADD_DBUS_INTERFACE)
- 
-  MACRO(QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE _sources _interface _basename)
-    SET_SOURCE_FILES_PROPERTIES(${_interface} PROPERTIES NO_NAMESPACE TRUE)
-    QT4_ADD_DBUS_INTERFACE(${_sources} ${_interface} ${_basename})
-  ENDMACRO(QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE)
-
-  # Internal (avoid to duplicate code between QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE and QT4_ADD_DBUS_INTERFACES 
-  MACRO(_QT4_ADD_DBUS_INTERFACES _sources _filename)
-        GET_FILENAME_COMPONENT(_infile ${_filename} ABSOLUTE)
-        # get the part before the ".xml" suffix
-        STRING(REGEX REPLACE "(.*[/\\.])?([^\\.]+)\\.xml" "\\2" _basename ${_current_FILE})
-        STRING(TOLOWER ${_basename} _basename)
-        QT4_ADD_DBUS_INTERFACE(${_sources} ${_infile} ${_basename}interface)     
-  ENDMACRO(_QT4_ADD_DBUS_INTERFACES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACES _sources)
-     FOREACH (_current_FILE ${ARGN})
-        _QT4_ADD_DBUS_INTERFACES(${_sources} ${_current_FILE})
-     ENDFOREACH (_current_FILE)
-  ENDMACRO(QT4_ADD_DBUS_INTERFACES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE _sources)
-    FOREACH (_current_FILE ${ARGN})
-	SET_SOURCE_FILES_PROPERTIES(${_current_FILE} PROPERTIES NO_NAMESPACE TRUE)
-        _QT4_ADD_DBUS_INTERFACES(${_sources} ${_current_FILE})
-    ENDFOREACH (_current_FILE)
-  ENDMACRO(QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE)
-  
-  MACRO(QT4_GENERATE_DBUS_INTERFACE _header) # _customName )
-    SET(_customName "${ARGV1}")
-    GET_FILENAME_COMPONENT(_in_file ${_header} ABSOLUTE)
-    GET_FILENAME_COMPONENT(_basename ${_header} NAME_WE)
-    
-    IF (_customName)
-      SET(_target ${CMAKE_CURRENT_BINARY_DIR}/${_customName})
-    ELSE (_customName)
-      SET(_target ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.xml)
-    ENDIF (_customName)
-  
-    ADD_CUSTOM_COMMAND(OUTPUT ${_target}
-        COMMAND ${QT_DBUSCPP2XML_EXECUTABLE} ${_in_file} > ${_target}
-        DEPENDS ${_in_file}
-    )
-  ENDMACRO(QT4_GENERATE_DBUS_INTERFACE)
-  
-  
-  MACRO(QT4_ADD_DBUS_ADAPTOR _sources _xml_file _include _parentClass) # _optionalBasename )
-    GET_FILENAME_COMPONENT(_infile ${_xml_file} ABSOLUTE)
-    
-    SET(_optionalBasename "${ARGV4}")
-    IF (_optionalBasename)
-       SET(_basename ${_optionalBasename} )
-    ELSE (_optionalBasename)
-       STRING(REGEX REPLACE "(.*[/\\.])?([^\\.]+)\\.xml" "\\2adaptor" _basename ${_infile})
-       STRING(TOLOWER ${_basename} _basename)
-    ENDIF (_optionalBasename)
-
-    SET(_optionalClassName "${ARGV5}")
-    SET(_header ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.h)
-    SET(_impl   ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.cpp)
-    SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.moc)
-
-    IF(_optionalClassName)
-       ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-          COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} -m -a ${_basename} -c ${_optionalClassName} -i ${_include} -l ${_parentClass} ${_infile}
-          DEPENDS ${_infile}
-        )
-    ELSE(_optionalClassName)
-       ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-          COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} -m -a ${_basename} -i ${_include} -l ${_parentClass} ${_infile}
-          DEPENDS ${_infile}
-        )
-    ENDIF(_optionalClassName)
-
-    QT4_GENERATE_MOC(${_header} ${_moc})
-    SET_SOURCE_FILES_PROPERTIES(${_impl} PROPERTIES SKIP_AUTOMOC TRUE)
-    MACRO_ADD_FILE_DEPENDENCIES(${_impl} ${_moc})
-
-    SET(${_sources} ${${_sources}} ${_impl} ${_header} ${_moc})
-  ENDMACRO(QT4_ADD_DBUS_ADAPTOR)
-
-   MACRO(QT4_AUTOMOC)
-      QT4_GET_MOC_INC_DIRS(_moc_INCS)
-
-      SET(_matching_FILES )
-      FOREACH (_current_FILE ${ARGN})
-
-         GET_FILENAME_COMPONENT(_abs_FILE ${_current_FILE} ABSOLUTE)
-         # if "SKIP_AUTOMOC" is set to true, we will not handle this file here.
-         # here. this is required to make bouic work correctly:
-         # we need to add generated .cpp files to the sources (to compile them),
-         # but we cannot let automoc handle them, as the .cpp files don't exist yet when
-         # cmake is run for the very first time on them -> however the .cpp files might
-         # exist at a later run. at that time we need to skip them, so that we don't add two
-         # different rules for the same moc file
-         GET_SOURCE_FILE_PROPERTY(_skip ${_abs_FILE} SKIP_AUTOMOC)
-
-         IF ( NOT _skip AND EXISTS ${_abs_FILE} )
-
-            FILE(READ ${_abs_FILE} _contents)
-
-            GET_FILENAME_COMPONENT(_abs_PATH ${_abs_FILE} PATH)
-
-            STRING(REGEX MATCHALL "#include +[^ ]+\\.moc[\">]" _match "${_contents}")
-            IF(_match)
-               FOREACH (_current_MOC_INC ${_match})
-                  STRING(REGEX MATCH "[^ <\"]+\\.moc" _current_MOC "${_current_MOC_INC}")
-
-                  GET_filename_component(_basename ${_current_MOC} NAME_WE)
-   #               SET(_header ${CMAKE_CURRENT_SOURCE_DIR}/${_basename}.h)
-                  SET(_header ${_abs_PATH}/${_basename}.h)
-                  SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_current_MOC})
-                  ADD_CUSTOM_COMMAND(OUTPUT ${_moc}
-                     COMMAND ${QT_MOC_EXECUTABLE}
-                     ARGS ${_moc_INCS} ${_header} -o ${_moc}
-                     DEPENDS ${_header}
-                  )
-
-                  MACRO_ADD_FILE_DEPENDENCIES(${_abs_FILE} ${_moc})
-               ENDFOREACH (_current_MOC_INC)
-            ENDIF(_match)
-         ENDIF ( NOT _skip AND EXISTS ${_abs_FILE} )
-      ENDFOREACH (_current_FILE)
-   ENDMACRO(QT4_AUTOMOC)
-
-
-
-  ######################################
-  #
-  #       decide if Qt got found
-  #
-  ######################################
-
-  # if the includes,libraries,moc,uic and rcc are found then we have it
-  IF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND "YES" )
-    IF( NOT Qt4_FIND_QUIETLY)
-      IF (WIN32)
-        MESSAGE(STATUS "Found Qt-Version ${QTVERSION} with qmake at ${QT_QMAKE_EXECUTABLE}")
-      ELSE (WIN32)
-        MESSAGE(STATUS "Found Qt-Version ${QTVERSION}")
-      ENDIF (WIN32)
-    ENDIF( NOT Qt4_FIND_QUIETLY)
-  ELSE( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND "NO")
-    SET(QT_QMAKE_EXECUTABLE "${QT_QMAKE_EXECUTABLE}-NOTFOUND" CACHE FILEPATH "Invalid qmake found" FORCE)
-    IF( Qt4_FIND_REQUIRED)
-      IF ( NOT QT_LIBRARY_DIR )
-	MESSAGE(STATUS "Qt libraries NOT found!")
-      ENDIF(NOT QT_LIBRARY_DIR )
-      IF ( NOT QT_INCLUDE_DIR )
-	MESSAGE(STATUS "Qt includes NOT found!")
-      ENDIF( NOT QT_INCLUDE_DIR )
-      IF ( NOT QT_MOC_EXECUTABLE )
-        MESSAGE(STATUS "Qt's moc NOT found!")
-      ENDIF( NOT QT_MOC_EXECUTABLE )
-      IF ( NOT QT_UIC_EXECUTABLE )
-        MESSAGE(STATUS "Qt's uic NOT found!")
-      ENDIF( NOT QT_UIC_EXECUTABLE )
-      IF ( NOT QT_RCC_EXECUTABLE )
-        MESSAGE(STATUS "Qt's rcc NOT found!")
-      ENDIF( NOT QT_RCC_EXECUTABLE )
-      MESSAGE( FATAL_ERROR "Qt libraries, includes, moc, uic or/and rcc NOT found!")
-    ENDIF( Qt4_FIND_REQUIRED)
-  ENDIF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND  QT_RCC_EXECUTABLE)
-  SET(QT_FOUND ${QT4_FOUND})
-
-
-  #######################################
-  #
-  #       System dependent settings  
-  #
-  #######################################
-  # for unix add X11 stuff
-  IF(UNIX)
-    # on OS X X11 may not be required
-    IF (Q_WS_X11)
-      FIND_PACKAGE(X11 REQUIRED)
-    ENDIF (Q_WS_X11)
-    FIND_PACKAGE(Threads)
-    SET(QT_QTCORE_LIBRARY ${QT_QTCORE_LIBRARY} ${CMAKE_THREAD_LIBS_INIT})
-  ENDIF(UNIX)
-
-
-  #######################################
-  #
-  #       compatibility settings 
-  #
-  #######################################
-  # Backwards compatibility for CMake1.4 and 1.2
-  SET (QT_MOC_EXE ${QT_MOC_EXECUTABLE} )
-  SET (QT_UIC_EXE ${QT_UIC_EXECUTABLE} )
-
-  SET( QT_QT_LIBRARY "")
-
-ELSE(QT4_QMAKE_FOUND)
-   
-   SET(QT_QMAKE_EXECUTABLE "${QT_QMAKE_EXECUTABLE}-NOTFOUND" CACHE FILEPATH "Invalid qmake found" FORCE)
-   IF(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD)
-         MESSAGE(FATAL_ERROR "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
-      ELSE(QT4_INSTALLED_VERSION_TOO_OLD)
-         MESSAGE( FATAL_ERROR "Qt qmake not found!")
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD)
-   ELSE(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-         MESSAGE(STATUS "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-   ENDIF(Qt4_FIND_REQUIRED)
- 
-ENDIF (QT4_QMAKE_FOUND)
-
-
+# - Find QT 4
+# This module can be used to find Qt4.
+# The most important issue is that the Qt4 qmake is available via the system path.
+# This qmake is then used to detect basically everything else.
+# This module defines a number of key variables and macros. First is 
+# QT_USE_FILE which is the path to a CMake file that can be included to compile
+# Qt 4 applications and libraries.  By default, the QtCore and QtGui 
+# libraries are loaded. This behavior can be changed by setting one or more 
+# of the following variables to true:
+#                    QT_DONT_USE_QTCORE
+#                    QT_DONT_USE_QTGUI
+#                    QT_USE_QT3SUPPORT
+#                    QT_USE_QTASSISTANT
+#                    QT_USE_QTDESIGNER
+#                    QT_USE_QTMOTIF
+#                    QT_USE_QTMAIN
+#                    QT_USE_QTNETWORK
+#                    QT_USE_QTNSPLUGIN
+#                    QT_USE_QTOPENGL
+#                    QT_USE_QTSQL
+#                    QT_USE_QTXML
+#                    QT_USE_QTSVG
+#                    QT_USE_QTTEST
+#                    QT_USE_QTUITOOLS
+#
+# All the libraries required are stored in a variable called QT_LIBRARIES.  
+# Add this variable to your TARGET_LINK_LIBRARIES.
+#  
+#  macro QT4_WRAP_CPP(outfiles inputfile ... )
+#  macro QT4_WRAP_UI(outfiles inputfile ... )
+#  macro QT4_ADD_RESOURCE(outfiles inputfile ... )
+#  macro QT4_AUTOMOC(inputfile ... )
+#  macro QT4_GENERATE_MOC(inputfile outputfile )
+#  
+#  QT_FOUND         If false, don't try to use Qt.
+#  QT4_FOUND        If false, don't try to use Qt 4.
+#                      
+#  QT_QTCORE_FOUND        True if QtCore was found.
+#  QT_QTGUI_FOUND         True if QtGui was found.
+#  QT_QT3SUPPORT_FOUND    True if Qt3Support was found.
+#  QT_QTASSISTANT_FOUND   True if QtAssistant was found.
+#  QT_QTDESIGNER_FOUND    True if QtDesigner was found.
+#  QT_QTMOTIF_FOUND       True if QtMotif was found.
+#  QT_QTNETWORK_FOUND     True if QtNetwork was found.
+#  QT_QTNSPLUGIN_FOUND    True if QtNsPlugin was found.
+#  QT_QTOPENGL_FOUND      True if QtOpenGL was found.
+#  QT_QTSQL_FOUND         True if QtSql was found.
+#  QT_QTXML_FOUND         True if QtXml was found.
+#  QT_QTSVG_FOUND         True if QtSvg was found.
+#  QT_QTTEST_FOUND        True if QtTest was found.
+#  QT_QTUITOOLS_FOUND     True if QtUiTools was found.
+#                      
+#  QT_DEFINITIONS   Definitions to use when compiling code that uses Qt.
+#                  
+#  QT_INCLUDES      List of paths to all include directories of 
+#                   Qt4 QT_INCLUDE_DIR and QT_QTCORE_INCLUDE_DIR are
+#                   always in this variable even if NOTFOUND,
+#                   all other INCLUDE_DIRS are
+#                   only added if they are found.
+#   
+#  QT_INCLUDE_DIR              Path to "include" of Qt4
+#  QT_QT_INCLUDE_DIR           Path to "include/Qt" 
+#  QT_QT3SUPPORT_INCLUDE_DIR   Path to "include/Qt3Support" 
+#  QT_QTASSISTANT_INCLUDE_DIR  Path to "include/QtAssistant" 
+#  QT_QTCORE_INCLUDE_DIR       Path to "include/QtCore"         
+#  QT_QTDESIGNER_INCLUDE_DIR   Path to "include/QtDesigner" 
+#  QT_QTGUI_INCLUDE_DIR        Path to "include/QtGui" 
+#  QT_QTMOTIF_INCLUDE_DIR      Path to "include/QtMotif" 
+#  QT_QTNETWORK_INCLUDE_DIR    Path to "include/QtNetwork" 
+#  QT_QTNSPLUGIN_INCLUDE_DIR   Path to "include/QtNsPlugin" 
+#  QT_QTOPENGL_INCLUDE_DIR     Path to "include/QtOpenGL" 
+#  QT_QTSQL_INCLUDE_DIR        Path to "include/QtSql" 
+#  QT_QTXML_INCLUDE_DIR        Path to "include/QtXml" 
+#  QT_QTSVG_INCLUDE_DIR        Path to "include/QtSvg"
+#  QT_QTTEST_INCLUDE_DIR       Path to "include/QtTest"
+#                            
+#  QT_LIBRARY_DIR              Path to "lib" of Qt4
+#                            
+#  QT_PLUGINS_DIR              Path to "plugins" for Qt4
+#                            
+# For every library of Qt there are three variables:
+#  QT_QTFOO_LIBRARY_RELEASE, which contains the full path to the release version
+#  QT_QTFOO_LIBRARY_DEBUG, which contains the full path to the debug version
+#  QT_QTFOO_LIBRARY, the full path to the release version if available, otherwise to the debug version
+#
+# So there are the following variables:
+# The Qt3Support library:     QT_QT3SUPPORT_LIBRARY
+#                             QT_QT3SUPPORT_LIBRARY_RELEASE
+#                             QT_QT3SUPPORT_DEBUG
+#
+# The QtAssistant library:    QT_QTASSISTANT_LIBRARY
+#                             QT_QTASSISTANT_LIBRARY_RELEASE
+#                             QT_QTASSISTANT_LIBRARY_DEBUG
+#
+# The QtCore library:         QT_QTCORE_LIBRARY
+#                             QT_QTCORE_LIBRARY_RELEASE
+#                             QT_QTCORE_LIBRARY_DEBUG
+#
+# The QtDesigner library:     QT_QTDESIGNER_LIBRARY
+#                             QT_QTDESIGNER_LIBRARY_RELEASE
+#                             QT_QTDESIGNER_LIBRARY_DEBUG
+#
+# The QtGui library:          QT_QTGUI_LIBRARY
+#                             QT_QTGUI_LIBRARY_RELEASE
+#                             QT_QTGUI_LIBRARY_DEBUG
+#
+# The QtMotif library:        QT_QTMOTIF_LIBRARY
+#                             QT_QTMOTIF_LIBRARY_RELEASE
+#                             QT_QTMOTIF_LIBRARY_DEBUG
+#
+# The QtNetwork library:      QT_QTNETWORK_LIBRARY
+#                             QT_QTNETWORK_LIBRARY_RELEASE
+#                             QT_QTNETWORK_LIBRARY_DEBUG
+#
+# The QtNsPLugin library:     QT_QTNSPLUGIN_LIBRARY
+#                             QT_QTNSPLUGIN_LIBRARY_RELEASE
+#                             QT_QTNSPLUGIN_LIBRARY_DEBUG
+#
+# The QtOpenGL library:       QT_QTOPENGL_LIBRARY
+#                             QT_QTOPENGL_LIBRARY_RELEASE
+#                             QT_QTOPENGL_LIBRARY_DEBUG
+#
+# The QtSql library:          QT_QTSQL_LIBRARY
+#                             QT_QTSQL_LIBRARY_RELEASE
+#                             QT_QTSQL_LIBRARY_DEBUG
+#
+# The QtXml library:          QT_QTXML_LIBRARY
+#                             QT_QTXML_LIBRARY_RELEASE
+#                             QT_QTXML_LIBRARY_DEBUG
+#
+# The QtSvg library:          QT_QTSVG_LIBRARY
+#                             QT_QTSVG_LIBRARY_RELEASE
+#                             QT_QTSVG_LIBRARY_DEBUG
+#
+# The QtTest library:         QT_QTTEST_LIBRARY
+#                             QT_QTTEST_LIBRARY_RELEASE
+#                             QT_QTTEST_LIBRARY_DEBUG
+#
+# The qtmain library for Windows QT_QTMAIN_LIBRARY
+#                             QT_QTMAIN_LIBRARY_RELEASE
+#                             QT_QTMAIN_LIBRARY_DEBUG
+#
+#The QtUiTools library:       QT_QTUITOOLS_LIBRARY
+#                             QT_QTUITOOLS_LIBRARY_RELEASE
+#                             QT_QTUITOOLS_LIBRARY_DEBUG
+#  
+# also defined, but NOT for general use are
+#  QT_MOC_EXECUTABLE          Where to find the moc tool.
+#  QT_UIC_EXECUTABLE          Where to find the uic tool.
+#  QT_UIC3_EXECUTABLE         Where to find the uic3 tool.
+#  QT_RCC_EXECUTABLE          Where to find the rcc tool
+#  
+#  QT_DOC_DIR                 Path to "doc" of Qt4
+#  QT_MKSPECS_DIR             Path to "mkspecs" of Qt4
+#
+#
+# These are around for backwards compatibility 
+# they will be set
+#  QT_WRAP_CPP  Set true if QT_MOC_EXECUTABLE is found
+#  QT_WRAP_UI   Set true if QT_UIC_EXECUTABLE is found
+#  
+# These variables do _NOT_ have any effect anymore (compared to FindQt.cmake)
+#  QT_MT_REQUIRED         Qt4 is now always multithreaded
+#  
+# These variables are set to "" Because Qt structure changed 
+# (They make no sense in Qt4)
+#  QT_QT_LIBRARY        Qt-Library is now split
+
+INCLUDE(CheckSymbolExists)
+INCLUDE(MacroAddFileDependencies)
+
+SET(QT_USE_FILE ${CMAKE_ROOT}/Modules/UseQt4.cmake)
+
+SET( QT_DEFINITIONS "")
+
+# check for qmake
+FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake-qt4 PATHS
+  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
+  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
+  $ENV{QTDIR}/bin
+  )
+
+SET(QT4_INSTALLED_VERSION_TOO_OLD FALSE)
+
+##  macro for asking qmake to process pro files
+MACRO(QT_QUERY_QMAKE outvar invar)
+  FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake/tmp.pro
+    "message(CMAKE_MESSAGE<$$${invar}>)")
+  EXECUTE_PROCESS(COMMAND ${QT_QMAKE_EXECUTABLE}
+    WORKING_DIRECTORY  
+    ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake
+    OUTPUT_VARIABLE _qmake_query_output
+    ERROR_VARIABLE _qmake_query_output )
+  FILE(REMOVE_RECURSE 
+    "${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake")
+  STRING(REGEX REPLACE ".*CMAKE_MESSAGE<([^>]*).*" "\\1" ${outvar} "${_qmake_query_output}")
+ENDMACRO(QT_QUERY_QMAKE)
+
+
+IF (QT_QMAKE_EXECUTABLE)
+
+   SET(QT4_QMAKE_FOUND FALSE)
+   
+   EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
+  # check for qt3 qmake and then try and find qmake-qt4 in the path
+  IF("${QTVERSION}" MATCHES "Unknown")
+    SET(QT_QMAKE_EXECUTABLE NOTFOUND CACHE FILEPATH "" FORCE)
+    FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake-qt4 PATHS
+      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
+      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
+      $ENV{QTDIR}/bin
+      )
+    IF(QT_QMAKE_EXECUTABLE)
+      EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} 
+        ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
+    ENDIF(QT_QMAKE_EXECUTABLE)
+  ENDIF("${QTVERSION}" MATCHES "Unknown")
+   # check that we found the Qt4 qmake, Qt3 qmake output won't match here
+   STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" qt_version_tmp "${QTVERSION}")
+   IF (qt_version_tmp)
+
+      # we need at least version 4.0.0
+      IF (NOT QT_MIN_VERSION)
+         SET(QT_MIN_VERSION "4.0.0")
+      ENDIF (NOT QT_MIN_VERSION)
+   
+      #now parse the parts of the user given version string into variables
+      STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" req_qt_major_vers "${QT_MIN_VERSION}")
+      IF (NOT req_qt_major_vers)
+         MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", expected e.g. \"4.0.1\"")
+      ENDIF (NOT req_qt_major_vers)
+   
+      # now parse the parts of the user given version string into variables
+      STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+" "\\1" req_qt_major_vers "${QT_MIN_VERSION}")
+      STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+" "\\1" req_qt_minor_vers "${QT_MIN_VERSION}")
+      STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+)" "\\1" req_qt_patch_vers "${QT_MIN_VERSION}")
+   
+      IF (NOT req_qt_major_vers EQUAL 4)
+         MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", major version 4 is required, e.g. \"4.0.1\"")
+      ENDIF (NOT req_qt_major_vers EQUAL 4)
+   
+      # and now the version string given by qmake
+      STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+.*" "\\1" found_qt_major_vers "${QTVERSION}")
+      STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+.*" "\\1" found_qt_minor_vers "${QTVERSION}")
+      STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+).*" "\\1" found_qt_patch_vers "${QTVERSION}")
+   
+      # compute an overall version number which can be compared at once
+      MATH(EXPR req_vers "${req_qt_major_vers}*10000 + ${req_qt_minor_vers}*100 + ${req_qt_patch_vers}")
+      MATH(EXPR found_vers "${found_qt_major_vers}*10000 + ${found_qt_minor_vers}*100 + ${found_qt_patch_vers}")
+   
+      IF (found_vers LESS req_vers)
+         SET(QT4_QMAKE_FOUND FALSE)
+         SET(QT4_INSTALLED_VERSION_TOO_OLD TRUE)
+      ELSE (found_vers LESS req_vers)
+    SET(QT4_QMAKE_FOUND TRUE)
+      ENDIF (found_vers LESS req_vers)
+   ENDIF (qt_version_tmp)
+
+ENDIF (QT_QMAKE_EXECUTABLE)
+
+IF (QT4_QMAKE_FOUND)
+
+  # ask qmake for the library dir
+  # Set QT_LIBRARY_DIR
+  IF (NOT QT_LIBRARY_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS "-query QT_INSTALL_LIBS"
+      OUTPUT_VARIABLE QT_LIBRARY_DIR_TMP )
+    IF(EXISTS "${QT_LIBRARY_DIR_TMP}")
+      SET(QT_LIBRARY_DIR ${QT_LIBRARY_DIR_TMP} CACHE PATH "Qt library dir")
+    ELSE(EXISTS "${QT_LIBRARY_DIR_TMP}")
+      MESSAGE("Warning: QT_QMAKE_EXECUTABLE reported QT_INSTALL_LIBS as ${QT_LIBRARY_DIR_TMP}")
+       MESSAGE("Warning: ${QT_LIBRARY_DIR_TMP} does NOT exist, Qt must NOT be installed correctly.")
+    ENDIF(EXISTS "${QT_LIBRARY_DIR_TMP}")
+  ENDIF(NOT QT_LIBRARY_DIR)
+  
+  IF (APPLE)
+    IF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+      SET(QT_USE_FRAMEWORKS ON
+        CACHE BOOL "Set to ON if Qt build uses frameworks.")
+    ELSE (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+      SET(QT_USE_FRAMEWORKS OFF
+        CACHE BOOL "Set to ON if Qt build uses frameworks.")
+    ENDIF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+    
+    MARK_AS_ADVANCED(QT_USE_FRAMEWORKS)
+  ENDIF (APPLE)
+  
+  # ask qmake for the binary dir
+  IF (NOT QT_BINARY_DIR)
+     EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE}
+        ARGS "-query QT_INSTALL_BINS"
+        OUTPUT_VARIABLE qt_bins )
+     SET(QT_BINARY_DIR ${qt_bins} CACHE INTERNAL "")
+  ENDIF (NOT QT_BINARY_DIR)
+
+  # ask qmake for the include dir
+  IF (NOT QT_HEADERS_DIR)
+      EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+        ARGS "-query QT_INSTALL_HEADERS" 
+        OUTPUT_VARIABLE qt_headers )
+      SET(QT_HEADERS_DIR ${qt_headers} CACHE INTERNAL "")
+  ENDIF(NOT QT_HEADERS_DIR)
+
+
+  # ask qmake for the documentation directory
+  IF (NOT QT_DOC_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS "-query QT_INSTALL_DOCS"
+      OUTPUT_VARIABLE qt_doc_dir )
+    SET(QT_DOC_DIR ${qt_doc_dir} CACHE PATH "The location of the Qt docs")
+  ENDIF (NOT QT_DOC_DIR)
+
+  # ask qmake for the mkspecs directory
+  IF (NOT QT_MKSPECS_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS "-query QMAKE_MKSPECS"
+      OUTPUT_VARIABLE qt_mkspecs_dir )
+    SET(QT_MKSPECS_DIR ${qt_mkspecs_dir} CACHE PATH "The location of the Qt mkspecs")
+  ENDIF (NOT QT_MKSPECS_DIR)
+
+  # ask qmake for the plugins directory
+  IF (NOT QT_PLUGINS_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS "-query QT_INSTALL_PLUGINS"
+      OUTPUT_VARIABLE qt_plugins_dir )
+    SET(QT_PLUGINS_DIR ${qt_plugins_dir} CACHE PATH "The location of the Qt plugins")
+  ENDIF (NOT QT_PLUGINS_DIR)
+  ########################################
+  #
+  #       Setting the INCLUDE-Variables
+  #
+  ########################################
+
+  FIND_PATH(QT_QTCORE_INCLUDE_DIR QtGlobal
+    ${QT_HEADERS_DIR}/QtCore
+    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
+    NO_DEFAULT_PATH
+   )
+
+  # Set QT_INCLUDE_DIR by removine "/QtCore" in the string ${QT_QTCORE_INCLUDE_DIR}
+  IF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
+    IF (QT_USE_FRAMEWORKS)
+      SET(QT_INCLUDE_DIR ${QT_HEADERS_DIR})
+    ELSE (QT_USE_FRAMEWORKS)
+      STRING( REGEX REPLACE "/QtCore$" "" qt4_include_dir ${QT_QTCORE_INCLUDE_DIR})
+      SET( QT_INCLUDE_DIR ${qt4_include_dir} CACHE PATH "")
+    ENDIF (QT_USE_FRAMEWORKS)
+  ENDIF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
+
+  IF( NOT QT_INCLUDE_DIR)
+    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR "Could NOT find QtGlobal header")
+    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+  ENDIF( NOT QT_INCLUDE_DIR)
+
+  #############################################
+  #
+  # Find out what window system we're using
+  #
+  #############################################
+  # Save required includes variable
+  SET(CMAKE_REQUIRED_INCLUDES_SAVE ${CMAKE_REQUIRED_INCLUDES})
+  # Add QT_INCLUDE_DIR to CMAKE_REQUIRED_INCLUDES
+  SET(CMAKE_REQUIRED_INCLUDES "${CMAKE_REQUIRED_INCLUDES};${QT_INCLUDE_DIR}")
+  # Check for Window system symbols (note: only one should end up being set)
+  CHECK_SYMBOL_EXISTS(Q_WS_X11 "QtCore/qglobal.h" Q_WS_X11)
+  CHECK_SYMBOL_EXISTS(Q_WS_MAC "QtCore/qglobal.h" Q_WS_MAC)
+  CHECK_SYMBOL_EXISTS(Q_WS_WIN "QtCore/qglobal.h" Q_WS_WIN)
+
+  IF (QT_QTCOPY_REQUIRED)
+     CHECK_SYMBOL_EXISTS(QT_IS_QTCOPY "QtCore/qglobal.h" QT_KDE_QT_COPY)
+     IF (NOT QT_IS_QTCOPY)
+        MESSAGE(FATAL_ERROR "qt-copy is required, but hasn't been found")
+     ENDIF (NOT QT_IS_QTCOPY)
+  ENDIF (QT_QTCOPY_REQUIRED)
+
+  # Restore CMAKE_REQUIRED_INCLUDES variable
+  SET(CMAKE_REQUIRED_INCLUDES ${CMAKE_REQUIRED_INCLUDES_SAVE})
+  #
+  #############################################
+
+  IF (QT_USE_FRAMEWORKS)
+    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -F${QT_LIBRARY_DIR} -L${QT_LIBRARY_DIR} )
+  ENDIF (QT_USE_FRAMEWORKS)
+
+  # Set QT_QT3SUPPORT_INCLUDE_DIR
+  FIND_PATH(QT_QT3SUPPORT_INCLUDE_DIR Qt3Support
+    PATHS
+    ${QT_INCLUDE_DIR}/Qt3Support
+    ${QT_LIBRARY_DIR}/Qt3Support.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QT_INCLUDE_DIR
+  FIND_PATH(QT_QT_INCLUDE_DIR qglobal.h
+    PATHS
+    ${QT_INCLUDE_DIR}/Qt
+    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTGUI_INCLUDE_DIR
+  FIND_PATH(QT_QTGUI_INCLUDE_DIR QtGui
+    PATHS
+    ${QT_INCLUDE_DIR}/QtGui
+    ${QT_LIBRARY_DIR}/QtGui.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTSVG_INCLUDE_DIR
+  FIND_PATH(QT_QTSVG_INCLUDE_DIR QtSvg
+    PATHS
+    ${QT_INCLUDE_DIR}/QtSvg
+    ${QT_LIBRARY_DIR}/QtSvg.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTTEST_INCLUDE_DIR
+  FIND_PATH(QT_QTTEST_INCLUDE_DIR QtTest
+    PATHS
+    ${QT_INCLUDE_DIR}/QtTest
+    ${QT_LIBRARY_DIR}/QtTest.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTUITOOLS_INCLUDE_DIR
+  FIND_PATH(QT_QTUITOOLS_INCLUDE_DIR QtUiTools
+    PATHS
+    ${QT_INCLUDE_DIR}/QtUiTools
+    ${QT_LIBRARY_DIR}/QtUiTools.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+
+
+  # Set QT_QTMOTIF_INCLUDE_DIR
+  IF(Q_WS_X11)
+    FIND_PATH(QT_QTMOTIF_INCLUDE_DIR QtMotif PATHS ${QT_INCLUDE_DIR}/QtMotif NO_DEFAULT_PATH )
+  ENDIF(Q_WS_X11)
+
+  # Set QT_QTNETWORK_INCLUDE_DIR
+  FIND_PATH(QT_QTNETWORK_INCLUDE_DIR QtNetwork
+    PATHS
+    ${QT_INCLUDE_DIR}/QtNetwork
+    ${QT_LIBRARY_DIR}/QtNetwork.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTNSPLUGIN_INCLUDE_DIR
+  FIND_PATH(QT_QTNSPLUGIN_INCLUDE_DIR QtNsPlugin
+    PATHS
+    ${QT_INCLUDE_DIR}/QtNsPlugin
+    ${QT_LIBRARY_DIR}/QtNsPlugin.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTOPENGL_INCLUDE_DIR
+  FIND_PATH(QT_QTOPENGL_INCLUDE_DIR QtOpenGL
+    PATHS
+    ${QT_INCLUDE_DIR}/QtOpenGL
+    ${QT_LIBRARY_DIR}/QtOpenGL.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTSQL_INCLUDE_DIR
+  FIND_PATH(QT_QTSQL_INCLUDE_DIR QtSql
+    PATHS
+    ${QT_INCLUDE_DIR}/QtSql
+    ${QT_LIBRARY_DIR}/QtSql.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTXML_INCLUDE_DIR
+  FIND_PATH(QT_QTXML_INCLUDE_DIR QtXml
+    PATHS
+    ${QT_INCLUDE_DIR}/QtXml
+    ${QT_LIBRARY_DIR}/QtXml.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTASSISTANT_INCLUDE_DIR
+  FIND_PATH(QT_QTASSISTANT_INCLUDE_DIR QtAssistant
+    PATHS
+    ${QT_INCLUDE_DIR}/QtAssistant
+    ${QT_HEADERS_DIR}/QtAssistant
+    ${QT_LIBRARY_DIR}/QtAssistant.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTDESIGNER_INCLUDE_DIR
+  FIND_PATH(QT_QTDESIGNER_INCLUDE_DIR QDesignerComponents
+    PATHS
+    ${QT_INCLUDE_DIR}/QtDesigner
+    ${QT_HEADERS_DIR}/QtDesigner
+    ${QT_LIBRARY_DIR}/QtDesigner.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Make variables changeble to the advanced user
+  MARK_AS_ADVANCED( QT_LIBRARY_DIR QT_INCLUDE_DIR QT_QT_INCLUDE_DIR QT_DOC_DIR)
+
+  # Set QT_INCLUDES
+  SET( QT_INCLUDES ${QT_INCLUDE_DIR} ${QT_QT_INCLUDE_DIR} ${QT_MKSPECS_DIR}/default )
+
+    # Set QT_QTCORE_LIBRARY by searching for a lib with "QtCore."  as part of the filename
+    FIND_LIBRARY(QT_QTCORE_LIBRARY_RELEASE NAMES QtCore QtCore4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH )
+  FIND_LIBRARY(QT_QTCORE_LIBRARY_DEBUG NAMES QtCore_debug QtCored QtCored4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QT3SUPPORT_LIBRARY
+    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_RELEASE NAMES Qt3Support Qt3Support4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_DEBUG   NAMES Qt3Support_debug Qt3Supportd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTGUI_LIBRARY
+    FIND_LIBRARY(QT_QTGUI_LIBRARY_RELEASE NAMES QtGui QtGui4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTGUI_LIBRARY_DEBUG   NAMES QtGui_debug QtGuid4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTMOTIF_LIBRARY
+    IF(Q_WS_X11)
+      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_RELEASE NAMES QtMotif PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
+      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_DEBUG   NAMES QtMotif_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+    ENDIF(Q_WS_X11)
+
+    # Set QT_QTNETWORK_LIBRARY
+    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_RELEASE NAMES QtNetwork QtNetwork4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_DEBUG   NAMES QtNetwork_debug QtNetworkd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTNSPLUGIN_LIBRARY
+    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_RELEASE NAMES QtNsPlugin PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_DEBUG   NAMES QtNsPlugin_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTOPENGL_LIBRARY
+    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_RELEASE NAMES QtOpenGL QtOpenGL4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_DEBUG   NAMES QtOpenGL_debug QtOpenGLd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTSQL_LIBRARY
+    FIND_LIBRARY(QT_QTSQL_LIBRARY_RELEASE NAMES QtSql QtSql4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTSQL_LIBRARY_DEBUG   NAMES QtSql_debug QtSqld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTXML_LIBRARY
+    FIND_LIBRARY(QT_QTXML_LIBRARY_RELEASE NAMES QtXml QtXml4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTXML_LIBRARY_DEBUG   NAMES QtXml_debug QtXmld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTSVG_LIBRARY
+    FIND_LIBRARY(QT_QTSVG_LIBRARY_RELEASE NAMES QtSvg QtSvg4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTSVG_LIBRARY_DEBUG   NAMES QtSvg_debug QtSvgd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTUITOOLS_LIBRARY
+    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_RELEASE NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_DEBUG   NAMES QtUiTools_debug QtUiToolsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTTEST_LIBRARY
+    FIND_LIBRARY(QT_QTTEST_LIBRARY_RELEASE NAMES QtTest QtTest4 PATHS ${QT_LIBRARY_DIR}                      NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTTEST_LIBRARY_DEBUG   NAMES QtTest_debug QtTest_debug4 QtTestd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    MARK_AS_ADVANCED(QT_QT3SUPPORT_LIBRARY QT_QTGUI_LIBRARY )
+
+  IF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
+    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR "Could NOT find QtCore. Check ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeError.log for more details.")
+    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+  ENDIF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
+
+  # Set QT_QTASSISTANT_LIBRARY
+  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_RELEASE NAMES QtAssistantClient QtAssistantClient4 QtAssistant QtAssistant4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_DEBUG   NAMES QtAssistantClientd QtAssistantClientd4 QtAssistantClient_debug QtAssistant_debug QtAssistantd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+  # Set QT_QTDESIGNER_LIBRARY
+  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_RELEASE NAMES QtDesigner QtDesigner4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_DEBUG   NAMES QtDesigner_debug QtDesignerd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+  # Set QT_QTMAIN_LIBRARY
+  IF(WIN32)
+    FIND_LIBRARY(QT_QTMAIN_LIBRARY_RELEASE NAMES qtmain PATHS ${QT_LIBRARY_DIR}
+      NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTMAIN_LIBRARY_DEBUG NAMES qtmaind PATHS ${QT_LIBRARY_DIR}
+      NO_DEFAULT_PATH)
+  ENDIF(WIN32)
+
+  ############################################
+  #
+  # Check the existence of the libraries.
+  #
+  ############################################
+
+  MACRO (_QT4_ADJUST_LIB_VARS basename)
+    IF (QT_${basename}_INCLUDE_DIR)
+
+      # if only the release version was found, set the debug variable also to the release version
+      IF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
+        SET(QT_${basename}_LIBRARY_DEBUG ${QT_${basename}_LIBRARY_RELEASE})
+        SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE})
+        SET(QT_${basename}_LIBRARIES     ${QT_${basename}_LIBRARY_RELEASE})
+      ENDIF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
+
+      # if only the debug version was found, set the release variable also to the debug version
+      IF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
+        SET(QT_${basename}_LIBRARY_RELEASE ${QT_${basename}_LIBRARY_DEBUG})
+        SET(QT_${basename}_LIBRARY         ${QT_${basename}_LIBRARY_DEBUG})
+        SET(QT_${basename}_LIBRARIES       ${QT_${basename}_LIBRARY_DEBUG})
+      ENDIF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
+      IF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
+        # if the generator supports configuration types then set
+        # optimized and debug libraries, or if the CMAKE_BUILD_TYPE has a value
+        IF (CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+          SET(QT_${basename}_LIBRARY       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
+        ELSE(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+          # if there are no configuration types and CMAKE_BUILD_TYPE has no value
+          # then just use the release libraries
+          SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE} )
+        ENDIF(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+        SET(QT_${basename}_LIBRARIES       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
+      ENDIF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
+
+      SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY} CACHE FILEPATH "The Qt ${basename} library")
+
+      IF (QT_${basename}_LIBRARY)
+        SET(QT_${basename}_FOUND 1)
+      ENDIF (QT_${basename}_LIBRARY)
+
+      #add the include directory to QT_INCLUDES
+      SET(QT_INCLUDES ${QT_INCLUDES} "${QT_${basename}_INCLUDE_DIR}")
+    ENDIF (QT_${basename}_INCLUDE_DIR )
+
+    # Make variables changeble to the advanced user
+    MARK_AS_ADVANCED(QT_${basename}_LIBRARY QT_${basename}_LIBRARY_RELEASE QT_${basename}_LIBRARY_DEBUG QT_${basename}_INCLUDE_DIR)
+  ENDMACRO (_QT4_ADJUST_LIB_VARS)
+
+  IF(WIN32)
+    # there is no include for qtmain but adjust macro needs it set
+    SET(QT_QTMAIN_INCLUDE_DIR 1)
+     _QT4_ADJUST_LIB_VARS(QTMAIN)
+    SET(QT_QTMAIN_INCLUDE_DIR )
+  ENDIF(WIN32)
+
+
+  _QT4_ADJUST_LIB_VARS(QTCORE)
+  _QT4_ADJUST_LIB_VARS(QTGUI)
+  _QT4_ADJUST_LIB_VARS(QT3SUPPORT)
+  _QT4_ADJUST_LIB_VARS(QTASSISTANT)
+  _QT4_ADJUST_LIB_VARS(QTDESIGNER)
+  IF(Q_WS_X11)
+    _QT4_ADJUST_LIB_VARS(QTMOTIF)
+  ENDIF(Q_WS_X11)
+  _QT4_ADJUST_LIB_VARS(QTNETWORK)
+  _QT4_ADJUST_LIB_VARS(QTNSPLUGIN)
+  _QT4_ADJUST_LIB_VARS(QTOPENGL)
+  _QT4_ADJUST_LIB_VARS(QTSQL)
+  _QT4_ADJUST_LIB_VARS(QTXML)
+  _QT4_ADJUST_LIB_VARS(QTSVG)
+  _QT4_ADJUST_LIB_VARS(QTUITOOLS)
+  _QT4_ADJUST_LIB_VARS(QTTEST)
+
+
+
+  #######################################
+  #
+  #       Check the executables of Qt 
+  #          ( moc, uic, rcc )
+  #
+  #######################################
+
+
+   # find moc and uic using qmake
+  QT_QUERY_QMAKE(QT_MOC_EXECUTABLE_INTERNAL "QMAKE_MOC")
+  QT_QUERY_QMAKE(QT_UIC_EXECUTABLE_INTERNAL "QMAKE_UIC")
+
+   FILE(TO_CMAKE_PATH 
+     "${QT_MOC_EXECUTABLE_INTERNAL}" QT_MOC_EXECUTABLE_INTERNAL)
+   FILE(TO_CMAKE_PATH 
+     "${QT_UIC_EXECUTABLE_INTERNAL}" QT_UIC_EXECUTABLE_INTERNAL)
+
+   SET(QT_MOC_EXECUTABLE 
+     ${QT_MOC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The moc executable")
+   SET(QT_UIC_EXECUTABLE 
+     ${QT_UIC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The uic executable")
+
+  FIND_PROGRAM(QT_UIC3_EXECUTABLE
+    NAMES uic3
+    PATHS ${QT_BINARY_DIR}
+    NO_DEFAULT_PATH
+    )
+
+  FIND_PROGRAM(QT_RCC_EXECUTABLE 
+    NAMES rcc
+    PATHS ${QT_BINARY_DIR}
+    NO_DEFAULT_PATH
+    )
+
+  IF (QT_MOC_EXECUTABLE)
+     SET(QT_WRAP_CPP "YES")
+  ENDIF (QT_MOC_EXECUTABLE)
+
+  IF (QT_UIC_EXECUTABLE)
+     SET(QT_WRAP_UI "YES")
+  ENDIF (QT_UIC_EXECUTABLE)
+
+
+
+  MARK_AS_ADVANCED( QT_UIC_EXECUTABLE QT_UIC3_EXECUTABLE QT_MOC_EXECUTABLE QT_RCC_EXECUTABLE )
+
+  ######################################
+  #
+  #       Macros for building Qt files
+  #
+  ######################################
+
+  MACRO (QT4_GET_MOC_INC_DIRS _moc_INC_DIRS)
+     SET(${_moc_INC_DIRS})
+     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
+
+     FOREACH(_current ${_inc_DIRS})
+        SET(${_moc_INC_DIRS} ${${_moc_INC_DIRS}} "-I" ${_current})
+     ENDFOREACH(_current ${_inc_DIRS})
+  ENDMACRO(QT4_GET_MOC_INC_DIRS)
+
+
+  MACRO (QT4_GENERATE_MOC infile outfile )
+  # get include dirs
+     QT4_GET_MOC_INC_DIRS(moc_includes)
+
+     GET_FILENAME_COMPONENT(infile ${infile} ABSOLUTE)
+
+     ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_MOC_EXECUTABLE}
+        ARGS ${moc_includes} -o ${outfile} ${infile}
+        DEPENDS ${infile})
+
+     MACRO_ADD_FILE_DEPENDENCIES(${infile} ${outfile})
+  ENDMACRO (QT4_GENERATE_MOC)
+
+
+  # QT4_WRAP_CPP(outfiles inputfile ... )
+  # TODO  perhaps add support for -D, -U and other minor options
+
+  MACRO (QT4_WRAP_CPP outfiles )
+    # get include dirs
+    QT4_GET_MOC_INC_DIRS(moc_includes)
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
+      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
+
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/moc_${outfile}.cxx)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_MOC_EXECUTABLE}
+        ARGS ${moc_includes} -o ${outfile} ${it}
+        DEPENDS ${it})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH(it)
+
+  ENDMACRO (QT4_WRAP_CPP)
+
+
+  # QT4_WRAP_UI(outfiles inputfile ... )
+
+  MACRO (QT4_WRAP_UI outfiles )
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_UIC_EXECUTABLE}
+        ARGS -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_WRAP_UI)
+
+
+  # QT4_ADD_RESOURCE(outfiles inputfile ... )
+  # TODO  perhaps consider adding support for compression and root options to rcc
+
+  MACRO (QT4_ADD_RESOURCES outfiles )
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
+      #  parse file for dependencies
+      FILE(READ "${infile}" _RC_FILE_CONTENTS)
+      STRING(REGEX MATCHALL "<file>[^<]*" _RC_FILES "${_RC_FILE_CONTENTS}")
+      SET(_RC_DEPENDS)
+      FOREACH(_RC_FILE ${_RC_FILES})
+        STRING(REGEX REPLACE "^<file>" "" _RC_FILE "${_RC_FILE}")
+        SET(_RC_DEPENDS ${_RC_DEPENDS} "${rc_path}/${_RC_FILE}")
+      ENDFOREACH(_RC_FILE)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_RCC_EXECUTABLE}
+        ARGS -name ${outfilename} -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile}
+        DEPENDS ${_RC_DEPENDS})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_ADD_RESOURCES)
+
+
+   MACRO(QT4_AUTOMOC)
+      QT4_GET_MOC_INC_DIRS(_moc_INCS)
+
+      SET(_matching_FILES )
+      FOREACH (_current_FILE ${ARGN})
+
+         GET_FILENAME_COMPONENT(_abs_FILE ${_current_FILE} ABSOLUTE)
+         # if "SKIP_AUTOMOC" is set to true, we will not handle this file here.
+         # here. this is required to make bouic work correctly:
+         # we need to add generated .cpp files to the sources (to compile them),
+         # but we cannot let automoc handle them, as the .cpp files don't exist yet when
+         # cmake is run for the very first time on them -> however the .cpp files might
+         # exist at a later run. at that time we need to skip them, so that we don't add two
+         # different rules for the same moc file
+         GET_SOURCE_FILE_PROPERTY(_skip ${_abs_FILE} SKIP_AUTOMOC)
+
+         IF ( NOT _skip AND EXISTS ${_abs_FILE} )
+
+            FILE(READ ${_abs_FILE} _contents)
+
+            GET_FILENAME_COMPONENT(_abs_PATH ${_abs_FILE} PATH)
+
+            STRING(REGEX MATCHALL "#include +[^ ]+\\.moc[\">]" _match "${_contents}")
+            IF(_match)
+               FOREACH (_current_MOC_INC ${_match})
+                  STRING(REGEX MATCH "[^ <\"]+\\.moc" _current_MOC "${_current_MOC_INC}")
+
+                  GET_filename_component(_basename ${_current_MOC} NAME_WE)
+   #               SET(_header ${CMAKE_CURRENT_SOURCE_DIR}/${_basename}.h)
+                  SET(_header ${_abs_PATH}/${_basename}.h)
+                  SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_current_MOC})
+                  ADD_CUSTOM_COMMAND(OUTPUT ${_moc}
+                     COMMAND ${QT_MOC_EXECUTABLE}
+                     ARGS ${_moc_INCS} ${_header} -o ${_moc}
+                     DEPENDS ${_header}
+                  )
+
+                  MACRO_ADD_FILE_DEPENDENCIES(${_abs_FILE} ${_moc})
+               ENDFOREACH (_current_MOC_INC)
+            ENDIF(_match)
+         ENDIF ( NOT _skip AND EXISTS ${_abs_FILE} )
+      ENDFOREACH (_current_FILE)
+   ENDMACRO(QT4_AUTOMOC)
+
+
+
+  ######################################
+  #
+  #       decide if Qt got found
+  #
+  ######################################
+
+  # if the includes,libraries,moc,uic and rcc are found then we have it
+  IF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
+    SET( QT4_FOUND "YES" )
+    IF( NOT Qt4_FIND_QUIETLY)
+      MESSAGE(STATUS "Found Qt-Version ${QTVERSION}")
+    ENDIF( NOT Qt4_FIND_QUIETLY)
+  ELSE( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
+    SET( QT4_FOUND "NO")
+    IF( Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR "Qt libraries, includes, moc, uic or/and rcc NOT found!")
+    ENDIF( Qt4_FIND_REQUIRED)
+  ENDIF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND  QT_RCC_EXECUTABLE)
+  SET(QT_FOUND ${QT4_FOUND})
+
+  #######################################
+  #
+  #       Qt configuration
+  #
+  #######################################
+  IF(EXISTS "${QT_MKSPECS_DIR}/qconfig.pri")
+    FILE(READ ${QT_MKSPECS_DIR}/qconfig.pri _qconfig_FILE_contents)
+    STRING(REGEX MATCH "QT_CONFIG[^\n]+" QT_QCONFIG ${_qconfig_FILE_contents})
+    STRING(REGEX MATCH "CONFIG[^\n]+" QT_CONFIG ${_qconfig_FILE_contents})
+  ENDIF(EXISTS "${QT_MKSPECS_DIR}/qconfig.pri")
+
+
+  ###############################################
+  #
+  #       configuration/system dependent settings  
+  #
+  ###############################################
+
+  SET(QT_GUI_LIB_DEPENDENCIES "")
+  SET(QT_CORE_LIB_DEPENDENCIES "")
+  
+  # shared build needs -DQT_SHARED
+  IF(NOT QT_CONFIG MATCHES "static")
+    # warning currently only qconfig.pri on Windows potentially contains "static"
+    # so QT_SHARED might not get defined properly on Mac/X11 (which seems harmless right now)
+    # Trolltech said they'd consider exporting it for all platforms in future releases.
+    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -DQT_SHARED)
+  ENDIF(NOT QT_CONFIG MATCHES "static")
+  
+  ## system png
+  IF(QT_QCONFIG MATCHES "system-png")
+    FIND_LIBRARY(QT_PNG_LIBRARY NAMES png)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_PNG_LIBRARY})
+    MARK_AS_ADVANCED(QT_PNG_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "system-png")
+  
+  # for X11, get X11 library directory
+  IF(Q_WS_X11)
+    QT_QUERY_QMAKE(QMAKE_LIBDIR_X11 "QMAKE_LIBDIR_X11")
+  ENDIF(Q_WS_X11)
+
+  ## X11 SM
+  IF(QT_QCONFIG MATCHES "x11sm")
+    # ask qmake where the x11 libs are
+    FIND_LIBRARY(QT_X11_SM_LIBRARY NAMES SM PATHS ${QMAKE_LIBDIR_X11})
+    FIND_LIBRARY(QT_X11_ICE_LIBRARY NAMES ICE PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_X11_SM_LIBRARY} ${QT_X11_ICE_LIBRARY})
+    MARK_AS_ADVANCED(QT_X11_SM_LIBRARY)
+    MARK_AS_ADVANCED(QT_X11_ICE_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "x11sm")
+  
+  ## Xi
+  IF(QT_QCONFIG MATCHES "tablet")
+    FIND_LIBRARY(QT_XI_LIBRARY NAMES Xi PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XI_LIBRARY})
+    MARK_AS_ADVANCED(QT_XI_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "tablet")
+
+  ## Xrender
+  IF(QT_QCONFIG MATCHES "xrender")
+    FIND_LIBRARY(QT_XRENDER_LIBRARY NAMES Xrender PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRENDER_LIBRARY})
+    MARK_AS_ADVANCED(QT_XRENDER_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "xrender")
+  
+  ## Xrandr
+  IF(QT_QCONFIG MATCHES "xrandr")
+    FIND_LIBRARY(QT_XRANDR_LIBRARY NAMES Xrandr PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRANDR_LIBRARY})
+    MARK_AS_ADVANCED(QT_XRANDR_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "xrandr")
+  
+  ## Xcursor
+  IF(QT_QCONFIG MATCHES "xcursor")
+    FIND_LIBRARY(QT_XCURSOR_LIBRARY NAMES Xcursor PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XCURSOR_LIBRARY})
+    MARK_AS_ADVANCED(QT_XCURSOR_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "xcursor")
+  
+  ## Xinerama
+  IF(QT_QCONFIG MATCHES "xinerama")
+    FIND_LIBRARY(QT_XINERAMA_LIBRARY NAMES Xinerama PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XINERAMA_LIBRARY})
+    MARK_AS_ADVANCED(QT_XINERAMA_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "xinerama")
+  
+  ## system-freetype
+  IF(QT_QCONFIG MATCHES "system-freetype")
+    FIND_LIBRARY(QT_FREETYPE_LIBRARY NAMES freetype)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FREETYPE_LIBRARY})
+    MARK_AS_ADVANCED(QT_FREETYPE_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "system-freetype")
+  
+  ## fontconfig
+  IF(QT_QCONFIG MATCHES "fontconfig")
+    FIND_LIBRARY(QT_FONTCONFIG_LIBRARY NAMES fontconfig)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FONTCONFIG_LIBRARY})
+    MARK_AS_ADVANCED(QT_FONTCONFIG_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "fontconfig")
+  
+  ## system-zlib
+  IF(QT_QCONFIG MATCHES "system-zlib")
+    FIND_LIBRARY(QT_ZLIB_LIBRARY NAMES z)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_ZLIB_LIBRARY})
+    MARK_AS_ADVANCED(QT_ZLIB_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES "system-zlib")
+
+  IF(Q_WS_X11)
+    # X11 libraries Qt absolutely depends on
+    QT_QUERY_QMAKE(QT_LIBS_X11 "QMAKE_LIBS_X11")
+    SEPARATE_ARGUMENTS(QT_LIBS_X11)
+    FOREACH(QT_X11_LIB ${QT_LIBS_X11})
+      STRING(REGEX REPLACE "-l" "" QT_X11_LIB "${QT_X11_LIB}")
+      SET(QT_TMP_STR "QT_X11_${QT_X11_LIB}_LIBRARY")
+      FIND_LIBRARY(${QT_TMP_STR} NAMES "${QT_X11_LIB}" PATHS ${QMAKE_LIBDIR_X11})
+      SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${${QT_TMP_STR}})
+    ENDFOREACH(QT_X11_LIB)
+
+    QT_QUERY_QMAKE(QT_LIBS_THREAD "QMAKE_LIBS_THREAD")
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_LIBS_THREAD})
+    
+    QT_QUERY_QMAKE(QMAKE_LIBS_DYNLOAD "QMAKE_LIBS_DYNLOAD")
+    SET (QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QMAKE_LIBS_DYNLOAD})
+
+  ENDIF(Q_WS_X11)
+
+  IF(Q_WS_WIN)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} Imm32 Winmm)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} Ws2_32)
+  ENDIF(Q_WS_WIN)
+  
+  IF(Q_WS_MAC)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} "-framework Carbon" "-framework QuickTime")
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} "-framework ApplicationServices")
+  ENDIF(Q_WS_MAC)
+
+  #######################################
+  #
+  #       compatibility settings 
+  #
+  #######################################
+  # Backwards compatibility for CMake1.4 and 1.2
+  SET (QT_MOC_EXE ${QT_MOC_EXECUTABLE} )
+  SET (QT_UIC_EXE ${QT_UIC_EXECUTABLE} )
+
+  SET( QT_QT_LIBRARY "")
+
+ELSE(QT4_QMAKE_FOUND)
+
+   IF(Qt4_FIND_REQUIRED)
+      IF(QT4_INSTALLED_VERSION_TOO_OLD)
+         MESSAGE(FATAL_ERROR "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
+      ELSE(QT4_INSTALLED_VERSION_TOO_OLD)
+     MESSAGE( FATAL_ERROR "Qt qmake not found!")
+      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD)
+   ELSE(Qt4_FIND_REQUIRED)
+      IF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
+         MESSAGE(STATUS "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
+      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
+   ENDIF(Qt4_FIND_REQUIRED)
+ 
+ENDIF (QT4_QMAKE_FOUND)
+

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,125 +1,144 @@
-# - Extract information from a subversion working copy
-# The module defines the following variables:
-#  Subversion_SVN_EXECUTABLE - path to svn command line client
-#  Subversion_VERSION_SVN - version of svn command line client
-#  Subversion_FOUND - true if the command line client was found
-# If the command line client executable is found the macro
-#  Subversion_WC_INFO(<dir> <var-prefix>)
-# is defined to extract information of a subversion working copy at
-# a given location. The macro defines the following variables:
-#  <var-prefix>_WC_URL - url of the repository (at <dir>)
-#  <var-prefix>_WC_ROOT - root url of the repository
-#  <var-prefix>_WC_REVISION - current revision
-#  <var-prefix>_WC_LAST_CHANGED_AUTHOR - author of last commit
-#  <var-prefix>_WC_LAST_CHANGED_DATE - date of last commit
-#  <var-prefix>_WC_LAST_CHANGED_REV - revision of last commit
-#  <var-prefix>_WC_LAST_CHANGED_LOG - last log of base revision
-#  <var-prefix>_WC_INFO - output of command `svn info <dir>'
-# Example usage:
-#  FIND_PACKAGE(Subversion)
-#  IF(Subversion_FOUND)
-#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-#    MESSAGE("Current revision is ${Project_WC_REVISION}")
-#  ENDIF(Subversion_FOUND)
-
-# Copyright (c) 2006, Tristan Carel
-# All rights reserved.
-# Redistribution and use in source and binary forms, with or without
-# modification, are permitted provided that the following conditions are met:
-#
-#     * Redistributions of source code must retain the above copyright
-#       notice, this list of conditions and the following disclaimer.
-#     * Redistributions in binary form must reproduce the above copyright
-#       notice, this list of conditions and the following disclaimer in the
-#       documentation and/or other materials provided with the distribution.
-#     * Neither the name of the University of California, Berkeley nor the
-#       names of its contributors may be used to endorse or promote products
-#       derived from this software without specific prior written permission.
-#
-# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
-# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
-# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
-# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
-# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
-# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
-# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
-# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
-
-SET(Subversion_FOUND FALSE)
-SET(Subversion_SVN_FOUND FALSE)
-
-FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
-  DOC "subversion command line client")
-MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
-
-IF(Subversion_SVN_EXECUTABLE)
-  SET(Subversion_SVN_FOUND TRUE)
-  SET(Subversion_FOUND TRUE)
-
-  MACRO(Subversion_WC_INFO dir prefix)
-    SET(MESSAGES_ENV_VAR $ENV{LC_MESSAGES})
-    SET(ENV{LC_MESSAGES} "C")
-
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_VERSION_SVN
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Getting svn version from ${dir}")
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
-      WORKING_DIRECTORY ${dir}
-      OUTPUT_VARIABLE ${prefix}_WC_INFO
-      ERROR_VARIABLE Subversion_svn_info_error
-      RESULT_VARIABLE Subversion_svn_info_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
-      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} info ${dir}\" failed with output:\n${Subversion_svn_info_error}")
-    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-      STRING(REGEX REPLACE "^(.*\n)?svn, version ([.0-9]+).*"
-        "\\2" Subversion_VERSION_SVN "${Subversion_VERSION_SVN}")
-      STRING(REGEX REPLACE "^(.*\n)?URL: ([^\n]+).*"
-        "\\2" ${prefix}_WC_URL "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Revision: ([^\n]+).*"
-        "\\2" ${prefix}_WC_REVISION "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Author: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_AUTHOR "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Rev: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_REV "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Date: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_DATE "${${prefix}_WC_INFO}")
-
-    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-    EXECUTE_PROCESS(COMMAND
-      ${Subversion_SVN_EXECUTABLE} log -r BASE .
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
-      ERROR_VARIABLE Subversion_svn_log_error
-      RESULT_VARIABLE Subversion_svn_log_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
-      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\" failed with output:\n${Subversion_svn_log_error}")
-    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
-
-    SET($ENV{LC_MESSAGES} MESSAGES_ENV_VAR)
-  ENDMACRO(Subversion_WC_INFO)
-
-ENDIF(Subversion_SVN_EXECUTABLE)
-
-IF(NOT Subversion_FOUND)
-  IF(NOT Subversion_FIND_QUIETLY)
-    MESSAGE(STATUS "Subversion was not found.")
-  ELSE(NOT Subversion_FIND_QUIETLY)
-    IF(Subversion_FIND_REQUIRED)
-      MESSAGE(FATAL_ERROR "Subversion was not found.")
-    ENDIF(Subversion_FIND_REQUIRED)
-  ENDIF(NOT Subversion_FIND_QUIETLY)
-ENDIF(NOT Subversion_FOUND)
-
-# FindSubversion.cmake ends here.
+# - Extract information from a subversion working copy
+# The module defines the following variables:
+#  Subversion_SVN_EXECUTABLE - path to svn command line client
+#  Subversion_VERSION_SVN - version of svn command line client
+#  Subversion_FOUND - true if the command line client was found
+# If the command line client executable is found the macro
+#  Subversion_WC_INFO(<dir> <var-prefix>)
+# is defined to extract information of a subversion working copy at
+# a given location. The macro defines the following variables:
+#  <var-prefix>_WC_URL - url of the repository (at <dir>)
+#  <var-prefix>_WC_ROOT - root url of the repository
+#  <var-prefix>_WC_REVISION - current revision
+#  <var-prefix>_WC_LAST_CHANGED_AUTHOR - author of last commit
+#  <var-prefix>_WC_LAST_CHANGED_DATE - date of last commit
+#  <var-prefix>_WC_LAST_CHANGED_REV - revision of last commit
+#  <var-prefix>_WC_LAST_CHANGED_LOG - last log of base revision
+#  <var-prefix>_WC_INFO - output of command `svn info <dir>'
+# Example usage:
+#  FIND_PACKAGE(Subversion)
+#  IF(Subversion_FOUND)
+#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+#    MESSAGE("Current revision is ${Project_WC_REVISION}")
+#  ENDIF(Subversion_FOUND)
+
+# Copyright (c) 2006, Tristan Carel
+# All rights reserved.
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+#     * Redistributions of source code must retain the above copyright
+#       notice, this list of conditions and the following disclaimer.
+#     * Redistributions in binary form must reproduce the above copyright
+#       notice, this list of conditions and the following disclaimer in the
+#       documentation and/or other materials provided with the distribution.
+#     * Neither the name of the University of California, Berkeley nor the
+#       names of its contributors may be used to endorse or promote products
+#       derived from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
+# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
+
+SET(Subversion_FOUND FALSE)
+SET(Subversion_SVN_FOUND FALSE)
+
+FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
+  DOC "subversion command line client")
+MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
+
+IF(Subversion_SVN_EXECUTABLE)
+  SET(Subversion_SVN_FOUND TRUE)
+  SET(Subversion_FOUND TRUE)
+
+  MACRO(Subversion_WC_INFO dir prefix)
+    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_VERSION_SVN
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+    MESSAGE(STATUS "Getting svn version from ${dir}")
+
+# Old svn info call
+#    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
+#      WORKING_DIRECTORY ${dir}
+#      OUTPUT_VARIABLE ${prefix}_WC_INFO
+#      ERROR_VARIABLE Subversion_svn_info_error
+#      RESULT_VARIABLE Subversion_svn_info_result
+#      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+# New svn info --xml call
+      EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info --xml . 
+        WORKING_DIRECTORY ${dir}
+        OUTPUT_VARIABLE ${prefix}_WC_INFO_XML
+        ERROR_VARIABLE Subversion_svn_info_error
+        RESULT_VARIABLE Subversion_svn_info_result
+        OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
+      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} info ${dir}\" failed with output:\n${Subversion_svn_info_error}")
+    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+      STRING(REGEX REPLACE "^(.*\n)?svn, version ([.0-9]+).*"
+        "\\2" Subversion_VERSION_SVN "${Subversion_VERSION_SVN}")
+
+# Old REGEX REPLACE tests, working with non licalized versions of svn :
+#      STRING(REGEX REPLACE "^(.*\n)?URL: ([^\n]+).*"
+#        "\\2" ${prefix}_WC_URL "${${prefix}_WC_INFO}")
+#      STRING(REGEX REPLACE "^(.*\n)?Revision: ([^\n]+).*"
+#        "\\2" ${prefix}_WC_REVISION "${${prefix}_WC_INFO}")
+#      STRING(REGEX REPLACE "^(.*\n)?Last Changed Author: ([^\n]+).*"
+#        "\\2" ${prefix}_WC_LAST_CHANGED_AUTHOR "${${prefix}_WC_INFO}")
+#      STRING(REGEX REPLACE "^(.*\n)?Last Changed Rev: ([^\n]+).*"
+#        "\\2" ${prefix}_WC_LAST_CHANGED_REV "${${prefix}_WC_INFO}")
+#      STRING(REGEX REPLACE "^(.*\n)?Last Changed Date: ([^\n]+).*"
+#        "\\2" ${prefix}_WC_LAST_CHANGED_DATE "${${prefix}_WC_INFO}")
+
+# New REGEX REPLACE tests, working with the xml output on all versions :
+      STRING(REGEX REPLACE "(.*)<url>(.*)</url>(.*)"
+        "\\2" ${prefix}_WC_URL "${${prefix}_WC_INFO_XML}")
+      STRING(REGEX REPLACE "(.*)<entry(.*)revision=\"(.*)\">(.*)"
+        "\\3" ${prefix}_WC_REVISION "${${prefix}_WC_INFO_XML}")
+      STRING(REGEX REPLACE "(.*)<commit(.*)revision=\"(.*)\">(.*)<author>(.*)</author>(.*)<date>(.*)</date>(.*)</commit>(.*)"
+        "\\5" ${prefix}_WC_LAST_CHANGED_AUTHOR "${${prefix}_WC_INFO_XML}")
+      STRING(REGEX REPLACE "(.*)<commit(.*)revision=\"(.*)\">(.*)<author>(.*)</author>(.*)<date>(.*)</date>(.*)</commit>(.*)"
+        "\\3" ${prefix}_WC_LAST_CHANGED_REV "${${prefix}_WC_INFO_XML}")
+      STRING(REGEX REPLACE "(.*)<commit(.*)revision=\"(.*)\">(.*)<author>(.*)</author>(.*)<date>(.*)</date>(.*)</commit>(.*)"
+        "\\7" ${prefix}_WC_LAST_CHANGED_DATE "${${prefix}_WC_INFO_XML}")
+
+    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+    EXECUTE_PROCESS(COMMAND
+      ${Subversion_SVN_EXECUTABLE} log -r BASE .
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
+      ERROR_VARIABLE Subversion_svn_log_error
+      RESULT_VARIABLE Subversion_svn_log_result
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
+      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\" failed with output:\n${Subversion_svn_log_error}")
+    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
+  ENDMACRO(Subversion_WC_INFO)
+
+ENDIF(Subversion_SVN_EXECUTABLE)
+
+IF(NOT Subversion_FOUND)
+  IF(NOT Subversion_FIND_QUIETLY)
+    MESSAGE(STATUS "Subversion was not found.")
+  ELSE(NOT Subversion_FIND_QUIETLY)
+    IF(Subversion_FIND_REQUIRED)
+      MESSAGE(FATAL_ERROR "Subversion was not found.")
+    ENDIF(Subversion_FIND_REQUIRED)
+  ENDIF(NOT Subversion_FIND_QUIETLY)
+ENDIF(NOT Subversion_FOUND)
+
+# FindSubversion.cmake ends here.

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,47 @@
+# - Find zlib
+# Find the native ZLIB includes and library
+#
+#  ZLIB_INCLUDE_DIR - where to find zlib.h, etc.
+#  ZLIB_LIBRARIES   - List of libraries when using zlib.
+#  ZLIB_FOUND       - True if zlib found.
+
+
+IF (ZLIB_INCLUDE_DIR)
+  # Already in cache, be silent
+  SET(ZLIB_FIND_QUIETLY TRUE)
+ENDIF (ZLIB_INCLUDE_DIR)
+
+FIND_PATH(ZLIB_INCLUDE_DIR zlib.h
+  /usr/local/include
+  /usr/include
+)
+
+SET(ZLIB_NAMES z zlib zdll)
+FIND_LIBRARY(ZLIB_LIBRARY
+  NAMES ${ZLIB_NAMES}
+  PATHS /usr/lib /usr/local/lib
+)
+
+IF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+   SET(ZLIB_FOUND TRUE)
+    SET( ZLIB_LIBRARIES ${ZLIB_LIBRARY} )
+ELSE (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+   SET(ZLIB_FOUND FALSE)
+   SET( ZLIB_LIBRARIES )
+ENDIF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+
+IF (ZLIB_FOUND)
+   IF (NOT ZLIB_FIND_QUIETLY)
+      MESSAGE(STATUS "Found ZLIB: ${ZLIB_LIBRARY}")
+   ENDIF (NOT ZLIB_FIND_QUIETLY)
+ELSE (ZLIB_FOUND)
+   IF (ZLIB_FIND_REQUIRED)
+      MESSAGE(STATUS "Looked for Z libraries named ${ZLIBS_NAMES}.")
+      MESSAGE(FATAL_ERROR "Could NOT find z library")
+   ENDIF (ZLIB_FIND_REQUIRED)
+ENDIF (ZLIB_FOUND)
+
+MARK_AS_ADVANCED(
+  ZLIB_LIBRARY
+  ZLIB_INCLUDE_DIR
+  )

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,16 +0,0 @@
-# - MACRO_ENSURE_OUT_OF_SOURCE_BUILD(<errorMessage>)
-# MACRO_ENSURE_OUT_OF_SOURCE_BUILD(<errorMessage>)
-
-# Copyright (c) 2006, Alexander Neundorf, <neundorf at kde.org>
-#
-# Redistribution and use is allowed according to the terms of the BSD license.
-# For details see the accompanying COPYING-CMAKE-SCRIPTS file.
-
-MACRO (MACRO_ENSURE_OUT_OF_SOURCE_BUILD _errorMessage)
-
-   STRING(COMPARE EQUAL "${CMAKE_SOURCE_DIR}" "${CMAKE_BINARY_DIR}" insource)
-      IF(insource)
-            MESSAGE(FATAL_ERROR "${_errorMessage}")
-       ENDIF(insource)
-
-ENDMACRO (MACRO_ENSURE_OUT_OF_SOURCE_BUILD)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -4,6 +4,7 @@
     IF(NOT XSLTPROC_EXECUTABLE AND NOT XSLTPROC_NOT_FOUND)
         SET(XSLTPROC_NAME "xsltproc")
         FIND_PROGRAM(XSLTPROC_EXECUTABLE ${XSLTPROC_NAME})
+        MARK_AS_ADVANCED(XSLTPROC_EXECUTABLE)
 
         IF (NOT XSLTPROC_EXECUTABLE)
           MESSAGE(STATUS "WARNING: ${XSLTPROC_NAME} not found - ts files can't be processed")

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,199 @@
+########################################
+# Aften
+########################################
+OPTION(AFTEN "" ON)
+
+MESSAGE(STATUS "Checking for Aften")
+MESSAGE(STATUS "******************")
+
+IF (AFTEN)
+	FIND_HEADER_AND_LIB(AFTEN aften/aften.h aften aften_encode_init)
+	PRINT_LIBRARY_INFO("Aften" AFTEN_FOUND "${AFTEN_INCLUDE_DIR}" "${AFTEN_LIBRARY_DIR}")
+
+	IF (AFTEN_FOUND)
+		SET(USE_AFTEN 1)
+		
+		IF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
+			TRY_RUN(AFTEN_TEST_RUN_RESULT
+				AFTEN_TEST_COMPILE_RESULT
+				${CMAKE_BINARY_DIR}
+				"${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp"
+				CMAKE_FLAGS -DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR})
+		ENDIF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
+
+		IF (AFTEN_TEST_RUN_RESULT EQUAL 8)
+			MESSAGE(STATUS "  version: 0.0.8")
+			SET(USE_AFTEN_08 1)
+		ELSEIF (AFTEN_TEST_RUN_RESULT EQUAL 7)
+			MESSAGE(STATUS "  version: 0.07")
+			SET(USE_AFTEN_07 1)
+		ELSE (AFTEN_TEST_RUN_RESULT EQUAL 8)
+			MESSAGE(STATUS "Warning: Unable to determine Aften version - support for Aften will be turned off")
+			SET(USE_AFTEN 0)
+		ENDIF (AFTEN_TEST_RUN_RESULT EQUAL 8)
+	ENDIF (AFTEN_FOUND)
+ELSE (AFTEN)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (AFTEN)
+
+MESSAGE("")
+
+########################################
+# amrnb
+########################################
+OPTION(AMRNB "" ON)
+
+MESSAGE(STATUS "Checking for amrnb")
+MESSAGE(STATUS "******************")
+
+IF (AMRNB)
+	IF (LATE_BINDING)
+		FIND_HEADER_AND_LIB(AMRNB amrnb/interf_dec.h)
+	ELSE (LATE_BINDING)
+		FIND_HEADER_AND_LIB(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode)
+	ENDIF (LATE_BINDING)
+
+	PRINT_LIBRARY_INFO("amrnb" AMRNB_FOUND "${AMRNB_INCLUDE_DIR}" "${AMRNB_LIBRARY_DIR}")
+	
+	IF (AMRNB_FOUND)
+		SET(USE_AMR_NB 1)
+		SET(CONFIG_AMR_NB 1)
+	ENDIF (AMRNB_FOUND)
+ELSE (AMRNB)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (AMRNB)
+
+MESSAGE("")
+
+########################################
+# LAME
+########################################
+OPTION(LAME "" ON)
+
+MESSAGE(STATUS "Checking for LAME")
+MESSAGE(STATUS "*****************")
+
+IF (LAME)
+	FIND_HEADER_AND_LIB(LAME lame/lame.h mp3lame lame_init)
+	PRINT_LIBRARY_INFO("LAME" LAME_FOUND "${LAME_INCLUDE_DIR}" "${LAME_LIBRARY_DIR}")
+	
+	IF (LAME_FOUND)
+		SET(HAVE_LIBMP3LAME 1)
+	ENDIF (LAME_FOUND)
+ELSE (LAME)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (LAME)
+
+MESSAGE("")
+
+########################################
+# libdca
+########################################
+OPTION(LIBDCA "" ON)
+
+MESSAGE(STATUS "Checking for libdca")
+MESSAGE(STATUS "*******************")
+
+IF (LIBDCA)
+	IF (USE_LATE_BINDING)
+		FIND_HEADER_AND_LIB(LIBDCA dts.h)
+	ELSE (USE_LATE_BINDING)
+		FIND_HEADER_AND_LIB(LIBDCA dts.h dts dts_init)
+	ENDIF (USE_LATE_BINDING)
+	
+	PRINT_LIBRARY_INFO("libdca" LIBDCA_FOUND "${LIBDCA_INCLUDE_DIR}" "${LIBDCA_LIBRARY_DIR}")
+
+	IF (LIBDCA_FOUND)
+		SET(USE_LIBDCA 1)
+	ENDIF (LIBDCA_FOUND)
+ELSE (LIBDCA)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (LIBDCA)
+
+MESSAGE("")
+
+########################################
+# FAAC
+########################################
+OPTION(FAAC "" ON)
+
+MESSAGE(STATUS "Checking for FAAC")
+MESSAGE(STATUS "*****************")
+
+IF (FAAC)
+	FIND_HEADER_AND_LIB(FAAC faac.h faac faacEncClose)
+	PRINT_LIBRARY_INFO("FAAC" FAAC_FOUND "${FAAC_INCLUDE_DIR}" "${FAAC_LIBRARY_DIR}")
+	
+	IF (FAAC_FOUND)
+		SET(USE_FAAC 1)
+	ENDIF (FAAC_FOUND)
+ELSE (FAAC)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (FAAC)
+
+MESSAGE("")
+
+########################################
+# FAAD
+########################################
+OPTION (FAAD "" ON)
+
+MESSAGE(STATUS "Checking for FAAD")
+MESSAGE(STATUS "*****************")
+
+IF (FAAD)
+	FIND_HEADER_AND_LIB(FAAD faad.h faad)
+
+	IF (FAAD_FOUND)
+		CHECK_LIBRARY_EXISTS(faad faacDecInit FAAD_LIBRARY_DIR FAACDEC_FUNCTION_FOUND)
+
+		IF (NOT FAACDEC_FUNCTION_FOUND)
+			CHECK_LIBRARY_EXISTS(faad NeAACDecInit FAAD_LIBRARY_DIR NEAACDEC_FUNCTION_FOUND)
+
+			IF (NOT NEAACDEC_FUNCTION_FOUND)
+				SET(FAAD_FOUND 0)
+			ENDIF (NOT NEAACDEC_FUNCTION_FOUND)
+		ENDIF (NOT FAACDEC_FUNCTION_FOUND)
+	ENDIF (FAAD_FOUND)
+
+	PRINT_LIBRARY_INFO("FAAD" FAAD_FOUND "${FAAD_INCLUDE_DIR}" "${FAAD_LIBRARY_DIR}")
+
+	IF (FAAD_FOUND)
+		SET(USE_FAAD 1)
+
+		CHECK_CFLAGS_REQUIRED(faad_check.cpp "-DOLD_FAAD_PROTO" "${FAAD_INCLUDE_DIR}" "${FAAD_LIBRARY_DIR}" FAAD_CFLAGS_REQUIRED)
+		
+		IF (FAAD_CFLAGS_REQUIRED)
+			SET(OLD_FAAD_PROTO 1)
+		ENDIF (FAAD_CFLAGS_REQUIRED)
+	ENDIF (FAAD_FOUND)
+ELSE (FAAD)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (FAAD)
+
+MESSAGE("")
+
+########################################
+# Vorbis
+########################################
+OPTION(VORBIS "" ON)
+
+MESSAGE(STATUS "Checking for Vorbis")
+MESSAGE(STATUS "*******************")
+
+IF (VORBIS)
+	FIND_HEADER_AND_LIB(VORBIS vorbis/vorbisenc.h vorbis vorbis_info_init)
+	FIND_HEADER_AND_LIB(VORBISENC "" vorbisenc vorbis_encode_init)
+	
+	IF (VORBIS_FOUND AND VORBISENC_FOUND)
+		SET(USE_VORBIS 1)
+	ELSE (VORBIS_FOUND AND VORBISENC_FOUND)
+		SET(VORBIS_FOUND 0 CACHE INTERNAL "")
+	ENDIF (VORBIS_FOUND AND VORBISENC_FOUND)
+
+	PRINT_LIBRARY_INFO("Vorbis" VORBIS_FOUND "${VORBIS_INCLUDE_DIR}" "${VORBIS_LIBRARY_DIR} ${VORBISENC_LIBRARY_DIR}")
+ELSE (VORBIS)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (VORBIS)
+
+MESSAGE ("")
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,145 @@
+########################################
+# ALSA
+########################################
+IF (ADM_OS_LINIX)
+	OPTION(ALSA "" ON)
+
+	MESSAGE(STATUS "Checking for ALSA")
+	MESSAGE(STATUS "*****************")
+
+	IF (ALSA)
+		FIND_PACKAGE(Alsa)
+
+		IF (ALSA_FOUND)
+			ALSA_VERSION_STRING(alsaVersion)
+
+			MESSAGE("  version: ${alsaVersion}")
+			PRINT_LIBRARY_INFO("ALSA" ALSA_FOUND "${_ALSA_INCLUDE_DIR}" "${ASOUND_LIBRARY}")
+
+			SET(ALSA_SUPPORT 1)
+		ENDIF (ALSA_FOUND)
+	ELSE (ALSA)
+		MESSAGE(STATUS "<disabled per request>")
+	ENDIF (ALSA)
+
+	MESSAGE("")
+ELSE (ADM_OS_LINUX)
+	SET(ALSA_CAPABLE FALSE)
+ENDIF (ADM_OS_LINIX)
+
+########################################
+# aRts
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(ARTS "" ON)
+	
+	MESSAGE(STATUS "Checking for aRts")
+	MESSAGE(STATUS "*****************")
+
+	IF (ARTS)
+		FIND_PACKAGE(FindArts)
+		PRINT_LIBRARY_INFO("aRts" ARTS_FOUND "${ARTS_CFLAGS}" "${ARTS_LDFLAGS}")
+		
+		IF (ARTS_FOUND)
+			SET(USE_ARTS 1)
+		ENDIF (ARTS_FOUND)
+	ELSE (ARTS)
+		MESSAGE(STATUS "<disabled per request>")
+	ENDIF (ARTS)
+		
+	MESSAGE("")
+ELSE (ADM_OS_LINUX)
+	SET(ARTS_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# ESD
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(ESD "" ON)
+
+	MESSAGE(STATUS "Checking for ESD")
+	MESSAGE(STATUS "****************")
+
+	IF (ESD)
+		FIND_HEADER_AND_LIB(ESD esd.h esd esd_close)
+		PRINT_LIBRARY_INFO("ESD" ESD_FOUND "${ESD_INCLUDE_DIR}" "${ESD_LIBRARY}")
+
+		IF (ESD_FOUND)
+			SET(USE_ESD 1)
+		ENDIF (ESD_FOUND)
+	ELSE (ESD)
+		MESSAGE(STATUS "<disabled per request>")
+	ENDIF (ESD)
+
+	MESSAGE("")
+ELSE (ADM_OS_LINUX)
+	SET(ESD_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# JACK
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	OPTION(JACK "" ON)
+
+	MESSAGE(STATUS "Checking for JACK")
+	MESSAGE(STATUS "*****************")
+
+	IF (JACK)
+		FIND_HEADER_AND_LIB(JACK jack/jack.h jack jack_client_close)
+		PRINT_LIBRARY_INFO("JACK" JACK_FOUND "${JACK_INCLUDE_DIR}" "${JACK_LIBRARY_DIR}")
+
+		IF (JACK_FOUND)
+			SET(USE_JACK 1)
+		ENDIF (JACK_FOUND)
+	ELSE (JACK)
+		MESSAGE(STATUS "<disabled per request>")
+	ENDIF (JACK)
+	
+	MESSAGE("")
+ELSE (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	SET(JACK_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+
+########################################
+# Secret Rabbit Code
+########################################
+IF (JACK_FOUND)
+	MESSAGE(STATUS "Checking for Secret Rabbit Code")
+	MESSAGE(STATUS "*******************************")
+
+	FIND_HEADER_AND_LIB(SRC samplerate.h samplerate src_get_version)
+	PRINT_LIBRARY_INFO("Secret Rabbit Code" SRC_FOUND "${SRC_INCLUDE_DIR}" "${SRC_LIBRARY_DIR}")
+
+	IF (SRC_FOUND)
+		SET(USE_SRC 1)
+	ENDIF (SRC_FOUND)
+	
+	MESSAGE("")
+ENDIF (JACK_FOUND)
+
+########################################
+# OSS
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(OSS "" ON)
+	
+	MESSAGE(STATUS "Checking for OSS")
+	MESSAGE(STATUS "****************")
+	
+	IF (OSS)
+		FIND_HEADER_AND_LIB(OSS sys/soundcard.h)
+		PRINT_LIBRARY_INFO("OSS" OSS_FOUND "${OSS_INCLUDE_DIR}" "")
+
+		IF (OSS_FOUND)
+			SET(OSS_SUPPORT 1)
+		ENDIF (OSS_FOUND)
+	ELSE (OSS)
+		MESSAGE(STATUS "<disabled per request>")
+	ENDIF (OSS)
+	
+	MESSAGE("")
+ELSE (ADM_OS_LINUX)
+	SET(OSS_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,135 @@
+########################################
+# FontConfig
+########################################
+MESSAGE(STATUS "Checking for FontConfig")
+MESSAGE(STATUS "***********************")
+
+FIND_HEADER_AND_LIB(FONTCONFIG fontconfig/fontconfig.h fontconfig FcStrSetCreate)
+PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_INCLUDE_DIR}" "${FONTCONFIG_LIBRARY_DIR}")
+
+IF (FONTCONFIG_FOUND)
+	SET(HAVE_FONTCONFIG 1)
+	SET(USE_FONTCONFIG 1)
+ENDIF (FONTCONFIG_FOUND)
+
+MESSAGE("")
+
+########################################
+# FreeType2
+########################################
+OPTION(FREETYPE2 "" ON)
+
+MESSAGE(STATUS "Checking for FreeType2")
+MESSAGE(STATUS "**********************")
+
+IF (FREETYPE2)
+	PKG_CHECK_MODULES(FREETYPE2 freetype2)
+	PRINT_LIBRARY_INFO("FreeType2" FREETYPE2_FOUND "${FREETYPE2_CFLAGS}" "${FREETYPE2_LDFLAGS}")
+
+	IF (FREETYPE2_FOUND)
+		SET(USE_FREETYPE 1)
+	ENDIF (FREETYPE2_FOUND)
+ELSE (FREETYPE2)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (FREETYPE2)
+
+MESSAGE("")
+
+########################################
+# gettext
+########################################
+MESSAGE(STATUS "Checking for gettext")
+MESSAGE(STATUS "********************")
+
+OPTION(GETTEXT "" ON)
+
+IF (GETTEXT)
+	FIND_HEADER_AND_LIB(GETTEXT libintl.h intl)
+	PRINT_LIBRARY_INFO("Gettext" GETTEXT_FOUND "${GETTEXT_INCLUDE_DIR}" "${GETTEXT_LIBRARY_DIR}")
+
+	IF (GETTEXT_INCLUDE_DIR)
+		# Try linking without -lintl
+		ADM_COMPILE(gettext.cpp "" "-I${GETTEXT_INCLUDE_DIR}" "" LIBINTL_NOT_REQUIRED outputWithoutLibintl)
+
+		IF (LIBINTL_NOT_REQUIRED)
+			SET(GETTEXT_LIBRARY_DIR "")
+			SET(HAVE_GETTEXT 1)
+
+			MESSAGE(STATUS "libintl not required for gettext support")
+		ELSE (LIBINTL_NOT_REQUIRED)
+			ADM_COMPILE(gettext.cpp "" "-I${GETTEXT_INCLUDE_DIR}" "${GETTEXT_LIBRARY_DIR}" LIBINTL_REQUIRED outputWithLibintl)
+
+			IF (LIBINTL_REQUIRED)
+				SET(HAVE_GETTEXT 1)
+
+				MESSAGE(STATUS "libintl required for gettext support")
+			ELSE (LIBINTL_REQUIRED)
+				SET(GETTEXT_FOUND 0 CACHE INTERNAL "")
+
+				MESSAGE("gettext support failed with or without libintl")
+				
+				IF (VERBOSE)
+					MESSAGE(STATUS "Compilation error with libintl:")
+					MESSAGE(STATUS ${outputWithLibintl})
+
+					MESSAGE(STATUS "Compilation error without libintl:")
+					MESSAGE(STATUS ${outputWithoutLibintl})
+				ENDIF (VERBOSE)
+			ENDIF (LIBINTL_REQUIRED)
+		ENDIF (LIBINTL_NOT_REQUIRED)
+	ENDIF (GETTEXT_INCLUDE_DIR)
+ELSE (GETTEXT)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (GETTEXT)
+
+SET(ADM_LOCALE "${CMAKE_INSTALL_PREFIX}/share/locale")
+
+MESSAGE("")
+
+########################################
+# SDL
+########################################
+OPTION(SDL "" ON)
+
+MESSAGE(STATUS "Checking for SDL")
+MESSAGE(STATUS "****************")
+
+IF (SDL)
+	FIND_PACKAGE(SDL)
+	PRINT_LIBRARY_INFO("SDL" SDL_FOUND "${SDL_INCLUDE_DIR}" "${SDL_LIBRARY}")
+	
+	MARK_AS_ADVANCED(SDLMAIN_LIBRARY)
+	MARK_AS_ADVANCED(SDL_INCLUDE_DIR)
+	MARK_AS_ADVANCED(SDL_LIBRARY)
+
+	IF (SDL_FOUND)
+		SET(USE_SDL 1)
+	ENDIF (SDL_FOUND)
+ELSE (SDL)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (SDL)
+
+MESSAGE("")
+
+########################################
+# XVideo
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)	
+	OPTION(XVIDEO "" ON)
+	
+	IF (X11_FOUND AND XVIDEO)
+		MESSAGE(STATUS "Checking for XVideo")
+		MESSAGE(STATUS "*******************")
+
+		FIND_HEADER_AND_LIB(XVIDEO X11/extensions/Xvlib.h Xv XvShmPutImage "-include X11/Xlib.h ${X11_INCLUDE_DIR} ${X11_LIBRARIES}")
+		PRINT_LIBRARY_INFO("XVideo" XVIDEO_FOUND "${XVIDEO_INCLUDE_DIR}" "${XVIDEO_LIBRARY}")
+		
+		IF (XVIDEO_FOUND)
+			SET(USE_XV 1)
+		ENDIF (XVIDEO_FOUND)
+	
+		MESSAGE("")
+	ENDIF (X11_FOUND AND XVIDEO)
+ELSE (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	SET(XVIDEO_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,73 @@
+########################################
+# pkg-config
+########################################
+MESSAGE(STATUS "Checking for pkg-config")
+MESSAGE(STATUS "***********************")
+
+FIND_PACKAGE(PkgConfig)
+
+IF (NOT PKG_CONFIG_FOUND)
+	MESSAGE(FATAL_ERROR "Could not find pkg-config")
+ENDIF (NOT PKG_CONFIG_FOUND)
+
+MESSAGE(STATUS "Found pkg-config")
+
+IF (VERBOSE)
+	MESSAGE(STATUS "Path: ${PKG_CONFIG_EXECUTABLE}")
+ENDIF (VERBOSE)
+
+MESSAGE("")
+
+########################################
+# libiconv
+########################################
+MESSAGE(STATUS "Checking for libiconv")
+MESSAGE(STATUS "*********************")
+
+FIND_HEADER_AND_LIB(LIBICONV iconv.h iconv)
+PRINT_LIBRARY_INFO("libiconv" LIBICONV_FOUND "${LIBICONV_INCLUDE_DIR}" "${LIBICONV_LIBRARY_DIR}")
+
+IF (NOT LIBICONV_INCLUDE_DIR)
+	MESSAGE(FATAL "iconv.h not found")
+ENDIF (NOT LIBICONV_INCLUDE_DIR)
+
+IF (LIBICONV_LIBRARY_DIR)
+	MESSAGE(STATUS "libiconv is probably needed")
+ELSE (LIBICONV_LIBRARY_DIR)
+	MESSAGE(STATUS "libiconv is probably not needed")
+ENDIF (LIBICONV_LIBRARY_DIR)
+
+CHECK_CFLAGS_REQUIRED(iconv_check.cpp "-DICONV_NEED_CONST" "${LIBICONV_INCLUDE_DIR}" "${LIBICONV_LIBRARY_DIR}" LIBICONV_CFLAGS_REQUIRED)
+
+IF (LIBICONV_CFLAGS_REQUIRED)
+	SET(LIBICONV_DEFINITIONS "-DICONV_NEED_CONST")
+	SET(ICONV_NEED_CONST 1)
+ENDIF(LIBICONV_CFLAGS_REQUIRED)
+
+MESSAGE("")
+
+########################################
+# Libxml2
+########################################
+MESSAGE(STATUS "Checking for Libxml2")
+MESSAGE(STATUS "********************")
+
+SET(LibXml2_FIND_QUIETLY TRUE)
+
+FIND_PACKAGE(LibXml2)
+PRINT_LIBRARY_INFO("Libxml2" LIBXML2_FOUND "${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS}" "${LIBXML2_LIBRARIES}" FATAL_ERROR)
+
+SET(USE_LIBXML2 1)
+MESSAGE("")
+
+########################################
+# libpng
+########################################
+MESSAGE(STATUS "Checking for libpng")
+MESSAGE(STATUS "*******************")
+
+FIND_PACKAGE(png)
+PRINT_LIBRARY_INFO("libpng" PNG_FOUND "${PNG_INCLUDE_DIR} ${PNG_DEFINITIONS}" "${PNG_LIBRARIES}" FATAL_ERROR)
+
+SET(USE_PNG 1)
+MESSAGE("")
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,117 @@
+########################################
+# X11
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	MESSAGE(STATUS "Checking for X11")
+	MESSAGE(STATUS "****************")
+	
+	FIND_PACKAGE(X11)
+	
+	PRINT_LIBRARY_INFO("X11" X11_FOUND "${X11_INCLUDE_DIR}" "${X11_LIBRARIES}")
+	
+	IF (NOT X11_FOUND)
+		SET(ADM_UI_GTK 0)
+		
+		IF (ADM_OS_LINUX)
+			SET(ADM_UI_QT4 0)
+		ENDIF (ADM_OS_LINUX)
+	ENDIF (NOT X11_FOUND)
+	
+	MESSAGE("")
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+
+########################################
+# GLib
+########################################
+MESSAGE(STATUS "Checking for GLib")
+MESSAGE(STATUS "*****************")
+
+PKG_CHECK_MODULES(GLIB glib-2.0)
+
+PRINT_LIBRARY_INFO("GLib" GLIB_FOUND "${GLIB_CFLAGS}" "${GLIB_LDFLAGS}" FATAL_ERROR)
+MESSAGE("")
+
+########################################
+# GTK+
+########################################
+OPTION(GTK "" ON)
+
+MESSAGE(STATUS "Checking for GTK+")
+MESSAGE(STATUS "*****************")
+
+IF (GTK)
+	PKG_CHECK_MODULES(GTK gtk+-2.0)
+	PRINT_LIBRARY_INFO("GTK+" GTK_FOUND "${GTK_CFLAGS}" "${GTK_LDFLAGS}")
+
+	IF (NOT GTK_FOUND)
+		SET(ADM_UI_GTK 0)
+	ENDIF (NOT GTK_FOUND)
+ELSE (GTK)
+	SET(ADM_UI_GTK 0)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (GTK)
+
+MESSAGE("")
+
+########################################
+# GThread
+########################################
+MESSAGE(STATUS "Checking for GThread")
+MESSAGE(STATUS "********************")
+
+IF (GTK)
+	PKG_CHECK_MODULES(GTHREAD gthread-2.0)
+	PRINT_LIBRARY_INFO("GThread" GTHREAD_FOUND "${GTHREAD_CFLAGS}" "${GTHREAD_LDFLAGS}")
+
+	IF (NOT GTHREAD_FOUND)
+		SET(ADM_UI_GTK 0)
+		MESSAGE(STATUS "Could not find GThread")
+	ENDIF(NOT GTHREAD_FOUND)
+ELSE (GTK)
+	SET(ADM_UI_GTK 0)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (GTK)
+
+MESSAGE("")
+
+########################################
+# Qt4
+########################################
+OPTION(QT4 "" ON)
+
+MESSAGE(STATUS "Checking for QT4")
+MESSAGE(STATUS "****************")
+
+IF (QT4)
+	FIND_PACKAGE(Qt4)	
+	STRING(REGEX REPLACE "[\\]" "/" QT_INCLUDES "${QT_INCLUDES}")	# backslashes aren't taken care of properly on Windows
+	PRINT_LIBRARY_INFO("Qt4" QT4_FOUND "${QT_INCLUDES} ${QT_DEFINITIONS}" "${QT_QTCORE_LIBRARY} ${QT_QTGUI_LIBRARY}")
+	
+	MARK_AS_ADVANCED(LRELEASE_EXECUTABLE)
+	MARK_AS_ADVANCED(QT_MKSPECS_DIR)
+	MARK_AS_ADVANCED(QT_PLUGINS_DIR)
+	MARK_AS_ADVANCED(QT_QMAKE_EXECUTABLE)
+	
+	IF (QT4_FOUND)
+		IF (XMINGW)
+			SET(QTXM /rot2/qt_4.3)
+
+			SET(QT_QMAKE_EXECUTABLE qmake)
+			SET(QT_UIC_EXECUTABLE uic-qt4)
+			SET(QT_MOC_EXECUTABLE moc-qt4)
+			SET(QT_RCC_EXECUTABLE rcc)
+			SET(QT_QTGUI_LIBRARY QtGui4)   # FIXME
+			SET(QT_QTCORE_LIBRARY QtCore4) # FIXME
+
+			SET(CMAKE_CXX_FLAGS "-I${QTXM}/include ${CMAKE_CXX_FLAGS}")
+			LINK_DIRECTORIES(${QTXM}/bin)
+			LINK_DIRECTORIES(${QTXM}/lib)
+		ENDIF (XMINGW)		
+	ELSE (QT4_FOUND)
+		SET(ADM_UI_QT4 0)
+	ENDIF (QT4_FOUND)	
+ELSE (QT4)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (QT4)
+
+MESSAGE("")
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,41 @@
+########################################
+# x264
+########################################
+OPTION(X264 "" ON)
+
+MESSAGE(STATUS "Checking for x264")
+MESSAGE(STATUS "*****************")
+
+IF (X264)
+	FIND_HEADER_AND_LIB(X264 x264.h x264 x264_encoder_open)
+	PRINT_LIBRARY_INFO("x264" X264_FOUND "${X264_INCLUDE_DIR}" "${X264_LIBRARY_DIR}")
+
+	IF (X264_FOUND)
+		SET(USE_X264 1)
+	ENDIF (X264_FOUND)
+ELSE (X264)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (X264)
+
+MESSAGE("")
+
+########################################
+# Xvid
+########################################
+OPTION(XVID "" ON)
+
+MESSAGE(STATUS "Checking for Xvid")
+MESSAGE(STATUS "*****************")
+
+IF (XVID)
+	FIND_HEADER_AND_LIB(XVID xvid.h xvidcore xvid_plugin_single)
+	PRINT_LIBRARY_INFO("Xvid" XVID_FOUND "${XVID_INCLUDE_DIR}" "${XVID_LIBRARY_DIR}")
+	
+	IF (XVID_FOUND)
+		SET(USE_XVID_4 1)
+	ENDIF (XVID_FOUND)
+ELSE (XVID)
+	MESSAGE(STATUS "<disabled per request>")
+ENDIF (XVID)
+
+MESSAGE("")
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,146 @@
+INCLUDE(CheckLibraryExists)		# required for FIND_HEADER_AND_LIB macro
+
+MACRO(PRINT_LIBRARY_INFO libraryName libraryDetected compilerFlags linkerFlags)
+	IF (${libraryDetected})
+		MESSAGE(STATUS "Found ${libraryName}")
+		
+		IF (VERBOSE)
+			MESSAGE(STATUS "Compiler Flags: ${compilerFlags}")
+			MESSAGE(STATUS "Linker Flags  : ${linkerFlags}")
+		ENDIF (VERBOSE)
+	ELSE (${libraryDetected})
+		MESSAGE(${ARGV4} "Could not find ${libraryName}")
+	ENDIF (${libraryDetected})
+ENDMACRO(PRINT_LIBRARY_INFO)
+
+
+MACRO(SDLify _source)
+	if(SDL_FOUND)
+        SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS "-I${SDL_INCLUDE_DIR}")
+	endif(SDL_FOUND)
+ENDMACRO(SDLify)
+
+# ARGV2 = library to check
+# ARGV3 = function to check
+# ARVG4 = CMAKE_REQUIRED_FLAGS
+MACRO(FIND_HEADER_AND_LIB prefix headerFile)
+	IF (NOT DEFINED ${prefix}_FOUND)
+		SET(${prefix}_FOUND 0 CACHE INTERNAL "")
+		SET(PROCEED 1)
+		
+		IF (NOT ${headerFile} STREQUAL "")
+			FIND_PATH(${prefix}_INCLUDE_DIR ${headerFile})
+			MARK_AS_ADVANCED(${prefix}_INCLUDE_DIR)
+		
+			IF (${prefix}_INCLUDE_DIR)
+				MESSAGE(STATUS "Found ${headerFile}")
+			ELSE (${prefix}_INCLUDE_DIR)
+				SET(PROCEED 0)
+				MESSAGE("Could not find ${headerFile}")
+			ENDIF (${prefix}_INCLUDE_DIR)
+		ENDIF (NOT ${headerFile} STREQUAL "")
+		
+		IF (PROCEED AND NOT ${ARGV2} STREQUAL "")
+			FIND_LIBRARY(${prefix}_LIBRARY_DIR ${ARGV2})
+			MARK_AS_ADVANCED(${prefix}_LIBRARY_DIR)
+
+			IF (${prefix}_LIBRARY_DIR)
+				MESSAGE(STATUS "Found ${ARGV2} library")
+				
+				IF (NOT ${ARGV3} STREQUAL "")
+					SET(CMAKE_REQUIRED_FLAGS_BACKUP "${CMAKE_REQUIRED_FLAGS}")
+					SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS} ${ARGV4}")
+
+					CHECK_LIBRARY_EXISTS(${ARGV2} ${ARGV3} ${prefix}_LIBRARY_DIR ${prefix}_FUNCTION_FOUND)
+
+					SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS_BACKUP}")
+
+					IF (${prefix}_FUNCTION_FOUND)
+						SET(${prefix}_FOUND 1 CACHE INTERNAL "")
+					ENDIF (${prefix}_FUNCTION_FOUND)
+				ELSE (NOT ${ARGV3} STREQUAL "")
+					SET(${prefix}_FOUND 1 CACHE INTERNAL "")
+				ENDIF (NOT ${ARGV3} STREQUAL "")
+			ELSE (${prefix}_LIBRARY_DIR)
+				MESSAGE(STATUS "Cound not find ${ARGV2} library")
+			ENDIF (${prefix}_LIBRARY_DIR)
+		ELSE (PROCEED AND NOT ${ARGV2} STREQUAL "")
+			SET(${prefix}_FOUND 1 CACHE INTERNAL "")
+		ENDIF (PROCEED AND NOT ${ARGV2} STREQUAL "")
+	ENDIF (NOT DEFINED ${prefix}_FOUND)
+ENDMACRO(FIND_HEADER_AND_LIB)
+
+
+MACRO (ADM_COMPILE _file _def _include _lib _varToSet _output)
+	IF (NOT DEFINED ${_varToSet}_COMPILED)
+		SET(${_varToSet}_COMPILED 1 CACHE INTERNAL "")
+		
+		TRY_COMPILE(${_varToSet}
+			  ${CMAKE_BINARY_DIR}
+			  ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
+			  CMAKE_FLAGS -DINCLUDE_DIRECTORIES=${_include} -DCOMPILE_DEFINITIONS=${_def} -DLINK_LIBRARIES=${_lib}
+			  COMPILE_DEFINITIONS "${_cflags}"
+			  OUTPUT_VARIABLE ${_output})
+	ENDIF (NOT DEFINED ${_varToSet}_COMPILED)
+ENDMACRO (ADM_COMPILE)
+
+
+MACRO (CHECK_CFLAGS_REQUIRED _file _cflags _include _lib _varToSet)
+	IF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
+		SET(${_varToSet}_CFLAGS_CHECKED 1 CACHE INTERNAL "")
+		
+		ADM_COMPILE(${_file} ${_cflags} ${_include} ${_lib} ${_varToSet}_COMPILE_WITH logwith)
+		ADM_COMPILE(${_file} "" ${_include} ${_lib} ${_varToSet}_COMPILE_WITHOUT logwithout)
+
+		IF (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+			SET(${_varToSet} 1 CACHE INTERNAL "")
+			
+			IF (VERBOSE)
+				MESSAGE(STATUS "(${_cflags}) required")
+			ENDIF (VERBOSE)
+		ELSE (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+			IF (NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+				IF (VERBOSE)
+					MESSAGE (STATUS "(${_cflags}) not required")
+				ENDIF (VERBOSE)
+			ELSE (NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+				MESSAGE(STATUS "Inconsistent compiler output with: ${${_varToSet}_COMPILE_WITH}, without: ${${_varToSet}_COMPILE_WITHOUT}")
+				MESSAGE(STATUS "${logwith}")
+				MESSAGE(STATUS "")
+				MESSAGE(STATUS "${logwithout}")
+			endif(NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+		ENDIF (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+	ENDIF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
+ENDMACRO (CHECK_CFLAGS_REQUIRED)
+
+MACRO (append_flags _flags _varToAppend)
+	if (_flags)
+		set(_flags "${_flags} ${_varToAppend}")
+	else (_flags)
+		set(_flags "${_varToAppend}")
+	endif (_flags)
+ENDMACRO (append_flags)
+
+MACRO (add_link_flags _target _flg)
+	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
+
+	append_flags("${_flags}" "${_flg}")
+
+	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS "${_flags}")
+ENDMACRO (add_link_flags)
+
+MACRO (add_source_compile_flags _target _flg)
+	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
+
+	append_flags("${_flags}" "${_flg}")
+   
+	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")   
+ENDMACRO (add_source_compile_flags)
+
+MACRO (add_target_compile_flags _target _flg)
+	GET_TARGET_PROPERTY(_flags ${_target} COMPILE_FLAGS)
+
+	append_flags("${_flags}" "${_flg}")
+   
+	SET_TARGET_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")
+ENDMACRO (add_target_compile_flags)
\ No newline at end of file

Copied: branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,64 @@
+# ARGV2 - capable flag
+MACRO(ADM_DISPLAY _name _val)
+	SET(PROCEED TRUE)
+	
+	IF (${ARGC} EQUAL 3)
+		IF (NOT ${ARGV2})
+			SET(PROCEED FALSE)
+		ENDIF (NOT ${ARGV2})
+	ENDIF (${ARGC} EQUAL 3)
+	
+	IF (${PROCEED} STREQUAL "TRUE")
+		IF (${_val} EQUAL 1)
+			SET(s "Yes")
+		ELSE (${_val} EQUAL 1)
+			SET(s "No")
+		ENDIF (${_val} EQUAL 1)
+	
+		MESSAGE("   ${_name}  ${s}")
+	ENDIF (${PROCEED} STREQUAL "TRUE")
+ENDMACRO(ADM_DISPLAY)
+
+MESSAGE("*********************")
+MESSAGE("***    SUMMARY    ***")
+MESSAGE("*********************")
+ADM_DISPLAY("GTK+      " ADM_UI_GTK)
+ADM_DISPLAY("Qt4       " ADM_UI_QT4)
+
+MESSAGE("***  Video Codec  ***")
+ADM_DISPLAY("x264      " USE_X264)
+ADM_DISPLAY("Xvid      " USE_XVID_4)
+
+MESSAGE("***  Audio Codec  ***")
+ADM_DISPLAY("Aften     " USE_AFTEN)
+ADM_DISPLAY("amrnb     " USE_AMR_NB)
+ADM_DISPLAY("LAME      " HAVE_LIBMP3LAME)
+ADM_DISPLAY("FAAC      " USE_FAAC)
+ADM_DISPLAY("FAAD      " USE_FAAD)
+ADM_DISPLAY("libdca    " USE_LIBDCA)
+ADM_DISPLAY("Vorbis    " USE_VORBIS)
+
+MESSAGE("*** Audio Device  ***")
+ADM_DISPLAY("ALSA      " ALSA_SUPPORT ${ALSA_CAPABLE})
+ADM_DISPLAY("aRts      " USE_ARTS ${ARTS_CAPABLE})
+ADM_DISPLAY("ESD       " USE_ESD ${ESD_CAPABLE})
+ADM_DISPLAY("JACK      " USE_JACK ${JACK_CAPABLE})
+ADM_DISPLAY("OSS       " OSS_SUPPORT ${OSS_CAPABLE})
+ADM_DISPLAY("SRC       " USE_SRC ${JACK_CAPABLE})
+
+MESSAGE("*** Miscellaneous ***")
+ADM_DISPLAY("FontConfig" USE_FONTCONFIG)
+ADM_DISPLAY("FreeType2 " FREETYPE2_FOUND)
+ADM_DISPLAY("gettext   " HAVE_GETTEXT)
+ADM_DISPLAY("SDL       " USE_SDL)
+ADM_DISPLAY("XVideo    " USE_XV ${XVIDEO_CAPABLE})
+
+MESSAGE("*********************")
+
+IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	MESSAGE("***  Debug Build  ***")
+ELSE (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	MESSAGE("*** Release Build ***")
+ENDIF(CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+MESSAGE("*********************")

Added: branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,38 @@
+# - determine CPU and Operating System
+#  ADM_CPU_X86      - x86 CPU architecture was detected
+#  ADM_CPU_X86_64   - x86-64 CPU architecture was detected
+#  ADM_OS_DARWIN    - Mac OS X was detected
+#  ADM_OS_LINUX     - Linux was detected
+#  ADM_OS_WINDOWS   - Microsoft Windows was detected
+
+INCLUDE(CMakeDetermineSystem)
+
+IF (WIN32)
+	SET(ADM_OS_WINDOWS 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
+		SET(ADM_CPU_X86 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
+ELSEIF (APPLE)
+	SET(ADM_OS_DARWIN 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
+		SET(ADM_CPU_X86 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
+ELSEIF (UNIX)
+	SET(ADM_OS_LINUX 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
+		SET(ADM_CPU_X86 1)
+	ELSEIF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
+		SET(ADM_CPU_X86_64 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
+ENDIF (WIN32)
+
+IF (NOT ADM_OS_DARWIN AND NOT ADM_OS_WINDOWS AND NOT ADM_OS_LINUX)
+	MESSAGE(FATAL_ERROR "Operating System not supported (${CMAKE_SYSTEM_NAME})")
+ENDIF (NOT ADM_OS_DARWIN AND NOT ADM_OS_WINDOWS AND NOT ADM_OS_LINUX)
+
+IF (NOT ADM_CPU_X86 AND NOT ADM_CPU_X86_64)
+	MESSAGE(FATAL_ERROR "CPU not supported (${CMAKE_SYSTEM_PROCESSOR})")
+ENDIF (NOT ADM_CPU_X86 AND NOT ADM_CPU_X86_64)	
\ No newline at end of file

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,45 +0,0 @@
-# - Locate the SDL library using sdl-config
-# This module defines
-#  SDL_LIBRARY, the library to link against
-#  SDL_FOUND, if false, do not try to link to SDL
-#  SDL_INCLUDE_DIR, where to find SDL.h
-#
-#MACRO(ADM_FIND_SDL)
-#
-#FIND_PROGRAM(SDL_EXECUTABLE
-#  NAMES sdl-config
-#  PATHS
-#  $ENV{SDLDIR}/bin
-#)
-#if(SDL_EXECUTABLE)
-#  MESSAGE(STATUS "sdl-config found ${SDL_EXECUTABLE}")
-## Check we can run it
-#    FIND_PROGRAM(SH_EXECUTABLE NAMES sh)
-#
-#    IF(SH_EXECUTABLE)
-#      MESSAGE(STATUS "sh found ${SH_EXECUTABLE}")
-#    
-#      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS "${SDL_EXECUTABLE} --libs"   OUTPUT_VARIABLE SDL_LDFLAGS )
-#      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS "${SDL_EXECUTABLE} --cflags" OUTPUT_VARIABLE SDL_CFLAGS )
-#      SET(SDL_FOUND TRUE)
-#    ELSEIF(WIN32)
-#      SET(SDL_FOUND TRUE)
-#      SET(SDL_LDFLAGS "-L/mingw/lib -lmingw32 -lSDLmain -lSDL -mwindows")
-#      SET(SDL_CFLAGS "-I/mingw/include/SDL -D_GNU_SOURCE=1 -Dmain=SDL_main")
-#    ENDIF(SH_EXECUTABLE)
-#    
-#    IF(SDL_FOUND)
-#      MESSAGE(STATUS "cflags : ${SDL_CFLAGS}")
-#      MESSAGE(STATUS "libs   : ${SDL_LDFLAGS}")
-#    ENDIF(SDL_FOUND)
-#else(SDL_EXECUTABLE)
-#  MESSAGE(STATUS "sdl-config not found ")
-#endif(SDL_EXECUTABLE)
-#
-#ENDMACRO(ADM_FIND_SDL)
-
-MACRO(SDLify _source)
-	if(SDL_FOUND)
-        SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS "-I${SDL_INCLUDE_DIR}")
-	endif(SDL_FOUND)
-ENDMACRO(SDLify)

Copied: branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,40 @@
+SET(CONFIG_ENCODERS 1)
+SET(CONFIG_DVVIDEO_ENCODER 1)
+
+SET(CONFIG_DECODERS 1)
+SET(CONFIG_DVVIDEO_DECODER 1)
+SET(CONFIG_H263_DECODER 1)
+SET(CONFIG_MPEG4_DECODER 1)
+SET(CONFIG_MPEGAUDIO_HP 1)
+SET(CONFIG_SNOW_DECODER 1)
+SET(CONFIG_VC1_DECODER 1)
+SET(CONFIG_WMV2_DECODER 1)
+SET(CONFIG_WMV3_DECODER 1)
+SET(CONFIG_ZLIB 1)
+
+SET(CONFIG_MUXERS 1)
+SET(CONFIG_MOV_MUXER 1)
+SET(CONFIG_MP4_MUXER 1)
+SET(CONFIG_PSP_MUXER 1)
+SET(CONFIG_TG2_MUXER 1)
+SET(CONFIG_TGP_MUXER 1)
+
+SET(ENABLE_MMX 1)
+SET(ENABLE_THREADS 1)
+SET(HAVE_FAST_UNALIGNED 1)
+SET(HAVE_LRINTF 1)
+SET(HAVE_MMX 1)
+SET(HAVE_THREADS 1)
+SET(RUNTIME_CPUDETECT 1)
+
+IF (ADM_CPU_X86_64)
+	SET(HAVE_FAST_64BIT 1)
+ENDIF (ADM_CPU_X86_64)
+
+IF (NOT NO_SSSE3)
+	SET(HAVE_SSSE3 1)
+ENDIF (NOT NO_SSSE3)
+
+IF (ADM_OS_DARWIN)
+	SET(CONFIG_DARWIN 1)
+ENDIF (ADM_OS_DARWIN)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,38 +0,0 @@
-# Small Macro to check head & lib and set output variable
-# all in one line, cmake is cool :)
-MACRO (ADM_CHECK_HL _banner _includeName _libName _libFunc _varToSet)
-MESSAGE(STATUS "<Checking for ${_banner}>")
-MESSAGE(STATUS "<******************************>")
-if(NO_${_banner})
-message(status "<disabled per request>")
-else(NO_${_banner})
- SET(_oldCRF ${CMAKE_REQUIRED_FLAGS})
- SET(CMAKE_REQUIRED_FLAGS "$ENV{CFLAGS} ${_oldCRF}")
-#MESSAGE(STATUS "CMAKE_REQUIRED_FLAGS:${CMAKE_REQUIRED_FLAGS}")
-#MESSAGE(STATUS "ENV:"$ENV{CFLAGS})
-CHECK_INCLUDE_FILES("${_includeName}" "${_varToSet}_H")
-#MESSAGE("OUT ${HAVE_IT_H}")
-if(${_varToSet}_H)
-  MESSAGE(STATUS "Header ${_includeName} Found")
-#FIND_LIBRARY(ADM_PATH_LIB ${_libName})
-  CHECK_LIBRARY_EXISTS(${_libName} ${_libFunc} "" ${_varToSet}_L)
-  if(${_varToSet}_L)
-        MESSAGE(STATUS "Lib ${_libName} Found")
-        SET(${_varToSet}  1)
-  else(${_varToSet}_L)
-        MESSAGE("Lib not found")
-  endif(${_varToSet}_L)
-else(${_varToSet}_H)
-  MESSAGE("Header not found(${_includeName})")
-endif(${_varToSet}_H)
-
-if(${_varToSet})
-   MESSAGE(STATUS "${_banner} OK")
-else(${_varToSet})
-     MESSAGE(STATUS "${_banner} support off")
-endif(${_varToSet})
-SET(CMAKE_REQUIRED_FLAGS "${_oldCRF}")
-endif(NO_${_banner})
-ENDMACRO (ADM_CHECK_HL _includeName _libName _libFunc _varToSet)
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,39 +0,0 @@
-# Small Macro to check head & lib and set output variable
-# all in one line, cmake is cool :)
-MACRO (ADM_COMPILE _file _cflags _lib _varToSet _output)
-TRY_COMPILE(${_varToSet}
-      ${CMAKE_BINARY_DIR}
-      ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
-      CMAKE_FLAGS -DLINK_LIBRARIES:STRING=${_lib}
-      COMPILE_DEFINITIONS  ${_cflags}
-      
-      OUTPUT_VARIABLE ${_output}) 
-#MESSAGE( ./compile.log "Compile:${MYOUTPUT}")
-ENDMACRO (ADM_COMPILE _file _cflags _varToSet _output)
-#########################################################
-MACRO (ADM_COMPILE_WITH_WITHOUT _file _cflags _lib _varToSet)
-
-ADM_COMPILE( ${_file} ${_cflags} ${_lib} CWITH logwith)
-ADM_COMPILE( ${_file} "" ${_lib}  CWITHOUT logwithout)
-
-if(CWITH AND NOT CWITHOUT)
-  SET(${_varToSet}  1)
-  MESSAGE (STATUS "<${_cflags}> needed")
-else(CWITH AND NOT CWITHOUT)
-  if(NOT CWITH AND CWITHOUT)
-    MESSAGE (STATUS "<${_cflags}> Not needed")
-  else(NOT CWITH AND CWITHOUT)
-    if(NOT CWIDTH AND NOT CWITHOUT)
-      MESSAGE(STATUS "Inconsistent compiler output with:${CWITH}, without:${CWITHOUT}")
-      MESSAGE(STATUS "**********************************")
-      MESSAGE(STATUS "${logwith}")
-      MESSAGE(STATUS "**********************************")
-      MESSAGE(STATUS "${logwithout}")
-    endif(NOT CWIDTH AND NOT CWITHOUT)
-  endif(NOT CWITH AND CWITHOUT)
-endif(CWITH AND NOT CWITHOUT)
-ENDMACRO (ADM_COMPILE_WITH_WITHOUT _file _cflags _varToSet)
-
-
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,44 +0,0 @@
-MACRO(ADM_DISPLAY _name _val)
-#MESSAGE("${_val}")
-if(${_val} EQUAL 1)
-  set(s "Yes")
-else(${_val} EQUAL 1)
-  set(s "No")
-endif(${_val} EQUAL 1)
-MESSAGE("${_name}  ${s}") 
-ENDMACRO(ADM_DISPLAY _name _val)
-
-
-
-MESSAGE("*******************")
-MESSAGE("**  Summary      **")
-MESSAGE("*******************")
-MESSAGE("Gtk         ${GTK_FOUND}")
-MESSAGE("Qt4         ${QT4_FOUND}")
-MESSAGE("*** Video Codec ***")
-ADM_DISPLAY("X264      " USE_X264)
-ADM_DISPLAY("Xvid4     " USE_XVID_4)
-MESSAGE("*** Audio Codec ***")
-ADM_DISPLAY("LAME      " HAVE_LIBMP3LAME)
-ADM_DISPLAY("FAAD      " USE_FAAD)
-ADM_DISPLAY("FAAC      " USE_FAAC)
-ADM_DISPLAY("Vorbis    " USE_VORBIS)
-ADM_DISPLAY("Aften     " USE_AFTEN)
-ADM_DISPLAY("libDCA    " USE_LIBDCA)
-ADM_DISPLAY("libAMRNB  " USE_AMR_NB)
-
-MESSAGE("*** Audio Device ***")
-ADM_DISPLAY("ESD       " USE_ESD)
-ADM_DISPLAY("OSS       " OSS_SUPPORT)
-ADM_DISPLAY("ARTS      " USE_ARTS)
-ADM_DISPLAY("JACK      " USE_JACK)
-
-MESSAGE("*** Misc       ***")
-ADM_DISPLAY("SDL       " USE_SDL)
-ADM_DISPLAY("FreeType  " USE_FREETYPE)
-ADM_DISPLAY("FontConfig" USE_FONTCONFIG)
-ADM_DISPLAY("Gettext   " HAVE_GETTEXT)
-ADM_DISPLAY("Xvideo    " USE_XV)
-ADM_DISPLAY("samplerate" USE_SRC)
-MESSAGE("*******************")
-MESSAGE("*******************")

Copied: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/config.h.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,246 @@
+/* config.h.in.  Generated from configure.in by autoheader.  */
+
+/* Jog Shuttle */
+#cmakedefine USE_JOG
+
+/* MPEG2DEC */
+#cmakedefine ACCEL_DETECT
+
+/* Big endian CPU - SPARC or PowerPC */
+#cmakedefine ADM_BIG_ENDIAN
+
+#define PACKAGE   "avidemux"
+#define ADMLOCALE "${ADM_LOCALE}"
+
+/* BSD OS specific ifdef */
+#cmakedefine ADM_BSD_FAMILY
+
+#cmakedefine HAVE_AUDIO
+
+/* Sparc workstations */
+#cmakedefine ADM_SPARC
+
+/* Build for Windows 32bits */
+#cmakedefine ADM_WIN32
+
+/* use ALSA as possible audio device */
+#cmakedefine ALSA_SUPPORT
+
+/* AMR_NB */
+#cmakedefine AMR_NB
+
+/* X86_64 AMD64 assembly */
+#cmakedefine ARCH_64_BITS
+
+/* Enable PowerPC optim */
+#cmakedefine ARCH_POWERPC
+
+/* AltiVec for libmpeg2 */
+#cmakedefine ARCH_PPC
+
+/* post proc */
+#cmakedefine ARCH_X86
+
+/* X86_32 assembly */
+#cmakedefine ARCH_X86_32
+
+/* X86_64 AMD64 assembly */
+#cmakedefine ARCH_X86_64
+
+/* FFMPEG */
+#cmakedefine CONFIG_ENCODERS
+#cmakedefine CONFIG_DVVIDEO_ENCODER
+
+#cmakedefine CONFIG_DECODERS
+#cmakedefine CONFIG_DVVIDEO_DECODER
+#cmakedefine CONFIG_H263_DECODER
+#cmakedefine CONFIG_MPEG4_DECODER
+#cmakedefine CONFIG_MPEGAUDIO_HP
+#cmakedefine CONFIG_SNOW_DECODER
+#cmakedefine CONFIG_VC1_DECODER
+#cmakedefine CONFIG_WMV2_DECODER
+#cmakedefine CONFIG_WMV3_DECODER
+#cmakedefine CONFIG_ZLIB
+
+#cmakedefine CONFIG_MUXERS
+#cmakedefine CONFIG_MOV_MUXER
+#cmakedefine CONFIG_MP4_MUXER
+#cmakedefine CONFIG_PSP_MUXER
+#cmakedefine CONFIG_TG2_MUXER
+#cmakedefine CONFIG_TGP_MUXER
+
+#cmakedefine ENABLE_MMX ${ENABLE_MMX}
+#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
+#cmakedefine HAVE_FAST_UNALIGNED
+#cmakedefine HAVE_LRINTF
+#cmakedefine HAVE_MMX
+#cmakedefine HAVE_THREADS
+#cmakedefine RUNTIME_CPUDETECT
+
+#cmakedefine HAVE_FAST_64BIT
+#cmakedefine HAVE_SSSE3
+#cmakedefine CONFIG_DARWIN
+
+/* Name mangling */
+#cmakedefine CYG_MANGLING
+
+/* Mad */
+#cmakedefine FPM_DEFAULT
+#cmakedefine FPM_INTEL
+#cmakedefine FPM_PPC
+#cmakedefine FPM_SPARC
+
+/* Using GCC 2.9x.x */
+#cmakedefine GCC_2_95_X
+
+/* gettext package name */
+#cmakedefine GETTEXT_PACKAGE
+
+/* AltiVec for mpeg2enc */
+#cmakedefine HAVE_ALTIVEC
+
+/* Enable AltiVec by default */
+#cmakedefine HAVE_ALTIVEC_H
+
+/* Enable AltiVec by default */
+#cmakedefine HAVE_BUILTIN_VECTOR
+
+/* FontConfig detected */
+#cmakedefine HAVE_FONTCONFIG
+
+/* Define if the GNU gettext() function is already present or preinstalled. */
+#cmakedefine HAVE_GETTEXT
+
+/* Define to 1 if you have the `gettimeofday' function. */
+#cmakedefine HAVE_GETTIMEOFDAY
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#cmakedefine HAVE_INTTYPES_H
+
+/* Define to 1 if you have the `mp3lame' library (-lmp3lame). */
+#cmakedefine HAVE_LIBMP3LAME
+
+/* Use malloc.h */
+#cmakedefine HAVE_MALLOC_H
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#cmakedefine HAVE_STDINT_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#cmakedefine HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#cmakedefine HAVE_UNISTD_H
+
+/* stricter prototyping */
+#cmakedefine ICONV_NEED_CONST
+
+/* use classing FAAD support */
+#cmakedefine OLD_FAAD_PROTO
+
+/* OSS detected */
+#cmakedefine OSS_SUPPORT
+
+/* use liba52 */
+#cmakedefine USE_AC3
+
+/* use Aften AC3 encoder */
+#cmakedefine USE_AFTEN
+
+/* Use Aften 0.07 */
+#cmakedefine USE_AFTEN_07
+
+/* Use Aften 0.08 */
+#cmakedefine USE_AFTEN_08
+
+/* AltiVec for mpeg2enc */
+#cmakedefine USE_ALTIVEC
+
+/* Tell avidemux to use libamrnb */
+#cmakedefine USE_AMR_NB
+
+/* aRts detected */
+#cmakedefine USE_ARTS
+
+/* ESD detected */
+#cmakedefine USE_ESD
+
+/* Jack detected */
+#cmakedefine USE_JACK
+
+/* Use faac audio enccoder */
+#cmakedefine USE_FAAC
+
+/* FAAD2 detected */
+#cmakedefine USE_FAAD
+
+/* FFmpeg */
+#cmakedefine USE_FFMPEG
+
+/* FontConfig detected */
+#cmakedefine USE_FONTCONFIG
+
+/* FreeType2 detected */
+#cmakedefine USE_FREETYPE
+
+/* use late binding of selected libraries */
+#cmakedefine USE_LATE_BINDING
+
+/* libdca detected */
+#cmakedefine USE_LIBDCA
+
+/* Libxml2 is available */
+#cmakedefine USE_LIBXML2
+
+/* MJPEG */
+#cmakedefine USE_MJPEG
+
+/* use libmad */
+#cmakedefine USE_MP3
+
+/* libpng is available */
+#cmakedefine USE_PNG
+
+/* use libsamplerate */
+#cmakedefine USE_SRC
+
+/* SDL detected */
+#cmakedefine USE_SDL
+
+/* Vorbis detected */
+#cmakedefine USE_VORBIS
+
+/* use x264 encoder */
+#cmakedefine USE_X264
+
+/* XVideo detected */
+#cmakedefine USE_XV
+
+/* use Xvid 1.x API */
+#cmakedefine USE_XVID_4
+
+/* use Xvid 0.9 API */
+#cmakedefine USE_XX_XVID
+
+/* Version number of package */
+#define  VERSION "${VERSION}"
+
+/* Big endian CPU - SPARC or PowerPC */
+#cmakedefine WORDS_BIGENDIAN
+
+/* use Nvwa memory leak detector */
+#cmakedefine FIND_LEAKS
+
+#cmakedefine ADM_OS_DARWIN
+#cmakedefine ADM_OS_LINUX
+#cmakedefine ADM_OS_WINDOWS
+
+#cmakedefine ADM_CPU_X86
+#cmakedefine ADM_CPU_X86_64
+
+#ifdef ADM_OS_WINDOWS
+#define rindex strrchr
+#define index strchr
+#define ftello ftello64
+#define fseeko fseeko64
+#endif

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,43 +0,0 @@
-MACRO(SET_LAVCODEC_FLAGS)
-	SET(CONFIG_ENCODERS 1)
-	SET(CONFIG_DVVIDEO_ENCODER 1)
-
-	SET(CONFIG_DECODERS 1)
-	SET(CONFIG_DVVIDEO_DECODER 1)
-	SET(CONFIG_H263_DECODER 1)
-	SET(CONFIG_MPEG4_DECODER 1)
-	SET(CONFIG_MPEGAUDIO_HP 1)
-	SET(CONFIG_SNOW_DECODER 1)
-	SET(CONFIG_VC1_DECODER 1)
-	SET(CONFIG_WMV2_DECODER 1)
-	SET(CONFIG_WMV3_DECODER 1)
-	SET(CONFIG_ZLIB 1)
-
-	SET(CONFIG_MUXERS 1)
-	SET(CONFIG_MOV_MUXER 1)
-	SET(CONFIG_MP4_MUXER 1)
-	SET(CONFIG_PSP_MUXER 1)
-	SET(CONFIG_TG2_MUXER 1)
-	SET(CONFIG_TGP_MUXER 1)
-
-	SET(ENABLE_MMX 1)
-	SET(ENABLE_THREADS 1)
-	SET(HAVE_FAST_UNALIGNED 1)
-	SET(HAVE_LRINTF 1)
-	SET(HAVE_MMX 1)
-	SET(HAVE_THREADS 1)
-	SET(RUNTIME_CPUDETECT 1)
-	
-	IF (ADM_CPU_X86_64)
-		SET(HAVE_FAST_64BIT 1)
-	ENDIF (ADM_CPU_X86_64)
-
-	IF (NOT NO_SSSE3)
-		SET(HAVE_SSSE3 1)
-	ENDIF (NOT NO_SSSE3)
-
-	IF (ADM_OS_APPLE)
-		SET(CONFIG_DARWIN 1)
-	ENDIF (ADM_OS_APPLE)
-ENDMACRO(SET_LAVCODEC_FLAGS)
-

Deleted: branches/avidemux_2.5_branch_gruntster/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,276 +0,0 @@
-/* config.h.in.  Generated from configure.in by autoheader.  */
-
-/* Jog Shuttle */
-#cmakedefine USE_JOG
-
-/* MPEG2DEC */
-#cmakedefine ACCEL_DETECT
-
-/* Big endian CPU - SPARC or PowerPC */
-#cmakedefine ADM_BIG_ENDIAN
-
-#define PACKAGE   "avidemux"
-#define ADMLOCALE "${ADM_LOCALE}"
-
-/* BSD OS specific ifdef */
-#cmakedefine ADM_BSD_FAMILY
-
-#cmakedefine HAVE_AUDIO
-
-/* Sparc workstations */
-#cmakedefine ADM_SPARC
-
-/* Build for Windows 32bits */
-#cmakedefine ADM_WIN32
-
-/* ALSA is 1.0 */
-#cmakedefine ALSA_1_0_SUPPORT
-
-/* use ALSA as possible audio device */
-#cmakedefine ALSA_SUPPORT
-
-/* AMR_NB */
-#cmakedefine AMR_NB
-
-/* X86_64 AMD64 assembly */
-#cmakedefine ARCH_64_BITS
-
-/* Enable PowerPC optim */
-#cmakedefine ARCH_POWERPC
-
-/* AltiVec for libmpeg2 */
-#cmakedefine ARCH_PPC
-
-/* post proc */
-#cmakedefine ARCH_X86
-
-/* X86_32 assembly */
-#cmakedefine ARCH_X86_32
-
-/* X86_64 AMD64 assembly */
-#cmakedefine ARCH_X86_64
-
-/* FFMPEG */
-#cmakedefine CONFIG_ENCODERS
-#cmakedefine CONFIG_DVVIDEO_ENCODER
-
-#cmakedefine CONFIG_DECODERS
-#cmakedefine CONFIG_DVVIDEO_DECODER
-#cmakedefine CONFIG_H263_DECODER
-#cmakedefine CONFIG_MPEG4_DECODER
-#cmakedefine CONFIG_MPEGAUDIO_HP
-#cmakedefine CONFIG_SNOW_DECODER
-#cmakedefine CONFIG_VC1_DECODER
-#cmakedefine CONFIG_WMV2_DECODER
-#cmakedefine CONFIG_WMV3_DECODER
-#cmakedefine CONFIG_ZLIB
-
-#cmakedefine CONFIG_MUXERS
-#cmakedefine CONFIG_MOV_MUXER
-#cmakedefine CONFIG_MP4_MUXER
-#cmakedefine CONFIG_PSP_MUXER
-#cmakedefine CONFIG_TG2_MUXER
-#cmakedefine CONFIG_TGP_MUXER
-
-#cmakedefine ENABLE_MMX ${ENABLE_MMX}
-#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
-#cmakedefine HAVE_FAST_UNALIGNED
-#cmakedefine HAVE_LRINTF
-#cmakedefine HAVE_MMX
-#cmakedefine HAVE_THREADS
-#cmakedefine RUNTIME_CPUDETECT
-
-#cmakedefine HAVE_FAST_64BIT
-#cmakedefine HAVE_SSSE3
-#cmakedefine CONFIG_DARWIN
-
-/* Name mangling */
-#cmakedefine CYG_MANGLING
-
-/* Mad */
-#cmakedefine FPM_DEFAULT
-#cmakedefine FPM_INTEL
-#cmakedefine FPM_PPC
-#cmakedefine FPM_SPARC
-
-/* Using GCC 2.9x.x */
-#cmakedefine GCC_2_95_X
-
-/* gettext package name */
-#cmakedefine GETTEXT_PACKAGE
-
-/* AltiVec for mpeg2enc */
-#cmakedefine HAVE_ALTIVEC
-
-/* Enable AltiVec by default */
-#cmakedefine HAVE_ALTIVEC_H
-
-/* Enable AltiVec by default */
-#cmakedefine HAVE_BUILTIN_VECTOR
-
-/* FontConfig detected */
-#cmakedefine HAVE_FONTCONFIG
-
-/* Define if the GNU gettext() function is already present or preinstalled. */
-#cmakedefine HAVE_GETTEXT
-
-/* Define to 1 if you have the `gettimeofday' function. */
-#cmakedefine HAVE_GETTIMEOFDAY
-
-/* Define to 1 if you have the <inttypes.h> header file. */
-#cmakedefine HAVE_INTTYPES_H
-
-/* Define to 1 if you have the `mp3lame' library (-lmp3lame). */
-#cmakedefine HAVE_LIBMP3LAME
-
-/* Use malloc.h */
-#cmakedefine HAVE_MALLOC_H
-
-/* Define to 1 if you have the <stdint.h> header file. */
-#cmakedefine HAVE_STDINT_H
-
-/* Define to 1 if you have the <stdlib.h> header file. */
-#cmakedefine HAVE_STDLIB_H
-
-/* Define to 1 if you have the <string.h> header file. */
-#cmakedefine HAVE_STRING_H
-
-/* Define to 1 if you have the <sys/stat.h> header file. */
-#cmakedefine HAVE_SYS_STAT_H
-
-/* Define to 1 if you have the <sys/types.h> header file. */
-#cmakedefine HAVE_SYS_TYPES_H
-
-/* Define to 1 if you have the <unistd.h> header file. */
-#cmakedefine HAVE_UNISTD_H
-
-/* stricter prototyping */
-#cmakedefine ICONV_NEED_CONST
-
-/* use classing FAAD support */
-#cmakedefine OLD_FAAD_PROTO
-
-/* OSS detected */
-#cmakedefine OSS_SUPPORT
-
-/* Name of package */
-#cmakedefine PACKAGE
-
-/* Define to the address where bug reports for this package should be sent. */
-#cmakedefine PACKAGE_BUGREPORT
-
-/* Define to the full name of this package. */
-#cmakedefine PACKAGE_NAME
-
-/* Define to the full name and version of this package. */
-#cmakedefine PACKAGE_STRING
-
-/* Define to the one symbol short name of this package. */
-#cmakedefine PACKAGE_TARNAME
-
-/* Define to the version of this package. */
-#cmakedefine PACKAGE_VERSION
-
-/* use liba52 */
-#cmakedefine USE_AC3
-
-/* use Aften AC3 encoder */
-#cmakedefine USE_AFTEN
-
-/* Use Aften 0.07 */
-#cmakedefine USE_AFTEN_07
-
-/* Use Aften 0.08 */
-#cmakedefine USE_AFTEN_08
-
-/* AltiVec for mpeg2enc */
-#cmakedefine USE_ALTIVEC
-
-/* Tell avidemux to use libamrnb */
-#cmakedefine USE_AMR_NB
-
-/* aRts detected */
-#cmakedefine USE_ARTS
-
-/* ESD detected */
-#cmakedefine USE_ESD
-
-/* Jack detected */
-#cmakedefine USE_JACK
-
-/* Use faac audio enccoder */
-#cmakedefine USE_FAAC
-
-/* FAAD2 detected */
-#cmakedefine USE_FAAD
-
-/* FFmpeg */
-#cmakedefine USE_FFMPEG
-
-/* FontConfig detected */
-#cmakedefine USE_FONTCONFIG
-
-/* FreeType2 detected */
-#cmakedefine USE_FREETYPE
-
-/* use late binding of selected libraries */
-#cmakedefine USE_LATE_BINDING
-
-/* libdca detected */
-#cmakedefine USE_LIBDCA
-
-/* Libxml2 is available */
-#cmakedefine USE_LIBXML2
-
-/* MJPEG */
-#cmakedefine USE_MJPEG
-
-/* use libmad */
-#cmakedefine USE_MP3
-
-/* libpng is available */
-#cmakedefine USE_PNG
-
-/* use libsamplerate */
-#cmakedefine USE_SRC
-
-/* SDL detected */
-#cmakedefine USE_SDL
-
-/* Vorbis detected */
-#cmakedefine USE_VORBIS
-
-/* use x264 encoder */
-#cmakedefine USE_X264
-
-/* XVideo detected */
-#cmakedefine USE_XV
-
-/* use Xvid 1.x API */
-#cmakedefine USE_XVID_4
-
-/* use Xvid 0.9 API */
-#cmakedefine USE_XX_XVID
-
-/* Version number of package */
-#define  VERSION "${VERSION}"
-
-/* Big endian CPU - SPARC or PowerPC */
-#cmakedefine WORDS_BIGENDIAN
-
-/* use Nvwa memory leak detector */
-#cmakedefine FIND_LEAKS
-
-#cmakedefine ADM_OS_APPLE
-#cmakedefine ADM_OS_UNIX
-#cmakedefine ADM_OS_WINDOWS
-
-#cmakedefine ADM_CPU_X86
-#cmakedefine ADM_CPU_X86_64
-
-#ifdef ADM_OS_WINDOWS
-#define rindex strrchr
-#define index strchr
-#define ftello ftello64
-#define fseeko fseeko64
-#endif



From gruntster at mail.berlios.de  Thu Nov 15 00:45:58 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 15 Nov 2007 00:45:58 +0100
Subject: [Avidemux-svn-commit] r3691 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200711142345.lAENjwEX019179@sheep.berlios.de>

Author: gruntster
Date: 2007-11-15 00:45:47 +0100 (Thu, 15 Nov 2007)
New Revision: 3691

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
Log:
[CMake] fixes for Linux

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-14 23:45:47 UTC (rev 3691)
@@ -265,7 +265,7 @@
 #XVideo 
 if(USE_XV)
 	add_libs_all_targets("${X11_LIBRARIES}")
-	add_libs_all_targets("{$XVIDEO_LIBRARY}")
+	add_libs_all_targets("${XVIDEO_LIBRARY_DIR}")
 endif(USE_XV)
 
 # SDL
@@ -285,7 +285,7 @@
 
 # ESD
 if(USE_ESD)
-	add_libs_all_targets("${ESD_LIBRARY}")
+	add_libs_all_targets("${ESD_LIBRARY_DIR}")
 endif(USE_ESD)
 
 # JACK

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
@@ -74,7 +74,11 @@
 MESSAGE(STATUS "*****************")
 
 IF (LAME)
-	FIND_HEADER_AND_LIB(LAME lame/lame.h mp3lame lame_init)
+	IF (ADM_OS_LINUX)
+		SET(LAME_REQUIRED_FLAGS "-lm")
+	ENDIF (ADM_OS_LINUX)
+
+	FIND_HEADER_AND_LIB(LAME lame/lame.h mp3lame lame_init ${LAME_REQUIRED_FLAGS})
 	PRINT_LIBRARY_INFO("LAME" LAME_FOUND "${LAME_INCLUDE_DIR}" "${LAME_LIBRARY_DIR}")
 	
 	IF (LAME_FOUND)
@@ -95,10 +99,14 @@
 MESSAGE(STATUS "*******************")
 
 IF (LIBDCA)
+	IF (ADM_OS_LINUX)
+		SET(LIBDCA_REQUIRED_FLAGS "-lm")
+	ENDIF (ADM_OS_LINUX)
+	
 	IF (USE_LATE_BINDING)
 		FIND_HEADER_AND_LIB(LIBDCA dts.h)
 	ELSE (USE_LATE_BINDING)
-		FIND_HEADER_AND_LIB(LIBDCA dts.h dts dts_init)
+		FIND_HEADER_AND_LIB(LIBDCA dts.h dts dts_init ${LIBDCA_REQUIRED_FLAGS})
 	ENDIF (USE_LATE_BINDING)
 	
 	PRINT_LIBRARY_INFO("libdca" LIBDCA_FOUND "${LIBDCA_INCLUDE_DIR}" "${LIBDCA_LIBRARY_DIR}")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
@@ -37,7 +37,7 @@
 	MESSAGE(STATUS "*****************")
 
 	IF (ARTS)
-		FIND_PACKAGE(FindArts)
+		FIND_PACKAGE(Arts)
 		PRINT_LIBRARY_INFO("aRts" ARTS_FOUND "${ARTS_CFLAGS}" "${ARTS_LDFLAGS}")
 		
 		IF (ARTS_FOUND)
@@ -63,7 +63,7 @@
 
 	IF (ESD)
 		FIND_HEADER_AND_LIB(ESD esd.h esd esd_close)
-		PRINT_LIBRARY_INFO("ESD" ESD_FOUND "${ESD_INCLUDE_DIR}" "${ESD_LIBRARY}")
+		PRINT_LIBRARY_INFO("ESD" ESD_FOUND "${ESD_INCLUDE_DIR}" "${ESD_LIBRARY_DIR}")
 
 		IF (ESD_FOUND)
 			SET(USE_ESD 1)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
@@ -116,18 +116,18 @@
 ########################################
 IF (ADM_OS_LINUX OR ADM_OS_DARWIN)	
 	OPTION(XVIDEO "" ON)
-	
+
 	IF (X11_FOUND AND XVIDEO)
 		MESSAGE(STATUS "Checking for XVideo")
 		MESSAGE(STATUS "*******************")
 
-		FIND_HEADER_AND_LIB(XVIDEO X11/extensions/Xvlib.h Xv XvShmPutImage "-include X11/Xlib.h ${X11_INCLUDE_DIR} ${X11_LIBRARIES}")
-		PRINT_LIBRARY_INFO("XVideo" XVIDEO_FOUND "${XVIDEO_INCLUDE_DIR}" "${XVIDEO_LIBRARY}")
-		
+		FIND_HEADER_AND_LIB(XVIDEO X11/extensions/Xvlib.h Xv XvShmPutImage "${X11_LIBRARIES}")
+		PRINT_LIBRARY_INFO("XVideo" XVIDEO_FOUND "${XVIDEO_INCLUDE_DIR}" "${XVIDEO_LIBRARY_DIR}")
+
 		IF (XVIDEO_FOUND)
 			SET(USE_XV 1)
 		ENDIF (XVIDEO_FOUND)
-	
+
 		MESSAGE("")
 	ENDIF (X11_FOUND AND XVIDEO)
 ELSE (ADM_OS_LINUX OR ADM_OS_DARWIN)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
@@ -33,12 +33,16 @@
 
 IF (LIBICONV_LIBRARY_DIR)
 	MESSAGE(STATUS "libiconv is probably needed")
+
+	CHECK_CFLAGS_REQUIRED(iconv_check.cpp "-DICONV_NEED_CONST" "${LIBICONV_INCLUDE_DIR}" "${LIBICONV_LIBRARY_DIR}" LIBICONV_CFLAGS_REQUIRED)
 ELSE (LIBICONV_LIBRARY_DIR)
+	SET(LIBICONV_INCLUDE_DIR "")
+	SET(LIBICONV_LIBRARY_DIR "")
 	MESSAGE(STATUS "libiconv is probably not needed")
+
+	ADM_COMPILE(iconv_check.cpp "-DICONV_NEED_CONST" "" "" LIBICONV_CFLAGS_REQUIRED LIBICONV_COMPILE_OUTPUT)
 ENDIF (LIBICONV_LIBRARY_DIR)
 
-CHECK_CFLAGS_REQUIRED(iconv_check.cpp "-DICONV_NEED_CONST" "${LIBICONV_INCLUDE_DIR}" "${LIBICONV_LIBRARY_DIR}" LIBICONV_CFLAGS_REQUIRED)
-
 IF (LIBICONV_CFLAGS_REQUIRED)
 	SET(LIBICONV_DEFINITIONS "-DICONV_NEED_CONST")
 	SET(ICONV_NEED_CONST 1)
@@ -66,7 +70,7 @@
 MESSAGE(STATUS "Checking for libpng")
 MESSAGE(STATUS "*******************")
 
-FIND_PACKAGE(png)
+FIND_PACKAGE(PNG)
 PRINT_LIBRARY_INFO("libpng" PNG_FOUND "${PNG_INCLUDE_DIR} ${PNG_DEFINITIONS}" "${PNG_LIBRARIES}" FATAL_ERROR)
 
 SET(USE_PNG 1)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-14 16:59:14 UTC (rev 3690)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-14 23:45:47 UTC (rev 3691)
@@ -3,7 +3,7 @@
 MACRO(PRINT_LIBRARY_INFO libraryName libraryDetected compilerFlags linkerFlags)
 	IF (${libraryDetected})
 		MESSAGE(STATUS "Found ${libraryName}")
-		
+
 		IF (VERBOSE)
 			MESSAGE(STATUS "Compiler Flags: ${compilerFlags}")
 			MESSAGE(STATUS "Linker Flags  : ${linkerFlags}")
@@ -15,9 +15,9 @@
 
 
 MACRO(SDLify _source)
-	if(SDL_FOUND)
-        SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS "-I${SDL_INCLUDE_DIR}")
-	endif(SDL_FOUND)
+	IF (SDL_FOUND)
+		SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS "-I${SDL_INCLUDE_DIR}")
+	ENDIF (SDL_FOUND)
 ENDMACRO(SDLify)
 
 # ARGV2 = library to check
@@ -26,8 +26,8 @@
 MACRO(FIND_HEADER_AND_LIB prefix headerFile)
 	IF (NOT DEFINED ${prefix}_FOUND)
 		SET(${prefix}_FOUND 0 CACHE INTERNAL "")
-		SET(PROCEED 1)
-		
+		SET(_proceed 1)
+
 		IF (NOT ${headerFile} STREQUAL "")
 			FIND_PATH(${prefix}_INCLUDE_DIR ${headerFile})
 			MARK_AS_ADVANCED(${prefix}_INCLUDE_DIR)
@@ -35,12 +35,12 @@
 			IF (${prefix}_INCLUDE_DIR)
 				MESSAGE(STATUS "Found ${headerFile}")
 			ELSE (${prefix}_INCLUDE_DIR)
-				SET(PROCEED 0)
+				SET(_proceed 0)
 				MESSAGE("Could not find ${headerFile}")
 			ENDIF (${prefix}_INCLUDE_DIR)
 		ENDIF (NOT ${headerFile} STREQUAL "")
-		
-		IF (PROCEED AND NOT ${ARGV2} STREQUAL "")
+
+		IF (_proceed AND NOT ${ARGV2} STREQUAL "")
 			FIND_LIBRARY(${prefix}_LIBRARY_DIR ${ARGV2})
 			MARK_AS_ADVANCED(${prefix}_LIBRARY_DIR)
 
@@ -64,9 +64,9 @@
 			ELSE (${prefix}_LIBRARY_DIR)
 				MESSAGE(STATUS "Cound not find ${ARGV2} library")
 			ENDIF (${prefix}_LIBRARY_DIR)
-		ELSE (PROCEED AND NOT ${ARGV2} STREQUAL "")
-			SET(${prefix}_FOUND 1 CACHE INTERNAL "")
-		ENDIF (PROCEED AND NOT ${ARGV2} STREQUAL "")
+		ELSE (_proceed AND NOT ${ARGV2} STREQUAL "")
+			SET(${prefix}_FOUND ${_proceed} CACHE INTERNAL "")
+		ENDIF (_proceed AND NOT ${ARGV2} STREQUAL "")
 	ENDIF (NOT DEFINED ${prefix}_FOUND)
 ENDMACRO(FIND_HEADER_AND_LIB)
 
@@ -74,7 +74,7 @@
 MACRO (ADM_COMPILE _file _def _include _lib _varToSet _output)
 	IF (NOT DEFINED ${_varToSet}_COMPILED)
 		SET(${_varToSet}_COMPILED 1 CACHE INTERNAL "")
-		
+
 		TRY_COMPILE(${_varToSet}
 			  ${CMAKE_BINARY_DIR}
 			  ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
@@ -133,7 +133,7 @@
 	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
 
 	append_flags("${_flags}" "${_flg}")
-   
+
 	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")   
 ENDMACRO (add_source_compile_flags)
 
@@ -141,6 +141,7 @@
 	GET_TARGET_PROPERTY(_flags ${_target} COMPILE_FLAGS)
 
 	append_flags("${_flags}" "${_flg}")
-   
+
 	SET_TARGET_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")
+
 ENDMACRO (add_target_compile_flags)
\ No newline at end of file



From gruntster at mail.berlios.de  Thu Nov 15 17:32:20 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 15 Nov 2007 17:32:20 +0100
Subject: [Avidemux-svn-commit] r3692 - in
	branches/avidemux_2.5_branch_gruntster: . cmake cmake_compile_check
Message-ID: <200711151632.lAFGWK52006527@sheep.berlios.de>

Author: gruntster
Date: 2007-11-15 17:31:55 +0100 (Thu, 15 Nov 2007)
New Revision: 3692

Added:
   branches/avidemux_2.5_branch_gruntster/cmake_compile_check/CheckFunctionExists.c
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
Log:
[CMake] fixes for Linux and Mac

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-15 16:31:55 UTC (rev 3692)
@@ -3,7 +3,7 @@
 MESSAGE("#####################################")
 MESSAGE("")
 
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
 SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
 
 PROJECT(Avidemux)
@@ -42,20 +42,17 @@
 
 IF (ADM_OS_WINDOWS)
 	SET(CYG_MANGLING 1)
-	SET(ADM_WIN32 1)		# needs to be removed one day...
+	SET(ADM_WIN32 1)	# needs to be removed one day...
 	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
 ENDIF (ADM_OS_WINDOWS)
 
 IF (ADM_OS_DARWIN)
-	SET(CMAKE_INCLUDE_PATH "/opt/local/include ${CMAKE_INCLUDE_PATH}")
-	SET(CMAKE_LIBRARY_PATH "/opt/local/lib ${CMAKE_LIBRARY_PATH}")
-
 	SET(CYG_MANGLING 1)
 	SET(ADM_BSD_FAMILY 1)
 ENDIF (ADM_OS_DARWIN)
 
 IF (ADM_OS_LINUX)
-	SET(USE_JOG 1)			# jog shuttle is only available on Linux due to its interface
+	SET(USE_JOG 1)		# jog shuttle is only available on Linux due to its interface
 ENDIF (ADM_OS_LINUX)
 
 ########################################

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
@@ -153,10 +153,10 @@
 	FIND_HEADER_AND_LIB(FAAD faad.h faad)
 
 	IF (FAAD_FOUND)
-		CHECK_LIBRARY_EXISTS(faad faacDecInit FAAD_LIBRARY_DIR FAACDEC_FUNCTION_FOUND)
+		ADM_CHECK_FUNCTION_EXISTS(faacDecInit "${FAAD_LIBRARY_DIR}" FAACDEC_FUNCTION_FOUND)
 
 		IF (NOT FAACDEC_FUNCTION_FOUND)
-			CHECK_LIBRARY_EXISTS(faad NeAACDecInit FAAD_LIBRARY_DIR NEAACDEC_FUNCTION_FOUND)
+			ADM_CHECK_FUNCTION_EXISTS(NeAACDecInit "${FAAD_LIBRARY_DIR}" NEAACDEC_FUNCTION_FOUND)
 
 			IF (NOT NEAACDEC_FUNCTION_FOUND)
 				SET(FAAD_FOUND 0)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
@@ -1,7 +1,7 @@
 ########################################
 # ALSA
 ########################################
-IF (ADM_OS_LINIX)
+IF (ADM_OS_LINUX)
 	OPTION(ALSA "" ON)
 
 	MESSAGE(STATUS "Checking for ALSA")
@@ -13,7 +13,7 @@
 		IF (ALSA_FOUND)
 			ALSA_VERSION_STRING(alsaVersion)
 
-			MESSAGE("  version: ${alsaVersion}")
+			MESSAGE(STATUS "  version: ${alsaVersion}")
 			PRINT_LIBRARY_INFO("ALSA" ALSA_FOUND "${_ALSA_INCLUDE_DIR}" "${ASOUND_LIBRARY}")
 
 			SET(ALSA_SUPPORT 1)
@@ -25,7 +25,7 @@
 	MESSAGE("")
 ELSE (ADM_OS_LINUX)
 	SET(ALSA_CAPABLE FALSE)
-ENDIF (ADM_OS_LINIX)
+ENDIF (ADM_OS_LINUX)
 
 ########################################
 # aRts

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
@@ -6,7 +6,6 @@
 	MESSAGE(STATUS "****************")
 	
 	FIND_PACKAGE(X11)
-	
 	PRINT_LIBRARY_INFO("X11" X11_FOUND "${X11_INCLUDE_DIR}" "${X11_LIBRARIES}")
 	
 	IF (NOT X11_FOUND)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-15 16:31:55 UTC (rev 3692)
@@ -1,5 +1,3 @@
-INCLUDE(CheckLibraryExists)		# required for FIND_HEADER_AND_LIB macro
-
 MACRO(PRINT_LIBRARY_INFO libraryName libraryDetected compilerFlags linkerFlags)
 	IF (${libraryDetected})
 		MESSAGE(STATUS "Found ${libraryName}")
@@ -22,7 +20,7 @@
 
 # ARGV2 = library to check
 # ARGV3 = function to check
-# ARVG4 = CMAKE_REQUIRED_FLAGS
+# ARVG4 = extra required libs
 MACRO(FIND_HEADER_AND_LIB prefix headerFile)
 	IF (NOT DEFINED ${prefix}_FOUND)
 		SET(${prefix}_FOUND 0 CACHE INTERNAL "")
@@ -48,13 +46,8 @@
 				MESSAGE(STATUS "Found ${ARGV2} library")
 				
 				IF (NOT ${ARGV3} STREQUAL "")
-					SET(CMAKE_REQUIRED_FLAGS_BACKUP "${CMAKE_REQUIRED_FLAGS}")
-					SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS} ${ARGV4}")
+					ADM_CHECK_FUNCTION_EXISTS(${ARGV3} "${${prefix}_LIBRARY_DIR}" ${prefix}_FUNCTION_FOUND "${ARGV4}")
 
-					CHECK_LIBRARY_EXISTS(${ARGV2} ${ARGV3} ${prefix}_LIBRARY_DIR ${prefix}_FUNCTION_FOUND)
-
-					SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS_BACKUP}")
-
 					IF (${prefix}_FUNCTION_FOUND)
 						SET(${prefix}_FOUND 1 CACHE INTERNAL "")
 					ENDIF (${prefix}_FUNCTION_FOUND)
@@ -78,13 +71,29 @@
 		TRY_COMPILE(${_varToSet}
 			  ${CMAKE_BINARY_DIR}
 			  ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
-			  CMAKE_FLAGS -DINCLUDE_DIRECTORIES=${_include} -DCOMPILE_DEFINITIONS=${_def} -DLINK_LIBRARIES=${_lib}
-			  COMPILE_DEFINITIONS "${_cflags}"
+			  CMAKE_FLAGS "-DINCLUDE_DIRECTORIES:STRING=${_include}" "-DLINK_LIBRARIES:STRING=${_lib}"
+			  COMPILE_DEFINITIONS ${_def}
 			  OUTPUT_VARIABLE ${_output})
 	ENDIF (NOT DEFINED ${_varToSet}_COMPILED)
 ENDMACRO (ADM_COMPILE)
 
 
+#ARGV3 = extra libraries
+#ARGV4 = extra compile flags
+MACRO (ADM_CHECK_FUNCTION_EXISTS _function _lib _varToSet)
+	SET(CHECK_FUNCTION_DEFINE "-DCHECK_FUNCTION_EXISTS=${_function}" ${ARGV4})
+	SET(CHECK_FUNCTION_LIB ${_lib} ${ARGV3})
+	
+	ADM_COMPILE(CheckFunctionExists.c "${CHECK_FUNCTION_DEFINE}" "" "${CHECK_FUNCTION_LIB}" ${_varToSet} OUTPUT)
+
+	IF (${_varToSet})
+		MESSAGE(STATUS "Found ${_function} in ${_lib}")
+	ELSE (${_varToSet})
+		MESSAGE(STATUS "Could not find ${_function} in ${_lib}")
+	ENDIF (${_varToSet})	
+ENDMACRO (ADM_CHECK_FUNCTION_EXISTS)
+
+
 MACRO (CHECK_CFLAGS_REQUIRED _file _cflags _include _lib _varToSet)
 	IF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
 		SET(${_varToSet}_CFLAGS_CHECKED 1 CACHE INTERNAL "")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-15 16:31:55 UTC (rev 3692)
@@ -13,7 +13,7 @@
 	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
 		SET(ADM_CPU_X86 1)
 	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
-ELSEIF (APPLE)
+ELSEIF (APPLE AND UNIX)
 	SET(ADM_OS_DARWIN 1)
 	
 	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")

Added: branches/avidemux_2.5_branch_gruntster/cmake_compile_check/CheckFunctionExists.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake_compile_check/CheckFunctionExists.c	2007-11-14 23:45:47 UTC (rev 3691)
+++ branches/avidemux_2.5_branch_gruntster/cmake_compile_check/CheckFunctionExists.c	2007-11-15 16:31:55 UTC (rev 3692)
@@ -0,0 +1,23 @@
+#ifdef CHECK_FUNCTION_EXISTS
+
+char CHECK_FUNCTION_EXISTS();
+#ifdef __CLASSIC_C__
+int main(){
+  int ac;
+  char*av[];
+#else
+int main(int ac, char*av[]){
+#endif
+  CHECK_FUNCTION_EXISTS();
+  if(ac > 1000)
+    {
+    return *av[0];
+    }
+  return 0;
+}
+
+#else  /* CHECK_FUNCTION_EXISTS */
+
+#  error "CHECK_FUNCTION_EXISTS has to specify the function"
+
+#endif /* CHECK_FUNCTION_EXISTS */



From gruntster at mail.berlios.de  Sat Nov 17 01:05:01 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 17 Nov 2007 01:05:01 +0100
Subject: [Avidemux-svn-commit] r3693 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux cmake
Message-ID: <200711170005.lAH051d8011848@sheep.berlios.de>

Author: gruntster
Date: 2007-11-17 01:04:01 +0100 (Sat, 17 Nov 2007)
New Revision: 3693

Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
Log:
[CMake] slight scrubbing

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-17 00:04:01 UTC (rev 3693)
@@ -43,7 +43,6 @@
 IF (ADM_OS_WINDOWS)
 	SET(CYG_MANGLING 1)
 	SET(ADM_WIN32 1)	# needs to be removed one day...
-	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
 ENDIF (ADM_OS_WINDOWS)
 
 IF (ADM_OS_DARWIN)
@@ -91,6 +90,12 @@
 # LibMpeg2Dec
 SET(ACCEL_DETECT 1)
 
+IF (NOT CMAKE_BUILD_TYPE)
+	SET(CMAKE_BUILD_TYPE "Release")
+ELSEIF (CMAKE_BUILD_TYPE STREQUAL "Debug")
+	SET(ADM_DEBUG 1)
+ENDIF (NOT CMAKE_BUILD_TYPE)
+
 ########################################
 # Subversion
 ########################################
@@ -127,6 +132,8 @@
 SET(ADM_UI_GTK 1)
 SET(ADM_UI_QT4 1)
 
+SET(MSG_DISABLE_OPTION "Disabled per request")
+
 INCLUDE(admCheckRequiredLibs)
 INCLUDE(admCheckUserInterfaceLibs)
 INCLUDE(admCheckVideoCodecLibs)
@@ -154,25 +161,6 @@
 MESSAGE("")
 
 ########################################
-# Compiler Flags
-########################################
-IF (NOT CMAKE_BUILD_TYPE)
-	SET(CMAKE_BUILD_TYPE "Release")
-ENDIF (NOT CMAKE_BUILD_TYPE)
-
-IF (CMAKE_BUILD_TYPE STREQUAL "Debug")
-	SET(ADM_DEBUG 1)
-	ADD_DEFINITIONS(-DADM_DEBUG)
-ENDIF(CMAKE_BUILD_TYPE STREQUAL "Debug")
-
-add_definitions(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
-add_definitions(-DHAVE_CONFIG_H)
-
-INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec)
-
-########################################
 # Print Summary
 ########################################
 IF (VERBOSE)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-17 00:04:01 UTC (rev 3693)
@@ -1,71 +1,84 @@
-##########################################################
-#
-#  Main CMake makefile for avidemux2
-#  It is not for the faint of heart and pretty ugly
-#
-##########################################################
-SET(adm_EXE_SRCS ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
-
-include_directories(ADM_userInterfaces/ADM_commonUI ADM_outputs)
-add_definitions(${GLIB_CFLAGS})
-
-########################################################
+########################################
 # Macros
-########################################################
+########################################
 MACRO (add_libs_all_targets _libName)
-	TARGET_LINK_LIBRARIES(avidemux2_cli ${_libName})
+	TARGET_LINK_LIBRARIES(avidemux2_cli ${ARGV})
   
-	if(GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${_libName})
-	endif(GTK_FOUND)
+	IF (GTK_FOUND)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ARGV})
+	ENDIF (GTK_FOUND)
 	
-	if(QT4_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${_libName})
-	endif(QT4_FOUND)
-ENDMACRO (add_libs_all_targets _libName)
+	IF (QT4_FOUND)
+		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ARGV})
+	ENDIF (QT4_FOUND)
+ENDMACRO (add_libs_all_targets)
 
-MACRO (add_ldflags_all_targets _libName)
-	add_link_flags(avidemux2_cli ${_libName})
+MACRO (add_ldflags_all_targets _ldflags)
+	add_target_link_flags(avidemux2_cli ${_ldflags})
 
-	if(GTK_FOUND)
-		add_link_flags(avidemux2_gtk ${_libName})
-	endif(GTK_FOUND)
+	IF (GTK_FOUND)
+		add_target_link_flags(avidemux2_gtk ${_ldflags})
+	ENDIF (GTK_FOUND)
 
-	if(QT4_FOUND)
-		add_link_flags(avidemux2_qt4 ${_libName})
-	endif(QT4_FOUND)
-ENDMACRO (add_ldflags_all_targets _libName)
+	IF (QT4_FOUND)
+		add_target_link_flags(avidemux2_qt4 ${_ldflags})
+	ENDIF (QT4_FOUND)
+ENDMACRO (add_ldflags_all_targets)
 
-########################################################
+########################################
+# Definitions and Includes
+########################################
+ADD_DEFINITIONS(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
+ADD_DEFINITIONS(-DHAVE_CONFIG_H)
+
+IF (ADM_DEBUG)
+	ADD_DEFINITIONS(-DADM_DEBUG)
+ENDIF (ADM_DEBUG)
+
+INCLUDE_DIRECTORIES(${CMAKE_BINARY_DIR}
+					${CMAKE_SOURCE_DIR}/avidemux
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_userInterfaces/ADM_commonUI
+					${CMAKE_SOURCE_DIR}/avidemux/ADM_outputs)
+
+########################################
 # Our exectuables
-########################################################
-ADD_EXECUTABLE(avidemux2_cli ${adm_EXE_SRCS})
+########################################
+SET(ADM_EXE_SRCS ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
+ADD_DEFINITIONS(${GLIB_CFLAGS})
 
-if(GTK_FOUND)
-	ADD_EXECUTABLE(avidemux2_gtk ${adm_EXE_SRCS})
-endif(GTK_FOUND)
+ADD_EXECUTABLE(avidemux2_cli ${ADM_EXE_SRCS})
 
-if(QT4_FOUND)
-	ADD_EXECUTABLE(avidemux2_qt4 ${adm_EXE_SRCS})
-endif(QT4_FOUND)
+IF (GTK_FOUND)
+	ADD_EXECUTABLE(avidemux2_gtk ${ADM_EXE_SRCS})
+ENDIF (GTK_FOUND)
 
-########################################################
-# Normal subdirs, compile and link what is inside....
-########################################################
+IF (QT4_FOUND)
+	ADD_EXECUTABLE(avidemux2_qt4 ${ADM_EXE_SRCS})
+ENDIF (QT4_FOUND)
+
+SDLify(main.cpp)
+add_source_compile_flags(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
+
+########################################
+# Compile and link general subdirs
+########################################
 SET(ADM_SUBDIR 
-ADM_filter
-ADM_audiofilter 
-ADM_editor
-ADM_audiocodec 
-ADM_audio
-ADM_script 
-ADM_videoFilter
-ADM_filter
-ADM_video 
-ADM_audiodevice
-ADM_ocr  
-ADM_colorspace 
-)
+	ADM_filter
+	ADM_audiofilter
+	ADM_editor
+	ADM_audiocodec
+	ADM_audio
+	ADM_script
+	ADM_videoFilter
+	ADM_filter
+	ADM_video
+	ADM_audiodevice
+	ADM_ocr
+	ADM_colorspace)
 
 FOREACH(_current ${ADM_SUBDIR})
 	ADD_SUBDIRECTORY(${_current})
@@ -73,104 +86,97 @@
 ENDFOREACH(_current ${ADM_SUBDIR})
 
 ###########################################
-# Build Regular Subdirs
-###########################################
-ADD_SUBDIRECTORY(ADM_osSupport)
-ADD_SUBDIRECTORY(ADM_encoder)
-ADD_SUBDIRECTORY(ADM_toolkit)
-ADD_SUBDIRECTORY(ADM_codecs)
-ADD_SUBDIRECTORY(ADM_requant)
-ADD_SUBDIRECTORY(ADM_infoExtractor)
-
-###########################################
 # Construct ADM_outputs
 ###########################################
 ADD_SUBDIRECTORY(ADM_outputs)
 
-SET(ADM_outputs
-oplug_avi
-oplug_mp4
-oplug_mpeg
-oplug_mpegFF
-oplug_ogm
-oplug_flv
-oplug_dummy
-)
+SET(ADM_OUTPUTS
+	oplug_avi
+	oplug_mp4
+	oplug_mpeg
+	oplug_mpegFF
+	oplug_ogm
+	oplug_flv
+	oplug_dummy)
 
-FOREACH(_current ${ADM_outputs})
+FOREACH(_current ${ADM_OUTPUTS})
 	add_libs_all_targets(${_current})
-ENDFOREACH(_current ${ADM_outputs})
+ENDFOREACH(_current ${ADM_OUTPUTS})
 
 ###########################################
 # Construct ADM_inputs
 ###########################################
 ADD_SUBDIRECTORY(ADM_inputs)
 
-SET(ADM_inputs
-ADM_asf
-ADM_avsproxy
-ADM_h263
-ADM_inpics
-ADM_matroska
-ADM_mp4
-ADM_mpegdemuxer
-ADM_nuv
-ADM_ogm
-ADM_openDML
-ADM_flv
-ADM_amv
-)
+SET(ADM_INPUTS
+	ADM_asf
+	ADM_avsproxy
+	ADM_h263
+	ADM_inpics
+	ADM_matroska
+	ADM_mp4
+	ADM_mpegdemuxer
+	ADM_nuv
+	ADM_ogm
+	ADM_openDML
+	ADM_flv
+	ADM_amv)
 
-FOREACH(_current ${ADM_inputs})
+FOREACH(_current ${ADM_INPUTS})
 	add_libs_all_targets(${_current})
-ENDFOREACH(_current ${ADM_inputs})
+ENDFOREACH(_current ${ADM_INPUTS})
 
 #########################################
 # Tails
 #########################################
-add_libs_all_targets(ADM_toolkit)
-add_libs_all_targets(ADM_osSupport)
-add_libs_all_targets(ADM_encoder)
-add_libs_all_targets(ADM_codecs)
-add_libs_all_targets(ADM_requant)
-add_libs_all_targets(ADM_infoExtractor)
+SET(ADM_TAILS
+	ADM_osSupport
+	ADM_encoder
+	ADM_toolkit
+	ADM_codecs
+	ADM_requant
+	ADM_infoExtractor)
 
+FOREACH(_current ${ADM_TAILS})
+	ADD_SUBDIRECTORY(${_current})
+	add_libs_all_targets(${_current})
+ENDFOREACH(_current ${ADM_TAILS})
+
 ###########################################
 # Construct ADM_libraries
 ###########################################
 ADD_SUBDIRECTORY(ADM_libraries)
 
 SET(ADM_LIBRARIES
-ADM_lavformat
-ADM_lavcodec
-ADM_lavutil
-ADM_liba52
-ADM_libMad
-ADM_mplex
-ADM_libMpeg2Dec
-ADM_libmpeg2enc
-ADM_libswscale
-ADM_libtwolame
-ADM_libwrapper
-ADM_lvemux
-ADM_smjs
-ADM_utilities
-ADM_xvidratectl
-ADM_libpostproc
-ADM_colorspace
-)
+	ADM_lavformat
+	ADM_lavcodec
+	ADM_lavutil
+	ADM_liba52
+	ADM_libMad
+	ADM_mplex
+	ADM_libMpeg2Dec
+	ADM_libmpeg2enc
+	ADM_libswscale
+	ADM_libtwolame
+	ADM_libwrapper
+	ADM_lvemux
+	ADM_smjs
+	ADM_utilities
+	ADM_xvidratectl
+	ADM_libpostproc
+	ADM_colorspace)
 
-if (USE_FREETYPE)
+IF (USE_FREETYPE)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libass)
-endif (USE_FREETYPE)
+ENDIF (USE_FREETYPE)
 
-if (ADM_DEBUG AND FIND_LEAKS)
+IF (ADM_DEBUG AND FIND_LEAKS)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
-endif (ADM_DEBUG AND FIND_LEAKS)
+ENDIF (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_DARWIN AND USE_SDL)
+IF (ADM_OS_DARWIN AND USE_SDL)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libsdl)
-endif (ADM_OS_DARWIN AND USE_SDL)
+ENDIF (ADM_OS_DARWIN AND USE_SDL)
 
 FOREACH(_current ${ADM_LIBRARIES})
 	add_libs_all_targets(${_current})
@@ -189,7 +195,7 @@
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFiltersNone)
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogGuiNone)
 
-if(GTK_FOUND)
+IF (GTK_FOUND)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_UI_GTK)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr)
@@ -200,9 +206,9 @@
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_gui2Gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_toolkitGtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI)
-endif(GTK_FOUND)
+ENDIF (GTK_FOUND)
 
-if(QT4_FOUND)
+IF (QT4_FOUND)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_UI_QT4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_ocr)
@@ -212,200 +218,180 @@
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_guiQt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_filtersQt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI)
-endif(QT4_FOUND)
+ENDIF (QT4_FOUND)
 
 add_libs_all_targets(ADM_utilities)
 
 ###########################################
-# Add external libs
+# External libs
 ###########################################
-#iconv
+# libiconv
 add_libs_all_targets("${LIBICONV_LIBRARY_DIR}")
 
-#gettext
-if (GETTEXT_FOUND)
+# gettext
+IF (GETTEXT_FOUND)
 	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
 	TARGET_LINK_LIBRARIES(avidemux2_cli "${GETTEXT_LIBRARY_DIR}")
 
-	if(GTK_FOUND)
+	IF (GTK_FOUND)
 		TARGET_LINK_LIBRARIES(avidemux2_gtk "${GETTEXT_LIBRARY_DIR}")
-	endif(GTK_FOUND)
-endif (GETTEXT_FOUND)
+	ENDIF (GTK_FOUND)
+ENDIF (GETTEXT_FOUND)
 
-#freetype
-if(USE_FREETYPE)
+# Freetype2
+IF (USE_FREETYPE)
 	add_libs_all_targets("${FREETYPE2_LDFLAGS}")
-endif(USE_FREETYPE)
+ENDIF (USE_FREETYPE)
 
-#fontconfig
-if(USE_FONTCONFIG)
+# FontConfig
+IF (USE_FONTCONFIG)
 	add_libs_all_targets("${FONTCONFIG_LIBRARY_DIR}")
-endif(USE_FONTCONFIG)
+ENDIF (USE_FONTCONFIG)
 
-# png
-if(USE_PNG)
+# PNG
+IF (USE_PNG)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${PNG_LIBRARIES})
 	
-	if(GTK_FOUND)
+	IF (GTK_FOUND)
 		TARGET_LINK_LIBRARIES(avidemux2_gtk ${PNG_LIBRARIES})
-	endif(GTK_FOUND)
+	ENDIF (GTK_FOUND)
 	
-	if (QT4_FOUND)
-		if (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
+	IF (QT4_FOUND)
+		IF (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
 			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
-		elseif (NOT ADM_OS_DARWIN)
+		ELSEIF (NOT ADM_OS_DARWIN)
 			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
-		endif (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
-	endif (QT4_FOUND)
-endif(USE_PNG)
+		ENDIF (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
+	ENDIF (QT4_FOUND)
+ENDIF (USE_PNG)
 
-# Xml2
+# Libxml2
 add_libs_all_targets("${LIBXML2_LIBRARIES}")
 
-#XVideo 
-if(USE_XV)
+# XVideo 
+IF (USE_XV)
 	add_libs_all_targets("${X11_LIBRARIES}")
 	add_libs_all_targets("${XVIDEO_LIBRARY_DIR}")
-endif(USE_XV)
+ENDIF (USE_XV)
 
 # SDL
-if(USE_SDL)
+IF (USE_SDL)
 	add_libs_all_targets("${SDL_LIBRARY}")
-endif(USE_SDL)
+ENDIF (USE_SDL)
 
-# ARTS
-if(USE_ARTS)
+# aRts
+IF (USE_ARTS)
 	add_libs_all_targets("${ARTS_LDFLAGS}")
-endif(USE_ARTS)
+ENDIF (USE_ARTS)
 
-#alsa
-if(ALSA_FOUND)
+# ALSA
+IF (ALSA_FOUND)
 	add_libs_all_targets("${ASOUND_LIBRARY}")
-endif(ALSA_FOUND)
+ENDIF (ALSA_FOUND)
 
 # ESD
-if(USE_ESD)
+IF (USE_ESD)
 	add_libs_all_targets("${ESD_LIBRARY_DIR}")
-endif(USE_ESD)
+ENDIF (USE_ESD)
 
 # JACK
-if(USE_JACK)
+IF (USE_JACK)
 	add_libs_all_targets("${JACK_LIBRARY_DIR}")
-endif(USE_JACK)
+ENDIF (USE_JACK)
 
-# libAMRNB
-if(USE_AMR_NB AND NOT USE_LATE_BINDING)
+# amrnb
+IF (USE_AMR_NB AND NOT USE_LATE_BINDING)
 	add_libs_all_targets("${AMRNB_LIBRARY_DIR}")
-endif(USE_AMR_NB AND NOT USE_LATE_BINDING)
+ENDIF (USE_AMR_NB AND NOT USE_LATE_BINDING)
 
-#libdts
-if(USE_LIBDCA AND NOT USE_LATE_BINDING)
+# libdca
+IF (USE_LIBDCA AND NOT USE_LATE_BINDING)
 	add_libs_all_targets("${LIBDCA_LIBRARY_DIR}")
-endif(USE_LIBDCA AND NOT USE_LATE_BINDING)
+ENDIF (USE_LIBDCA AND NOT USE_LATE_BINDING)
 
 # Lame
-if(HAVE_LIBMP3LAME)
+IF (HAVE_LIBMP3LAME)
 	add_libs_all_targets("${LAME_LIBRARY_DIR}")
-endif(HAVE_LIBMP3LAME)
+ENDIF (HAVE_LIBMP3LAME)
 
 # Vorbis
-if(USE_VORBIS)
+IF (USE_VORBIS)
 	add_libs_all_targets("${VORBIS_LIBRARY_DIR}")
 	add_libs_all_targets("${VORBISENC_LIBRARY_DIR}")
-endif(USE_VORBIS)
+ENDIF (USE_VORBIS)
 
-#faac
-if(USE_FAAC)
+# FAAC
+IF (USE_FAAC)
 	add_libs_all_targets("${FAAC_LIBRARY_DIR}")
-endif(USE_FAAC)
+ENDIF (USE_FAAC)
 
-#aften
-if(USE_AFTEN)
+# Aften
+IF (USE_AFTEN)
 	add_libs_all_targets("${AFTEN_LIBRARY_DIR}")
-endif(USE_AFTEN)
+ENDIF (USE_AFTEN)
 
-#faad
-if(USE_FAAD)
+# FAAD
+IF (USE_FAAD)
 	add_libs_all_targets("${FAAD_LIBRARY_DIR}")
-endif(USE_FAAD)
+ENDIF (USE_FAAD)
 
-#libsamplerate
-if(USE_SRC)
+# Secret Rabbit Code
+IF (USE_SRC)
 	add_libs_all_targets("${SRC_LIBRARY_DIR}")
-endif(USE_SRC)
+ENDIF (USE_SRC)
 
-# xvid
-if(USE_XVID_4)
+# Xvid
+IF (USE_XVID_4)
 	add_libs_all_targets("${XVID_LIBRARY_DIR}")
-endif(USE_XVID_4)
+ENDIF (USE_XVID_4)
 
 # x264
-if(USE_X264)
+IF (USE_X264)
 	add_libs_all_targets("${X264_LIBRARY_DIR}")
-endif(USE_X264)
+ENDIF (USE_X264)
 
 ###########################################
-# Specific
+# UI Specific
 ###########################################
 TARGET_LINK_LIBRARIES(avidemux2_cli ${GLIB_LDFLAGS})
-LINK_DIRECTORIES(avidemux2_cli ${GLIB_LIB})
 
-if(GTK_FOUND)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${GLIB_LDFLAGS})
-	LINK_DIRECTORIES(avidemux2_gtk ${GLIB_LIB})
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${GTK_LDFLAGS})
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${GTHREAD_LDFLAGS}) # FIXME
-endif(GTK_FOUND)
+IF (GTK_FOUND)
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
+ENDIF (GTK_FOUND)
 
-if(QT4_FOUND)
+IF (QT4_FOUND)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${GLIB_LDFLAGS})
-	LINK_DIRECTORIES(avidemux2_qt4 ${GLIB_LIB})
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${QT_QTGUI_LIBRARY}) # FIXME
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${QT_QTCORE_LIBRARY}) # FIXME
-endif(QT4_FOUND)
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
+ENDIF (QT4_FOUND)
 
-########################
-# Win32
-########################
+###########################################
+# OS Specific
+###########################################
 IF (ADM_OS_WINDOWS)
-	add_libs_all_targets(ADM_osSupport)
-	add_libs_all_targets(pthreadGC2)
-	add_libs_all_targets(winmm)
-	add_libs_all_targets(wsock32)
-	add_libs_all_targets(imagehlp)
-
+	add_libs_all_targets(ADM_osSupport pthreadGC2 winmm wsock32 imagehlp)
 	add_ldflags_all_targets("-mms-bitfield -mno-cygwin -mwinmm -mwindows ${CMAKE_SOURCE_DIR}/avidemux/xpm/adm.o -Wl,--export-all-symbols")
 
-	if(CMAKE_BUILD_TYPE STREQUAL "Release")
+	IF (CMAKE_BUILD_TYPE STREQUAL "Release")
 		add_ldflags_all_targets("-Wl,-s")
-	endif(CMAKE_BUILD_TYPE STREQUAL "Release")
+	ENDIF (CMAKE_BUILD_TYPE STREQUAL "Release")
 ENDIF (ADM_OS_WINDOWS)
 
-########################
-# MacOsX
-########################
-if (ADM_OS_DARWIN)
+IF (ADM_OS_DARWIN)
 	add_libs_all_targets("-framework CoreServices -framework CoreAudio -framework AudioUnit")
-endif (ADM_OS_DARWIN)
+ENDIF (ADM_OS_DARWIN)
 
-########################
-# all
-########################
-SDLify(main.cpp)
-add_source_compile_flags(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
-
-###############
-# INSTALL
-###############
+###########################################
+# Install
+###########################################
 SET(ADM_EXES avidemux2_cli)
 
-if(GTK_FOUND)
+IF (GTK_FOUND)
 	SET(ADM_EXES ${ADM_EXES} avidemux2_gtk)
-endif(GTK_FOUND)
+ENDIF (GTK_FOUND)
 
-if(QT4_FOUND)
+IF (QT4_FOUND)
 	SET(ADM_EXES ${ADM_EXES} avidemux2_qt4)
-endif(QT4_FOUND)
+ENDIF (QT4_FOUND)
 
 INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION bin LIBRARY DESTINATION lib)
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -33,7 +33,7 @@
 		ENDIF (AFTEN_TEST_RUN_RESULT EQUAL 8)
 	ENDIF (AFTEN_FOUND)
 ELSE (AFTEN)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (AFTEN)
 
 MESSAGE("")
@@ -60,7 +60,7 @@
 		SET(CONFIG_AMR_NB 1)
 	ENDIF (AMRNB_FOUND)
 ELSE (AMRNB)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (AMRNB)
 
 MESSAGE("")
@@ -85,7 +85,7 @@
 		SET(HAVE_LIBMP3LAME 1)
 	ENDIF (LAME_FOUND)
 ELSE (LAME)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (LAME)
 
 MESSAGE("")
@@ -115,7 +115,7 @@
 		SET(USE_LIBDCA 1)
 	ENDIF (LIBDCA_FOUND)
 ELSE (LIBDCA)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (LIBDCA)
 
 MESSAGE("")
@@ -136,7 +136,7 @@
 		SET(USE_FAAC 1)
 	ENDIF (FAAC_FOUND)
 ELSE (FAAC)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (FAAC)
 
 MESSAGE("")
@@ -176,7 +176,7 @@
 		ENDIF (FAAD_CFLAGS_REQUIRED)
 	ENDIF (FAAD_FOUND)
 ELSE (FAAD)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (FAAD)
 
 MESSAGE("")
@@ -201,7 +201,7 @@
 
 	PRINT_LIBRARY_INFO("Vorbis" VORBIS_FOUND "${VORBIS_INCLUDE_DIR}" "${VORBIS_LIBRARY_DIR} ${VORBISENC_LIBRARY_DIR}")
 ELSE (VORBIS)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (VORBIS)
 
 MESSAGE ("")
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -19,7 +19,7 @@
 			SET(ALSA_SUPPORT 1)
 		ENDIF (ALSA_FOUND)
 	ELSE (ALSA)
-		MESSAGE(STATUS "<disabled per request>")
+		MESSAGE("${MSG_DISABLE_OPTION}")
 	ENDIF (ALSA)
 
 	MESSAGE("")
@@ -44,7 +44,7 @@
 			SET(USE_ARTS 1)
 		ENDIF (ARTS_FOUND)
 	ELSE (ARTS)
-		MESSAGE(STATUS "<disabled per request>")
+		MESSAGE("${MSG_DISABLE_OPTION}")
 	ENDIF (ARTS)
 		
 	MESSAGE("")
@@ -69,7 +69,7 @@
 			SET(USE_ESD 1)
 		ENDIF (ESD_FOUND)
 	ELSE (ESD)
-		MESSAGE(STATUS "<disabled per request>")
+		MESSAGE("${MSG_DISABLE_OPTION}")
 	ENDIF (ESD)
 
 	MESSAGE("")
@@ -94,7 +94,7 @@
 			SET(USE_JACK 1)
 		ENDIF (JACK_FOUND)
 	ELSE (JACK)
-		MESSAGE(STATUS "<disabled per request>")
+		MESSAGE("${MSG_DISABLE_OPTION}")
 	ENDIF (JACK)
 	
 	MESSAGE("")
@@ -136,7 +136,7 @@
 			SET(OSS_SUPPORT 1)
 		ENDIF (OSS_FOUND)
 	ELSE (OSS)
-		MESSAGE(STATUS "<disabled per request>")
+		MESSAGE("${MSG_DISABLE_OPTION}")
 	ENDIF (OSS)
 	
 	MESSAGE("")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -1,16 +1,22 @@
 ########################################
 # FontConfig
 ########################################
+OPTION(FONTCONFIG "" ON)
+
 MESSAGE(STATUS "Checking for FontConfig")
 MESSAGE(STATUS "***********************")
 
-FIND_HEADER_AND_LIB(FONTCONFIG fontconfig/fontconfig.h fontconfig FcStrSetCreate)
-PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_INCLUDE_DIR}" "${FONTCONFIG_LIBRARY_DIR}")
+IF (FONTCONFIG)
+	FIND_HEADER_AND_LIB(FONTCONFIG fontconfig/fontconfig.h fontconfig FcStrSetCreate)
+	PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_INCLUDE_DIR}" "${FONTCONFIG_LIBRARY_DIR}")
 
-IF (FONTCONFIG_FOUND)
-	SET(HAVE_FONTCONFIG 1)
-	SET(USE_FONTCONFIG 1)
-ENDIF (FONTCONFIG_FOUND)
+	IF (FONTCONFIG_FOUND)
+		SET(HAVE_FONTCONFIG 1)
+		SET(USE_FONTCONFIG 1)
+	ENDIF (FONTCONFIG_FOUND)
+ELSE (FONTCONFIG)
+	MESSAGE("${MSG_DISABLE_OPTION}")
+ENDIF (FONTCONFIG)
 
 MESSAGE("")
 
@@ -30,7 +36,7 @@
 		SET(USE_FREETYPE 1)
 	ENDIF (FREETYPE2_FOUND)
 ELSE (FREETYPE2)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (FREETYPE2)
 
 MESSAGE("")
@@ -79,7 +85,7 @@
 		ENDIF (LIBINTL_NOT_REQUIRED)
 	ENDIF (GETTEXT_INCLUDE_DIR)
 ELSE (GETTEXT)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (GETTEXT)
 
 SET(ADM_LOCALE "${CMAKE_INSTALL_PREFIX}/share/locale")
@@ -106,7 +112,7 @@
 		SET(USE_SDL 1)
 	ENDIF (SDL_FOUND)
 ELSE (SDL)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (SDL)
 
 MESSAGE("")

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -47,7 +47,7 @@
 	ENDIF (NOT GTK_FOUND)
 ELSE (GTK)
 	SET(ADM_UI_GTK 0)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (GTK)
 
 MESSAGE("")
@@ -68,7 +68,7 @@
 	ENDIF(NOT GTHREAD_FOUND)
 ELSE (GTK)
 	SET(ADM_UI_GTK 0)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (GTK)
 
 MESSAGE("")
@@ -105,12 +105,12 @@
 			SET(CMAKE_CXX_FLAGS "-I${QTXM}/include ${CMAKE_CXX_FLAGS}")
 			LINK_DIRECTORIES(${QTXM}/bin)
 			LINK_DIRECTORIES(${QTXM}/lib)
-		ENDIF (XMINGW)		
+		ENDIF (XMINGW)
 	ELSE (QT4_FOUND)
 		SET(ADM_UI_QT4 0)
-	ENDIF (QT4_FOUND)	
+	ENDIF (QT4_FOUND)
 ELSE (QT4)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (QT4)
 
 MESSAGE("")
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -14,7 +14,7 @@
 		SET(USE_X264 1)
 	ENDIF (X264_FOUND)
 ELSE (X264)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (X264)
 
 MESSAGE("")
@@ -35,7 +35,7 @@
 		SET(USE_XVID_4 1)
 	ENDIF (XVID_FOUND)
 ELSE (XVID)
-	MESSAGE(STATUS "<disabled per request>")
+	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (XVID)
 
 MESSAGE("")
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-15 16:31:55 UTC (rev 3692)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-17 00:04:01 UTC (rev 3693)
@@ -44,7 +44,7 @@
 
 			IF (${prefix}_LIBRARY_DIR)
 				MESSAGE(STATUS "Found ${ARGV2} library")
-				
+
 				IF (NOT ${ARGV3} STREQUAL "")
 					ADM_CHECK_FUNCTION_EXISTS(${ARGV3} "${${prefix}_LIBRARY_DIR}" ${prefix}_FUNCTION_FOUND "${ARGV4}")
 
@@ -83,7 +83,7 @@
 MACRO (ADM_CHECK_FUNCTION_EXISTS _function _lib _varToSet)
 	SET(CHECK_FUNCTION_DEFINE "-DCHECK_FUNCTION_EXISTS=${_function}" ${ARGV4})
 	SET(CHECK_FUNCTION_LIB ${_lib} ${ARGV3})
-	
+
 	ADM_COMPILE(CheckFunctionExists.c "${CHECK_FUNCTION_DEFINE}" "" "${CHECK_FUNCTION_LIB}" ${_varToSet} OUTPUT)
 
 	IF (${_varToSet})
@@ -97,7 +97,7 @@
 MACRO (CHECK_CFLAGS_REQUIRED _file _cflags _include _lib _varToSet)
 	IF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
 		SET(${_varToSet}_CFLAGS_CHECKED 1 CACHE INTERNAL "")
-		
+
 		ADM_COMPILE(${_file} ${_cflags} ${_include} ${_lib} ${_varToSet}_COMPILE_WITH logwith)
 		ADM_COMPILE(${_file} "" ${_include} ${_lib} ${_varToSet}_COMPILE_WITHOUT logwithout)
 
@@ -123,21 +123,13 @@
 ENDMACRO (CHECK_CFLAGS_REQUIRED)
 
 MACRO (append_flags _flags _varToAppend)
-	if (_flags)
+	IF (_flags)
 		set(_flags "${_flags} ${_varToAppend}")
-	else (_flags)
+	ELSE (_flags)
 		set(_flags "${_varToAppend}")
-	endif (_flags)
+	ENDIF (_flags)
 ENDMACRO (append_flags)
 
-MACRO (add_link_flags _target _flg)
-	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
-
-	append_flags("${_flags}" "${_flg}")
-
-	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS "${_flags}")
-ENDMACRO (add_link_flags)
-
 MACRO (add_source_compile_flags _target _flg)
 	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
 
@@ -153,4 +145,12 @@
 
 	SET_TARGET_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")
 
-ENDMACRO (add_target_compile_flags)
\ No newline at end of file
+ENDMACRO (add_target_compile_flags)
+
+MACRO (add_target_link_flags _target _flg)
+	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
+
+	append_flags("${_flags}" "${_flg}")
+
+	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS "${_flags}")
+ENDMACRO (add_target_link_flags)
\ No newline at end of file



From mean at mail.berlios.de  Sun Nov 18 14:55:17 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 18 Nov 2007 14:55:17 +0100
Subject: [Avidemux-svn-commit] r3694 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv
Message-ID: <200711181355.lAIDtHjQ002607@sheep.berlios.de>

Author: mean
Date: 2007-11-18 14:55:17 +0100 (Sun, 18 Nov 2007)
New Revision: 3694

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
Log:
[FLV] If headers is lying, try to grab audio track

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2007-11-17 00:04:01 UTC (rev 3693)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp	2007-11-18 13:55:17 UTC (rev 3694)
@@ -154,7 +154,7 @@
   if(_isaudiopresent) 
     audioTrack=new flvTrak(50);
   else
-    videoTrack=NULL;
+    audioTrack=NULL;
   // Loop
   while(pos<fileSize-14)
   {
@@ -170,7 +170,11 @@
     {
       case FLV_TAG_TYPE_AUDIO:
           {
-            if(!_isaudiopresent) break;
+            if(!_isaudiopresent) 
+            {
+                audioTrack=new flvTrak(50);
+                _isaudiopresent=1; /* Damn  lying headers...*/
+            };
             uint8_t flags=read8();
             int of=1+4+3+3+1+4;
             remaining--;



From gruntster at mail.berlios.de  Mon Nov 19 17:53:28 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 19 Nov 2007 17:53:28 +0100
Subject: [Avidemux-svn-commit] r3695 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200711191653.lAJGrScL009666@sheep.berlios.de>

Author: gruntster
Date: 2007-11-19 17:53:21 +0100 (Mon, 19 Nov 2007)
New Revision: 3695

Removed:
   branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/CMakePrintSystemInformation.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindGTK.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/UsePkgConfig.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/UseQt4.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
Log:
[CMake] remove standard CMake modules

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-19 16:53:21 UTC (rev 3695)
@@ -309,7 +309,7 @@
 	add_libs_all_targets("${LIBDCA_LIBRARY_DIR}")
 ENDIF (USE_LIBDCA AND NOT USE_LATE_BINDING)
 
-# Lame
+# LAME
 IF (HAVE_LIBMP3LAME)
 	add_libs_all_targets("${LAME_LIBRARY_DIR}")
 ENDIF (HAVE_LIBMP3LAME)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -1,80 +0,0 @@
-
-# This module is used by the Makefile generator to determin the following variables:
-# CMAKE_SYSTEM_NAME - on unix this is uname -s, for windows it is Windows
-# CMAKE_SYSTEM_VERSION - on unix this is uname -r, for windows it is empty
-# CMAKE_SYSTEM - ${CMAKE_SYSTEM}-${CMAKE_SYSTEM_VERSION}, for windows: ${CMAKE_SYSTEM}
-#
-#  Expected uname -s output:
-#
-# AIX                           AIX  
-# BSD/OS                        BSD/OS  
-# FreeBSD                       FreeBSD  
-# HP-UX                         HP-UX  
-# IRIX                          IRIX  
-# Linux                         Linux  
-# NetBSD                        NetBSD  
-# OpenBSD                       OpenBSD  
-# OFS/1 (Digital Unix)          OSF1  
-# SCO OpenServer 5              SCO_SV  
-# SCO UnixWare 7                UnixWare  
-# SCO UnixWare (pre release 7)  UNIX_SV  
-# SCO XENIX                     Xenix  
-# Solaris                       SunOS  
-# SunOS                         SunOS  
-# Tru64                         Tru64  
-# Ultrix                        ULTRIX  
-# cygwin                        CYGWIN_NT-5.1
-# MacOSX                        Darwin
-  
-IF(UNIX)
-  FIND_PROGRAM(CMAKE_UNAME uname /bin /usr/bin /usr/local/bin )
-  IF(CMAKE_UNAME)
-    EXEC_PROGRAM(uname ARGS -s OUTPUT_VARIABLE CMAKE_SYSTEM_NAME)
-    EXEC_PROGRAM(uname ARGS -r OUTPUT_VARIABLE CMAKE_SYSTEM_VERSION)
-    EXEC_PROGRAM(uname ARGS -m OUTPUT_VARIABLE CMAKE_SYSTEM_PROCESSOR
-        RETURN_VALUE val)
-    IF("${val}" GREATER 0)
-      SET(CMAKE_SYSTEM_PROCESSOR "unknown")
-    ENDIF("${val}" GREATER 0)
-    SET(CMAKE_UNAME ${CMAKE_UNAME} CACHE INTERNAL "uname command")
-    # processor may have double quote in the name, and that needs to be removed
-    STRING(REGEX REPLACE "\"" "" CMAKE_SYSTEM_PROCESSOR "${CMAKE_SYSTEM_PROCESSOR}")
-    STRING(REGEX REPLACE "/" "_" CMAKE_SYSTEM_PROCESSOR "${CMAKE_SYSTEM_PROCESSOR}")
-  ENDIF(CMAKE_UNAME)
-ELSE(UNIX)
-  IF(WIN32)
-    SET (CMAKE_SYSTEM_NAME "Windows")
-    SET (CMAKE_SYSTEM_PROCESSOR "$ENV{PROCESSOR_ARCHITECTURE}")
-  ENDIF(WIN32)
-ENDIF(UNIX)
-
-IF(NOT CMAKE_SYSTEM_NAME)
-  SET(CMAKE_SYSTEM_NAME "UnknownOS")
-ENDIF(NOT CMAKE_SYSTEM_NAME)
-
-# fix for BSD/OS , remove the /
-IF(CMAKE_SYSTEM_NAME MATCHES BSD.OS)
-  SET(CMAKE_SYSTEM_NAME BSDOS)
-ENDIF(CMAKE_SYSTEM_NAME MATCHES BSD.OS)
-
-# fix for CYGWIN which has windows version in it 
-IF(CMAKE_SYSTEM_NAME MATCHES CYGWIN)
-  SET(CMAKE_SYSTEM_NAME CYGWIN)
-ENDIF(CMAKE_SYSTEM_NAME MATCHES CYGWIN)
-
-# set CMAKE_SYSTEM to the CMAKE_SYSTEM_NAME
-SET(CMAKE_SYSTEM  ${CMAKE_SYSTEM_NAME})
-# if there is a CMAKE_SYSTEM_VERSION then add a -${CMAKE_SYSTEM_VERSION}
-IF(CMAKE_SYSTEM_VERSION)
-  SET(CMAKE_SYSTEM ${CMAKE_SYSTEM}-${CMAKE_SYSTEM_VERSION})
-ENDIF(CMAKE_SYSTEM_VERSION)
-
-
-FILE(APPEND ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeOutput.log 
-  "The system is: ${CMAKE_SYSTEM_NAME} - ${CMAKE_SYSTEM_VERSION} - ${CMAKE_SYSTEM_PROCESSOR}\n")
-
-# configure variables set in this file for fast reload
-CONFIGURE_FILE(${CMAKE_ROOT}/Modules/CMakeSystem.cmake.in 
-               ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeSystem.cmake 
-               IMMEDIATE)
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/CMakePrintSystemInformation.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/CMakePrintSystemInformation.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/CMakePrintSystemInformation.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -1,33 +0,0 @@
-# - print system information
-# This file can be used for diagnostic purposes
-# just include it in a project to see various internal CMake
-# variables.
-
-MESSAGE("CMAKE_SYSTEM is ${CMAKE_SYSTEM} ${CMAKE_SYSTEM_NAME} ${CMAKE_SYSTEM_VERSION}")
-MESSAGE("CMAKE_SYSTEM file is ${CMAKE_SYSTEM_INFO_FILE}")
-MESSAGE("CMAKE_C_COMPILER is ${CMAKE_C_COMPILER}")
-MESSAGE("CMAKE_CXX_COMPILER is ${CMAKE_CXX_COMPILER}")
-
-
-MESSAGE("CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS is ${CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS}")
-MESSAGE("CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS is ${CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS}")
-MESSAGE("CMAKE_DL_LIBS is ${CMAKE_DL_LIBS}")
-MESSAGE("CMAKE_SHARED_LIBRARY_PREFIX is ${CMAKE_SHARED_LIBRARY_PREFIX}")
-MESSAGE("CMAKE_SHARED_LIBRARY_SUFFIX is ${CMAKE_SHARED_LIBRARY_SUFFIX}")
-MESSAGE("CMAKE_COMPILER_IS_GNUGCC = ${CMAKE_COMPILER_IS_GNUGCC}")
-MESSAGE("CMAKE_COMPILER_IS_GNUCXX = ${CMAKE_COMPILER_IS_GNUCXX}")
-
-MESSAGE("CMAKE_CXX_CREATE_SHARED_LIBRARY is ${CMAKE_CXX_CREATE_SHARED_LIBRARY}")
-MESSAGE("CMAKE_CXX_CREATE_SHARED_MODULE is ${CMAKE_CXX_CREATE_SHARED_MODULE}")
-MESSAGE("CMAKE_CXX_CREATE_STATIC_LIBRARY is ${CMAKE_CXX_CREATE_STATIC_LIBRARY}")
-MESSAGE("CMAKE_CXX_COMPILE_OBJECT is ${CMAKE_CXX_COMPILE_OBJECT}")
-MESSAGE("CMAKE_CXX_LINK_EXECUTABLE ${CMAKE_CXX_LINK_EXECUTABLE}")
-
-MESSAGE("CMAKE_C_CREATE_SHARED_LIBRARY is ${CMAKE_C_CREATE_SHARED_LIBRARY}")
-MESSAGE("CMAKE_C_CREATE_SHARED_MODULE is ${CMAKE_C_CREATE_SHARED_MODULE}")
-MESSAGE("CMAKE_C_CREATE_STATIC_LIBRARY is ${CMAKE_C_CREATE_STATIC_LIBRARY}")
-MESSAGE("CMAKE_C_COMPILE_OBJECT is ${CMAKE_C_COMPILE_OBJECT}")
-MESSAGE("CMAKE_C_LINK_EXECUTABLE ${CMAKE_C_LINK_EXECUTABLE}")
-
-MESSAGE("CMAKE_SYSTEM_AND_CXX_COMPILER_INFO_FILE ${CMAKE_SYSTEM_AND_CXX_COMPILER_INFO_FILE}")
-MESSAGE("CMAKE_SYSTEM_AND_C_COMPILER_INFO_FILE ${CMAKE_SYSTEM_AND_C_COMPILER_INFO_FILE}")

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindGTK.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindGTK.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindGTK.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -1,186 +0,0 @@
-# - try to find GTK (and glib) and GTKGLArea
-#  GTK_INCLUDE_DIR   - Directories to include to use GTK
-#  GTK_LIBRARIES     - Files to link against to use GTK
-#  GTK_FOUND         - GTK was found
-#  GTK_GL_FOUND      - GTK's GL features were found
-
-# don't even bother under WIN32
-IF(UNIX)
-
-  FIND_PATH( GTK_gtk_INCLUDE_PATH gtk/gtk.h
-    /usr/include
-    /usr/local/include
-    /usr/openwin/share/include
-    /usr/openwin/include
-    /usr/X11R6/include
-    /usr/include/X11
-    /usr/X11R6/include/gtk12
-    /usr/include/gtk-1.2
-    /usr/local/include/gtk-1.2
-    /opt/gnome/include
-  )
-
-  # Some Linux distributions (e.g. Red Hat) have glibconfig.h
-  # and glib.h in different directories, so we need to look
-  # for both.
-  #  - Atanas Georgiev <atanas at cs.columbia.edu>
-
-  FIND_PATH( GTK_glibconfig_INCLUDE_PATH glibconfig.h
-    /usr/include
-    /usr/local/include
-    /usr/openwin/share/include
-    /usr/local/include/glib12
-    /usr/lib/glib/include
-    /usr/local/lib/glib/include
-    /opt/gnome/include
-    /opt/gnome/lib/glib/include
-  )
-
-  FIND_PATH( GTK_glib_INCLUDE_PATH glib.h
-    /usr/include
-    /usr/local/include
-    /usr/openwin/share/include
-    /usr/include/gtk-1.2
-    /usr/local/include/glib12
-    /usr/lib/glib/include
-    /usr/include/glib-1.2
-    /usr/local/include/glib-1.2
-    /opt/gnome/include
-    /opt/gnome/include/glib-1.2
-  )
-
-  FIND_PATH( GTK_gtkgl_INCLUDE_PATH gtkgl/gtkglarea.h
-    /usr/include
-    /usr/local/include
-    /usr/openwin/share/include
-    /opt/gnome/include
-  )
-
-  FIND_LIBRARY( GTK_gtkgl_LIBRARY gtkgl
-    /usr/lib
-    /usr/local/lib
-    /usr/openwin/lib
-    /usr/X11R6/lib
-    /opt/gnome/lib
-  )
-
-  #
-  # The 12 suffix is thanks to the FreeBSD ports collection
-  #
-
-  FIND_LIBRARY( GTK_gtk_LIBRARY
-    NAMES  gtk gtk12
-    PATHS /usr/lib
-          /usr/local/lib
-          /usr/openwin/lib
-          /usr/X11R6/lib
-          /opt/gnome/lib
-  )
-
-  FIND_LIBRARY( GTK_gdk_LIBRARY
-    NAMES  gdk gdk12
-    PATHS  /usr/lib
-           /usr/local/lib
-           /usr/openwin/lib
-           /usr/X11R6/lib
-           /opt/gnome/lib
-  )
-
-  FIND_LIBRARY( GTK_gmodule_LIBRARY
-    NAMES  gmodule gmodule12
-    PATHS  /usr/lib
-           /usr/local/lib
-           /usr/openwin/lib
-           /usr/X11R6/lib
-           /opt/gnome/lib
-  )
-
-  FIND_LIBRARY( GTK_glib_LIBRARY
-    NAMES  glib glib12
-    PATHS  /usr/lib
-           /usr/local/lib
-           /usr/openwin/lib
-           /usr/X11R6/lib
-           /opt/gnome/lib
-  )
-
-  FIND_LIBRARY( GTK_Xi_LIBRARY 
-    NAMES Xi 
-    PATHS /usr/lib 
-    /usr/local/lib 
-    /usr/openwin/lib 
-    /usr/X11R6/lib 
-    /opt/gnome/lib 
-    ) 
-
-  FIND_LIBRARY( GTK_gthread_LIBRARY
-    NAMES  gthread gthread12
-    PATHS  /usr/lib
-           /usr/local/lib
-           /usr/openwin/lib
-           /usr/X11R6/lib
-           /opt/gnome/lib
-  )
-
-  IF(GTK_gtk_INCLUDE_PATH)
-  IF(GTK_glibconfig_INCLUDE_PATH)
-  IF(GTK_glib_INCLUDE_PATH)
-  IF(GTK_gtk_LIBRARY)
-  IF(GTK_glib_LIBRARY)
-
-    # Assume that if gtk and glib were found, the other
-    # supporting libraries have also been found.
-
-    SET( GTK_FOUND "YES" )
-    SET( GTK_INCLUDE_DIR  ${GTK_gtk_INCLUDE_PATH}
-                           ${GTK_glibconfig_INCLUDE_PATH}
-                           ${GTK_glib_INCLUDE_PATH} )
-    SET( GTK_LIBRARIES  ${GTK_gtk_LIBRARY}
-                        ${GTK_gdk_LIBRARY}
-                        ${GTK_glib_LIBRARY} )
-
-    IF(GTK_gmodule_LIBRARY)
-      SET(GTK_LIBRARIES ${GTK_LIBRARIES} ${GTK_gmodule_LIBRARY})
-    ENDIF(GTK_gmodule_LIBRARY)
-    IF(GTK_gthread_LIBRARY)
-      SET(GTK_LIBRARIES ${GTK_LIBRARIES} ${GTK_gthread_LIBRARY})
-    ENDIF(GTK_gthread_LIBRARY)
-    IF(GTK_Xi_LIBRARY)
-      SET(GTK_LIBRARIES ${GTK_LIBRARIES} ${GTK_Xi_LIBRARY})
-    ENDIF(GTK_Xi_LIBRARY)
-
-  IF(GTK_gtkgl_INCLUDE_PATH)
-  IF(GTK_gtkgl_LIBRARY)
-    SET( GTK_GL_FOUND "YES" )
-    SET( GTK_INCLUDE_DIR  ${GTK_INCLUDE_DIR}
-                           ${GTK_gtkgl_INCLUDE_PATH} )
-    SET( GTK_LIBRARIES  ${GTK_gtkgl_LIBRARY} ${GTK_LIBRARIES} )
-    MARK_AS_ADVANCED(
-      GTK_gtkgl_LIBRARY
-      GTK_gtkgl_INCLUDE_PATH
-      )
-  ENDIF(GTK_gtkgl_LIBRARY)
-  ENDIF(GTK_gtkgl_INCLUDE_PATH)
-
-  ENDIF(GTK_glib_LIBRARY)
-  ENDIF(GTK_gtk_LIBRARY)
-  ENDIF(GTK_glib_INCLUDE_PATH) 
-  ENDIF(GTK_glibconfig_INCLUDE_PATH)
-  ENDIF(GTK_gtk_INCLUDE_PATH)
-
-  MARK_AS_ADVANCED(
-    GTK_gdk_LIBRARY
-    GTK_glib_INCLUDE_PATH
-    GTK_glib_LIBRARY
-    GTK_glibconfig_INCLUDE_PATH
-    GTK_gmodule_LIBRARY
-    GTK_gthread_LIBRARY
-    GTK_Xi_LIBRARY
-    GTK_gtk_INCLUDE_PATH
-    GTK_gtk_LIBRARY
-    GTK_gtkgl_INCLUDE_PATH
-    GTK_gtkgl_LIBRARY
-  )
-
-ENDIF(UNIX)
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/UsePkgConfig.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/UsePkgConfig.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/UsePkgConfig.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -1,46 +0,0 @@
-# - pkg-config module for CMake
-#
-# Defines the following macros:
-#
-# PKGCONFIG(package includedir libdir linkflags cflags)
-#
-# Calling PKGCONFIG will fill the desired information into the 4 given arguments,
-# e.g. PKGCONFIG(libart-2.0 LIBART_INCLUDE_DIR LIBART_LINK_DIR LIBART_LINK_FLAGS LIBART_CFLAGS)
-# if pkg-config was NOT found or the specified software package doesn't exist, the
-# variable will be empty when the function returns, otherwise they will contain the respective information
-#
-
-
-
-FIND_PROGRAM(PKGCONFIG_EXECUTABLE NAMES pkg-config PATHS /usr/local/bin )
-
-MACRO(PKGCONFIG _package _include_DIR _link_DIR _link_FLAGS _cflags)
-# reset the variables at the beginning
-  SET(${_include_DIR})
-  SET(${_link_DIR})
-  SET(${_link_FLAGS})
-  SET(${_cflags})
-
-  # if pkg-config has been found
-  IF(PKGCONFIG_EXECUTABLE)
-
-    EXEC_PROGRAM(${PKGCONFIG_EXECUTABLE} ARGS ${_package} --exists RETURN_VALUE _return_VALUE OUTPUT_VARIABLE _pkgconfigDevNull )
-
-    # and if the package of interest also exists for pkg-config, then get the information
-    IF(NOT _return_VALUE)
-
-      EXEC_PROGRAM(${PKGCONFIG_EXECUTABLE} ARGS ${_package} --variable=includedir OUTPUT_VARIABLE ${_include_DIR} )
-
-      EXEC_PROGRAM(${PKGCONFIG_EXECUTABLE} ARGS ${_package} --variable=libdir OUTPUT_VARIABLE ${_link_DIR} )
-
-      EXEC_PROGRAM(${PKGCONFIG_EXECUTABLE} ARGS ${_package} --libs OUTPUT_VARIABLE ${_link_FLAGS} )
-
-      EXEC_PROGRAM(${PKGCONFIG_EXECUTABLE} ARGS ${_package} --cflags OUTPUT_VARIABLE ${_cflags} )
-
-    ENDIF(NOT _return_VALUE)
-
-  ENDIF(PKGCONFIG_EXECUTABLE)
-
-ENDMACRO(PKGCONFIG _include_DIR _link_DIR _link_FLAGS _cflags)
-
-MARK_AS_ADVANCED(PKGCONFIG_EXECUTABLE)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/UseQt4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/UseQt4.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/UseQt4.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -1,91 +0,0 @@
-# - Use Module for QT4
-# Sets up C and C++ to use Qt 4.  It is assumed that FindQt.cmake
-# has already been loaded.  See FindQt.cmake for information on
-# how to load Qt 4 into your CMake project.
-
-
-ADD_DEFINITIONS(${QT_DEFINITIONS})
-
-INCLUDE_DIRECTORIES(${QT_INCLUDE_DIR})
-
-SET(QT_LIBRARIES "")
-
-IF (QT_USE_QTMAIN)
-  IF (WIN32)
-    SET(QT_LIBRARIES ${QT_LIBRARIES} ${QT_QTMAIN_LIBRARY})
-  ENDIF (WIN32)
-ENDIF (QT_USE_QTMAIN)
-
-# Macro for setting up compile flags for Qt modules
-MACRO(QT_MODULE_SETUP module)
-  IF (QT_QT${module}_FOUND)
-    ADD_DEFINITIONS(-DQT_${module}_LIB)
-    INCLUDE_DIRECTORIES(${QT_QT${module}_INCLUDE_DIR})
-    SET(QT_LIBRARIES ${QT_LIBRARIES} ${QT_QT${module}_LIBRARY})
-    SET(QT_LIBRARIES ${QT_LIBRARIES} ${QT_${module}_LIB_DEPENDENCIES})
-  ELSE (QT_QT${module}_FOUND)
-    MESSAGE("Qt ${module} library not found.")
-  ENDIF (QT_QT${module}_FOUND)
-ENDMACRO(QT_MODULE_SETUP)
-
-
-# Qt modules  (in order of dependence)
-
-IF (QT_USE_QT3SUPPORT)
-  QT_MODULE_SETUP(3SUPPORT)
-    ADD_DEFINITIONS(-DQT3_SUPPORT)
-ENDIF (QT_USE_QT3SUPPORT)
-
-IF (QT_USE_QTOPENGL)
-  QT_MODULE_SETUP(OPENGL)
-ENDIF (QT_USE_QTOPENGL)
-
-IF (QT_USE_QTASSISTANT)
-  QT_MODULE_SETUP(ASSISTANT)
-ENDIF (QT_USE_QTASSISTANT)
-
-IF (QT_USE_QTDESIGNER)
-  QT_MODULE_SETUP(DESIGNER)
-ENDIF (QT_USE_QTDESIGNER)
-
-IF (QT_USE_QTMOTIF)
-  QT_MODULE_SETUP(MOTIF)
-ENDIF (QT_USE_QTMOTIF)
-
-IF (QT_USE_QTNSPLUGIN)
-  QT_MODULE_SETUP(NSPLUGIN)
-ENDIF (QT_USE_QTNSPLUGIN)
-
-IF (QT_USE_QTSVG)
-  QT_MODULE_SETUP(SVG)
-ENDIF (QT_USE_QTSVG)
-
-IF (QT_USE_QTUITOOLS)
-  QT_MODULE_SETUP(UITOOLS)
-ENDIF (QT_USE_QTUITOOLS)
-
-IF (NOT QT_DONT_USE_QTGUI)
-  QT_MODULE_SETUP(GUI)
-ENDIF (NOT QT_DONT_USE_QTGUI)
-
-IF (QT_USE_QTTEST)
-  QT_MODULE_SETUP(TEST)
-ENDIF (QT_USE_QTTEST)
-
-IF (QT_USE_QTXML)
-  QT_MODULE_SETUP(XML)
-ENDIF (QT_USE_QTXML)
-
-IF (QT_USE_QTSQL)
-  QT_MODULE_SETUP(SQL)
-ENDIF (QT_USE_QTSQL)
-
-IF (QT_USE_QTNETWORK)
-  QT_MODULE_SETUP(NETWORK)
-ENDIF (QT_USE_QTNETWORK)
-
-IF (NOT QT_DONT_USE_QTCORE)
-  QT_MODULE_SETUP(CORE)
-ENDIF (NOT QT_DONT_USE_QTCORE)
-
-

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-18 13:55:17 UTC (rev 3694)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-19 16:53:21 UTC (rev 3695)
@@ -4,18 +4,18 @@
 IF (ADM_OS_LINUX OR ADM_OS_DARWIN)
 	MESSAGE(STATUS "Checking for X11")
 	MESSAGE(STATUS "****************")
-	
+
 	FIND_PACKAGE(X11)
 	PRINT_LIBRARY_INFO("X11" X11_FOUND "${X11_INCLUDE_DIR}" "${X11_LIBRARIES}")
-	
+
 	IF (NOT X11_FOUND)
 		SET(ADM_UI_GTK 0)
-		
+
 		IF (ADM_OS_LINUX)
 			SET(ADM_UI_QT4 0)
 		ENDIF (ADM_OS_LINUX)
 	ENDIF (NOT X11_FOUND)
-	
+
 	MESSAGE("")
 ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)
 
@@ -26,8 +26,8 @@
 MESSAGE(STATUS "*****************")
 
 PKG_CHECK_MODULES(GLIB glib-2.0)
+PRINT_LIBRARY_INFO("GLib" GLIB_FOUND "${GLIB_CFLAGS}" "${GLIB_LDFLAGS}" FATAL_ERROR)
 
-PRINT_LIBRARY_INFO("GLib" GLIB_FOUND "${GLIB_CFLAGS}" "${GLIB_LDFLAGS}" FATAL_ERROR)
 MESSAGE("")
 
 ########################################
@@ -85,12 +85,12 @@
 	FIND_PACKAGE(Qt4)	
 	STRING(REGEX REPLACE "[\\]" "/" QT_INCLUDES "${QT_INCLUDES}")	# backslashes aren't taken care of properly on Windows
 	PRINT_LIBRARY_INFO("Qt4" QT4_FOUND "${QT_INCLUDES} ${QT_DEFINITIONS}" "${QT_QTCORE_LIBRARY} ${QT_QTGUI_LIBRARY}")
-	
+
 	MARK_AS_ADVANCED(LRELEASE_EXECUTABLE)
 	MARK_AS_ADVANCED(QT_MKSPECS_DIR)
 	MARK_AS_ADVANCED(QT_PLUGINS_DIR)
 	MARK_AS_ADVANCED(QT_QMAKE_EXECUTABLE)
-	
+
 	IF (QT4_FOUND)
 		IF (XMINGW)
 			SET(QTXM /rot2/qt_4.3)



From mean at mail.berlios.de  Tue Nov 20 19:58:05 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 20 Nov 2007 19:58:05 +0100
Subject: [Avidemux-svn-commit] r3696 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat
Message-ID: <200711201858.lAKIw5S8009344@sheep.berlios.de>

Author: mean
Date: 2007-11-20 19:58:04 +0100 (Tue, 20 Nov 2007)
New Revision: 3696

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
Log:
[MKV] Fix indexes & seeking 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-11-19 16:53:21 UTC (rev 3695)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-11-20 18:58:04 UTC (rev 3696)
@@ -647,7 +647,7 @@
         pkt.data= bitstream->data;
         pkt.size= bitstream->len;
 	// Look if it is a gop start or seq start
-        if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV)
+        if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV || _type==MUXER_MATROSKA)
         {
             if(bitstream->flags & AVI_KEY_FRAME) 
                         pkt.flags |= PKT_FLAG_KEY;



From gruntster at mail.berlios.de  Wed Nov 21 15:55:43 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 21 Nov 2007 15:55:43 +0100
Subject: [Avidemux-svn-commit] r3698 - in
	branches/avidemux_2.5_branch_gruntster:
	avidemux/ADM_audiodevice avidemux/ADM_filter
	avidemux/ADM_libraries/ADM_utilities avidemux/ADM_osSupport
	avidemux/ADM_userInterfaces/ADM_commonUI
	avidemux/ADM_videoFilter cmake
Message-ID: <200711211455.lALEthrt007328@sheep.berlios.de>

Author: gruntster
Date: 2007-11-21 15:55:28 +0100 (Wed, 21 Nov 2007)
New Revision: 3698

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/default.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
Log:
[CMake] fixes for Unix

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/CMakeLists.txt	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiodevice/CMakeLists.txt	2007-11-21 14:55:28 UTC (rev 3698)
@@ -7,5 +7,5 @@
 SDLify(ADM_deviceSDL.cpp)
 
 IF (USE_ARTS)
-  ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} "${ARTS_CFLAGS}")
+	ADD_CFLAGS_ALL_TARGETS(ADM_audiodevice ${ARTS_CFLAGS})
 ENDIF (USE_ARTS)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/CMakeLists.txt	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/CMakeLists.txt	2007-11-21 14:55:28 UTC (rev 3698)
@@ -1,3 +1,4 @@
 SET(ADM_filter_SRCS ADM_vidDummyFilter.cpp  filter.cpp  filter_declaration.cpp  filter_dylib.cpp  filter_saveload.cpp  vidVCD.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_filter ${ADM_filter_SRCS})
+ADD_CFLAGS_ALL_TARGETS(ADM_filter -I${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS})
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/CMakeLists.txt	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/CMakeLists.txt	2007-11-21 14:55:28 UTC (rev 3698)
@@ -5,4 +5,5 @@
 	ADM_fileio.cpp     ADM_imageResizer.cpp  ADM_pp.cpp          avidemutils.cpp  aviindexer.cpp  broken.cpp  prefs.cpp
 	ADM_imageLoader.cpp  ADM_gettext.cpp)
 
-ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
\ No newline at end of file
+ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
+ADD_SOURCE_CFLAGS(prefs.cpp -I${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS})
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/default.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/default.h	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/default.h	2007-11-21 14:55:28 UTC (rev 3698)
@@ -82,14 +82,8 @@
  * Standard gettext macros.
  */
 #ifdef HAVE_GETTEXT
-#  include <libintl.h>
-#  undef _
-#else
-#  define textdomain(String) (String)
-#  define gettext(String) (String)
-#  define dgettext(Domain,Message) (Message)
-#  define dcgettext(Domain,Message,Type) (Message)
-#  define bindtextdomain(Domain,Directory) (Domain)
+	#include <libintl.h>
+	#undef _
 #endif
 
 extern const char* translate(const char *__domainname, const char *__msgid);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/CMakeLists.txt	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport/CMakeLists.txt	2007-11-21 14:55:28 UTC (rev 3698)
@@ -4,4 +4,5 @@
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_osSupport ${ADM_osSupport_SRCS})
 ADD_SOURCE_CFLAGS(ADM_crashdump.cpp ${GLIB_CFLAGS})
-ADD_SOURCE_CFLAGS(ADM_fileio.cpp ${GLIB_CFLAGS})
\ No newline at end of file
+ADD_SOURCE_CFLAGS(ADM_fileio.cpp ${GLIB_CFLAGS})
+ADD_SOURCE_CFLAGS(ADM_quota.cpp -I${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS})
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp	2007-11-21 14:55:28 UTC (rev 3698)
@@ -26,8 +26,6 @@
 //#define VERBOSE_XV
 
 #ifdef USE_XV
-
-
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
 #include <sys/ipc.h>
@@ -36,11 +34,10 @@
 #include <X11/extensions/Xvlib.h>
 #include <X11/extensions/XShm.h>
 
-
 #include "default.h"
 
 #include "ADM_colorspace/colorspace.h"
-#include "ADM_commonUI//GUI_render.h"
+#include "GUI_render.h"
 
 #include "GUI_accelRender.h"
 #include "GUI_xvRender.h"

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-21 14:55:28 UTC (rev 3698)
@@ -1,26 +1,26 @@
 SET(ADM_videoFilter_SRCS 
-	ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp    
+	ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp
 	ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
-	ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp     
+	ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp
 	ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
-	ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp     
+	ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp
 	ADM_vidReverse.cpp        ADM_vidVlad.cpp
-	ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp  
+	ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp
 	ADM_vidRotate.cpp         ADM_vidWhirl.cpp
-	ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp   
+	ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp
 	ADM_vidSeparateField.cpp  ADM_vidYadif.cpp
-	ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp    
+	ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp
 	ADM_vidSoften.cpp
-	ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp   
+	ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp
 	ADM_vidStabilize.cpp
-	ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp   
+	ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp
 	ADM_vidSwapFields.cpp
 	ADM_vidYadif_asm.c
 	ADM_guiResize.cpp  ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
-	ADM_vidMPLResize.cpp  
+	ADM_vidMPLResize.cpp
 	ADM_vidResize25.cpp
 	ADM_vidTdeint.cpp
-	ADM_vidChromaShift.cpp  
+	ADM_vidChromaShift.cpp
 	ADM_vidAnimated.cpp
 	ADM_vidDvbSub.cpp
 	ADM_vidLogo.cpp
@@ -28,11 +28,11 @@
 	ADM_vidSRT.cpp
 	ADM_vidSRTload.cpp
 	ADM_vidSRTRender.cpp
-	ADM_vidCrop.cpp       
-	ADM_vidEq2.cpp      
-	ADM_vidContrast.cpp 
-	ADM_vidDelta.cpp 
-	ADM_vidUnblend.cpp 
+	ADM_vidCrop.cpp
+	ADM_vidEq2.cpp
+	ADM_vidContrast.cpp
+	ADM_vidDelta.cpp
+	ADM_vidUnblend.cpp
 	ADM_vidAsharp.cpp
 	ADM_vidVobsub.cpp
 	ADM_vidVobSubRender.cpp
@@ -51,5 +51,5 @@
 IF (USE_FREETYPE)
 	ADD_SOURCE_CFLAGS(ADM_vidSRT.cpp "${FREETYPE2_CFLAGS}")
 	ADD_SOURCE_CFLAGS(ADM_vidSRTload.cpp "${FREETYPE2_CFLAGS}")
-	ADD_SOURCE_CFLAGS(ADM_vidSRTrender.cpp "${FREETYPE2_CFLAGS}")
+	ADD_SOURCE_CFLAGS(ADM_vidSRTRender.cpp "${FREETYPE2_CFLAGS}")
 ENDIF (USE_FREETYPE)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake	2007-11-21 12:21:10 UTC (rev 3697)
+++ branches/avidemux_2.5_branch_gruntster/cmake/CMakeDetermineSystem.cmake	2007-11-21 14:55:28 UTC (rev 3698)
@@ -0,0 +1,80 @@
+
+# This module is used by the Makefile generator to determin the following variables:
+# CMAKE_SYSTEM_NAME - on unix this is uname -s, for windows it is Windows
+# CMAKE_SYSTEM_VERSION - on unix this is uname -r, for windows it is empty
+# CMAKE_SYSTEM - ${CMAKE_SYSTEM}-${CMAKE_SYSTEM_VERSION}, for windows: ${CMAKE_SYSTEM}
+#
+#  Expected uname -s output:
+#
+# AIX                           AIX  
+# BSD/OS                        BSD/OS  
+# FreeBSD                       FreeBSD  
+# HP-UX                         HP-UX  
+# IRIX                          IRIX  
+# Linux                         Linux  
+# NetBSD                        NetBSD  
+# OpenBSD                       OpenBSD  
+# OFS/1 (Digital Unix)          OSF1  
+# SCO OpenServer 5              SCO_SV  
+# SCO UnixWare 7                UnixWare  
+# SCO UnixWare (pre release 7)  UNIX_SV  
+# SCO XENIX                     Xenix  
+# Solaris                       SunOS  
+# SunOS                         SunOS  
+# Tru64                         Tru64  
+# Ultrix                        ULTRIX  
+# cygwin                        CYGWIN_NT-5.1
+# MacOSX                        Darwin
+  
+IF(UNIX)
+  FIND_PROGRAM(CMAKE_UNAME uname /bin /usr/bin /usr/local/bin )
+  IF(CMAKE_UNAME)
+    EXEC_PROGRAM(uname ARGS -s OUTPUT_VARIABLE CMAKE_SYSTEM_NAME)
+    EXEC_PROGRAM(uname ARGS -r OUTPUT_VARIABLE CMAKE_SYSTEM_VERSION)
+    EXEC_PROGRAM(uname ARGS -m OUTPUT_VARIABLE CMAKE_SYSTEM_PROCESSOR RETURN_VALUE val)
+
+    IF("${val}" GREATER 0)
+      SET(CMAKE_SYSTEM_PROCESSOR "unknown")
+    ENDIF("${val}" GREATER 0)
+    SET(CMAKE_UNAME ${CMAKE_UNAME} CACHE INTERNAL "uname command")
+    # processor may have double quote in the name, and that needs to be removed
+    STRING(REGEX REPLACE "\"" "" CMAKE_SYSTEM_PROCESSOR "${CMAKE_SYSTEM_PROCESSOR}")
+    STRING(REGEX REPLACE "/" "_" CMAKE_SYSTEM_PROCESSOR "${CMAKE_SYSTEM_PROCESSOR}")
+  ENDIF(CMAKE_UNAME)
+ELSE(UNIX)
+  IF(WIN32)
+    SET (CMAKE_SYSTEM_NAME "Windows")
+    SET (CMAKE_SYSTEM_PROCESSOR "$ENV{PROCESSOR_ARCHITECTURE}")
+  ENDIF(WIN32)
+ENDIF(UNIX)
+
+IF(NOT CMAKE_SYSTEM_NAME)
+  SET(CMAKE_SYSTEM_NAME "UnknownOS")
+ENDIF(NOT CMAKE_SYSTEM_NAME)
+
+# fix for BSD/OS , remove the /
+IF(CMAKE_SYSTEM_NAME MATCHES BSD.OS)
+  SET(CMAKE_SYSTEM_NAME BSDOS)
+ENDIF(CMAKE_SYSTEM_NAME MATCHES BSD.OS)
+
+# fix for CYGWIN which has windows version in it 
+IF(CMAKE_SYSTEM_NAME MATCHES CYGWIN)
+  SET(CMAKE_SYSTEM_NAME CYGWIN)
+ENDIF(CMAKE_SYSTEM_NAME MATCHES CYGWIN)
+
+# set CMAKE_SYSTEM to the CMAKE_SYSTEM_NAME
+SET(CMAKE_SYSTEM  ${CMAKE_SYSTEM_NAME})
+# if there is a CMAKE_SYSTEM_VERSION then add a -${CMAKE_SYSTEM_VERSION}
+IF(CMAKE_SYSTEM_VERSION)
+  SET(CMAKE_SYSTEM ${CMAKE_SYSTEM}-${CMAKE_SYSTEM_VERSION})
+ENDIF(CMAKE_SYSTEM_VERSION)
+
+
+FILE(APPEND ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeOutput.log 
+  "The system is: ${CMAKE_SYSTEM_NAME} - ${CMAKE_SYSTEM_VERSION} - ${CMAKE_SYSTEM_PROCESSOR}\n")
+
+# configure variables set in this file for fast reload
+CONFIGURE_FILE(${CMAKE_ROOT}/Modules/CMakeSystem.cmake.in 
+               ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeSystem.cmake 
+               IMMEDIATE)
+



From mean at mail.berlios.de  Wed Nov 21 19:09:48 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 21 Nov 2007 19:09:48 +0100
Subject: [Avidemux-svn-commit] r3699 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass
Message-ID: <200711211809.lALI9mFY014440@sheep.berlios.de>

Author: mean
Date: 2007-11-21 19:09:42 +0100 (Wed, 21 Nov 2007)
New Revision: 3699

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h
Log:
[ASS] Surfer: Update to ass/mplayer current

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c	2007-11-21 18:09:42 UTC (rev 3699)
@@ -271,6 +271,14 @@
 	char* format = strdup(track->event_format);
 	char* q = format; // format scanning pointer
 
+	if (track->n_styles == 0) {
+		// add "Default" style to the end
+		// will be used if track does not contain a default style (or even does not contain styles at all)
+		int sid = ass_alloc_style(track);
+		track->styles[sid].Name = strdup("Default");
+		track->styles[sid].FontName = strdup("Arial");
+	}
+
 	for (i = 0; i < n_ignored; ++i) {
 		NEXT(q, tname);
 	}
@@ -323,13 +331,13 @@
 	if (!list) return;
 	
 	for (fs = list; *fs; ++fs) {
-		eq = strchr(*fs, '=');
+		eq = strrchr(*fs, '=');
 		if (!eq)
 			continue;
 		*eq = '\0';
 		token = eq + 1;
 
-		dt = strchr(*fs, '.');
+		dt = strrchr(*fs, '.');
 		if (dt) {
 			*dt = '\0';
 			style = *fs;
@@ -697,7 +705,6 @@
 void ass_process_codec_private(ass_track_t* track, char *data, int size)
 {
 	char* str = malloc(size + 1);
-	int sid;
 
 	memcpy(str, data, size);
 	str[size] = '\0';
@@ -705,12 +712,6 @@
 	process_text(track, str);
 	free(str);
 
-	// add "Default" style to the end
-	// will be used if track does not contain a default style (or even does not contain styles at all)
-	sid = ass_alloc_style(track);
-	track->styles[sid].Name = strdup("Default");
-	track->styles[sid].FontName = strdup("Arial");
-	
 	if (!track->event_format) {
 		// probably an mkv produced by ancient mkvtoolnix
 		// such files don't have [Events] and Format: headers
@@ -982,17 +983,9 @@
 	return track;
 }
 
-/**
- * \brief Read subtitles from file.
- * \param library libass library object
- * \param fname file name
- * \param codepage recode buffer contents from given codepage
- * \return newly allocated track
-*/ 
-ass_track_t* ass_read_file(ass_library_t* library, char* fname, char* codepage)
+char* read_file_recode(char* fname, char* codepage, int* size)
 {
 	char* buf;
-	ass_track_t* track;
 	size_t bufsize;
 	
 	buf = read_file(fname, &bufsize);
@@ -1007,6 +1000,26 @@
 	if (!buf)
 		return 0;
 #endif
+	*size = bufsize;
+	return buf;
+}
+
+/**
+ * \brief Read subtitles from file.
+ * \param library libass library object
+ * \param fname file name
+ * \param codepage recode buffer contents from given codepage
+ * \return newly allocated track
+*/ 
+ass_track_t* ass_read_file(ass_library_t* library, char* fname, char* codepage)
+{
+	char* buf;
+	ass_track_t* track;
+	size_t bufsize;
+
+	buf = read_file_recode(fname, codepage, &bufsize);
+	if (!buf)
+		return 0;
 	track = parse_memory(library, buf);
 	free(buf);
 	if (!track)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_H__
-#define __ASS_H__
+#ifndef ASS_H
+#define ASS_H
 
 #include "ass_types.h"
 
@@ -85,6 +85,7 @@
 void ass_set_aspect_ratio(ass_renderer_t* priv, double ar);
 void ass_set_font_scale(ass_renderer_t* priv, double font_scale);
 void ass_set_hinting(ass_renderer_t* priv, ass_hinting_t ht);
+void ass_set_line_spacing(ass_renderer_t* priv, double line_spacing);
 
 /**
  * \brief set font lookup defaults
@@ -162,6 +163,8 @@
 */
 void ass_process_chunk(ass_track_t* track, char *data, int size, long long timecode, long long duration);
 
+char* read_file_recode(char* fname, char* codepage, int* size);
+
 /**
  * \brief Read subtitles from file.
  * \param fname file name

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_BITMAP_H__
-#define __ASS_BITMAP_H__
+#ifndef ASS_BITMAP_H
+#define ASS_BITMAP_H
 
 typedef struct ass_synth_priv_s ass_synth_priv_t;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-11-21 18:09:42 UTC (rev 3699)
@@ -21,18 +21,9 @@
 #include "config.h"
 
 #include <inttypes.h>
-#ifdef HAVE_UNISTD_H
-// avoid warnings due to different definition of this in freetype headers
-#define WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#endif
 #include <ft2build.h>
 #include FT_FREETYPE_H
 #include FT_GLYPH_H
-#ifdef WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#define HAVE_UNISTD_H
-#endif
 
 #include <assert.h>
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_CACHE_H__
-#define __ASS_CACHE_H__
+#ifndef ASS_CACHE_H
+#define ASS_CACHE_H
 
 void ass_font_cache_init(void);
 ass_font_t* ass_font_cache_find(ass_font_desc_t* desc);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-11-21 18:09:42 UTC (rev 3699)
@@ -21,21 +21,11 @@
 #include "config.h"
 
 #include <inttypes.h>
-#ifdef HAVE_UNISTD_H
-// avoid warnings due to different definition of this in freetype headers
-#define WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#endif
 #include <ft2build.h>
 #include FT_FREETYPE_H
 #include FT_SYNTHESIS_H
 #include FT_GLYPH_H
 #include FT_TRUETYPE_TABLES_H
-#ifdef HAVE_UNISTD_H
-// avoid warnings due to different definition of this in freetype headers
-#define WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#endif
 
 #include "ass.h"
 #include "ass_library.h"
@@ -97,46 +87,85 @@
 	return -1;
 }
 
+static void face_set_size(FT_Face face, double size);
+
+static void buggy_font_workaround(FT_Face face)
+{
+	// Some fonts have zero Ascender/Descender fields in 'hhea' table.
+	// In this case, get the information from 'os2' table or, as
+	// a last resort, from face.bbox.
+	if (face->ascender + face->descender == 0 || face->height == 0) {
+		TT_OS2 *os2 = FT_Get_Sfnt_Table(face, ft_sfnt_os2);
+		if (os2) {
+			face->ascender = os2->sTypoAscender;
+			face->descender = os2->sTypoDescender;
+			face->height = face->ascender - face->descender;
+		} else {
+			face->ascender = face->bbox.yMax;
+			face->descender = face->bbox.yMin;
+			face->height = face->ascender - face->descender;
+		}
+	}
+}
+
 /**
- * \brief Create a new ass_font_t according to "desc" argument
+ * \brief Select a face with the given charcode and add it to ass_font_t
+ * \return index of the new face in font->faces, -1 if failed
  */
-ass_font_t* ass_font_new(ass_library_t* library, FT_Library ftlibrary, void* fc_priv, ass_font_desc_t* desc)
+static int add_face(void* fc_priv, ass_font_t* font, uint32_t ch)
 {
 	char* path;
 	int index;
 	FT_Face face;
 	int error;
-	ass_font_t* fontp;
-	ass_font_t font;
 	int mem_idx;
-
-	fontp = ass_font_cache_find(desc);
-	if (fontp)
-		return fontp;
 	
-	path = fontconfig_select(fc_priv, desc->family, desc->bold, desc->italic, &index);
+	if (font->n_faces == ASS_FONT_MAX_FACES)
+		return -1;
 	
-	mem_idx = find_font(library, path);
+	path = fontconfig_select(fc_priv, font->desc.family, font->desc.bold,
+					      font->desc.italic, &index, ch);
+
+	mem_idx = find_font(font->library, path);
 	if (mem_idx >= 0) {
-		error = FT_New_Memory_Face(ftlibrary, (unsigned char*)library->fontdata[mem_idx].data,
-					   library->fontdata[mem_idx].size, 0, &face);
+		error = FT_New_Memory_Face(font->ftlibrary, (unsigned char*)font->library->fontdata[mem_idx].data,
+					   font->library->fontdata[mem_idx].size, 0, &face);
 		if (error) {
 			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningMemoryFont, path);
-			return 0;
+			return -1;
 		}
 	} else {
-		error = FT_New_Face(ftlibrary, path, index, &face);
+		error = FT_New_Face(font->ftlibrary, path, index, &face);
 		if (error) {
 			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningFont, path, index);
-			return 0;
+			return -1;
 		}
 	}
-
 	charmap_magic(face);
+	buggy_font_workaround(face);
 	
+	font->faces[font->n_faces++] = face;
+	update_transform(font);
+	face_set_size(face, font->size);
+	return font->n_faces - 1;
+}
+
+/**
+ * \brief Create a new ass_font_t according to "desc" argument
+ */
+ass_font_t* ass_font_new(ass_library_t* library, FT_Library ftlibrary, void* fc_priv, ass_font_desc_t* desc)
+{
+	int error;
+	ass_font_t* fontp;
+	ass_font_t font;
+
+	fontp = ass_font_cache_find(desc);
+	if (fontp)
+		return fontp;
+	
+	font.library = library;
 	font.ftlibrary = ftlibrary;
-	font.faces[0] = face;
-	font.n_faces = 1;
+	font.n_faces = 0;
 	font.desc.family = strdup(desc->family);
 	font.desc.bold = desc->bold;
 	font.desc.italic = desc->italic;
@@ -145,11 +174,12 @@
 	font.v.x = font.v.y = 0;
 	font.size = 0.;
 
-#ifdef HAVE_FONTCONFIG
-	font.charset = FcCharSetCreate();
-#endif
-
-	return ass_font_cache_add(&font);
+	error = add_face(fc_priv, &font, 0);
+	if (error == -1) {
+		free(font.desc.family);
+		return 0;
+	} else
+		return ass_font_cache_add(&font);
 }
 
 /**
@@ -174,8 +204,12 @@
 	FT_Size_Metrics *m = &face->size->metrics;
 	// VSFilter uses metrics from TrueType OS/2 table
 	// The idea was borrowed from asa (http://asa.diac24.net)
-	if (hori && os2)
-		mscale = ((double)(hori->Ascender - hori->Descender)) / (os2->usWinAscent + os2->usWinDescent);
+	if (hori && os2) {
+		int hori_height = hori->Ascender - hori->Descender;
+		int os2_height = os2->usWinAscent + os2->usWinDescent;
+		if (hori_height && os2_height)
+			mscale = (double)hori_height / os2_height;
+	}
 	memset(&rq, 0, sizeof(rq));
 	rq.type = FT_SIZE_REQUEST_TYPE_REAL_DIM;
 	rq.width = 0;
@@ -203,44 +237,7 @@
 	}
 }
 
-#ifdef HAVE_FONTCONFIG
 /**
- * \brief Select a new FT_Face with the given character
- * The new face is added to the end of font->faces.
- **/
-static void ass_font_reselect(void* fontconfig_priv, ass_font_t* font, uint32_t ch)
-{
-	char* path;
-	int index;
-	FT_Face face;
-	int error;
-
-	if (font->n_faces == ASS_FONT_MAX_FACES)
-		return;
-	
-	path = fontconfig_select_with_charset(fontconfig_priv, font->desc.family, font->desc.bold,
-					      font->desc.italic, &index, font->charset);
-
-	error = FT_New_Face(font->ftlibrary, path, index, &face);
-	if (error) {
-		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningFont, path, index);
-		return;
-	}
-	charmap_magic(face);
-
-	error = FT_Get_Char_Index(face, ch);
-	if (error == 0) { // the new font face is not better then the old one
-		FT_Done_Face(face);
-		return;
-	}
-
-	font->faces[font->n_faces++] = face;
-	update_transform(font);
-	FT_Set_Pixel_Sizes(face, 0, (int)font->size);
-}
-#endif
-
-/**
  * \brief Get maximal font ascender and descender.
  * \param ch character code
  * The values are extracted from the font face that provides glyphs for the given character
@@ -292,12 +289,12 @@
 	}
 
 #ifdef HAVE_FONTCONFIG
-	FcCharSetAddChar(font->charset, ch);
 	if (index == 0) {
+		int face_idx;
 		mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_GlyphNotFoundReselectingFont,
 		       ch, font->desc.family, font->desc.bold, font->desc.italic);
-		ass_font_reselect(fontconfig_priv, font, ch);
-		face = font->faces[font->n_faces - 1];
+		face_idx = add_face(fontconfig_priv, font, ch);
+		face = font->faces[face_idx];
 		index = FT_Get_Char_Index(face, ch);
 		if (index == 0) {
 			mp_msg(MSGT_ASS, MSGL_ERR, MSGTR_LIBASS_GlyphNotFound,
@@ -369,8 +366,5 @@
 	for (i = 0; i < font->n_faces; ++i)
 		if (font->faces[i]) FT_Done_Face(font->faces[i]);
 	if (font->desc.family) free(font->desc.family);
-#ifdef HAVE_FONTCONFIG
-	if (font->charset) FcCharSetDestroy(font->charset);
-#endif
 	free(font);
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,13 +18,9 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_FONT_H__
-#define __ASS_FONT_H__
+#ifndef ASS_FONT_H
+#define ASS_FONT_H
 
-#ifdef HAVE_FONTCONFIG
-#include <fontconfig/fontconfig.h>
-#endif
-
 typedef struct ass_font_desc_s {
 	char* family;
 	unsigned bold;
@@ -35,15 +31,13 @@
 
 typedef struct ass_font_s {
 	ass_font_desc_t desc;
+	ass_library_t* library;
 	FT_Library ftlibrary;
 	FT_Face faces[ASS_FONT_MAX_FACES];
 	int n_faces;
 	double scale_x, scale_y; // current transform
 	FT_Vector v; // current shift
 	double size;
-#ifdef HAVE_FONTCONFIG
-	FcCharSet* charset;
-#endif
 } ass_font_t;
 
 ass_font_t* ass_font_new(ass_library_t* library, FT_Library ftlibrary, void* fc_priv, ass_font_desc_t* desc);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-11-21 18:09:42 UTC (rev 3699)
@@ -27,17 +27,8 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <inttypes.h>
-#ifdef HAVE_UNISTD_H
-// avoid warnings due to different definition of this in freetype headers
-#define WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#endif
 #include <ft2build.h>
 #include FT_FREETYPE_H
-#ifdef WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#define HAVE_UNISTD_H
-#endif
 
 #include "mputils.h"
 #include "ass.h"
@@ -66,11 +57,11 @@
  * \param bold font weight value
  * \param italic font slant value
  * \param index out: font index inside a file
- * \param charset: contains the characters that should be present in the font, can be NULL
+ * \param code: the character that should be present in the font, can be 0
  * \return font file path
 */ 
 static char* _select_font(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
-			  FcCharSet* charset)
+			  uint32_t code)
 {
 	FcBool rc;
 	FcResult result;
@@ -80,7 +71,7 @@
 	FcBool val_b;
 	FcCharSet* val_cs;
 	FcFontSet* fset = 0;
-	int curf, bestf, bestdiff = 0;
+	int curf;
 	char* retval = 0;
 	
 	*index = 0;
@@ -102,9 +93,6 @@
 
 	fset = FcFontSort(priv->config, pat, FcTrue, NULL, &result);
 
-	bestf = -1;
-	if (charset)
-		bestdiff = FcCharSetCount(charset) + 1;
 	for (curf = 0; curf < fset->nfont; ++curf) {
 		rpat = fset->fonts[curf];
 		
@@ -113,29 +101,19 @@
 			continue;
 		if (val_b != FcTrue)
 			continue;
-
-		if (charset) {
-			int diff;
-			result = FcPatternGetCharSet(rpat, FC_CHARSET, 0, &val_cs);
-			if (result != FcResultMatch)
-				continue;
-			diff = FcCharSetSubtractCount(charset, val_cs);
-			if (diff < bestdiff) {
-				bestdiff = diff;
-				bestf = curf;
-			}
- 			if (diff == 0)
-				break;
-		} else {
-			bestf = curf;
+		if (!code)
 			break;
-		}
+		result = FcPatternGetCharSet(rpat, FC_CHARSET, 0, &val_cs);
+		if (result != FcResultMatch)
+			continue;
+		if (FcCharSetHasChar(val_cs, code))
+			break;
 	}
 
-	if (bestf < 0)
+	if (curf >= fset->nfont)
 		goto error;
 
-	rpat = fset->fonts[bestf];
+	rpat = fset->fonts[curf];
 	
 	result = FcPatternGetInteger(rpat, FC_INDEX, 0, &val_i);
 	if (result != FcResultMatch)
@@ -168,17 +146,17 @@
  * \param bold font weight value
  * \param italic font slant value
  * \param index out: font index inside a file
- * \param charset: contains the characters that should be present in the font, can be NULL
+ * \param code: the character that should be present in the font, can be 0
  * \return font file path
 */ 
-char* fontconfig_select_with_charset(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
-			FcCharSet* charset)
+char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
+			uint32_t code)
 {
 	char* res = 0;
 	if (family && *family)
-		res = _select_font(priv, family, bold, italic, index, charset);
+		res = _select_font(priv, family, bold, italic, index, code);
 	if (!res && priv->family_default) {
-		res = _select_font(priv, priv->family_default, bold, italic, index, charset);
+		res = _select_font(priv, priv->family_default, bold, italic, index, code);
 		if (res)
 			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UsingDefaultFontFamily, 
 					family, bold, italic, res, *index);
@@ -190,7 +168,7 @@
 		       family, bold, italic, res, *index);
 	}
 	if (!res) {
-		res = _select_font(priv, "Arial", bold, italic, index, charset);
+		res = _select_font(priv, "Arial", bold, italic, index, code);
 		if (res)
 			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UsingArialFontFamily, 
 					family, bold, italic, res, *index);
@@ -201,11 +179,6 @@
 	return res;
 }
 
-char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
-{
-	return fontconfig_select_with_charset(priv, family, bold, italic, index, 0);
-}
-
 #if (FC_VERSION < 20402)
 static char* validate_fname(char* name)
 {
@@ -407,7 +380,8 @@
 
 #else // HAVE_FONTCONFIG
 
-char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
+char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
+			uint32_t code)
 {
 	*index = priv->index_default;
 	return priv->path_default;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_FONTCONFIG_H__
-#define __ASS_FONTCONFIG_H__
+#ifndef ASS_FONTCONFIG_H
+#define ASS_FONTCONFIG_H
 
 #ifdef HAVE_FONTCONFIG
 #include <fontconfig/fontconfig.h>
@@ -28,12 +28,8 @@
 typedef struct fc_instance_s fc_instance_t;
 
 fc_instance_t* fontconfig_init(ass_library_t* library, FT_Library ftlibrary, const char* family, const char* path);
-char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index);
+char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index, uint32_t code);
 void fontconfig_done(fc_instance_t* priv);
 
-#ifdef HAVE_FONTCONFIG
-char* fontconfig_select_with_charset(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index, FcCharSet* charset);
 #endif
 
-#endif
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_LIBRARY_H__
-#define __ASS_LIBRARY_H__
+#ifndef ASS_LIBRARY_H
+#define ASS_LIBRARY_H
 
 typedef struct ass_fontdata_s {
 	char* name;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-11-21 18:09:42 UTC (rev 3699)
@@ -23,20 +23,11 @@
 #include <assert.h>
 #include <math.h>
 #include <inttypes.h>
-#ifdef HAVE_UNISTD_H
-// avoid warnings due to different definition of this in freetype headers
-#define WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#endif
 #include <ft2build.h>
 #include FT_FREETYPE_H
 #include FT_STROKER_H
 #include FT_GLYPH_H
 #include FT_SYNTHESIS_H
-#ifdef WE_DO_HAVE_UNISTD_H
-#undef HAVE_UNISTD_H
-#define HAVE_UNISTD_H
-#endif
 
 #include "mputils.h"
 
@@ -1326,7 +1317,6 @@
 /**
  * This function goes through text_info and calculates text parameters.
  * The following text_info fields are filled:
- *   n_lines
  *   height
  *   lines[].height
  *   lines[].asc
@@ -1353,6 +1343,7 @@
 				max_desc = cur->desc;
 		}
 	}
+	text_info.height += (text_info.n_lines - 1) * double_to_d6(global_settings->line_spacing);
 }
 
 /**
@@ -1483,7 +1474,7 @@
 			int height = text_info.lines[cur_line - 1].desc + text_info.lines[cur_line].asc;
 			cur_line ++;
 			pen_shift_x = - cur->pos.x;
-			pen_shift_y += d6_to_int(height) + global_settings->line_spacing;
+			pen_shift_y += d6_to_int(height + double_to_d6(global_settings->line_spacing));
 			mp_msg(MSGT_ASS, MSGL_DBG2, "shifting from %d to %d by (%d, %d)\n", i, text_info.length - 1, pen_shift_x, pen_shift_y);
 		}
 		cur->pos.x += pen_shift_x;
@@ -2072,6 +2063,11 @@
 	}
 }
 
+void ass_set_line_spacing(ass_renderer_t* priv, double line_spacing)
+{
+	priv->settings.line_spacing = line_spacing;
+}
+
 int ass_set_fonts(ass_renderer_t* priv, const char* default_font, const char* default_family)
 {
 	if (priv->settings.default_font)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_TYPES_H__
-#define __ASS_TYPES_H__
+#ifndef ASS_TYPES_H
+#define ASS_TYPES_H
 
 #define VALIGN_SUB 0
 #define VALIGN_CENTER 8

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h	2007-11-21 14:55:28 UTC (rev 3698)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h	2007-11-21 18:09:42 UTC (rev 3699)
@@ -18,8 +18,8 @@
   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
 
-#ifndef __ASS_UTILS_H__
-#define __ASS_UTILS_H__
+#ifndef ASS_UTILS_H
+#define ASS_UTILS_H
 
 int mystrtoi(char** p, int base, int* res);
 int mystrtou32(char** p, int base, uint32_t* res);



From gruntster at mail.berlios.de  Wed Nov 21 19:49:04 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 21 Nov 2007 19:49:04 +0100
Subject: [Avidemux-svn-commit] r3700 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_audiocodec avidemux/ADM_audiofilter
	avidemux/ADM_codecs avidemux/ADM_encoder
	avidemux/ADM_libraries/ADM_lavcodec
	avidemux/ADM_libraries/ADM_libwrapper
	avidemux/ADM_userInterfaces/ADM_commonUI cmake
Message-ID: <200711211849.lALIn4PP015284@sheep.berlios.de>

Author: gruntster
Date: 2007-11-21 19:48:31 +0100 (Wed, 21 Nov 2007)
New Revision: 3700

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
Log:
[CMake] improve support for headers in non-standard locations

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -5,3 +5,20 @@
 	ADM_audiocodec.cpp  ADM_codecfaad.cpp  ADM_codecmp3.cpp  ADM_codecwav.cpp   ADM_dca.cpp   audiocodec_ogg.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_audiocodec ${ADM_audiocodec_SRCS})
+
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(ADM_audiocodec.cpp -I${AMRNB_INCLUDE_DIR})
+ENDIF (USE_AMR_NB)
+
+IF (USE_FAAD)
+	ADD_SOURCE_CFLAGS(ADM_codecfaad.cpp -I${FAAD_INCLUDE_DIR})
+ENDIF (USE_FAAD)
+
+IF (USE_LIBDCA)
+	ADD_SOURCE_CFLAGS(ADM_audiocodec.cpp -I${LIBDCA_INCLUDE_DIR})
+	ADD_SOURCE_CFLAGS(ADM_dca.cpp -I${LIBDCA_INCLUDE_DIR})
+ENDIF (USE_LIBDCA)
+
+IF (USE_VORBIS)
+	ADD_SOURCE_CFLAGS(audiocodec_ogg.cpp -I${VORBIS_INCLUDE_DIR})
+ENDIF (USE_VORBIS)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiofilter/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -6,3 +6,19 @@
 	audioencoder_lame.cpp       audioeng_buff.cpp          audiofilter_dolby.cpp          audiofilter_sox.cpp)
 	
 ADD_ADM_LIB_ALL_TARGETS(ADM_audiofilter ${ADMaudiofilter_SRCS})
+
+IF (USE_AFTEN)
+	ADD_SOURCE_CFLAGS(audioencoder_aften.cpp -I${AFTEN_INCLUDE_DIR})
+ENDIF (USE_AFTEN)
+
+IF (USE_FAAC)
+	ADD_SOURCE_CFLAGS(audioencoder_faac.cpp -I${FAAC_INCLUDE_DIR})
+ENDIF (USE_FAAC)
+
+IF (HAVE_LIBMP3LAME)
+	ADD_SOURCE_CFLAGS(audioencoder_lame.cpp -I${LAME_INCLUDE_DIR})
+ENDIF (HAVE_LIBMP3LAME)
+
+IF (USE_VORBIS)
+	ADD_SOURCE_CFLAGS(audioencoder_vorbis.cpp -I${VORBIS_INCLUDE_DIR})
+ENDIF (USE_VORBIS)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -3,3 +3,15 @@
 	ADM_ffmp43.cpp  ADM_mjpeg.cpp   ADM_mpeg.cpp         ADM_rgb16.cpp  ADM_uyvy.cpp        ADM_xvid4.cpp  ADM_xvidcvs.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_codecs ${ADM_codecs_SRCS})
+
+IF (USE_PNG)
+	 ADD_SOURCE_CFLAGS(ADM_png.cpp ${PNG_CFLAGS})
+ENDIF (USE_PNG)
+
+IF (USE_X264)
+	ADD_SOURCE_CFLAGS(ADM_x264.cpp -I${X264_INCLUDE_DIR})
+ENDIF (USE_X264)
+
+IF (USE_XVID_4)
+	ADD_SOURCE_CFLAGS(ADM_xvid4.cpp -I${XVID_INCLUDE_DIR})
+ENDIF (USE_XVID_4)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -3,3 +3,8 @@
 	adm_encCopy.cpp    adm_encdivx.cpp    adm_encffmpeg.cpp   adm_encmpeg2enc.cpp  adm_encRequant.cpp  adm_encXvid4.cpp  adm_encyv12.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_encoder ${ADM_encoder_SRCS})
+
+IF (USE_XVID_4)
+	ADD_SOURCE_CFLAGS(adm_encxvid.cpp -I${XVID_INCLUDE_DIR})
+	ADD_SOURCE_CFLAGS(adm_encXvid4.cpp -I${XVID_INCLUDE_DIR})
+ENDIF (USE_XVID_4)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -45,4 +45,8 @@
 
 IF (ADM_DEBUG)
 	ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} "-O2")
-ENDIF (ADM_DEBUG)
\ No newline at end of file
+ENDIF (ADM_DEBUG)
+
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(amr.c -I${AMRNB_INCLUDE_DIR})
+ENDIF (USE_AMR_NB)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -3,4 +3,14 @@
 SET(${ADM_LIB}_SRCS 
 	libwrapper_amrnb.cpp  libwrapper.cpp  libwrapper_dca.cpp  libwrapper_global.cpp)
 	
-ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
\ No newline at end of file
+ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
+
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(libwrapper_amrnb.cpp -I${AMRNB_INCLUDE_DIR})
+	ADD_SOURCE_CFLAGS(libwrapper_global.cpp -I${AMRNB_INCLUDE_DIR})
+ENDIF (USE_AMR_NB)
+
+IF (USE_LIBDCA)
+	ADD_SOURCE_CFLAGS(libwrapper_dca.cpp -I${LIBDCA_INCLUDE_DIR})
+	ADD_SOURCE_CFLAGS(libwrapper_global.cpp -I${LIBDCA_INCLUDE_DIR})
+ENDIF (USE_LIBDCA)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -10,4 +10,12 @@
 
 ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
 
-SDLify(GUI_sdlRender.cpp)
\ No newline at end of file
+SDLify(GUI_sdlRender.cpp)
+
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(DIA_builtin.cpp -I${AMRNB_INCLUDE_DIR})
+ENDIF (USE_AMR_NB)
+
+IF (USE_LIBDCA)
+	ADD_SOURCE_CFLAGS(DIA_builtin.cpp -I${LIBDCA_INCLUDE_DIR})
+ENDIF (USE_LIBDCA)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
@@ -60,8 +60,16 @@
 
 SDLify(main.cpp)
 ADD_SOURCE_CFLAGS(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
-ADD_SOURCE_CFLAGS(gtk_gui.cpp "${GLIB_CFLAGS}")
+ADD_SOURCE_CFLAGS(gtk_gui.cpp ${GLIB_CFLAGS})
 
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
+ENDIF (USE_AMR_NB)
+
+IF (USE_LIBDCA)
+	ADD_SOURCE_CFLAGS(main.cpp -I${LIBDCA_INCLUDE_DIR})
+ENDIF (USE_LIBDCA)
+
 ########################################
 # Compile and link general subdirs
 ########################################

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-21 18:48:31 UTC (rev 3700)
@@ -18,7 +18,8 @@
 				AFTEN_TEST_COMPILE_RESULT
 				${CMAKE_BINARY_DIR}
 				"${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp"
-				CMAKE_FLAGS -DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR})
+				CMAKE_FLAGS "-DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR}"
+				COMPILE_DEFINITIONS "-I${AFTEN_INCLUDE_DIR}")
 		ENDIF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
 
 		IF (AFTEN_TEST_RUN_RESULT EQUAL 8)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-21 18:09:42 UTC (rev 3699)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-21 18:48:31 UTC (rev 3700)
@@ -73,5 +73,10 @@
 FIND_PACKAGE(PNG)
 PRINT_LIBRARY_INFO("libpng" PNG_FOUND "${PNG_INCLUDE_DIR} ${PNG_DEFINITIONS}" "${PNG_LIBRARIES}" FATAL_ERROR)
 
+FOREACH(_flag ${PNG_INCLUDE_DIR})
+	SET(PNG_CFLAGS ${PNG_CFLAGS} -I${_flag})
+ENDFOREACH(_flag)
+
+SET(PNG_CFLAGS ${PNG_CFLAGS} ${PNG_DEFINITIONS})
 SET(USE_PNG 1)
 MESSAGE("")
\ No newline at end of file



From gruntster at mail.berlios.de  Thu Nov 22 13:38:29 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 22 Nov 2007 13:38:29 +0100
Subject: [Avidemux-svn-commit] r3701 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200711221238.lAMCcTn8005120@sheep.berlios.de>

Author: gruntster
Date: 2007-11-22 13:38:20 +0100 (Thu, 22 Nov 2007)
New Revision: 3701

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
Log:
[CMake] customise link libraries for each UI

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-21 18:48:31 UTC (rev 3700)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-22 12:38:20 UTC (rev 3701)
@@ -62,12 +62,12 @@
 ADD_SOURCE_CFLAGS(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
 ADD_SOURCE_CFLAGS(gtk_gui.cpp ${GLIB_CFLAGS})
 
-IF (USE_AMR_NB)
-	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
+IF (USE_AMR_NB)
+	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
 ENDIF (USE_AMR_NB)
 
-IF (USE_LIBDCA)
-	ADD_SOURCE_CFLAGS(main.cpp -I${LIBDCA_INCLUDE_DIR})
+IF (USE_LIBDCA)
+	ADD_SOURCE_CFLAGS(main.cpp -I${LIBDCA_INCLUDE_DIR})
 ENDIF (USE_LIBDCA)
 
 ########################################
@@ -181,14 +181,15 @@
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
 ENDIF (ADM_DEBUG AND FIND_LEAKS)
 
-IF (ADM_OS_DARWIN AND USE_SDL)
-	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libsdl)
-ENDIF (ADM_OS_DARWIN AND USE_SDL)
-
 FOREACH(_current ${ADM_LIBRARIES})
 	ADD_ADMLIB_ALL_TARGETS(${_current})
 ENDFOREACH(_current ${ADM_SUBDIR})
 
+IF (ADM_OS_DARWIN AND USE_SDL)
+	ADD_ADM_LIB_GTK_TARGET(ADM_libsdl)
+	ADD_ADM_LIB_QT4_TARGET(ADM_libsdl)
+ENDIF (ADM_OS_DARWIN AND USE_SDL)
+
 ###########################################
 # Construct ADM_userInterface
 ###########################################
@@ -238,10 +239,10 @@
 # gettext
 IF (GETTEXT_FOUND)
 	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
-	TARGET_LINK_LIBRARIES(avidemux2_cli "${GETTEXT_LIBRARY_DIR}")
+	TARGET_LINK_LIBRARIES(avidemux2_cli ${GETTEXT_LIBRARY_DIR})
 
 	IF (GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk "${GETTEXT_LIBRARY_DIR}")
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${GETTEXT_LIBRARY_DIR})
 	ENDIF (GTK_FOUND)
 ENDIF (GETTEXT_FOUND)
 
@@ -275,10 +276,15 @@
 # Libxml2
 ADD_LIB_ALL_TARGETS("${LIBXML2_LIBRARIES}")
 
-# XVideo 
+# XVideo
 IF (USE_XV)
-	ADD_LIB_ALL_TARGETS("${X11_LIBRARIES}")
-	ADD_LIB_ALL_TARGETS("${XVIDEO_LIBRARY_DIR}")
+	IF (NOT ADM_OS_DARWIN)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${X11_LIBRARIES})
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${XVIDEO_LIBRARY_DIR})
+	ENDIF (NOT ADM_OS_DARWIN)
+
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${X11_LIBRARIES})
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${XVIDEO_LIBRARY_DIR})
 ENDIF (USE_XV)
 
 # SDL
@@ -288,17 +294,20 @@
 
 # aRts
 IF (USE_ARTS)
-	ADD_LIB_ALL_TARGETS("${ARTS_LDFLAGS}")
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ARTS_LDFLAGS})
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ARTS_LDFLAGS})
 ENDIF (USE_ARTS)
 
 # ALSA
 IF (ALSA_FOUND)
-	ADD_LIB_ALL_TARGETS("${ASOUND_LIBRARY}")
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ASOUND_LIBRARY})
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ASOUND_LIBRARY})
 ENDIF (ALSA_FOUND)
 
 # ESD
 IF (USE_ESD)
-	ADD_LIB_ALL_TARGETS("${ESD_LIBRARY_DIR}")
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ESD_LIBRARY_DIR})
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ESD_LIBRARY_DIR})
 ENDIF (USE_ESD)
 
 # JACK

Modified: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-21 18:48:31 UTC (rev 3700)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-22 12:38:20 UTC (rev 3701)
@@ -27,8 +27,10 @@
 /* Build for Windows 32bits */
 #cmakedefine ADM_WIN32
 
+#if ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK || ${CONFIG_HEADER_TYPE} == ADM_BUILD_QT4
 /* use ALSA as possible audio device */
 #cmakedefine ALSA_SUPPORT
+#endif
 
 /* AMR_NB */
 #cmakedefine AMR_NB
@@ -162,11 +164,15 @@
 /* Tell avidemux to use libamrnb */
 #cmakedefine USE_AMR_NB
 
+#if ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK || ${CONFIG_HEADER_TYPE} == ADM_BUILD_QT4
 /* aRts detected */
 #cmakedefine USE_ARTS
+#endif
 
+#if ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK || ${CONFIG_HEADER_TYPE} == ADM_BUILD_QT4
 /* ESD detected */
 #cmakedefine USE_ESD
+#endif
 
 /* Jack detected */
 #cmakedefine USE_JACK
@@ -207,8 +213,10 @@
 /* use libsamplerate */
 #cmakedefine USE_SRC
 
+#if ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK || ${CONFIG_HEADER_TYPE} == ADM_BUILD_QT4
 /* SDL detected */
 #cmakedefine USE_SDL
+#endif
 
 /* Vorbis detected */
 #cmakedefine USE_VORBIS
@@ -216,7 +224,7 @@
 /* use x264 encoder */
 #cmakedefine USE_X264
 
-#if !defined(__APPLE__) || (defined(__APPLE__) && ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK)
+#if (!defined(__APPLE__) && (${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK || ${CONFIG_HEADER_TYPE} == ADM_BUILD_QT4)) || (defined(__APPLE__) && ${CONFIG_HEADER_TYPE} == ADM_BUILD_GTK)
 /* XVideo detected */
 #cmakedefine USE_XV
 #endif



From gruntster at mail.berlios.de  Thu Nov 22 17:17:03 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 22 Nov 2007 17:17:03 +0100
Subject: [Avidemux-svn-commit] r3702 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_libraries/ADM_libass cmake
Message-ID: <200711221617.lAMGH37F021297@sheep.berlios.de>

Author: gruntster
Date: 2007-11-22 17:14:05 +0100 (Thu, 22 Nov 2007)
New Revision: 3702

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
Log:
[CMake] fixes mainly for Mac

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-22 12:38:20 UTC (rev 3701)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-22 16:14:05 UTC (rev 3702)
@@ -7,4 +7,8 @@
 
 	ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
 	ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} ${FREETYPE2_CFLAGS})
+
+	IF (USE_FONTCONFIG)
+		ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} ${FONTCONFIG_CFLAGS})
+	ENDIF (USE_FONTCONFIG)
 ENDIF (USE_FREETYPE)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-22 12:38:20 UTC (rev 3701)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-22 16:14:05 UTC (rev 3702)
@@ -13,7 +13,7 @@
 	ENDIF (ADM_UI_QT4)
 ENDMACRO (ADD_ADMLIB_ALL_TARGETS)
 
-MACRO (ADD_LIB_ALL_TARGETS _libName)
+MACRO (ADD_LIB_ALL_TARGETS)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${ARGV})
   
 	IF (ADM_UI_GTK)
@@ -40,6 +40,10 @@
 INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
 INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec)
 
+IF (GETTEXT_FOUND)
+	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
+ENDIF (GETTEXT_FOUND)
+
 ########################################
 # Our exectuables
 ########################################
@@ -186,8 +190,8 @@
 ENDFOREACH(_current ${ADM_SUBDIR})
 
 IF (ADM_OS_DARWIN AND USE_SDL)
-	ADD_ADM_LIB_GTK_TARGET(ADM_libsdl)
-	ADD_ADM_LIB_QT4_TARGET(ADM_libsdl)
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_libsdl_gtk)
+	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_libsdl_qt4)
 ENDIF (ADM_OS_DARWIN AND USE_SDL)
 
 ###########################################
@@ -238,7 +242,6 @@
 
 # gettext
 IF (GETTEXT_FOUND)
-	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${GETTEXT_LIBRARY_DIR})
 
 	IF (GTK_FOUND)
@@ -248,12 +251,12 @@
 
 # Freetype2
 IF (USE_FREETYPE)
-	ADD_LIB_ALL_TARGETS("${FREETYPE2_LDFLAGS}")
+	ADD_LIB_ALL_TARGETS(${FREETYPE2_LDFLAGS})
 ENDIF (USE_FREETYPE)
 
 # FontConfig
 IF (USE_FONTCONFIG)
-	ADD_LIB_ALL_TARGETS("${FONTCONFIG_LIBRARY_DIR}")
+	ADD_LIB_ALL_TARGETS(${FONTCONFIG_LDFLAGS})
 ENDIF (USE_FONTCONFIG)
 
 # PNG
@@ -278,13 +281,13 @@
 
 # XVideo
 IF (USE_XV)
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${X11_LIBRARIES})
+	TARGET_LINK_LIBRARIES(avidemux2_gtk ${XVIDEO_LIBRARY_DIR})
+
 	IF (NOT ADM_OS_DARWIN)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${X11_LIBRARIES})
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${XVIDEO_LIBRARY_DIR})
+		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${X11_LIBRARIES})
+		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${XVIDEO_LIBRARY_DIR})
 	ENDIF (NOT ADM_OS_DARWIN)
-
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${X11_LIBRARIES})
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${XVIDEO_LIBRARY_DIR})
 ENDIF (USE_XV)
 
 # SDL

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-22 12:38:20 UTC (rev 3701)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-22 16:14:05 UTC (rev 3702)
@@ -18,8 +18,7 @@
 				AFTEN_TEST_COMPILE_RESULT
 				${CMAKE_BINARY_DIR}
 				"${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp"
-				CMAKE_FLAGS "-DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR}"
-				COMPILE_DEFINITIONS "-I${AFTEN_INCLUDE_DIR}")
+				CMAKE_FLAGS "-DINCLUDE_DIRECTORIES=${AFTEN_INCLUDE_DIR}" "-DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR}")
 		ENDIF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
 
 		IF (AFTEN_TEST_RUN_RESULT EQUAL 8)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-22 12:38:20 UTC (rev 3701)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-22 16:14:05 UTC (rev 3702)
@@ -7,8 +7,8 @@
 MESSAGE(STATUS "***********************")
 
 IF (FONTCONFIG)
-	FIND_HEADER_AND_LIB(FONTCONFIG fontconfig/fontconfig.h fontconfig FcStrSetCreate)
-	PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_INCLUDE_DIR}" "${FONTCONFIG_LIBRARY_DIR}")
+	PKG_CHECK_MODULES(FONTCONFIG fontconfig)
+	PRINT_LIBRARY_INFO("FontConfig" FONTCONFIG_FOUND "${FONTCONFIG_CFLAGS}" "${FONTCONFIG_LDFLAGS}")
 
 	IF (FONTCONFIG_FOUND)
 		SET(HAVE_FONTCONFIG 1)
@@ -55,7 +55,7 @@
 
 	IF (GETTEXT_INCLUDE_DIR)
 		# Try linking without -lintl
-		ADM_COMPILE(gettext.cpp "" "-I${GETTEXT_INCLUDE_DIR}" "" LIBINTL_NOT_REQUIRED outputWithoutLibintl)
+		ADM_COMPILE(gettext.cpp "" "${GETTEXT_INCLUDE_DIR}" "" LIBINTL_NOT_REQUIRED outputWithoutLibintl)
 
 		IF (LIBINTL_NOT_REQUIRED)
 			SET(GETTEXT_LIBRARY_DIR "")
@@ -63,7 +63,7 @@
 
 			MESSAGE(STATUS "libintl not required for gettext support")
 		ELSE (LIBINTL_NOT_REQUIRED)
-			ADM_COMPILE(gettext.cpp "" "-I${GETTEXT_INCLUDE_DIR}" "${GETTEXT_LIBRARY_DIR}" LIBINTL_REQUIRED outputWithLibintl)
+			ADM_COMPILE(gettext.cpp "" "${GETTEXT_INCLUDE_DIR}" "${GETTEXT_LIBRARY_DIR}" LIBINTL_REQUIRED outputWithLibintl)
 
 			IF (LIBINTL_REQUIRED)
 				SET(HAVE_GETTEXT 1)



From gruntster at mail.berlios.de  Fri Nov 23 13:42:45 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 23 Nov 2007 13:42:45 +0100
Subject: [Avidemux-svn-commit] r3703 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200711231242.lANCgjxk016942@sheep.berlios.de>

Author: gruntster
Date: 2007-11-23 13:42:34 +0100 (Fri, 23 Nov 2007)
New Revision: 3703

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
Log:
[CMake] flatten ld flags

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-22 16:14:05 UTC (rev 3702)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-23 12:42:34 UTC (rev 3703)
@@ -13,18 +13,33 @@
 	ENDIF (ADM_UI_QT4)
 ENDMACRO (ADD_ADMLIB_ALL_TARGETS)
 
+
 MACRO (ADD_LIB_ALL_TARGETS)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${ARGV})
-  
+
 	IF (ADM_UI_GTK)
 		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ARGV})
 	ENDIF (ADM_UI_GTK)
-	
+
 	IF (ADM_UI_QT4)
 		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ARGV})
 	ENDIF (ADM_UI_QT4)
 ENDMACRO (ADD_LIB_ALL_TARGETS)
 
+
+MACRO (ADD_LDFLAGS_ALL_TARGETS)
+	ADD_TARGET_LDFLAGS(avidemux2_cli ${ARGV})
+
+	IF (ADM_UI_GTK)
+		ADD_TARGET_LDFLAGS(avidemux2_gtk ${ARGV})
+	ENDIF (ADM_UI_GTK)
+
+	IF (ADM_UI_QT4)
+		ADD_TARGET_LDFLAGS(avidemux2_qt4 ${ARGV})
+	ENDIF (ADM_UI_QT4)
+ENDMACRO (ADD_LDFLAGS_ALL_TARGETS)
+
+
 ########################################
 # Definitions and Includes
 ########################################
@@ -207,7 +222,7 @@
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFiltersNone_cli)
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogGuiNone_cli)
 
-IF (GTK_FOUND)
+IF (ADM_UI_GTK)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_UI_GTK_gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI_gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr_gtk)
@@ -218,9 +233,9 @@
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_gui2Gtk_gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_toolkitGtk_gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI_gtk)
-ENDIF (GTK_FOUND)
+ENDIF (ADM_UI_GTK)
 
-IF (QT4_FOUND)
+IF (ADM_UI_QT4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_UI_QT4_qt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI_qt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_ocr_qt4)
@@ -230,7 +245,7 @@
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_guiQt4_qt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_filtersQt4_qt4)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI_qt4)
-ENDIF (QT4_FOUND)
+ENDIF (ADM_UI_QT4)
 
 ADD_ADMLIB_ALL_TARGETS(ADM_utilities)
 
@@ -244,36 +259,36 @@
 IF (GETTEXT_FOUND)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${GETTEXT_LIBRARY_DIR})
 
-	IF (GTK_FOUND)
+	IF (ADM_UI_GTK)
 		TARGET_LINK_LIBRARIES(avidemux2_gtk ${GETTEXT_LIBRARY_DIR})
-	ENDIF (GTK_FOUND)
+	ENDIF (ADM_UI_GTK)
 ENDIF (GETTEXT_FOUND)
 
 # Freetype2
 IF (USE_FREETYPE)
-	ADD_LIB_ALL_TARGETS(${FREETYPE2_LDFLAGS})
+	ADD_LDFLAGS_ALL_TARGETS(${FREETYPE2_LDFLAGS})
 ENDIF (USE_FREETYPE)
 
 # FontConfig
 IF (USE_FONTCONFIG)
-	ADD_LIB_ALL_TARGETS(${FONTCONFIG_LDFLAGS})
+	ADD_LDFLAGS_ALL_TARGETS(${FONTCONFIG_LDFLAGS})
 ENDIF (USE_FONTCONFIG)
 
 # PNG
 IF (USE_PNG)
 	TARGET_LINK_LIBRARIES(avidemux2_cli ${PNG_LIBRARIES})
 	
-	IF (GTK_FOUND)
+	IF (ADM_UI_GTK)
 		TARGET_LINK_LIBRARIES(avidemux2_gtk ${PNG_LIBRARIES})
-	ENDIF (GTK_FOUND)
+	ENDIF (ADM_UI_GTK)
 	
-	IF (QT4_FOUND)
+	IF (ADM_UI_QT4)
 		IF (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
 			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
 		ELSEIF (NOT ADM_OS_DARWIN)
 			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
 		ENDIF (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
-	ENDIF (QT4_FOUND)
+	ENDIF (ADM_UI_QT4)
 ENDIF (USE_PNG)
 
 # Libxml2
@@ -281,13 +296,15 @@
 
 # XVideo
 IF (USE_XV)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${X11_LIBRARIES})
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${XVIDEO_LIBRARY_DIR})
+	IF (ADM_UI_GTK)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${X11_LIBRARIES})
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${XVIDEO_LIBRARY_DIR})
+	ENDIF (ADM_UI_GTK)
 
-	IF (NOT ADM_OS_DARWIN)
+	IF (ADM_UI_QT4 AND NOT ADM_OS_DARWIN)
 		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${X11_LIBRARIES})
 		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${XVIDEO_LIBRARY_DIR})
-	ENDIF (NOT ADM_OS_DARWIN)
+	ENDIF (ADM_UI_QT4 AND NOT ADM_OS_DARWIN)
 ENDIF (USE_XV)
 
 # SDL
@@ -297,20 +314,35 @@
 
 # aRts
 IF (USE_ARTS)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ARTS_LDFLAGS})
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ARTS_LDFLAGS})
+	IF (ADM_UI_GTK)
+		ADD_TARGET_LDFLAGS(avidemux2_gtk ${ARTS_LDFLAGS})
+	ENDIF (ADM_UI_GTK)
+
+	IF (ADM_UI_QT4)
+		ADD_TARGET_LDFLAGS(avidemux2_qt4 ${ARTS_LDFLAGS})
+	ENDIF (ADM_UI_QT4)
 ENDIF (USE_ARTS)
 
 # ALSA
 IF (ALSA_FOUND)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ASOUND_LIBRARY})
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ASOUND_LIBRARY})
+	IF (ADM_UI_GTK)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ASOUND_LIBRARY})
+	ENDIF (ADM_UI_GTK)
+
+	IF (ADM_UI_QT4)
+		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ASOUND_LIBRARY})
+	ENDIF (ADM_UI_QT4)
 ENDIF (ALSA_FOUND)
 
 # ESD
 IF (USE_ESD)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${ESD_LIBRARY_DIR})
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ESD_LIBRARY_DIR})
+	IF (ADM_UI_GTK)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ESD_LIBRARY_DIR})
+	ENDIF (ADM_UI_GTK)
+
+	IF (ADM_UI_QT4)
+		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${ESD_LIBRARY_DIR})
+	ENDIF (ADM_UI_QT4)
 ENDIF (USE_ESD)
 
 # JACK
@@ -372,16 +404,16 @@
 ###########################################
 # UI Specific
 ###########################################
-TARGET_LINK_LIBRARIES(avidemux2_cli ${GLIB_LDFLAGS})
+ADD_TARGET_LDFLAGS(avidemux2_cli ${GLIB_LDFLAGS})
 
-IF (GTK_FOUND)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
-ENDIF (GTK_FOUND)
+IF (ADM_UI_GTK)
+	ADD_TARGET_LDFLAGS(avidemux2_gtk ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
+ENDIF (ADM_UI_GTK)
 
-IF (QT4_FOUND)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${GLIB_LDFLAGS})
+IF (ADM_UI_QT4)
+	ADD_TARGET_LDFLAGS(avidemux2_qt4 ${GLIB_LDFLAGS})
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
-ENDIF (QT4_FOUND)
+ENDIF (ADM_UI_QT4)
 
 ###########################################
 # OS Specific
@@ -405,13 +437,13 @@
 ###########################################
 SET(ADM_EXES avidemux2_cli)
 
-IF (GTK_FOUND)
+IF (ADM_UI_GTK)
 	SET(ADM_EXES ${ADM_EXES} avidemux2_gtk)
-ENDIF (GTK_FOUND)
+ENDIF (ADM_UI_GTK)
 
-IF (QT4_FOUND)
+IF (ADM_UI_QT4)
 	SET(ADM_EXES ${ADM_EXES} avidemux2_qt4)
-ENDIF (QT4_FOUND)
+ENDIF (ADM_UI_QT4)
 
 INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION bin LIBRARY DESTINATION lib)
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-22 16:14:05 UTC (rev 3702)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-23 12:42:34 UTC (rev 3703)
@@ -3,8 +3,14 @@
 		MESSAGE(STATUS "Found ${libraryName}")
 
 		IF (VERBOSE)
-			MESSAGE(STATUS "Compiler Flags: ${compilerFlags}")
-			MESSAGE(STATUS "Linker Flags  : ${linkerFlags}")
+			SET(_compilerFlags "")
+			APPEND_FLAGS(_compilerFlags ${compilerFlags})
+
+			SET(_linkerFlags "")
+			APPEND_FLAGS(_linkerFlags ${linkerFlags})
+
+			MESSAGE(STATUS "Compiler Flags:${_compilerFlags}")
+			MESSAGE(STATUS "Linker Flags  :${_linkerFlags}")
 		ENDIF (VERBOSE)
 	ELSE (${libraryDetected})
 		MESSAGE(${ARGV4} "Could not find ${libraryName}")
@@ -124,34 +130,28 @@
 ENDMACRO (CHECK_CFLAGS_REQUIRED)
 
 
-MACRO (APPEND_FLAGS _flags _varToAppend)
-	IF (${_flags})
-		SET(${_flags} "${${_flags}} ${_varToAppend}")
-	ELSE (${_flags})
-		SET(${_flags} "${_varToAppend}")
-	ENDIF (${_flags})
+MACRO (APPEND_FLAGS _flags)
+	IF (NOT ${_flags})
+		SET(${_flags} "")
+	ENDIF (NOT ${_flags})
+
+	FOREACH (_flag ${ARGN})
+		SET(${_flags} "${${_flags}} ${_flag}")
+	ENDFOREACH (_flag ${ARGN})
 ENDMACRO (APPEND_FLAGS)
 
 
 #ARGV1 = flags
 MACRO (ADD_SOURCE_CFLAGS _target)
 	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
-
-	FOREACH (_flg ${ARGN})
-		APPEND_FLAGS(_flags "${_flg}")
-	ENDFOREACH (_flg ${ARGN})
-
+	APPEND_FLAGS(_flags ${ARGN})
 	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")   
 ENDMACRO (ADD_SOURCE_CFLAGS)
 
 
 MACRO (ADD_TARGET_CFLAGS _target)
 	GET_TARGET_PROPERTY(_flags ${_target} COMPILE_FLAGS)
-
-	FOREACH (_flg ${ARGN})
-		APPEND_FLAGS(_flags "${_flg}")
-	ENDFOREACH (_flg ${ARGN})
-
+	APPEND_FLAGS(_flags ${ARGN})
 	SET_TARGET_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS "${_flags}")
 ENDMACRO (ADD_TARGET_CFLAGS)
 
@@ -203,4 +203,12 @@
 	ADD_ADM_LIB_CLI_TARGET(${_libName} ${ARGN})
 	ADD_ADM_LIB_GTK_TARGET(${_libName} ${ARGN})
 	ADD_ADM_LIB_QT4_TARGET(${_libName} ${ARGN})
-ENDMACRO (ADD_ADM_LIB_ALL_TARGETS)
\ No newline at end of file
+ENDMACRO (ADD_ADM_LIB_ALL_TARGETS)
+
+
+MACRO (ADD_TARGET_LDFLAGS _target)
+	SET(_flags)
+	APPEND_FLAGS(_flags ${ARGN})
+
+	TARGET_LINK_LIBRARIES(${_target} ${_flags})
+ENDMACRO (ADD_TARGET_LDFLAGS)
\ No newline at end of file



From mean at mail.berlios.de  Sun Nov 25 11:18:11 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 25 Nov 2007 11:18:11 +0100
Subject: [Avidemux-svn-commit] r3704 -
	branches/avidemux_2.4_branch/avidemux/ADM_codecs
Message-ID: <200711251018.lAPAIBsi000948@sheep.berlios.de>

Author: mean
Date: 2007-11-25 11:18:10 +0100 (Sun, 25 Nov 2007)
New Revision: 3704

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
Log:
[Codec] Fix memleak 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-11-23 12:42:34 UTC (rev 3703)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-11-25 10:18:10 UTC (rev 3704)
@@ -54,9 +54,8 @@
 uint8_t ffmpegEncoder::stopEncoder(void)
 {
     printf("[lavc] stopEncoder (%x)\n",_context);
-    if (_init)
+    if (_context)
     {
-        _init = 0;
         avcodec_close (_context);
         ADM_dealloc (_context);
         _context = NULL;



From mean at mail.berlios.de  Sun Nov 25 14:47:15 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 25 Nov 2007 14:47:15 +0100
Subject: [Avidemux-svn-commit] r3705 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_filter
	ADM_userInterfaces/ADM_QT4/ADM_gui ADM_userInterfaces/ADM_commonUI
Message-ID: <200711251347.lAPDlFMj014686@sheep.berlios.de>

Author: mean
Date: 2007-11-25 14:47:14 +0100 (Sun, 25 Nov 2007)
New Revision: 3705

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h
   branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
Log:
[Sikon] Add 640*480 profile for Ipod

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp	2007-11-25 13:47:14 UTC (rev 3705)
@@ -73,11 +73,13 @@
 static targetFmt PSP={480, 480, 272, 272};
 static targetFmt PSPH264={720, 720, 480, 480};
 static targetFmt IPOD={320, 320, 240, 240};
+static targetFmt IPOD640={640, 640, 480, 480};
+
 /* Dont forget to update DIA_resizeWiz if you change something here */
 
-targetFmt *allFormats[7]={&VCD,&SVCD,&DVD,&DVDHD1,&PSP,&PSPH264,&IPOD};
+targetFmt *allFormats[]={&VCD,&SVCD,&DVD,&DVDHD1,&PSP,&PSPH264,&IPOD,&IPOD640};
 extern AVDMGenericVideoStream *createResampleFps(AVDMGenericVideoStream *in,uint32_t targetfps1000);
-#define ARME(x) format=RESWIZ_##x;
+#define ARME(x) format=RESWIZ_##x
 
 uint8_t setVCD (void)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.h	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.h	2007-11-25 13:47:14 UTC (rev 3705)
@@ -26,6 +26,6 @@
 uint8_t setPSPFullRes(void);
 uint8_t setDVD( void );
 uint8_t setHalfD1( void );
-uint8_t setIPOD( void );
+uint8_t setIPOD( void);
 
-#endif
\ No newline at end of file
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-11-25 13:47:14 UTC (rev 3705)
@@ -7,7 +7,7 @@
     <x>0</x>
     <y>0</y>
     <width>838</width>
-    <height>543</height>
+    <height>568</height>
    </rect>
   </property>
   <property name="windowTitle" >
@@ -24,42 +24,76 @@
   </property>
   <widget class="QWidget" name="centralwidget" >
    <layout class="QVBoxLayout" >
-    <property name="margin" >
-     <number>9</number>
-    </property>
     <property name="spacing" >
      <number>6</number>
     </property>
+    <property name="leftMargin" >
+     <number>9</number>
+    </property>
+    <property name="topMargin" >
+     <number>9</number>
+    </property>
+    <property name="rightMargin" >
+     <number>9</number>
+    </property>
+    <property name="bottomMargin" >
+     <number>9</number>
+    </property>
     <item>
      <layout class="QHBoxLayout" >
-      <property name="margin" >
-       <number>0</number>
-      </property>
       <property name="spacing" >
        <number>6</number>
       </property>
+      <property name="leftMargin" >
+       <number>0</number>
+      </property>
+      <property name="topMargin" >
+       <number>0</number>
+      </property>
+      <property name="rightMargin" >
+       <number>0</number>
+      </property>
+      <property name="bottomMargin" >
+       <number>0</number>
+      </property>
       <item>
        <layout class="QVBoxLayout" >
-        <property name="margin" >
-         <number>0</number>
-        </property>
         <property name="spacing" >
          <number>6</number>
         </property>
+        <property name="leftMargin" >
+         <number>0</number>
+        </property>
+        <property name="topMargin" >
+         <number>0</number>
+        </property>
+        <property name="rightMargin" >
+         <number>0</number>
+        </property>
+        <property name="bottomMargin" >
+         <number>0</number>
+        </property>
         <item>
          <layout class="QVBoxLayout" >
-          <property name="margin" >
+          <property name="spacing" >
            <number>0</number>
           </property>
-          <property name="spacing" >
+          <property name="leftMargin" >
            <number>0</number>
           </property>
+          <property name="topMargin" >
+           <number>0</number>
+          </property>
+          <property name="rightMargin" >
+           <number>0</number>
+          </property>
+          <property name="bottomMargin" >
+           <number>0</number>
+          </property>
           <item>
            <widget class="QLabel" name="label_3" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>5</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Preferred" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -96,12 +130,21 @@
           </item>
           <item>
            <layout class="QHBoxLayout" >
-            <property name="margin" >
+            <property name="spacing" >
              <number>0</number>
             </property>
-            <property name="spacing" >
+            <property name="leftMargin" >
              <number>0</number>
             </property>
+            <property name="topMargin" >
+             <number>0</number>
+            </property>
+            <property name="rightMargin" >
+             <number>0</number>
+            </property>
+            <property name="bottomMargin" >
+             <number>0</number>
+            </property>
             <item>
              <spacer>
               <property name="orientation" >
@@ -120,18 +163,25 @@
             </item>
             <item>
              <layout class="QVBoxLayout" >
-              <property name="margin" >
-               <number>0</number>
-              </property>
               <property name="spacing" >
                <number>6</number>
               </property>
+              <property name="leftMargin" >
+               <number>0</number>
+              </property>
+              <property name="topMargin" >
+               <number>0</number>
+              </property>
+              <property name="rightMargin" >
+               <number>0</number>
+              </property>
+              <property name="bottomMargin" >
+               <number>0</number>
+              </property>
               <item>
                <widget class="QComboBox" name="comboBoxVideo" >
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -149,9 +199,7 @@
                  <bool>true</bool>
                 </property>
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -167,9 +215,7 @@
                  <bool>true</bool>
                 </property>
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -202,9 +248,7 @@
           <item>
            <widget class="QLabel" name="label_5" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>5</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Preferred" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -241,12 +285,21 @@
           </item>
           <item>
            <layout class="QHBoxLayout" >
-            <property name="margin" >
+            <property name="spacing" >
              <number>0</number>
             </property>
-            <property name="spacing" >
+            <property name="leftMargin" >
              <number>0</number>
             </property>
+            <property name="topMargin" >
+             <number>0</number>
+            </property>
+            <property name="rightMargin" >
+             <number>0</number>
+            </property>
+            <property name="bottomMargin" >
+             <number>0</number>
+            </property>
             <item>
              <spacer>
               <property name="orientation" >
@@ -265,18 +318,25 @@
             </item>
             <item>
              <layout class="QVBoxLayout" >
-              <property name="margin" >
-               <number>0</number>
-              </property>
               <property name="spacing" >
                <number>6</number>
               </property>
+              <property name="leftMargin" >
+               <number>0</number>
+              </property>
+              <property name="topMargin" >
+               <number>0</number>
+              </property>
+              <property name="rightMargin" >
+               <number>0</number>
+              </property>
+              <property name="bottomMargin" >
+               <number>0</number>
+              </property>
               <item>
                <widget class="QComboBox" name="comboBoxAudio" >
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -294,9 +354,7 @@
                  <bool>true</bool>
                 </property>
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -312,9 +370,7 @@
                  <bool>true</bool>
                 </property>
                 <property name="sizePolicy" >
-                 <sizepolicy>
-                  <hsizetype>1</hsizetype>
-                  <vsizetype>0</vsizetype>
+                 <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                   <horstretch>0</horstretch>
                   <verstretch>0</verstretch>
                  </sizepolicy>
@@ -326,12 +382,21 @@
               </item>
               <item>
                <layout class="QHBoxLayout" >
-                <property name="margin" >
-                 <number>0</number>
-                </property>
                 <property name="spacing" >
                  <number>6</number>
                 </property>
+                <property name="leftMargin" >
+                 <number>0</number>
+                </property>
+                <property name="topMargin" >
+                 <number>0</number>
+                </property>
+                <property name="rightMargin" >
+                 <number>0</number>
+                </property>
+                <property name="bottomMargin" >
+                 <number>0</number>
+                </property>
                 <item>
                  <widget class="QCheckBox" name="checkBox_TimeShift" >
                   <property name="text" >
@@ -342,19 +407,17 @@
                 <item>
                  <widget class="QSpinBox" name="spinBox_TimeValue" >
                   <property name="sizePolicy" >
-                   <sizepolicy>
-                    <hsizetype>1</hsizetype>
-                    <vsizetype>0</vsizetype>
+                   <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                     <horstretch>0</horstretch>
                     <verstretch>0</verstretch>
                    </sizepolicy>
                   </property>
+                  <property name="minimum" >
+                   <number>-99999</number>
+                  </property>
                   <property name="maximum" >
                    <number>99999</number>
                   </property>
-                  <property name="minimum" >
-                   <number>-99999</number>
-                  </property>
                  </widget>
                 </item>
                </layout>
@@ -382,9 +445,7 @@
           <item>
            <widget class="QLabel" name="label_4" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>5</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Preferred" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -415,12 +476,21 @@
           </item>
           <item>
            <layout class="QHBoxLayout" >
-            <property name="margin" >
+            <property name="spacing" >
              <number>0</number>
             </property>
-            <property name="spacing" >
+            <property name="leftMargin" >
              <number>0</number>
             </property>
+            <property name="topMargin" >
+             <number>0</number>
+            </property>
+            <property name="rightMargin" >
+             <number>0</number>
+            </property>
+            <property name="bottomMargin" >
+             <number>0</number>
+            </property>
             <item>
              <spacer>
               <property name="orientation" >
@@ -440,9 +510,7 @@
             <item>
              <widget class="QComboBox" name="comboBoxFormat" >
               <property name="sizePolicy" >
-               <sizepolicy>
-                <hsizetype>1</hsizetype>
-                <vsizetype>0</vsizetype>
+               <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
                 <horstretch>0</horstretch>
                 <verstretch>0</verstretch>
                </sizepolicy>
@@ -473,18 +541,25 @@
       </item>
       <item>
        <layout class="QHBoxLayout" >
-        <property name="margin" >
-         <number>0</number>
-        </property>
         <property name="spacing" >
          <number>6</number>
         </property>
+        <property name="leftMargin" >
+         <number>0</number>
+        </property>
+        <property name="topMargin" >
+         <number>0</number>
+        </property>
+        <property name="rightMargin" >
+         <number>0</number>
+        </property>
+        <property name="bottomMargin" >
+         <number>0</number>
+        </property>
         <item>
          <widget class="QFrame" name="frame_video" >
           <property name="sizePolicy" >
-           <sizepolicy>
-            <hsizetype>7</hsizetype>
-            <vsizetype>7</vsizetype>
+           <sizepolicy vsizetype="Expanding" hsizetype="Expanding" >
             <horstretch>0</horstretch>
             <verstretch>0</verstretch>
            </sizepolicy>
@@ -531,20 +606,38 @@
     </item>
     <item>
      <layout class="QHBoxLayout" >
-      <property name="margin" >
-       <number>0</number>
-      </property>
       <property name="spacing" >
        <number>6</number>
       </property>
+      <property name="leftMargin" >
+       <number>0</number>
+      </property>
+      <property name="topMargin" >
+       <number>0</number>
+      </property>
+      <property name="rightMargin" >
+       <number>0</number>
+      </property>
+      <property name="bottomMargin" >
+       <number>0</number>
+      </property>
       <item>
        <layout class="QVBoxLayout" >
-        <property name="margin" >
-         <number>0</number>
-        </property>
         <property name="spacing" >
          <number>6</number>
         </property>
+        <property name="leftMargin" >
+         <number>0</number>
+        </property>
+        <property name="topMargin" >
+         <number>0</number>
+        </property>
+        <property name="rightMargin" >
+         <number>0</number>
+        </property>
+        <property name="bottomMargin" >
+         <number>0</number>
+        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -564,9 +657,7 @@
         <item>
          <widget class="ADM_QSlider" name="horizontalSlider" >
           <property name="sizePolicy" >
-           <sizepolicy>
-            <hsizetype>7</hsizetype>
-            <vsizetype>0</vsizetype>
+           <sizepolicy vsizetype="Fixed" hsizetype="Expanding" >
             <horstretch>0</horstretch>
             <verstretch>0</verstretch>
            </sizepolicy>
@@ -578,12 +669,21 @@
         </item>
         <item>
          <layout class="QHBoxLayout" >
-          <property name="margin" >
-           <number>0</number>
-          </property>
           <property name="spacing" >
            <number>6</number>
           </property>
+          <property name="leftMargin" >
+           <number>0</number>
+          </property>
+          <property name="topMargin" >
+           <number>0</number>
+          </property>
+          <property name="rightMargin" >
+           <number>0</number>
+          </property>
+          <property name="bottomMargin" >
+           <number>0</number>
+          </property>
           <item>
            <widget class="QToolButton" name="toolButtonPlay" >
             <property name="text" >
@@ -829,18 +929,25 @@
         </item>
         <item>
          <layout class="QHBoxLayout" >
-          <property name="margin" >
-           <number>0</number>
-          </property>
           <property name="spacing" >
            <number>6</number>
           </property>
+          <property name="leftMargin" >
+           <number>0</number>
+          </property>
+          <property name="topMargin" >
+           <number>0</number>
+          </property>
+          <property name="rightMargin" >
+           <number>0</number>
+          </property>
+          <property name="bottomMargin" >
+           <number>0</number>
+          </property>
           <item>
            <widget class="QLabel" name="label" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>1</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Minimum" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -864,9 +971,7 @@
           <item>
            <widget class="QLineEdit" name="lineEdit" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>0</hsizetype>
-              <vsizetype>0</vsizetype>
+             <sizepolicy vsizetype="Fixed" hsizetype="Fixed" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -900,9 +1005,7 @@
           <item>
            <widget class="QLabel" name="label_2" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>1</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Minimum" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -931,9 +1034,7 @@
           <item>
            <widget class="QLabel" name="label_6" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>1</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Minimum" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -957,9 +1058,7 @@
           <item>
            <widget class="QLineEdit" name="lineEdit_2" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>0</hsizetype>
-              <vsizetype>0</vsizetype>
+             <sizepolicy vsizetype="Fixed" hsizetype="Fixed" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -981,9 +1080,7 @@
           <item>
            <widget class="QLabel" name="label_7" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>1</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Minimum" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -1030,9 +1127,7 @@
           <item>
            <widget class="QLabel" name="label_8" >
             <property name="sizePolicy" >
-             <sizepolicy>
-              <hsizetype>1</hsizetype>
-              <vsizetype>5</vsizetype>
+             <sizepolicy vsizetype="Preferred" hsizetype="Minimum" >
               <horstretch>0</horstretch>
               <verstretch>0</verstretch>
              </sizepolicy>
@@ -1077,12 +1172,21 @@
       </item>
       <item>
        <layout class="QVBoxLayout" >
-        <property name="margin" >
-         <number>0</number>
-        </property>
         <property name="spacing" >
          <number>6</number>
         </property>
+        <property name="leftMargin" >
+         <number>0</number>
+        </property>
+        <property name="topMargin" >
+         <number>0</number>
+        </property>
+        <property name="rightMargin" >
+         <number>0</number>
+        </property>
+        <property name="bottomMargin" >
+         <number>0</number>
+        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -1102,9 +1206,7 @@
         <item>
          <widget class="QGroupBox" name="groupBox" >
           <property name="sizePolicy" >
-           <sizepolicy>
-            <hsizetype>1</hsizetype>
-            <vsizetype>1</vsizetype>
+           <sizepolicy vsizetype="Minimum" hsizetype="Minimum" >
             <horstretch>0</horstretch>
             <verstretch>0</verstretch>
            </sizepolicy>
@@ -1190,9 +1292,7 @@
             </rect>
            </property>
            <property name="sizePolicy" >
-            <sizepolicy>
-             <hsizetype>1</hsizetype>
-             <vsizetype>0</vsizetype>
+            <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
              <horstretch>0</horstretch>
              <verstretch>0</verstretch>
             </sizepolicy>
@@ -1222,9 +1322,7 @@
             </rect>
            </property>
            <property name="sizePolicy" >
-            <sizepolicy>
-             <hsizetype>1</hsizetype>
-             <vsizetype>0</vsizetype>
+            <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
              <horstretch>0</horstretch>
              <verstretch>0</verstretch>
             </sizepolicy>
@@ -1269,12 +1367,21 @@
       </item>
       <item>
        <layout class="QVBoxLayout" >
-        <property name="margin" >
-         <number>0</number>
-        </property>
         <property name="spacing" >
          <number>4</number>
         </property>
+        <property name="leftMargin" >
+         <number>0</number>
+        </property>
+        <property name="topMargin" >
+         <number>0</number>
+        </property>
+        <property name="rightMargin" >
+         <number>0</number>
+        </property>
+        <property name="bottomMargin" >
+         <number>0</number>
+        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -1313,9 +1420,7 @@
         <item>
          <widget class="QSlider" name="horizontalSlider_2" >
           <property name="sizePolicy" >
-           <sizepolicy>
-            <hsizetype>5</hsizetype>
-            <vsizetype>1</vsizetype>
+           <sizepolicy vsizetype="Minimum" hsizetype="Preferred" >
             <horstretch>0</horstretch>
             <verstretch>0</verstretch>
            </sizepolicy>
@@ -1349,7 +1454,7 @@
      <x>0</x>
      <y>0</y>
      <width>838</width>
-     <height>23</height>
+     <height>25</height>
     </rect>
    </property>
    <widget class="QMenu" name="menuHelp" >
@@ -1507,6 +1612,7 @@
     <addaction name="actionPSP" />
     <addaction name="actionPSP_H264" />
     <addaction name="actionFLV" />
+    <addaction name="actionIPOD" />
    </widget>
    <addaction name="menuFile" />
    <addaction name="menuEdit" />
@@ -1525,8 +1631,11 @@
     <enum>Qt::Horizontal</enum>
    </property>
    <attribute name="toolBarArea" >
-    <number>4</number>
+    <enum>TopToolBarArea</enum>
    </attribute>
+   <attribute name="toolBarBreak" >
+    <bool>false</bool>
+   </attribute>
    <addaction name="separator" />
    <addaction name="actionOpen" />
    <addaction name="actionSave_video" />
@@ -1542,8 +1651,11 @@
     <enum>Qt::Horizontal</enum>
    </property>
    <attribute name="toolBarArea" >
-    <number>4</number>
+    <enum>TopToolBarArea</enum>
    </attribute>
+   <attribute name="toolBarBreak" >
+    <bool>false</bool>
+   </attribute>
    <addaction name="actionPreviewInput" />
    <addaction name="actionPreviewOutput" />
    <addaction name="actionPreviewSide" />
@@ -2378,6 +2490,11 @@
     <string>FLV</string>
    </property>
   </action>
+  <action name="actionIPOD" >
+   <property name="text" >
+    <string>IPOD (mpeg4)</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-11-25 13:47:14 UTC (rev 3705)
@@ -65,6 +65,7 @@
 PROCESS(actionPSP,ACT_AUTO_PSP) \
 PROCESS(actionFLV,ACT_AUTO_FLV) \
 PROCESS(actionPSP_H264,ACT_AUTO_PSP_H264)\
+PROCESS(actionIPOD,ACT_AUTO_IPOD) \
 PROCESS(actionAdd_to_joblist,ACT_ADD_JOB) \
 PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-11-25 13:47:14 UTC (rev 3705)
@@ -29,7 +29,7 @@
 {
 uint8_t r=0;
 #define ONELINE(x,y) {RESWIZ_##x,y,NULL}
-            diaMenuEntry menuFTarget[7]={
+            diaMenuEntry menuFTarget[]={
                              ONELINE(VCD,QT_TR_NOOP("VCD")),
                              ONELINE(SVCD,QT_TR_NOOP("SVCD")),
                              ONELINE(DVD,QT_TR_NOOP("DVD")),
@@ -37,6 +37,7 @@
                              ONELINE(PSP,QT_TR_NOOP("PSP 480*272")),
                              ONELINE(PSP_FULLRES,QT_TR_NOOP("PSP full res (720*480")),
                              ONELINE(IPOD,"IPOD 320*240"),
+                             ONELINE(IPOD640,"IPOD 640*480"),
                           };
              diaMenuEntry menuFAspect[3]={
                {RESWIZ_AR_1_1,QT_TR_NOOP("1:1"),NULL},
@@ -50,7 +51,7 @@
     uint32_t tsource=(uint32_t )*source;
     uint32_t tdestination=(uint32_t )*destination;
                           
-    diaElemMenu     menu1(&tformat,QT_TR_NOOP("_Target type:"), 7,menuFTarget);
+    diaElemMenu     menu1(&tformat,QT_TR_NOOP("_Target type:"), sizeof(menuFTarget) / sizeof(diaMenuEntry),menuFTarget);
     diaElemMenu     menu2(&tsource,QT_TR_NOOP("_Source aspect ratio:"), 3,menuFAspect);
     diaElemMenu     menu3(&tdestination,QT_TR_NOOP("_Destination aspect ratio:"), 3,menuFAspect);
     

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h	2007-11-25 13:47:14 UTC (rev 3705)
@@ -28,7 +28,8 @@
         RESWIZ_DVD_HD1,
         RESWIZ_PSP,
         RESWIZ_PSP_FULLRES,
-        RESWIZ_IPOD
+        RESWIZ_IPOD,
+        RESWIZ_IPOD640
         
 }RESWIZ_FORMAT;
 

Modified: branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2007-11-25 10:18:10 UTC (rev 3704)
+++ branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2007-11-25 13:47:14 UTC (rev 3705)
@@ -58,17 +58,20 @@
         switch(action)
         {
                 case ACT_AUTO_IPOD:
-#if  !defined(USE_XVID_4) || !defined(USE_FAAC)
+#if  !defined(USE_XVID_4) || (!defined(USE_FAAC) && !defined(HAVE_MP3LAME))
                   GUI_Error_HIG(QT_TR_NOOP("Codec Error"),
-                                        QT_TR_NOOP( "You need both Xvid4 and FAAC support for Ipod profile"));
+                                        QT_TR_NOOP( "You need Xvid4 and either LAME or FAAC support for the iPod profile"));
 #else
-                    if(!setIPOD()) return 0;
+                    if(!setIPOD())
+                    {
+                        return 0;
+                    }
                 
                     // Video codec
 
                     if(!videoCodecSelectByName("XVID4")) 
                     {
-                      GUI_Error_HIG(QT_TR_NOOP("Codec Error"),QT_TR_NOOP( "Cannot select mpeg4 sp codec."));
+                      GUI_Error_HIG(QT_TR_NOOP("Codec Error"),QT_TR_NOOP( "Cannot select the MPEG-4 SP codec."));
                         return 0;
                     }
                     setIpod_Xvid4Preset();
@@ -76,13 +79,18 @@
                     setVideoEncoderSettings(COMPRESS_CBR,400,0,NULL);
                     // Audio Codec
                     if(   (currentaudiostream->getInfo()->channels==2)&&
-                        (currentaudiostream->getInfo()->encoding==WAV_AAC))
+                        (currentaudiostream->getInfo()->encoding==WAV_AAC ||
+                         currentaudiostream->getInfo()->encoding==WAV_MP3))
                     {
                         audioCodecSetcodec(AUDIOENC_COPY);
                     }
                     else
                     {
+#if defined(USE_FAAC)
                           audioCodecSetcodec(AUDIOENC_FAAC);
+#elif defined(HAVE_MP3LAME)
+                          audioCodecSetcodec(AUDIOENC_MP3);
+#endif
                           audioFilter_SetBitrate(128);
                       }
 #endif



From mean at mail.berlios.de  Sun Nov 25 15:07:38 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 25 Nov 2007 15:07:38 +0100
Subject: [Avidemux-svn-commit] r3706 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_gui2 ADM_toolkit_gtk glade
Message-ID: <200711251407.lAPE7cNY024733@sheep.berlios.de>

Author: mean
Date: 2007-11-25 15:07:37 +0100 (Sun, 25 Nov 2007)
New Revision: 3706

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
Log:
[GTK] Put back calculator icon

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-11-25 13:47:14 UTC (rev 3705)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-11-25 14:07:37 UTC (rev 3706)
@@ -179,6 +179,7 @@
   GtkWidget *toolbuttonSave;
   GtkWidget *toolbuttonInfo;
   GtkWidget *separatortoolitem1;
+  GtkWidget *tmp_image;
   GtkWidget *toolbuttonCalc;
   GtkWidget *separatortoolitem2;
   GtkWidget *toolitem12;
@@ -993,7 +994,9 @@
   gtk_widget_show (separatortoolitem1);
   gtk_container_add (GTK_CONTAINER (toolbar2), separatortoolitem1);
 
-  toolbuttonCalc = (GtkWidget*) gtk_tool_button_new (NULL, QT_TR_NOOP("Calculator"));
+  tmp_image = create_pixmap (mainWindow, "gnome-calculator.png");
+  gtk_widget_show (tmp_image);
+  toolbuttonCalc = (GtkWidget*) gtk_tool_button_new (tmp_image, QT_TR_NOOP("Calculator"));
   gtk_widget_show (toolbuttonCalc);
   gtk_container_add (GTK_CONTAINER (toolbar2), toolbuttonCalc);
   gtk_tool_item_set_tooltip (GTK_TOOL_ITEM (toolbuttonCalc), tooltips, QT_TR_NOOP("Bitrate/size calculator"), NULL);
@@ -1195,8 +1198,8 @@
   jogg = jog_shuttle_new ();gtk_widget_set_size_request (jogg, -1, 16); 
   gtk_widget_show (jogg);
   gtk_table_attach (GTK_TABLE (table2), jogg, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_EXPAND), 0, 0);
+                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (0), 0, 0);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_FOCUS);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_DEFAULT);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp	2007-11-25 13:47:14 UTC (rev 3705)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp	2007-11-25 14:07:37 UTC (rev 3706)
@@ -96,7 +96,7 @@
 	{A_ICON_XPM,"xpm_prevblack.xpm",(void *)        xpm_prevblack},
         {A_ICON_XPM,"avidemux_icon.xpm",(void *)        avidemux_icon_xpm},
         {A_ICON_XPM,"xpm_prevblack.xpm",(void *)        xpm_prevblack},
-        {A_ICON_PNG,"gnome-calculator.xpm",(void *)     gnome_calculator},
+        {A_ICON_PNG,"gnome-calculator.png",(void *)     gnome_calculator},
         {A_ICON_PNG,"gnome-calculator_small.xpm",(void *) gnome_calculator_small},
         {A_ICON_PNG,"preview.png",(void *) preview},
         {A_ICON_PNG,"output.png",(void *) output},

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-11-25 13:47:14 UTC (rev 3705)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-11-25 14:07:37 UTC (rev 3706)
@@ -50,7 +50,7 @@
 		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8423">
+			<widget class="GtkImage" id="image8448">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-open</property>
 			  <property name="icon_size">1</property>
@@ -71,7 +71,7 @@
 		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8424">
+			<widget class="GtkImage" id="image8449">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-add</property>
 			  <property name="icon_size">1</property>
@@ -91,7 +91,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8425">
+			<widget class="GtkImage" id="image8450">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -169,7 +169,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8426">
+			<widget class="GtkImage" id="image8451">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -189,7 +189,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8427">
+			<widget class="GtkImage" id="image8452">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -209,7 +209,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8428">
+			<widget class="GtkImage" id="image8453">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-execute</property>
 			  <property name="icon_size">1</property>
@@ -267,7 +267,7 @@
 		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8429">
+			<widget class="GtkImage" id="image8454">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-properties</property>
 			  <property name="icon_size">1</property>
@@ -302,7 +302,7 @@
 		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8430">
+			<widget class="GtkImage" id="image8455">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-quit</property>
 			  <property name="icon_size">1</property>
@@ -335,7 +335,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8431">
+			<widget class="GtkImage" id="image8456">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-undo</property>
 			  <property name="icon_size">1</property>
@@ -362,7 +362,7 @@
 		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8432">
+			<widget class="GtkImage" id="image8457">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-cut</property>
 			  <property name="icon_size">1</property>
@@ -383,7 +383,7 @@
 		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8433">
+			<widget class="GtkImage" id="image8458">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-copy</property>
 			  <property name="icon_size">1</property>
@@ -404,7 +404,7 @@
 		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8434">
+			<widget class="GtkImage" id="image8459">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-paste</property>
 			  <property name="icon_size">1</property>
@@ -425,7 +425,7 @@
 		      <accelerator key="Delete" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8435">
+			<widget class="GtkImage" id="image8460">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-remove</property>
 			  <property name="icon_size">1</property>
@@ -475,7 +475,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8436">
+			<widget class="GtkImage" id="image8461">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-preferences</property>
 			  <property name="icon_size">1</property>
@@ -702,7 +702,7 @@
 		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8437">
+			<widget class="GtkImage" id="image8462">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -753,7 +753,7 @@
 		      <accelerator key="F7" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8438">
+			<widget class="GtkImage" id="image8463">
 			  <property name="visible">True</property>
 			  <property name="pixbuf">gnome-calculator_small.xpm</property>
 			  <property name="xalign">0.5</property>
@@ -907,6 +907,22 @@
 		      <property name="use_underline">True</property>
 		    </widget>
 		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="flv1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">F_LV</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
+		    <widget class="GtkMenuItem" id="Ipod">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">IPOD (mpeg4)</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
 		</widget>
 	      </child>
 	    </widget>
@@ -929,7 +945,7 @@
 		      <accelerator key="P" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8439">
+			<widget class="GtkImage" id="image8464">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-play</property>
 			  <property name="icon_size">1</property>
@@ -950,7 +966,7 @@
 		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8440">
+			<widget class="GtkImage" id="image8465">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-previous</property>
 			  <property name="icon_size">1</property>
@@ -971,7 +987,7 @@
 		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8441">
+			<widget class="GtkImage" id="image8466">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-next</property>
 			  <property name="icon_size">1</property>
@@ -992,7 +1008,7 @@
 		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8442">
+			<widget class="GtkImage" id="image8467">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-rewind</property>
 			  <property name="icon_size">1</property>
@@ -1013,7 +1029,7 @@
 		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8443">
+			<widget class="GtkImage" id="image8468">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-forward</property>
 			  <property name="icon_size">1</property>
@@ -1050,7 +1066,7 @@
 		      <accelerator key="Home" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8444">
+			<widget class="GtkImage" id="image8469">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-first</property>
 			  <property name="icon_size">1</property>
@@ -1071,7 +1087,7 @@
 		      <accelerator key="End" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8445">
+			<widget class="GtkImage" id="image8470">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-last</property>
 			  <property name="icon_size">1</property>
@@ -1122,7 +1138,7 @@
 		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8446">
+			<widget class="GtkImage" id="image8471">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1143,7 +1159,7 @@
 		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8447">
+			<widget class="GtkImage" id="image8472">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1192,7 +1208,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8448">
+			<widget class="GtkImage" id="image8473">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-about</property>
 			  <property name="icon_size">1</property>
@@ -1301,7 +1317,7 @@
 	      <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
 	      <property name="label" translatable="yes">Calculator</property>
 	      <property name="use_underline">True</property>
-	      <property name="icon">gnome-calculator.xpm</property>
+	      <property name="icon">gnome-calculator.png</property>
 	      <property name="visible_horizontal">True</property>
 	      <property name="visible_vertical">True</property>
 	      <property name="is_important">True</property>
@@ -1882,21 +1898,39 @@
 	      <property name="column_spacing">6</property>
 
 	      <child>
-		<widget class="GtkVBox" id="vbox14">
+		<widget class="Custom" id="jogg">
 		  <property name="visible">True</property>
+		  <property name="creation_function">jog_shuttle_new</property>
+		  <property name="int1">0</property>
+		  <property name="int2">0</property>
+		  <property name="last_modification_time">Sun, 07 Oct 2007 12:58:40 GMT</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options"></property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkHBox" id="hbox16">
+		  <property name="visible">True</property>
 		  <property name="homogeneous">False</property>
-		  <property name="spacing">0</property>
+		  <property name="spacing">6</property>
 
 		  <child>
-		    <widget class="GtkLabel" id="label21">
+		    <widget class="GtkLabel" id="label1">
 		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">&lt;b&gt;Selection&lt;/b&gt;</property>
+		      <property name="label" translatable="yes">Frame: </property>
 		      <property name="use_underline">False</property>
-		      <property name="use_markup">True</property>
+		      <property name="use_markup">False</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
 		      <property name="wrap">False</property>
 		      <property name="selectable">False</property>
-		      <property name="xalign">0</property>
+		      <property name="xalign">0.5</property>
 		      <property name="yalign">0.5</property>
 		      <property name="xpad">0</property>
 		      <property name="ypad">0</property>
@@ -1913,144 +1947,178 @@
 		  </child>
 
 		  <child>
-		    <widget class="GtkAlignment" id="alignment15">
+		    <widget class="GtkEntry" id="boxCurFrame">
 		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Current frame</property>
+		      <property name="can_focus">True</property>
+		      <property name="editable">True</property>
+		      <property name="visibility">True</property>
+		      <property name="max_length">8</property>
+		      <property name="text" translatable="yes">0</property>
+		      <property name="has_frame">True</property>
+		      <property name="invisible_char">*</property>
+		      <property name="activates_default">False</property>
+		      <property name="width_chars">8</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="labelTotalFrame">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">/ 0000000</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
 		      <property name="xalign">0.5</property>
 		      <property name="yalign">0.5</property>
-		      <property name="xscale">1</property>
-		      <property name="yscale">1</property>
-		      <property name="top_padding">3</property>
-		      <property name="bottom_padding">0</property>
-		      <property name="left_padding">12</property>
-		      <property name="right_padding">0</property>
+		      <property name="xpad">5</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
 
-		      <child>
-			<widget class="GtkTable" id="table1">
-			  <property name="visible">True</property>
-			  <property name="n_rows">2</property>
-			  <property name="n_columns">2</property>
-			  <property name="homogeneous">False</property>
-			  <property name="row_spacing">3</property>
-			  <property name="column_spacing">3</property>
+		  <child>
+		    <widget class="GtkLabel" id="label4">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Time: </property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
 
-			  <child>
-			    <widget class="GtkLabel" id="labelMarkA">
-			      <property name="visible">True</property>
-			      <property name="can_focus">True</property>
-			      <property name="label" translatable="yes"> 0000000</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">False</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">1</property>
-			      <property name="right_attach">2</property>
-			      <property name="top_attach">0</property>
-			      <property name="bottom_attach">1</property>
-			      <property name="x_options">fill</property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
+		  <child>
+		    <widget class="GtkEntry" id="boxCurTime">
+		      <property name="visible">True</property>
+		      <property name="tooltip" translatable="yes">Current time</property>
+		      <property name="can_focus">True</property>
+		      <property name="editable">True</property>
+		      <property name="visibility">True</property>
+		      <property name="max_length">0</property>
+		      <property name="text" translatable="yes">00:00:00.000</property>
+		      <property name="has_frame">True</property>
+		      <property name="invisible_char">*</property>
+		      <property name="activates_default">False</property>
+		      <property name="width_chars">13</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
 
-			  <child>
-			    <widget class="GtkLabel" id="labelMarkB">
-			      <property name="visible">True</property>
-			      <property name="can_focus">True</property>
-			      <property name="label" translatable="yes"> 0000000</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">False</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">1</property>
-			      <property name="right_attach">2</property>
-			      <property name="top_attach">1</property>
-			      <property name="bottom_attach">2</property>
-			      <property name="x_options">fill</property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
+		  <child>
+		    <widget class="GtkLabel" id="labelTotalTime">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">/ 00:00:00,000</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">5</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="padding">0</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
+		    </packing>
+		  </child>
 
-			  <child>
-			    <widget class="GtkButton" id="buttonGotoA">
-			      <property name="height_request">20</property>
-			      <property name="visible">True</property>
-			      <property name="tooltip" translatable="yes">Go to marker A</property>
-			      <property name="label" translatable="yes">A:</property>
-			      <property name="use_underline">True</property>
-			      <property name="relief">GTK_RELIEF_NORMAL</property>
-			      <property name="focus_on_click">True</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">0</property>
-			      <property name="right_attach">1</property>
-			      <property name="top_attach">0</property>
-			      <property name="bottom_attach">1</property>
-			      <property name="x_options">fill</property>
-			      <property name="y_options">fill</property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkButton" id="buttonGotoB">
-			      <property name="height_request">20</property>
-			      <property name="visible">True</property>
-			      <property name="tooltip" translatable="yes">Go to marker B</property>
-			      <property name="label" translatable="yes">B:</property>
-			      <property name="use_underline">True</property>
-			      <property name="relief">GTK_RELIEF_NORMAL</property>
-			      <property name="focus_on_click">True</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">0</property>
-			      <property name="right_attach">1</property>
-			      <property name="top_attach">1</property>
-			      <property name="bottom_attach">2</property>
-			      <property name="x_options">fill</property>
-			      <property name="y_options">fill</property>
-			    </packing>
-			  </child>
-			</widget>
-		      </child>
+		  <child>
+		    <widget class="GtkLabel" id="labelFrameType">
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="label" translatable="yes">Frame: ?</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
 		    </widget>
 		    <packing>
 		      <property name="padding">0</property>
-		      <property name="expand">True</property>
-		      <property name="fill">True</property>
+		      <property name="expand">False</property>
+		      <property name="fill">False</property>
 		    </packing>
 		  </child>
 		</widget>
 		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">1</property>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">2</property>
 		  <property name="bottom_attach">3</property>
-		  <property name="x_options">fill</property>
-		  <property name="y_options">fill</property>
+		  <property name="y_options"></property>
 		</packing>
 	      </child>
 
 	      <child>
+		<widget class="GtkHScale" id="sliderNavigate">
+		  <property name="visible">True</property>
+		  <property name="draw_value">True</property>
+		  <property name="value_pos">GTK_POS_LEFT</property>
+		  <property name="digits">1</property>
+		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
+		  <property name="inverted">False</property>
+		  <property name="adjustment">0 0 99.9899978638 0.00999999977648 1 0</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		</packing>
+	      </child>
+
+	      <child>
 		<widget class="GtkHBox" id="hbox10">
 		  <property name="visible">True</property>
 		  <property name="homogeneous">False</property>
@@ -2377,39 +2445,21 @@
 	      </child>
 
 	      <child>
-		<widget class="GtkHScale" id="sliderNavigate">
+		<widget class="GtkVBox" id="vbox14">
 		  <property name="visible">True</property>
-		  <property name="draw_value">True</property>
-		  <property name="value_pos">GTK_POS_LEFT</property>
-		  <property name="digits">1</property>
-		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
-		  <property name="inverted">False</property>
-		  <property name="adjustment">0 0 99.9899978638 0.00999999977648 1 0</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkHBox" id="hbox16">
-		  <property name="visible">True</property>
 		  <property name="homogeneous">False</property>
-		  <property name="spacing">6</property>
+		  <property name="spacing">0</property>
 
 		  <child>
-		    <widget class="GtkLabel" id="label1">
+		    <widget class="GtkLabel" id="label21">
 		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Frame: </property>
+		      <property name="label" translatable="yes">&lt;b&gt;Selection&lt;/b&gt;</property>
 		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
+		      <property name="use_markup">True</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
 		      <property name="wrap">False</property>
 		      <property name="selectable">False</property>
-		      <property name="xalign">0.5</property>
+		      <property name="xalign">0</property>
 		      <property name="yalign">0.5</property>
 		      <property name="xpad">0</property>
 		      <property name="ypad">0</property>
@@ -2426,176 +2476,142 @@
 		  </child>
 
 		  <child>
-		    <widget class="GtkEntry" id="boxCurFrame">
+		    <widget class="GtkAlignment" id="alignment15">
 		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Current frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="editable">True</property>
-		      <property name="visibility">True</property>
-		      <property name="max_length">8</property>
-		      <property name="text" translatable="yes">0</property>
-		      <property name="has_frame">True</property>
-		      <property name="invisible_char">*</property>
-		      <property name="activates_default">False</property>
-		      <property name="width_chars">8</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="labelTotalFrame">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 0000000</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
 		      <property name="xalign">0.5</property>
 		      <property name="yalign">0.5</property>
-		      <property name="xpad">5</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
+		      <property name="xscale">1</property>
+		      <property name="yscale">1</property>
+		      <property name="top_padding">3</property>
+		      <property name="bottom_padding">0</property>
+		      <property name="left_padding">12</property>
+		      <property name="right_padding">0</property>
 
-		  <child>
-		    <widget class="GtkLabel" id="label4">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Time: </property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">False</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
+		      <child>
+			<widget class="GtkTable" id="table1">
+			  <property name="visible">True</property>
+			  <property name="n_rows">2</property>
+			  <property name="n_columns">2</property>
+			  <property name="homogeneous">False</property>
+			  <property name="row_spacing">3</property>
+			  <property name="column_spacing">3</property>
 
-		  <child>
-		    <widget class="GtkEntry" id="boxCurTime">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Current time</property>
-		      <property name="can_focus">True</property>
-		      <property name="editable">True</property>
-		      <property name="visibility">True</property>
-		      <property name="max_length">0</property>
-		      <property name="text" translatable="yes">00:00:00.000</property>
-		      <property name="has_frame">True</property>
-		      <property name="invisible_char">*</property>
-		      <property name="activates_default">False</property>
-		      <property name="width_chars">13</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
+			  <child>
+			    <widget class="GtkButton" id="buttonGotoB">
+			      <property name="height_request">20</property>
+			      <property name="visible">True</property>
+			      <property name="tooltip" translatable="yes">Go to marker B</property>
+			      <property name="label" translatable="yes">B:</property>
+			      <property name="use_underline">True</property>
+			      <property name="relief">GTK_RELIEF_NORMAL</property>
+			      <property name="focus_on_click">True</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">0</property>
+			      <property name="right_attach">1</property>
+			      <property name="top_attach">1</property>
+			      <property name="bottom_attach">2</property>
+			      <property name="x_options"></property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
 
-		  <child>
-		    <widget class="GtkLabel" id="labelTotalTime">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 00:00:00,000</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">5</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
+			  <child>
+			    <widget class="GtkButton" id="buttonGotoA">
+			      <property name="height_request">20</property>
+			      <property name="visible">True</property>
+			      <property name="tooltip" translatable="yes">Go to marker A</property>
+			      <property name="label" translatable="yes">A:</property>
+			      <property name="use_underline">True</property>
+			      <property name="relief">GTK_RELIEF_NORMAL</property>
+			      <property name="focus_on_click">True</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">0</property>
+			      <property name="right_attach">1</property>
+			      <property name="top_attach">0</property>
+			      <property name="bottom_attach">1</property>
+			      <property name="x_options"></property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
 
-		  <child>
-		    <widget class="GtkLabel" id="labelFrameType">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">Frame: ?</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
+			  <child>
+			    <widget class="GtkLabel" id="labelMarkB">
+			      <property name="visible">True</property>
+			      <property name="can_focus">True</property>
+			      <property name="label" translatable="yes"> 0000000</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">1</property>
+			      <property name="right_attach">2</property>
+			      <property name="top_attach">1</property>
+			      <property name="bottom_attach">2</property>
+			      <property name="x_options"></property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkLabel" id="labelMarkA">
+			      <property name="visible">True</property>
+			      <property name="can_focus">True</property>
+			      <property name="label" translatable="yes"> 0000000</property>
+			      <property name="use_underline">False</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">True</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="left_attach">1</property>
+			      <property name="right_attach">2</property>
+			      <property name="top_attach">0</property>
+			      <property name="bottom_attach">1</property>
+			      <property name="x_options"></property>
+			      <property name="y_options"></property>
+			    </packing>
+			  </child>
+			</widget>
+		      </child>
 		    </widget>
 		    <packing>
 		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
+		      <property name="expand">True</property>
+		      <property name="fill">True</property>
 		    </packing>
 		  </child>
 		</widget>
 		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">2</property>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">1</property>
 		  <property name="bottom_attach">3</property>
+		  <property name="x_options"></property>
 		  <property name="y_options"></property>
 		</packing>
 	      </child>
-
-	      <child>
-		<widget class="Custom" id="jogg">
-		  <property name="visible">True</property>
-		  <property name="creation_function">jog_shuttle_new</property>
-		  <property name="int1">0</property>
-		  <property name="int2">0</property>
-		  <property name="last_modification_time">Wed, 04 Jul 2007 18:33:02 GMT</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		  <property name="x_options">fill</property>
-		  <property name="y_options">expand</property>
-		</packing>
-	      </child>
 	    </widget>
 	    <packing>
 	      <property name="padding">0</property>



From mean at mail.berlios.de  Sun Nov 25 17:17:33 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 25 Nov 2007 17:17:33 +0100
Subject: [Avidemux-svn-commit] r3707 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200711251617.lAPGHXju017533@sheep.berlios.de>

Author: mean
Date: 2007-11-25 17:17:33 +0100 (Sun, 25 Nov 2007)
New Revision: 3707

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp
Log:
[MKV] Completed switch to 64 bit-ness, not tested much

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h	2007-11-25 14:07:37 UTC (rev 3706)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h	2007-11-25 16:17:33 UTC (rev 3707)
@@ -53,7 +53,7 @@
                 uint32_t  _close;
   public: 
                             ADM_ebml_file();
-                            ADM_ebml_file(ADM_ebml_file *father,uint32_t size);
+                            ADM_ebml_file(ADM_ebml_file *father,uint64_t size);
                             ~ADM_ebml_file();
                     uint8_t open(const char *fn);
        
@@ -64,8 +64,8 @@
                     uint8_t   finished(void);
                     uint64_t  getFileSize(void) {return _size;};
                     uint8_t   find(ADM_MKV_SEARCHTYPE search,
-                                        MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint32_t *len,uint32_t rewind=1);
-                    uint8_t   simplefind(MKV_ELEM_ID  prim,uint32_t *len,uint32_t rewind=1);
+                                        MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint64_t *len,uint32_t rewind=1);
+                    uint8_t   simplefind(MKV_ELEM_ID  prim,uint64_t *len,uint32_t rewind=1);
                     uint64_t remaining(void);
 };
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2007-11-25 14:07:37 UTC (rev 3706)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp	2007-11-25 16:17:33 UTC (rev 3707)
@@ -39,7 +39,7 @@
  
   ADM_ebml_file ebml;
   uint64_t id,len;
-  uint32_t alen;
+  uint64_t alen;
   ADM_MKV_TYPE type;
   const char *ss;
   

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-11-25 14:07:37 UTC (rev 3706)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-11-25 16:17:33 UTC (rev 3707)
@@ -303,7 +303,7 @@
 uint8_t                 mkvHeader::readCue(ADM_ebml_file *parser)
 {
   uint64_t fileSize,len,bsize;
-  uint32_t alen,vlen;
+  uint64_t alen,vlen;
   uint64_t id;
   ADM_MKV_TYPE type;
   const char *ss;
@@ -390,7 +390,7 @@
 uint8_t   mkvHeader::indexClusters(ADM_ebml_file *parser)
 {
   uint64_t fileSize,len,bsize;
-  uint32_t alen,vlen;
+  uint64_t alen,vlen;
   uint64_t id;
   ADM_MKV_TYPE type;
   const char *ss;
@@ -445,6 +445,7 @@
            _nbClusters++;
        }
        segment.seek( _clusters[seekme].pos+ _clusters[seekme].size);
+       //printf("Position :%u %u MB\n", _clusters[seekme].pos+ _clusters[seekme].size,( _clusters[seekme].pos+ _clusters[seekme].size)>>20);
    }
    delete work;
    printf("[MKV] Found %u clusters\n",_nbClusters);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp	2007-11-25 14:07:37 UTC (rev 3706)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp	2007-11-25 16:17:33 UTC (rev 3707)
@@ -50,6 +50,8 @@
   {"A_VORBIS",0,WAV_OGG,""},
   
   // Video
+  {"V_MPEG2",1,0,"MPEG"}, // Mpeg2
+  {"V_MPEG1",1,0,"MPEG"}, // Mpeg1
   {"V_MPEG4/MS/V3",1,0,"DIV3"}, // MS MPEG4 (Divx3)
   {"V_MPEG4/ISO/AVC",1,0,"AVC1"}, //H264
   {"V_MS/VFW/FOURCC",1,0,"VFWX"}, // Divx 2.

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp	2007-11-25 14:07:37 UTC (rev 3706)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp	2007-11-25 16:17:33 UTC (rev 3707)
@@ -227,7 +227,7 @@
 //*******************************************
 //***********FILE IO PART *******************
 //*******************************************
-ADM_ebml_file::ADM_ebml_file(ADM_ebml_file *father,uint32_t size)
+ADM_ebml_file::ADM_ebml_file(ADM_ebml_file *father,uint64_t size)
 {
   _close=0;
   _size=size;
@@ -317,7 +317,7 @@
   \fn find
   \brief Search for the tag given and returns the corresponding atom
 */
- uint8_t ADM_ebml_file::find(ADM_MKV_SEARCHTYPE search,MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint32_t *len,uint32_t rewind)
+ uint8_t ADM_ebml_file::find(ADM_MKV_SEARCHTYPE search,MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint64_t *len,uint32_t rewind)
 {
   uint64_t id,pos;
   ADM_MKV_TYPE type;
@@ -354,7 +354,7 @@
   \fn find
   \brief Search for the tag given and returns the corresponding atom
 */
-uint8_t ADM_ebml_file::simplefind(MKV_ELEM_ID  prim,uint32_t *len,uint32_t rewind)
+uint8_t ADM_ebml_file::simplefind(MKV_ELEM_ID  prim,uint64_t *len,uint32_t rewind)
 {
   uint64_t id,alen;
   ADM_MKV_TYPE type;
@@ -381,7 +381,7 @@
           vprintf("Found Tag : %x (%s)\n",id,ss);
           if(id==prim)
           {
-            *len=(uint32_t )alen;
+            *len=alen;
             return 1;
           }else
             skip(alen);



From gruntster at mail.berlios.de  Mon Nov 26 17:06:43 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 26 Nov 2007 17:06:43 +0100
Subject: [Avidemux-svn-commit] r3708 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux
	avidemux/xpm cmake
Message-ID: <200711261606.lAQG6hX6020822@sheep.berlios.de>

Author: gruntster
Date: 2007-11-26 17:06:25 +0100 (Mon, 26 Nov 2007)
New Revision: 3708

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux.icns
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
Log:
[CMake] bundle apps on Mac + minor tweaks

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-25 16:17:33 UTC (rev 3707)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-26 16:06:25 UTC (rev 3708)
@@ -14,7 +14,6 @@
 	MESSAGE(FATAL_ERROR "in-tree-build detected")
 ENDIF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
 
-INCLUDE(CheckCCompilerFlag)
 INCLUDE(CheckCXXCompilerFlag)
 INCLUDE(admConfigHelper)
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-25 16:17:33 UTC (rev 3707)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-26 16:06:25 UTC (rev 3708)
@@ -64,16 +64,20 @@
 ########################################
 SET(ADM_EXE_SRCS ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
 
-ADD_EXECUTABLE(avidemux2_cli ${ADM_EXE_SRCS})
+IF (ADM_OS_DARWIN)
+	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} ${CMAKE_SOURCE_DIR}/avidemux/xpm/avidemux.icns)
+ENDIF (ADM_OS_DARWIN)
+
+ADD_EXECUTABLE(avidemux2_cli MACOSX_BUNDLE ${ADM_EXE_SRCS})
 ADD_TARGET_CFLAGS(avidemux2_cli "-I${CMAKE_BINARY_DIR}/config/cli")
 
 IF (ADM_UI_GTK)
-	ADD_EXECUTABLE(avidemux2_gtk ${ADM_EXE_SRCS})
+	ADD_EXECUTABLE(avidemux2_gtk MACOSX_BUNDLE ${ADM_EXE_SRCS})
 	ADD_TARGET_CFLAGS(avidemux2_gtk "-I${CMAKE_BINARY_DIR}/config/gtk")
 ENDIF (ADM_UI_GTK)
 
 IF (ADM_UI_QT4)
-	ADD_EXECUTABLE(avidemux2_qt4 ${ADM_EXE_SRCS})
+	ADD_EXECUTABLE(avidemux2_qt4 MACOSX_BUNDLE ${ADM_EXE_SRCS})
 	ADD_TARGET_CFLAGS(avidemux2_qt4 "-I${CMAKE_BINARY_DIR}/config/qt4")
 ENDIF (ADM_UI_QT4)
 
@@ -81,6 +85,10 @@
 ADD_SOURCE_CFLAGS(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
 ADD_SOURCE_CFLAGS(gtk_gui.cpp ${GLIB_CFLAGS})
 
+IF (ADM_OS_DARWIN)
+	SET_SOURCE_FILES_PROPERTIES(${CMAKE_SOURCE_DIR}/avidemux/xpm/avidemux.icns PROPERTIES MACOSX_PACKAGE_LOCATION Resources)
+ENDIF (ADM_OS_DARWIN)
+
 IF (USE_AMR_NB)
 	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
 ENDIF (USE_AMR_NB)
@@ -430,6 +438,18 @@
 
 IF (ADM_OS_DARWIN)
 	ADD_LIB_ALL_TARGETS("-framework CoreServices -framework CoreAudio -framework AudioUnit")
+
+	SET(ADM_OSX_VERSION "${VERSION}")
+
+	IF (Subversion_FOUND)
+		SET(ADM_OSX_VERSION "${ADM_OSX_VERSION} (r${ADM_SUBVERSION})")
+	ENDIF (Subversion_FOUND)
+
+	SET(MACOSX_BUNDLE_ICON_FILE avidemux.icns)
+	SET(MACOSX_BUNDLE_INFO_STRING "Avidemux ${ADM_OSX_VERSION}")
+	SET(MACOSX_BUNDLE_LONG_VERSION_STRING "${ADM_OSX_VERSION}") 
+	SET(MACOSX_BUNDLE_SHORT_VERSION_STRING "${ADM_OSX_VERSION}")
+	SET(MACOSX_BUNDLE_VERSION "${ADM_OSX_VERSION}")
 ENDIF (ADM_OS_DARWIN)
 
 ###########################################

Added: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux.icns
===================================================================
(Binary files differ)


Property changes on: branches/avidemux_2.5_branch_gruntster/avidemux/xpm/avidemux.icns
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-25 16:17:33 UTC (rev 3707)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-26 16:06:25 UTC (rev 3708)
@@ -75,8 +75,8 @@
 #cmakedefine CONFIG_TG2_MUXER
 #cmakedefine CONFIG_TGP_MUXER
 
-#cmakedefine ENABLE_MMX ${ENABLE_MMX}
-#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
+#define ENABLE_MMX ${ENABLE_MMX}
+#define ENABLE_THREADS ${ENABLE_THREADS}
 #cmakedefine HAVE_FAST_UNALIGNED
 #cmakedefine HAVE_LRINTF
 #cmakedefine HAVE_MMX



From gruntster at mail.berlios.de  Tue Nov 27 15:12:34 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 27 Nov 2007 15:12:34 +0100
Subject: [Avidemux-svn-commit] r3709 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
Message-ID: <200711271412.lARECYNI017276@sheep.berlios.de>

Author: gruntster
Date: 2007-11-27 15:12:27 +0100 (Tue, 27 Nov 2007)
New Revision: 3709

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
Log:
[CMake] stamp Win32 executables with version info

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-26 16:06:25 UTC (rev 3708)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-27 14:12:27 UTC (rev 3709)
@@ -39,7 +39,6 @@
 	ENDIF (ADM_UI_QT4)
 ENDMACRO (ADD_LDFLAGS_ALL_TARGETS)
 
-
 ########################################
 # Definitions and Includes
 ########################################
@@ -50,24 +49,56 @@
 	ADD_DEFINITIONS(-DADM_DEBUG)
 ENDIF (ADM_DEBUG)
 
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux)		# ADM_assert.h, prefs.h
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities)		# default.h, fourcc.h
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
-INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec)
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})		# ADM_assert.h, prefs.h
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_utilities)		# default.h, fourcc.h
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_lavutil)
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_lavcodec)
 
 IF (GETTEXT_FOUND)
 	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
 ENDIF (GETTEXT_FOUND)
 
 ########################################
-# Our exectuables
+# Embed resources for executables
 ########################################
-SET(ADM_EXE_SRCS ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
+IF (ADM_OS_DARWIN)
+	# add icon
+	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} ${CMAKE_CURRENT_SOURCE_DIR}/xpm/avidemux.icns)
+	SET_SOURCE_FILES_PROPERTIES(${CMAKE_CURRENT_SOURCE_DIR}/xpm/avidemux.icns PROPERTIES MACOSX_PACKAGE_LOCATION Resources)
 
-IF (ADM_OS_DARWIN)
-	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} ${CMAKE_SOURCE_DIR}/avidemux/xpm/avidemux.icns)
+	# bundle version info
+	SET(ADM_OSX_VERSION "${VERSION}")
+
+	IF (Subversion_FOUND)
+		SET(ADM_OSX_VERSION "${ADM_OSX_VERSION} (r${ADM_SUBVERSION})")
+	ENDIF (Subversion_FOUND)
+
+	SET(MACOSX_BUNDLE_ICON_FILE avidemux.icns)
+	SET(MACOSX_BUNDLE_INFO_STRING "Avidemux ${ADM_OSX_VERSION}")
+	SET(MACOSX_BUNDLE_LONG_VERSION_STRING "${ADM_OSX_VERSION}") 
+	SET(MACOSX_BUNDLE_SHORT_VERSION_STRING "${ADM_OSX_VERSION}")
+	SET(MACOSX_BUNDLE_VERSION "${ADM_OSX_VERSION}")
 ENDIF (ADM_OS_DARWIN)
 
+IF (ADM_OS_WINDOWS)
+	# add icon and version info
+	SET(FILEVERSION_STRING "${VERSION}.0.${ADM_SUBVERSION}")
+	SET(PRODUCTVERSION_STRING "${VERSION}")
+	STRING(REPLACE "." "," FILEVERSION ${FILEVERSION_STRING})
+	STRING(REPLACE "." "," PRODUCTVERSION ${PRODUCTVERSION_STRING})
+	SET(PRODUCTVERSION "${PRODUCTVERSION},0,0")
+
+	CONFIGURE_FILE("${CMAKE_MODULE_PATH}/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
+	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)
+
+	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} "${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj")
+ENDIF (ADM_OS_WINDOWS)
+
+########################################
+# Our exectuables
+########################################
+SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
+
 ADD_EXECUTABLE(avidemux2_cli MACOSX_BUNDLE ${ADM_EXE_SRCS})
 ADD_TARGET_CFLAGS(avidemux2_cli "-I${CMAKE_BINARY_DIR}/config/cli")
 
@@ -85,10 +116,6 @@
 ADD_SOURCE_CFLAGS(main.cpp "-DADM_SUBVERSION=${ADM_SUBVERSION}")
 ADD_SOURCE_CFLAGS(gtk_gui.cpp ${GLIB_CFLAGS})
 
-IF (ADM_OS_DARWIN)
-	SET_SOURCE_FILES_PROPERTIES(${CMAKE_SOURCE_DIR}/avidemux/xpm/avidemux.icns PROPERTIES MACOSX_PACKAGE_LOCATION Resources)
-ENDIF (ADM_OS_DARWIN)
-
 IF (USE_AMR_NB)
 	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
 ENDIF (USE_AMR_NB)
@@ -429,8 +456,16 @@
 IF (ADM_OS_WINDOWS)
 	ADD_ADMLIB_ALL_TARGETS(ADM_osSupport)
 	ADD_LIB_ALL_TARGETS(pthreadGC2 winmm wsock32 imagehlp)
-	ADD_LIB_ALL_TARGETS("-mno-cygwin -mwinmm -mwindows ${CMAKE_SOURCE_DIR}/avidemux/xpm/adm.o -Wl,--export-all-symbols")
+	ADD_LIB_ALL_TARGETS("-mno-cygwin -Wl,--export-all-symbols")
 
+	IF (ADM_UI_GTK)
+		ADD_TARGET_LDFLAGS(avidemux2_gtk "-mwindows")
+	ENDIF (ADM_UI_GTK)
+
+	IF (ADM_UI_QT4)
+		ADD_TARGET_LDFLAGS(avidemux2_qt4 "-mwindows")
+	ENDIF (ADM_UI_QT4)
+
 	IF (CMAKE_BUILD_TYPE STREQUAL "Release")
 		ADD_LIB_ALL_TARGETS("-Wl,-s")
 	ENDIF (CMAKE_BUILD_TYPE STREQUAL "Release")
@@ -438,18 +473,6 @@
 
 IF (ADM_OS_DARWIN)
 	ADD_LIB_ALL_TARGETS("-framework CoreServices -framework CoreAudio -framework AudioUnit")
-
-	SET(ADM_OSX_VERSION "${VERSION}")
-
-	IF (Subversion_FOUND)
-		SET(ADM_OSX_VERSION "${ADM_OSX_VERSION} (r${ADM_SUBVERSION})")
-	ENDIF (Subversion_FOUND)
-
-	SET(MACOSX_BUNDLE_ICON_FILE avidemux.icns)
-	SET(MACOSX_BUNDLE_INFO_STRING "Avidemux ${ADM_OSX_VERSION}")
-	SET(MACOSX_BUNDLE_LONG_VERSION_STRING "${ADM_OSX_VERSION}") 
-	SET(MACOSX_BUNDLE_SHORT_VERSION_STRING "${ADM_OSX_VERSION}")
-	SET(MACOSX_BUNDLE_VERSION "${ADM_OSX_VERSION}")
 ENDIF (ADM_OS_DARWIN)
 
 ###########################################

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-26 16:06:25 UTC (rev 3708)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-27 14:12:27 UTC (rev 3709)
@@ -28,7 +28,7 @@
 PRINT_LIBRARY_INFO("libiconv" LIBICONV_FOUND "${LIBICONV_INCLUDE_DIR}" "${LIBICONV_LIBRARY_DIR}")
 
 IF (NOT LIBICONV_INCLUDE_DIR)
-	MESSAGE(FATAL "iconv.h not found")
+	MESSAGE(FATAL_ERROR "iconv.h not found")
 ENDIF (NOT LIBICONV_INCLUDE_DIR)
 
 IF (LIBICONV_LIBRARY_DIR)

Added: branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in	2007-11-26 16:06:25 UTC (rev 3708)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in	2007-11-27 14:12:27 UTC (rev 3709)
@@ -0,0 +1,31 @@
+VS_VERSION_INFO VERSIONINFO
+ FILEVERSION     ${FILEVERSION}
+ PRODUCTVERSION  ${PRODUCTVERSION}
+ FILEFLAGSMASK   0x3fL
+ FILEFLAGS       0x0L
+ FILEOS          0x4L
+ FILETYPE        0x1L
+ FILESUBTYPE     0x0L
+BEGIN
+    BLOCK "StringFileInfo"
+    BEGIN
+        BLOCK "040904B0"
+        BEGIN
+            VALUE "CompanyName",      "Free Software Foundation"
+            VALUE "FileDescription",  "Avidemux ${PRODUCTVERSION_STRING}"
+            VALUE "FileVersion",      "${FILEVERSION_STRING}"
+            VALUE "InternalName",     "avidemux"
+            VALUE "LegalCopyright",   "Copyright ? 2001-2007 Free Software Foundation"
+            VALUE "OriginalFilename", ""
+            VALUE "ProductName",      "Avidemux"
+            VALUE "ProductVersion",   "${PRODUCTVERSION_STRING}"
+        END
+    END
+
+    BLOCK "VarFileInfo"
+    BEGIN
+        VALUE "Translation", 0x409, 1200
+    END
+END
+
+100 ICON "${CMAKE_SOURCE_DIR}/avidemux/xpm/adm.ico"
\ No newline at end of file



From gruntster at mail.berlios.de  Tue Nov 27 17:31:32 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 27 Nov 2007 17:31:32 +0100
Subject: [Avidemux-svn-commit] r3710 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux cmake
Message-ID: <200711271631.lARGVWiH028155@sheep.berlios.de>

Author: gruntster
Date: 2007-11-27 17:31:06 +0100 (Tue, 27 Nov 2007)
New Revision: 3710

Removed:
   branches/avidemux_2.5_branch_gruntster/cmake/FindLibXml2.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindX11.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/FindSDL.cmake
Log:
[CMake] remove standard CMake modules + cosmetics

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-27 16:31:06 UTC (rev 3710)
@@ -4,7 +4,7 @@
 MESSAGE("")
 
 CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
-SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
+SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake" "${CMAKE_MODULE_PATH}")
 
 PROJECT(Avidemux)
 
@@ -174,15 +174,15 @@
 # Generate config.h
 ########################################
 SET(CONFIG_HEADER_TYPE ADM_BUILD_CLI)
-CONFIGURE_FILE("${CMAKE_MODULE_PATH}/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/cli/config.h")
+CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/cli/config.h")
 MESSAGE(STATUS "CLI config.h generated")
 
 SET(CONFIG_HEADER_TYPE ADM_BUILD_GTK)
-CONFIGURE_FILE("${CMAKE_MODULE_PATH}/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/gtk/config.h")
+CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/gtk/config.h")
 MESSAGE(STATUS "GTK config.h generated")
 
 SET(CONFIG_HEADER_TYPE ADM_BUILD_QT4)
-CONFIGURE_FILE("${CMAKE_MODULE_PATH}/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/qt4/config.h")
+CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/config.h.cmake" "${CMAKE_CURRENT_BINARY_DIR}/config/qt4/config.h")
 MESSAGE(STATUS "QT4 config.h generated")
 
 ########################################

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,16 +1,18 @@
 ########################################
 # Macros
 ########################################
-MACRO (ADD_ADMLIB_ALL_TARGETS _libName)
-	TARGET_LINK_LIBRARIES(avidemux2_cli ${_libName}_cli)
-  
-	IF (ADM_UI_GTK)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${_libName}_gtk)
-	ENDIF (ADM_UI_GTK)
-	
-	IF (ADM_UI_QT4)
-		TARGET_LINK_LIBRARIES(avidemux2_qt4 ${_libName}_qt4)
-	ENDIF (ADM_UI_QT4)
+MACRO (ADD_ADMLIB_ALL_TARGETS)
+	FOREACH (_libName ${ARGV})
+		TARGET_LINK_LIBRARIES(avidemux2_cli ${_libName}_cli)
+
+		IF (ADM_UI_GTK)
+			TARGET_LINK_LIBRARIES(avidemux2_gtk ${_libName}_gtk)
+		ENDIF (ADM_UI_GTK)
+
+		IF (ADM_UI_QT4)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${_libName}_qt4)
+		ENDIF (ADM_UI_QT4)
+	ENDFOREACH (_libName ${ARGV})
 ENDMACRO (ADD_ADMLIB_ALL_TARGETS)
 
 
@@ -88,7 +90,7 @@
 	STRING(REPLACE "." "," PRODUCTVERSION ${PRODUCTVERSION_STRING})
 	SET(PRODUCTVERSION "${PRODUCTVERSION},0,0")
 
-	CONFIGURE_FILE("${CMAKE_MODULE_PATH}/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
+	CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
 	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)
 
 	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} "${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj")
@@ -160,9 +162,7 @@
 	oplug_flv
 	oplug_dummy)
 
-FOREACH(_current ${ADM_OUTPUTS})
-	ADD_ADMLIB_ALL_TARGETS(${_current})
-ENDFOREACH(_current ${ADM_OUTPUTS})
+ADD_ADMLIB_ALL_TARGETS(${ADM_OUTPUTS})
 
 ###########################################
 # Construct ADM_inputs
@@ -183,9 +183,7 @@
 	ADM_flv
 	ADM_amv)
 
-FOREACH(_current ${ADM_INPUTS})
-	ADD_ADMLIB_ALL_TARGETS(${_current})
-ENDFOREACH(_current ${ADM_INPUTS})
+ADD_ADMLIB_ALL_TARGETS(${ADM_INPUTS})
 
 #########################################
 # Tails
@@ -227,18 +225,16 @@
 	ADM_libpostproc
 	ADM_colorspace)
 
+ADD_ADMLIB_ALL_TARGETS(${ADM_LIBRARIES})
+
 IF (USE_FREETYPE)
-	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libass)
+	ADD_ADMLIB_ALL_TARGETS(ADM_libass)
 ENDIF (USE_FREETYPE)
 
 IF (ADM_DEBUG AND FIND_LEAKS)
-	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
+	ADD_ADMLIB_ALL_TARGETS(ADM_nvwa)
 ENDIF (ADM_DEBUG AND FIND_LEAKS)
 
-FOREACH(_current ${ADM_LIBRARIES})
-	ADD_ADMLIB_ALL_TARGETS(${_current})
-ENDFOREACH(_current ${ADM_SUBDIR})
-
 IF (ADM_OS_DARWIN AND USE_SDL)
 	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_libsdl_gtk)
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_libsdl_qt4)
@@ -249,37 +245,40 @@
 ###########################################
 ADD_SUBDIRECTORY(ADM_userInterfaces)
 
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_UI_None_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_commonUI_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_ocr_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogNone_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFactoryNone_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFiltersNone_cli)
-TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogGuiNone_cli)
+TARGET_LINK_LIBRARIES(avidemux2_cli
+	ADM_UI_None_cli
+	ADM_commonUI_cli
+	ADM_ocr_cli
+	ADM_dialogNone_cli
+	ADM_dialogFactoryNone_cli
+	ADM_dialogFiltersNone_cli
+	ADM_dialogGuiNone_cli)
 
 IF (ADM_UI_GTK)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_UI_GTK_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocrGtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogGtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_filtersGtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogFactoryGtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_gui2Gtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_toolkitGtk_gtk)
-	TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI_gtk)
+	TARGET_LINK_LIBRARIES(avidemux2_gtk
+		ADM_UI_GTK_gtk
+		ADM_commonUI_gtk
+		ADM_ocr_gtk
+		ADM_ocrGtk_gtk
+		ADM_dialogGtk_gtk
+		ADM_filtersGtk_gtk
+		ADM_dialogFactoryGtk_gtk
+		ADM_gui2Gtk_gtk
+		ADM_toolkitGtk_gtk
+		ADM_commonUI_gtk)
 ENDIF (ADM_UI_GTK)
 
 IF (ADM_UI_QT4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_UI_QT4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_ocr_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_ocrQt4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_dialogQt4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_dialogFactoryQt4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_guiQt4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_filtersQt4_qt4)
-	TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI_qt4)
+	TARGET_LINK_LIBRARIES(avidemux2_qt4
+		ADM_UI_QT4_qt4
+		ADM_commonUI_qt4
+		ADM_ocr_qt4
+		ADM_ocrQt4_qt4
+		ADM_dialogQt4_qt4
+		ADM_dialogFactoryQt4_qt4
+		ADM_guiQt4_qt4
+		ADM_filtersQt4_qt4
+		ADM_commonUI_qt4)
 ENDIF (ADM_UI_QT4)
 
 ADD_ADMLIB_ALL_TARGETS(ADM_utilities)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindLibXml2.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindLibXml2.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindLibXml2.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,59 +0,0 @@
-# - Try to find LibXml2
-# Once done this will define
-#
-#  LIBXML2_FOUND - system has LibXml2
-#  LIBXML2_INCLUDE_DIR - the LibXml2 include directory
-#  LIBXML2_LIBRARIES - the libraries needed to use LibXml2
-#  LIBXML2_DEFINITIONS - Compiler switches required for using LibXml2
-#
-# Copyright (c) 2006, Alexander Neundorf <neundorf at kde.org>
-# This code is available under the BSD license, see licenses/BSD for details.
-
-# Copyright (c) 2006, Alexander Neundorf, <neundorf at kde.org>
-#
-# Redistribution and use is allowed according to the terms of the BSD license.
-# For details see the accompanying COPYING-CMAKE-SCRIPTS file.
-
-
-IF (LIBXML2_INCLUDE_DIR AND LIBXML2_LIBRARIES)
-   # in cache already
-   SET(LibXml2_FIND_QUIETLY TRUE)
-ENDIF (LIBXML2_INCLUDE_DIR AND LIBXML2_LIBRARIES)
-
-IF (NOT WIN32)
-   # use pkg-config to get the directories and then use these values
-   # in the FIND_PATH() and FIND_LIBRARY() calls
-   INCLUDE(UsePkgConfig)
-   PKGCONFIG(libxml-2.0 _LibXml2IncDir _LibXml2LinkDir _LibXml2LinkFlags _LibXml2Cflags)
-   SET(LIBXML2_DEFINITIONS ${_LibXml2Cflags})
-ENDIF (NOT WIN32)
-
-FIND_PATH(LIBXML2_INCLUDE_DIR libxml/xpath.h
-   PATHS
-   ${_LibXml2IncDir}
-   PATH_SUFFIXES libxml2
-   )
-
-FIND_LIBRARY(LIBXML2_LIBRARIES NAMES xml2 libxml2
-   PATHS
-   ${_LibXml2LinkDir}
-   )
-
-IF (LIBXML2_INCLUDE_DIR AND LIBXML2_LIBRARIES)
-   SET(LIBXML2_FOUND TRUE)
-ELSE (LIBXML2_INCLUDE_DIR AND LIBXML2_LIBRARIES)
-   SET(LIBXML2_FOUND FALSE)
-ENDIF (LIBXML2_INCLUDE_DIR AND LIBXML2_LIBRARIES)
-
-IF (LIBXML2_FOUND)
-   IF (NOT LibXml2_FIND_QUIETLY)
-      MESSAGE(STATUS "Found LibXml2: ${LIBXML2_LIBRARIES}")
-   ENDIF (NOT LibXml2_FIND_QUIETLY)
-ELSE (LIBXML2_FOUND)
-   IF (LibXml2_FIND_REQUIRED)
-      MESSAGE(SEND_ERROR "Could NOT find LibXml2")
-   ENDIF (LibXml2_FIND_REQUIRED)
-ENDIF (LIBXML2_FOUND)
-
-MARK_AS_ADVANCED(LIBXML2_INCLUDE_DIR LIBXML2_LIBRARIES)
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,58 +0,0 @@
-# - Find the native PNG includes and library
-#
-
-# This module defines
-#  PNG_INCLUDE_DIR, where to find png.h, etc.
-#  PNG_LIBRARIES, the libraries to link against to use PNG.
-#  PNG_DEFINITIONS - You should ADD_DEFINITONS(${PNG_DEFINITIONS}) before compiling code that includes png library files.
-#  PNG_FOUND, If false, do not try to use PNG.
-# also defined, but not for general use are
-#  PNG_LIBRARY, where to find the PNG library.
-# None of the above will be defined unles zlib can be found.
-# PNG depends on Zlib
-INCLUDE(FindZLIB)
-
-SET(PNG_FOUND "NO")
-
-IF(ZLIB_FOUND)
-  FIND_PATH(PNG_PNG_INCLUDE_DIR png.h
-  /usr/local/include
-  /usr/include
-  /usr/local/include/libpng             # OpenBSD
-  )
-
-  SET(PNG_NAMES ${PNG_NAMES} png libpng)
-  FIND_LIBRARY(PNG_LIBRARY
-    NAMES ${PNG_NAMES}
-    PATHS /usr/lib /usr/local/lib
-  )
-
-  IF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
-      # png.h includes zlib.h. Sigh.
-      SET(PNG_INCLUDE_DIR ${PNG_PNG_INCLUDE_DIR} ${ZLIB_INCLUDE_DIR} )
-      SET(PNG_LIBRARIES ${PNG_LIBRARY} ${ZLIB_LIBRARY})
-      SET(PNG_FOUND "YES")
-
-      IF (CYGWIN)
-        IF(BUILD_SHARED_LIBS)
-           # No need to define PNG_USE_DLL here, because it's default for Cygwin.
-        ELSE(BUILD_SHARED_LIBS)
-          SET (PNG_DEFINITIONS -DPNG_STATIC)
-        ENDIF(BUILD_SHARED_LIBS)
-      ENDIF (CYGWIN)
-
-  ENDIF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
-
-ENDIF(ZLIB_FOUND)
-
-IF (PNG_FOUND)
-  IF (NOT PNG_FIND_QUIETLY)
-    MESSAGE(STATUS "Found PNG: ${PNG_LIBRARY}")
-  ENDIF (NOT PNG_FIND_QUIETLY)
-ELSE (PNG_FOUND)
-  IF (PNG_FIND_REQUIRED)
-    MESSAGE(FATAL_ERROR "Could not find PNG library")
-  ENDIF (PNG_FIND_REQUIRED)
-ENDIF (PNG_FOUND)
-
-MARK_AS_ADVANCED(PNG_PNG_INCLUDE_DIR PNG_LIBRARY )

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,360 +0,0 @@
-# - a pkg-config module for CMake
-#
-# Usage:
-#   pkg_check_modules(<PREFIX> [REQUIRED] <MODULE> [<MODULE>]*)
-#     checks for all the given modules
-#
-#   pkg_search_module(<PREFIX> [REQUIRED] <MODULE> [<MODULE>]*)
-#     checks for given modules and uses the first working one
-#
-# When the 'REQUIRED' argument was set, macros will fail with an error
-# when module(s) could not be found
-#
-# It sets the following variables:
-#   PKG_CONFIG_FOUND         ... true iff pkg-config works on the system
-#   PKG_CONFIG_EXECUTABLE    ... pathname of the pkg-config program
-#   <PREFIX>_FOUND           ... set to 1 iff module(s) exist
-#
-# For the following variables two sets of values exist; first one is the
-# common one and has the given PREFIX. The second set contains flags
-# which are given out when pkgconfig was called with the '--static'
-# option.
-#   <XPREFIX>_LIBRARIES      ... only the libraries (w/o the '-l')
-#   <XPREFIX>_LIBRARY_DIRS   ... the paths of the libraries (w/o the '-L')
-#   <XPREFIX>_LDFLAGS        ... all required linker flags
-#   <XPREFIX>_LDFLAGS_OTHERS ... all other linker flags
-#   <XPREFIX>_INCLUDE_DIRS   ... the '-I' preprocessor flags (w/o the '-I')
-#   <XPREFIX>_CFLAGS         ... all required cflags
-#   <XPREFIX>_CFLAGS_OTHERS  ... the other compiler flags
-#
-#   <XPREFIX> = <PREFIX>        for common case
-#   <XPREFIX> = <PREFIX>_STATIC for static linking
-#
-# There are some special variables whose prefix depends on the count
-# of given modules. When there is only one module, <PREFIX> stays
-# unchanged. When there are multiple modules, the prefix will be
-# changed to <PREFIX>_<MODNAME>:
-#   <XPREFIX>_VERSION    ... version of the module
-#   <XPREFIX>_PREFIX     ... prefix-directory of the module
-#   <XPREFIX>_INCLUDEDIR ... include-dir of the module
-#   <XPREFIX>_LIBDIR     ... lib-dir of the module
-#
-#   <XPREFIX> = <PREFIX>  when |MODULES| == 1, else
-#   <XPREFIX> = <PREFIX>_<MODNAME>
-#
-# A <MODULE> parameter can have the following formats:
-#   {MODNAME}            ... matches any version
-#   {MODNAME}>={VERSION} ... at least version <VERSION> is required
-#   {MODNAME}={VERSION}  ... exactly version <VERSION> is required
-#   {MODNAME}<={VERSION} ... modules must not be newer than <VERSION>
-#
-# Examples
-#   pkg_check_modules (GLIB2   glib-2.0)
-#
-#   pkg_check_modules (GLIB2   glib-2.0>=2.10)
-#     requires at least version 2.10 of glib2 and defines e.g.
-#       GLIB2_VERSION=2.10.3
-#
-#   pkg_check_modules (FOO     glib-2.0>=2.10 gtk+-2.0)
-#     requires both glib2 and gtk2, and defines e.g.
-#       FOO_glib-2.0_VERSION=2.10.3
-#       FOO_gtk+-2.0_VERSION=2.8.20
-#
-#   pkg_check_modules (XRENDER REQUIRED xrender)
-#     defines e.g.:
-#       XRENDER_LIBRARIES=Xrender;X11
-#       XRENDER_STATIC_LIBRARIES=Xrender;X11;pthread;Xau;Xdmcp
-#
-#   pkg_search_module (BAR     libxml-2.0 libxml2 libxml>=2)
-
-
-# Copyright (C) 2006 Enrico Scholz <enrico.scholz at informatik.tu-chemnitz.de>
-#
-# Redistribution and use, with or without modification, are permitted
-# provided that the following conditions are met:
-# 
-#    1. Redistributions must retain the above copyright notice, this
-#       list of conditions and the following disclaimer.
-#    2. The name of the author may not be used to endorse or promote
-#       products derived from this software without specific prior
-#       written permission.
-# 
-# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
-# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
-# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
-# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
-# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
-# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
-# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
-# IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
-# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
-# IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-
-### Common stuff ####
-set(PKG_CONFIG_VERSION 1)
-set(PKG_CONFIG_FOUND   0)
-
-find_program(PKG_CONFIG_EXECUTABLE NAMES pkg-config DOC "pkg-config executable")
-mark_as_advanced(PKG_CONFIG_EXECUTABLE)
-
-if(PKG_CONFIG_EXECUTABLE)
-  set(PKG_CONFIG_FOUND 1)
-endif(PKG_CONFIG_EXECUTABLE)
-
-
-# Unsets the given variables
-macro(_pkgconfig_unset var)
-  set(${var} "" CACHE INTERNAL "")
-endmacro(_pkgconfig_unset)
-
-macro(_pkgconfig_set var value)
-  set(${var} ${value} CACHE INTERNAL "")
-endmacro(_pkgconfig_set)
-
-# Invokes pkgconfig, cleans up the result and sets variables
-macro(_pkgconfig_invoke _pkglist _prefix _varname _regexp)
-  set(_pkgconfig_invoke_result)
-
-  execute_process(
-    COMMAND ${PKG_CONFIG_EXECUTABLE} ${ARGN} ${_pkglist}
-    OUTPUT_VARIABLE _pkgconfig_invoke_result
-    RESULT_VARIABLE _pkgconfig_failed)
-
-  if (_pkgconfig_failed)
-    set(_pkgconfig_${_varname} "")
-    _pkgconfig_unset(${_prefix}_${_varname})
-  else(_pkgconfig_failed)
-    string(REGEX REPLACE "[\r\n]"                  " " _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
-    string(REGEX REPLACE " +$"                     ""  _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
-
-    if (NOT ${_regexp} STREQUAL "")
-      string(REGEX REPLACE "${_regexp}" " " _pkgconfig_invoke_result "${_pkgconfig_invoke_result}")
-    endif(NOT ${_regexp} STREQUAL "")
-
-    separate_arguments(_pkgconfig_invoke_result)
-
-    #message(STATUS "  ${_varname} ... ${_pkgconfig_invoke_result}")
-    set(_pkgconfig_${_varname} ${_pkgconfig_invoke_result})
-    _pkgconfig_set(${_prefix}_${_varname} "${_pkgconfig_invoke_result}")
-  endif(_pkgconfig_failed)
-endmacro(_pkgconfig_invoke)
-
-# Invokes pkgconfig two times; once without '--static' and once with
-# '--static'
-macro(_pkgconfig_invoke_dyn _pkglist _prefix _varname cleanup_regexp)
-  _pkgconfig_invoke("${_pkglist}" ${_prefix}        ${_varname} "${cleanup_regexp}" ${ARGN})
-  _pkgconfig_invoke("${_pkglist}" ${_prefix} STATIC_${_varname} "${cleanup_regexp}" --static  ${ARGN})
-endmacro(_pkgconfig_invoke_dyn)
-
-# Splits given arguments into options and a package list
-macro(_pkgconfig_parse_options _result _is_req)
-  set(${_is_req} 0)
-  
-  foreach(_pkg ${ARGN})
-    if (_pkg STREQUAL "REQUIRED")
-      set(${_is_req} 1)
-    endif (_pkg STREQUAL "REQUIRED")
-  endforeach(_pkg ${ARGN})
-
-  set(${_result} ${ARGN})
-  list(REMOVE_ITEM ${_result} "REQUIRED")
-endmacro(_pkgconfig_parse_options)
-
-###
-macro(_pkg_check_modules_internal _is_required _is_silent _prefix)
-  _pkgconfig_unset(${_prefix}_FOUND)
-  _pkgconfig_unset(${_prefix}_VERSION)
-  _pkgconfig_unset(${_prefix}_PREFIX)
-  _pkgconfig_unset(${_prefix}_INCLUDEDIR)
-  _pkgconfig_unset(${_prefix}_LIBDIR)
-  _pkgconfig_unset(${_prefix}_LIBS)
-  _pkgconfig_unset(${_prefix}_LIBS_L)
-  _pkgconfig_unset(${_prefix}_LIBS_PATHS)
-  _pkgconfig_unset(${_prefix}_LIBS_OTHER)
-  _pkgconfig_unset(${_prefix}_CFLAGS)
-  _pkgconfig_unset(${_prefix}_CFLAGS_I)
-  _pkgconfig_unset(${_prefix}_CFLAGS_OTHER)
-  _pkgconfig_unset(${_prefix}_STATIC_LIBDIR)
-  _pkgconfig_unset(${_prefix}_STATIC_LIBS)
-  _pkgconfig_unset(${_prefix}_STATIC_LIBS_L)
-  _pkgconfig_unset(${_prefix}_STATIC_LIBS_PATHS)
-  _pkgconfig_unset(${_prefix}_STATIC_LIBS_OTHER)
-  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS)
-  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_I)
-  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_OTHER)
-
-  # create a better addressable variable of the modules and calculate its size
-  set(_pkg_check_modules_list ${ARGN})
-  list(LENGTH _pkg_check_modules_list _pkg_check_modules_cnt)
-
-  if(PKG_CONFIG_EXECUTABLE)
-    # give out status message telling checked module
-    if (NOT ${_is_silent})
-      if (_pkg_check_modules_cnt EQUAL 1)
-        message(STATUS "checking for module '${_pkg_check_modules_list}'")
-      else(_pkg_check_modules_cnt EQUAL 1)
-        message(STATUS "checking for modules '${_pkg_check_modules_list}'")
-      endif(_pkg_check_modules_cnt EQUAL 1)
-    endif(NOT ${_is_silent})
-    
-    set(_pkg_check_modules_packages)
-    set(_pkg_check_modules_failed)
-
-    # iterate through module list and check whether they exist and match the required version
-    foreach (_pkg_check_modules_pkg ${_pkg_check_modules_list})
-      set(_pkg_check_modules_exist_query)
-
-      # check whether version is given
-      if (_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
-        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\1" _pkg_check_modules_pkg_name "${_pkg_check_modules_pkg}")
-        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\2" _pkg_check_modules_pkg_op   "${_pkg_check_modules_pkg}")
-        string(REGEX REPLACE "(.*[^><])(>=|=|<=)(.*)" "\\3" _pkg_check_modules_pkg_ver  "${_pkg_check_modules_pkg}")
-      else(_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
-        set(_pkg_check_modules_pkg_name "${_pkg_check_modules_pkg}")
-        set(_pkg_check_modules_pkg_op)
-        set(_pkg_check_modules_pkg_ver)
-      endif(_pkg_check_modules_pkg MATCHES ".*(>=|=|<=).*")
-
-      # handle the operands
-      if (_pkg_check_modules_pkg_op STREQUAL ">=")
-        list(APPEND _pkg_check_modules_exist_query --atleast-version)
-      endif(_pkg_check_modules_pkg_op STREQUAL ">=")
-
-      if (_pkg_check_modules_pkg_op STREQUAL "=")
-        list(APPEND _pkg_check_modules_exist_query --exact-version)
-      endif(_pkg_check_modules_pkg_op STREQUAL "=")
-      
-      if (_pkg_check_modules_pkg_op STREQUAL "<=")
-        list(APPEND _pkg_check_modules_exist_query --max-version)
-      endif(_pkg_check_modules_pkg_op STREQUAL "<=")
-
-      # create the final query which is of the format:
-      # * --atleast-version <version> <pkg-name>
-      # * --exact-version <version> <pkg-name>      
-      # * --max-version <version> <pkg-name>
-      # * --exists <pkg-name>
-      if (_pkg_check_modules_pkg_op)
-        list(APPEND _pkg_check_modules_exist_query "${_pkg_check_modules_pkg_ver}")
-      else(_pkg_check_modules_pkg_op)
-        list(APPEND _pkg_check_modules_exist_query --exists)
-      endif(_pkg_check_modules_pkg_op)
-
-      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_VERSION)
-      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_PREFIX)
-      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_INCLUDEDIR)
-      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_LIBDIR)
-
-      list(APPEND _pkg_check_modules_exist_query "${_pkg_check_modules_pkg_name}")
-      list(APPEND _pkg_check_modules_packages    "${_pkg_check_modules_pkg_name}")
-
-      # execute the query
-      execute_process(
-        COMMAND ${PKG_CONFIG_EXECUTABLE} ${_pkg_check_modules_exist_query}
-        RESULT_VARIABLE _pkgconfig_retval)
-
-      # evaluate result and tell failures
-      if (_pkgconfig_retval)
-        if(NOT ${_is_silent})
-          message(STATUS "  package '${_pkg_check_modules_pkg}' not found")
-        endif(NOT ${_is_silent})
-
-        set(_pkg_check_modules_failed 1)
-      endif(_pkgconfig_retval)
-    endforeach(_pkg_check_modules_pkg)
-
-    if(_pkg_check_modules_failed)
-      # fail when requested
-      if (${_is_required})
-        message(SEND_ERROR "A required package was not found")
-      endif (${_is_required})
-    else(_pkg_check_modules_failed)
-      # when we are here, we checked whether requested modules
-      # exist. Now, go through them and set variables
-      
-      _pkgconfig_set(${_prefix}_FOUND 1)
-      list(LENGTH _pkg_check_modules_packages pkg_count)
-
-      # iterate through all modules again and set individual variables
-      foreach (_pkg_check_modules_pkg ${_pkg_check_modules_packages})
-        # handle case when there is only one package required
-        if (pkg_count EQUAL 1)
-          set(_pkg_check_prefix "${_prefix}")
-        else(pkg_count EQUAL 1)
-          set(_pkg_check_prefix "${_prefix}_${_pkg_check_modules_pkg}")
-        endif(pkg_count EQUAL 1)
-        
-        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" VERSION    ""   --modversion )
-        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" PREFIX     ""   --variable=prefix )
-        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" INCLUDEDIR ""   --variable=includedir )
-        _pkgconfig_invoke(${_pkg_check_modules_pkg} "${_pkg_check_prefix}" LIBDIR     ""   --variable=libdir )
-
-        message(STATUS "  found ${_pkg_check_modules_pkg}, version ${_pkgconfig_VERSION}")
-      endforeach(_pkg_check_modules_pkg)
-
-      # set variables which are combined for multiple modules
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LIBRARIES           "(^| )-l" --libs-only-l )
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LIBRARY_DIRS        "(^| )-L" --libs-only-L )
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LDFLAGS             ""        --libs )
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" LDFLAGS_OTHER       ""        --libs-only-other )
-
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" INCLUDE_DIRS        "(^| )-I" --cflags-only-I )
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" CFLAGS              ""        --cflags )
-      _pkgconfig_invoke_dyn("${_pkg_check_modules_packages}" "${_prefix}" CFLAGS_OTHER        ""        --cflags-only-other )
-    endif(_pkg_check_modules_failed)
-  else(PKG_CONFIG_EXECUTABLE)
-    if (${_is_required})
-      message(SEND_ERROR "pkg-config tool not found")
-    endif (${_is_required})
-  endif(PKG_CONFIG_EXECUTABLE)
-endmacro(_pkg_check_modules_internal)
-
-###
-### User visible macros start here
-###
-
-###
-macro(pkg_check_modules _prefix _module0)
-  # check cached value
-  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
-    _pkgconfig_parse_options   (_pkg_modules _pkg_is_required "${_module0}" ${ARGN})
-    _pkg_check_modules_internal("${_pkg_is_required}" 0 "${_prefix}" ${_pkg_modules})
-
-    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
-  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
-endmacro(pkg_check_modules)
-
-###
-macro(pkg_search_module _prefix _module0)
-  # check cached value
-  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
-    set(_pkg_modules_found 0)
-    _pkgconfig_parse_options(_pkg_modules_alt _pkg_is_required "${_module0}" ${ARGN})
-
-    message(STATUS "checking for one of the modules '${_pkg_modules_alt}'")
-
-    # iterate through all modules and stop at the first working one.
-    foreach(_pkg_alt ${_pkg_modules_alt})
-      if(NOT _pkg_modules_found)
-        _pkg_check_modules_internal(0 1 "${_prefix}" "${_pkg_alt}")
-      endif(NOT _pkg_modules_found)
-
-      if (${_prefix}_FOUND)
-        set(_pkg_modules_found 1)
-      endif(${_prefix}_FOUND)
-    endforeach(_pkg_alt)
-
-    if (NOT ${_prefix}_FOUND)
-      if(${_pkg_is_required})
-        message(SEND_ERROR "None of the required '${_pkg_modules_alt}' found")
-      endif(${_pkg_is_required})
-    endif(NOT ${_prefix}_FOUND)
-    
-    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
-  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})  
-endmacro(pkg_search_module)
-
-### Local Variables:
-### mode: cmake
-### End:

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,1030 +0,0 @@
-# - Find QT 4
-# This module can be used to find Qt4.
-# The most important issue is that the Qt4 qmake is available via the system path.
-# This qmake is then used to detect basically everything else.
-# This module defines a number of key variables and macros. First is 
-# QT_USE_FILE which is the path to a CMake file that can be included to compile
-# Qt 4 applications and libraries.  By default, the QtCore and QtGui 
-# libraries are loaded. This behavior can be changed by setting one or more 
-# of the following variables to true:
-#                    QT_DONT_USE_QTCORE
-#                    QT_DONT_USE_QTGUI
-#                    QT_USE_QT3SUPPORT
-#                    QT_USE_QTASSISTANT
-#                    QT_USE_QTDESIGNER
-#                    QT_USE_QTMOTIF
-#                    QT_USE_QTMAIN
-#                    QT_USE_QTNETWORK
-#                    QT_USE_QTNSPLUGIN
-#                    QT_USE_QTOPENGL
-#                    QT_USE_QTSQL
-#                    QT_USE_QTXML
-#                    QT_USE_QTSVG
-#                    QT_USE_QTTEST
-#                    QT_USE_QTUITOOLS
-#
-# All the libraries required are stored in a variable called QT_LIBRARIES.  
-# Add this variable to your TARGET_LINK_LIBRARIES.
-#  
-#  macro QT4_WRAP_CPP(outfiles inputfile ... )
-#  macro QT4_WRAP_UI(outfiles inputfile ... )
-#  macro QT4_ADD_RESOURCE(outfiles inputfile ... )
-#  macro QT4_AUTOMOC(inputfile ... )
-#  macro QT4_GENERATE_MOC(inputfile outputfile )
-#  
-#  QT_FOUND         If false, don't try to use Qt.
-#  QT4_FOUND        If false, don't try to use Qt 4.
-#                      
-#  QT_QTCORE_FOUND        True if QtCore was found.
-#  QT_QTGUI_FOUND         True if QtGui was found.
-#  QT_QT3SUPPORT_FOUND    True if Qt3Support was found.
-#  QT_QTASSISTANT_FOUND   True if QtAssistant was found.
-#  QT_QTDESIGNER_FOUND    True if QtDesigner was found.
-#  QT_QTMOTIF_FOUND       True if QtMotif was found.
-#  QT_QTNETWORK_FOUND     True if QtNetwork was found.
-#  QT_QTNSPLUGIN_FOUND    True if QtNsPlugin was found.
-#  QT_QTOPENGL_FOUND      True if QtOpenGL was found.
-#  QT_QTSQL_FOUND         True if QtSql was found.
-#  QT_QTXML_FOUND         True if QtXml was found.
-#  QT_QTSVG_FOUND         True if QtSvg was found.
-#  QT_QTTEST_FOUND        True if QtTest was found.
-#  QT_QTUITOOLS_FOUND     True if QtUiTools was found.
-#                      
-#  QT_DEFINITIONS   Definitions to use when compiling code that uses Qt.
-#                  
-#  QT_INCLUDES      List of paths to all include directories of 
-#                   Qt4 QT_INCLUDE_DIR and QT_QTCORE_INCLUDE_DIR are
-#                   always in this variable even if NOTFOUND,
-#                   all other INCLUDE_DIRS are
-#                   only added if they are found.
-#   
-#  QT_INCLUDE_DIR              Path to "include" of Qt4
-#  QT_QT_INCLUDE_DIR           Path to "include/Qt" 
-#  QT_QT3SUPPORT_INCLUDE_DIR   Path to "include/Qt3Support" 
-#  QT_QTASSISTANT_INCLUDE_DIR  Path to "include/QtAssistant" 
-#  QT_QTCORE_INCLUDE_DIR       Path to "include/QtCore"         
-#  QT_QTDESIGNER_INCLUDE_DIR   Path to "include/QtDesigner" 
-#  QT_QTGUI_INCLUDE_DIR        Path to "include/QtGui" 
-#  QT_QTMOTIF_INCLUDE_DIR      Path to "include/QtMotif" 
-#  QT_QTNETWORK_INCLUDE_DIR    Path to "include/QtNetwork" 
-#  QT_QTNSPLUGIN_INCLUDE_DIR   Path to "include/QtNsPlugin" 
-#  QT_QTOPENGL_INCLUDE_DIR     Path to "include/QtOpenGL" 
-#  QT_QTSQL_INCLUDE_DIR        Path to "include/QtSql" 
-#  QT_QTXML_INCLUDE_DIR        Path to "include/QtXml" 
-#  QT_QTSVG_INCLUDE_DIR        Path to "include/QtSvg"
-#  QT_QTTEST_INCLUDE_DIR       Path to "include/QtTest"
-#                            
-#  QT_LIBRARY_DIR              Path to "lib" of Qt4
-#                            
-#  QT_PLUGINS_DIR              Path to "plugins" for Qt4
-#                            
-# For every library of Qt there are three variables:
-#  QT_QTFOO_LIBRARY_RELEASE, which contains the full path to the release version
-#  QT_QTFOO_LIBRARY_DEBUG, which contains the full path to the debug version
-#  QT_QTFOO_LIBRARY, the full path to the release version if available, otherwise to the debug version
-#
-# So there are the following variables:
-# The Qt3Support library:     QT_QT3SUPPORT_LIBRARY
-#                             QT_QT3SUPPORT_LIBRARY_RELEASE
-#                             QT_QT3SUPPORT_DEBUG
-#
-# The QtAssistant library:    QT_QTASSISTANT_LIBRARY
-#                             QT_QTASSISTANT_LIBRARY_RELEASE
-#                             QT_QTASSISTANT_LIBRARY_DEBUG
-#
-# The QtCore library:         QT_QTCORE_LIBRARY
-#                             QT_QTCORE_LIBRARY_RELEASE
-#                             QT_QTCORE_LIBRARY_DEBUG
-#
-# The QtDesigner library:     QT_QTDESIGNER_LIBRARY
-#                             QT_QTDESIGNER_LIBRARY_RELEASE
-#                             QT_QTDESIGNER_LIBRARY_DEBUG
-#
-# The QtGui library:          QT_QTGUI_LIBRARY
-#                             QT_QTGUI_LIBRARY_RELEASE
-#                             QT_QTGUI_LIBRARY_DEBUG
-#
-# The QtMotif library:        QT_QTMOTIF_LIBRARY
-#                             QT_QTMOTIF_LIBRARY_RELEASE
-#                             QT_QTMOTIF_LIBRARY_DEBUG
-#
-# The QtNetwork library:      QT_QTNETWORK_LIBRARY
-#                             QT_QTNETWORK_LIBRARY_RELEASE
-#                             QT_QTNETWORK_LIBRARY_DEBUG
-#
-# The QtNsPLugin library:     QT_QTNSPLUGIN_LIBRARY
-#                             QT_QTNSPLUGIN_LIBRARY_RELEASE
-#                             QT_QTNSPLUGIN_LIBRARY_DEBUG
-#
-# The QtOpenGL library:       QT_QTOPENGL_LIBRARY
-#                             QT_QTOPENGL_LIBRARY_RELEASE
-#                             QT_QTOPENGL_LIBRARY_DEBUG
-#
-# The QtSql library:          QT_QTSQL_LIBRARY
-#                             QT_QTSQL_LIBRARY_RELEASE
-#                             QT_QTSQL_LIBRARY_DEBUG
-#
-# The QtXml library:          QT_QTXML_LIBRARY
-#                             QT_QTXML_LIBRARY_RELEASE
-#                             QT_QTXML_LIBRARY_DEBUG
-#
-# The QtSvg library:          QT_QTSVG_LIBRARY
-#                             QT_QTSVG_LIBRARY_RELEASE
-#                             QT_QTSVG_LIBRARY_DEBUG
-#
-# The QtTest library:         QT_QTTEST_LIBRARY
-#                             QT_QTTEST_LIBRARY_RELEASE
-#                             QT_QTTEST_LIBRARY_DEBUG
-#
-# The qtmain library for Windows QT_QTMAIN_LIBRARY
-#                             QT_QTMAIN_LIBRARY_RELEASE
-#                             QT_QTMAIN_LIBRARY_DEBUG
-#
-#The QtUiTools library:       QT_QTUITOOLS_LIBRARY
-#                             QT_QTUITOOLS_LIBRARY_RELEASE
-#                             QT_QTUITOOLS_LIBRARY_DEBUG
-#  
-# also defined, but NOT for general use are
-#  QT_MOC_EXECUTABLE          Where to find the moc tool.
-#  QT_UIC_EXECUTABLE          Where to find the uic tool.
-#  QT_UIC3_EXECUTABLE         Where to find the uic3 tool.
-#  QT_RCC_EXECUTABLE          Where to find the rcc tool
-#  
-#  QT_DOC_DIR                 Path to "doc" of Qt4
-#  QT_MKSPECS_DIR             Path to "mkspecs" of Qt4
-#
-#
-# These are around for backwards compatibility 
-# they will be set
-#  QT_WRAP_CPP  Set true if QT_MOC_EXECUTABLE is found
-#  QT_WRAP_UI   Set true if QT_UIC_EXECUTABLE is found
-#  
-# These variables do _NOT_ have any effect anymore (compared to FindQt.cmake)
-#  QT_MT_REQUIRED         Qt4 is now always multithreaded
-#  
-# These variables are set to "" Because Qt structure changed 
-# (They make no sense in Qt4)
-#  QT_QT_LIBRARY        Qt-Library is now split
-
-INCLUDE(CheckSymbolExists)
-INCLUDE(MacroAddFileDependencies)
-
-SET(QT_USE_FILE ${CMAKE_ROOT}/Modules/UseQt4.cmake)
-
-SET( QT_DEFINITIONS "")
-
-# check for qmake
-FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake-qt4 PATHS
-  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
-  "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
-  $ENV{QTDIR}/bin
-  )
-
-SET(QT4_INSTALLED_VERSION_TOO_OLD FALSE)
-
-##  macro for asking qmake to process pro files
-MACRO(QT_QUERY_QMAKE outvar invar)
-  FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake/tmp.pro
-    "message(CMAKE_MESSAGE<$$${invar}>)")
-  EXECUTE_PROCESS(COMMAND ${QT_QMAKE_EXECUTABLE}
-    WORKING_DIRECTORY  
-    ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake
-    OUTPUT_VARIABLE _qmake_query_output
-    ERROR_VARIABLE _qmake_query_output )
-  FILE(REMOVE_RECURSE 
-    "${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake")
-  STRING(REGEX REPLACE ".*CMAKE_MESSAGE<([^>]*).*" "\\1" ${outvar} "${_qmake_query_output}")
-ENDMACRO(QT_QUERY_QMAKE)
-
-
-IF (QT_QMAKE_EXECUTABLE)
-
-   SET(QT4_QMAKE_FOUND FALSE)
-   
-   EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
-  # check for qt3 qmake and then try and find qmake-qt4 in the path
-  IF("${QTVERSION}" MATCHES "Unknown")
-    SET(QT_QMAKE_EXECUTABLE NOTFOUND CACHE FILEPATH "" FORCE)
-    FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake-qt4 PATHS
-      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
-      "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
-      $ENV{QTDIR}/bin
-      )
-    IF(QT_QMAKE_EXECUTABLE)
-      EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} 
-        ARGS "-query QT_VERSION" OUTPUT_VARIABLE QTVERSION)
-    ENDIF(QT_QMAKE_EXECUTABLE)
-  ENDIF("${QTVERSION}" MATCHES "Unknown")
-   # check that we found the Qt4 qmake, Qt3 qmake output won't match here
-   STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" qt_version_tmp "${QTVERSION}")
-   IF (qt_version_tmp)
-
-      # we need at least version 4.0.0
-      IF (NOT QT_MIN_VERSION)
-         SET(QT_MIN_VERSION "4.0.0")
-      ENDIF (NOT QT_MIN_VERSION)
-   
-      #now parse the parts of the user given version string into variables
-      STRING(REGEX MATCH "^[0-9]+\\.[0-9]+\\.[0-9]+" req_qt_major_vers "${QT_MIN_VERSION}")
-      IF (NOT req_qt_major_vers)
-         MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", expected e.g. \"4.0.1\"")
-      ENDIF (NOT req_qt_major_vers)
-   
-      # now parse the parts of the user given version string into variables
-      STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+" "\\1" req_qt_major_vers "${QT_MIN_VERSION}")
-      STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+" "\\1" req_qt_minor_vers "${QT_MIN_VERSION}")
-      STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+)" "\\1" req_qt_patch_vers "${QT_MIN_VERSION}")
-   
-      IF (NOT req_qt_major_vers EQUAL 4)
-         MESSAGE( FATAL_ERROR "Invalid Qt version string given: \"${QT_MIN_VERSION}\", major version 4 is required, e.g. \"4.0.1\"")
-      ENDIF (NOT req_qt_major_vers EQUAL 4)
-   
-      # and now the version string given by qmake
-      STRING(REGEX REPLACE "^([0-9]+)\\.[0-9]+\\.[0-9]+.*" "\\1" found_qt_major_vers "${QTVERSION}")
-      STRING(REGEX REPLACE "^[0-9]+\\.([0-9])+\\.[0-9]+.*" "\\1" found_qt_minor_vers "${QTVERSION}")
-      STRING(REGEX REPLACE "^[0-9]+\\.[0-9]+\\.([0-9]+).*" "\\1" found_qt_patch_vers "${QTVERSION}")
-   
-      # compute an overall version number which can be compared at once
-      MATH(EXPR req_vers "${req_qt_major_vers}*10000 + ${req_qt_minor_vers}*100 + ${req_qt_patch_vers}")
-      MATH(EXPR found_vers "${found_qt_major_vers}*10000 + ${found_qt_minor_vers}*100 + ${found_qt_patch_vers}")
-   
-      IF (found_vers LESS req_vers)
-         SET(QT4_QMAKE_FOUND FALSE)
-         SET(QT4_INSTALLED_VERSION_TOO_OLD TRUE)
-      ELSE (found_vers LESS req_vers)
-    SET(QT4_QMAKE_FOUND TRUE)
-      ENDIF (found_vers LESS req_vers)
-   ENDIF (qt_version_tmp)
-
-ENDIF (QT_QMAKE_EXECUTABLE)
-
-IF (QT4_QMAKE_FOUND)
-
-  # ask qmake for the library dir
-  # Set QT_LIBRARY_DIR
-  IF (NOT QT_LIBRARY_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_LIBS"
-      OUTPUT_VARIABLE QT_LIBRARY_DIR_TMP )
-    IF(EXISTS "${QT_LIBRARY_DIR_TMP}")
-      SET(QT_LIBRARY_DIR ${QT_LIBRARY_DIR_TMP} CACHE PATH "Qt library dir")
-    ELSE(EXISTS "${QT_LIBRARY_DIR_TMP}")
-      MESSAGE("Warning: QT_QMAKE_EXECUTABLE reported QT_INSTALL_LIBS as ${QT_LIBRARY_DIR_TMP}")
-       MESSAGE("Warning: ${QT_LIBRARY_DIR_TMP} does NOT exist, Qt must NOT be installed correctly.")
-    ENDIF(EXISTS "${QT_LIBRARY_DIR_TMP}")
-  ENDIF(NOT QT_LIBRARY_DIR)
-  
-  IF (APPLE)
-    IF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS ON
-        CACHE BOOL "Set to ON if Qt build uses frameworks.")
-    ELSE (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS OFF
-        CACHE BOOL "Set to ON if Qt build uses frameworks.")
-    ENDIF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-    
-    MARK_AS_ADVANCED(QT_USE_FRAMEWORKS)
-  ENDIF (APPLE)
-  
-  # ask qmake for the binary dir
-  IF (NOT QT_BINARY_DIR)
-     EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE}
-        ARGS "-query QT_INSTALL_BINS"
-        OUTPUT_VARIABLE qt_bins )
-     SET(QT_BINARY_DIR ${qt_bins} CACHE INTERNAL "")
-  ENDIF (NOT QT_BINARY_DIR)
-
-  # ask qmake for the include dir
-  IF (NOT QT_HEADERS_DIR)
-      EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-        ARGS "-query QT_INSTALL_HEADERS" 
-        OUTPUT_VARIABLE qt_headers )
-      SET(QT_HEADERS_DIR ${qt_headers} CACHE INTERNAL "")
-  ENDIF(NOT QT_HEADERS_DIR)
-
-
-  # ask qmake for the documentation directory
-  IF (NOT QT_DOC_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_DOCS"
-      OUTPUT_VARIABLE qt_doc_dir )
-    SET(QT_DOC_DIR ${qt_doc_dir} CACHE PATH "The location of the Qt docs")
-  ENDIF (NOT QT_DOC_DIR)
-
-  # ask qmake for the mkspecs directory
-  IF (NOT QT_MKSPECS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QMAKE_MKSPECS"
-      OUTPUT_VARIABLE qt_mkspecs_dir )
-    SET(QT_MKSPECS_DIR ${qt_mkspecs_dir} CACHE PATH "The location of the Qt mkspecs")
-  ENDIF (NOT QT_MKSPECS_DIR)
-
-  # ask qmake for the plugins directory
-  IF (NOT QT_PLUGINS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS "-query QT_INSTALL_PLUGINS"
-      OUTPUT_VARIABLE qt_plugins_dir )
-    SET(QT_PLUGINS_DIR ${qt_plugins_dir} CACHE PATH "The location of the Qt plugins")
-  ENDIF (NOT QT_PLUGINS_DIR)
-  ########################################
-  #
-  #       Setting the INCLUDE-Variables
-  #
-  ########################################
-
-  FIND_PATH(QT_QTCORE_INCLUDE_DIR QtGlobal
-    ${QT_HEADERS_DIR}/QtCore
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-   )
-
-  # Set QT_INCLUDE_DIR by removine "/QtCore" in the string ${QT_QTCORE_INCLUDE_DIR}
-  IF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-    IF (QT_USE_FRAMEWORKS)
-      SET(QT_INCLUDE_DIR ${QT_HEADERS_DIR})
-    ELSE (QT_USE_FRAMEWORKS)
-      STRING( REGEX REPLACE "/QtCore$" "" qt4_include_dir ${QT_QTCORE_INCLUDE_DIR})
-      SET( QT_INCLUDE_DIR ${qt4_include_dir} CACHE PATH "")
-    ENDIF (QT_USE_FRAMEWORKS)
-  ENDIF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-
-  IF( NOT QT_INCLUDE_DIR)
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR "Could NOT find QtGlobal header")
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_INCLUDE_DIR)
-
-  #############################################
-  #
-  # Find out what window system we're using
-  #
-  #############################################
-  # Save required includes variable
-  SET(CMAKE_REQUIRED_INCLUDES_SAVE ${CMAKE_REQUIRED_INCLUDES})
-  # Add QT_INCLUDE_DIR to CMAKE_REQUIRED_INCLUDES
-  SET(CMAKE_REQUIRED_INCLUDES "${CMAKE_REQUIRED_INCLUDES};${QT_INCLUDE_DIR}")
-  # Check for Window system symbols (note: only one should end up being set)
-  CHECK_SYMBOL_EXISTS(Q_WS_X11 "QtCore/qglobal.h" Q_WS_X11)
-  CHECK_SYMBOL_EXISTS(Q_WS_MAC "QtCore/qglobal.h" Q_WS_MAC)
-  CHECK_SYMBOL_EXISTS(Q_WS_WIN "QtCore/qglobal.h" Q_WS_WIN)
-
-  IF (QT_QTCOPY_REQUIRED)
-     CHECK_SYMBOL_EXISTS(QT_IS_QTCOPY "QtCore/qglobal.h" QT_KDE_QT_COPY)
-     IF (NOT QT_IS_QTCOPY)
-        MESSAGE(FATAL_ERROR "qt-copy is required, but hasn't been found")
-     ENDIF (NOT QT_IS_QTCOPY)
-  ENDIF (QT_QTCOPY_REQUIRED)
-
-  # Restore CMAKE_REQUIRED_INCLUDES variable
-  SET(CMAKE_REQUIRED_INCLUDES ${CMAKE_REQUIRED_INCLUDES_SAVE})
-  #
-  #############################################
-
-  IF (QT_USE_FRAMEWORKS)
-    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -F${QT_LIBRARY_DIR} -L${QT_LIBRARY_DIR} )
-  ENDIF (QT_USE_FRAMEWORKS)
-
-  # Set QT_QT3SUPPORT_INCLUDE_DIR
-  FIND_PATH(QT_QT3SUPPORT_INCLUDE_DIR Qt3Support
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt3Support
-    ${QT_LIBRARY_DIR}/Qt3Support.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QT_INCLUDE_DIR
-  FIND_PATH(QT_QT_INCLUDE_DIR qglobal.h
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTGUI_INCLUDE_DIR
-  FIND_PATH(QT_QTGUI_INCLUDE_DIR QtGui
-    PATHS
-    ${QT_INCLUDE_DIR}/QtGui
-    ${QT_LIBRARY_DIR}/QtGui.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSVG_INCLUDE_DIR
-  FIND_PATH(QT_QTSVG_INCLUDE_DIR QtSvg
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSvg
-    ${QT_LIBRARY_DIR}/QtSvg.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTTEST_INCLUDE_DIR
-  FIND_PATH(QT_QTTEST_INCLUDE_DIR QtTest
-    PATHS
-    ${QT_INCLUDE_DIR}/QtTest
-    ${QT_LIBRARY_DIR}/QtTest.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTUITOOLS_INCLUDE_DIR
-  FIND_PATH(QT_QTUITOOLS_INCLUDE_DIR QtUiTools
-    PATHS
-    ${QT_INCLUDE_DIR}/QtUiTools
-    ${QT_LIBRARY_DIR}/QtUiTools.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-
-
-  # Set QT_QTMOTIF_INCLUDE_DIR
-  IF(Q_WS_X11)
-    FIND_PATH(QT_QTMOTIF_INCLUDE_DIR QtMotif PATHS ${QT_INCLUDE_DIR}/QtMotif NO_DEFAULT_PATH )
-  ENDIF(Q_WS_X11)
-
-  # Set QT_QTNETWORK_INCLUDE_DIR
-  FIND_PATH(QT_QTNETWORK_INCLUDE_DIR QtNetwork
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNetwork
-    ${QT_LIBRARY_DIR}/QtNetwork.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTNSPLUGIN_INCLUDE_DIR
-  FIND_PATH(QT_QTNSPLUGIN_INCLUDE_DIR QtNsPlugin
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNsPlugin
-    ${QT_LIBRARY_DIR}/QtNsPlugin.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTOPENGL_INCLUDE_DIR
-  FIND_PATH(QT_QTOPENGL_INCLUDE_DIR QtOpenGL
-    PATHS
-    ${QT_INCLUDE_DIR}/QtOpenGL
-    ${QT_LIBRARY_DIR}/QtOpenGL.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSQL_INCLUDE_DIR
-  FIND_PATH(QT_QTSQL_INCLUDE_DIR QtSql
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSql
-    ${QT_LIBRARY_DIR}/QtSql.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTXML_INCLUDE_DIR
-  FIND_PATH(QT_QTXML_INCLUDE_DIR QtXml
-    PATHS
-    ${QT_INCLUDE_DIR}/QtXml
-    ${QT_LIBRARY_DIR}/QtXml.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTASSISTANT_INCLUDE_DIR
-  FIND_PATH(QT_QTASSISTANT_INCLUDE_DIR QtAssistant
-    PATHS
-    ${QT_INCLUDE_DIR}/QtAssistant
-    ${QT_HEADERS_DIR}/QtAssistant
-    ${QT_LIBRARY_DIR}/QtAssistant.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTDESIGNER_INCLUDE_DIR
-  FIND_PATH(QT_QTDESIGNER_INCLUDE_DIR QDesignerComponents
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDesigner
-    ${QT_HEADERS_DIR}/QtDesigner
-    ${QT_LIBRARY_DIR}/QtDesigner.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Make variables changeble to the advanced user
-  MARK_AS_ADVANCED( QT_LIBRARY_DIR QT_INCLUDE_DIR QT_QT_INCLUDE_DIR QT_DOC_DIR)
-
-  # Set QT_INCLUDES
-  SET( QT_INCLUDES ${QT_INCLUDE_DIR} ${QT_QT_INCLUDE_DIR} ${QT_MKSPECS_DIR}/default )
-
-    # Set QT_QTCORE_LIBRARY by searching for a lib with "QtCore."  as part of the filename
-    FIND_LIBRARY(QT_QTCORE_LIBRARY_RELEASE NAMES QtCore QtCore4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH )
-  FIND_LIBRARY(QT_QTCORE_LIBRARY_DEBUG NAMES QtCore_debug QtCored QtCored4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QT3SUPPORT_LIBRARY
-    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_RELEASE NAMES Qt3Support Qt3Support4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_DEBUG   NAMES Qt3Support_debug Qt3Supportd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTGUI_LIBRARY
-    FIND_LIBRARY(QT_QTGUI_LIBRARY_RELEASE NAMES QtGui QtGui4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTGUI_LIBRARY_DEBUG   NAMES QtGui_debug QtGuid4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTMOTIF_LIBRARY
-    IF(Q_WS_X11)
-      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_RELEASE NAMES QtMotif PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_DEBUG   NAMES QtMotif_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-    ENDIF(Q_WS_X11)
-
-    # Set QT_QTNETWORK_LIBRARY
-    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_RELEASE NAMES QtNetwork QtNetwork4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_DEBUG   NAMES QtNetwork_debug QtNetworkd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTNSPLUGIN_LIBRARY
-    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_RELEASE NAMES QtNsPlugin PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_DEBUG   NAMES QtNsPlugin_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTOPENGL_LIBRARY
-    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_RELEASE NAMES QtOpenGL QtOpenGL4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_DEBUG   NAMES QtOpenGL_debug QtOpenGLd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSQL_LIBRARY
-    FIND_LIBRARY(QT_QTSQL_LIBRARY_RELEASE NAMES QtSql QtSql4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTSQL_LIBRARY_DEBUG   NAMES QtSql_debug QtSqld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTXML_LIBRARY
-    FIND_LIBRARY(QT_QTXML_LIBRARY_RELEASE NAMES QtXml QtXml4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTXML_LIBRARY_DEBUG   NAMES QtXml_debug QtXmld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSVG_LIBRARY
-    FIND_LIBRARY(QT_QTSVG_LIBRARY_RELEASE NAMES QtSvg QtSvg4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTSVG_LIBRARY_DEBUG   NAMES QtSvg_debug QtSvgd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTUITOOLS_LIBRARY
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_RELEASE NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_DEBUG   NAMES QtUiTools_debug QtUiToolsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTTEST_LIBRARY
-    FIND_LIBRARY(QT_QTTEST_LIBRARY_RELEASE NAMES QtTest QtTest4 PATHS ${QT_LIBRARY_DIR}                      NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTTEST_LIBRARY_DEBUG   NAMES QtTest_debug QtTest_debug4 QtTestd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    MARK_AS_ADVANCED(QT_QT3SUPPORT_LIBRARY QT_QTGUI_LIBRARY )
-
-  IF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR "Could NOT find QtCore. Check ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeError.log for more details.")
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
-
-  # Set QT_QTASSISTANT_LIBRARY
-  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_RELEASE NAMES QtAssistantClient QtAssistantClient4 QtAssistant QtAssistant4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_DEBUG   NAMES QtAssistantClientd QtAssistantClientd4 QtAssistantClient_debug QtAssistant_debug QtAssistantd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-  # Set QT_QTDESIGNER_LIBRARY
-  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_RELEASE NAMES QtDesigner QtDesigner4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_DEBUG   NAMES QtDesigner_debug QtDesignerd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-  # Set QT_QTMAIN_LIBRARY
-  IF(WIN32)
-    FIND_LIBRARY(QT_QTMAIN_LIBRARY_RELEASE NAMES qtmain PATHS ${QT_LIBRARY_DIR}
-      NO_DEFAULT_PATH)
-    FIND_LIBRARY(QT_QTMAIN_LIBRARY_DEBUG NAMES qtmaind PATHS ${QT_LIBRARY_DIR}
-      NO_DEFAULT_PATH)
-  ENDIF(WIN32)
-
-  ############################################
-  #
-  # Check the existence of the libraries.
-  #
-  ############################################
-
-  MACRO (_QT4_ADJUST_LIB_VARS basename)
-    IF (QT_${basename}_INCLUDE_DIR)
-
-      # if only the release version was found, set the debug variable also to the release version
-      IF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
-        SET(QT_${basename}_LIBRARY_DEBUG ${QT_${basename}_LIBRARY_RELEASE})
-        SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE})
-        SET(QT_${basename}_LIBRARIES     ${QT_${basename}_LIBRARY_RELEASE})
-      ENDIF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
-
-      # if only the debug version was found, set the release variable also to the debug version
-      IF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
-        SET(QT_${basename}_LIBRARY_RELEASE ${QT_${basename}_LIBRARY_DEBUG})
-        SET(QT_${basename}_LIBRARY         ${QT_${basename}_LIBRARY_DEBUG})
-        SET(QT_${basename}_LIBRARIES       ${QT_${basename}_LIBRARY_DEBUG})
-      ENDIF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
-      IF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
-        # if the generator supports configuration types then set
-        # optimized and debug libraries, or if the CMAKE_BUILD_TYPE has a value
-        IF (CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
-          SET(QT_${basename}_LIBRARY       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
-        ELSE(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
-          # if there are no configuration types and CMAKE_BUILD_TYPE has no value
-          # then just use the release libraries
-          SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE} )
-        ENDIF(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
-        SET(QT_${basename}_LIBRARIES       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
-      ENDIF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
-
-      SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY} CACHE FILEPATH "The Qt ${basename} library")
-
-      IF (QT_${basename}_LIBRARY)
-        SET(QT_${basename}_FOUND 1)
-      ENDIF (QT_${basename}_LIBRARY)
-
-      #add the include directory to QT_INCLUDES
-      SET(QT_INCLUDES ${QT_INCLUDES} "${QT_${basename}_INCLUDE_DIR}")
-    ENDIF (QT_${basename}_INCLUDE_DIR )
-
-    # Make variables changeble to the advanced user
-    MARK_AS_ADVANCED(QT_${basename}_LIBRARY QT_${basename}_LIBRARY_RELEASE QT_${basename}_LIBRARY_DEBUG QT_${basename}_INCLUDE_DIR)
-  ENDMACRO (_QT4_ADJUST_LIB_VARS)
-
-  IF(WIN32)
-    # there is no include for qtmain but adjust macro needs it set
-    SET(QT_QTMAIN_INCLUDE_DIR 1)
-     _QT4_ADJUST_LIB_VARS(QTMAIN)
-    SET(QT_QTMAIN_INCLUDE_DIR )
-  ENDIF(WIN32)
-
-
-  _QT4_ADJUST_LIB_VARS(QTCORE)
-  _QT4_ADJUST_LIB_VARS(QTGUI)
-  _QT4_ADJUST_LIB_VARS(QT3SUPPORT)
-  _QT4_ADJUST_LIB_VARS(QTASSISTANT)
-  _QT4_ADJUST_LIB_VARS(QTDESIGNER)
-  IF(Q_WS_X11)
-    _QT4_ADJUST_LIB_VARS(QTMOTIF)
-  ENDIF(Q_WS_X11)
-  _QT4_ADJUST_LIB_VARS(QTNETWORK)
-  _QT4_ADJUST_LIB_VARS(QTNSPLUGIN)
-  _QT4_ADJUST_LIB_VARS(QTOPENGL)
-  _QT4_ADJUST_LIB_VARS(QTSQL)
-  _QT4_ADJUST_LIB_VARS(QTXML)
-  _QT4_ADJUST_LIB_VARS(QTSVG)
-  _QT4_ADJUST_LIB_VARS(QTUITOOLS)
-  _QT4_ADJUST_LIB_VARS(QTTEST)
-
-
-
-  #######################################
-  #
-  #       Check the executables of Qt 
-  #          ( moc, uic, rcc )
-  #
-  #######################################
-
-
-   # find moc and uic using qmake
-  QT_QUERY_QMAKE(QT_MOC_EXECUTABLE_INTERNAL "QMAKE_MOC")
-  QT_QUERY_QMAKE(QT_UIC_EXECUTABLE_INTERNAL "QMAKE_UIC")
-
-   FILE(TO_CMAKE_PATH 
-     "${QT_MOC_EXECUTABLE_INTERNAL}" QT_MOC_EXECUTABLE_INTERNAL)
-   FILE(TO_CMAKE_PATH 
-     "${QT_UIC_EXECUTABLE_INTERNAL}" QT_UIC_EXECUTABLE_INTERNAL)
-
-   SET(QT_MOC_EXECUTABLE 
-     ${QT_MOC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The moc executable")
-   SET(QT_UIC_EXECUTABLE 
-     ${QT_UIC_EXECUTABLE_INTERNAL} CACHE FILEPATH "The uic executable")
-
-  FIND_PROGRAM(QT_UIC3_EXECUTABLE
-    NAMES uic3
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_RCC_EXECUTABLE 
-    NAMES rcc
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  IF (QT_MOC_EXECUTABLE)
-     SET(QT_WRAP_CPP "YES")
-  ENDIF (QT_MOC_EXECUTABLE)
-
-  IF (QT_UIC_EXECUTABLE)
-     SET(QT_WRAP_UI "YES")
-  ENDIF (QT_UIC_EXECUTABLE)
-
-
-
-  MARK_AS_ADVANCED( QT_UIC_EXECUTABLE QT_UIC3_EXECUTABLE QT_MOC_EXECUTABLE QT_RCC_EXECUTABLE )
-
-  ######################################
-  #
-  #       Macros for building Qt files
-  #
-  ######################################
-
-  MACRO (QT4_GET_MOC_INC_DIRS _moc_INC_DIRS)
-     SET(${_moc_INC_DIRS})
-     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
-
-     FOREACH(_current ${_inc_DIRS})
-        SET(${_moc_INC_DIRS} ${${_moc_INC_DIRS}} "-I" ${_current})
-     ENDFOREACH(_current ${_inc_DIRS})
-  ENDMACRO(QT4_GET_MOC_INC_DIRS)
-
-
-  MACRO (QT4_GENERATE_MOC infile outfile )
-  # get include dirs
-     QT4_GET_MOC_INC_DIRS(moc_includes)
-
-     GET_FILENAME_COMPONENT(infile ${infile} ABSOLUTE)
-
-     ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${infile}
-        DEPENDS ${infile})
-
-     MACRO_ADD_FILE_DEPENDENCIES(${infile} ${outfile})
-  ENDMACRO (QT4_GENERATE_MOC)
-
-
-  # QT4_WRAP_CPP(outfiles inputfile ... )
-  # TODO  perhaps add support for -D, -U and other minor options
-
-  MACRO (QT4_WRAP_CPP outfiles )
-    # get include dirs
-    QT4_GET_MOC_INC_DIRS(moc_includes)
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/moc_${outfile}.cxx)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${it}
-        DEPENDS ${it})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH(it)
-
-  ENDMACRO (QT4_WRAP_CPP)
-
-
-  # QT4_WRAP_UI(outfiles inputfile ... )
-
-  MACRO (QT4_WRAP_UI outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_UIC_EXECUTABLE}
-        ARGS -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_WRAP_UI)
-
-
-  # QT4_ADD_RESOURCE(outfiles inputfile ... )
-  # TODO  perhaps consider adding support for compression and root options to rcc
-
-  MACRO (QT4_ADD_RESOURCES outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
-      #  parse file for dependencies
-      FILE(READ "${infile}" _RC_FILE_CONTENTS)
-      STRING(REGEX MATCHALL "<file>[^<]*" _RC_FILES "${_RC_FILE_CONTENTS}")
-      SET(_RC_DEPENDS)
-      FOREACH(_RC_FILE ${_RC_FILES})
-        STRING(REGEX REPLACE "^<file>" "" _RC_FILE "${_RC_FILE}")
-        SET(_RC_DEPENDS ${_RC_DEPENDS} "${rc_path}/${_RC_FILE}")
-      ENDFOREACH(_RC_FILE)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_RCC_EXECUTABLE}
-        ARGS -name ${outfilename} -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile}
-        DEPENDS ${_RC_DEPENDS})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_ADD_RESOURCES)
-
-
-   MACRO(QT4_AUTOMOC)
-      QT4_GET_MOC_INC_DIRS(_moc_INCS)
-
-      SET(_matching_FILES )
-      FOREACH (_current_FILE ${ARGN})
-
-         GET_FILENAME_COMPONENT(_abs_FILE ${_current_FILE} ABSOLUTE)
-         # if "SKIP_AUTOMOC" is set to true, we will not handle this file here.
-         # here. this is required to make bouic work correctly:
-         # we need to add generated .cpp files to the sources (to compile them),
-         # but we cannot let automoc handle them, as the .cpp files don't exist yet when
-         # cmake is run for the very first time on them -> however the .cpp files might
-         # exist at a later run. at that time we need to skip them, so that we don't add two
-         # different rules for the same moc file
-         GET_SOURCE_FILE_PROPERTY(_skip ${_abs_FILE} SKIP_AUTOMOC)
-
-         IF ( NOT _skip AND EXISTS ${_abs_FILE} )
-
-            FILE(READ ${_abs_FILE} _contents)
-
-            GET_FILENAME_COMPONENT(_abs_PATH ${_abs_FILE} PATH)
-
-            STRING(REGEX MATCHALL "#include +[^ ]+\\.moc[\">]" _match "${_contents}")
-            IF(_match)
-               FOREACH (_current_MOC_INC ${_match})
-                  STRING(REGEX MATCH "[^ <\"]+\\.moc" _current_MOC "${_current_MOC_INC}")
-
-                  GET_filename_component(_basename ${_current_MOC} NAME_WE)
-   #               SET(_header ${CMAKE_CURRENT_SOURCE_DIR}/${_basename}.h)
-                  SET(_header ${_abs_PATH}/${_basename}.h)
-                  SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_current_MOC})
-                  ADD_CUSTOM_COMMAND(OUTPUT ${_moc}
-                     COMMAND ${QT_MOC_EXECUTABLE}
-                     ARGS ${_moc_INCS} ${_header} -o ${_moc}
-                     DEPENDS ${_header}
-                  )
-
-                  MACRO_ADD_FILE_DEPENDENCIES(${_abs_FILE} ${_moc})
-               ENDFOREACH (_current_MOC_INC)
-            ENDIF(_match)
-         ENDIF ( NOT _skip AND EXISTS ${_abs_FILE} )
-      ENDFOREACH (_current_FILE)
-   ENDMACRO(QT4_AUTOMOC)
-
-
-
-  ######################################
-  #
-  #       decide if Qt got found
-  #
-  ######################################
-
-  # if the includes,libraries,moc,uic and rcc are found then we have it
-  IF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND "YES" )
-    IF( NOT Qt4_FIND_QUIETLY)
-      MESSAGE(STATUS "Found Qt-Version ${QTVERSION}")
-    ENDIF( NOT Qt4_FIND_QUIETLY)
-  ELSE( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND "NO")
-    IF( Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR "Qt libraries, includes, moc, uic or/and rcc NOT found!")
-    ENDIF( Qt4_FIND_REQUIRED)
-  ENDIF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND  QT_RCC_EXECUTABLE)
-  SET(QT_FOUND ${QT4_FOUND})
-
-  #######################################
-  #
-  #       Qt configuration
-  #
-  #######################################
-  IF(EXISTS "${QT_MKSPECS_DIR}/qconfig.pri")
-    FILE(READ ${QT_MKSPECS_DIR}/qconfig.pri _qconfig_FILE_contents)
-    STRING(REGEX MATCH "QT_CONFIG[^\n]+" QT_QCONFIG ${_qconfig_FILE_contents})
-    STRING(REGEX MATCH "CONFIG[^\n]+" QT_CONFIG ${_qconfig_FILE_contents})
-  ENDIF(EXISTS "${QT_MKSPECS_DIR}/qconfig.pri")
-
-
-  ###############################################
-  #
-  #       configuration/system dependent settings  
-  #
-  ###############################################
-
-  SET(QT_GUI_LIB_DEPENDENCIES "")
-  SET(QT_CORE_LIB_DEPENDENCIES "")
-  
-  # shared build needs -DQT_SHARED
-  IF(NOT QT_CONFIG MATCHES "static")
-    # warning currently only qconfig.pri on Windows potentially contains "static"
-    # so QT_SHARED might not get defined properly on Mac/X11 (which seems harmless right now)
-    # Trolltech said they'd consider exporting it for all platforms in future releases.
-    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -DQT_SHARED)
-  ENDIF(NOT QT_CONFIG MATCHES "static")
-  
-  ## system png
-  IF(QT_QCONFIG MATCHES "system-png")
-    FIND_LIBRARY(QT_PNG_LIBRARY NAMES png)
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_PNG_LIBRARY})
-    MARK_AS_ADVANCED(QT_PNG_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "system-png")
-  
-  # for X11, get X11 library directory
-  IF(Q_WS_X11)
-    QT_QUERY_QMAKE(QMAKE_LIBDIR_X11 "QMAKE_LIBDIR_X11")
-  ENDIF(Q_WS_X11)
-
-  ## X11 SM
-  IF(QT_QCONFIG MATCHES "x11sm")
-    # ask qmake where the x11 libs are
-    FIND_LIBRARY(QT_X11_SM_LIBRARY NAMES SM PATHS ${QMAKE_LIBDIR_X11})
-    FIND_LIBRARY(QT_X11_ICE_LIBRARY NAMES ICE PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_X11_SM_LIBRARY} ${QT_X11_ICE_LIBRARY})
-    MARK_AS_ADVANCED(QT_X11_SM_LIBRARY)
-    MARK_AS_ADVANCED(QT_X11_ICE_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "x11sm")
-  
-  ## Xi
-  IF(QT_QCONFIG MATCHES "tablet")
-    FIND_LIBRARY(QT_XI_LIBRARY NAMES Xi PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XI_LIBRARY})
-    MARK_AS_ADVANCED(QT_XI_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "tablet")
-
-  ## Xrender
-  IF(QT_QCONFIG MATCHES "xrender")
-    FIND_LIBRARY(QT_XRENDER_LIBRARY NAMES Xrender PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRENDER_LIBRARY})
-    MARK_AS_ADVANCED(QT_XRENDER_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "xrender")
-  
-  ## Xrandr
-  IF(QT_QCONFIG MATCHES "xrandr")
-    FIND_LIBRARY(QT_XRANDR_LIBRARY NAMES Xrandr PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRANDR_LIBRARY})
-    MARK_AS_ADVANCED(QT_XRANDR_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "xrandr")
-  
-  ## Xcursor
-  IF(QT_QCONFIG MATCHES "xcursor")
-    FIND_LIBRARY(QT_XCURSOR_LIBRARY NAMES Xcursor PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XCURSOR_LIBRARY})
-    MARK_AS_ADVANCED(QT_XCURSOR_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "xcursor")
-  
-  ## Xinerama
-  IF(QT_QCONFIG MATCHES "xinerama")
-    FIND_LIBRARY(QT_XINERAMA_LIBRARY NAMES Xinerama PATHS ${QMAKE_LIBDIR_X11})
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XINERAMA_LIBRARY})
-    MARK_AS_ADVANCED(QT_XINERAMA_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "xinerama")
-  
-  ## system-freetype
-  IF(QT_QCONFIG MATCHES "system-freetype")
-    FIND_LIBRARY(QT_FREETYPE_LIBRARY NAMES freetype)
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FREETYPE_LIBRARY})
-    MARK_AS_ADVANCED(QT_FREETYPE_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "system-freetype")
-  
-  ## fontconfig
-  IF(QT_QCONFIG MATCHES "fontconfig")
-    FIND_LIBRARY(QT_FONTCONFIG_LIBRARY NAMES fontconfig)
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FONTCONFIG_LIBRARY})
-    MARK_AS_ADVANCED(QT_FONTCONFIG_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "fontconfig")
-  
-  ## system-zlib
-  IF(QT_QCONFIG MATCHES "system-zlib")
-    FIND_LIBRARY(QT_ZLIB_LIBRARY NAMES z)
-    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_ZLIB_LIBRARY})
-    MARK_AS_ADVANCED(QT_ZLIB_LIBRARY)
-  ENDIF(QT_QCONFIG MATCHES "system-zlib")
-
-  IF(Q_WS_X11)
-    # X11 libraries Qt absolutely depends on
-    QT_QUERY_QMAKE(QT_LIBS_X11 "QMAKE_LIBS_X11")
-    SEPARATE_ARGUMENTS(QT_LIBS_X11)
-    FOREACH(QT_X11_LIB ${QT_LIBS_X11})
-      STRING(REGEX REPLACE "-l" "" QT_X11_LIB "${QT_X11_LIB}")
-      SET(QT_TMP_STR "QT_X11_${QT_X11_LIB}_LIBRARY")
-      FIND_LIBRARY(${QT_TMP_STR} NAMES "${QT_X11_LIB}" PATHS ${QMAKE_LIBDIR_X11})
-      SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${${QT_TMP_STR}})
-    ENDFOREACH(QT_X11_LIB)
-
-    QT_QUERY_QMAKE(QT_LIBS_THREAD "QMAKE_LIBS_THREAD")
-    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_LIBS_THREAD})
-    
-    QT_QUERY_QMAKE(QMAKE_LIBS_DYNLOAD "QMAKE_LIBS_DYNLOAD")
-    SET (QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QMAKE_LIBS_DYNLOAD})
-
-  ENDIF(Q_WS_X11)
-
-  IF(Q_WS_WIN)
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} Imm32 Winmm)
-    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} Ws2_32)
-  ENDIF(Q_WS_WIN)
-  
-  IF(Q_WS_MAC)
-    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} "-framework Carbon" "-framework QuickTime")
-    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} "-framework ApplicationServices")
-  ENDIF(Q_WS_MAC)
-
-  #######################################
-  #
-  #       compatibility settings 
-  #
-  #######################################
-  # Backwards compatibility for CMake1.4 and 1.2
-  SET (QT_MOC_EXE ${QT_MOC_EXECUTABLE} )
-  SET (QT_UIC_EXE ${QT_UIC_EXECUTABLE} )
-
-  SET( QT_QT_LIBRARY "")
-
-ELSE(QT4_QMAKE_FOUND)
-
-   IF(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD)
-         MESSAGE(FATAL_ERROR "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
-      ELSE(QT4_INSTALLED_VERSION_TOO_OLD)
-     MESSAGE( FATAL_ERROR "Qt qmake not found!")
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD)
-   ELSE(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-         MESSAGE(STATUS "The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required")
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-   ENDIF(Qt4_FIND_REQUIRED)
- 
-ENDIF (QT4_QMAKE_FOUND)
-

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindSDL.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindSDL.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindSDL.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,163 +1,163 @@
-# - Locate the SDL library
-# This module defines
-#  SDL_LIBRARY, the library to link against
-#  SDL_FOUND, if false, do not try to link to SDL
-#  SDL_INCLUDE_DIR, where to find SDL.h
-#
-# Don't forget to include SDLmain.h and SDLmain.m your project for the 
-# OS X framework based version. (Other versions link to -lSDLmain which
-# this module will try to find on your behalf.) Also for OS X, this 
-# module will automatically add the -framework Cocoa on your behalf.
-# $SDLDIR is an environment variable that would
-# correspond to the ./configure --prefix=$SDLDIR
-# used in building SDL.
-# l.e.galup  9-20-02
-#
-# Modified by Eric Wing. 
-# Added new modifications to recognize OS X frameworks and 
-# additional Unix paths (FreeBSD, etc). 
-# Also corrected the header search path to follow "proper" SDL guidelines.
-# Added a search for SDLmain which is needed by some platforms.
-# Added a search for threads which is needed by some platforms.
-# Added needed compile switches for MinGW.
-#
-# On OSX, this will prefer the Framework version (if found) over others.
-# People will have to manually change the cache values of 
-# SDL_LIBRARY to override this selection.
-#
-# Note that the header path has changed from SDL/SDL.h to just SDL.h
-# This needed to change because "proper" SDL convention
-# is #include "SDL.h", not <SDL/SDL.h>. This is done for portability
-# reasons because not all systems place things in SDL/ (see FreeBSD).
-FIND_PATH(SDL_INCLUDE_DIR SDL.h
-  $ENV{SDLDIR}/include
-  $ENV{SDLDIR}/include/SDL
-  ~/Library/Frameworks/SDL.framework/Headers
-  /Library/Frameworks/SDL.framework/Headers
-  /usr/local/include/SDL
-  /usr/include/SDL
-  /usr/local/include/SDL12
-  /usr/local/include/SDL11 # FreeBSD ports
-  /usr/include/SDL12
-  /usr/include/SDL11
-  /usr/local/include
-  /usr/include
-  /sw/include/SDL # Fink
-  /sw/include
-  /opt/local/include/SDL # DarwinPorts
-  /opt/local/include
-  /opt/csw/include/SDL # Blastwave
-  /opt/csw/include 
-  /opt/include/SDL
-  /opt/include
-  )
-# I'm not sure if I should do a special casing for Apple. It is 
-# unlikely that other Unix systems will find the framework path.
-# But if they do ([Next|Open|GNU]Step?), 
-# do they want the -framework option also?
-IF(${SDL_INCLUDE_DIR} MATCHES ".framework")
-  # The Cocoa framework must be linked into SDL because SDL is Cocoa based.
-  # Remember that the OS X framework version expects you to drop in
-  # SDLmain.h and SDLmain.m directly into your project.
-  # (Cocoa link moved to bottom of this script.)
-  # SET (SDL_LIBRARY "-framework SDL -framework Cocoa" CACHE STRING "SDL framework for OSX")
-  # SET(SDL_LIBRARY "-framework SDL" CACHE STRING "SDL framework for OSX")
-  # Extract the path the framework resides in so we can use it for the -F flag
-  STRING(REGEX REPLACE "(.*)/.*\\.framework/.*" "\\1" SDL_FRAMEWORK_PATH_TEMP ${SDL_INCLUDE_DIR})
-  IF("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
-      OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
-      )
-    # String is in default search path, don't need to use -F
-    SET(SDL_LIBRARY_TEMP "-framework SDL")
-  ELSE("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
-      OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
-      )
-    # String is not /Library/Frameworks, need to use -F
-    SET(SDL_LIBRARY_TEMP "-F${SDL_FRAMEWORK_PATH_TEMP} -framework SDL")
-  ENDIF("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
-    OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
-    )
-  # Clear the temp variable so nobody can see it
-  SET(SDL_FRAMEWORK_PATH_TEMP "" CACHE INTERNAL "")
-
-ELSE(${SDL_INCLUDE_DIR} MATCHES ".framework")
-  # SDL-1.1 is the name used by FreeBSD ports...
-  # don't confuse it for the version number.
-  FIND_LIBRARY(SDL_LIBRARY_TEMP 
-    NAMES SDL SDL-1.1
-    PATHS
-    $ENV{SDLDIR}/lib
-    /usr/local/lib
-    /usr/lib
-    /sw/lib
-    /opt/local/lib
-    /opt/csw/lib
-    /opt/lib
-    )
-  # Non-OS X framework versions expect you to also dynamically link to 
-  # SDLmain. This is mainly for Windows and OS X. Other platforms 
-  # seem to provide SDLmain for compatibility even though they don't
-  # necessarily need it.
-  FIND_LIBRARY(SDLMAIN_LIBRARY 
-    NAMES SDLmain SDLmain-1.1
-    PATHS
-    $ENV{SDLDIR}/lib
-    /usr/local/lib
-    /usr/lib
-    /sw/lib
-    /opt/local/lib
-    /opt/csw/lib
-    /opt/lib
-    )
-ENDIF(${SDL_INCLUDE_DIR} MATCHES ".framework")
-
-# SDL may require threads on your system.
-# The Apple build may not need an explicit flag because one of the 
-# frameworks may already provide it. 
-# But for non-OSX systems, I will use the CMake Threads package.
-IF(NOT APPLE)
-  FIND_PACKAGE(Threads)
-ENDIF(NOT APPLE)
-
-# MinGW needs an additional library, mwindows
-# It's total link flags should look like -lmingw32 -lSDLmain -lSDL -lmwindows
-# (Actually on second look, I think it only needs one of the m* libraries.)
-IF(MINGW)
-  SET(MINGW32_LIBRARY mingw32 CACHE STRING "mwindows for MinGW")
-ENDIF(MINGW)
-
-SET(SDL_FOUND FALSE)
-IF(SDL_LIBRARY_TEMP)
-  # For SDLmain
-  IF(SDLMAIN_LIBRARY)
-    SET(SDL_LIBRARY_TEMP ${SDLMAIN_LIBRARY} ${SDL_LIBRARY_TEMP})
-  ENDIF(SDLMAIN_LIBRARY)
-
-  # For OS X, SDL uses Cocoa as a backend so it must link to Cocoa.
-  # CMake doesn't display the -framework Cocoa string in the UI even 
-  # though it actually is there. I think it has something to do 
-  # with the CACHE STRING. Maybe somebody else knows how to fix this.
-  # The problem is mainly cosmetic, and not a functional issue.
-  IF(APPLE)
-    SET(SDL_LIBRARY_TEMP ${SDL_LIBRARY_TEMP} "-framework Cocoa")
-  ENDIF(APPLE)
-  
-  # For threads, as mentioned Apple doesn't need this.
-  # In fact, there seems to be a problem if Find the threads package
-  # and try using this line, so I'm just skipping it entirely for OS X.
-  IF(NOT APPLE)
-    SET(SDL_LIBRARY_TEMP ${SDL_LIBRARY_TEMP} ${CMAKE_THREAD_LIBS_INIT})
-  ENDIF(NOT APPLE)
-
-  # For MinGW library
-  IF(MINGW)
-    SET(SDL_LIBRARY_TEMP ${MINGW32_LIBRARY} ${SDL_LIBRARY_TEMP})
-  ENDIF(MINGW)
-
-  # Set the final string here so the GUI reflects the final state.
-  SET(SDL_LIBRARY ${SDL_LIBRARY_TEMP} CACHE STRING "Where the SDL Library can be found")
-
-  SET(SDL_FOUND TRUE)
-ENDIF(SDL_LIBRARY_TEMP)
-
-MARK_AS_ADVANCED(SDL_LIBRARY_TEMP)
+# - Locate the SDL library
+# This module defines
+#  SDL_LIBRARY, the library to link against
+#  SDL_FOUND, if false, do not try to link to SDL
+#  SDL_INCLUDE_DIR, where to find SDL.h
+#
+# Don't forget to include SDLmain.h and SDLmain.m your project for the 
+# OS X framework based version. (Other versions link to -lSDLmain which
+# this module will try to find on your behalf.) Also for OS X, this 
+# module will automatically add the -framework Cocoa on your behalf.
+# $SDLDIR is an environment variable that would
+# correspond to the ./configure --prefix=$SDLDIR
+# used in building SDL.
+# l.e.galup  9-20-02
+#
+# Modified by Eric Wing. 
+# Added new modifications to recognize OS X frameworks and 
+# additional Unix paths (FreeBSD, etc). 
+# Also corrected the header search path to follow "proper" SDL guidelines.
+# Added a search for SDLmain which is needed by some platforms.
+# Added a search for threads which is needed by some platforms.
+# Added needed compile switches for MinGW.
+#
+# On OSX, this will prefer the Framework version (if found) over others.
+# People will have to manually change the cache values of 
+# SDL_LIBRARY to override this selection.
+#
+# Note that the header path has changed from SDL/SDL.h to just SDL.h
+# This needed to change because "proper" SDL convention
+# is #include "SDL.h", not <SDL/SDL.h>. This is done for portability
+# reasons because not all systems place things in SDL/ (see FreeBSD).
+FIND_PATH(SDL_INCLUDE_DIR SDL.h
+  $ENV{SDLDIR}/include
+  $ENV{SDLDIR}/include/SDL
+  ~/Library/Frameworks/SDL.framework/Headers
+  /Library/Frameworks/SDL.framework/Headers
+  /usr/local/include/SDL
+  /usr/include/SDL
+  /usr/local/include/SDL12
+  /usr/local/include/SDL11 # FreeBSD ports
+  /usr/include/SDL12
+  /usr/include/SDL11
+  /usr/local/include
+  /usr/include
+  /sw/include/SDL # Fink
+  /sw/include
+  /opt/local/include/SDL # DarwinPorts
+  /opt/local/include
+  /opt/csw/include/SDL # Blastwave
+  /opt/csw/include 
+  /opt/include/SDL
+  /opt/include
+  )
+# I'm not sure if I should do a special casing for Apple. It is 
+# unlikely that other Unix systems will find the framework path.
+# But if they do ([Next|Open|GNU]Step?), 
+# do they want the -framework option also?
+IF(${SDL_INCLUDE_DIR} MATCHES ".framework")
+  # The Cocoa framework must be linked into SDL because SDL is Cocoa based.
+  # Remember that the OS X framework version expects you to drop in
+  # SDLmain.h and SDLmain.m directly into your project.
+  # (Cocoa link moved to bottom of this script.)
+  # SET (SDL_LIBRARY "-framework SDL -framework Cocoa" CACHE STRING "SDL framework for OSX")
+  # SET(SDL_LIBRARY "-framework SDL" CACHE STRING "SDL framework for OSX")
+  # Extract the path the framework resides in so we can use it for the -F flag
+  STRING(REGEX REPLACE "(.*)/.*\\.framework/.*" "\\1" SDL_FRAMEWORK_PATH_TEMP ${SDL_INCLUDE_DIR})
+  IF("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
+      OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
+      )
+    # String is in default search path, don't need to use -F
+    SET(SDL_LIBRARY_TEMP "-framework SDL")
+  ELSE("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
+      OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
+      )
+    # String is not /Library/Frameworks, need to use -F
+    SET(SDL_LIBRARY_TEMP "-F${SDL_FRAMEWORK_PATH_TEMP} -framework SDL")
+  ENDIF("${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/Library/Frameworks"
+    OR "${SDL_FRAMEWORK_PATH_TEMP}" STREQUAL "/System/Library/Frameworks"
+    )
+  # Clear the temp variable so nobody can see it
+  SET(SDL_FRAMEWORK_PATH_TEMP "" CACHE INTERNAL "")
+
+ELSE(${SDL_INCLUDE_DIR} MATCHES ".framework")
+  # SDL-1.1 is the name used by FreeBSD ports...
+  # don't confuse it for the version number.
+  FIND_LIBRARY(SDL_LIBRARY_TEMP 
+    NAMES SDL SDL-1.1
+    PATHS
+    $ENV{SDLDIR}/lib
+    /usr/local/lib
+    /usr/lib
+    /sw/lib
+    /opt/local/lib
+    /opt/csw/lib
+    /opt/lib
+    )
+  # Non-OS X framework versions expect you to also dynamically link to 
+  # SDLmain. This is mainly for Windows and OS X. Other platforms 
+  # seem to provide SDLmain for compatibility even though they don't
+  # necessarily need it.
+  FIND_LIBRARY(SDLMAIN_LIBRARY 
+    NAMES SDLmain SDLmain-1.1
+    PATHS
+    $ENV{SDLDIR}/lib
+    /usr/local/lib
+    /usr/lib
+    /sw/lib
+    /opt/local/lib
+    /opt/csw/lib
+    /opt/lib
+    )
+ENDIF(${SDL_INCLUDE_DIR} MATCHES ".framework")
+
+# SDL may require threads on your system.
+# The Apple build may not need an explicit flag because one of the 
+# frameworks may already provide it. 
+# But for non-OSX systems, I will use the CMake Threads package.
+IF(NOT APPLE)
+  FIND_PACKAGE(Threads)
+ENDIF(NOT APPLE)
+
+# MinGW needs an additional library, mwindows
+# It's total link flags should look like -lmingw32 -lSDLmain -lSDL -lmwindows
+# (Actually on second look, I think it only needs one of the m* libraries.)
+IF(MINGW)
+  SET(MINGW32_LIBRARY mingw32 CACHE STRING "mwindows for MinGW")
+ENDIF(MINGW)
+
+SET(SDL_FOUND "NO")
+IF(SDL_LIBRARY_TEMP)
+  # For SDLmain
+  IF(SDLMAIN_LIBRARY)
+    SET(SDL_LIBRARY_TEMP ${SDLMAIN_LIBRARY} ${SDL_LIBRARY_TEMP})
+  ENDIF(SDLMAIN_LIBRARY)
+
+  # For OS X, SDL uses Cocoa as a backend so it must link to Cocoa.
+  # CMake doesn't display the -framework Cocoa string in the UI even 
+  # though it actually is there. I think it has something to do 
+  # with the CACHE STRING. Maybe somebody else knows how to fix this.
+  # The problem is mainly cosmetic, and not a functional issue.
+  IF(APPLE)
+    SET(SDL_LIBRARY_TEMP ${SDL_LIBRARY_TEMP} "-framework Cocoa")
+  ENDIF(APPLE)
+  
+  # For threads, as mentioned Apple doesn't need this.
+  # In fact, there seems to be a problem if Find the threads package
+  # and try using this line, so I'm just skipping it entirely for OS X.
+  IF(NOT APPLE)
+    SET(SDL_LIBRARY_TEMP ${SDL_LIBRARY_TEMP} ${CMAKE_THREAD_LIBS_INIT})
+  ENDIF(NOT APPLE)
+
+  # For MinGW library
+  IF(MINGW)
+    SET(SDL_LIBRARY_TEMP ${MINGW32_LIBRARY} ${SDL_LIBRARY_TEMP})
+  ENDIF(MINGW)
+
+  # Set the final string here so the GUI reflects the final state.
+  SET(SDL_LIBRARY ${SDL_LIBRARY_TEMP} CACHE STRING "Where the SDL Library can be found")
+
+  SET(SDL_FOUND "YES")
+ENDIF(SDL_LIBRARY_TEMP)
+
+MARK_AS_ADVANCED(SDL_LIBRARY_TEMP)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindX11.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindX11.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindX11.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,154 +0,0 @@
-# - Find X11 installation
-# Try to find X11 on UNIX systems. The following values are defined
-#  X11_FOUND        - True if X11 is available
-#  X11_INCLUDE_DIR  - include directories to use X11
-#  X11_LIBRARIES    - link against these to use X11
-
-IF (UNIX)
-  SET(X11_FOUND 0)
-  # X11 is never a framework and some header files may be
-  # found in tcl on the mac
-  SET(CMAKE_FIND_FRAMEWORK_SAVE ${CMAKE_FIND_FRAMEWORK})
-  SET(CMAKE_FIND_FRAMEWORK NEVER)
-  SET(X11_INC_SEARCH_PATH
-    /usr/X11R6/include 
-    /usr/local/include 
-    /usr/include/X11
-    /usr/openwin/include 
-    /usr/openwin/share/include 
-    /opt/graphics/OpenGL/include
-    /usr/include
-  )
-
-  SET(X11_LIB_SEARCH_PATH
-    /usr/X11R6/lib
-    /usr/local/lib 
-    /usr/openwin/lib 
-    /usr/lib 
-  )
-
-  FIND_PATH(X11_X11_INCLUDE_PATH X11/X.h ${X11_INC_SEARCH_PATH})
-  FIND_PATH(X11_Xlib_INCLUDE_PATH X11/Xlib.h ${X11_INC_SEARCH_PATH})
-  FIND_PATH(X11_Xutil_INCLUDE_PATH X11/Xutil.h ${X11_INC_SEARCH_PATH})
-  FIND_LIBRARY(X11_X11_LIB X11 ${X11_LIB_SEARCH_PATH})
-  FIND_LIBRARY(X11_Xext_LIB Xext ${X11_LIB_SEARCH_PATH})
-
-  IF(X11_X11_INCLUDE_PATH)
-    SET(X11_INCLUDE_DIR ${X11_INCLUDE_DIR} ${X11_X11_INCLUDE_PATH})
-  ENDIF(X11_X11_INCLUDE_PATH)
-
-  IF(X11_Xlib_INCLUDE_PATH)
-    SET(X11_INCLUDE_DIR ${X11_INCLUDE_DIR} ${X11_Xlib_INCLUDE_PATH})
-  ENDIF(X11_Xlib_INCLUDE_PATH)
-
-  IF(X11_Xutil_INCLUDE_PATH)
-    SET(X11_INCLUDE_DIR ${X11_INCLUDE_DIR} ${X11_Xutil_INCLUDE_PATH})
-  ENDIF(X11_Xutil_INCLUDE_PATH)
-
-  IF(X11_X11_LIB)
-    SET(X11_LIBRARIES ${X11_LIBRARIES} ${X11_X11_LIB})
-  ENDIF(X11_X11_LIB)
-
-  IF(X11_Xext_LIB)
-    SET(X11_LIBRARIES ${X11_LIBRARIES} ${X11_Xext_LIB})
-  ENDIF(X11_Xext_LIB)
-
-  # Deprecated variable for backwards compatibility with CMake 1.4
-  IF(X11_X11_INCLUDE_PATH)
-    IF(X11_LIBRARIES)
-      SET(X11_FOUND 1)
-    ENDIF(X11_LIBRARIES)
-  ENDIF(X11_X11_INCLUDE_PATH)
-
-  SET(X11_LIBRARY_DIR "")
-  IF(X11_X11_LIB)
-    GET_FILENAME_COMPONENT(X11_LIBRARY_DIR ${X11_X11_LIB} PATH)
-  ENDIF(X11_X11_LIB)
-
-  IF(X11_FOUND)
-    INCLUDE(CheckFunctionExists)
-    INCLUDE(CheckLibraryExists)
-
-    # Translated from an autoconf-generated configure script.
-    # See libs.m4 in autoconf's m4 directory.
-    IF($ENV{ISC} MATCHES "^yes$")
-      SET(X11_X_EXTRA_LIBS -lnsl_s -linet)
-    ELSE($ENV{ISC} MATCHES "^yes$")
-      SET(X11_X_EXTRA_LIBS "")
-
-      # See if XOpenDisplay in X11 works by itself.
-      CHECK_LIBRARY_EXISTS("${X11_LIBRARIES}" "XOpenDisplay" "${X11_LIBRARY_DIR}" X11_LIB_X11_SOLO)
-      IF(NOT X11_LIB_X11_SOLO)
-        # Find library needed for dnet_ntoa.
-        CHECK_LIBRARY_EXISTS("dnet" "dnet_ntoa" "" X11_LIB_DNET_HAS_DNET_NTOA) 
-        IF (X11_LIB_DNET_HAS_DNET_NTOA)
-          SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -ldnet)
-        ELSE (X11_LIB_DNET_HAS_DNET_NTOA)
-          CHECK_LIBRARY_EXISTS("dnet_stub" "dnet_ntoa" "" X11_LIB_DNET_STUB_HAS_DNET_NTOA) 
-          IF (X11_LIB_DNET_STUB_HAS_DNET_NTOA)
-            SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -ldnet_stub)
-          ENDIF (X11_LIB_DNET_STUB_HAS_DNET_NTOA)
-        ENDIF (X11_LIB_DNET_HAS_DNET_NTOA)
-      ENDIF(NOT X11_LIB_X11_SOLO)
-
-      # Find library needed for gethostbyname.
-      CHECK_FUNCTION_EXISTS("gethostbyname" CMAKE_HAVE_GETHOSTBYNAME)
-      IF(NOT CMAKE_HAVE_GETHOSTBYNAME)
-        CHECK_LIBRARY_EXISTS("nsl" "gethostbyname" "" CMAKE_LIB_NSL_HAS_GETHOSTBYNAME) 
-        IF (CMAKE_LIB_NSL_HAS_GETHOSTBYNAME)
-          SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -lnsl)
-        ELSE (CMAKE_LIB_NSL_HAS_GETHOSTBYNAME)
-          CHECK_LIBRARY_EXISTS("bsd" "gethostbyname" "" CMAKE_LIB_BSD_HAS_GETHOSTBYNAME) 
-          IF (CMAKE_LIB_BSD_HAS_GETHOSTBYNAME)
-            SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -lbsd)
-          ENDIF (CMAKE_LIB_BSD_HAS_GETHOSTBYNAME)
-        ENDIF (CMAKE_LIB_NSL_HAS_GETHOSTBYNAME)
-      ENDIF(NOT CMAKE_HAVE_GETHOSTBYNAME)
-
-      # Find library needed for connect.
-      CHECK_FUNCTION_EXISTS("connect" CMAKE_HAVE_CONNECT)
-      IF(NOT CMAKE_HAVE_CONNECT)
-        CHECK_LIBRARY_EXISTS("socket" "connect" "" CMAKE_LIB_SOCKET_HAS_CONNECT) 
-        IF (CMAKE_LIB_SOCKET_HAS_CONNECT)
-          SET (X11_X_EXTRA_LIBS -lsocket ${X11_X_EXTRA_LIBS})
-        ENDIF (CMAKE_LIB_SOCKET_HAS_CONNECT)
-      ENDIF(NOT CMAKE_HAVE_CONNECT)
-
-      # Find library needed for remove.
-      CHECK_FUNCTION_EXISTS("remove" CMAKE_HAVE_REMOVE)
-      IF(NOT CMAKE_HAVE_REMOVE)
-        CHECK_LIBRARY_EXISTS("posix" "remove" "" CMAKE_LIB_POSIX_HAS_REMOVE) 
-        IF (CMAKE_LIB_POSIX_HAS_REMOVE)
-          SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -lposix)
-        ENDIF (CMAKE_LIB_POSIX_HAS_REMOVE)
-      ENDIF(NOT CMAKE_HAVE_REMOVE)
-
-      # Find library needed for shmat.
-      CHECK_FUNCTION_EXISTS("shmat" CMAKE_HAVE_SHMAT)
-      IF(NOT CMAKE_HAVE_SHMAT)
-        CHECK_LIBRARY_EXISTS("ipc" "shmat" "" CMAKE_LIB_IPS_HAS_SHMAT) 
-        IF (CMAKE_LIB_IPS_HAS_SHMAT)
-          SET (X11_X_EXTRA_LIBS ${X11_X_EXTRA_LIBS} -lipc)
-        ENDIF (CMAKE_LIB_IPS_HAS_SHMAT)
-      ENDIF(NOT CMAKE_HAVE_SHMAT)
-    ENDIF($ENV{ISC} MATCHES "^yes$")
-
-    CHECK_LIBRARY_EXISTS("ICE" "IceConnectionNumber" "${X11_LIBRARY_DIR}"
-                         CMAKE_LIB_ICE_HAS_ICECONNECTIONNUMBER)
-    IF(CMAKE_LIB_ICE_HAS_ICECONNECTIONNUMBER)
-      SET (X11_X_PRE_LIBS -lSM -lICE)
-    ENDIF(CMAKE_LIB_ICE_HAS_ICECONNECTIONNUMBER)
-    # Build the final list of libraries.
-    SET (X11_LIBRARIES ${X11_X_PRE_LIBS} ${X11_LIBRARIES} ${X11_X_EXTRA_LIBS})
-  ENDIF(X11_FOUND)
-
-  MARK_AS_ADVANCED(
-    X11_X11_INCLUDE_PATH
-    X11_X11_LIB
-    X11_Xext_LIB
-    X11_Xlib_INCLUDE_PATH
-    X11_Xutil_INCLUDE_PATH
-    X11_LIBRARIES
-    )
-  SET(CMAKE_FIND_FRAMEWORK ${CMAKE_FIND_FRAMEWORK_SAVE})
-ENDIF (UNIX)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-27 14:12:27 UTC (rev 3709)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-27 16:31:06 UTC (rev 3710)
@@ -1,47 +0,0 @@
-# - Find zlib
-# Find the native ZLIB includes and library
-#
-#  ZLIB_INCLUDE_DIR - where to find zlib.h, etc.
-#  ZLIB_LIBRARIES   - List of libraries when using zlib.
-#  ZLIB_FOUND       - True if zlib found.
-
-
-IF (ZLIB_INCLUDE_DIR)
-  # Already in cache, be silent
-  SET(ZLIB_FIND_QUIETLY TRUE)
-ENDIF (ZLIB_INCLUDE_DIR)
-
-FIND_PATH(ZLIB_INCLUDE_DIR zlib.h
-  /usr/local/include
-  /usr/include
-)
-
-SET(ZLIB_NAMES z zlib zdll)
-FIND_LIBRARY(ZLIB_LIBRARY
-  NAMES ${ZLIB_NAMES}
-  PATHS /usr/lib /usr/local/lib
-)
-
-IF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
-   SET(ZLIB_FOUND TRUE)
-    SET( ZLIB_LIBRARIES ${ZLIB_LIBRARY} )
-ELSE (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
-   SET(ZLIB_FOUND FALSE)
-   SET( ZLIB_LIBRARIES )
-ENDIF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
-
-IF (ZLIB_FOUND)
-   IF (NOT ZLIB_FIND_QUIETLY)
-      MESSAGE(STATUS "Found ZLIB: ${ZLIB_LIBRARY}")
-   ENDIF (NOT ZLIB_FIND_QUIETLY)
-ELSE (ZLIB_FOUND)
-   IF (ZLIB_FIND_REQUIRED)
-      MESSAGE(STATUS "Looked for Z libraries named ${ZLIBS_NAMES}.")
-      MESSAGE(FATAL_ERROR "Could NOT find z library")
-   ENDIF (ZLIB_FIND_REQUIRED)
-ENDIF (ZLIB_FOUND)
-
-MARK_AS_ADVANCED(
-  ZLIB_LIBRARY
-  ZLIB_INCLUDE_DIR
-  )



From gruntster at mail.berlios.de  Tue Nov 27 23:05:03 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 27 Nov 2007 23:05:03 +0100
Subject: [Avidemux-svn-commit] r3711 - in
	branches/avidemux_2.5_branch_gruntster:
	avidemux/ADM_libraries/ADM_libwrapper cmake
Message-ID: <200711272205.lARM53cB009887@sheep.berlios.de>

Author: gruntster
Date: 2007-11-27 23:04:55 +0100 (Tue, 27 Nov 2007)
New Revision: 3711

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
Log:
[CMake] libdca 0.0.5 support

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp	2007-11-27 16:31:06 UTC (rev 3710)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp	2007-11-27 22:04:55 UTC (rev 3711)
@@ -9,11 +9,20 @@
 {
 #ifdef USE_LATE_BINDING
 #ifdef ADM_WIN32
-	char* libname = "libdts.dll";
+#ifdef USE_LIBDCA_002
+	const char* libname = "libdts.dll";
 #else
-	char* libname = "libdts.so";	// ???
-#endif
+	const char* libname = "libdca-0.dll";
+#endif	// USE_LIBDCA_002
+#else
+#ifdef USE_LIBDCA_002
+	const char* libname = "libdts.so";	// ???
+#else
+	const char* libname = "libdca-0.so";	// ???
+#endif	// USE_LIBDCA_002
+#endif	// ADM_WIN32
 
+#ifdef USE_LIBDCA_002
 	initialised = (loadLibrary(libname) && getSymbols(7, 
 		&func_dts_block, "dts_block", 
 		&func_dts_blocks_num, "dts_blocks_num", 
@@ -23,8 +32,18 @@
 		&func_dts_samples, "dts_samples", 
 		&func_dts_syncinfo, "dts_syncinfo"));
 #else
+	initialised = (loadLibrary(libname) && getSymbols(7, 
+		&func_dts_block, "dca_block", 
+		&func_dts_blocks_num, "dca_blocks_num", 
+		&func_dts_frame, "dca_frame", 
+		&func_dts_free, "dca_free", 
+		&func_dts_init, "dca_init",
+		&func_dts_samples, "dca_samples", 
+		&func_dts_syncinfo, "dca_syncinfo"));
+#endif	// USE_LIBDCA_002
+#else
 	initialised = true;
-#endif	
+#endif	// USE_LATE_BINDING
 }
 
 ADM_LibWrapperDca::~ADM_LibWrapperDca() {}

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-27 16:31:06 UTC (rev 3710)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-27 22:04:55 UTC (rev 3711)
@@ -54,7 +54,7 @@
 	ENDIF (LATE_BINDING)
 
 	PRINT_LIBRARY_INFO("amrnb" AMRNB_FOUND "${AMRNB_INCLUDE_DIR}" "${AMRNB_LIBRARY_DIR}")
-	
+
 	IF (AMRNB_FOUND)
 		SET(USE_AMR_NB 1)
 		SET(CONFIG_AMR_NB 1)
@@ -80,7 +80,7 @@
 
 	FIND_HEADER_AND_LIB(LAME lame/lame.h mp3lame lame_init ${LAME_REQUIRED_FLAGS})
 	PRINT_LIBRARY_INFO("LAME" LAME_FOUND "${LAME_INCLUDE_DIR}" "${LAME_LIBRARY_DIR}")
-	
+
 	IF (LAME_FOUND)
 		SET(HAVE_LIBMP3LAME 1)
 	ENDIF (LAME_FOUND)
@@ -102,18 +102,34 @@
 	IF (ADM_OS_LINUX)
 		SET(LIBDCA_REQUIRED_FLAGS "-lm")
 	ENDIF (ADM_OS_LINUX)
-	
+
+	SET(LIBDCA_VERSION 005)
+
 	IF (USE_LATE_BINDING)
-		FIND_HEADER_AND_LIB(LIBDCA dts.h)
+		FIND_HEADER_AND_LIB(LIBDCA_005 dca.h)
+
+		IF (NOT LIBDCA_005_FOUND)
+			SET(LIBDCA_VERSION 002)
+			FIND_HEADER_AND_LIB(LIBDCA_002 dts.h)
+		ENDIF (NOT LIBDCA_005_FOUND)
 	ELSE (USE_LATE_BINDING)
-		FIND_HEADER_AND_LIB(LIBDCA dts.h dts dts_init ${LIBDCA_REQUIRED_FLAGS})
+		FIND_HEADER_AND_LIB(LIBDCA_005 dca.h dca dca_init ${LIBDCA_REQUIRED_FLAGS})
+
+		IF (NOT LIBDCA_005_FOUND)
+			SET(LIBDCA_VERSION 002)
+			FIND_HEADER_AND_LIB(LIBDCA_002 dts.h dts dts_init ${LIBDCA_REQUIRED_FLAGS})
+		ENDIF (NOT LIBDCA_005_FOUND)
 	ENDIF (USE_LATE_BINDING)
-	
-	PRINT_LIBRARY_INFO("libdca" LIBDCA_FOUND "${LIBDCA_INCLUDE_DIR}" "${LIBDCA_LIBRARY_DIR}")
 
-	IF (LIBDCA_FOUND)
+	IF (LIBDCA_${LIBDCA_VERSION}_FOUND)
+		SET(LIBDCA_FOUND 1)
 		SET(USE_LIBDCA 1)
-	ENDIF (LIBDCA_FOUND)
+		SET(USE_LIBDCA_${LIBDCA_VERSION} 1)
+		SET(LIBDCA_INCLUDE_DIR "${LIBDCA_${LIBDCA_VERSION}_INCLUDE_DIR}")
+		SET(LIBDCA_LIBRARY_DIR "${LIBDCA_${LIBDCA_VERSION}_LIBRARY_DIR}")
+	ENDIF (LIBDCA_${LIBDCA_VERSION}_FOUND)
+
+	PRINT_LIBRARY_INFO("libdca" LIBDCA_FOUND "${LIBDCA_INCLUDE_DIR}" "${LIBDCA_LIBRARY_DIR}")
 ELSE (LIBDCA)
 	MESSAGE("${MSG_DISABLE_OPTION}")
 ENDIF (LIBDCA)
@@ -131,7 +147,7 @@
 IF (FAAC)
 	FIND_HEADER_AND_LIB(FAAC faac.h faac faacEncClose)
 	PRINT_LIBRARY_INFO("FAAC" FAAC_FOUND "${FAAC_INCLUDE_DIR}" "${FAAC_LIBRARY_DIR}")
-	
+
 	IF (FAAC_FOUND)
 		SET(USE_FAAC 1)
 	ENDIF (FAAC_FOUND)
@@ -170,7 +186,7 @@
 		SET(USE_FAAD 1)
 
 		CHECK_CFLAGS_REQUIRED(faad_check.cpp "-DOLD_FAAD_PROTO" "${FAAD_INCLUDE_DIR}" "${FAAD_LIBRARY_DIR}" FAAD_CFLAGS_REQUIRED)
-		
+
 		IF (FAAD_CFLAGS_REQUIRED)
 			SET(OLD_FAAD_PROTO 1)
 		ENDIF (FAAD_CFLAGS_REQUIRED)
@@ -192,7 +208,7 @@
 IF (VORBIS)
 	FIND_HEADER_AND_LIB(VORBIS vorbis/vorbisenc.h vorbis vorbis_info_init)
 	FIND_HEADER_AND_LIB(VORBISENC "" vorbisenc vorbis_encode_init)
-	
+
 	IF (VORBIS_FOUND AND VORBISENC_FOUND)
 		SET(USE_VORBIS 1)
 	ELSE (VORBIS_FOUND AND VORBISENC_FOUND)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-27 16:31:06 UTC (rev 3710)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-27 22:04:55 UTC (rev 3711)
@@ -197,6 +197,8 @@
 
 /* libdca detected */
 #cmakedefine USE_LIBDCA
+#cmakedefine USE_LIBDCA_002
+#cmakedefine USE_LIBDCA_005
 
 /* Libxml2 is available */
 #cmakedefine USE_LIBXML2



From gruntster at mail.berlios.de  Thu Nov 29 13:50:04 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 29 Nov 2007 13:50:04 +0100
Subject: [Avidemux-svn-commit] r3712 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc
Message-ID: <200711291250.lATCo44r026639@sheep.berlios.de>

Author: gruntster
Date: 2007-11-29 13:49:58 +0100 (Thu, 29 Nov 2007)
New Revision: 3712

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/CMakeLists.txt
Log:
[CMake] remove unnecessary file from mpeg2enc build

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/CMakeLists.txt	2007-11-27 22:04:55 UTC (rev 3711)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libmpeg2enc/CMakeLists.txt	2007-11-29 12:49:58 UTC (rev 3712)
@@ -12,8 +12,7 @@
 cpu_accel.cc          idctdata.cc           mblock_sub44_sads_x86.cc    mpeg2param.cc    predict_x86.cc    quantize_ref.cc  transfrm_ref.cc
 fdctdata.cc           idct_mmx.cc           mpeg2setup.cc               putbits.cc        quantize_x86.cc  transfrm_x86.cc
 fdct_mmx.cc           ioio.c                mblock_sumsq_mmx.cc         mpegconsts.cc    puthdr.cc         quant_mmx2.cc    writepic.cc
-fdctref.cc            macroblock.cc         motion.cc                   predcomp_mmx.cc  putmpg.cc         ratectl.cc       xx.c 
-ADM_mpe2enc.cpp
+fdctref.cc            macroblock.cc         motion.cc                   predcomp_mmx.cc  putmpg.cc         ratectl.cc       ADM_mpe2enc.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)



From gruntster at mail.berlios.de  Fri Nov 30 15:10:39 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 30 Nov 2007 15:10:39 +0100
Subject: [Avidemux-svn-commit] r3713 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_libraries/ADM_mplex
Message-ID: <200711301410.lAUEAd4b020499@sheep.berlios.de>

Author: gruntster
Date: 2007-11-30 15:10:32 +0100 (Fri, 30 Nov 2007)
New Revision: 3713

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_assert.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/CMakeLists.txt
Log:
[Mac] disable custom memory management

Modified: branches/avidemux_2.4_branch/avidemux/ADM_assert.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2007-11-29 12:49:58 UTC (rev 3712)
+++ branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2007-11-30 14:10:32 UTC (rev 3713)
@@ -39,6 +39,7 @@
 #define fopen   ADM_fopen
 #define fclose  ADM_fclose
 
+#ifndef __APPLE__
 #ifndef ADM_LEGACY_PROGGY
   #define malloc #error
   #define realloc #error
@@ -56,6 +57,7 @@
   #define strdup ADM_strdup
   #define calloc ADM_calloc
 #endif
+#endif    // __APPLE__
 #ifdef __cplusplus
 }
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/CMakeLists.txt	2007-11-29 12:49:58 UTC (rev 3712)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/CMakeLists.txt	2007-11-30 14:10:32 UTC (rev 3713)
@@ -14,4 +14,7 @@
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
 ################################
 include_directories("${CMAKE_CURRENT_SOURCE_DIR}")
-add_definitions(-DHAVE_MEMALIGN)
\ No newline at end of file
+
+IF (NOT ADM_OS_APPLE)
+    add_definitions(-DHAVE_MEMALIGN)
+ENDIF (NOT ADM_OS_APPLE)



