<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r7199 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_libraries cmake cmake/patches	platforms/windows/installer
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2011-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r7199%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux%0A%09avidemux/ADM_libraries%20cmake%20cmake/patches%0A%09platforms/windows/installer&In-Reply-To=%3C20110511175416.1636448122A%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004353.html">
   <LINK REL="Next"  HREF="004355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r7199 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_libraries cmake cmake/patches	platforms/windows/installer</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r7199%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux%0A%09avidemux/ADM_libraries%20cmake%20cmake/patches%0A%09platforms/windows/installer&In-Reply-To=%3C20110511175416.1636448122A%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r7199 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_libraries cmake cmake/patches	platforms/windows/installer">gruntster at mail.berlios.de
       </A><BR>
    <I>Wed May 11 19:54:15 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004353.html">[Avidemux-svn-commit] r7198 - in	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders:	ADM_ad_lav ADM_ad_opencore_amrnb ADM_ad_opencore_amrwb
</A></li>
        <LI>Next message: <A HREF="004355.html">[Avidemux-svn-commit] r7200 -	branches/avidemux_2.5_branch_gruntster/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4354">[ date ]</a>
              <a href="thread.html#4354">[ thread ]</a>
              <a href="subject.html#4354">[ subject ]</a>
              <a href="author.html#4354">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2011-05-11 19:54:15 +0200 (Wed, 11 May 2011)
New Revision: 7199

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ffmpeg-0.7-rc1.tar.gz
Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ffmpeg_r25041.tar.gz
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/libswscale_r32049.tar.gz
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegPrepareTar.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/patches/createPatches.sh
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264_parser.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_vc1dec.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[ffmpeg] roll ffmpeg forward again so win64 works properly (0.7rc1)

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ffmpeg-0.7-rc1.tar.gz
===================================================================
(Binary files differ)


Property changes on: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ffmpeg-0.7-rc1.tar.gz
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ffmpeg_r25041.tar.gz
===================================================================
(Binary files differ)

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/libswscale_r32049.tar.gz
===================================================================
(Binary files differ)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2011-05-11 17:54:15 UTC (rev 7199)
@@ -279,8 +279,7 @@
 	ADM_libpostproc
 	ADM_libswscale
 	ADM_libavcodec
-	ADM_libavformat
-	ADM_libavcore)
+	ADM_libavformat)
 
 if (USE_SYSTEM_SPIDERMONKEY)
 	ADD_LIB_ALL_TARGETS(${SPIDERMONKEY_LIBRARY_DIR})

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,16 +1,20 @@
 include(admFFmpegUtil)
 
-set(FFMPEG_VERSION 25041)	# <A HREF="http://git.ffmpeg.org/?p=ffmpeg;a=snapshot;h=2be4fa05c5528073bcfc472d1c23f2d77b679a9d;sf=tgz">http://git.ffmpeg.org/?p=ffmpeg;a=snapshot;h=2be4fa05c5528073bcfc472d1c23f2d77b679a9d;sf=tgz</A>
-set(SWSCALE_VERSION 32049)	# <A HREF="http://git.ffmpeg.org/?p=libswscale;a=snapshot;h=d1a43021d9198868fa7a023a30e5ee9e09a907d3;sf=tgz">http://git.ffmpeg.org/?p=libswscale;a=snapshot;h=d1a43021d9198868fa7a023a30e5ee9e09a907d3;sf=tgz</A>
+set(FFMPEG_VERSION 0.7-rc1)
+set(FFMPEG_SOURCE_ARCHIVE &quot;ffmpeg-${FFMPEG_VERSION}.tar.gz&quot;)
+set(FFMPEG_SOURCE_ARCHIVE_DIR &quot;ffmpeg-${FFMPEG_VERSION}&quot;)
 
+#set(FFMPEG_VERSION 26061)	# <A HREF="http://git.ffmpeg.org/?p=ffmpeg;a=snapshot;h=2be4fa05c5528073bcfc472d1c23f2d77b679a9d;sf=tgz">http://git.ffmpeg.org/?p=ffmpeg;a=snapshot;h=2be4fa05c5528073bcfc472d1c23f2d77b679a9d;sf=tgz</A>
+#set(SWSCALE_VERSION 32724)	# <A HREF="http://git.ffmpeg.org/?p=libswscale;a=snapshot;h=d1a43021d9198868fa7a023a30e5ee9e09a907d3;sf=tgz">http://git.ffmpeg.org/?p=libswscale;a=snapshot;h=d1a43021d9198868fa7a023a30e5ee9e09a907d3;sf=tgz</A>
+
 set(LIBRARY_SOURCE_DIR &quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries&quot;)
 set(FFMPEG_SOURCE_DIR &quot;${LIBRARY_SOURCE_DIR}/ffmpeg&quot;)
 set(FFMPEG_BINARY_DIR &quot;${CMAKE_BINARY_DIR}/avidemux/ADM_libraries/ffmpeg&quot;)
 
-set(FFMPEG_DECODERS  adpcm_ima_amv  amv  bmp  cinepak  cyuv  dca  dvbsub  dvvideo  ffv1  ffvhuff  flv  fraps  h263  h264  huffyuv  mjpeg
-					 mjpegb  mpeg2video  mpeg4  msmpeg4v2  msmpeg4v3  msvideo1  nellymoser  png  qdm2  rawvideo  snow  svq3  theora  tscc
-					 vc1  vp3  vp6  vp6a  vp6f  wmav2  wmv1  wmv2  wmv3)
-set(FFMPEG_ENCODERS  ac3  dvvideo  ffv1  ffvhuff  flv  h263  huffyuv  mjpeg  mp2  mpeg1video  mpeg2video  mpeg4  snow)
+set(FFMPEG_DECODERS  adpcm_ima_amv  amv  bmp  cinepak  cyuv  dca  dvbsub  dvvideo  ffv1  ffvhuff  flac  flv  fraps  h263  h264  huffyuv
+					 mjpeg  mjpegb  mpeg2video  mpeg4  msmpeg4v2  msmpeg4v3  msvideo1  nellymoser  png  qdm2  rawvideo  snow  svq3
+					 theora  tscc  vc1  vp3  vp6  vp6a  vp6f  wmav2  wmv1  wmv2  wmv3)
+set(FFMPEG_ENCODERS  ac3  ac3_fixed  ac3_float  dvvideo  ffv1  ffvhuff  flv  h263  huffyuv  mjpeg  mp2  mpeg1video  mpeg2video  mpeg4  snow)
 set(FFMPEG_MUXERS  flv  matroska  mpeg1vcd  mpeg2dvd  mpeg2svcd  mpegts  mov  mp4  psp)
 set(FFMPEG_PARSERS  ac3  h263  h264  mpeg4video)
 set(FFMPEG_PROTOCOLS  file)
@@ -20,9 +24,9 @@
 include(admFFmpegPatch)
 include(admFFmpegPrepareTar)
 
-if (NOT FFMPEG_PREPARED)
-	include(admFFmpegPrepareSvn)
-endif (NOT FFMPEG_PREPARED)
+#if (NOT FFMPEG_PREPARED)
+	#include(admFFmpegPrepareSvn)
+#endif (NOT FFMPEG_PREPARED)
 
 if (NOT VERBOSE)
 	set(ffmpegBuildOutput OUTPUT_VARIABLE FFMPEG_CONFIGURE_OUTPUT)
@@ -205,10 +209,6 @@
 set_property(TARGET ADM_libavformat PROPERTY IMPORTED_LOCATION &quot;${FFMPEG_BINARY_DIR}/libavformat/${LIBAVFORMAT_LIB}&quot;)
 install(${FFMPEG_SHLIB_INSTALL_TYPE} &quot;${FFMPEG_BINARY_DIR}/libavformat/${LIBAVFORMAT_LIB}&quot; DESTINATION &quot;${FFMPEG_INSTALL_DIR}&quot;)
 
-add_library(ADM_libavcore UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavcore PROPERTY IMPORTED_LOCATION &quot;${FFMPEG_BINARY_DIR}/libavcore/${LIBAVCORE_LIB}&quot;)
-install(${FFMPEG_SHLIB_INSTALL_TYPE} &quot;${FFMPEG_BINARY_DIR}/libavcore/${LIBAVCORE_LIB}&quot; DESTINATION &quot;${FFMPEG_INSTALL_DIR}&quot;)
-
 include_directories(&quot;${FFMPEG_SOURCE_DIR}&quot;)
 include_directories(&quot;${FFMPEG_SOURCE_DIR}/libavutil&quot;)
 include_directories(&quot;${FFMPEG_SOURCE_DIR}/libpostproc&quot;)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegPrepareTar.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegPrepareTar.cmake	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegPrepareTar.cmake	2011-05-11 17:54:15 UTC (rev 7199)
@@ -2,33 +2,39 @@
 	set(ffmpegExtractOutput OUTPUT_VARIABLE FFMPEG_EXTRACT_OUTPUT)
 endif (NOT VERBOSE)
 
-set(FFMPEG_SOURCE_ARCHIVE &quot;ffmpeg_r${FFMPEG_VERSION}.tar.gz&quot;)
-set(SWSCALE_SOURCE_ARCHIVE &quot;libswscale_r${SWSCALE_VERSION}.tar.gz&quot;)
+#set(FFMPEG_SOURCE_ARCHIVE &quot;ffmpeg_r${FFMPEG_VERSION}.tar.gz&quot;)
+#set(SWSCALE_SOURCE_ARCHIVE &quot;libswscale_r${SWSCALE_VERSION}.tar.gz&quot;)
 
-if (EXISTS &quot;${LIBRARY_SOURCE_DIR}/${FFMPEG_SOURCE_ARCHIVE}&quot; AND EXISTS &quot;${LIBRARY_SOURCE_DIR}/${SWSCALE_SOURCE_ARCHIVE}&quot;)
+if (EXISTS &quot;${LIBRARY_SOURCE_DIR}/${FFMPEG_SOURCE_ARCHIVE}&quot;) # AND EXISTS &quot;${LIBRARY_SOURCE_DIR}/${SWSCALE_SOURCE_ARCHIVE}&quot;)
 	if (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/ffmpeg.c&quot; OR NOT ${LAST_FFMPEG_VERSION} EQUAL ${FFMPEG_VERSION})
 		find_package(Tar)
 
+		execute_process(COMMAND ${CMAKE_COMMAND} -E remove &quot;ffmpeg&quot;
+					WORKING_DIRECTORY &quot;${LIBRARY_SOURCE_DIR}&quot;)
+
 		execute_process(COMMAND ${TAR_EXECUTABLE} xvf ${FFMPEG_SOURCE_ARCHIVE}
 					WORKING_DIRECTORY &quot;${LIBRARY_SOURCE_DIR}&quot;
 					${ffmpegExtractOutput})
 
+		execute_process(COMMAND ${CMAKE_COMMAND} -E rename &quot;ffmpeg-0.7-rc1&quot; &quot;ffmpeg&quot;
+					WORKING_DIRECTORY &quot;${LIBRARY_SOURCE_DIR}&quot;)
+
 		set(FFMPEG_PERFORM_PATCH 1)
 		set(FFMPEG_PERFORM_BUILD 1)
 	endif (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/ffmpeg.c&quot; OR NOT ${LAST_FFMPEG_VERSION} EQUAL ${FFMPEG_VERSION})
 
-	if (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/libswscale/swscale.c&quot; OR NOT ${LAST_SWSCALE_VERSION} EQUAL ${SWSCALE_VERSION})
-		find_package(Tar)
+	#if (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/libswscale/swscale.c&quot; OR NOT ${LAST_SWSCALE_VERSION} EQUAL ${SWSCALE_VERSION})
+		#find_package(Tar)
 
-		execute_process(COMMAND ${TAR_EXECUTABLE} xvf ../${SWSCALE_SOURCE_ARCHIVE}
-					WORKING_DIRECTORY &quot;${FFMPEG_SOURCE_DIR}&quot;
-					${ffmpegExtractOutput})
+		#execute_process(COMMAND ${TAR_EXECUTABLE} xvf ../${SWSCALE_SOURCE_ARCHIVE}
+					#WORKING_DIRECTORY &quot;${FFMPEG_SOURCE_DIR}&quot;
+					#${ffmpegExtractOutput})
 
-		set(FFMPEG_PERFORM_PATCH 1)
-		set(FFMPEG_PERFORM_BUILD 1)
-	endif (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/libswscale/swscale.c&quot; OR NOT ${LAST_SWSCALE_VERSION} EQUAL ${SWSCALE_VERSION})
+		#set(FFMPEG_PERFORM_PATCH 1)
+		#set(FFMPEG_PERFORM_BUILD 1)
+	#endif (NOT EXISTS &quot;${FFMPEG_SOURCE_DIR}/libswscale/swscale.c&quot; OR NOT ${LAST_SWSCALE_VERSION} EQUAL ${SWSCALE_VERSION})
 
 	set(FFMPEG_PREPARED 1)
 	set(LAST_FFMPEG_VERSION &quot;${FFMPEG_VERSION}&quot; CACHE STRING &quot;&quot; FORCE)
-	set(LAST_SWSCALE_VERSION &quot;${SWSCALE_VERSION}&quot; CACHE STRING &quot;&quot; FORCE)
-endif (EXISTS &quot;${LIBRARY_SOURCE_DIR}/${FFMPEG_SOURCE_ARCHIVE}&quot; AND EXISTS &quot;${LIBRARY_SOURCE_DIR}/${SWSCALE_SOURCE_ARCHIVE}&quot;)
\ No newline at end of file
+	#set(LAST_SWSCALE_VERSION &quot;${SWSCALE_VERSION}&quot; CACHE STRING &quot;&quot; FORCE)
+endif (EXISTS &quot;${LIBRARY_SOURCE_DIR}/${FFMPEG_SOURCE_ARCHIVE}&quot;) # AND EXISTS &quot;${LIBRARY_SOURCE_DIR}/${SWSCALE_SOURCE_ARCHIVE}&quot;)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2011-05-11 17:54:15 UTC (rev 7199)
@@ -5,9 +5,8 @@
 ENDMACRO (getFfmpegVersionFromHeader)
 
 MACRO (getFfmpegLibNames sourceDir)
-	getFfmpegVersionFromHeader(&quot;libavcodec&quot; &quot;${sourceDir}/libavcodec/avcodec.h&quot; LIBAVCODEC_VERSION_MAJOR LIBAVCODEC_VERSION)
-	getFfmpegVersionFromHeader(&quot;libavcore&quot; &quot;${sourceDir}/libavcore/avcore.h&quot; LIBAVCORE_VERSION_MAJOR LIBAVCORE_VERSION)	
-	getFfmpegVersionFromHeader(&quot;libavformat&quot; &quot;${sourceDir}/libavformat/avformat.h&quot; LIBAVFORMAT_VERSION_MAJOR LIBAVFORMAT_VERSION)
+	getFfmpegVersionFromHeader(&quot;libavcodec&quot; &quot;${sourceDir}/libavcodec/version.h&quot; LIBAVCODEC_VERSION_MAJOR LIBAVCODEC_VERSION)
+	getFfmpegVersionFromHeader(&quot;libavformat&quot; &quot;${sourceDir}/libavformat/version.h&quot; LIBAVFORMAT_VERSION_MAJOR LIBAVFORMAT_VERSION)
 	getFfmpegVersionFromHeader(&quot;libavutil&quot; &quot;${sourceDir}/libavutil/avutil.h&quot; LIBAVUTIL_VERSION_MAJOR LIBAVUTIL_VERSION)
 	getFfmpegVersionFromHeader(&quot;libpostproc&quot; &quot;${sourceDir}/libpostproc/postprocess.h&quot; LIBPOSTPROC_VERSION_MAJOR LIBPOSTPROC_VERSION)
 	getFfmpegVersionFromHeader(&quot;libswscale&quot; &quot;${sourceDir}/libswscale/swscale.h&quot; LIBSWSCALE_VERSION_MAJOR LIBSWSCALE_VERSION)
@@ -18,21 +17,18 @@
 
 	if (APPLE)
 		set(LIBAVCODEC_LIB lib${LIBAVCODEC_ADM}avcodec.${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBAVCORE_LIB lib${LIBAVCODEC_ADM}avcore.${LIBAVCORE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVFORMAT_LIB lib${LIBAVCODEC_ADM}avformat.${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVUTIL_LIB lib${LIBAVCODEC_ADM}avutil.${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBPOSTPROC_LIB lib${LIBAVCODEC_ADM}postproc.${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBSWSCALE_LIB lib${LIBAVCODEC_ADM}swscale.${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 	elseif (UNIX)
 		set(LIBAVCODEC_LIB lib${LIBAVCODEC_ADM}avcodec${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVCODEC_VERSION})
-		set(LIBAVCORE_LIB lib${LIBAVCODEC_ADM}avcore${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVCORE_VERSION})
 		set(LIBAVFORMAT_LIB lib${LIBAVCODEC_ADM}avformat${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVFORMAT_VERSION})
 		set(LIBAVUTIL_LIB lib${LIBAVCODEC_ADM}avutil${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVUTIL_VERSION})
 		set(LIBPOSTPROC_LIB lib${LIBAVCODEC_ADM}postproc${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBPOSTPROC_VERSION})
 		set(LIBSWSCALE_LIB lib${LIBAVCODEC_ADM}swscale${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBSWSCALE_VERSION})
 	else (APPLE)
 		set(LIBAVCODEC_LIB ${LIBAVCODEC_ADM}avcodec-${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBAVCORE_LIB ${LIBAVCODEC_ADM}avcore-${LIBAVCORE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVFORMAT_LIB ${LIBAVCODEC_ADM}avformat-${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVUTIL_LIB ${LIBAVCODEC_ADM}avutil-${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBPOSTPROC_LIB ${LIBAVCODEC_ADM}postproc-${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/createPatches.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/createPatches.sh	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/createPatches.sh	2011-05-11 17:54:15 UTC (rev 7199)
@@ -4,15 +4,22 @@
 export ffmpegPath=../../avidemux/ADM_libraries/ffmpeg
 
 function updatePatch {
+	#cd $ffmpegPath
+	#cp $1/$2 $1/$2.new
+	#svn revert $1/$2
+	#unix2dos $1/$2
+	#unix2dos $1/$2.new
+	#mv $1/$2 $1/$2.old
+	#mv $1/$2.new $1/$2
+	#diff -u $1/$2.old $1/$2 &gt; $curDir/$1_$2.patch
+	#rm $1/$2.old
+	#cd $curDir
+	#dos2unix $1_$2.patch
+
 	cd $ffmpegPath
-	cp $1/$2 $1/$2.new
-	svn revert $1/$2
 	unix2dos $1/$2
-	unix2dos $1/$2.new
-	mv $1/$2 $1/$2.old
-	mv $1/$2.new $1/$2
-	diff -u $1/$2.old $1/$2 &gt; $curDir/$1_$2.patch
-	rm $1/$2.old
+	unix2dos $1/$2.orig
+	diff -u $1/$2.orig $1/$2 &gt; $curDir/$1_$2.patch
 	cd $curDir
 	dos2unix $1_$2.patch
 }

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/avcodec.h.old	2010-12-20 13:49:18 +0000
-+++ libavcodec/avcodec.h	2010-12-20 13:49:18 +0000
-@@ -665,6 +665,8 @@
+--- libavcodec/avcodec.h.orig	2011-05-10 22:40:28 +0100
++++ libavcodec/avcodec.h	2011-05-10 22:40:28 +0100
+@@ -636,6 +636,8 @@
  #define CODEC_FLAG2_PSY           0x00080000 ///&lt; Use psycho visual optimizations.
  #define CODEC_FLAG2_SSIM          0x00100000 ///&lt; Compute SSIM during encoding, error[] values are undefined.
  #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///&lt; Use periodic insertion of intra blocks instead of keyframes.
@@ -9,7 +9,7 @@
  
  /* Unsupported options :
   *              Syntax Arithmetic coding (SAC)
-@@ -1559,6 +1561,7 @@
+@@ -1589,6 +1591,7 @@
       * - decoding: unused
       */
      int rc_max_rate;
@@ -17,7 +17,7 @@
  
      /**
       * minimum bitrate
-@@ -1573,6 +1576,8 @@
+@@ -1603,6 +1606,8 @@
       * - decoding: unused
       */
      int rc_buffer_size;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/h263dec.c.old	2010-12-20 13:49:21 +0000
-+++ libavcodec/h263dec.c	2010-12-20 13:49:21 +0000
-@@ -120,6 +120,25 @@
+--- libavcodec/h263dec.c.orig	2011-05-10 22:40:29 +0100
++++ libavcodec/h263dec.c	2011-05-10 22:40:29 +0100
+@@ -121,6 +121,25 @@
  
      return 0;
  }
@@ -26,7 +26,7 @@
  
  av_cold int ff_h263_decode_end(AVCodecContext *avctx)
  {
-@@ -422,6 +441,12 @@
+@@ -437,6 +456,12 @@
      } else {
          ret = h263_decode_picture_header(s);
      }
@@ -39,7 +39,7 @@
  
      if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
  
-@@ -717,6 +742,14 @@
+@@ -738,6 +763,14 @@
  
  assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
  assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,8 +1,8 @@
---- libavcodec/h264.c.old	2010-12-20 13:49:22 +0000
-+++ libavcodec/h264.c	2010-12-20 13:49:22 +0000
-@@ -3395,6 +3395,19 @@
-     return 0;
- }
+--- libavcodec/h264.c.orig	2011-04-26 23:58:23 +0100
++++ libavcodec/h264.c	2011-05-10 22:34:57 +0100
+@@ -3458,6 +3458,20 @@
+     { FF_PROFILE_UNKNOWN },
+ };
  
 +/* MEANX */
 +int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc);
@@ -17,6 +17,7 @@
 +
 +  }
 +/* MeanX */
- 
- AVCodec h264_decoder = {
++
+ AVCodec ff_h264_decoder = {
      &quot;h264&quot;,
+     AVMEDIA_TYPE_VIDEO,

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264_parser.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264_parser.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264_parser.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/h264_parser.c.old	2010-12-20 13:49:23 +0000
-+++ libavcodec/h264_parser.c	2010-12-20 13:49:23 +0000
-@@ -30,7 +30,52 @@
+--- libavcodec/h264_parser.c.orig	2011-05-10 22:40:29 +0100
++++ libavcodec/h264_parser.c	2011-05-10 22:40:29 +0100
+@@ -29,7 +29,52 @@
  #include &quot;h264data.h&quot;
  #include &quot;golomb.h&quot;
  
@@ -52,4 +52,4 @@
 +// /MEANX
  
  
- int ff_h264_find_frame_end(H264Context *h, const uint8_t *buf, int buf_size)
+ static int ff_h264_find_frame_end(H264Context *h, const uint8_t *buf, int buf_size)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/mpeg12.c.old	2010-12-20 13:49:23 +0000
-+++ libavcodec/mpeg12.c	2010-12-20 13:49:23 +0000
-@@ -1948,6 +1948,11 @@
+--- libavcodec/mpeg12.c.orig	2011-05-10 22:40:29 +0100
++++ libavcodec/mpeg12.c	2011-05-10 22:40:29 +0100
+@@ -1999,6 +1999,11 @@
          ff_er_frame_end(s);
  
          MPV_frame_end(s);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/mpegvideo.c.old	2010-12-20 13:49:25 +0000
-+++ libavcodec/mpegvideo.c	2010-12-20 13:49:25 +0000
-@@ -653,7 +653,11 @@
+--- libavcodec/mpegvideo.c.orig	2011-05-10 22:40:30 +0100
++++ libavcodec/mpegvideo.c	2011-05-10 22:40:29 +0100
+@@ -735,7 +735,11 @@
      FF_ALLOCZ_OR_GOTO(s-&gt;avctx, s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE, fail);
  
      s-&gt;parse_context.state= -1;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/mpegvideo_enc.c.old	2010-12-20 13:49:26 +0000
-+++ libavcodec/mpegvideo_enc.c	2010-12-20 13:49:26 +0000
-@@ -367,12 +367,14 @@
+--- libavcodec/mpegvideo_enc.c.orig	2011-05-10 22:40:30 +0100
++++ libavcodec/mpegvideo_enc.c	2011-05-10 22:40:30 +0100
+@@ -376,12 +376,14 @@
  
          av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
      }
@@ -15,7 +15,7 @@
  
      if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
          av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
-@@ -413,10 +415,12 @@
+@@ -422,10 +424,12 @@
          return -1;
      }
  

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavcodec/utils.c.old	2010-12-20 13:49:27 +0000
-+++ libavcodec/utils.c	2010-12-20 13:49:27 +0000
-@@ -659,10 +659,12 @@
+--- libavcodec/utils.c.orig	2011-05-10 22:40:30 +0100
++++ libavcodec/utils.c	2011-05-10 22:40:30 +0100
+@@ -766,10 +766,12 @@
  
      if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || avpkt-&gt;size){
          //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_vc1dec.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_vc1dec.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_vc1dec.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,14 +1,14 @@
---- libavcodec/vc1dec.c.old	2010-12-20 13:49:28 +0000
-+++ libavcodec/vc1dec.c	2010-12-20 13:49:28 +0000
-@@ -3146,7 +3146,10 @@
-     AVFrame *pict = data;
-     uint8_t *buf2 = NULL;
-     const uint8_t *buf_start = buf;
--
-+/** MEANX **/
-+    if(s-&gt;flags&amp; CODEC_FLAG_LOW_DELAY)
-+        s-&gt;low_delay=1;
-+/** /MEANX **/
+--- libavcodec/vc1dec.c.orig	2011-04-26 23:58:23 +0100
++++ libavcodec/vc1dec.c	2011-05-10 21:01:54 +0100
+@@ -3390,6 +3390,11 @@
+         int mby_start;
+     } *slices = NULL;
+ 
++	/** MEANX **/
++	if(s-&gt;flags &amp; CODEC_FLAG_LOW_DELAY)
++		s-&gt;low_delay = 1;
++	/** /MEANX **/
++
      /* no supplementary picture */
-     if (buf_size == 0) {
+     if (buf_size == 0 || (buf_size == 4 &amp;&amp; AV_RB32(buf) == VC1_CODE_ENDOFSEQ)) {
          /* special case for last picture */

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,8 +1,8 @@
---- libavformat/file.c.old	2010-12-20 13:49:28 +0000
-+++ libavformat/file.c	2010-12-20 13:49:29 +0000
-@@ -30,6 +30,75 @@
- #include &lt;stdlib.h&gt;
+--- libavformat/file.c.orig	2011-05-10 22:40:30 +0100
++++ libavformat/file.c	2011-05-10 22:40:30 +0100
+@@ -31,6 +31,75 @@
  #include &quot;os_support.h&quot;
+ #include &quot;url.h&quot;
  
 +// GRUNTSTER start
 +#ifdef __WIN32

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,6 +1,6 @@
---- libavformat/isom.c.old	2010-12-20 13:49:29 +0000
-+++ libavformat/isom.c	2010-12-20 13:49:29 +0000
-@@ -222,7 +222,10 @@
+--- libavformat/isom.c.orig	2011-05-10 22:40:30 +0100
++++ libavformat/isom.c	2011-05-10 22:40:30 +0100
+@@ -234,7 +234,10 @@
      { CODEC_ID_MP1, MKTAG('.', 'm', 'p', '1') }, /* MPEG layer 1 */
      { CODEC_ID_MP2, MKTAG('.', 'm', 'p', '2') }, /* MPEG layer 2 */
  

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2011-05-11 17:54:15 UTC (rev 7199)
@@ -1,15 +1,15 @@
---- libavformat/matroskaenc.c.old	2010-12-20 13:49:30 +0000
-+++ libavformat/matroskaenc.c	2010-12-20 13:49:30 +0000
+--- libavformat/matroskaenc.c.orig	2011-05-10 22:40:30 +0100
++++ libavformat/matroskaenc.c	2011-05-10 22:40:30 +0100
 @@ -410,6 +410,7 @@
  
- static int put_xiph_codecpriv(AVFormatContext *s, ByteIOContext *pb, AVCodecContext *codec)
+ static int put_xiph_codecpriv(AVFormatContext *s, AVIOContext *pb, AVCodecContext *codec)
  {
 +#if 0 // MEANX avidemux does thing differently
      uint8_t *header_start[3];
      int header_len[3];
      int first_header_size;
 @@ -434,6 +435,28 @@
-         put_buffer(pb, header_start[j], header_len[j]);
+         avio_write(pb, header_start[j], header_len[j]);
  
      return 0;
 +#else
@@ -37,7 +37,7 @@
  }
  
  static void get_aac_sample_rates(AVFormatContext *s, AVCodecContext *codec, int *sample_rate, int *output_sample_rate)
-@@ -552,6 +575,24 @@
+@@ -538,6 +561,24 @@
          put_ebml_uint (pb, MATROSKA_ID_TRACKUID        , i + 1);
          put_ebml_uint (pb, MATROSKA_ID_TRACKFLAGLACING , 0);    // no lacing (yet)
  

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2011-05-10 06:07:28 UTC (rev 7198)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2011-05-11 17:54:15 UTC (rev 7199)
@@ -304,7 +304,6 @@
     ${File} COPYING.
     ${File} README.
     ${File} avcodec-*.dll
-    ${File} avcore-*.dll
     ${File} avformat-*.dll
     ${File} avutil-*.dll
     ${File} postproc-*.dll


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004353.html">[Avidemux-svn-commit] r7198 - in	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders:	ADM_ad_lav ADM_ad_opencore_amrnb ADM_ad_opencore_amrwb
</A></li>
	<LI>Next message: <A HREF="004355.html">[Avidemux-svn-commit] r7200 -	branches/avidemux_2.5_branch_gruntster/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4354">[ date ]</a>
              <a href="thread.html#4354">[ thread ]</a>
              <a href="subject.html#4354">[ subject ]</a>
              <a href="author.html#4354">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
