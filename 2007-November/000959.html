<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3690 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_libraries avidemux/ADM_libraries/ADM_libass	avidemux/ADM_libraries/ADM_libswscale	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video	avidemux/ADM_videoFilter cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3690%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%0A%09avidemux/ADM_libraries%20avidemux/ADM_libraries/ADM_libass%0A%09avidemux/ADM_libraries/ADM_libswscale%0A%09avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_video%0A%09avidemux/ADM_videoFilter%20cmake&In-Reply-To=%3C200711141659.lAEGxmTr018686%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000958.html">
   <LINK REL="Next"  HREF="000960.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3690 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_libraries avidemux/ADM_libraries/ADM_libass	avidemux/ADM_libraries/ADM_libswscale	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video	avidemux/ADM_videoFilter cmake</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3690%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%0A%09avidemux/ADM_libraries%20avidemux/ADM_libraries/ADM_libass%0A%09avidemux/ADM_libraries/ADM_libswscale%0A%09avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_video%0A%09avidemux/ADM_videoFilter%20cmake&In-Reply-To=%3C200711141659.lAEGxmTr018686%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3690 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_libraries avidemux/ADM_libraries/ADM_libass	avidemux/ADM_libraries/ADM_libswscale	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video	avidemux/ADM_videoFilter cmake">gruntster at mail.berlios.de
       </A><BR>
    <I>Wed Nov 14 17:59:48 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000958.html">[Avidemux-svn-commit] r3689 - branches
</A></li>
        <LI>Next message: <A HREF="000960.html">[Avidemux-svn-commit] r3691 - in	branches/avidemux_2.5_branch_gruntster: avidemux cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#959">[ date ]</a>
              <a href="thread.html#959">[ thread ]</a>
              <a href="subject.html#959">[ subject ]</a>
              <a href="author.html#959">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2007-11-14 17:59:14 +0100 (Wed, 14 Nov 2007)
New Revision: 3690

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake
Removed:
   branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake
   branches/avidemux_2.5_branch_gruntster/config.h.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
Log:
[CMake] restructured, improved detection of libs and headers, config options now available via CMake GUI, added caching of variables, added verbosity mode

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,212 +1,199 @@
-##########################################################
-# main cmake file for avidemux
-# Derived from the one available in sim-im &amp; kde4
-##########################################################
-MESSAGE(&quot;#####################################&quot;)
-MESSAGE(&quot;Configure Started&quot;)
-MESSAGE(&quot;#####################################&quot;)
-PROJECT(Avidemux2)
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.4)
-SET(CMAKE_COLOR_MAKEFILE ON)
-
-# where to look first for cmake modules, before ${CMAKE_ROOT}/Modules/ is checked
-SET(CMAKE_MODULE_PATH &quot;${CMAKE_SOURCE_DIR}/cmake&quot;)
-# XMingw ?
-OPTION(XMINGW FALSE)
-if(XMINGW)
-MESSAGE(STATUS &quot;Xmingw set, forcing win32 target&quot;)
-SET(WIN32 1)
-endif(XMINGW)
-
-#**************************************************
-# MESSAGE
-#**************************************************
-SET(CMAKE_C_FLAGS $ENV{CFLAGS})
-SET(CMAKE_CXX_FLAGS $ENV{CXXFLAGS})
-
-MESSAGE(&quot;EXTRA Cflags:${CMAKE_C_FLAGS}&quot;)
-MESSAGE(&quot;EXTRA CXXflags:${CMAKE_CXX_FLAGS}&quot;)
-#*************************************************
-include(UsePkgConfig)
-include(MacroEnsureOutOfSourceBuild)
-include(CheckCXXCompilerFlag)
-
-#**************************************************
-# Subversion
-#**************************************************
-if(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot; AND EXISTS &quot;${CMAKE_SOURCE_DIR}/.svn&quot;)
-	MESSAGE(STATUS &quot;&lt;Checking for Subversion&gt;&quot;)
-	MESSAGE(STATUS &quot;&lt;***********************&gt;&quot;)
-	include(FindSubversion)
-
-	FIND_PACKAGE(Subversion)
-	IF(Subversion_FOUND)
-		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-		MESSAGE(STATUS &quot;Current revision is ${Project_WC_REVISION}&quot;)
-		SET(ADM_SUBVERSION ${Project_WC_REVISION})
-	ELSE(Subversion_FOUND)
-		MESSAGE(STATUS &quot;Could not find Subversion&quot;)
-	ENDIF(Subversion_FOUND)
-ENDIF(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot; AND EXISTS &quot;${CMAKE_SOURCE_DIR}/.svn&quot;)
-
-IF(NOT Subversion_FOUND)
-	SET(ADM_SUBVERSION 0)
-ENDIF(NOT Subversion_FOUND)
-
-#**************************************************
-# PKG Config
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for PKG-CONFIG&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;***********************&gt;&quot;)
-if(NOT PKGCONFIG_EXECUTABLE)
-             MESSAGE(FATAL_ERROR &quot;Could not find pkg-config&quot;)
-endif(NOT PKGCONFIG_EXECUTABLE)
-MESSAGE(STATUS &quot;OK ${PKGCONFIG_EXECUTABLE}&quot;)
-
-#**************************************************
-# libxml2
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for LibXML2&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;*********************&gt;&quot;)
-include(FindLibXml2)
-if(NOT LIBXML2_FOUND)
-  MESSAGE(FATAL_ERROR &quot;Could not find Libxml2&quot;)
-endif(NOT LIBXML2_FOUND)
-MESSAGE(STATUS &quot;LibXML2 OK&quot;)
-
-#**************************************************
-# Search for FREETYPE
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for FreeType through PKG-CONFIG&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;****************************************&gt;&quot;)
-if(NO_FREETYPE)
-message(status &quot;&lt;disabled per request&gt;&quot;)
-else(NO_FREETYPE)
-PKGCONFIG(freetype2 FT_INCLUDE FT_LIB FT_LDFLAGS FT_CFLAGS)
-
-IF(NOT FT_INCLUDE)
-    MESSAGE(STATUS &quot;Could not find Freetype &quot;)
-ELSE(NOT FT_INCLUDE)
-    SET(FT_FOUND TRUE)
-    MESSAGE(STATUS &quot;LDFLAGS &lt;${FT_LDFLAGS}&gt;&quot;)
-    MESSAGE(STATUS &quot;LIBS &lt;${FT_LIB}&gt;&quot;)
-    MESSAGE(STATUS OK)
-    MESSAGE(STATUS &quot;FreeType Found (&quot;${FT_CFLAGS} ${FT_INCLUDE}&quot;)&quot;)
-    
-ENDIF(NOT FT_INCLUDE)
-endif(NO_FREETYPE)
-#**************************************************
-# Search for  X11 (not on windows)
-#**************************************************
-if(NOT WIN32)
-        MESSAGE(STATUS &quot;&lt;Checking for X11&gt;&quot;)
-        MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-        include(FindX11)
-        if(NOT X11_FOUND)
-             MESSAGE(FATAL_ERROR &quot;Could not find X11&quot;)
-        endif(NOT X11_FOUND)
-        MESSAGE(STATUS OK)
-endif(NOT WIN32)
-#**************************************************
-# Search for GLIB through PKG-Config
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for GLIB&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-PKGCONFIG(glib-2.0 GLIB_INCLUDE GLIB_LIB GLIB_LDFLAGS GLIB_CFLAGS)
-
-IF(NOT GLIB_INCLUDE)
-    MESSAGE(STATUS &quot;Could not find GLIB - cannot compile avidemux2_gtk here&quot;)
-ELSE(NOT GLIB_INCLUDE)
-    SET(GLIB_FOUND,TRUE)
-    MESSAGE(STATUS OK)
-    MESSAGE(&quot;GLIB Found (&quot;${GLIB_CFLAGS}&quot;)&quot;)
-    
-ENDIF(NOT GLIB_INCLUDE)
-#**************************************************
-# Search for GTK through PKG-Config
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for GTK&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-if(NO_GTK)
-message(status &quot;&lt;disabled per request&gt;&quot;)
-else(NO_GTK)
-PKGCONFIG(gtk+-2.0 GTK_INCLUDE GTK_LIB GTK_LDFLAGS GTK_CFLAGS)
-
-IF(NOT GTK_CFLAGS)
-    MESSAGE(STATUS &quot;Could not find GTK - cannot compile avidemux2_gtk here&quot;)
-ELSE(NOT GTK_CFLAGS)
-    SET(GTK_FOUND TRUE)
-    MESSAGE(STATUS OK)
-ENDIF(NOT GTK_CFLAGS)
-endif(NO_GTK)
-#**************************************************
-# Search for Gthread through PKG-Config
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for Gthread&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-PKGCONFIG(gthread-2.0 GTHREAD_INCLUDE GTHREAD_LIB GTHREAD_LDFLAGS GTHREAD_CFLAGS)
-
-IF(NOT GTHREAD_CFLAGS)
-    MESSAGE(STATUS &quot;Could not find GTHREAD&quot;)
-    SET(GTK_FOUND FALSE)
-ELSE(NOT GTHREAD_CFLAGS)
-    SET(GTHREAD_LDFLAGS,${GTHREAD_LDFLAGS})
-    MESSAGE(STATUS &quot;OK ${GTHREAD_LDFLAGS}&quot;)
-ENDIF(NOT GTHREAD_CFLAGS)
-#**************************************************
-# Search for QT4 
-#**************************************************
-MESSAGE(STATUS &quot;&lt;Checking for QT4&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-if(NO_QT4)
-message(status &quot;&lt;disabled per request&gt;&quot;)
-else(NO_QT4)
-include(FindQt4)
-if(QT4_FOUND AND MINGW)
-if(XMINGW) # Cross compile ?
-        SET(QTXM /rot2/qt_4.3)
-        #
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic-qt4)
-	SET(QT_MOC_EXECUTABLE moc-qt4)
-	SET(QT_RCC_EXECUTABLE rcc)
-	SET(QT_QTGUI_LIBRARY QtGui4 ) # FIXME
-        SET(QT_QTCORE_LIBRARY QtCore4 ) # FIXME
-
-        SET(CMAKE_CXX_FLAGS &quot;-I${QTXM}/include ${CMAKE_CXX_FLAGS}&quot;)
-        LINK_DIRECTORIES(${QTXM}/bin)
-        LINK_DIRECTORIES(${QTXM}/lib)
-
-else(XMINGW)
-	MESSAGE(STATUS &quot;** MINGW ** OVERRIDING PATH FOR QT4 You may have to edit CMakeLists.txt!!!&quot;)
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic)
-	SET(QT_MOC_EXECUTABLE moc)
-	SET(QT_RCC_EXECUTABLE rcc)
-endif(XMINGW)
-endif(QT4_FOUND AND MINGW)
-endif(NO_QT4)
-
-# do config checks
-include(ConfigureChecks.cmake)
-
-# create config.h
-CONFIGURE_FILE(config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)
-
-include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
-include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
-include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
-
-#**********************************************
-# Some CFLAGS
-#**********************************************
-add_definitions (-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
-add_definitions( -DHAVE_CONFIG_H )
-
-ADD_SUBDIRECTORY(avidemux)
-ADD_SUBDIRECTORY(po)
-
-###############################
-# Summary
-###############################
-include(conf_summary)
+MESSAGE(&quot;#####################################&quot;)
+MESSAGE(&quot;Configure Started&quot;)
+MESSAGE(&quot;#####################################&quot;)
+MESSAGE(&quot;&quot;)
+
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
+SET(CMAKE_MODULE_PATH &quot;${CMAKE_SOURCE_DIR}/cmake&quot;)
+
+PROJECT(Avidemux)
+
+IF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+	MESSAGE(&quot;Please do an out-of-tree build:&quot;)
+	MESSAGE(&quot;rm CMakeCache.txt; mkdir build; cd build; cmake ..; make&quot;)
+	MESSAGE(FATAL_ERROR &quot;in-tree-build detected&quot;)
+ENDIF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+
+INCLUDE(CheckCCompilerFlag)
+INCLUDE(CheckCXXCompilerFlag)
+INCLUDE(admConfigHelper)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Global options
+########################################
+OPTION(XMINGW &quot;&quot; OFF)
+OPTION(VERBOSE &quot;&quot; OFF)
+OPTION(LATE_BINDING &quot;&quot; OFF)
+
+IF (XMINGW)
+	SET(WIN32 1)
+ENDIF (XMINGW)
+
+IF (LATE_BINDING)
+	SET(USE_LATE_BINDING 1)
+ENDIF (LATE_BINDING)
+
+########################################
+# Avidemux OS specific tweaks
+########################################
+INCLUDE(admDetermineSystem)
+
+IF (ADM_OS_WINDOWS)
+	SET(CYG_MANGLING 1)
+	SET(ADM_WIN32 1)		# needs to be removed one day...
+	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
+ENDIF (ADM_OS_WINDOWS)
+
+IF (ADM_OS_DARWIN)
+	SET(CMAKE_INCLUDE_PATH &quot;/opt/local/include ${CMAKE_INCLUDE_PATH}&quot;)
+	SET(CMAKE_LIBRARY_PATH &quot;/opt/local/lib ${CMAKE_LIBRARY_PATH}&quot;)
+
+	SET(CYG_MANGLING 1)
+	SET(ADM_BSD_FAMILY 1)
+ENDIF (ADM_OS_DARWIN)
+
+IF (ADM_OS_LINUX)
+	SET(USE_JOG 1)			# jog shuttle is only available on Linux due to its interface
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# Standard Avidemux defines
+########################################
+SET(VERSION 2.5)
+
+SET(HAVE_BUILTIN_VECTOR 1)
+SET(HAVE_AUDIO 1)
+
+SET(USE_MP3 1)
+SET(USE_AC3 1)
+SET(USE_FFMPEG 1)
+SET(USE_MJPEG 1)
+
+# ARCH_XXX need to be removed from Avidemux code one day and made library specific...
+IF (ADM_CPU_X86)
+	SET(ARCH_X86 1)
+	SET(ARCH_X86_32 1)
+ELSEIF (ADM_CPU_X86_64)
+	SET(ARCH_X86 1)
+	SET(ARCH_X86_64 1)
+	SET(ARCH_64_BITS 1)
+ENDIF (ADM_CPU_X86)
+
+# LibMad
+IF (ADM_CPU_X86)
+	SET(FPM_INTEL 1)
+ELSEIF (ADM_CPU_X86_64)
+	SET(FPM_DEFAULT 1)
+ENDIF (ADM_CPU_X86)
+
+# Libavcodec
+INCLUDE(admSetLavcodecFlags)
+
+# LibMpeg2Dec
+SET(ACCEL_DETECT 1)
+
+########################################
+# Subversion
+########################################
+OPTION(SVN &quot;&quot; ON)
+
+IF (SVN AND NOT CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot; AND EXISTS &quot;${CMAKE_SOURCE_DIR}/.svn&quot;)
+	MESSAGE(STATUS &quot;Checking for Subversion&quot;)
+	MESSAGE(STATUS &quot;***********************&quot;)
+
+	FIND_PACKAGE(Subversion)
+
+	IF (Subversion_FOUND)
+		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+		MESSAGE(STATUS &quot;  revision: ${Project_WC_REVISION}&quot;)
+		SET(ADM_SUBVERSION ${Project_WC_REVISION})
+	ELSE (Subversion_FOUND)
+		MESSAGE(STATUS &quot;Could not find Subversion&quot;)
+	ENDIF (Subversion_FOUND)
+	
+	MESSAGE(&quot;&quot;)
+ENDIF (SVN AND NOT CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot; AND EXISTS &quot;${CMAKE_SOURCE_DIR}/.svn&quot;)
+
+IF (NOT Subversion_FOUND)
+	SET(ADM_SUBVERSION 0)
+ENDIF (NOT Subversion_FOUND)
+
+########################################
+# Check for libraries
+########################################
+# Define internal flags for GTK+ and Qt4 builds.  These are turned off
+# if a showstopper is found.  CLI is automatically assumed as possible
+# since it uses the minimum set of required libraries and CMake will 
+# fail if these aren't met.
+SET(ADM_UI_GTK 1)
+SET(ADM_UI_QT4 1)
+
+INCLUDE(admCheckRequiredLibs)
+INCLUDE(admCheckUserInterfaceLibs)
+INCLUDE(admCheckVideoCodecLibs)
+INCLUDE(admCheckAudioCodecLibs)
+INCLUDE(admCheckAudioDeviceLibs)
+INCLUDE(admCheckMiscLibs)
+
+########################################
+# Check functions and includes
+########################################
+MESSAGE(STATUS &quot;Checking system headers&quot;)
+MESSAGE(STATUS &quot;***********************&quot;)
+
+INCLUDE(CheckIncludeFiles)
+INCLUDE(CheckFunctionExists)
+
+CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
+
+CHECK_INCLUDE_FILES(inttypes.h   HAVE_INTTYPES_H)	# internal use, mpeg2enc, mplex
+CHECK_INCLUDE_FILES(stdint.h     HAVE_STDINT_H)		# internal use, mpeg2enc, mplex
+CHECK_INCLUDE_FILES(sys/types.h  HAVE_SYS_TYPES_H)	# mad, mpeg2enc
+CHECK_INCLUDE_FILES(unistd.h     HAVE_UNISTD_H)		# internal use, ass, mad
+CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# libavcodec, libavutil, libpostproc, libswscale, mplex
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Compiler Flags
+########################################
+IF (NOT CMAKE_BUILD_TYPE)
+	SET(CMAKE_BUILD_TYPE &quot;Release&quot;)
+ENDIF (NOT CMAKE_BUILD_TYPE)
+
+IF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+	SET(ADM_DEBUG 1)
+	ADD_DEFINITIONS(-DADM_DEBUG)
+ENDIF(CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+
+add_definitions(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
+add_definitions(-DHAVE_CONFIG_H)
+
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
+INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
+INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec)
+
+########################################
+# Print Summary
+########################################
+IF (VERBOSE)
+	INCLUDE(adm_log)
+	MESSAGE(&quot;&quot;)
+ENDIF (VERBOSE)
+
+INCLUDE(admConfigSummary)
+MESSAGE(&quot;&quot;)
+
+########################################
+# Generate config.h
+########################################
+CONFIGURE_FILE(&quot;${CMAKE_MODULE_PATH}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
+MESSAGE(STATUS &quot;config.h generated&quot;)
+
+########################################
+# Directories to build
+########################################
+ADD_SUBDIRECTORY(avidemux)
+ADD_SUBDIRECTORY(po)
\ No newline at end of file

Deleted: branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/ConfigureChecks.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,516 +0,0 @@
-########################################
-# CPU and Host
-########################################
-MESSAGE(STATUS &quot;Checking CPU and OS&quot;)
-INCLUDE(CMakeDetermineSystem)
-
-IF (WIN32)
-	SET(ADM_OS_WINDOWS 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86&quot;)
-		SET(ADM_CPU_X86 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86&quot;)
-ELSEIF (APPLE)
-	SET(ADM_OS_APPLE 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i386&quot;)
-		SET(ADM_CPU_X86 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i386&quot;)
-ELSEIF (UNIX)
-	SET(ADM_OS_UNIX 1)
-	
-	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i586&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i686&quot;)
-		SET(ADM_CPU_X86 1)
-	ELSEIF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86_64&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;amd64&quot;)
-		SET(ADM_CPU_X86_64 1)
-	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i586&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i686&quot;)
-ENDIF (WIN32)
-
-# Various defines (needs to be removed from Avidemux code one day and be library specific...)
-IF (ADM_CPU_X86)
-	SET(ARCH_X86 1)
-	SET(ARCH_X86_32 1)
-ELSEIF (ADM_CPU_X86_64)
-	SET(ARCH_X86 1)
-	SET(ARCH_X86_64 1)
-	SET(ARCH_64_BITS 1)
-ENDIF (ADM_CPU_X86)
-
-########################################
-# Include CMake scripts
-########################################
-INCLUDE(CheckIncludeFiles)
-INCLUDE(CheckSymbolExists)
-INCLUDE(CheckFunctionExists)
-INCLUDE(CheckLibraryExists)
-INCLUDE(lavcodec)
-INCLUDE(adm_checkHeaderLib)
-INCLUDE(adm_compile)
-
-########################################
-# Mangling
-########################################
-IF (ADM_OS_WINDOWS OR ADM_OS_APPLE)
-	SET(CYG_MANGLING 1)
-ENDIF (ADM_OS_WINDOWS OR ADM_OS_APPLE)
-
-########################################
-# Avidemux OS specific tweaks
-########################################
-IF (ADM_OS_WINDOWS)
-	SET(ADM_WIN32 1)		# needs to be removed one day...
-	ADD_DEFINITIONS(-mms-bitfields -mno-cygwin)
-ELSE (ADM_OS_WINDOWS)
-	IF (ADM_OS_APPLE)
-		SET(CFLAGS_ORIG $ENV{CFLAGS})
-		SET(CXXFLAGS_ORIG $ENV{CXXFLAGS})
-		
-		SET(ENV{CFLAGS} &quot;-I/opt/local/include -L/opt/local/lib $ENV{CFLAGS}&quot;)
-		SET(ENV{CXXFLAGS} &quot;-I/opt/local/include -L/opt/local/lib $ENV{CXXFLAGS}&quot;)
-
-		LINK_DIRECTORIES(/opt/local/lib)
-
-		SET(ADM_BSD_FAMILY 1)
-	ENDIF (ADM_OS_APPLE)
-
-	CHECK_FUNCTION_EXISTS(chmod HAVE_CHMOD)         # __homedir/homedir.cpp, gpg/gpg.cpp
-ENDIF (ADM_OS_WINDOWS)
-
-# Jog shuttle is only available on linux due to its interface
-IF(CMAKE_SYSTEM_NAME STREQUAL &quot;Linux&quot;)
-        SET(USE_JOG 1)
-ENDIF(CMAKE_SYSTEM_NAME STREQUAL &quot;Linux&quot;)
-
-########################################
-# Standard Avidemux defines
-########################################
-SET(VERSION 2.4)
-SET(PACKAGE_VERSION 2.4)
-
-SET(HAVE_BUILTIN_VECTOR 1)
-SET(HAVE_AUDIO 1)
-
-SET(USE_MP3 1)
-SET(USE_AC3 1)
-SET(USE_FFMPEG 1)
-SET(USE_MJPEG 1)
-SET(USE_LIBXML2 1)
-
-########################################
-# Check functions, includes, symbols
-########################################
-CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
-
-CHECK_INCLUDE_FILES(inttypes.h      HAVE_INTTYPES_H)                    # simapi.h
-CHECK_INCLUDE_FILES(stddef.h        HAVE_STDDEF_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdint.h        HAVE_STDINT_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdlib.h        HAVE_STDLIB_H)                      # simapi.h
-CHECK_INCLUDE_FILES(string.h        HAVE_STRING_H)                      # _core/libintl.cpp
-CHECK_INCLUDE_FILES(sys/stat.h      HAVE_SYS_STAT_H)                    # gpg/gpg.cpp
-CHECK_INCLUDE_FILES(sys/types.h     HAVE_SYS_TYPES_H)                   # simapi.h
-CHECK_INCLUDE_FILES(unistd.h        HAVE_UNISTD_H)                      # simapi.h
-CHECK_INCLUDE_FILES(malloc.h        HAVE_MALLOC_H)                      # simapi.h
-
-CHECK_SYMBOL_EXISTS(strcasecmp  &quot;strings.h&quot;         HAVE_STRCASECMP)    # simapi.h, various
-
-########################################
-# LibMad
-########################################
-IF (ADM_CPU_X86)
-	SET(FPM_INTEL 1)
-ELSEIF (ADM_CPU_X86_64)
-	SET(FPM_DEFAULT 1)
-ENDIF (ADM_CPU_X86)
-
-########################################
-# Libavcodec
-########################################
-SET_LAVCODEC_FLAGS()
-
-########################################
-# LibMpeg2Dec
-########################################
-SET(ACCEL_DETECT 1)
-
-########################################
-# Gettext
-########################################
-MESSAGE(STATUS &quot;&lt;Checking gettext&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;****************&gt;&quot;)
-
-IF (NO_NLS)
-	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
-ELSE (NO_NLS)
-	FIND_PATH(LIBINTL_H_DIR libintl.h $ENV{CXXFLAGS})
-	MESSAGE(STATUS &quot;libintl Header Path: ${LIBINTL_H_DIR}&quot;)
-
-	IF (NOT LIBINTL_H_DIR STREQUAL &quot;LIBINTL_H-NOTFOUND&quot;)
-		FIND_LIBRARY(LIBINTL_LIB_DIR intl $ENV{CXXFLAGS})
-		MESSAGE(STATUS &quot;libintl Library Path: ${LIBINTL_LIB_DIR}&quot;)
-
-		# Try linking without -lintl
-		ADM_COMPILE(gettext.cpp -I${LIBINTL_H_DIR} &quot;&quot; WITHOUT_LIBINTL outputWithoutLibintl)
-		
-		IF (WITHOUT_LIBINTL)
-			SET(HAVE_GETTEXT 1)
-			MESSAGE(STATUS &quot;Ok, No lib needed (${ADM_GETTEXT_LIB})&quot;)
-		ELSE (WITHOUT_LIBINTL)
-			ADM_COMPILE(gettext.cpp -I${LIBINTL_H_DIR} ${LIBINTL_LIB_DIR} WITH_LIBINTL outputWithLibintl)
-			
-			IF (WITH_LIBINTL)
-				SET(ADM_GETTEXT_LIB ${LIBINTL_LIB_DIR})
-				SET(HAVE_GETTEXT 1)
-				
-				MESSAGE(STATUS &quot;Ok, libintl needed&quot;)
-			ELSE (WITH_LIBINTL)
-				MESSAGE(STATUS &quot;Does not work, without ${outputWithoutLibintl}&quot;)
-				MESSAGE(STATUS &quot;Does not work, with ${outputWithLibintl}&quot;)
-			ENDIF (WITH_LIBINTL)
-		ENDIF (WITHOUT_LIBINTL)
-	ENDIF (NOT LIBINTL_H_DIR STREQUAL &quot;LIBINTL_H-NOTFOUND&quot;)
-
-	IF (HAVE_GETTEXT)
-		SET(ADM_GETTEXT_INCLUDE -I${LIBINTL_H_DIR})
-	ENDIF(HAVE_GETTEXT)
-ENDIF (NO_NLS)
-
-########################################
-# Locale
-########################################
-SET(ADM_LOCALE &quot;${CMAKE_INSTALL_PREFIX}/share/locale&quot;)
-
-########################################
-# ALSA
-########################################
-IF (ADM_OS_UNIX)
-	MESSAGE(STATUS &quot;&lt;Checking for ALSA&gt;&quot;)
-	MESSAGE(STATUS &quot;&lt;*****************&gt;&quot;)
-	IF (NO_ALSA)
-		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
-	ELSE (NO_ALSA)
-		INCLUDE(FindAlsa)
-		
-		IF (ALSA_FOUND)
-			ALSA_VERSION_STRING(alsaVersion)
-			
-			MESSAGE(&quot;Found alsa version :${alsaVersion}&quot;) 
-			MESSAGE(&quot;Found alsa lib     :${ASOUND_LIBRARY}&quot;)
-			
-			SET(ALSA_SUPPORT 1)
-			SET(ALSA_1_0_SUPPORT 1)
-		ENDIF (ALSA_FOUND)
-	ENDIF (NO_ALSA)
-ENDIF (ADM_OS_UNIX)
-
-########################################
-# SDL
-########################################
-MESSAGE(STATUS &quot;&lt;Checking for SDL&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;*****************&gt;&quot;)
-
-INCLUDE(admSDL)
-
-IF (NO_SDL)
-	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
-ELSE (NO_SDL)
-	include(FindSDL)
-
-	IF (SDL_FOUND)
-		SET(USE_SDL 1)
-		
-		MESSAGE(STATUS &quot;Found&quot;)
-	ELSE (SDL_FOUND)
-		MESSAGE(STATUS &quot;Not Found&quot;)
-	ENDIF (SDL_FOUND)
-	
-	MESSAGE(STATUS &quot;Flags: -I${SDL_INCLUDE_DIR}&quot;)
-	MESSAGE(STATUS &quot;Libraries: ${SDL_LIBRARY}&quot;)
-ENDIF (NO_SDL)
-
-########################################
-# FONTCONFIG
-########################################
-ADM_CHECK_HL(FontConfig fontconfig/fontconfig.h fontconfig FcStrSetCreate USE_FONTCONFIG)
-
-IF (USE_FONTCONFIG)
-	SET(HAVE_FONTCONFIG 1)
-ENDIF (USE_FONTCONFIG)
-
-########################################
-# Xvideo
-########################################
-IF (NOT NO_XV AND NOT ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS &quot;-include X11/Xlib.h&quot;)
-	SET(CMAKE_REQUIRED_LIBRARIES &quot;${X11_LIBRARIES}&quot;)
-	SET(CMAKE_REQUIRED_INCLUDE &quot;${X11_INCLUDE_DIR}&quot;)
-
-	ADM_CHECK_HL(Xvideo X11/extensions/Xvlib.h Xv XvShmPutImage USE_XV)
-	
-	MESSAGE(STATUS &quot;Flags: ${CMAKE_REQUIRED_FLAGS} ${X11_INCLUDE_DIR}&quot;)
-	MESSAGE(STATUS &quot;Libraries: ${X11_LIBRARIES}&quot;)
-
-	SET(CMAKE_REQUIRED_FLAGS)
-	SET(CMAKE_REQUIRED_LIBRARIES)
-	SET(CMAKE_REQUIRED_INCLUDE)
-ENDIF (NOT NO_XV AND NOT ADM_OS_WINDOWS)
-
-########################################
-# OSS
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	MESSAGE(STATUS &quot;&lt;Checking for OSS&gt;&quot;)
-	MESSAGE(STATUS &quot;&lt;*****************&gt;&quot;)
-	
-	IF (NO_OSS)
-		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
-	ELSE (NO_OSS)
-		CHECK_INCLUDE_FILES(sys/soundcard.h OSS_SUPPORT)
-		
-		IF (OSS_SUPPORT)
-			MESSAGE(STATUS &quot;Found&quot;)
-		ELSE (OSS_SUPPORT)
-			MESSAGE(STATUS &quot;Not found&quot;)
-		ENDIF (OSS_SUPPORT)
-	ENDIF (NO_OSS)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# ARTS
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	INCLUDE(FindArts)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# ESD
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	ADM_CHECK_HL(Esd esd.h  esd esd_close USE_ESD)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# JACK
-########################################
-IF (NOT ADM_OS_WINDOWS)
-	ADM_CHECK_HL(Jack jack/jack.h  jack jack_client_close USE_JACK)
-ENDIF (NOT ADM_OS_WINDOWS)
-
-########################################
-# Aften
-########################################
-IF (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS &quot;-lm -lpthreadGC2&quot;)
-ELSE (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_FLAGS &quot;-lm -lpthread&quot;)
-ENDIF (ADM_OS_WINDOWS)
-
-ADM_CHECK_HL(Aften aften/aften.h aften aften_encode_init USE_AFTEN)
-
-IF (USE_AFTEN)
-	FIND_LIBRARY(AFTEN_LIB_PATH NAMES aften $ENV{CXXFLAGS})
-
-	TRY_RUN(AFTEN_TEST_RUN_RESULT
-		AFTEN_TEST_COMPILE_RESULT
-		${CMAKE_BINARY_DIR}
-		&quot;${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp&quot;
-		CMAKE_FLAGS -DLINK_LIBRARIES=${AFTEN_LIB_PATH})
-
-	IF (AFTEN_TEST_RUN_RESULT EQUAL 8)
-		MESSAGE(STATUS &quot;Aften Version: 0.0.8&quot;)
-		SET(USE_AFTEN_08 1)
-	ELSEIF (AFTEN_TEST_RUN_RESULT EQUAL 7)
-		MESSAGE(STATUS &quot;Aften Version: 0.07&quot;)
-		SET(USE_AFTEN_07 1)
-	ELSE (AFTEN_TEST_RUN_RESULT EQUAL 8)
-		MESSAGE(STATUS &quot;Warning: Unable to determine Aften version - support for Aften will be turned off&quot;)
-		SET(USE_AFTEN 0)
-	ENDIF (AFTEN_TEST_RUN_RESULT EQUAL 8)
-ENDIF (USE_AFTEN)
-
-SET(CMAKE_REQUIRED_FLAGS &quot;&quot;)
-
-########################################
-# Secret Rabbit Code
-########################################
-ADM_CHECK_HL(libsamplerate samplerate.h samplerate src_get_version USE_SRC)
-
-########################################
-# ICONV
-########################################
-MESSAGE(STATUS &quot;&lt;Checking for iconv.h&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-
-CHECK_INCLUDE_FILES(iconv.h HAVE_ICONV_H)
-
-IF (NOT HAVE_ICONV_H)
-	MESSAGE(FATAL &quot;iconv.h not found&quot;)
-ENDIF (NOT HAVE_ICONV_H)
-
-# need libiconv ?
-CHECK_LIBRARY_EXISTS(iconv libiconv &quot;&quot; LINK_WITH_ICONV)
-
-IF (LINK_WITH_ICONV)
-	SET(NEED_LIBICONV 1)
-	MESSAGE(STATUS &quot;libiconv found, probably needed&quot;)
-ELSE (LINK_WITH_ICONV)
-	MESSAGE(STATUS &quot;libiconv not found, probably not needed&quot;)
-ENDIF (LINK_WITH_ICONV)
-
-MESSAGE(STATUS &quot;&lt;Checking if iconv needs const&gt;&quot;)
-
-IF (NEED_LIBICONV)
-	ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp &quot;-DICONV_NEED_CONST&quot; &quot;-liconv&quot; ICONV_WITH)
-ELSE (NEED_LIBICONV)
-	ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp &quot;-DICONV_NEED_CONST&quot; &quot;-lm&quot; ICONV_WITH)
-ENDIF (NEED_LIBICONV)
-
-IF (ICONV_WITH)
-	MESSAGE(STATUS &quot;Yes&quot;)
-	SET(ICONV_NEED_CONST 1)
-ELSE (ICONV_WITH)
-    MESSAGE(STATUS &quot;No&quot;)
-ENDIF(ICONV_WITH)
-
-########################################
-# LAME
-########################################
-SET(CMAKE_REQUIRED_LIBRARIES &quot;-lm&quot;)
-ADM_CHECK_HL(Lame lame/lame.h mp3lame lame_init HAVE_LIBMP3LAME)
-SET(CMAKE_REQUIRED_LIBRARIES)
-
-########################################
-# Xvid
-########################################
-ADM_CHECK_HL(Xvid xvid.h xvidcore xvid_plugin_single USE_XVID_4)
-
-########################################
-# AMR_NB
-########################################
-IF (USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(amrnb/interf_dec.h USE_AMR_NB)
-ELSE (USE_LATE_BINDING)
-	ADM_CHECK_HL(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode USE_AMR_NB)
-ENDIF (USE_LATE_BINDING)
-
-IF (USE_AMR_NB)
-	SET(CONFIG_AMR_NB 1)
-ENDIF (USE_AMR_NB)
-
-########################################
-# Libdca
-########################################
-SET(CMAKE_REQUIRED_FLAGS &quot;-include stdint.h&quot;)
-SET(CMAKE_REQUIRED_LIBRARIES &quot;-lm&quot;)
-
-IF (USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(dts.h USE_LIBDCA)
-ELSE (USE_LATE_BINDING)
-	ADM_CHECK_HL(libdca dts.h dts dts_init USE_LIBDCA)
-ENDIF (USE_LATE_BINDING)
-
-SET(CMAKE_REQUIRED_LIBRARIES)
-SET(CMAKE_REQUIRED_FLAGS)
-
-########################################
-# X264
-########################################
-SET(CMAKE_REQUIRED_FLAGS &quot;-include stdint.h&quot;)
-
-IF (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_LIBRARIES &quot;-lm -lpthreadGC2&quot;)
-ELSE (ADM_OS_WINDOWS)
-	SET(CMAKE_REQUIRED_LIBRARIES &quot;-lm -lpthread&quot;)
-ENDIF (ADM_OS_WINDOWS)
-
-ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
-SET(CMAKE_REQUIRED_FLAGS)
-SET(CMAKE_REQUIRED_LIBRARIES)
-
-########################################
-# PNG
-########################################
-ADM_CHECK_HL(libPNG png.h png png_malloc USE_PNG)
-
-########################################
-# FAAD
-########################################
-ADM_CHECK_HL(FAAD faad.h faad faacDecInit USE_FAAD_P)
-
-IF(NOT USE_FAAD_P)
-	MESSAGE(STATUS &quot;Trying neaac variant&quot;)
-	ADM_CHECK_HL(NeAAC faad.h faad NeAACDecInit USE_FAAD_A)
-ENDIF(NOT USE_FAAD_P)
-
-IF(USE_FAAD_P OR USE_FAAD_A)
-	SET(USE_FAAD  1)
-ENDIF(USE_FAAD_P OR USE_FAAD_A)
-
-# See if we need old FAAD or new
-IF (USE_FAAD)
-	FIND_PATH(FAAD_H_DIR faad.h $ENV{CXXFLAGS})
-	FIND_LIBRARY(FAAD_LIB_DIR faad $ENV{CXXFLAGS})
-	
-	MESSAGE(STATUS &quot;&lt;Checking if faad needs old proto&gt;&quot;)
-	ADM_COMPILE_WITH_WITHOUT(faad_check.cpp &quot;-DOLD_FAAD_PROTO -I${FAAD_H_DIR}&quot; &quot;${FAAD_LIB_DIR}&quot; FAAD_WITH)
-	
-	IF(FAAD_WITH)
-		MESSAGE(STATUS &quot;Yes&quot;)
-		SET(OLD_FAAD_PROTO 1)
-	ELSE (FAAD_WITH)
-		MESSAGE(STATUS &quot;No&quot;)
-	ENDIF (FAAD_WITH)
-ENDIF(USE_FAAD)
-
-########################################
-# FAAC
-########################################
-SET(CMAKE_REQUIRED_FLAGS &quot;-include stdint.h&quot;)
-ADM_CHECK_HL(FAAC faac.h faac faacEncClose USE_FAAC)
-SET(CMAKE_REQUIRED_FLAGS)
-
-########################################
-# FreeType
-########################################
-IF (FT_FOUND)
-	SET(USE_FREETYPE 1)
-ENDIF (FT_FOUND)
-
-########################################
-# Vorbis
-########################################
-ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbis vorbis_info_init USE_VORBIS1)
-ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbisenc vorbis_encode_init USE_VORBIS2)
-
-IF (USE_VORBIS1 AND USE_VORBIS2)
-	SET(USE_VORBIS 1)
-ENDIF (USE_VORBIS1 AND USE_VORBIS2)
-
-########################################
-# End test
-########################################
-ADM_CHECK_HL(Invalid dummy_header.h dummy_libxyz dummy_func_tyu DUMMY_TEST)
-ADM_CHECK_HL(Invalid stdio.h dummy_libxyz dummy_func_tyu DUMMY_TEST2)
-
-IF (DUMMY_TEST OR DUMMY_TEST2)
-	MESSAGE(FATAL &quot;This test should have failed!!!&quot;)
-	MESSAGE(FATAL &quot;This test should have failed!!!&quot;)
-	MESSAGE(FATAL &quot;This test should have failed!!!&quot;)
-ENDIF (DUMMY_TEST OR DUMMY_TEST2)
-
-INCLUDE(adm_log)
-
-IF (NOT CMAKE_BUILD_TYPE)
-	SET(CMAKE_BUILD_TYPE &quot;Release&quot;)
-ENDIF (NOT CMAKE_BUILD_TYPE)
-
-IF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
-	MESSAGE(STATUS &quot;** DEBUG BUILD (${CMAKE_BUILD_TYPE})**&quot;)
-	
-	SET(ADM_DEBUG 1)
-	ADD_DEFINITIONS(-DADM_DEBUG)
-ELSE (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
-	MESSAGE(STATUS &quot;** RELEASE BUILD (${CMAKE_BUILD_TYPE})**&quot;)
-ENDIF(CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
-
-MESSAGE(&quot;LINK_FLAGS ${CMAKE_LD_FLAGS}&quot;)
-# EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -3,15 +3,16 @@
 ################################
 include(AdmLib)
 SET(ADM_LIB ADM_libass)
-#
-if(FT_FOUND)
-SET(${ADM_LIB}_SRCS 
-ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
-ass_font.c
-)
-ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
-ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
-endif(FT_FOUND)
 
-################################
-ADD_definitions(${FT_CFLAGS} )
+if(USE_FREETYPE)
+	SET(${ADM_LIB}_SRCS 
+	ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c   ass_render.c  ass_utils.c  mputils.c
+	ass_font.c
+	)
+	ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+	ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
+	
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
+################################
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libswscale/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -11,12 +11,12 @@
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
 ADD_DEFINITIONS(-DCONFIG_GPL -fomit-frame-pointer)
 
-IF (ADM_OS_APPLE)
+IF (ADM_OS_DARWIN)
 	ADD_DEFINITIONS(-DPIC)
 	
 	IF (ADM_DEBUG)
 		ADD_DEFINITIONS(-O2)
 	ENDIF (ADM_DEBUG)
-ENDIF (ADM_OS_APPLE)
+ENDIF (ADM_OS_DARWIN)
 
 ################################

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -23,6 +23,6 @@
 	subdirs (PREORDER ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE AND USE_SDL)
+if (ADM_OS_DARWIN AND USE_SDL)
 	subdirs (PREORDER ADM_libsdl)
-endif (ADM_OS_APPLE AND USE_SDL)
\ No newline at end of file
+endif (ADM_OS_DARWIN AND USE_SDL)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-11-14 16:59:14 UTC (rev 3690)
@@ -31,8 +31,6 @@
 #undef HAVE_INTTYPES_H
 #undef HAVE_MALLOC_H
 #undef HAVE_STDINT_H
-#undef HAVE_STDLIB_H
-#undef HAVE_STRING_H
 #undef HAVE_SYS_TYPES_H
 #include &quot;SDL.h&quot;
 #include &quot;SDL_syswm.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_video/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -17,7 +17,9 @@
 ADM_vidNull.cpp          
 )
 ADD_LIBRARY(ADM_video STATIC ${ADM_video_SRCS})
-if(FT_FOUND)
-add_definitions(${FT_CFLAGS})
-endif(FT_FOUND)
+
+if(USE_FREETYPE)
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
 include_directories(../ADM_inputs)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,55 +1,57 @@
-
-SET(ADM_videoFilter_SRCS 
-ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp    
-ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
-ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp     
-ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
-ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp     
-ADM_vidReverse.cpp        ADM_vidVlad.cpp
-ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp  
-ADM_vidRotate.cpp         ADM_vidWhirl.cpp
-ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp   
-ADM_vidSeparateField.cpp  ADM_vidYadif.cpp
-ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp    
-ADM_vidSoften.cpp
-ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp   
-ADM_vidStabilize.cpp
-ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp   
-ADM_vidSwapFields.cpp
-ADM_vidYadif_asm.c
-ADM_guiResize.cpp  ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
-ADM_vidMPLResize.cpp  
-ADM_vidResize25.cpp
-ADM_vidTdeint.cpp
-ADM_vidChromaShift.cpp  
-ADM_vidAnimated.cpp
-ADM_vidDvbSub.cpp
-ADM_vidLogo.cpp
-ADM_vidHue.cpp
-ADM_vidSRT.cpp
-ADM_vidSRTload.cpp
-ADM_vidSRTRender.cpp
-ADM_vidCrop.cpp       
-ADM_vidEq2.cpp      
-ADM_vidContrast.cpp 
-ADM_vidDelta.cpp 
-ADM_vidUnblend.cpp 
-ADM_vidAsharp.cpp
-ADM_vidVobsub.cpp
-ADM_vidVobSubRender.cpp
-ADM_vobsubinfo.cpp
-ADM_vidComputeAverage.cpp
-ADM_vidSwissArmyKnife.cpp
-ADM_vidThreshold.cpp
-ADM_vidParticle.cpp
-
-)
-ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})
-if(FT_FOUND)
-add_definitions(${FT_CFLAGS})
-endif(FT_FOUND)
-include_directories(../ADM_inputs)
-
-IF (ADM_OS_APPLE AND ADM_DEBUG)
+
+SET(ADM_videoFilter_SRCS 
+ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp    
+ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
+ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp     
+ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
+ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp     
+ADM_vidReverse.cpp        ADM_vidVlad.cpp
+ADM_vidBlend.cpp         ADM_vidDenoise.cpp          ADM_vidForcedPP.cpp         ADM_vidMPLD3Dlow.cpp  
+ADM_vidRotate.cpp         ADM_vidWhirl.cpp
+ADM_vidBlendRemoval.cpp  ADM_vidDGbob.cpp            ADM_vidHardIvtcRemoval.cpp  ADM_vidMSharpen.cpp   
+ADM_vidSeparateField.cpp  ADM_vidYadif.cpp
+ADM_vidBSmear.cpp        ADM_vidDropOut.cpp          ADM_vidKernelDeint.cpp      ADM_vidMsmooth.cpp    
+ADM_vidSoften.cpp
+ADM_vidChroma.cpp        ADM_vidFade.cpp             ADM_vidLargeMedian.cpp      ADM_vidPalShift.cpp   
+ADM_vidStabilize.cpp
+ADM_vidDecDec.cpp        ADM_vidFastConvolution.cpp  ADM_vidLuma.cpp             ADM_vidPalSmart.cpp   
+ADM_vidSwapFields.cpp
+ADM_vidYadif_asm.c
+ADM_guiResize.cpp  ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
+ADM_vidMPLResize.cpp  
+ADM_vidResize25.cpp
+ADM_vidTdeint.cpp
+ADM_vidChromaShift.cpp  
+ADM_vidAnimated.cpp
+ADM_vidDvbSub.cpp
+ADM_vidLogo.cpp
+ADM_vidHue.cpp
+ADM_vidSRT.cpp
+ADM_vidSRTload.cpp
+ADM_vidSRTRender.cpp
+ADM_vidCrop.cpp       
+ADM_vidEq2.cpp      
+ADM_vidContrast.cpp 
+ADM_vidDelta.cpp 
+ADM_vidUnblend.cpp 
+ADM_vidAsharp.cpp
+ADM_vidVobsub.cpp
+ADM_vidVobSubRender.cpp
+ADM_vobsubinfo.cpp
+ADM_vidComputeAverage.cpp
+ADM_vidSwissArmyKnife.cpp
+ADM_vidThreshold.cpp
+ADM_vidParticle.cpp
+
+)
+ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})
+
+if(USE_FREETYPE)
+	include_directories(${FREETYPE2_INCLUDE_DIRS})
+endif(USE_FREETYPE)
+
+include_directories(../ADM_inputs)
+
+IF (ADM_OS_DARWIN AND ADM_DEBUG)
 	SET_SOURCE_FILES_PROPERTIES(ADM_vidYadif_asm.c PROPERTIES COMPILE_FLAGS &quot;-O2&quot;)
-ENDIF (ADM_OS_APPLE AND ADM_DEBUG)
\ No newline at end of file
+ENDIF (ADM_OS_DARWIN AND ADM_DEBUG)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2007-11-14 16:59:14 UTC (rev 3690)
@@ -24,18 +24,6 @@
 	endif(QT4_FOUND)
 ENDMACRO (add_libs_all_targets _libName)
 
-MACRO (add_link_flags _target _flg)
-	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
-
-	if (_flags)
-		set(_flags &quot;${_flags} ${_flg}&quot;)
-	else (_flags)
-		set(_flags &quot;${_flg}&quot;)
-	endif (_flags)
-
-	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS &quot;${_flags}&quot;)
-ENDMACRO (add_link_flags)
-
 MACRO (add_ldflags_all_targets _libName)
 	add_link_flags(avidemux2_cli ${_libName})
 
@@ -48,18 +36,6 @@
 	endif(QT4_FOUND)
 ENDMACRO (add_ldflags_all_targets _libName)
 
-MACRO (add_compile_flags _target _flg)
-	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
-
-	if (_flags)
-		set(_flags &quot;${_flags} ${_flg}&quot;)
-	else (_flags)
-		set(_flags &quot;${_flg}&quot;)
-	endif (_flags)
-   
-	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS &quot;${_flags}&quot;)   
-ENDMACRO (add_compile_flags)
-
 ########################################################
 # Our exectuables
 ########################################################
@@ -192,9 +168,9 @@
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_nvwa)
 endif (ADM_DEBUG AND FIND_LEAKS)
 
-if (ADM_OS_APPLE AND USE_SDL)
+if (ADM_OS_DARWIN AND USE_SDL)
 	SET(ADM_LIBRARIES ${ADM_LIBRARIES} ADM_libsdl)
-endif (ADM_OS_APPLE AND USE_SDL)
+endif (ADM_OS_DARWIN AND USE_SDL)
 
 FOREACH(_current ${ADM_LIBRARIES})
 	add_libs_all_targets(${_current})
@@ -244,54 +220,52 @@
 # Add external libs
 ###########################################
 #iconv
-if(NEEED_LIBICONV)
-	add_libs_all_targets(iconv)
-endif(NEEED_LIBICONV)
+add_libs_all_targets(&quot;${LIBICONV_LIBRARY_DIR}&quot;)
 
 #gettext
-if(ADM_GETTEXT_LIB)
-	INCLUDE_DIRECTORIES(${ADM_GETTEXT_INCLUDE})
-	TARGET_LINK_LIBRARIES(avidemux2_cli ${ADM_GETTEXT_LIB})
+if (GETTEXT_FOUND)
+	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
+	TARGET_LINK_LIBRARIES(avidemux2_cli &quot;${GETTEXT_LIBRARY_DIR}&quot;)
 
 	if(GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk ${ADM_GETTEXT_LIB})
+		TARGET_LINK_LIBRARIES(avidemux2_gtk &quot;${GETTEXT_LIBRARY_DIR}&quot;)
 	endif(GTK_FOUND)
-endif(ADM_GETTEXT_LIB)
+endif (GETTEXT_FOUND)
 
 #freetype
 if(USE_FREETYPE)
-	add_libs_all_targets(${FT_LDFLAGS})
+	add_libs_all_targets(&quot;${FREETYPE2_LDFLAGS}&quot;)
 endif(USE_FREETYPE)
 
 #fontconfig
 if(USE_FONTCONFIG)
-	add_libs_all_targets(fontconfig)
+	add_libs_all_targets(&quot;${FONTCONFIG_LIBRARY_DIR}&quot;)
 endif(USE_FONTCONFIG)
 
 # png
 if(USE_PNG)
-	TARGET_LINK_LIBRARIES(avidemux2_cli png)
+	TARGET_LINK_LIBRARIES(avidemux2_cli ${PNG_LIBRARIES})
 	
 	if(GTK_FOUND)
-		TARGET_LINK_LIBRARIES(avidemux2_gtk png)
+		TARGET_LINK_LIBRARIES(avidemux2_gtk ${PNG_LIBRARIES})
 	endif(GTK_FOUND)
 	
 	if (QT4_FOUND)
-		if (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
-			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
-		elseif (NOT ADM_OS_APPLE)
-			TARGET_LINK_LIBRARIES(avidemux2_qt4 png)
-		endif (ADM_OS_APPLE AND NOT QT_USE_FRAMEWORKS)
+		if (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
+		elseif (NOT ADM_OS_DARWIN)
+			TARGET_LINK_LIBRARIES(avidemux2_qt4 ${PNG_LIBRARIES})
+		endif (ADM_OS_DARWIN AND NOT QT_USE_FRAMEWORKS)
 	endif (QT4_FOUND)
 endif(USE_PNG)
 
 # Xml2
-add_libs_all_targets(xml2)
+add_libs_all_targets(&quot;${LIBXML2_LIBRARIES}&quot;)
 
 #XVideo 
 if(USE_XV)
 	add_libs_all_targets(&quot;${X11_LIBRARIES}&quot;)
-	add_libs_all_targets(Xv)
+	add_libs_all_targets(&quot;{$XVIDEO_LIBRARY}&quot;)
 endif(USE_XV)
 
 # SDL
@@ -311,63 +285,63 @@
 
 # ESD
 if(USE_ESD)
-	add_libs_all_targets(esd)
+	add_libs_all_targets(&quot;${ESD_LIBRARY}&quot;)
 endif(USE_ESD)
 
 # JACK
 if(USE_JACK)
-	add_libs_all_targets(jack)
+	add_libs_all_targets(&quot;${JACK_LIBRARY_DIR}&quot;)
 endif(USE_JACK)
 
 # libAMRNB
 if(USE_AMR_NB AND NOT USE_LATE_BINDING)
-	add_libs_all_targets(amrnb)
+	add_libs_all_targets(&quot;${AMRNB_LIBRARY_DIR}&quot;)
 endif(USE_AMR_NB AND NOT USE_LATE_BINDING)
 
 #libdts
 if(USE_LIBDCA AND NOT USE_LATE_BINDING)
-	add_libs_all_targets(dts)
+	add_libs_all_targets(&quot;${LIBDCA_LIBRARY_DIR}&quot;)
 endif(USE_LIBDCA AND NOT USE_LATE_BINDING)
 
 # Lame
 if(HAVE_LIBMP3LAME)
-	add_libs_all_targets(mp3lame)
+	add_libs_all_targets(&quot;${LAME_LIBRARY_DIR}&quot;)
 endif(HAVE_LIBMP3LAME)
 
 # Vorbis
 if(USE_VORBIS)
-	add_libs_all_targets(vorbis)
-	add_libs_all_targets(vorbisenc)
+	add_libs_all_targets(&quot;${VORBIS_LIBRARY_DIR}&quot;)
+	add_libs_all_targets(&quot;${VORBISENC_LIBRARY_DIR}&quot;)
 endif(USE_VORBIS)
 
 #faac
 if(USE_FAAC)
-	add_libs_all_targets(faac)
+	add_libs_all_targets(&quot;${FAAC_LIBRARY_DIR}&quot;)
 endif(USE_FAAC)
 
 #aften
 if(USE_AFTEN)
-	add_libs_all_targets(aften)
+	add_libs_all_targets(&quot;${AFTEN_LIBRARY_DIR}&quot;)
 endif(USE_AFTEN)
 
 #faad
 if(USE_FAAD)
-	add_libs_all_targets(faad)
+	add_libs_all_targets(&quot;${FAAD_LIBRARY_DIR}&quot;)
 endif(USE_FAAD)
 
 #libsamplerate
 if(USE_SRC)
-	add_libs_all_targets(samplerate)
+	add_libs_all_targets(&quot;${SRC_LIBRARY_DIR}&quot;)
 endif(USE_SRC)
 
 # xvid
 if(USE_XVID_4)
-	add_libs_all_targets(xvidcore)
+	add_libs_all_targets(&quot;${XVID_LIBRARY_DIR}&quot;)
 endif(USE_XVID_4)
 
 # x264
 if(USE_X264)
-	add_libs_all_targets(x264)
+	add_libs_all_targets(&quot;${X264_LIBRARY_DIR}&quot;)
 endif(USE_X264)
 
 ###########################################
@@ -394,7 +368,6 @@
 # Win32
 ########################
 IF (ADM_OS_WINDOWS)
-	add_libs_all_targets(z)
 	add_libs_all_targets(ADM_osSupport)
 	add_libs_all_targets(pthreadGC2)
 	add_libs_all_targets(winmm)
@@ -411,16 +384,15 @@
 ########################
 # MacOsX
 ########################
-if (ADM_OS_APPLE)
-	add_libs_all_targets(z)
+if (ADM_OS_DARWIN)
 	add_libs_all_targets(&quot;-framework CoreServices -framework CoreAudio -framework AudioUnit&quot;)
-endif (ADM_OS_APPLE)
+endif (ADM_OS_DARWIN)
 
 ########################
 # all
 ########################
 SDLify(main.cpp)
-add_compile_flags(main.cpp &quot;-DADM_SUBVERSION=${ADM_SUBVERSION}&quot;)
+add_source_compile_flags(main.cpp &quot;-DADM_SUBVERSION=${ADM_SUBVERSION}&quot;)
 
 ###############
 # INSTALL

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindArts.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,27 +1,16 @@
 # Find arts CFLAGS etc
 
-MESSAGE(STATUS &quot;&lt;** ARTS **&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;----------&gt;&quot;)
-if(NO_ARTS)
-message(status &quot;&lt;disabled per request&gt;&quot;)
-else(NO_ARTS)
 FIND_PROGRAM(ARTS_CONFIG_EXECUTABLE artsc-config)
 MARK_AS_ADVANCED(ARTS_CONFIG_EXECUTABLE)
 
-IF(ARTS_CONFIG_EXECUTABLE)
+IF (ARTS_CONFIG_EXECUTABLE)
     EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --cflags
       OUTPUT_VARIABLE ARTS_CFLAGS
       OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS &quot;Arts cflags : ${ARTS_CFLAGS}&quot;)
+      
     EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --libs
       OUTPUT_VARIABLE ARTS_LDFLAGS
       OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS &quot;Arts ldflags : ${ARTS_LDFLAGS}&quot;)
-    SET(USE_ARTS 1)
-ELSE(ARTS_CONFIG_EXECUTABLE)
-MESSAGE(STATUS &quot;Not found&quot;)
-ENDIF(ARTS_CONFIG_EXECUTABLE)
-endif(NO_ARTS)
 
-
-# FindSubversion.cmake ends here.
+    SET(ARTS_FOUND TRUE)
+ENDIF(ARTS_CONFIG_EXECUTABLE)

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPNG.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,58 @@
+# - Find the native PNG includes and library
+#
+
+# This module defines
+#  PNG_INCLUDE_DIR, where to find png.h, etc.
+#  PNG_LIBRARIES, the libraries to link against to use PNG.
+#  PNG_DEFINITIONS - You should ADD_DEFINITONS(${PNG_DEFINITIONS}) before compiling code that includes png library files.
+#  PNG_FOUND, If false, do not try to use PNG.
+# also defined, but not for general use are
+#  PNG_LIBRARY, where to find the PNG library.
+# None of the above will be defined unles zlib can be found.
+# PNG depends on Zlib
+INCLUDE(FindZLIB)
+
+SET(PNG_FOUND &quot;NO&quot;)
+
+IF(ZLIB_FOUND)
+  FIND_PATH(PNG_PNG_INCLUDE_DIR png.h
+  /usr/local/include
+  /usr/include
+  /usr/local/include/libpng             # OpenBSD
+  )
+
+  SET(PNG_NAMES ${PNG_NAMES} png libpng)
+  FIND_LIBRARY(PNG_LIBRARY
+    NAMES ${PNG_NAMES}
+    PATHS /usr/lib /usr/local/lib
+  )
+
+  IF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
+      # png.h includes zlib.h. Sigh.
+      SET(PNG_INCLUDE_DIR ${PNG_PNG_INCLUDE_DIR} ${ZLIB_INCLUDE_DIR} )
+      SET(PNG_LIBRARIES ${PNG_LIBRARY} ${ZLIB_LIBRARY})
+      SET(PNG_FOUND &quot;YES&quot;)
+
+      IF (CYGWIN)
+        IF(BUILD_SHARED_LIBS)
+           # No need to define PNG_USE_DLL here, because it's default for Cygwin.
+        ELSE(BUILD_SHARED_LIBS)
+          SET (PNG_DEFINITIONS -DPNG_STATIC)
+        ENDIF(BUILD_SHARED_LIBS)
+      ENDIF (CYGWIN)
+
+  ENDIF (PNG_LIBRARY AND PNG_PNG_INCLUDE_DIR)
+
+ENDIF(ZLIB_FOUND)
+
+IF (PNG_FOUND)
+  IF (NOT PNG_FIND_QUIETLY)
+    MESSAGE(STATUS &quot;Found PNG: ${PNG_LIBRARY}&quot;)
+  ENDIF (NOT PNG_FIND_QUIETLY)
+ELSE (PNG_FOUND)
+  IF (PNG_FIND_REQUIRED)
+    MESSAGE(FATAL_ERROR &quot;Could not find PNG library&quot;)
+  ENDIF (PNG_FIND_REQUIRED)
+ENDIF (PNG_FOUND)
+
+MARK_AS_ADVANCED(PNG_PNG_INCLUDE_DIR PNG_LIBRARY )

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindPkgConfig.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,360 @@
+# - a pkg-config module for CMake
+#
+# Usage:
+#   pkg_check_modules(&lt;PREFIX&gt; [REQUIRED] &lt;MODULE&gt; [&lt;MODULE&gt;]*)
+#     checks for all the given modules
+#
+#   pkg_search_module(&lt;PREFIX&gt; [REQUIRED] &lt;MODULE&gt; [&lt;MODULE&gt;]*)
+#     checks for given modules and uses the first working one
+#
+# When the 'REQUIRED' argument was set, macros will fail with an error
+# when module(s) could not be found
+#
+# It sets the following variables:
+#   PKG_CONFIG_FOUND         ... true iff pkg-config works on the system
+#   PKG_CONFIG_EXECUTABLE    ... pathname of the pkg-config program
+#   &lt;PREFIX&gt;_FOUND           ... set to 1 iff module(s) exist
+#
+# For the following variables two sets of values exist; first one is the
+# common one and has the given PREFIX. The second set contains flags
+# which are given out when pkgconfig was called with the '--static'
+# option.
+#   &lt;XPREFIX&gt;_LIBRARIES      ... only the libraries (w/o the '-l')
+#   &lt;XPREFIX&gt;_LIBRARY_DIRS   ... the paths of the libraries (w/o the '-L')
+#   &lt;XPREFIX&gt;_LDFLAGS        ... all required linker flags
+#   &lt;XPREFIX&gt;_LDFLAGS_OTHERS ... all other linker flags
+#   &lt;XPREFIX&gt;_INCLUDE_DIRS   ... the '-I' preprocessor flags (w/o the '-I')
+#   &lt;XPREFIX&gt;_CFLAGS         ... all required cflags
+#   &lt;XPREFIX&gt;_CFLAGS_OTHERS  ... the other compiler flags
+#
+#   &lt;XPREFIX&gt; = &lt;PREFIX&gt;        for common case
+#   &lt;XPREFIX&gt; = &lt;PREFIX&gt;_STATIC for static linking
+#
+# There are some special variables whose prefix depends on the count
+# of given modules. When there is only one module, &lt;PREFIX&gt; stays
+# unchanged. When there are multiple modules, the prefix will be
+# changed to &lt;PREFIX&gt;_&lt;MODNAME&gt;:
+#   &lt;XPREFIX&gt;_VERSION    ... version of the module
+#   &lt;XPREFIX&gt;_PREFIX     ... prefix-directory of the module
+#   &lt;XPREFIX&gt;_INCLUDEDIR ... include-dir of the module
+#   &lt;XPREFIX&gt;_LIBDIR     ... lib-dir of the module
+#
+#   &lt;XPREFIX&gt; = &lt;PREFIX&gt;  when |MODULES| == 1, else
+#   &lt;XPREFIX&gt; = &lt;PREFIX&gt;_&lt;MODNAME&gt;
+#
+# A &lt;MODULE&gt; parameter can have the following formats:
+#   {MODNAME}            ... matches any version
+#   {MODNAME}&gt;={VERSION} ... at least version &lt;VERSION&gt; is required
+#   {MODNAME}={VERSION}  ... exactly version &lt;VERSION&gt; is required
+#   {MODNAME}&lt;={VERSION} ... modules must not be newer than &lt;VERSION&gt;
+#
+# Examples
+#   pkg_check_modules (GLIB2   glib-2.0)
+#
+#   pkg_check_modules (GLIB2   glib-2.0&gt;=2.10)
+#     requires at least version 2.10 of glib2 and defines e.g.
+#       GLIB2_VERSION=2.10.3
+#
+#   pkg_check_modules (FOO     glib-2.0&gt;=2.10 gtk+-2.0)
+#     requires both glib2 and gtk2, and defines e.g.
+#       FOO_glib-2.0_VERSION=2.10.3
+#       FOO_gtk+-2.0_VERSION=2.8.20
+#
+#   pkg_check_modules (XRENDER REQUIRED xrender)
+#     defines e.g.:
+#       XRENDER_LIBRARIES=Xrender;X11
+#       XRENDER_STATIC_LIBRARIES=Xrender;X11;pthread;Xau;Xdmcp
+#
+#   pkg_search_module (BAR     libxml-2.0 libxml2 libxml&gt;=2)
+
+
+# Copyright (C) 2006 Enrico Scholz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">enrico.scholz at informatik.tu-chemnitz.de</A>&gt;
+#
+# Redistribution and use, with or without modification, are permitted
+# provided that the following conditions are met:
+# 
+#    1. Redistributions must retain the above copyright notice, this
+#       list of conditions and the following disclaimer.
+#    2. The name of the author may not be used to endorse or promote
+#       products derived from this software without specific prior
+#       written permission.
+# 
+# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
+# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
+# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
+# IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
+# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
+# IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+
+### Common stuff ####
+set(PKG_CONFIG_VERSION 1)
+set(PKG_CONFIG_FOUND   0)
+
+find_program(PKG_CONFIG_EXECUTABLE NAMES pkg-config DOC &quot;pkg-config executable&quot;)
+mark_as_advanced(PKG_CONFIG_EXECUTABLE)
+
+if(PKG_CONFIG_EXECUTABLE)
+  set(PKG_CONFIG_FOUND 1)
+endif(PKG_CONFIG_EXECUTABLE)
+
+
+# Unsets the given variables
+macro(_pkgconfig_unset var)
+  set(${var} &quot;&quot; CACHE INTERNAL &quot;&quot;)
+endmacro(_pkgconfig_unset)
+
+macro(_pkgconfig_set var value)
+  set(${var} ${value} CACHE INTERNAL &quot;&quot;)
+endmacro(_pkgconfig_set)
+
+# Invokes pkgconfig, cleans up the result and sets variables
+macro(_pkgconfig_invoke _pkglist _prefix _varname _regexp)
+  set(_pkgconfig_invoke_result)
+
+  execute_process(
+    COMMAND ${PKG_CONFIG_EXECUTABLE} ${ARGN} ${_pkglist}
+    OUTPUT_VARIABLE _pkgconfig_invoke_result
+    RESULT_VARIABLE _pkgconfig_failed)
+
+  if (_pkgconfig_failed)
+    set(_pkgconfig_${_varname} &quot;&quot;)
+    _pkgconfig_unset(${_prefix}_${_varname})
+  else(_pkgconfig_failed)
+    string(REGEX REPLACE &quot;[\r\n]&quot;                  &quot; &quot; _pkgconfig_invoke_result &quot;${_pkgconfig_invoke_result}&quot;)
+    string(REGEX REPLACE &quot; +$&quot;                     &quot;&quot;  _pkgconfig_invoke_result &quot;${_pkgconfig_invoke_result}&quot;)
+
+    if (NOT ${_regexp} STREQUAL &quot;&quot;)
+      string(REGEX REPLACE &quot;${_regexp}&quot; &quot; &quot; _pkgconfig_invoke_result &quot;${_pkgconfig_invoke_result}&quot;)
+    endif(NOT ${_regexp} STREQUAL &quot;&quot;)
+
+    separate_arguments(_pkgconfig_invoke_result)
+
+    #message(STATUS &quot;  ${_varname} ... ${_pkgconfig_invoke_result}&quot;)
+    set(_pkgconfig_${_varname} ${_pkgconfig_invoke_result})
+    _pkgconfig_set(${_prefix}_${_varname} &quot;${_pkgconfig_invoke_result}&quot;)
+  endif(_pkgconfig_failed)
+endmacro(_pkgconfig_invoke)
+
+# Invokes pkgconfig two times; once without '--static' and once with
+# '--static'
+macro(_pkgconfig_invoke_dyn _pkglist _prefix _varname cleanup_regexp)
+  _pkgconfig_invoke(&quot;${_pkglist}&quot; ${_prefix}        ${_varname} &quot;${cleanup_regexp}&quot; ${ARGN})
+  _pkgconfig_invoke(&quot;${_pkglist}&quot; ${_prefix} STATIC_${_varname} &quot;${cleanup_regexp}&quot; --static  ${ARGN})
+endmacro(_pkgconfig_invoke_dyn)
+
+# Splits given arguments into options and a package list
+macro(_pkgconfig_parse_options _result _is_req)
+  set(${_is_req} 0)
+  
+  foreach(_pkg ${ARGN})
+    if (_pkg STREQUAL &quot;REQUIRED&quot;)
+      set(${_is_req} 1)
+    endif (_pkg STREQUAL &quot;REQUIRED&quot;)
+  endforeach(_pkg ${ARGN})
+
+  set(${_result} ${ARGN})
+  list(REMOVE_ITEM ${_result} &quot;REQUIRED&quot;)
+endmacro(_pkgconfig_parse_options)
+
+###
+macro(_pkg_check_modules_internal _is_required _is_silent _prefix)
+  _pkgconfig_unset(${_prefix}_FOUND)
+  _pkgconfig_unset(${_prefix}_VERSION)
+  _pkgconfig_unset(${_prefix}_PREFIX)
+  _pkgconfig_unset(${_prefix}_INCLUDEDIR)
+  _pkgconfig_unset(${_prefix}_LIBDIR)
+  _pkgconfig_unset(${_prefix}_LIBS)
+  _pkgconfig_unset(${_prefix}_LIBS_L)
+  _pkgconfig_unset(${_prefix}_LIBS_PATHS)
+  _pkgconfig_unset(${_prefix}_LIBS_OTHER)
+  _pkgconfig_unset(${_prefix}_CFLAGS)
+  _pkgconfig_unset(${_prefix}_CFLAGS_I)
+  _pkgconfig_unset(${_prefix}_CFLAGS_OTHER)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBDIR)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_L)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_PATHS)
+  _pkgconfig_unset(${_prefix}_STATIC_LIBS_OTHER)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_I)
+  _pkgconfig_unset(${_prefix}_STATIC_CFLAGS_OTHER)
+
+  # create a better addressable variable of the modules and calculate its size
+  set(_pkg_check_modules_list ${ARGN})
+  list(LENGTH _pkg_check_modules_list _pkg_check_modules_cnt)
+
+  if(PKG_CONFIG_EXECUTABLE)
+    # give out status message telling checked module
+    if (NOT ${_is_silent})
+      if (_pkg_check_modules_cnt EQUAL 1)
+        message(STATUS &quot;checking for module '${_pkg_check_modules_list}'&quot;)
+      else(_pkg_check_modules_cnt EQUAL 1)
+        message(STATUS &quot;checking for modules '${_pkg_check_modules_list}'&quot;)
+      endif(_pkg_check_modules_cnt EQUAL 1)
+    endif(NOT ${_is_silent})
+    
+    set(_pkg_check_modules_packages)
+    set(_pkg_check_modules_failed)
+
+    # iterate through module list and check whether they exist and match the required version
+    foreach (_pkg_check_modules_pkg ${_pkg_check_modules_list})
+      set(_pkg_check_modules_exist_query)
+
+      # check whether version is given
+      if (_pkg_check_modules_pkg MATCHES &quot;.*(&gt;=|=|&lt;=).*&quot;)
+        string(REGEX REPLACE &quot;(.*[^&gt;&lt;])(&gt;=|=|&lt;=)(.*)&quot; &quot;\\1&quot; _pkg_check_modules_pkg_name &quot;${_pkg_check_modules_pkg}&quot;)
+        string(REGEX REPLACE &quot;(.*[^&gt;&lt;])(&gt;=|=|&lt;=)(.*)&quot; &quot;\\2&quot; _pkg_check_modules_pkg_op   &quot;${_pkg_check_modules_pkg}&quot;)
+        string(REGEX REPLACE &quot;(.*[^&gt;&lt;])(&gt;=|=|&lt;=)(.*)&quot; &quot;\\3&quot; _pkg_check_modules_pkg_ver  &quot;${_pkg_check_modules_pkg}&quot;)
+      else(_pkg_check_modules_pkg MATCHES &quot;.*(&gt;=|=|&lt;=).*&quot;)
+        set(_pkg_check_modules_pkg_name &quot;${_pkg_check_modules_pkg}&quot;)
+        set(_pkg_check_modules_pkg_op)
+        set(_pkg_check_modules_pkg_ver)
+      endif(_pkg_check_modules_pkg MATCHES &quot;.*(&gt;=|=|&lt;=).*&quot;)
+
+      # handle the operands
+      if (_pkg_check_modules_pkg_op STREQUAL &quot;&gt;=&quot;)
+        list(APPEND _pkg_check_modules_exist_query --atleast-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL &quot;&gt;=&quot;)
+
+      if (_pkg_check_modules_pkg_op STREQUAL &quot;=&quot;)
+        list(APPEND _pkg_check_modules_exist_query --exact-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL &quot;=&quot;)
+      
+      if (_pkg_check_modules_pkg_op STREQUAL &quot;&lt;=&quot;)
+        list(APPEND _pkg_check_modules_exist_query --max-version)
+      endif(_pkg_check_modules_pkg_op STREQUAL &quot;&lt;=&quot;)
+
+      # create the final query which is of the format:
+      # * --atleast-version &lt;version&gt; &lt;pkg-name&gt;
+      # * --exact-version &lt;version&gt; &lt;pkg-name&gt;      
+      # * --max-version &lt;version&gt; &lt;pkg-name&gt;
+      # * --exists &lt;pkg-name&gt;
+      if (_pkg_check_modules_pkg_op)
+        list(APPEND _pkg_check_modules_exist_query &quot;${_pkg_check_modules_pkg_ver}&quot;)
+      else(_pkg_check_modules_pkg_op)
+        list(APPEND _pkg_check_modules_exist_query --exists)
+      endif(_pkg_check_modules_pkg_op)
+
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_VERSION)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_PREFIX)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_INCLUDEDIR)
+      _pkgconfig_unset(${_prefix}_${_pkg_check_modules_pkg_name}_LIBDIR)
+
+      list(APPEND _pkg_check_modules_exist_query &quot;${_pkg_check_modules_pkg_name}&quot;)
+      list(APPEND _pkg_check_modules_packages    &quot;${_pkg_check_modules_pkg_name}&quot;)
+
+      # execute the query
+      execute_process(
+        COMMAND ${PKG_CONFIG_EXECUTABLE} ${_pkg_check_modules_exist_query}
+        RESULT_VARIABLE _pkgconfig_retval)
+
+      # evaluate result and tell failures
+      if (_pkgconfig_retval)
+        if(NOT ${_is_silent})
+          message(STATUS &quot;  package '${_pkg_check_modules_pkg}' not found&quot;)
+        endif(NOT ${_is_silent})
+
+        set(_pkg_check_modules_failed 1)
+      endif(_pkgconfig_retval)
+    endforeach(_pkg_check_modules_pkg)
+
+    if(_pkg_check_modules_failed)
+      # fail when requested
+      if (${_is_required})
+        message(SEND_ERROR &quot;A required package was not found&quot;)
+      endif (${_is_required})
+    else(_pkg_check_modules_failed)
+      # when we are here, we checked whether requested modules
+      # exist. Now, go through them and set variables
+      
+      _pkgconfig_set(${_prefix}_FOUND 1)
+      list(LENGTH _pkg_check_modules_packages pkg_count)
+
+      # iterate through all modules again and set individual variables
+      foreach (_pkg_check_modules_pkg ${_pkg_check_modules_packages})
+        # handle case when there is only one package required
+        if (pkg_count EQUAL 1)
+          set(_pkg_check_prefix &quot;${_prefix}&quot;)
+        else(pkg_count EQUAL 1)
+          set(_pkg_check_prefix &quot;${_prefix}_${_pkg_check_modules_pkg}&quot;)
+        endif(pkg_count EQUAL 1)
+        
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} &quot;${_pkg_check_prefix}&quot; VERSION    &quot;&quot;   --modversion )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} &quot;${_pkg_check_prefix}&quot; PREFIX     &quot;&quot;   --variable=prefix )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} &quot;${_pkg_check_prefix}&quot; INCLUDEDIR &quot;&quot;   --variable=includedir )
+        _pkgconfig_invoke(${_pkg_check_modules_pkg} &quot;${_pkg_check_prefix}&quot; LIBDIR     &quot;&quot;   --variable=libdir )
+
+        message(STATUS &quot;  found ${_pkg_check_modules_pkg}, version ${_pkgconfig_VERSION}&quot;)
+      endforeach(_pkg_check_modules_pkg)
+
+      # set variables which are combined for multiple modules
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; LIBRARIES           &quot;(^| )-l&quot; --libs-only-l )
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; LIBRARY_DIRS        &quot;(^| )-L&quot; --libs-only-L )
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; LDFLAGS             &quot;&quot;        --libs )
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; LDFLAGS_OTHER       &quot;&quot;        --libs-only-other )
+
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; INCLUDE_DIRS        &quot;(^| )-I&quot; --cflags-only-I )
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; CFLAGS              &quot;&quot;        --cflags )
+      _pkgconfig_invoke_dyn(&quot;${_pkg_check_modules_packages}&quot; &quot;${_prefix}&quot; CFLAGS_OTHER        &quot;&quot;        --cflags-only-other )
+    endif(_pkg_check_modules_failed)
+  else(PKG_CONFIG_EXECUTABLE)
+    if (${_is_required})
+      message(SEND_ERROR &quot;pkg-config tool not found&quot;)
+    endif (${_is_required})
+  endif(PKG_CONFIG_EXECUTABLE)
+endmacro(_pkg_check_modules_internal)
+
+###
+### User visible macros start here
+###
+
+###
+macro(pkg_check_modules _prefix _module0)
+  # check cached value
+  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+    _pkgconfig_parse_options   (_pkg_modules _pkg_is_required &quot;${_module0}&quot; ${ARGN})
+    _pkg_check_modules_internal(&quot;${_pkg_is_required}&quot; 0 &quot;${_prefix}&quot; ${_pkg_modules})
+
+    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
+  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+endmacro(pkg_check_modules)
+
+###
+macro(pkg_search_module _prefix _module0)
+  # check cached value
+  if (NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})
+    set(_pkg_modules_found 0)
+    _pkgconfig_parse_options(_pkg_modules_alt _pkg_is_required &quot;${_module0}&quot; ${ARGN})
+
+    message(STATUS &quot;checking for one of the modules '${_pkg_modules_alt}'&quot;)
+
+    # iterate through all modules and stop at the first working one.
+    foreach(_pkg_alt ${_pkg_modules_alt})
+      if(NOT _pkg_modules_found)
+        _pkg_check_modules_internal(0 1 &quot;${_prefix}&quot; &quot;${_pkg_alt}&quot;)
+      endif(NOT _pkg_modules_found)
+
+      if (${_prefix}_FOUND)
+        set(_pkg_modules_found 1)
+      endif(${_prefix}_FOUND)
+    endforeach(_pkg_alt)
+
+    if (NOT ${_prefix}_FOUND)
+      if(${_pkg_is_required})
+        message(SEND_ERROR &quot;None of the required '${_pkg_modules_alt}' found&quot;)
+      endif(${_pkg_is_required})
+    endif(NOT ${_prefix}_FOUND)
+    
+    _pkgconfig_set(__pkg_config_checked_${_prefix} ${PKG_CONFIG_VERSION})
+  endif(NOT DEFINED __pkg_config_checked_${_prefix} OR __pkg_config_checked_${_prefix} LESS ${PKG_CONFIG_VERSION})  
+endmacro(pkg_search_module)
+
+### Local Variables:
+### mode: cmake
+### End:

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindQT4.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,1201 +1,1030 @@
-# - Find QT 4
-# This module can be used to find Qt4.
-# The most important issue is that the Qt4 qmake is available via the system path.
-# This qmake is then used to detect basically everything else.
-# This module defines a number of key variables and macros. First is 
-# QT_USE_FILE which is the path to a CMake file that can be included to compile
-# Qt 4 applications and libraries.  By default, the QtCore and QtGui 
-# libraries are loaded. This behavior can be changed by setting one or more 
-# of the following variables to true:
-#                    QT_DONT_USE_QTCORE
-#                    QT_DONT_USE_QTGUI
-#                    QT_USE_QT3SUPPORT
-#                    QT_USE_QTASSISTANT
-#                    QT_USE_QTDESIGNER
-#                    QT_USE_QTMOTIF
-#                    QT_USE_QTMAIN
-#                    QT_USE_QTNETWORK
-#                    QT_USE_QTNSPLUGIN
-#                    QT_USE_QTOPENGL
-#                    QT_USE_QTSQL
-#                    QT_USE_QTXML
-#                    QT_USE_QTSVG
-#                    QT_USE_QTTEST
-#                    QT_USE_QTUITOOLS
-#                    QT_USE_QTDBUS
-#
-# All the libraries required are stored in a variable called QT_LIBRARIES.  
-# Add this variable to your TARGET_LINK_LIBRARIES.
-#  
-#  macro QT4_WRAP_CPP(outfiles inputfile ... )
-#  macro QT4_WRAP_UI(outfiles inputfile ... )
-#  macro QT4_ADD_RESOURCE(outfiles inputfile ... )
-#  macro QT4_AUTOMOC(inputfile ... )
-#  macro QT4_GENERATE_MOC(inputfile outputfile )
-#
-#  macro QT4_ADD_DBUS_INTERFACE(outfiles interface basename)
-#        create a the interface header and implementation files with the 
-#        given basename from the given interface xml file and add it to 
-#        the list of sources
-#
-#  macro QT4_ADD_DBUS_INTERFACES(outfiles inputfile ... )
-#        create the interface header and implementation files 
-#        for all listed interface xml files
-#        the name will be automatically determined from the name of the xml file
-#
-#  macro QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE(outfiles interface basename)
-#        create a the interface without namespace header and implementation files with the
-#        given basename from the given interface xml file and add it to
-#        the list of sources
-#
-#  macro QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE(outfiles inputfile ... )
-#        create the interface header without namespace and implementation files
-#        for all listed interface xml files
-#        the name will be automatically determined from the name of the xml file
-#
-#  macro QT4_ADD_DBUS_ADAPTOR(outfiles xmlfile parentheader parentclassname [basename] )
-#        create a dbus adaptor (header and implementation file) from the xml file
-#        describing the interface, and add it to the list of sources. The adaptor
-#        forwards the calls to a parent class, defined in parentheader and named
-#        parentclassname. The name of the generated files will be
-#        &lt;basename&gt;adaptor.{cpp,h} where basename is the basename of the xml file.
-#
-#  macro QT4_GENERATE_DBUS_INTERFACE( header [interfacename] )
-#        generate the xml interface file from the given header.
-#        If the optional argument interfacename is omitted, the name of the 
-#        interface file is constructed from the basename of the header with
-#        the suffix .xml appended.
-#
-#  QT_FOUND         If false, don't try to use Qt.
-#  QT4_FOUND        If false, don't try to use Qt 4.
-#
-#  QT_QTCORE_FOUND        True if QtCore was found.
-#  QT_QTGUI_FOUND         True if QtGui was found.
-#  QT_QT3SUPPORT_FOUND    True if Qt3Support was found.
-#  QT_QTASSISTANT_FOUND   True if QtAssistant was found.
-#  QT_QTDBUS_FOUND        True if QtDBus was found.
-#  QT_QTDESIGNER_FOUND    True if QtDesigner was found.
-#  QT_QTDESIGNERCOMPONENTS True if QtDesignerComponents was found.
-#  QT_QTMOTIF_FOUND       True if QtMotif was found.
-#  QT_QTNETWORK_FOUND     True if QtNetwork was found.
-#  QT_QTNSPLUGIN_FOUND    True if QtNsPlugin was found.
-#  QT_QTOPENGL_FOUND      True if QtOpenGL was found.
-#  QT_QTSQL_FOUND         True if QtSql was found.
-#  QT_QTXML_FOUND         True if QtXml was found.
-#  QT_QTSVG_FOUND         True if QtSvg was found.
-#  QT_QTSCRIPT_FOUND      True if QtScript was found.
-#  QT_QTTEST_FOUND        True if QtTest was found.
-#  QT_QTUITOOLS_FOUND     True if QtUiTools was found.
-#                      
-#  QT_DEFINITIONS   Definitions to use when compiling code that uses Qt.
-#                  
-#  QT_INCLUDES      List of paths to all include directories of 
-#                   Qt4 QT_INCLUDE_DIR and QT_QTCORE_INCLUDE_DIR are
-#                   always in this variable even if NOTFOUND,
-#                   all other INCLUDE_DIRS are
-#                   only added if they are found.
-#   
-#  QT_INCLUDE_DIR              Path to &quot;include&quot; of Qt4
-#  QT_QT_INCLUDE_DIR           Path to &quot;include/Qt&quot; 
-#  QT_QT3SUPPORT_INCLUDE_DIR   Path to &quot;include/Qt3Support&quot; 
-#  QT_QTASSISTANT_INCLUDE_DIR  Path to &quot;include/QtAssistant&quot; 
-#  QT_QTCORE_INCLUDE_DIR       Path to &quot;include/QtCore&quot;         
-#  QT_QTDESIGNER_INCLUDE_DIR   Path to &quot;include/QtDesigner&quot; 
-#  QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR   Path to &quot;include/QtDesigner&quot;
-#  QT_QTDBUS_INCLUDE_DIR       Path to &quot;include/QtDBus&quot; 
-#  QT_QTGUI_INCLUDE_DIR        Path to &quot;include/QtGui&quot; 
-#  QT_QTMOTIF_INCLUDE_DIR      Path to &quot;include/QtMotif&quot; 
-#  QT_QTNETWORK_INCLUDE_DIR    Path to &quot;include/QtNetwork&quot; 
-#  QT_QTNSPLUGIN_INCLUDE_DIR   Path to &quot;include/QtNsPlugin&quot; 
-#  QT_QTOPENGL_INCLUDE_DIR     Path to &quot;include/QtOpenGL&quot; 
-#  QT_QTSQL_INCLUDE_DIR        Path to &quot;include/QtSql&quot; 
-#  QT_QTXML_INCLUDE_DIR        Path to &quot;include/QtXml&quot; 
-#  QT_QTSVG_INCLUDE_DIR        Path to &quot;include/QtSvg&quot;
-#  QT_QTSCRIPT_INCLUDE_DIR     Path to &quot;include/QtScript&quot;
-#  QT_QTTEST_INCLUDE_DIR       Path to &quot;include/QtTest&quot;
-#                            
-#  QT_LIBRARY_DIR              Path to &quot;lib&quot; of Qt4
-# 
-#  QT_PLUGINS_DIR              Path to &quot;plugins&quot; for Qt4
-#                            
-# For every library of Qt, a QT_QTFOO_LIBRARY variable is defined, with the full path to the library.
-#
-# So there are the following variables:
-# The Qt3Support library:     QT_QT3SUPPORT_LIBRARY
-#
-# The QtAssistant library:    QT_QTASSISTANT_LIBRARY
-#
-# The QtCore library:         QT_QTCORE_LIBRARY
-#
-# The QtDBus library:         QT_QTDBUS_LIBRARY
-#
-# The QtDesigner library:     QT_QTDESIGNER_LIBRARY
-#
-# The QtDesignerComponents library:     QT_QTDESIGNERCOMPONENTS_LIBRARY
-#
-# The QtGui library:          QT_QTGUI_LIBRARY
-#
-# The QtMotif library:        QT_QTMOTIF_LIBRARY
-#
-# The QtNetwork library:      QT_QTNETWORK_LIBRARY
-#
-# The QtNsPLugin library:     QT_QTNSPLUGIN_LIBRARY
-#
-# The QtOpenGL library:       QT_QTOPENGL_LIBRARY
-#
-# The QtSql library:          QT_QTSQL_LIBRARY
-#
-# The QtXml library:          QT_QTXML_LIBRARY
-#
-# The QtSvg library:          QT_QTSVG_LIBRARY
-#
-# The QtScript library:       QT_QTSCRIPT_LIBRARY
-#
-# The QtTest library:         QT_QTTEST_LIBRARY
-#
-# The qtmain library for Windows QT_QTMAIN_LIBRARY
-#
-# The QtUiTools library:      QT_QTUITOOLS_LIBRARY
-#  
-# also defined, but NOT for general use are
-#  QT_MOC_EXECUTABLE          Where to find the moc tool.
-#  QT_UIC_EXECUTABLE          Where to find the uic tool.
-#  QT_UIC3_EXECUTABLE         Where to find the uic3 tool.
-#  QT_RCC_EXECUTABLE          Where to find the rcc tool
-#  QT_DBUSCPP2XML_EXECUTABLE  Where to find the qdbuscpp2xml tool.
-#  QT_DBUSXML2CPP_EXECUTABLE  Where to find the qdbusxml2cpp tool.
-#  
-#  QT_DOC_DIR                 Path to &quot;doc&quot; of Qt4
-#  QT_MKSPECS_DIR             Path to &quot;mkspecs&quot; of Qt4
-#
-#
-# These are around for backwards compatibility 
-# they will be set
-#  QT_WRAP_CPP  Set true if QT_MOC_EXECUTABLE is found
-#  QT_WRAP_UI   Set true if QT_UIC_EXECUTABLE is found
-#  
-# These variables do _NOT_ have any effect anymore (compared to FindQt.cmake)
-#  QT_MT_REQUIRED         Qt4 is now always multithreaded
-#  
-# These variables are set to &quot;&quot; Because Qt structure changed 
-# (They make no sense in Qt4)
-#  QT_QT_LIBRARY        Qt-Library is now split
-
-# Copyright (c) 2002 Kitware, Inc., Insight Consortium.  All rights reserved.
-# See Copyright.txt or <A HREF="http://www.cmake.org/HTML/Copyright.html">http://www.cmake.org/HTML/Copyright.html</A> for details.
-
-
-INCLUDE(CheckSymbolExists)
-INCLUDE(MacroAddFileDependencies)
-
-SET(QT_USE_FILE ${CMAKE_ROOT}/Modules/UseQt4.cmake)
-
-SET( QT_DEFINITIONS &quot;&quot;)
-
-IF (WIN32)
-  SET(QT_DEFINITIONS -DQT_DLL)
-ENDIF(WIN32)
-
-SET(QT4_INSTALLED_VERSION_TOO_OLD FALSE)
-
-#  macro for asking qmake to process pro files
-MACRO(QT_QUERY_QMAKE outvar invar)
-  FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake/tmp.pro
-    &quot;message(CMAKE_MESSAGE&lt;$$${invar}&gt;)&quot;)
-
-  EXECUTE_PROCESS(COMMAND ${QT_QMAKE_EXECUTABLE}
-    WORKING_DIRECTORY  
-    ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake
-    OUTPUT_VARIABLE _qmake_query_output
-    ERROR_VARIABLE _qmake_query_output )
-
-  FILE(REMOVE_RECURSE 
-    &quot;${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake&quot;)
-
-  STRING(REGEX REPLACE &quot;.*CMAKE_MESSAGE&lt;([^&gt;]*).*&quot; &quot;\\1&quot; ${outvar} &quot;${_qmake_query_output}&quot;)
-ENDMACRO(QT_QUERY_QMAKE)
-
-# check for qmake
-FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake4 qmake-qt4 PATHS
-  &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin&quot;
-  &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin&quot;
-  $ENV{QTDIR}/bin
-)
-
-IF (QT_QMAKE_EXECUTABLE)
-
-  SET(QT4_QMAKE_FOUND FALSE)
-  
-  EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} ARGS &quot;-query QT_VERSION&quot; OUTPUT_VARIABLE QTVERSION)
-
-  # check for qt3 qmake and then try and find qmake4 or qmake-qt4 in the path
-  IF(&quot;${QTVERSION}&quot; MATCHES &quot;Unknown&quot;)
-    SET(QT_QMAKE_EXECUTABLE NOTFOUND CACHE FILEPATH &quot;&quot; FORCE)
-    FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake4 qmake-qt4 PATHS
-      &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin&quot;
-      &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin&quot;
-      $ENV{QTDIR}/bin
-      )
-    IF(QT_QMAKE_EXECUTABLE)
-      EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} 
-        ARGS &quot;-query QT_VERSION&quot; OUTPUT_VARIABLE QTVERSION)
-    ENDIF(QT_QMAKE_EXECUTABLE)
-  ENDIF(&quot;${QTVERSION}&quot; MATCHES &quot;Unknown&quot;)
-
-  # check that we found the Qt4 qmake, Qt3 qmake output won't match here
-  STRING(REGEX MATCH &quot;^[0-9]+\\.[0-9]+\\.[0-9]+&quot; qt_version_tmp &quot;${QTVERSION}&quot;)
-  IF (qt_version_tmp)
-
-    # we need at least version 4.0.0
-    IF (NOT QT_MIN_VERSION)
-      SET(QT_MIN_VERSION &quot;4.0.0&quot;)
-    ENDIF (NOT QT_MIN_VERSION)
-
-    #now parse the parts of the user given version string into variables
-    STRING(REGEX MATCH &quot;^[0-9]+\\.[0-9]+\\.[0-9]+&quot; req_qt_major_vers &quot;${QT_MIN_VERSION}&quot;)
-    IF (NOT req_qt_major_vers)
-      MESSAGE( FATAL_ERROR &quot;Invalid Qt version string given: \&quot;${QT_MIN_VERSION}\&quot;, expected e.g. \&quot;4.0.1\&quot;&quot;)
-    ENDIF (NOT req_qt_major_vers)
-
-    # now parse the parts of the user given version string into variables
-    STRING(REGEX REPLACE &quot;^([0-9]+)\\.[0-9]+\\.[0-9]+&quot; &quot;\\1&quot; req_qt_major_vers &quot;${QT_MIN_VERSION}&quot;)
-    STRING(REGEX REPLACE &quot;^[0-9]+\\.([0-9])+\\.[0-9]+&quot; &quot;\\1&quot; req_qt_minor_vers &quot;${QT_MIN_VERSION}&quot;)
-    STRING(REGEX REPLACE &quot;^[0-9]+\\.[0-9]+\\.([0-9]+)&quot; &quot;\\1&quot; req_qt_patch_vers &quot;${QT_MIN_VERSION}&quot;)
-
-    IF (NOT req_qt_major_vers EQUAL 4)
-      MESSAGE( FATAL_ERROR &quot;Invalid Qt version string given: \&quot;${QT_MIN_VERSION}\&quot;, major version 4 is required, e.g. \&quot;4.0.1\&quot;&quot;)
-    ENDIF (NOT req_qt_major_vers EQUAL 4)
-
-    # and now the version string given by qmake
-    STRING(REGEX REPLACE &quot;^([0-9]+)\\.[0-9]+\\.[0-9]+.*&quot; &quot;\\1&quot; found_qt_major_vers &quot;${QTVERSION}&quot;)
-    STRING(REGEX REPLACE &quot;^[0-9]+\\.([0-9])+\\.[0-9]+.*&quot; &quot;\\1&quot; found_qt_minor_vers &quot;${QTVERSION}&quot;)
-    STRING(REGEX REPLACE &quot;^[0-9]+\\.[0-9]+\\.([0-9]+).*&quot; &quot;\\1&quot; found_qt_patch_vers &quot;${QTVERSION}&quot;)
-
-    # compute an overall version number which can be compared at once
-    MATH(EXPR req_vers &quot;${req_qt_major_vers}*10000 + ${req_qt_minor_vers}*100 + ${req_qt_patch_vers}&quot;)
-    MATH(EXPR found_vers &quot;${found_qt_major_vers}*10000 + ${found_qt_minor_vers}*100 + ${found_qt_patch_vers}&quot;)
-
-    IF (found_vers LESS req_vers)
-      SET(QT4_QMAKE_FOUND FALSE)
-      SET(QT4_INSTALLED_VERSION_TOO_OLD TRUE)
-    ELSE (found_vers LESS req_vers)
-      SET(QT4_QMAKE_FOUND TRUE)
-    ENDIF (found_vers LESS req_vers)
-  ENDIF (qt_version_tmp)
-
-ENDIF (QT_QMAKE_EXECUTABLE)
-
-IF (QT4_QMAKE_FOUND)
-
-  # ask qmake for the library dir
-  # Set QT_LIBRARY_DIR
-  IF (NOT QT_LIBRARY_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS &quot;-query QT_INSTALL_LIBS&quot;
-      OUTPUT_VARIABLE QT_LIBRARY_DIR_TMP )
-    IF(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
-      SET(QT_LIBRARY_DIR ${QT_LIBRARY_DIR_TMP} CACHE PATH &quot;Qt library dir&quot;)
-    ELSE(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
-      MESSAGE(&quot;Warning: QT_QMAKE_EXECUTABLE reported QT_INSTALL_LIBS as ${QT_LIBRARY_DIR_TMP}&quot;)
-      MESSAGE(&quot;Warning: ${QT_LIBRARY_DIR_TMP} does NOT exist, Qt must NOT be installed correctly.&quot;)
-    ENDIF(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
-  ENDIF(NOT QT_LIBRARY_DIR)
-  
-  IF (APPLE)
-    IF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS ON
-        CACHE BOOL &quot;Set to ON if Qt build uses frameworks.&quot;)
-    ELSE (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_USE_FRAMEWORKS OFF
-        CACHE BOOL &quot;Set to ON if Qt build uses frameworks.&quot;)
-    ENDIF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-    
-    MARK_AS_ADVANCED(QT_USE_FRAMEWORKS)
-  ENDIF (APPLE)
-  
-  # ask qmake for the binary dir
-  IF (NOT QT_BINARY_DIR)
-     EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE}
-        ARGS &quot;-query QT_INSTALL_BINS&quot;
-        OUTPUT_VARIABLE qt_bins )
-     SET(QT_BINARY_DIR ${qt_bins} CACHE INTERNAL &quot;&quot;)
-  ENDIF (NOT QT_BINARY_DIR)
-
-  # ask qmake for the include dir
-  IF (NOT QT_HEADERS_DIR)
-      EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-        ARGS &quot;-query QT_INSTALL_HEADERS&quot; 
-        OUTPUT_VARIABLE qt_headers )
-      SET(QT_HEADERS_DIR ${qt_headers} CACHE INTERNAL &quot;&quot;)
-  ENDIF(NOT QT_HEADERS_DIR)
-
-
-  # ask qmake for the documentation directory
-  IF (NOT QT_DOC_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS &quot;-query QT_INSTALL_DOCS&quot;
-      OUTPUT_VARIABLE qt_doc_dir )
-    SET(QT_DOC_DIR ${qt_doc_dir} CACHE PATH &quot;The location of the Qt docs&quot;)
-  ENDIF (NOT QT_DOC_DIR)
-
-  # ask qmake for the mkspecs directory
-  IF (NOT QT_MKSPECS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS &quot;-query QMAKE_MKSPECS&quot;
-      OUTPUT_VARIABLE qt_mkspecs_dir )
-    SET(QT_MKSPECS_DIR ${qt_mkspecs_dir} CACHE PATH &quot;The location of the Qt mkspecs&quot;)
-  ENDIF (NOT QT_MKSPECS_DIR)
-
-  # ask qmake for the plugins directory
-  IF (NOT QT_PLUGINS_DIR)
-    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
-      ARGS &quot;-query QT_INSTALL_PLUGINS&quot;
-      OUTPUT_VARIABLE qt_plugins_dir )
-    SET(QT_PLUGINS_DIR ${qt_plugins_dir} CACHE PATH &quot;The location of the Qt plugins&quot;)
-  ENDIF (NOT QT_PLUGINS_DIR)
-  ########################################
-  #
-  #       Setting the INCLUDE-Variables
-  #
-  ########################################
-
-  FIND_PATH(QT_QTCORE_INCLUDE_DIR QtGlobal
-    ${QT_HEADERS_DIR}/QtCore
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_INCLUDE_DIR by removine &quot;/QtCore&quot; in the string ${QT_QTCORE_INCLUDE_DIR}
-  IF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-    IF (QT_USE_FRAMEWORKS)
-      SET(QT_INCLUDE_DIR ${QT_HEADERS_DIR})
-    ELSE (QT_USE_FRAMEWORKS)
-      STRING( REGEX REPLACE &quot;/QtCore$&quot; &quot;&quot; qt4_include_dir ${QT_QTCORE_INCLUDE_DIR})
-      SET( QT_INCLUDE_DIR ${qt4_include_dir} CACHE PATH &quot;&quot;)
-    ENDIF (QT_USE_FRAMEWORKS)
-  ENDIF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
-
-  IF( NOT QT_INCLUDE_DIR)
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR &quot;Could NOT find QtGlobal header&quot;)
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_INCLUDE_DIR)
-
-  #############################################
-  #
-  # Find out what window system we're using
-  #
-  #############################################
-  # Save required includes variable
-  SET(CMAKE_REQUIRED_INCLUDES_SAVE ${CMAKE_REQUIRED_INCLUDES})
-  # Add QT_INCLUDE_DIR to CMAKE_REQUIRED_INCLUDES
-  SET(CMAKE_REQUIRED_INCLUDES &quot;${CMAKE_REQUIRED_INCLUDES};${QT_INCLUDE_DIR}&quot;)
-  # Check for Window system symbols (note: only one should end up being set)
-  CHECK_SYMBOL_EXISTS(Q_WS_X11 &quot;QtCore/qglobal.h&quot; Q_WS_X11)
-  CHECK_SYMBOL_EXISTS(Q_WS_MAC &quot;QtCore/qglobal.h&quot; Q_WS_MAC)
-  CHECK_SYMBOL_EXISTS(Q_WS_WIN &quot;QtCore/qglobal.h&quot; Q_WS_WIN)
-
-  IF (QT_QTCOPY_REQUIRED)
-     CHECK_SYMBOL_EXISTS(QT_IS_QTCOPY &quot;QtCore/qglobal.h&quot; QT_KDE_QT_COPY)
-     IF (NOT QT_IS_QTCOPY)
-        MESSAGE(FATAL_ERROR &quot;qt-copy is required, but hasn't been found&quot;)
-     ENDIF (NOT QT_IS_QTCOPY)
-  ENDIF (QT_QTCOPY_REQUIRED)
-
-  # Restore CMAKE_REQUIRED_INCLUDES variable
-  SET(CMAKE_REQUIRED_INCLUDES ${CMAKE_REQUIRED_INCLUDES_SAVE})
-  #
-  #############################################
-
-  IF (QT_USE_FRAMEWORKS)
-    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -F${QT_LIBRARY_DIR} -L${QT_LIBRARY_DIR} )
-  ENDIF (QT_USE_FRAMEWORKS)
-
-  # Set QT_QT3SUPPORT_INCLUDE_DIR
-  FIND_PATH(QT_QT3SUPPORT_INCLUDE_DIR Qt3Support
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt3Support
-    ${QT_LIBRARY_DIR}/Qt3Support.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QT_INCLUDE_DIR
-  FIND_PATH(QT_QT_INCLUDE_DIR qglobal.h
-    PATHS
-    ${QT_INCLUDE_DIR}/Qt
-    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTGUI_INCLUDE_DIR
-  FIND_PATH(QT_QTGUI_INCLUDE_DIR QtGui
-    PATHS
-    ${QT_INCLUDE_DIR}/QtGui
-    ${QT_LIBRARY_DIR}/QtGui.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSVG_INCLUDE_DIR
-  FIND_PATH(QT_QTSVG_INCLUDE_DIR QtSvg
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSvg
-    ${QT_LIBRARY_DIR}/QtSvg.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSVG_INCLUDE_DIR
-  FIND_PATH(QT_QTSCRIPT_INCLUDE_DIR QtScript
-    PATHS
-    ${QT_INCLUDE_DIR}/QtScript
-    ${QT_LIBRARY_DIR}/QtScript.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTTEST_INCLUDE_DIR
-  FIND_PATH(QT_QTTEST_INCLUDE_DIR QtTest
-    PATHS
-    ${QT_INCLUDE_DIR}/QtTest
-    ${QT_LIBRARY_DIR}/QtTest.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTUITOOLS_INCLUDE_DIR
-  FIND_PATH(QT_QTUITOOLS_INCLUDE_DIR QtUiTools
-    PATHS
-    ${QT_INCLUDE_DIR}/QtUiTools
-    ${QT_LIBRARY_DIR}/QtUiTools.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-
-
-  # Set QT_QTMOTIF_INCLUDE_DIR
-  IF(Q_WS_X11)
-    FIND_PATH(QT_QTMOTIF_INCLUDE_DIR QtMotif PATHS ${QT_INCLUDE_DIR}/QtMotif NO_DEFAULT_PATH )
-  ENDIF(Q_WS_X11)
-
-  # Set QT_QTNETWORK_INCLUDE_DIR
-  FIND_PATH(QT_QTNETWORK_INCLUDE_DIR QtNetwork
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNetwork
-    ${QT_LIBRARY_DIR}/QtNetwork.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTNSPLUGIN_INCLUDE_DIR
-  FIND_PATH(QT_QTNSPLUGIN_INCLUDE_DIR QtNsPlugin
-    PATHS
-    ${QT_INCLUDE_DIR}/QtNsPlugin
-    ${QT_LIBRARY_DIR}/QtNsPlugin.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTOPENGL_INCLUDE_DIR
-  FIND_PATH(QT_QTOPENGL_INCLUDE_DIR QtOpenGL
-    PATHS
-    ${QT_INCLUDE_DIR}/QtOpenGL
-    ${QT_LIBRARY_DIR}/QtOpenGL.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTSQL_INCLUDE_DIR
-  FIND_PATH(QT_QTSQL_INCLUDE_DIR QtSql
-    PATHS
-    ${QT_INCLUDE_DIR}/QtSql
-    ${QT_LIBRARY_DIR}/QtSql.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTXML_INCLUDE_DIR
-  FIND_PATH(QT_QTXML_INCLUDE_DIR QtXml
-    PATHS
-    ${QT_INCLUDE_DIR}/QtXml
-    ${QT_LIBRARY_DIR}/QtXml.framework/Headers
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTASSISTANT_INCLUDE_DIR
-  FIND_PATH(QT_QTASSISTANT_INCLUDE_DIR QtAssistant
-    PATHS
-    ${QT_INCLUDE_DIR}/QtAssistant
-    ${QT_HEADERS_DIR}/QtAssistant
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTDESIGNER_INCLUDE_DIR
-  FIND_PATH(QT_QTDESIGNER_INCLUDE_DIR QDesignerComponents
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDesigner
-    ${QT_HEADERS_DIR}/QtDesigner
-    NO_DEFAULT_PATH
-    )
-
-  # Set QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR
-  FIND_PATH(QT_QTDESIGNERCOMPONENTS_INCLUDE_DIR QDesignerComponents
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDesigner
-    ${QT_HEADERS_DIR}/QtDesigner
-    NO_DEFAULT_PATH
-    )
-
-
-  # Set QT_QTDBUS_INCLUDE_DIR
-  FIND_PATH(QT_QTDBUS_INCLUDE_DIR QtDBus
-    PATHS
-    ${QT_INCLUDE_DIR}/QtDBus
-    ${QT_HEADERS_DIR}/QtDBus
-    NO_DEFAULT_PATH
-    )
-
-  # Make variables changeble to the advanced user
-  MARK_AS_ADVANCED( QT_LIBRARY_DIR QT_INCLUDE_DIR QT_QT_INCLUDE_DIR QT_DOC_DIR QT_MKSPECS_DIR QT_PLUGINS_DIR)
-
-  # Set QT_INCLUDES
-  SET( QT_INCLUDES ${QT_INCLUDE_DIR} ${QT_QT_INCLUDE_DIR} ${QT_MKSPECS_DIR}/default )
-
-
-  ########################################
-  #
-  #       Setting the LIBRARY-Variables
-  #
-  ########################################
-
-  IF (QT_USE_FRAMEWORKS)
-    # If FIND_LIBRARY found libraries in Apple frameworks, we would NOT have
-    # to jump through these hoops.
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_QTCORE_FOUND TRUE)
-      SET(QT_QTCORE_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtCore&quot; CACHE STRING &quot;The QtCore library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-      SET(QT_QTCORE_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-      SET(QT_QTGUI_FOUND TRUE)
-      SET(QT_QTGUI_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtGui&quot; CACHE STRING &quot;The QtGui library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-      SET(QT_QTGUI_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtGui.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-      SET(QT_QT3SUPPORT_FOUND TRUE)
-      SET(QT_QT3SUPPORT_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework Qt3Support&quot; CACHE STRING &quot;The Qt3Support library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-      SET(QT_QT3SUPPORT_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/Qt3Support.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-      SET(QT_QTNETWORK_FOUND TRUE)
-      SET(QT_QTNETWORK_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtNetwork&quot; CACHE STRING &quot;The QtNetwork library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-      SET(QT_QTNETWORK_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtNetwork.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-      SET(QT_QTOPENGL_FOUND TRUE)
-      SET(QT_QTOPENGL_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtOpenGL&quot; CACHE STRING &quot;The QtOpenGL library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-      SET(QT_QTOPENGL_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtOpenGL.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-      SET(QT_QTSQL_FOUND TRUE)
-      SET(QT_QTSQL_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtSql&quot; CACHE STRING &quot;The QtSql library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-      SET(QT_QTSQL_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtSql.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-      SET(QT_QTXML_FOUND TRUE)
-      SET(QT_QTXML_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtXml&quot; CACHE STRING &quot;The QtXml library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-      SET(QT_QTXML_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtXml.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-      SET(QT_QTSVG_FOUND TRUE)
-      SET(QT_QTSVG_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtSvg&quot; CACHE STRING &quot;The QtSvg library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-      SET(QT_QTSVG_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtSvg.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-      SET(QT_QTDBUS_FOUND TRUE)
-      SET(QT_QTDBUS_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtDBus&quot; CACHE STRING &quot;The QtDBus library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-      SET(QT_QTDBUS_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtDBus.framework)
-
-    IF(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-      SET(QT_QTTEST_FOUND TRUE)
-      SET(QT_QTTEST_LIBRARY &quot;-F${QT_LIBRARY_DIR} -framework QtTest&quot; CACHE STRING &quot;The QtTest library.&quot;)
-    ELSE(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-      SET(QT_QTTEST_FOUND FALSE)
-    ENDIF(EXISTS ${QT_LIBRARY_DIR}/QtTest.framework)
-
-    # WTF?  why don't we have frameworks?  :P
-    # Set QT_QTUITOOLS_LIBRARY
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR} )
-    # Set QT_QTSCRIPT_LIBRARY
-    FIND_LIBRARY(QT_QTSCRIPT_LIBRARY NAMES QtScript QtScript4    PATHS ${QT_LIBRARY_DIR} )
-
-  ELSE (QT_USE_FRAMEWORKS)
-    
-    # Set QT_QTCORE_LIBRARY by searching for a lib with &quot;QtCore.&quot;  as part of the filename
-    FIND_LIBRARY(QT_QTCORE_LIBRARY NAMES QtCore QtCore4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH )
-
-    # Set QT_QT3SUPPORT_LIBRARY
-    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY NAMES Qt3Support Qt3Support4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTGUI_LIBRARY
-    FIND_LIBRARY(QT_QTGUI_LIBRARY NAMES QtGui QtGui4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTMOTIF_LIBRARY
-    IF(Q_WS_X11)
-      FIND_LIBRARY(QT_QTMOTIF_LIBRARY NAMES QtMotif              PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-    ENDIF(Q_WS_X11)
-
-    # Set QT_QTNETWORK_LIBRARY
-    FIND_LIBRARY(QT_QTNETWORK_LIBRARY NAMES QtNetwork QtNetwork4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTNSPLUGIN_LIBRARY
-    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY NAMES QtNsPlugin          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTOPENGL_LIBRARY
-    FIND_LIBRARY(QT_QTOPENGL_LIBRARY NAMES QtOpenGL QtOpenGL4    PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSQL_LIBRARY
-    FIND_LIBRARY(QT_QTSQL_LIBRARY NAMES QtSql QtSql4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTXML_LIBRARY
-    FIND_LIBRARY(QT_QTXML_LIBRARY NAMES QtXml QtXml4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSVG_LIBRARY
-    FIND_LIBRARY(QT_QTSVG_LIBRARY NAMES QtSvg QtSvg4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTSCRIPT_LIBRARY
-    FIND_LIBRARY(QT_QTSCRIPT_LIBRARY NAMES QtScript QtScript4    PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTUITOOLS_LIBRARY
-    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    # Set QT_QTTEST_LIBRARY
-    FIND_LIBRARY(QT_QTTEST_LIBRARY NAMES QtTest QtTest4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    FIND_LIBRARY(QT_QTDBUS_LIBRARY NAMES QtDBus QtDBus4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-    IF(MSVC)
-      FIND_LIBRARY(QT_QTCORE_LIBRARY_DEBUG      NAMES QtCored4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_DEBUG  NAMES Qt3Supportd4        PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTGUI_LIBRARY_DEBUG       NAMES QtGuid4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTNETWORK_LIBRARY_DEBUG   NAMES QtNetworkd4         PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTOPENGL_LIBRARY_DEBUG    NAMES QtOpenGLd4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSQL_LIBRARY_DEBUG       NAMES QtSqld4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTXML_LIBRARY_DEBUG       NAMES QtXmld4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSVG_LIBRARY_DEBUG       NAMES QtSvgd4             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTSCRIPT_LIBRARY_DEBUG    NAMES QtScriptd4          PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_DEBUG   NAMES QtUiToolsd QtUiToolsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTTEST_LIBRARY_DEBUG      NAMES QtTestd4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDBUS_LIBRARY_DEBUG      NAMES QtDBusd4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_DEBUG NAMES QtAssistantClientd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_DEBUG           NAMES QtDesigner4            PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTDESIGNERCOMPONENTS_LIBRARY_DEBUG NAMES QtDesignerComponentsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-      FIND_LIBRARY(QT_QTMAIN_LIBRARY_DEBUG      NAMES qtmaind             PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-    ENDIF(MSVC)
-
-  ENDIF (QT_USE_FRAMEWORKS)
-
-  IF( NOT QT_QTCORE_LIBRARY )
-    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-      MESSAGE( FATAL_ERROR &quot;Could NOT find QtCore. Check CMakeFiles/CMakeError.log for more details.&quot;)
-    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
-  ENDIF( NOT QT_QTCORE_LIBRARY )
-
-  # Set QT_QTASSISTANT_LIBRARY
-  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY NAMES QtAssistantClient QtAssistantClient4 QtAssistant QtAssistant4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-
-  # Set QT_QTDESIGNER_LIBRARY
-  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY NAMES QtDesigner QtDesigner4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-
-  # Set QT_QTDESIGNERCOMPONENTS_LIBRARY
-  FIND_LIBRARY(QT_QTDESIGNERCOMPONENTS_LIBRARY NAMES QtDesignerComponents QtDesignerComponents4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
-
-  # Set QT_QTMAIN_LIBRARY
-  IF(WIN32)
-    FIND_LIBRARY(QT_QTMAIN_LIBRARY NAMES qtmain PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
-  ENDIF(WIN32)
-
-  ############################################
-  #
-  # Check the existence of the libraries.
-  #
-  ############################################
-
-  MACRO (_QT4_ADJUST_LIB_VARS basename)
-    IF (QT_${basename}_LIBRARY OR QT_${basename}_LIBRARY_DEBUG)
-
-      IF(MSVC)
-
-        # Both set
-        IF (QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-          SET(QT_${basename}_LIBRARY optimized ${QT_${basename}_LIBRARY} debug ${QT_${basename}_LIBRARY_DEBUG})
-        ENDIF (QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-
-        # Only debug was found
-        IF (NOT QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-          SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY_DEBUG})
-        ENDIF (NOT QT_${basename}_LIBRARY AND QT_${basename}_LIBRARY_DEBUG)
-
-        # Hmm, is this used anywhere ? Yes, in UseQt4.cmake. We are currently incompatible :-(
-        SET(QT_${basename}_LIBRARIES optimized ${QT_${basename}_LIBRARY} debug ${QT_${basename}_LIBRARY_DEBUG})
-
-      ENDIF(MSVC)
-
-      SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY} CACHE FILEPATH &quot;The Qt ${basename} library&quot;)
-
-      IF (QT_${basename}_LIBRARY)
-        SET(QT_${basename}_FOUND 1)
-      ENDIF (QT_${basename}_LIBRARY)
-      
-    ENDIF (QT_${basename}_LIBRARY OR QT_${basename}_LIBRARY_DEBUG)
-    
-    IF (QT_${basename}_INCLUDE_DIR)
-      #add the include directory to QT_INCLUDES
-      SET(QT_INCLUDES ${QT_INCLUDES} &quot;${QT_${basename}_INCLUDE_DIR}&quot;)
-    ENDIF (QT_${basename}_INCLUDE_DIR)
-
-    # Make variables changeble to the advanced user
-    MARK_AS_ADVANCED(QT_${basename}_LIBRARY QT_${basename}_INCLUDE_DIR)
-  ENDMACRO (_QT4_ADJUST_LIB_VARS)
-
-
-  # Set QT_xyz_LIBRARY variable and add 
-  # library include path to QT_INCLUDES
-  _QT4_ADJUST_LIB_VARS(QTCORE)
-  _QT4_ADJUST_LIB_VARS(QTGUI)
-  _QT4_ADJUST_LIB_VARS(QT3SUPPORT)
-  _QT4_ADJUST_LIB_VARS(QTASSISTANT)
-  _QT4_ADJUST_LIB_VARS(QTDESIGNER)
-  _QT4_ADJUST_LIB_VARS(QTDESIGNERCOMPONENTS)
-  _QT4_ADJUST_LIB_VARS(QTNETWORK)
-  _QT4_ADJUST_LIB_VARS(QTNSPLUGIN)
-  _QT4_ADJUST_LIB_VARS(QTOPENGL)
-  _QT4_ADJUST_LIB_VARS(QTSQL)
-  _QT4_ADJUST_LIB_VARS(QTXML)
-  _QT4_ADJUST_LIB_VARS(QTSVG)
-  _QT4_ADJUST_LIB_VARS(QTSCRIPT)
-  _QT4_ADJUST_LIB_VARS(QTUITOOLS)
-  _QT4_ADJUST_LIB_VARS(QTTEST)
-  _QT4_ADJUST_LIB_VARS(QTDBUS)
-  
-  
-  # platform dependent libraries
-  IF(Q_WS_X11)
-    _QT4_ADJUST_LIB_VARS(QTMOTIF)
-  ENDIF(Q_WS_X11)
-  IF(WIN32)
-    _QT4_ADJUST_LIB_VARS(QTMAIN)
-  ENDIF(WIN32)
-
-  IF(QT_QTSCRIPT_LIBRARY AND QT_QTUITOOLS_LIBRARY)
-    SET(QT_QTUITOOLS_LIBRARY ${QT_QTUITOOLS_LIBRARY} ${QT_QTSCRIPT_LIBRARY} )
-  ENDIF(QT_QTSCRIPT_LIBRARY AND QT_QTUITOOLS_LIBRARY)
-
-  #######################################
-  #
-  #       Check the executables of Qt 
-  #          ( moc, uic, rcc )
-  #
-  #######################################
-
-
-  # find moc and uic using qmake
-  QT_QUERY_QMAKE(QT_MOC_EXECUTABLE_INTERNAL &quot;QMAKE_MOC&quot;)
-  QT_QUERY_QMAKE(QT_UIC_EXECUTABLE_INTERNAL &quot;QMAKE_UIC&quot;)
-
-  FILE(TO_CMAKE_PATH 
-    &quot;${QT_MOC_EXECUTABLE_INTERNAL}&quot; QT_MOC_EXECUTABLE_INTERNAL)
-  FILE(TO_CMAKE_PATH 
-    &quot;${QT_UIC_EXECUTABLE_INTERNAL}&quot; QT_UIC_EXECUTABLE_INTERNAL)
-
-  SET(QT_MOC_EXECUTABLE 
-    ${QT_MOC_EXECUTABLE_INTERNAL} CACHE FILEPATH &quot;The moc executable&quot;)
-  SET(QT_UIC_EXECUTABLE 
-    ${QT_UIC_EXECUTABLE_INTERNAL} CACHE FILEPATH &quot;The uic executable&quot;)
-
-  FIND_PROGRAM(QT_UIC3_EXECUTABLE
-    NAMES uic3
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_RCC_EXECUTABLE 
-    NAMES rcc
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_DBUSCPP2XML_EXECUTABLE 
-    NAMES qdbuscpp2xml
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  FIND_PROGRAM(QT_DBUSXML2CPP_EXECUTABLE 
-    NAMES qdbusxml2cpp
-    PATHS ${QT_BINARY_DIR}
-    NO_DEFAULT_PATH
-    )
-
-  IF (QT_MOC_EXECUTABLE)
-     SET(QT_WRAP_CPP &quot;YES&quot;)
-  ENDIF (QT_MOC_EXECUTABLE)
-
-  IF (QT_UIC_EXECUTABLE)
-     SET(QT_WRAP_UI &quot;YES&quot;)
-  ENDIF (QT_UIC_EXECUTABLE)
-
-
-
-  MARK_AS_ADVANCED( QT_UIC_EXECUTABLE QT_UIC3_EXECUTABLE QT_MOC_EXECUTABLE QT_RCC_EXECUTABLE QT_DBUSXML2CPP_EXECUTABLE QT_DBUSCPP2XML_EXECUTABLE)
-
-  ######################################
-  #
-  #       Macros for building Qt files
-  #
-  ######################################
-
-  MACRO (QT4_GET_MOC_INC_DIRS _moc_INC_DIRS)
-     SET(${_moc_INC_DIRS})
-     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
-
-     FOREACH(_current ${_inc_DIRS})
-        SET(${_moc_INC_DIRS} ${${_moc_INC_DIRS}} &quot;-I&quot; ${_current})
-     ENDFOREACH(_current ${_inc_DIRS})
-  ENDMACRO(QT4_GET_MOC_INC_DIRS)
-
-
-  MACRO (QT4_GENERATE_MOC infile outfile )
-  # get include dirs
-     QT4_GET_MOC_INC_DIRS(moc_includes)
-
-     GET_FILENAME_COMPONENT(abs_infile ${infile} ABSOLUTE)
-
-     ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${abs_infile}
-        DEPENDS ${abs_infile})
-
-     SET_SOURCE_FILES_PROPERTIES(${outfile} PROPERTIES SKIP_AUTOMOC TRUE)  # dont run automoc on this file
-
-     MACRO_ADD_FILE_DEPENDENCIES(${abs_infile} ${outfile})
-  ENDMACRO (QT4_GENERATE_MOC)
-
-
-  # QT4_WRAP_CPP(outfiles inputfile ... )
-  # TODO  perhaps add support for -D, -U and other minor options
-
-  MACRO (QT4_WRAP_CPP outfiles )
-    # get include dirs
-    QT4_GET_MOC_INC_DIRS(moc_includes)
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/moc_${outfile}.cxx)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_MOC_EXECUTABLE}
-        ARGS ${moc_includes} -o ${outfile} ${it}
-        DEPENDS ${it})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH(it)
-
-  ENDMACRO (QT4_WRAP_CPP)
-
-
-  # QT4_WRAP_UI(outfiles inputfile ... )
-
-  MACRO (QT4_WRAP_UI outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_UIC_EXECUTABLE}
-        ARGS -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_WRAP_UI)
-
-
-  # QT4_ADD_RESOURCE(outfiles inputfile ... )
-  # TODO  perhaps consider adding support for compression and root options to rcc
-
-  MACRO (QT4_ADD_RESOURCES outfiles )
-
-    FOREACH (it ${ARGN})
-      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
-      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
-      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
-      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
-      #  parse file for dependencies
-      FILE(READ &quot;${infile}&quot; _RC_FILE_CONTENTS)
-      STRING(REGEX MATCHALL &quot;&lt;file[^&lt;]+&quot; _RC_FILES &quot;${_RC_FILE_CONTENTS}&quot;)
-      
-      SET(_RC_DEPENDS)
-      FOREACH(_RC_FILE ${_RC_FILES})
-        STRING(REGEX REPLACE &quot;^&lt;file[^&gt;]*&gt;&quot; &quot;&quot; _RC_FILE &quot;${_RC_FILE}&quot;)
-        SET(_RC_DEPENDS ${_RC_DEPENDS} &quot;${rc_path}/${_RC_FILE}&quot;)
-      ENDFOREACH(_RC_FILE)
-      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
-        COMMAND ${QT_RCC_EXECUTABLE}
-        ARGS -name ${outfilename} -o ${outfile} ${infile}
-        MAIN_DEPENDENCY ${infile}
-        DEPENDS ${_RC_DEPENDS})
-      SET(${outfiles} ${${outfiles}} ${outfile})
-    ENDFOREACH (it)
-
-  ENDMACRO (QT4_ADD_RESOURCES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACE _sources _interface _basename)
-    GET_FILENAME_COMPONENT(_infile ${_interface} ABSOLUTE)
-    SET(_header ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.h)
-    SET(_impl   ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.cpp)
-    SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.moc)
-
-    GET_SOURCE_FILE_PROPERTY(_nonamespace ${_infile} NO_NAMESPACE)
-    IF ( _nonamespace )
-        SET(_params -N -m -p)
-    ELSE ( _nonamespace )
-        SET(_params -m -p)
-    ENDIF ( _nonamespace )
-
-     ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-        COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} ${_params} ${_basename} ${_infile}
-        DEPENDS ${_infile})
-
-    SET_SOURCE_FILES_PROPERTIES(${_impl} PROPERTIES SKIP_AUTOMOC TRUE)
-    
-    QT4_GENERATE_MOC(${_header} ${_moc})
-  
-    SET(${_sources} ${${_sources}} ${_impl} ${_header} ${_moc})
-    MACRO_ADD_FILE_DEPENDENCIES(${_impl} ${_moc})
-  
-  ENDMACRO(QT4_ADD_DBUS_INTERFACE)
- 
-  MACRO(QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE _sources _interface _basename)
-    SET_SOURCE_FILES_PROPERTIES(${_interface} PROPERTIES NO_NAMESPACE TRUE)
-    QT4_ADD_DBUS_INTERFACE(${_sources} ${_interface} ${_basename})
-  ENDMACRO(QT4_ADD_DBUS_INTERFACE_NO_NAMESPACE)
-
-  # Internal (avoid to duplicate code between QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE and QT4_ADD_DBUS_INTERFACES 
-  MACRO(_QT4_ADD_DBUS_INTERFACES _sources _filename)
-        GET_FILENAME_COMPONENT(_infile ${_filename} ABSOLUTE)
-        # get the part before the &quot;.xml&quot; suffix
-        STRING(REGEX REPLACE &quot;(.*[/\\.])?([^\\.]+)\\.xml&quot; &quot;\\2&quot; _basename ${_current_FILE})
-        STRING(TOLOWER ${_basename} _basename)
-        QT4_ADD_DBUS_INTERFACE(${_sources} ${_infile} ${_basename}interface)     
-  ENDMACRO(_QT4_ADD_DBUS_INTERFACES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACES _sources)
-     FOREACH (_current_FILE ${ARGN})
-        _QT4_ADD_DBUS_INTERFACES(${_sources} ${_current_FILE})
-     ENDFOREACH (_current_FILE)
-  ENDMACRO(QT4_ADD_DBUS_INTERFACES)
-
-  MACRO(QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE _sources)
-    FOREACH (_current_FILE ${ARGN})
-	SET_SOURCE_FILES_PROPERTIES(${_current_FILE} PROPERTIES NO_NAMESPACE TRUE)
-        _QT4_ADD_DBUS_INTERFACES(${_sources} ${_current_FILE})
-    ENDFOREACH (_current_FILE)
-  ENDMACRO(QT4_ADD_DBUS_INTERFACES_NO_NAMESPACE)
-  
-  MACRO(QT4_GENERATE_DBUS_INTERFACE _header) # _customName )
-    SET(_customName &quot;${ARGV1}&quot;)
-    GET_FILENAME_COMPONENT(_in_file ${_header} ABSOLUTE)
-    GET_FILENAME_COMPONENT(_basename ${_header} NAME_WE)
-    
-    IF (_customName)
-      SET(_target ${CMAKE_CURRENT_BINARY_DIR}/${_customName})
-    ELSE (_customName)
-      SET(_target ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.xml)
-    ENDIF (_customName)
-  
-    ADD_CUSTOM_COMMAND(OUTPUT ${_target}
-        COMMAND ${QT_DBUSCPP2XML_EXECUTABLE} ${_in_file} &gt; ${_target}
-        DEPENDS ${_in_file}
-    )
-  ENDMACRO(QT4_GENERATE_DBUS_INTERFACE)
-  
-  
-  MACRO(QT4_ADD_DBUS_ADAPTOR _sources _xml_file _include _parentClass) # _optionalBasename )
-    GET_FILENAME_COMPONENT(_infile ${_xml_file} ABSOLUTE)
-    
-    SET(_optionalBasename &quot;${ARGV4}&quot;)
-    IF (_optionalBasename)
-       SET(_basename ${_optionalBasename} )
-    ELSE (_optionalBasename)
-       STRING(REGEX REPLACE &quot;(.*[/\\.])?([^\\.]+)\\.xml&quot; &quot;\\2adaptor&quot; _basename ${_infile})
-       STRING(TOLOWER ${_basename} _basename)
-    ENDIF (_optionalBasename)
-
-    SET(_optionalClassName &quot;${ARGV5}&quot;)
-    SET(_header ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.h)
-    SET(_impl   ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.cpp)
-    SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_basename}.moc)
-
-    IF(_optionalClassName)
-       ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-          COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} -m -a ${_basename} -c ${_optionalClassName} -i ${_include} -l ${_parentClass} ${_infile}
-          DEPENDS ${_infile}
-        )
-    ELSE(_optionalClassName)
-       ADD_CUSTOM_COMMAND(OUTPUT ${_impl} ${_header}
-          COMMAND ${QT_DBUSXML2CPP_EXECUTABLE} -m -a ${_basename} -i ${_include} -l ${_parentClass} ${_infile}
-          DEPENDS ${_infile}
-        )
-    ENDIF(_optionalClassName)
-
-    QT4_GENERATE_MOC(${_header} ${_moc})
-    SET_SOURCE_FILES_PROPERTIES(${_impl} PROPERTIES SKIP_AUTOMOC TRUE)
-    MACRO_ADD_FILE_DEPENDENCIES(${_impl} ${_moc})
-
-    SET(${_sources} ${${_sources}} ${_impl} ${_header} ${_moc})
-  ENDMACRO(QT4_ADD_DBUS_ADAPTOR)
-
-   MACRO(QT4_AUTOMOC)
-      QT4_GET_MOC_INC_DIRS(_moc_INCS)
-
-      SET(_matching_FILES )
-      FOREACH (_current_FILE ${ARGN})
-
-         GET_FILENAME_COMPONENT(_abs_FILE ${_current_FILE} ABSOLUTE)
-         # if &quot;SKIP_AUTOMOC&quot; is set to true, we will not handle this file here.
-         # here. this is required to make bouic work correctly:
-         # we need to add generated .cpp files to the sources (to compile them),
-         # but we cannot let automoc handle them, as the .cpp files don't exist yet when
-         # cmake is run for the very first time on them -&gt; however the .cpp files might
-         # exist at a later run. at that time we need to skip them, so that we don't add two
-         # different rules for the same moc file
-         GET_SOURCE_FILE_PROPERTY(_skip ${_abs_FILE} SKIP_AUTOMOC)
-
-         IF ( NOT _skip AND EXISTS ${_abs_FILE} )
-
-            FILE(READ ${_abs_FILE} _contents)
-
-            GET_FILENAME_COMPONENT(_abs_PATH ${_abs_FILE} PATH)
-
-            STRING(REGEX MATCHALL &quot;#include +[^ ]+\\.moc[\&quot;&gt;]&quot; _match &quot;${_contents}&quot;)
-            IF(_match)
-               FOREACH (_current_MOC_INC ${_match})
-                  STRING(REGEX MATCH &quot;[^ &lt;\&quot;]+\\.moc&quot; _current_MOC &quot;${_current_MOC_INC}&quot;)
-
-                  GET_filename_component(_basename ${_current_MOC} NAME_WE)
-   #               SET(_header ${CMAKE_CURRENT_SOURCE_DIR}/${_basename}.h)
-                  SET(_header ${_abs_PATH}/${_basename}.h)
-                  SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_current_MOC})
-                  ADD_CUSTOM_COMMAND(OUTPUT ${_moc}
-                     COMMAND ${QT_MOC_EXECUTABLE}
-                     ARGS ${_moc_INCS} ${_header} -o ${_moc}
-                     DEPENDS ${_header}
-                  )
-
-                  MACRO_ADD_FILE_DEPENDENCIES(${_abs_FILE} ${_moc})
-               ENDFOREACH (_current_MOC_INC)
-            ENDIF(_match)
-         ENDIF ( NOT _skip AND EXISTS ${_abs_FILE} )
-      ENDFOREACH (_current_FILE)
-   ENDMACRO(QT4_AUTOMOC)
-
-
-
-  ######################################
-  #
-  #       decide if Qt got found
-  #
-  ######################################
-
-  # if the includes,libraries,moc,uic and rcc are found then we have it
-  IF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND &quot;YES&quot; )
-    IF( NOT Qt4_FIND_QUIETLY)
-      IF (WIN32)
-        MESSAGE(STATUS &quot;Found Qt-Version ${QTVERSION} with qmake at ${QT_QMAKE_EXECUTABLE}&quot;)
-      ELSE (WIN32)
-        MESSAGE(STATUS &quot;Found Qt-Version ${QTVERSION}&quot;)
-      ENDIF (WIN32)
-    ENDIF( NOT Qt4_FIND_QUIETLY)
-  ELSE( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
-    SET( QT4_FOUND &quot;NO&quot;)
-    SET(QT_QMAKE_EXECUTABLE &quot;${QT_QMAKE_EXECUTABLE}-NOTFOUND&quot; CACHE FILEPATH &quot;Invalid qmake found&quot; FORCE)
-    IF( Qt4_FIND_REQUIRED)
-      IF ( NOT QT_LIBRARY_DIR )
-	MESSAGE(STATUS &quot;Qt libraries NOT found!&quot;)
-      ENDIF(NOT QT_LIBRARY_DIR )
-      IF ( NOT QT_INCLUDE_DIR )
-	MESSAGE(STATUS &quot;Qt includes NOT found!&quot;)
-      ENDIF( NOT QT_INCLUDE_DIR )
-      IF ( NOT QT_MOC_EXECUTABLE )
-        MESSAGE(STATUS &quot;Qt's moc NOT found!&quot;)
-      ENDIF( NOT QT_MOC_EXECUTABLE )
-      IF ( NOT QT_UIC_EXECUTABLE )
-        MESSAGE(STATUS &quot;Qt's uic NOT found!&quot;)
-      ENDIF( NOT QT_UIC_EXECUTABLE )
-      IF ( NOT QT_RCC_EXECUTABLE )
-        MESSAGE(STATUS &quot;Qt's rcc NOT found!&quot;)
-      ENDIF( NOT QT_RCC_EXECUTABLE )
-      MESSAGE( FATAL_ERROR &quot;Qt libraries, includes, moc, uic or/and rcc NOT found!&quot;)
-    ENDIF( Qt4_FIND_REQUIRED)
-  ENDIF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND  QT_RCC_EXECUTABLE)
-  SET(QT_FOUND ${QT4_FOUND})
-
-
-  #######################################
-  #
-  #       System dependent settings  
-  #
-  #######################################
-  # for unix add X11 stuff
-  IF(UNIX)
-    # on OS X X11 may not be required
-    IF (Q_WS_X11)
-      FIND_PACKAGE(X11 REQUIRED)
-    ENDIF (Q_WS_X11)
-    FIND_PACKAGE(Threads)
-    SET(QT_QTCORE_LIBRARY ${QT_QTCORE_LIBRARY} ${CMAKE_THREAD_LIBS_INIT})
-  ENDIF(UNIX)
-
-
-  #######################################
-  #
-  #       compatibility settings 
-  #
-  #######################################
-  # Backwards compatibility for CMake1.4 and 1.2
-  SET (QT_MOC_EXE ${QT_MOC_EXECUTABLE} )
-  SET (QT_UIC_EXE ${QT_UIC_EXECUTABLE} )
-
-  SET( QT_QT_LIBRARY &quot;&quot;)
-
-ELSE(QT4_QMAKE_FOUND)
-   
-   SET(QT_QMAKE_EXECUTABLE &quot;${QT_QMAKE_EXECUTABLE}-NOTFOUND&quot; CACHE FILEPATH &quot;Invalid qmake found&quot; FORCE)
-   IF(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD)
-         MESSAGE(FATAL_ERROR &quot;The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required&quot;)
-      ELSE(QT4_INSTALLED_VERSION_TOO_OLD)
-         MESSAGE( FATAL_ERROR &quot;Qt qmake not found!&quot;)
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD)
-   ELSE(Qt4_FIND_REQUIRED)
-      IF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-         MESSAGE(STATUS &quot;The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required&quot;)
-      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
-   ENDIF(Qt4_FIND_REQUIRED)
- 
-ENDIF (QT4_QMAKE_FOUND)
-
-
+# - Find QT 4
+# This module can be used to find Qt4.
+# The most important issue is that the Qt4 qmake is available via the system path.
+# This qmake is then used to detect basically everything else.
+# This module defines a number of key variables and macros. First is 
+# QT_USE_FILE which is the path to a CMake file that can be included to compile
+# Qt 4 applications and libraries.  By default, the QtCore and QtGui 
+# libraries are loaded. This behavior can be changed by setting one or more 
+# of the following variables to true:
+#                    QT_DONT_USE_QTCORE
+#                    QT_DONT_USE_QTGUI
+#                    QT_USE_QT3SUPPORT
+#                    QT_USE_QTASSISTANT
+#                    QT_USE_QTDESIGNER
+#                    QT_USE_QTMOTIF
+#                    QT_USE_QTMAIN
+#                    QT_USE_QTNETWORK
+#                    QT_USE_QTNSPLUGIN
+#                    QT_USE_QTOPENGL
+#                    QT_USE_QTSQL
+#                    QT_USE_QTXML
+#                    QT_USE_QTSVG
+#                    QT_USE_QTTEST
+#                    QT_USE_QTUITOOLS
+#
+# All the libraries required are stored in a variable called QT_LIBRARIES.  
+# Add this variable to your TARGET_LINK_LIBRARIES.
+#  
+#  macro QT4_WRAP_CPP(outfiles inputfile ... )
+#  macro QT4_WRAP_UI(outfiles inputfile ... )
+#  macro QT4_ADD_RESOURCE(outfiles inputfile ... )
+#  macro QT4_AUTOMOC(inputfile ... )
+#  macro QT4_GENERATE_MOC(inputfile outputfile )
+#  
+#  QT_FOUND         If false, don't try to use Qt.
+#  QT4_FOUND        If false, don't try to use Qt 4.
+#                      
+#  QT_QTCORE_FOUND        True if QtCore was found.
+#  QT_QTGUI_FOUND         True if QtGui was found.
+#  QT_QT3SUPPORT_FOUND    True if Qt3Support was found.
+#  QT_QTASSISTANT_FOUND   True if QtAssistant was found.
+#  QT_QTDESIGNER_FOUND    True if QtDesigner was found.
+#  QT_QTMOTIF_FOUND       True if QtMotif was found.
+#  QT_QTNETWORK_FOUND     True if QtNetwork was found.
+#  QT_QTNSPLUGIN_FOUND    True if QtNsPlugin was found.
+#  QT_QTOPENGL_FOUND      True if QtOpenGL was found.
+#  QT_QTSQL_FOUND         True if QtSql was found.
+#  QT_QTXML_FOUND         True if QtXml was found.
+#  QT_QTSVG_FOUND         True if QtSvg was found.
+#  QT_QTTEST_FOUND        True if QtTest was found.
+#  QT_QTUITOOLS_FOUND     True if QtUiTools was found.
+#                      
+#  QT_DEFINITIONS   Definitions to use when compiling code that uses Qt.
+#                  
+#  QT_INCLUDES      List of paths to all include directories of 
+#                   Qt4 QT_INCLUDE_DIR and QT_QTCORE_INCLUDE_DIR are
+#                   always in this variable even if NOTFOUND,
+#                   all other INCLUDE_DIRS are
+#                   only added if they are found.
+#   
+#  QT_INCLUDE_DIR              Path to &quot;include&quot; of Qt4
+#  QT_QT_INCLUDE_DIR           Path to &quot;include/Qt&quot; 
+#  QT_QT3SUPPORT_INCLUDE_DIR   Path to &quot;include/Qt3Support&quot; 
+#  QT_QTASSISTANT_INCLUDE_DIR  Path to &quot;include/QtAssistant&quot; 
+#  QT_QTCORE_INCLUDE_DIR       Path to &quot;include/QtCore&quot;         
+#  QT_QTDESIGNER_INCLUDE_DIR   Path to &quot;include/QtDesigner&quot; 
+#  QT_QTGUI_INCLUDE_DIR        Path to &quot;include/QtGui&quot; 
+#  QT_QTMOTIF_INCLUDE_DIR      Path to &quot;include/QtMotif&quot; 
+#  QT_QTNETWORK_INCLUDE_DIR    Path to &quot;include/QtNetwork&quot; 
+#  QT_QTNSPLUGIN_INCLUDE_DIR   Path to &quot;include/QtNsPlugin&quot; 
+#  QT_QTOPENGL_INCLUDE_DIR     Path to &quot;include/QtOpenGL&quot; 
+#  QT_QTSQL_INCLUDE_DIR        Path to &quot;include/QtSql&quot; 
+#  QT_QTXML_INCLUDE_DIR        Path to &quot;include/QtXml&quot; 
+#  QT_QTSVG_INCLUDE_DIR        Path to &quot;include/QtSvg&quot;
+#  QT_QTTEST_INCLUDE_DIR       Path to &quot;include/QtTest&quot;
+#                            
+#  QT_LIBRARY_DIR              Path to &quot;lib&quot; of Qt4
+#                            
+#  QT_PLUGINS_DIR              Path to &quot;plugins&quot; for Qt4
+#                            
+# For every library of Qt there are three variables:
+#  QT_QTFOO_LIBRARY_RELEASE, which contains the full path to the release version
+#  QT_QTFOO_LIBRARY_DEBUG, which contains the full path to the debug version
+#  QT_QTFOO_LIBRARY, the full path to the release version if available, otherwise to the debug version
+#
+# So there are the following variables:
+# The Qt3Support library:     QT_QT3SUPPORT_LIBRARY
+#                             QT_QT3SUPPORT_LIBRARY_RELEASE
+#                             QT_QT3SUPPORT_DEBUG
+#
+# The QtAssistant library:    QT_QTASSISTANT_LIBRARY
+#                             QT_QTASSISTANT_LIBRARY_RELEASE
+#                             QT_QTASSISTANT_LIBRARY_DEBUG
+#
+# The QtCore library:         QT_QTCORE_LIBRARY
+#                             QT_QTCORE_LIBRARY_RELEASE
+#                             QT_QTCORE_LIBRARY_DEBUG
+#
+# The QtDesigner library:     QT_QTDESIGNER_LIBRARY
+#                             QT_QTDESIGNER_LIBRARY_RELEASE
+#                             QT_QTDESIGNER_LIBRARY_DEBUG
+#
+# The QtGui library:          QT_QTGUI_LIBRARY
+#                             QT_QTGUI_LIBRARY_RELEASE
+#                             QT_QTGUI_LIBRARY_DEBUG
+#
+# The QtMotif library:        QT_QTMOTIF_LIBRARY
+#                             QT_QTMOTIF_LIBRARY_RELEASE
+#                             QT_QTMOTIF_LIBRARY_DEBUG
+#
+# The QtNetwork library:      QT_QTNETWORK_LIBRARY
+#                             QT_QTNETWORK_LIBRARY_RELEASE
+#                             QT_QTNETWORK_LIBRARY_DEBUG
+#
+# The QtNsPLugin library:     QT_QTNSPLUGIN_LIBRARY
+#                             QT_QTNSPLUGIN_LIBRARY_RELEASE
+#                             QT_QTNSPLUGIN_LIBRARY_DEBUG
+#
+# The QtOpenGL library:       QT_QTOPENGL_LIBRARY
+#                             QT_QTOPENGL_LIBRARY_RELEASE
+#                             QT_QTOPENGL_LIBRARY_DEBUG
+#
+# The QtSql library:          QT_QTSQL_LIBRARY
+#                             QT_QTSQL_LIBRARY_RELEASE
+#                             QT_QTSQL_LIBRARY_DEBUG
+#
+# The QtXml library:          QT_QTXML_LIBRARY
+#                             QT_QTXML_LIBRARY_RELEASE
+#                             QT_QTXML_LIBRARY_DEBUG
+#
+# The QtSvg library:          QT_QTSVG_LIBRARY
+#                             QT_QTSVG_LIBRARY_RELEASE
+#                             QT_QTSVG_LIBRARY_DEBUG
+#
+# The QtTest library:         QT_QTTEST_LIBRARY
+#                             QT_QTTEST_LIBRARY_RELEASE
+#                             QT_QTTEST_LIBRARY_DEBUG
+#
+# The qtmain library for Windows QT_QTMAIN_LIBRARY
+#                             QT_QTMAIN_LIBRARY_RELEASE
+#                             QT_QTMAIN_LIBRARY_DEBUG
+#
+#The QtUiTools library:       QT_QTUITOOLS_LIBRARY
+#                             QT_QTUITOOLS_LIBRARY_RELEASE
+#                             QT_QTUITOOLS_LIBRARY_DEBUG
+#  
+# also defined, but NOT for general use are
+#  QT_MOC_EXECUTABLE          Where to find the moc tool.
+#  QT_UIC_EXECUTABLE          Where to find the uic tool.
+#  QT_UIC3_EXECUTABLE         Where to find the uic3 tool.
+#  QT_RCC_EXECUTABLE          Where to find the rcc tool
+#  
+#  QT_DOC_DIR                 Path to &quot;doc&quot; of Qt4
+#  QT_MKSPECS_DIR             Path to &quot;mkspecs&quot; of Qt4
+#
+#
+# These are around for backwards compatibility 
+# they will be set
+#  QT_WRAP_CPP  Set true if QT_MOC_EXECUTABLE is found
+#  QT_WRAP_UI   Set true if QT_UIC_EXECUTABLE is found
+#  
+# These variables do _NOT_ have any effect anymore (compared to FindQt.cmake)
+#  QT_MT_REQUIRED         Qt4 is now always multithreaded
+#  
+# These variables are set to &quot;&quot; Because Qt structure changed 
+# (They make no sense in Qt4)
+#  QT_QT_LIBRARY        Qt-Library is now split
+
+INCLUDE(CheckSymbolExists)
+INCLUDE(MacroAddFileDependencies)
+
+SET(QT_USE_FILE ${CMAKE_ROOT}/Modules/UseQt4.cmake)
+
+SET( QT_DEFINITIONS &quot;&quot;)
+
+# check for qmake
+FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake-qt4 PATHS
+  &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin&quot;
+  &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin&quot;
+  $ENV{QTDIR}/bin
+  )
+
+SET(QT4_INSTALLED_VERSION_TOO_OLD FALSE)
+
+##  macro for asking qmake to process pro files
+MACRO(QT_QUERY_QMAKE outvar invar)
+  FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake/tmp.pro
+    &quot;message(CMAKE_MESSAGE&lt;$$${invar}&gt;)&quot;)
+  EXECUTE_PROCESS(COMMAND ${QT_QMAKE_EXECUTABLE}
+    WORKING_DIRECTORY  
+    ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake
+    OUTPUT_VARIABLE _qmake_query_output
+    ERROR_VARIABLE _qmake_query_output )
+  FILE(REMOVE_RECURSE 
+    &quot;${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmpQmake&quot;)
+  STRING(REGEX REPLACE &quot;.*CMAKE_MESSAGE&lt;([^&gt;]*).*&quot; &quot;\\1&quot; ${outvar} &quot;${_qmake_query_output}&quot;)
+ENDMACRO(QT_QUERY_QMAKE)
+
+
+IF (QT_QMAKE_EXECUTABLE)
+
+   SET(QT4_QMAKE_FOUND FALSE)
+   
+   EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} ARGS &quot;-query QT_VERSION&quot; OUTPUT_VARIABLE QTVERSION)
+  # check for qt3 qmake and then try and find qmake-qt4 in the path
+  IF(&quot;${QTVERSION}&quot; MATCHES &quot;Unknown&quot;)
+    SET(QT_QMAKE_EXECUTABLE NOTFOUND CACHE FILEPATH &quot;&quot; FORCE)
+    FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake-qt4 PATHS
+      &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin&quot;
+      &quot;[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin&quot;
+      $ENV{QTDIR}/bin
+      )
+    IF(QT_QMAKE_EXECUTABLE)
+      EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE} 
+        ARGS &quot;-query QT_VERSION&quot; OUTPUT_VARIABLE QTVERSION)
+    ENDIF(QT_QMAKE_EXECUTABLE)
+  ENDIF(&quot;${QTVERSION}&quot; MATCHES &quot;Unknown&quot;)
+   # check that we found the Qt4 qmake, Qt3 qmake output won't match here
+   STRING(REGEX MATCH &quot;^[0-9]+\\.[0-9]+\\.[0-9]+&quot; qt_version_tmp &quot;${QTVERSION}&quot;)
+   IF (qt_version_tmp)
+
+      # we need at least version 4.0.0
+      IF (NOT QT_MIN_VERSION)
+         SET(QT_MIN_VERSION &quot;4.0.0&quot;)
+      ENDIF (NOT QT_MIN_VERSION)
+   
+      #now parse the parts of the user given version string into variables
+      STRING(REGEX MATCH &quot;^[0-9]+\\.[0-9]+\\.[0-9]+&quot; req_qt_major_vers &quot;${QT_MIN_VERSION}&quot;)
+      IF (NOT req_qt_major_vers)
+         MESSAGE( FATAL_ERROR &quot;Invalid Qt version string given: \&quot;${QT_MIN_VERSION}\&quot;, expected e.g. \&quot;4.0.1\&quot;&quot;)
+      ENDIF (NOT req_qt_major_vers)
+   
+      # now parse the parts of the user given version string into variables
+      STRING(REGEX REPLACE &quot;^([0-9]+)\\.[0-9]+\\.[0-9]+&quot; &quot;\\1&quot; req_qt_major_vers &quot;${QT_MIN_VERSION}&quot;)
+      STRING(REGEX REPLACE &quot;^[0-9]+\\.([0-9])+\\.[0-9]+&quot; &quot;\\1&quot; req_qt_minor_vers &quot;${QT_MIN_VERSION}&quot;)
+      STRING(REGEX REPLACE &quot;^[0-9]+\\.[0-9]+\\.([0-9]+)&quot; &quot;\\1&quot; req_qt_patch_vers &quot;${QT_MIN_VERSION}&quot;)
+   
+      IF (NOT req_qt_major_vers EQUAL 4)
+         MESSAGE( FATAL_ERROR &quot;Invalid Qt version string given: \&quot;${QT_MIN_VERSION}\&quot;, major version 4 is required, e.g. \&quot;4.0.1\&quot;&quot;)
+      ENDIF (NOT req_qt_major_vers EQUAL 4)
+   
+      # and now the version string given by qmake
+      STRING(REGEX REPLACE &quot;^([0-9]+)\\.[0-9]+\\.[0-9]+.*&quot; &quot;\\1&quot; found_qt_major_vers &quot;${QTVERSION}&quot;)
+      STRING(REGEX REPLACE &quot;^[0-9]+\\.([0-9])+\\.[0-9]+.*&quot; &quot;\\1&quot; found_qt_minor_vers &quot;${QTVERSION}&quot;)
+      STRING(REGEX REPLACE &quot;^[0-9]+\\.[0-9]+\\.([0-9]+).*&quot; &quot;\\1&quot; found_qt_patch_vers &quot;${QTVERSION}&quot;)
+   
+      # compute an overall version number which can be compared at once
+      MATH(EXPR req_vers &quot;${req_qt_major_vers}*10000 + ${req_qt_minor_vers}*100 + ${req_qt_patch_vers}&quot;)
+      MATH(EXPR found_vers &quot;${found_qt_major_vers}*10000 + ${found_qt_minor_vers}*100 + ${found_qt_patch_vers}&quot;)
+   
+      IF (found_vers LESS req_vers)
+         SET(QT4_QMAKE_FOUND FALSE)
+         SET(QT4_INSTALLED_VERSION_TOO_OLD TRUE)
+      ELSE (found_vers LESS req_vers)
+    SET(QT4_QMAKE_FOUND TRUE)
+      ENDIF (found_vers LESS req_vers)
+   ENDIF (qt_version_tmp)
+
+ENDIF (QT_QMAKE_EXECUTABLE)
+
+IF (QT4_QMAKE_FOUND)
+
+  # ask qmake for the library dir
+  # Set QT_LIBRARY_DIR
+  IF (NOT QT_LIBRARY_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS &quot;-query QT_INSTALL_LIBS&quot;
+      OUTPUT_VARIABLE QT_LIBRARY_DIR_TMP )
+    IF(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
+      SET(QT_LIBRARY_DIR ${QT_LIBRARY_DIR_TMP} CACHE PATH &quot;Qt library dir&quot;)
+    ELSE(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
+      MESSAGE(&quot;Warning: QT_QMAKE_EXECUTABLE reported QT_INSTALL_LIBS as ${QT_LIBRARY_DIR_TMP}&quot;)
+       MESSAGE(&quot;Warning: ${QT_LIBRARY_DIR_TMP} does NOT exist, Qt must NOT be installed correctly.&quot;)
+    ENDIF(EXISTS &quot;${QT_LIBRARY_DIR_TMP}&quot;)
+  ENDIF(NOT QT_LIBRARY_DIR)
+  
+  IF (APPLE)
+    IF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+      SET(QT_USE_FRAMEWORKS ON
+        CACHE BOOL &quot;Set to ON if Qt build uses frameworks.&quot;)
+    ELSE (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+      SET(QT_USE_FRAMEWORKS OFF
+        CACHE BOOL &quot;Set to ON if Qt build uses frameworks.&quot;)
+    ENDIF (EXISTS ${QT_LIBRARY_DIR}/QtCore.framework)
+    
+    MARK_AS_ADVANCED(QT_USE_FRAMEWORKS)
+  ENDIF (APPLE)
+  
+  # ask qmake for the binary dir
+  IF (NOT QT_BINARY_DIR)
+     EXEC_PROGRAM(${QT_QMAKE_EXECUTABLE}
+        ARGS &quot;-query QT_INSTALL_BINS&quot;
+        OUTPUT_VARIABLE qt_bins )
+     SET(QT_BINARY_DIR ${qt_bins} CACHE INTERNAL &quot;&quot;)
+  ENDIF (NOT QT_BINARY_DIR)
+
+  # ask qmake for the include dir
+  IF (NOT QT_HEADERS_DIR)
+      EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+        ARGS &quot;-query QT_INSTALL_HEADERS&quot; 
+        OUTPUT_VARIABLE qt_headers )
+      SET(QT_HEADERS_DIR ${qt_headers} CACHE INTERNAL &quot;&quot;)
+  ENDIF(NOT QT_HEADERS_DIR)
+
+
+  # ask qmake for the documentation directory
+  IF (NOT QT_DOC_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS &quot;-query QT_INSTALL_DOCS&quot;
+      OUTPUT_VARIABLE qt_doc_dir )
+    SET(QT_DOC_DIR ${qt_doc_dir} CACHE PATH &quot;The location of the Qt docs&quot;)
+  ENDIF (NOT QT_DOC_DIR)
+
+  # ask qmake for the mkspecs directory
+  IF (NOT QT_MKSPECS_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS &quot;-query QMAKE_MKSPECS&quot;
+      OUTPUT_VARIABLE qt_mkspecs_dir )
+    SET(QT_MKSPECS_DIR ${qt_mkspecs_dir} CACHE PATH &quot;The location of the Qt mkspecs&quot;)
+  ENDIF (NOT QT_MKSPECS_DIR)
+
+  # ask qmake for the plugins directory
+  IF (NOT QT_PLUGINS_DIR)
+    EXEC_PROGRAM( ${QT_QMAKE_EXECUTABLE}
+      ARGS &quot;-query QT_INSTALL_PLUGINS&quot;
+      OUTPUT_VARIABLE qt_plugins_dir )
+    SET(QT_PLUGINS_DIR ${qt_plugins_dir} CACHE PATH &quot;The location of the Qt plugins&quot;)
+  ENDIF (NOT QT_PLUGINS_DIR)
+  ########################################
+  #
+  #       Setting the INCLUDE-Variables
+  #
+  ########################################
+
+  FIND_PATH(QT_QTCORE_INCLUDE_DIR QtGlobal
+    ${QT_HEADERS_DIR}/QtCore
+    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
+    NO_DEFAULT_PATH
+   )
+
+  # Set QT_INCLUDE_DIR by removine &quot;/QtCore&quot; in the string ${QT_QTCORE_INCLUDE_DIR}
+  IF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
+    IF (QT_USE_FRAMEWORKS)
+      SET(QT_INCLUDE_DIR ${QT_HEADERS_DIR})
+    ELSE (QT_USE_FRAMEWORKS)
+      STRING( REGEX REPLACE &quot;/QtCore$&quot; &quot;&quot; qt4_include_dir ${QT_QTCORE_INCLUDE_DIR})
+      SET( QT_INCLUDE_DIR ${qt4_include_dir} CACHE PATH &quot;&quot;)
+    ENDIF (QT_USE_FRAMEWORKS)
+  ENDIF( QT_QTCORE_INCLUDE_DIR AND NOT QT_INCLUDE_DIR)
+
+  IF( NOT QT_INCLUDE_DIR)
+    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR &quot;Could NOT find QtGlobal header&quot;)
+    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+  ENDIF( NOT QT_INCLUDE_DIR)
+
+  #############################################
+  #
+  # Find out what window system we're using
+  #
+  #############################################
+  # Save required includes variable
+  SET(CMAKE_REQUIRED_INCLUDES_SAVE ${CMAKE_REQUIRED_INCLUDES})
+  # Add QT_INCLUDE_DIR to CMAKE_REQUIRED_INCLUDES
+  SET(CMAKE_REQUIRED_INCLUDES &quot;${CMAKE_REQUIRED_INCLUDES};${QT_INCLUDE_DIR}&quot;)
+  # Check for Window system symbols (note: only one should end up being set)
+  CHECK_SYMBOL_EXISTS(Q_WS_X11 &quot;QtCore/qglobal.h&quot; Q_WS_X11)
+  CHECK_SYMBOL_EXISTS(Q_WS_MAC &quot;QtCore/qglobal.h&quot; Q_WS_MAC)
+  CHECK_SYMBOL_EXISTS(Q_WS_WIN &quot;QtCore/qglobal.h&quot; Q_WS_WIN)
+
+  IF (QT_QTCOPY_REQUIRED)
+     CHECK_SYMBOL_EXISTS(QT_IS_QTCOPY &quot;QtCore/qglobal.h&quot; QT_KDE_QT_COPY)
+     IF (NOT QT_IS_QTCOPY)
+        MESSAGE(FATAL_ERROR &quot;qt-copy is required, but hasn't been found&quot;)
+     ENDIF (NOT QT_IS_QTCOPY)
+  ENDIF (QT_QTCOPY_REQUIRED)
+
+  # Restore CMAKE_REQUIRED_INCLUDES variable
+  SET(CMAKE_REQUIRED_INCLUDES ${CMAKE_REQUIRED_INCLUDES_SAVE})
+  #
+  #############################################
+
+  IF (QT_USE_FRAMEWORKS)
+    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -F${QT_LIBRARY_DIR} -L${QT_LIBRARY_DIR} )
+  ENDIF (QT_USE_FRAMEWORKS)
+
+  # Set QT_QT3SUPPORT_INCLUDE_DIR
+  FIND_PATH(QT_QT3SUPPORT_INCLUDE_DIR Qt3Support
+    PATHS
+    ${QT_INCLUDE_DIR}/Qt3Support
+    ${QT_LIBRARY_DIR}/Qt3Support.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QT_INCLUDE_DIR
+  FIND_PATH(QT_QT_INCLUDE_DIR qglobal.h
+    PATHS
+    ${QT_INCLUDE_DIR}/Qt
+    ${QT_LIBRARY_DIR}/QtCore.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTGUI_INCLUDE_DIR
+  FIND_PATH(QT_QTGUI_INCLUDE_DIR QtGui
+    PATHS
+    ${QT_INCLUDE_DIR}/QtGui
+    ${QT_LIBRARY_DIR}/QtGui.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTSVG_INCLUDE_DIR
+  FIND_PATH(QT_QTSVG_INCLUDE_DIR QtSvg
+    PATHS
+    ${QT_INCLUDE_DIR}/QtSvg
+    ${QT_LIBRARY_DIR}/QtSvg.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTTEST_INCLUDE_DIR
+  FIND_PATH(QT_QTTEST_INCLUDE_DIR QtTest
+    PATHS
+    ${QT_INCLUDE_DIR}/QtTest
+    ${QT_LIBRARY_DIR}/QtTest.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTUITOOLS_INCLUDE_DIR
+  FIND_PATH(QT_QTUITOOLS_INCLUDE_DIR QtUiTools
+    PATHS
+    ${QT_INCLUDE_DIR}/QtUiTools
+    ${QT_LIBRARY_DIR}/QtUiTools.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+
+
+  # Set QT_QTMOTIF_INCLUDE_DIR
+  IF(Q_WS_X11)
+    FIND_PATH(QT_QTMOTIF_INCLUDE_DIR QtMotif PATHS ${QT_INCLUDE_DIR}/QtMotif NO_DEFAULT_PATH )
+  ENDIF(Q_WS_X11)
+
+  # Set QT_QTNETWORK_INCLUDE_DIR
+  FIND_PATH(QT_QTNETWORK_INCLUDE_DIR QtNetwork
+    PATHS
+    ${QT_INCLUDE_DIR}/QtNetwork
+    ${QT_LIBRARY_DIR}/QtNetwork.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTNSPLUGIN_INCLUDE_DIR
+  FIND_PATH(QT_QTNSPLUGIN_INCLUDE_DIR QtNsPlugin
+    PATHS
+    ${QT_INCLUDE_DIR}/QtNsPlugin
+    ${QT_LIBRARY_DIR}/QtNsPlugin.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTOPENGL_INCLUDE_DIR
+  FIND_PATH(QT_QTOPENGL_INCLUDE_DIR QtOpenGL
+    PATHS
+    ${QT_INCLUDE_DIR}/QtOpenGL
+    ${QT_LIBRARY_DIR}/QtOpenGL.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTSQL_INCLUDE_DIR
+  FIND_PATH(QT_QTSQL_INCLUDE_DIR QtSql
+    PATHS
+    ${QT_INCLUDE_DIR}/QtSql
+    ${QT_LIBRARY_DIR}/QtSql.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTXML_INCLUDE_DIR
+  FIND_PATH(QT_QTXML_INCLUDE_DIR QtXml
+    PATHS
+    ${QT_INCLUDE_DIR}/QtXml
+    ${QT_LIBRARY_DIR}/QtXml.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTASSISTANT_INCLUDE_DIR
+  FIND_PATH(QT_QTASSISTANT_INCLUDE_DIR QtAssistant
+    PATHS
+    ${QT_INCLUDE_DIR}/QtAssistant
+    ${QT_HEADERS_DIR}/QtAssistant
+    ${QT_LIBRARY_DIR}/QtAssistant.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Set QT_QTDESIGNER_INCLUDE_DIR
+  FIND_PATH(QT_QTDESIGNER_INCLUDE_DIR QDesignerComponents
+    PATHS
+    ${QT_INCLUDE_DIR}/QtDesigner
+    ${QT_HEADERS_DIR}/QtDesigner
+    ${QT_LIBRARY_DIR}/QtDesigner.framework/Headers
+    NO_DEFAULT_PATH
+    )
+
+  # Make variables changeble to the advanced user
+  MARK_AS_ADVANCED( QT_LIBRARY_DIR QT_INCLUDE_DIR QT_QT_INCLUDE_DIR QT_DOC_DIR)
+
+  # Set QT_INCLUDES
+  SET( QT_INCLUDES ${QT_INCLUDE_DIR} ${QT_QT_INCLUDE_DIR} ${QT_MKSPECS_DIR}/default )
+
+    # Set QT_QTCORE_LIBRARY by searching for a lib with &quot;QtCore.&quot;  as part of the filename
+    FIND_LIBRARY(QT_QTCORE_LIBRARY_RELEASE NAMES QtCore QtCore4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH )
+  FIND_LIBRARY(QT_QTCORE_LIBRARY_DEBUG NAMES QtCore_debug QtCored QtCored4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QT3SUPPORT_LIBRARY
+    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_RELEASE NAMES Qt3Support Qt3Support4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QT3SUPPORT_LIBRARY_DEBUG   NAMES Qt3Support_debug Qt3Supportd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTGUI_LIBRARY
+    FIND_LIBRARY(QT_QTGUI_LIBRARY_RELEASE NAMES QtGui QtGui4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTGUI_LIBRARY_DEBUG   NAMES QtGui_debug QtGuid4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTMOTIF_LIBRARY
+    IF(Q_WS_X11)
+      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_RELEASE NAMES QtMotif PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
+      FIND_LIBRARY(QT_QTMOTIF_LIBRARY_DEBUG   NAMES QtMotif_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+    ENDIF(Q_WS_X11)
+
+    # Set QT_QTNETWORK_LIBRARY
+    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_RELEASE NAMES QtNetwork QtNetwork4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTNETWORK_LIBRARY_DEBUG   NAMES QtNetwork_debug QtNetworkd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTNSPLUGIN_LIBRARY
+    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_RELEASE NAMES QtNsPlugin PATHS ${QT_LIBRARY_DIR}       NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTNSPLUGIN_LIBRARY_DEBUG   NAMES QtNsPlugin_debug PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTOPENGL_LIBRARY
+    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_RELEASE NAMES QtOpenGL QtOpenGL4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTOPENGL_LIBRARY_DEBUG   NAMES QtOpenGL_debug QtOpenGLd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTSQL_LIBRARY
+    FIND_LIBRARY(QT_QTSQL_LIBRARY_RELEASE NAMES QtSql QtSql4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTSQL_LIBRARY_DEBUG   NAMES QtSql_debug QtSqld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTXML_LIBRARY
+    FIND_LIBRARY(QT_QTXML_LIBRARY_RELEASE NAMES QtXml QtXml4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTXML_LIBRARY_DEBUG   NAMES QtXml_debug QtXmld4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTSVG_LIBRARY
+    FIND_LIBRARY(QT_QTSVG_LIBRARY_RELEASE NAMES QtSvg QtSvg4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTSVG_LIBRARY_DEBUG   NAMES QtSvg_debug QtSvgd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTUITOOLS_LIBRARY
+    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_RELEASE NAMES QtUiTools QtUiTools4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTUITOOLS_LIBRARY_DEBUG   NAMES QtUiTools_debug QtUiToolsd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    # Set QT_QTTEST_LIBRARY
+    FIND_LIBRARY(QT_QTTEST_LIBRARY_RELEASE NAMES QtTest QtTest4 PATHS ${QT_LIBRARY_DIR}                      NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTTEST_LIBRARY_DEBUG   NAMES QtTest_debug QtTest_debug4 QtTestd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+    MARK_AS_ADVANCED(QT_QT3SUPPORT_LIBRARY QT_QTGUI_LIBRARY )
+
+  IF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
+    IF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR &quot;Could NOT find QtCore. Check ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeError.log for more details.&quot;)
+    ENDIF( NOT Qt4_FIND_QUIETLY AND Qt4_FIND_REQUIRED)
+  ENDIF( NOT QT_QTCORE_LIBRARY_DEBUG AND NOT QT_QTCORE_LIBRARY_RELEASE )
+
+  # Set QT_QTASSISTANT_LIBRARY
+  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_RELEASE NAMES QtAssistantClient QtAssistantClient4 QtAssistant QtAssistant4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+  FIND_LIBRARY(QT_QTASSISTANT_LIBRARY_DEBUG   NAMES QtAssistantClientd QtAssistantClientd4 QtAssistantClient_debug QtAssistant_debug QtAssistantd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+  # Set QT_QTDESIGNER_LIBRARY
+  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_RELEASE NAMES QtDesigner QtDesigner4 PATHS ${QT_LIBRARY_DIR}        NO_DEFAULT_PATH)
+  FIND_LIBRARY(QT_QTDESIGNER_LIBRARY_DEBUG   NAMES QtDesigner_debug QtDesignerd4 PATHS ${QT_LIBRARY_DIR} NO_DEFAULT_PATH)
+
+  # Set QT_QTMAIN_LIBRARY
+  IF(WIN32)
+    FIND_LIBRARY(QT_QTMAIN_LIBRARY_RELEASE NAMES qtmain PATHS ${QT_LIBRARY_DIR}
+      NO_DEFAULT_PATH)
+    FIND_LIBRARY(QT_QTMAIN_LIBRARY_DEBUG NAMES qtmaind PATHS ${QT_LIBRARY_DIR}
+      NO_DEFAULT_PATH)
+  ENDIF(WIN32)
+
+  ############################################
+  #
+  # Check the existence of the libraries.
+  #
+  ############################################
+
+  MACRO (_QT4_ADJUST_LIB_VARS basename)
+    IF (QT_${basename}_INCLUDE_DIR)
+
+      # if only the release version was found, set the debug variable also to the release version
+      IF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
+        SET(QT_${basename}_LIBRARY_DEBUG ${QT_${basename}_LIBRARY_RELEASE})
+        SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE})
+        SET(QT_${basename}_LIBRARIES     ${QT_${basename}_LIBRARY_RELEASE})
+      ENDIF (QT_${basename}_LIBRARY_RELEASE AND NOT QT_${basename}_LIBRARY_DEBUG)
+
+      # if only the debug version was found, set the release variable also to the debug version
+      IF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
+        SET(QT_${basename}_LIBRARY_RELEASE ${QT_${basename}_LIBRARY_DEBUG})
+        SET(QT_${basename}_LIBRARY         ${QT_${basename}_LIBRARY_DEBUG})
+        SET(QT_${basename}_LIBRARIES       ${QT_${basename}_LIBRARY_DEBUG})
+      ENDIF (QT_${basename}_LIBRARY_DEBUG AND NOT QT_${basename}_LIBRARY_RELEASE)
+      IF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
+        # if the generator supports configuration types then set
+        # optimized and debug libraries, or if the CMAKE_BUILD_TYPE has a value
+        IF (CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+          SET(QT_${basename}_LIBRARY       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
+        ELSE(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+          # if there are no configuration types and CMAKE_BUILD_TYPE has no value
+          # then just use the release libraries
+          SET(QT_${basename}_LIBRARY       ${QT_${basename}_LIBRARY_RELEASE} )
+        ENDIF(CMAKE_CONFIGURATION_TYPES OR CMAKE_BUILD_TYPE)
+        SET(QT_${basename}_LIBRARIES       optimized ${QT_${basename}_LIBRARY_RELEASE} debug ${QT_${basename}_LIBRARY_DEBUG})
+      ENDIF (QT_${basename}_LIBRARY_DEBUG AND QT_${basename}_LIBRARY_RELEASE)
+
+      SET(QT_${basename}_LIBRARY ${QT_${basename}_LIBRARY} CACHE FILEPATH &quot;The Qt ${basename} library&quot;)
+
+      IF (QT_${basename}_LIBRARY)
+        SET(QT_${basename}_FOUND 1)
+      ENDIF (QT_${basename}_LIBRARY)
+
+      #add the include directory to QT_INCLUDES
+      SET(QT_INCLUDES ${QT_INCLUDES} &quot;${QT_${basename}_INCLUDE_DIR}&quot;)
+    ENDIF (QT_${basename}_INCLUDE_DIR )
+
+    # Make variables changeble to the advanced user
+    MARK_AS_ADVANCED(QT_${basename}_LIBRARY QT_${basename}_LIBRARY_RELEASE QT_${basename}_LIBRARY_DEBUG QT_${basename}_INCLUDE_DIR)
+  ENDMACRO (_QT4_ADJUST_LIB_VARS)
+
+  IF(WIN32)
+    # there is no include for qtmain but adjust macro needs it set
+    SET(QT_QTMAIN_INCLUDE_DIR 1)
+     _QT4_ADJUST_LIB_VARS(QTMAIN)
+    SET(QT_QTMAIN_INCLUDE_DIR )
+  ENDIF(WIN32)
+
+
+  _QT4_ADJUST_LIB_VARS(QTCORE)
+  _QT4_ADJUST_LIB_VARS(QTGUI)
+  _QT4_ADJUST_LIB_VARS(QT3SUPPORT)
+  _QT4_ADJUST_LIB_VARS(QTASSISTANT)
+  _QT4_ADJUST_LIB_VARS(QTDESIGNER)
+  IF(Q_WS_X11)
+    _QT4_ADJUST_LIB_VARS(QTMOTIF)
+  ENDIF(Q_WS_X11)
+  _QT4_ADJUST_LIB_VARS(QTNETWORK)
+  _QT4_ADJUST_LIB_VARS(QTNSPLUGIN)
+  _QT4_ADJUST_LIB_VARS(QTOPENGL)
+  _QT4_ADJUST_LIB_VARS(QTSQL)
+  _QT4_ADJUST_LIB_VARS(QTXML)
+  _QT4_ADJUST_LIB_VARS(QTSVG)
+  _QT4_ADJUST_LIB_VARS(QTUITOOLS)
+  _QT4_ADJUST_LIB_VARS(QTTEST)
+
+
+
+  #######################################
+  #
+  #       Check the executables of Qt 
+  #          ( moc, uic, rcc )
+  #
+  #######################################
+
+
+   # find moc and uic using qmake
+  QT_QUERY_QMAKE(QT_MOC_EXECUTABLE_INTERNAL &quot;QMAKE_MOC&quot;)
+  QT_QUERY_QMAKE(QT_UIC_EXECUTABLE_INTERNAL &quot;QMAKE_UIC&quot;)
+
+   FILE(TO_CMAKE_PATH 
+     &quot;${QT_MOC_EXECUTABLE_INTERNAL}&quot; QT_MOC_EXECUTABLE_INTERNAL)
+   FILE(TO_CMAKE_PATH 
+     &quot;${QT_UIC_EXECUTABLE_INTERNAL}&quot; QT_UIC_EXECUTABLE_INTERNAL)
+
+   SET(QT_MOC_EXECUTABLE 
+     ${QT_MOC_EXECUTABLE_INTERNAL} CACHE FILEPATH &quot;The moc executable&quot;)
+   SET(QT_UIC_EXECUTABLE 
+     ${QT_UIC_EXECUTABLE_INTERNAL} CACHE FILEPATH &quot;The uic executable&quot;)
+
+  FIND_PROGRAM(QT_UIC3_EXECUTABLE
+    NAMES uic3
+    PATHS ${QT_BINARY_DIR}
+    NO_DEFAULT_PATH
+    )
+
+  FIND_PROGRAM(QT_RCC_EXECUTABLE 
+    NAMES rcc
+    PATHS ${QT_BINARY_DIR}
+    NO_DEFAULT_PATH
+    )
+
+  IF (QT_MOC_EXECUTABLE)
+     SET(QT_WRAP_CPP &quot;YES&quot;)
+  ENDIF (QT_MOC_EXECUTABLE)
+
+  IF (QT_UIC_EXECUTABLE)
+     SET(QT_WRAP_UI &quot;YES&quot;)
+  ENDIF (QT_UIC_EXECUTABLE)
+
+
+
+  MARK_AS_ADVANCED( QT_UIC_EXECUTABLE QT_UIC3_EXECUTABLE QT_MOC_EXECUTABLE QT_RCC_EXECUTABLE )
+
+  ######################################
+  #
+  #       Macros for building Qt files
+  #
+  ######################################
+
+  MACRO (QT4_GET_MOC_INC_DIRS _moc_INC_DIRS)
+     SET(${_moc_INC_DIRS})
+     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
+
+     FOREACH(_current ${_inc_DIRS})
+        SET(${_moc_INC_DIRS} ${${_moc_INC_DIRS}} &quot;-I&quot; ${_current})
+     ENDFOREACH(_current ${_inc_DIRS})
+  ENDMACRO(QT4_GET_MOC_INC_DIRS)
+
+
+  MACRO (QT4_GENERATE_MOC infile outfile )
+  # get include dirs
+     QT4_GET_MOC_INC_DIRS(moc_includes)
+
+     GET_FILENAME_COMPONENT(infile ${infile} ABSOLUTE)
+
+     ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_MOC_EXECUTABLE}
+        ARGS ${moc_includes} -o ${outfile} ${infile}
+        DEPENDS ${infile})
+
+     MACRO_ADD_FILE_DEPENDENCIES(${infile} ${outfile})
+  ENDMACRO (QT4_GENERATE_MOC)
+
+
+  # QT4_WRAP_CPP(outfiles inputfile ... )
+  # TODO  perhaps add support for -D, -U and other minor options
+
+  MACRO (QT4_WRAP_CPP outfiles )
+    # get include dirs
+    QT4_GET_MOC_INC_DIRS(moc_includes)
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
+      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
+
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/moc_${outfile}.cxx)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_MOC_EXECUTABLE}
+        ARGS ${moc_includes} -o ${outfile} ${it}
+        DEPENDS ${it})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH(it)
+
+  ENDMACRO (QT4_WRAP_CPP)
+
+
+  # QT4_WRAP_UI(outfiles inputfile ... )
+
+  MACRO (QT4_WRAP_UI outfiles )
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_UIC_EXECUTABLE}
+        ARGS -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_WRAP_UI)
+
+
+  # QT4_ADD_RESOURCE(outfiles inputfile ... )
+  # TODO  perhaps consider adding support for compression and root options to rcc
+
+  MACRO (QT4_ADD_RESOURCES outfiles )
+
+    FOREACH (it ${ARGN})
+      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
+      #  parse file for dependencies
+      FILE(READ &quot;${infile}&quot; _RC_FILE_CONTENTS)
+      STRING(REGEX MATCHALL &quot;&lt;file&gt;[^&lt;]*&quot; _RC_FILES &quot;${_RC_FILE_CONTENTS}&quot;)
+      SET(_RC_DEPENDS)
+      FOREACH(_RC_FILE ${_RC_FILES})
+        STRING(REGEX REPLACE &quot;^&lt;file&gt;&quot; &quot;&quot; _RC_FILE &quot;${_RC_FILE}&quot;)
+        SET(_RC_DEPENDS ${_RC_DEPENDS} &quot;${rc_path}/${_RC_FILE}&quot;)
+      ENDFOREACH(_RC_FILE)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_RCC_EXECUTABLE}
+        ARGS -name ${outfilename} -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile}
+        DEPENDS ${_RC_DEPENDS})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_ADD_RESOURCES)
+
+
+   MACRO(QT4_AUTOMOC)
+      QT4_GET_MOC_INC_DIRS(_moc_INCS)
+
+      SET(_matching_FILES )
+      FOREACH (_current_FILE ${ARGN})
+
+         GET_FILENAME_COMPONENT(_abs_FILE ${_current_FILE} ABSOLUTE)
+         # if &quot;SKIP_AUTOMOC&quot; is set to true, we will not handle this file here.
+         # here. this is required to make bouic work correctly:
+         # we need to add generated .cpp files to the sources (to compile them),
+         # but we cannot let automoc handle them, as the .cpp files don't exist yet when
+         # cmake is run for the very first time on them -&gt; however the .cpp files might
+         # exist at a later run. at that time we need to skip them, so that we don't add two
+         # different rules for the same moc file
+         GET_SOURCE_FILE_PROPERTY(_skip ${_abs_FILE} SKIP_AUTOMOC)
+
+         IF ( NOT _skip AND EXISTS ${_abs_FILE} )
+
+            FILE(READ ${_abs_FILE} _contents)
+
+            GET_FILENAME_COMPONENT(_abs_PATH ${_abs_FILE} PATH)
+
+            STRING(REGEX MATCHALL &quot;#include +[^ ]+\\.moc[\&quot;&gt;]&quot; _match &quot;${_contents}&quot;)
+            IF(_match)
+               FOREACH (_current_MOC_INC ${_match})
+                  STRING(REGEX MATCH &quot;[^ &lt;\&quot;]+\\.moc&quot; _current_MOC &quot;${_current_MOC_INC}&quot;)
+
+                  GET_filename_component(_basename ${_current_MOC} NAME_WE)
+   #               SET(_header ${CMAKE_CURRENT_SOURCE_DIR}/${_basename}.h)
+                  SET(_header ${_abs_PATH}/${_basename}.h)
+                  SET(_moc    ${CMAKE_CURRENT_BINARY_DIR}/${_current_MOC})
+                  ADD_CUSTOM_COMMAND(OUTPUT ${_moc}
+                     COMMAND ${QT_MOC_EXECUTABLE}
+                     ARGS ${_moc_INCS} ${_header} -o ${_moc}
+                     DEPENDS ${_header}
+                  )
+
+                  MACRO_ADD_FILE_DEPENDENCIES(${_abs_FILE} ${_moc})
+               ENDFOREACH (_current_MOC_INC)
+            ENDIF(_match)
+         ENDIF ( NOT _skip AND EXISTS ${_abs_FILE} )
+      ENDFOREACH (_current_FILE)
+   ENDMACRO(QT4_AUTOMOC)
+
+
+
+  ######################################
+  #
+  #       decide if Qt got found
+  #
+  ######################################
+
+  # if the includes,libraries,moc,uic and rcc are found then we have it
+  IF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
+    SET( QT4_FOUND &quot;YES&quot; )
+    IF( NOT Qt4_FIND_QUIETLY)
+      MESSAGE(STATUS &quot;Found Qt-Version ${QTVERSION}&quot;)
+    ENDIF( NOT Qt4_FIND_QUIETLY)
+  ELSE( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND QT_RCC_EXECUTABLE)
+    SET( QT4_FOUND &quot;NO&quot;)
+    IF( Qt4_FIND_REQUIRED)
+      MESSAGE( FATAL_ERROR &quot;Qt libraries, includes, moc, uic or/and rcc NOT found!&quot;)
+    ENDIF( Qt4_FIND_REQUIRED)
+  ENDIF( QT_LIBRARY_DIR AND QT_INCLUDE_DIR AND QT_MOC_EXECUTABLE AND QT_UIC_EXECUTABLE AND  QT_RCC_EXECUTABLE)
+  SET(QT_FOUND ${QT4_FOUND})
+
+  #######################################
+  #
+  #       Qt configuration
+  #
+  #######################################
+  IF(EXISTS &quot;${QT_MKSPECS_DIR}/qconfig.pri&quot;)
+    FILE(READ ${QT_MKSPECS_DIR}/qconfig.pri _qconfig_FILE_contents)
+    STRING(REGEX MATCH &quot;QT_CONFIG[^\n]+&quot; QT_QCONFIG ${_qconfig_FILE_contents})
+    STRING(REGEX MATCH &quot;CONFIG[^\n]+&quot; QT_CONFIG ${_qconfig_FILE_contents})
+  ENDIF(EXISTS &quot;${QT_MKSPECS_DIR}/qconfig.pri&quot;)
+
+
+  ###############################################
+  #
+  #       configuration/system dependent settings  
+  #
+  ###############################################
+
+  SET(QT_GUI_LIB_DEPENDENCIES &quot;&quot;)
+  SET(QT_CORE_LIB_DEPENDENCIES &quot;&quot;)
+  
+  # shared build needs -DQT_SHARED
+  IF(NOT QT_CONFIG MATCHES &quot;static&quot;)
+    # warning currently only qconfig.pri on Windows potentially contains &quot;static&quot;
+    # so QT_SHARED might not get defined properly on Mac/X11 (which seems harmless right now)
+    # Trolltech said they'd consider exporting it for all platforms in future releases.
+    SET(QT_DEFINITIONS ${QT_DEFINITIONS} -DQT_SHARED)
+  ENDIF(NOT QT_CONFIG MATCHES &quot;static&quot;)
+  
+  ## system png
+  IF(QT_QCONFIG MATCHES &quot;system-png&quot;)
+    FIND_LIBRARY(QT_PNG_LIBRARY NAMES png)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_PNG_LIBRARY})
+    MARK_AS_ADVANCED(QT_PNG_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;system-png&quot;)
+  
+  # for X11, get X11 library directory
+  IF(Q_WS_X11)
+    QT_QUERY_QMAKE(QMAKE_LIBDIR_X11 &quot;QMAKE_LIBDIR_X11&quot;)
+  ENDIF(Q_WS_X11)
+
+  ## X11 SM
+  IF(QT_QCONFIG MATCHES &quot;x11sm&quot;)
+    # ask qmake where the x11 libs are
+    FIND_LIBRARY(QT_X11_SM_LIBRARY NAMES SM PATHS ${QMAKE_LIBDIR_X11})
+    FIND_LIBRARY(QT_X11_ICE_LIBRARY NAMES ICE PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_X11_SM_LIBRARY} ${QT_X11_ICE_LIBRARY})
+    MARK_AS_ADVANCED(QT_X11_SM_LIBRARY)
+    MARK_AS_ADVANCED(QT_X11_ICE_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;x11sm&quot;)
+  
+  ## Xi
+  IF(QT_QCONFIG MATCHES &quot;tablet&quot;)
+    FIND_LIBRARY(QT_XI_LIBRARY NAMES Xi PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XI_LIBRARY})
+    MARK_AS_ADVANCED(QT_XI_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;tablet&quot;)
+
+  ## Xrender
+  IF(QT_QCONFIG MATCHES &quot;xrender&quot;)
+    FIND_LIBRARY(QT_XRENDER_LIBRARY NAMES Xrender PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRENDER_LIBRARY})
+    MARK_AS_ADVANCED(QT_XRENDER_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;xrender&quot;)
+  
+  ## Xrandr
+  IF(QT_QCONFIG MATCHES &quot;xrandr&quot;)
+    FIND_LIBRARY(QT_XRANDR_LIBRARY NAMES Xrandr PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XRANDR_LIBRARY})
+    MARK_AS_ADVANCED(QT_XRANDR_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;xrandr&quot;)
+  
+  ## Xcursor
+  IF(QT_QCONFIG MATCHES &quot;xcursor&quot;)
+    FIND_LIBRARY(QT_XCURSOR_LIBRARY NAMES Xcursor PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XCURSOR_LIBRARY})
+    MARK_AS_ADVANCED(QT_XCURSOR_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;xcursor&quot;)
+  
+  ## Xinerama
+  IF(QT_QCONFIG MATCHES &quot;xinerama&quot;)
+    FIND_LIBRARY(QT_XINERAMA_LIBRARY NAMES Xinerama PATHS ${QMAKE_LIBDIR_X11})
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_XINERAMA_LIBRARY})
+    MARK_AS_ADVANCED(QT_XINERAMA_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;xinerama&quot;)
+  
+  ## system-freetype
+  IF(QT_QCONFIG MATCHES &quot;system-freetype&quot;)
+    FIND_LIBRARY(QT_FREETYPE_LIBRARY NAMES freetype)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FREETYPE_LIBRARY})
+    MARK_AS_ADVANCED(QT_FREETYPE_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;system-freetype&quot;)
+  
+  ## fontconfig
+  IF(QT_QCONFIG MATCHES &quot;fontconfig&quot;)
+    FIND_LIBRARY(QT_FONTCONFIG_LIBRARY NAMES fontconfig)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${QT_FONTCONFIG_LIBRARY})
+    MARK_AS_ADVANCED(QT_FONTCONFIG_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;fontconfig&quot;)
+  
+  ## system-zlib
+  IF(QT_QCONFIG MATCHES &quot;system-zlib&quot;)
+    FIND_LIBRARY(QT_ZLIB_LIBRARY NAMES z)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_ZLIB_LIBRARY})
+    MARK_AS_ADVANCED(QT_ZLIB_LIBRARY)
+  ENDIF(QT_QCONFIG MATCHES &quot;system-zlib&quot;)
+
+  IF(Q_WS_X11)
+    # X11 libraries Qt absolutely depends on
+    QT_QUERY_QMAKE(QT_LIBS_X11 &quot;QMAKE_LIBS_X11&quot;)
+    SEPARATE_ARGUMENTS(QT_LIBS_X11)
+    FOREACH(QT_X11_LIB ${QT_LIBS_X11})
+      STRING(REGEX REPLACE &quot;-l&quot; &quot;&quot; QT_X11_LIB &quot;${QT_X11_LIB}&quot;)
+      SET(QT_TMP_STR &quot;QT_X11_${QT_X11_LIB}_LIBRARY&quot;)
+      FIND_LIBRARY(${QT_TMP_STR} NAMES &quot;${QT_X11_LIB}&quot; PATHS ${QMAKE_LIBDIR_X11})
+      SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} ${${QT_TMP_STR}})
+    ENDFOREACH(QT_X11_LIB)
+
+    QT_QUERY_QMAKE(QT_LIBS_THREAD &quot;QMAKE_LIBS_THREAD&quot;)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QT_LIBS_THREAD})
+    
+    QT_QUERY_QMAKE(QMAKE_LIBS_DYNLOAD &quot;QMAKE_LIBS_DYNLOAD&quot;)
+    SET (QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} ${QMAKE_LIBS_DYNLOAD})
+
+  ENDIF(Q_WS_X11)
+
+  IF(Q_WS_WIN)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} Imm32 Winmm)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} Ws2_32)
+  ENDIF(Q_WS_WIN)
+  
+  IF(Q_WS_MAC)
+    SET(QT_GUI_LIB_DEPENDENCIES ${QT_GUI_LIB_DEPENDENCIES} &quot;-framework Carbon&quot; &quot;-framework QuickTime&quot;)
+    SET(QT_CORE_LIB_DEPENDENCIES ${QT_CORE_LIB_DEPENDENCIES} &quot;-framework ApplicationServices&quot;)
+  ENDIF(Q_WS_MAC)
+
+  #######################################
+  #
+  #       compatibility settings 
+  #
+  #######################################
+  # Backwards compatibility for CMake1.4 and 1.2
+  SET (QT_MOC_EXE ${QT_MOC_EXECUTABLE} )
+  SET (QT_UIC_EXE ${QT_UIC_EXECUTABLE} )
+
+  SET( QT_QT_LIBRARY &quot;&quot;)
+
+ELSE(QT4_QMAKE_FOUND)
+
+   IF(Qt4_FIND_REQUIRED)
+      IF(QT4_INSTALLED_VERSION_TOO_OLD)
+         MESSAGE(FATAL_ERROR &quot;The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required&quot;)
+      ELSE(QT4_INSTALLED_VERSION_TOO_OLD)
+     MESSAGE( FATAL_ERROR &quot;Qt qmake not found!&quot;)
+      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD)
+   ELSE(Qt4_FIND_REQUIRED)
+      IF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
+         MESSAGE(STATUS &quot;The installed Qt version ${QTVERSION} is too old, at least version ${QT_MIN_VERSION} is required&quot;)
+      ENDIF(QT4_INSTALLED_VERSION_TOO_OLD AND NOT Qt4_FIND_QUIETLY)
+   ENDIF(Qt4_FIND_REQUIRED)
+ 
+ENDIF (QT4_QMAKE_FOUND)
+

Modified: branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindSubversion.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,125 +1,144 @@
-# - Extract information from a subversion working copy
-# The module defines the following variables:
-#  Subversion_SVN_EXECUTABLE - path to svn command line client
-#  Subversion_VERSION_SVN - version of svn command line client
-#  Subversion_FOUND - true if the command line client was found
-# If the command line client executable is found the macro
-#  Subversion_WC_INFO(&lt;dir&gt; &lt;var-prefix&gt;)
-# is defined to extract information of a subversion working copy at
-# a given location. The macro defines the following variables:
-#  &lt;var-prefix&gt;_WC_URL - url of the repository (at &lt;dir&gt;)
-#  &lt;var-prefix&gt;_WC_ROOT - root url of the repository
-#  &lt;var-prefix&gt;_WC_REVISION - current revision
-#  &lt;var-prefix&gt;_WC_LAST_CHANGED_AUTHOR - author of last commit
-#  &lt;var-prefix&gt;_WC_LAST_CHANGED_DATE - date of last commit
-#  &lt;var-prefix&gt;_WC_LAST_CHANGED_REV - revision of last commit
-#  &lt;var-prefix&gt;_WC_LAST_CHANGED_LOG - last log of base revision
-#  &lt;var-prefix&gt;_WC_INFO - output of command `svn info &lt;dir&gt;'
-# Example usage:
-#  FIND_PACKAGE(Subversion)
-#  IF(Subversion_FOUND)
-#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-#    MESSAGE(&quot;Current revision is ${Project_WC_REVISION}&quot;)
-#  ENDIF(Subversion_FOUND)
-
-# Copyright (c) 2006, Tristan Carel
-# All rights reserved.
-# Redistribution and use in source and binary forms, with or without
-# modification, are permitted provided that the following conditions are met:
-#
-#     * Redistributions of source code must retain the above copyright
-#       notice, this list of conditions and the following disclaimer.
-#     * Redistributions in binary form must reproduce the above copyright
-#       notice, this list of conditions and the following disclaimer in the
-#       documentation and/or other materials provided with the distribution.
-#     * Neither the name of the University of California, Berkeley nor the
-#       names of its contributors may be used to endorse or promote products
-#       derived from this software without specific prior written permission.
-#
-# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
-# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
-# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
-# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
-# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
-# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
-# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
-# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
-
-SET(Subversion_FOUND FALSE)
-SET(Subversion_SVN_FOUND FALSE)
-
-FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
-  DOC &quot;subversion command line client&quot;)
-MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
-
-IF(Subversion_SVN_EXECUTABLE)
-  SET(Subversion_SVN_FOUND TRUE)
-  SET(Subversion_FOUND TRUE)
-
-  MACRO(Subversion_WC_INFO dir prefix)
-    SET(MESSAGES_ENV_VAR $ENV{LC_MESSAGES})
-    SET(ENV{LC_MESSAGES} &quot;C&quot;)
-
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_VERSION_SVN
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS &quot;Getting svn version from ${dir}&quot;)
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
-      WORKING_DIRECTORY ${dir}
-      OUTPUT_VARIABLE ${prefix}_WC_INFO
-      ERROR_VARIABLE Subversion_svn_info_error
-      RESULT_VARIABLE Subversion_svn_info_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
-      MESSAGE(SEND_ERROR &quot;Command \&quot;${Subversion_SVN_EXECUTABLE} info ${dir}\&quot; failed with output:\n${Subversion_svn_info_error}&quot;)
-    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-      STRING(REGEX REPLACE &quot;^(.*\n)?svn, version ([.0-9]+).*&quot;
-        &quot;\\2&quot; Subversion_VERSION_SVN &quot;${Subversion_VERSION_SVN}&quot;)
-      STRING(REGEX REPLACE &quot;^(.*\n)?URL: ([^\n]+).*&quot;
-        &quot;\\2&quot; ${prefix}_WC_URL &quot;${${prefix}_WC_INFO}&quot;)
-      STRING(REGEX REPLACE &quot;^(.*\n)?Revision: ([^\n]+).*&quot;
-        &quot;\\2&quot; ${prefix}_WC_REVISION &quot;${${prefix}_WC_INFO}&quot;)
-      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Author: ([^\n]+).*&quot;
-        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_AUTHOR &quot;${${prefix}_WC_INFO}&quot;)
-      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Rev: ([^\n]+).*&quot;
-        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_REV &quot;${${prefix}_WC_INFO}&quot;)
-      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Date: ([^\n]+).*&quot;
-        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_DATE &quot;${${prefix}_WC_INFO}&quot;)
-
-    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-    EXECUTE_PROCESS(COMMAND
-      ${Subversion_SVN_EXECUTABLE} log -r BASE .
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
-      ERROR_VARIABLE Subversion_svn_log_error
-      RESULT_VARIABLE Subversion_svn_log_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
-      MESSAGE(SEND_ERROR &quot;Command \&quot;${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\&quot; failed with output:\n${Subversion_svn_log_error}&quot;)
-    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
-
-    SET($ENV{LC_MESSAGES} MESSAGES_ENV_VAR)
-  ENDMACRO(Subversion_WC_INFO)
-
-ENDIF(Subversion_SVN_EXECUTABLE)
-
-IF(NOT Subversion_FOUND)
-  IF(NOT Subversion_FIND_QUIETLY)
-    MESSAGE(STATUS &quot;Subversion was not found.&quot;)
-  ELSE(NOT Subversion_FIND_QUIETLY)
-    IF(Subversion_FIND_REQUIRED)
-      MESSAGE(FATAL_ERROR &quot;Subversion was not found.&quot;)
-    ENDIF(Subversion_FIND_REQUIRED)
-  ENDIF(NOT Subversion_FIND_QUIETLY)
-ENDIF(NOT Subversion_FOUND)
-
-# FindSubversion.cmake ends here.
+# - Extract information from a subversion working copy
+# The module defines the following variables:
+#  Subversion_SVN_EXECUTABLE - path to svn command line client
+#  Subversion_VERSION_SVN - version of svn command line client
+#  Subversion_FOUND - true if the command line client was found
+# If the command line client executable is found the macro
+#  Subversion_WC_INFO(&lt;dir&gt; &lt;var-prefix&gt;)
+# is defined to extract information of a subversion working copy at
+# a given location. The macro defines the following variables:
+#  &lt;var-prefix&gt;_WC_URL - url of the repository (at &lt;dir&gt;)
+#  &lt;var-prefix&gt;_WC_ROOT - root url of the repository
+#  &lt;var-prefix&gt;_WC_REVISION - current revision
+#  &lt;var-prefix&gt;_WC_LAST_CHANGED_AUTHOR - author of last commit
+#  &lt;var-prefix&gt;_WC_LAST_CHANGED_DATE - date of last commit
+#  &lt;var-prefix&gt;_WC_LAST_CHANGED_REV - revision of last commit
+#  &lt;var-prefix&gt;_WC_LAST_CHANGED_LOG - last log of base revision
+#  &lt;var-prefix&gt;_WC_INFO - output of command `svn info &lt;dir&gt;'
+# Example usage:
+#  FIND_PACKAGE(Subversion)
+#  IF(Subversion_FOUND)
+#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+#    MESSAGE(&quot;Current revision is ${Project_WC_REVISION}&quot;)
+#  ENDIF(Subversion_FOUND)
+
+# Copyright (c) 2006, Tristan Carel
+# All rights reserved.
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+#     * Redistributions of source code must retain the above copyright
+#       notice, this list of conditions and the following disclaimer.
+#     * Redistributions in binary form must reproduce the above copyright
+#       notice, this list of conditions and the following disclaimer in the
+#       documentation and/or other materials provided with the distribution.
+#     * Neither the name of the University of California, Berkeley nor the
+#       names of its contributors may be used to endorse or promote products
+#       derived from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
+# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
+
+SET(Subversion_FOUND FALSE)
+SET(Subversion_SVN_FOUND FALSE)
+
+FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
+  DOC &quot;subversion command line client&quot;)
+MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
+
+IF(Subversion_SVN_EXECUTABLE)
+  SET(Subversion_SVN_FOUND TRUE)
+  SET(Subversion_FOUND TRUE)
+
+  MACRO(Subversion_WC_INFO dir prefix)
+    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_VERSION_SVN
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+    MESSAGE(STATUS &quot;Getting svn version from ${dir}&quot;)
+
+# Old svn info call
+#    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
+#      WORKING_DIRECTORY ${dir}
+#      OUTPUT_VARIABLE ${prefix}_WC_INFO
+#      ERROR_VARIABLE Subversion_svn_info_error
+#      RESULT_VARIABLE Subversion_svn_info_result
+#      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+# New svn info --xml call
+      EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info --xml . 
+        WORKING_DIRECTORY ${dir}
+        OUTPUT_VARIABLE ${prefix}_WC_INFO_XML
+        ERROR_VARIABLE Subversion_svn_info_error
+        RESULT_VARIABLE Subversion_svn_info_result
+        OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
+      MESSAGE(SEND_ERROR &quot;Command \&quot;${Subversion_SVN_EXECUTABLE} info ${dir}\&quot; failed with output:\n${Subversion_svn_info_error}&quot;)
+    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+      STRING(REGEX REPLACE &quot;^(.*\n)?svn, version ([.0-9]+).*&quot;
+        &quot;\\2&quot; Subversion_VERSION_SVN &quot;${Subversion_VERSION_SVN}&quot;)
+
+# Old REGEX REPLACE tests, working with non licalized versions of svn :
+#      STRING(REGEX REPLACE &quot;^(.*\n)?URL: ([^\n]+).*&quot;
+#        &quot;\\2&quot; ${prefix}_WC_URL &quot;${${prefix}_WC_INFO}&quot;)
+#      STRING(REGEX REPLACE &quot;^(.*\n)?Revision: ([^\n]+).*&quot;
+#        &quot;\\2&quot; ${prefix}_WC_REVISION &quot;${${prefix}_WC_INFO}&quot;)
+#      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Author: ([^\n]+).*&quot;
+#        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_AUTHOR &quot;${${prefix}_WC_INFO}&quot;)
+#      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Rev: ([^\n]+).*&quot;
+#        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_REV &quot;${${prefix}_WC_INFO}&quot;)
+#      STRING(REGEX REPLACE &quot;^(.*\n)?Last Changed Date: ([^\n]+).*&quot;
+#        &quot;\\2&quot; ${prefix}_WC_LAST_CHANGED_DATE &quot;${${prefix}_WC_INFO}&quot;)
+
+# New REGEX REPLACE tests, working with the xml output on all versions :
+      STRING(REGEX REPLACE &quot;(.*)&lt;url&gt;(.*)&lt;/url&gt;(.*)&quot;
+        &quot;\\2&quot; ${prefix}_WC_URL &quot;${${prefix}_WC_INFO_XML}&quot;)
+      STRING(REGEX REPLACE &quot;(.*)&lt;entry(.*)revision=\&quot;(.*)\&quot;&gt;(.*)&quot;
+        &quot;\\3&quot; ${prefix}_WC_REVISION &quot;${${prefix}_WC_INFO_XML}&quot;)
+      STRING(REGEX REPLACE &quot;(.*)&lt;commit(.*)revision=\&quot;(.*)\&quot;&gt;(.*)&lt;author&gt;(.*)&lt;/author&gt;(.*)&lt;date&gt;(.*)&lt;/date&gt;(.*)&lt;/commit&gt;(.*)&quot;
+        &quot;\\5&quot; ${prefix}_WC_LAST_CHANGED_AUTHOR &quot;${${prefix}_WC_INFO_XML}&quot;)
+      STRING(REGEX REPLACE &quot;(.*)&lt;commit(.*)revision=\&quot;(.*)\&quot;&gt;(.*)&lt;author&gt;(.*)&lt;/author&gt;(.*)&lt;date&gt;(.*)&lt;/date&gt;(.*)&lt;/commit&gt;(.*)&quot;
+        &quot;\\3&quot; ${prefix}_WC_LAST_CHANGED_REV &quot;${${prefix}_WC_INFO_XML}&quot;)
+      STRING(REGEX REPLACE &quot;(.*)&lt;commit(.*)revision=\&quot;(.*)\&quot;&gt;(.*)&lt;author&gt;(.*)&lt;/author&gt;(.*)&lt;date&gt;(.*)&lt;/date&gt;(.*)&lt;/commit&gt;(.*)&quot;
+        &quot;\\7&quot; ${prefix}_WC_LAST_CHANGED_DATE &quot;${${prefix}_WC_INFO_XML}&quot;)
+
+    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+    EXECUTE_PROCESS(COMMAND
+      ${Subversion_SVN_EXECUTABLE} log -r BASE .
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
+      ERROR_VARIABLE Subversion_svn_log_error
+      RESULT_VARIABLE Subversion_svn_log_result
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
+      MESSAGE(SEND_ERROR &quot;Command \&quot;${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\&quot; failed with output:\n${Subversion_svn_log_error}&quot;)
+    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
+  ENDMACRO(Subversion_WC_INFO)
+
+ENDIF(Subversion_SVN_EXECUTABLE)
+
+IF(NOT Subversion_FOUND)
+  IF(NOT Subversion_FIND_QUIETLY)
+    MESSAGE(STATUS &quot;Subversion was not found.&quot;)
+  ELSE(NOT Subversion_FIND_QUIETLY)
+    IF(Subversion_FIND_REQUIRED)
+      MESSAGE(FATAL_ERROR &quot;Subversion was not found.&quot;)
+    ENDIF(Subversion_FIND_REQUIRED)
+  ENDIF(NOT Subversion_FIND_QUIETLY)
+ENDIF(NOT Subversion_FOUND)
+
+# FindSubversion.cmake ends here.

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindZLIB.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,47 @@
+# - Find zlib
+# Find the native ZLIB includes and library
+#
+#  ZLIB_INCLUDE_DIR - where to find zlib.h, etc.
+#  ZLIB_LIBRARIES   - List of libraries when using zlib.
+#  ZLIB_FOUND       - True if zlib found.
+
+
+IF (ZLIB_INCLUDE_DIR)
+  # Already in cache, be silent
+  SET(ZLIB_FIND_QUIETLY TRUE)
+ENDIF (ZLIB_INCLUDE_DIR)
+
+FIND_PATH(ZLIB_INCLUDE_DIR zlib.h
+  /usr/local/include
+  /usr/include
+)
+
+SET(ZLIB_NAMES z zlib zdll)
+FIND_LIBRARY(ZLIB_LIBRARY
+  NAMES ${ZLIB_NAMES}
+  PATHS /usr/lib /usr/local/lib
+)
+
+IF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+   SET(ZLIB_FOUND TRUE)
+    SET( ZLIB_LIBRARIES ${ZLIB_LIBRARY} )
+ELSE (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+   SET(ZLIB_FOUND FALSE)
+   SET( ZLIB_LIBRARIES )
+ENDIF (ZLIB_INCLUDE_DIR AND ZLIB_LIBRARY)
+
+IF (ZLIB_FOUND)
+   IF (NOT ZLIB_FIND_QUIETLY)
+      MESSAGE(STATUS &quot;Found ZLIB: ${ZLIB_LIBRARY}&quot;)
+   ENDIF (NOT ZLIB_FIND_QUIETLY)
+ELSE (ZLIB_FOUND)
+   IF (ZLIB_FIND_REQUIRED)
+      MESSAGE(STATUS &quot;Looked for Z libraries named ${ZLIBS_NAMES}.&quot;)
+      MESSAGE(FATAL_ERROR &quot;Could NOT find z library&quot;)
+   ENDIF (ZLIB_FIND_REQUIRED)
+ENDIF (ZLIB_FOUND)
+
+MARK_AS_ADVANCED(
+  ZLIB_LIBRARY
+  ZLIB_INCLUDE_DIR
+  )

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/MacroEnsureOutOfSourceBuild.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,16 +0,0 @@
-# - MACRO_ENSURE_OUT_OF_SOURCE_BUILD(&lt;errorMessage&gt;)
-# MACRO_ENSURE_OUT_OF_SOURCE_BUILD(&lt;errorMessage&gt;)
-
-# Copyright (c) 2006, Alexander Neundorf, &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">neundorf at kde.org</A>&gt;
-#
-# Redistribution and use is allowed according to the terms of the BSD license.
-# For details see the accompanying COPYING-CMAKE-SCRIPTS file.
-
-MACRO (MACRO_ENSURE_OUT_OF_SOURCE_BUILD _errorMessage)
-
-   STRING(COMPARE EQUAL &quot;${CMAKE_SOURCE_DIR}&quot; &quot;${CMAKE_BINARY_DIR}&quot; insource)
-      IF(insource)
-            MESSAGE(FATAL_ERROR &quot;${_errorMessage}&quot;)
-       ENDIF(insource)
-
-ENDMACRO (MACRO_ENSURE_OUT_OF_SOURCE_BUILD)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -4,6 +4,7 @@
     IF(NOT XSLTPROC_EXECUTABLE AND NOT XSLTPROC_NOT_FOUND)
         SET(XSLTPROC_NAME &quot;xsltproc&quot;)
         FIND_PROGRAM(XSLTPROC_EXECUTABLE ${XSLTPROC_NAME})
+        MARK_AS_ADVANCED(XSLTPROC_EXECUTABLE)
 
         IF (NOT XSLTPROC_EXECUTABLE)
           MESSAGE(STATUS &quot;WARNING: ${XSLTPROC_NAME} not found - ts files can't be processed&quot;)

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioCodecLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,199 @@
+########################################
+# Aften
+########################################
+OPTION(AFTEN &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for Aften&quot;)
+MESSAGE(STATUS &quot;******************&quot;)
+
+IF (AFTEN)
+	FIND_HEADER_AND_LIB(AFTEN aften/aften.h aften aften_encode_init)
+	PRINT_LIBRARY_INFO(&quot;Aften&quot; AFTEN_FOUND &quot;${AFTEN_INCLUDE_DIR}&quot; &quot;${AFTEN_LIBRARY_DIR}&quot;)
+
+	IF (AFTEN_FOUND)
+		SET(USE_AFTEN 1)
+		
+		IF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
+			TRY_RUN(AFTEN_TEST_RUN_RESULT
+				AFTEN_TEST_COMPILE_RESULT
+				${CMAKE_BINARY_DIR}
+				&quot;${CMAKE_SOURCE_DIR}/cmake_compile_check/aften_check.cpp&quot;
+				CMAKE_FLAGS -DLINK_LIBRARIES=${AFTEN_LIBRARY_DIR})
+		ENDIF (NOT DEFINED AFTEN_TEST_RUN_RESULT)
+
+		IF (AFTEN_TEST_RUN_RESULT EQUAL 8)
+			MESSAGE(STATUS &quot;  version: 0.0.8&quot;)
+			SET(USE_AFTEN_08 1)
+		ELSEIF (AFTEN_TEST_RUN_RESULT EQUAL 7)
+			MESSAGE(STATUS &quot;  version: 0.07&quot;)
+			SET(USE_AFTEN_07 1)
+		ELSE (AFTEN_TEST_RUN_RESULT EQUAL 8)
+			MESSAGE(STATUS &quot;Warning: Unable to determine Aften version - support for Aften will be turned off&quot;)
+			SET(USE_AFTEN 0)
+		ENDIF (AFTEN_TEST_RUN_RESULT EQUAL 8)
+	ENDIF (AFTEN_FOUND)
+ELSE (AFTEN)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (AFTEN)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# amrnb
+########################################
+OPTION(AMRNB &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for amrnb&quot;)
+MESSAGE(STATUS &quot;******************&quot;)
+
+IF (AMRNB)
+	IF (LATE_BINDING)
+		FIND_HEADER_AND_LIB(AMRNB amrnb/interf_dec.h)
+	ELSE (LATE_BINDING)
+		FIND_HEADER_AND_LIB(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode)
+	ENDIF (LATE_BINDING)
+
+	PRINT_LIBRARY_INFO(&quot;amrnb&quot; AMRNB_FOUND &quot;${AMRNB_INCLUDE_DIR}&quot; &quot;${AMRNB_LIBRARY_DIR}&quot;)
+	
+	IF (AMRNB_FOUND)
+		SET(USE_AMR_NB 1)
+		SET(CONFIG_AMR_NB 1)
+	ENDIF (AMRNB_FOUND)
+ELSE (AMRNB)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (AMRNB)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# LAME
+########################################
+OPTION(LAME &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for LAME&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (LAME)
+	FIND_HEADER_AND_LIB(LAME lame/lame.h mp3lame lame_init)
+	PRINT_LIBRARY_INFO(&quot;LAME&quot; LAME_FOUND &quot;${LAME_INCLUDE_DIR}&quot; &quot;${LAME_LIBRARY_DIR}&quot;)
+	
+	IF (LAME_FOUND)
+		SET(HAVE_LIBMP3LAME 1)
+	ENDIF (LAME_FOUND)
+ELSE (LAME)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (LAME)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# libdca
+########################################
+OPTION(LIBDCA &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for libdca&quot;)
+MESSAGE(STATUS &quot;*******************&quot;)
+
+IF (LIBDCA)
+	IF (USE_LATE_BINDING)
+		FIND_HEADER_AND_LIB(LIBDCA dts.h)
+	ELSE (USE_LATE_BINDING)
+		FIND_HEADER_AND_LIB(LIBDCA dts.h dts dts_init)
+	ENDIF (USE_LATE_BINDING)
+	
+	PRINT_LIBRARY_INFO(&quot;libdca&quot; LIBDCA_FOUND &quot;${LIBDCA_INCLUDE_DIR}&quot; &quot;${LIBDCA_LIBRARY_DIR}&quot;)
+
+	IF (LIBDCA_FOUND)
+		SET(USE_LIBDCA 1)
+	ENDIF (LIBDCA_FOUND)
+ELSE (LIBDCA)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (LIBDCA)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# FAAC
+########################################
+OPTION(FAAC &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for FAAC&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (FAAC)
+	FIND_HEADER_AND_LIB(FAAC faac.h faac faacEncClose)
+	PRINT_LIBRARY_INFO(&quot;FAAC&quot; FAAC_FOUND &quot;${FAAC_INCLUDE_DIR}&quot; &quot;${FAAC_LIBRARY_DIR}&quot;)
+	
+	IF (FAAC_FOUND)
+		SET(USE_FAAC 1)
+	ENDIF (FAAC_FOUND)
+ELSE (FAAC)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (FAAC)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# FAAD
+########################################
+OPTION (FAAD &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for FAAD&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (FAAD)
+	FIND_HEADER_AND_LIB(FAAD faad.h faad)
+
+	IF (FAAD_FOUND)
+		CHECK_LIBRARY_EXISTS(faad faacDecInit FAAD_LIBRARY_DIR FAACDEC_FUNCTION_FOUND)
+
+		IF (NOT FAACDEC_FUNCTION_FOUND)
+			CHECK_LIBRARY_EXISTS(faad NeAACDecInit FAAD_LIBRARY_DIR NEAACDEC_FUNCTION_FOUND)
+
+			IF (NOT NEAACDEC_FUNCTION_FOUND)
+				SET(FAAD_FOUND 0)
+			ENDIF (NOT NEAACDEC_FUNCTION_FOUND)
+		ENDIF (NOT FAACDEC_FUNCTION_FOUND)
+	ENDIF (FAAD_FOUND)
+
+	PRINT_LIBRARY_INFO(&quot;FAAD&quot; FAAD_FOUND &quot;${FAAD_INCLUDE_DIR}&quot; &quot;${FAAD_LIBRARY_DIR}&quot;)
+
+	IF (FAAD_FOUND)
+		SET(USE_FAAD 1)
+
+		CHECK_CFLAGS_REQUIRED(faad_check.cpp &quot;-DOLD_FAAD_PROTO&quot; &quot;${FAAD_INCLUDE_DIR}&quot; &quot;${FAAD_LIBRARY_DIR}&quot; FAAD_CFLAGS_REQUIRED)
+		
+		IF (FAAD_CFLAGS_REQUIRED)
+			SET(OLD_FAAD_PROTO 1)
+		ENDIF (FAAD_CFLAGS_REQUIRED)
+	ENDIF (FAAD_FOUND)
+ELSE (FAAD)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (FAAD)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Vorbis
+########################################
+OPTION(VORBIS &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for Vorbis&quot;)
+MESSAGE(STATUS &quot;*******************&quot;)
+
+IF (VORBIS)
+	FIND_HEADER_AND_LIB(VORBIS vorbis/vorbisenc.h vorbis vorbis_info_init)
+	FIND_HEADER_AND_LIB(VORBISENC &quot;&quot; vorbisenc vorbis_encode_init)
+	
+	IF (VORBIS_FOUND AND VORBISENC_FOUND)
+		SET(USE_VORBIS 1)
+	ELSE (VORBIS_FOUND AND VORBISENC_FOUND)
+		SET(VORBIS_FOUND 0 CACHE INTERNAL &quot;&quot;)
+	ENDIF (VORBIS_FOUND AND VORBISENC_FOUND)
+
+	PRINT_LIBRARY_INFO(&quot;Vorbis&quot; VORBIS_FOUND &quot;${VORBIS_INCLUDE_DIR}&quot; &quot;${VORBIS_LIBRARY_DIR} ${VORBISENC_LIBRARY_DIR}&quot;)
+ELSE (VORBIS)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (VORBIS)
+
+MESSAGE (&quot;&quot;)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckAudioDeviceLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,145 @@
+########################################
+# ALSA
+########################################
+IF (ADM_OS_LINIX)
+	OPTION(ALSA &quot;&quot; ON)
+
+	MESSAGE(STATUS &quot;Checking for ALSA&quot;)
+	MESSAGE(STATUS &quot;*****************&quot;)
+
+	IF (ALSA)
+		FIND_PACKAGE(Alsa)
+
+		IF (ALSA_FOUND)
+			ALSA_VERSION_STRING(alsaVersion)
+
+			MESSAGE(&quot;  version: ${alsaVersion}&quot;)
+			PRINT_LIBRARY_INFO(&quot;ALSA&quot; ALSA_FOUND &quot;${_ALSA_INCLUDE_DIR}&quot; &quot;${ASOUND_LIBRARY}&quot;)
+
+			SET(ALSA_SUPPORT 1)
+		ENDIF (ALSA_FOUND)
+	ELSE (ALSA)
+		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+	ENDIF (ALSA)
+
+	MESSAGE(&quot;&quot;)
+ELSE (ADM_OS_LINUX)
+	SET(ALSA_CAPABLE FALSE)
+ENDIF (ADM_OS_LINIX)
+
+########################################
+# aRts
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(ARTS &quot;&quot; ON)
+	
+	MESSAGE(STATUS &quot;Checking for aRts&quot;)
+	MESSAGE(STATUS &quot;*****************&quot;)
+
+	IF (ARTS)
+		FIND_PACKAGE(FindArts)
+		PRINT_LIBRARY_INFO(&quot;aRts&quot; ARTS_FOUND &quot;${ARTS_CFLAGS}&quot; &quot;${ARTS_LDFLAGS}&quot;)
+		
+		IF (ARTS_FOUND)
+			SET(USE_ARTS 1)
+		ENDIF (ARTS_FOUND)
+	ELSE (ARTS)
+		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+	ENDIF (ARTS)
+		
+	MESSAGE(&quot;&quot;)
+ELSE (ADM_OS_LINUX)
+	SET(ARTS_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# ESD
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(ESD &quot;&quot; ON)
+
+	MESSAGE(STATUS &quot;Checking for ESD&quot;)
+	MESSAGE(STATUS &quot;****************&quot;)
+
+	IF (ESD)
+		FIND_HEADER_AND_LIB(ESD esd.h esd esd_close)
+		PRINT_LIBRARY_INFO(&quot;ESD&quot; ESD_FOUND &quot;${ESD_INCLUDE_DIR}&quot; &quot;${ESD_LIBRARY}&quot;)
+
+		IF (ESD_FOUND)
+			SET(USE_ESD 1)
+		ENDIF (ESD_FOUND)
+	ELSE (ESD)
+		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+	ENDIF (ESD)
+
+	MESSAGE(&quot;&quot;)
+ELSE (ADM_OS_LINUX)
+	SET(ESD_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
+
+########################################
+# JACK
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	OPTION(JACK &quot;&quot; ON)
+
+	MESSAGE(STATUS &quot;Checking for JACK&quot;)
+	MESSAGE(STATUS &quot;*****************&quot;)
+
+	IF (JACK)
+		FIND_HEADER_AND_LIB(JACK jack/jack.h jack jack_client_close)
+		PRINT_LIBRARY_INFO(&quot;JACK&quot; JACK_FOUND &quot;${JACK_INCLUDE_DIR}&quot; &quot;${JACK_LIBRARY_DIR}&quot;)
+
+		IF (JACK_FOUND)
+			SET(USE_JACK 1)
+		ENDIF (JACK_FOUND)
+	ELSE (JACK)
+		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+	ENDIF (JACK)
+	
+	MESSAGE(&quot;&quot;)
+ELSE (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	SET(JACK_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+
+########################################
+# Secret Rabbit Code
+########################################
+IF (JACK_FOUND)
+	MESSAGE(STATUS &quot;Checking for Secret Rabbit Code&quot;)
+	MESSAGE(STATUS &quot;*******************************&quot;)
+
+	FIND_HEADER_AND_LIB(SRC samplerate.h samplerate src_get_version)
+	PRINT_LIBRARY_INFO(&quot;Secret Rabbit Code&quot; SRC_FOUND &quot;${SRC_INCLUDE_DIR}&quot; &quot;${SRC_LIBRARY_DIR}&quot;)
+
+	IF (SRC_FOUND)
+		SET(USE_SRC 1)
+	ENDIF (SRC_FOUND)
+	
+	MESSAGE(&quot;&quot;)
+ENDIF (JACK_FOUND)
+
+########################################
+# OSS
+########################################
+IF (ADM_OS_LINUX)
+	OPTION(OSS &quot;&quot; ON)
+	
+	MESSAGE(STATUS &quot;Checking for OSS&quot;)
+	MESSAGE(STATUS &quot;****************&quot;)
+	
+	IF (OSS)
+		FIND_HEADER_AND_LIB(OSS sys/soundcard.h)
+		PRINT_LIBRARY_INFO(&quot;OSS&quot; OSS_FOUND &quot;${OSS_INCLUDE_DIR}&quot; &quot;&quot;)
+
+		IF (OSS_FOUND)
+			SET(OSS_SUPPORT 1)
+		ENDIF (OSS_FOUND)
+	ELSE (OSS)
+		MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+	ENDIF (OSS)
+	
+	MESSAGE(&quot;&quot;)
+ELSE (ADM_OS_LINUX)
+	SET(OSS_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckMiscLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,135 @@
+########################################
+# FontConfig
+########################################
+MESSAGE(STATUS &quot;Checking for FontConfig&quot;)
+MESSAGE(STATUS &quot;***********************&quot;)
+
+FIND_HEADER_AND_LIB(FONTCONFIG fontconfig/fontconfig.h fontconfig FcStrSetCreate)
+PRINT_LIBRARY_INFO(&quot;FontConfig&quot; FONTCONFIG_FOUND &quot;${FONTCONFIG_INCLUDE_DIR}&quot; &quot;${FONTCONFIG_LIBRARY_DIR}&quot;)
+
+IF (FONTCONFIG_FOUND)
+	SET(HAVE_FONTCONFIG 1)
+	SET(USE_FONTCONFIG 1)
+ENDIF (FONTCONFIG_FOUND)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# FreeType2
+########################################
+OPTION(FREETYPE2 &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for FreeType2&quot;)
+MESSAGE(STATUS &quot;**********************&quot;)
+
+IF (FREETYPE2)
+	PKG_CHECK_MODULES(FREETYPE2 freetype2)
+	PRINT_LIBRARY_INFO(&quot;FreeType2&quot; FREETYPE2_FOUND &quot;${FREETYPE2_CFLAGS}&quot; &quot;${FREETYPE2_LDFLAGS}&quot;)
+
+	IF (FREETYPE2_FOUND)
+		SET(USE_FREETYPE 1)
+	ENDIF (FREETYPE2_FOUND)
+ELSE (FREETYPE2)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (FREETYPE2)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# gettext
+########################################
+MESSAGE(STATUS &quot;Checking for gettext&quot;)
+MESSAGE(STATUS &quot;********************&quot;)
+
+OPTION(GETTEXT &quot;&quot; ON)
+
+IF (GETTEXT)
+	FIND_HEADER_AND_LIB(GETTEXT libintl.h intl)
+	PRINT_LIBRARY_INFO(&quot;Gettext&quot; GETTEXT_FOUND &quot;${GETTEXT_INCLUDE_DIR}&quot; &quot;${GETTEXT_LIBRARY_DIR}&quot;)
+
+	IF (GETTEXT_INCLUDE_DIR)
+		# Try linking without -lintl
+		ADM_COMPILE(gettext.cpp &quot;&quot; &quot;-I${GETTEXT_INCLUDE_DIR}&quot; &quot;&quot; LIBINTL_NOT_REQUIRED outputWithoutLibintl)
+
+		IF (LIBINTL_NOT_REQUIRED)
+			SET(GETTEXT_LIBRARY_DIR &quot;&quot;)
+			SET(HAVE_GETTEXT 1)
+
+			MESSAGE(STATUS &quot;libintl not required for gettext support&quot;)
+		ELSE (LIBINTL_NOT_REQUIRED)
+			ADM_COMPILE(gettext.cpp &quot;&quot; &quot;-I${GETTEXT_INCLUDE_DIR}&quot; &quot;${GETTEXT_LIBRARY_DIR}&quot; LIBINTL_REQUIRED outputWithLibintl)
+
+			IF (LIBINTL_REQUIRED)
+				SET(HAVE_GETTEXT 1)
+
+				MESSAGE(STATUS &quot;libintl required for gettext support&quot;)
+			ELSE (LIBINTL_REQUIRED)
+				SET(GETTEXT_FOUND 0 CACHE INTERNAL &quot;&quot;)
+
+				MESSAGE(&quot;gettext support failed with or without libintl&quot;)
+				
+				IF (VERBOSE)
+					MESSAGE(STATUS &quot;Compilation error with libintl:&quot;)
+					MESSAGE(STATUS ${outputWithLibintl})
+
+					MESSAGE(STATUS &quot;Compilation error without libintl:&quot;)
+					MESSAGE(STATUS ${outputWithoutLibintl})
+				ENDIF (VERBOSE)
+			ENDIF (LIBINTL_REQUIRED)
+		ENDIF (LIBINTL_NOT_REQUIRED)
+	ENDIF (GETTEXT_INCLUDE_DIR)
+ELSE (GETTEXT)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (GETTEXT)
+
+SET(ADM_LOCALE &quot;${CMAKE_INSTALL_PREFIX}/share/locale&quot;)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# SDL
+########################################
+OPTION(SDL &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for SDL&quot;)
+MESSAGE(STATUS &quot;****************&quot;)
+
+IF (SDL)
+	FIND_PACKAGE(SDL)
+	PRINT_LIBRARY_INFO(&quot;SDL&quot; SDL_FOUND &quot;${SDL_INCLUDE_DIR}&quot; &quot;${SDL_LIBRARY}&quot;)
+	
+	MARK_AS_ADVANCED(SDLMAIN_LIBRARY)
+	MARK_AS_ADVANCED(SDL_INCLUDE_DIR)
+	MARK_AS_ADVANCED(SDL_LIBRARY)
+
+	IF (SDL_FOUND)
+		SET(USE_SDL 1)
+	ENDIF (SDL_FOUND)
+ELSE (SDL)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (SDL)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# XVideo
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)	
+	OPTION(XVIDEO &quot;&quot; ON)
+	
+	IF (X11_FOUND AND XVIDEO)
+		MESSAGE(STATUS &quot;Checking for XVideo&quot;)
+		MESSAGE(STATUS &quot;*******************&quot;)
+
+		FIND_HEADER_AND_LIB(XVIDEO X11/extensions/Xvlib.h Xv XvShmPutImage &quot;-include X11/Xlib.h ${X11_INCLUDE_DIR} ${X11_LIBRARIES}&quot;)
+		PRINT_LIBRARY_INFO(&quot;XVideo&quot; XVIDEO_FOUND &quot;${XVIDEO_INCLUDE_DIR}&quot; &quot;${XVIDEO_LIBRARY}&quot;)
+		
+		IF (XVIDEO_FOUND)
+			SET(USE_XV 1)
+		ENDIF (XVIDEO_FOUND)
+	
+		MESSAGE(&quot;&quot;)
+	ENDIF (X11_FOUND AND XVIDEO)
+ELSE (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	SET(XVIDEO_CAPABLE FALSE)
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckRequiredLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,73 @@
+########################################
+# pkg-config
+########################################
+MESSAGE(STATUS &quot;Checking for pkg-config&quot;)
+MESSAGE(STATUS &quot;***********************&quot;)
+
+FIND_PACKAGE(PkgConfig)
+
+IF (NOT PKG_CONFIG_FOUND)
+	MESSAGE(FATAL_ERROR &quot;Could not find pkg-config&quot;)
+ENDIF (NOT PKG_CONFIG_FOUND)
+
+MESSAGE(STATUS &quot;Found pkg-config&quot;)
+
+IF (VERBOSE)
+	MESSAGE(STATUS &quot;Path: ${PKG_CONFIG_EXECUTABLE}&quot;)
+ENDIF (VERBOSE)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# libiconv
+########################################
+MESSAGE(STATUS &quot;Checking for libiconv&quot;)
+MESSAGE(STATUS &quot;*********************&quot;)
+
+FIND_HEADER_AND_LIB(LIBICONV iconv.h iconv)
+PRINT_LIBRARY_INFO(&quot;libiconv&quot; LIBICONV_FOUND &quot;${LIBICONV_INCLUDE_DIR}&quot; &quot;${LIBICONV_LIBRARY_DIR}&quot;)
+
+IF (NOT LIBICONV_INCLUDE_DIR)
+	MESSAGE(FATAL &quot;iconv.h not found&quot;)
+ENDIF (NOT LIBICONV_INCLUDE_DIR)
+
+IF (LIBICONV_LIBRARY_DIR)
+	MESSAGE(STATUS &quot;libiconv is probably needed&quot;)
+ELSE (LIBICONV_LIBRARY_DIR)
+	MESSAGE(STATUS &quot;libiconv is probably not needed&quot;)
+ENDIF (LIBICONV_LIBRARY_DIR)
+
+CHECK_CFLAGS_REQUIRED(iconv_check.cpp &quot;-DICONV_NEED_CONST&quot; &quot;${LIBICONV_INCLUDE_DIR}&quot; &quot;${LIBICONV_LIBRARY_DIR}&quot; LIBICONV_CFLAGS_REQUIRED)
+
+IF (LIBICONV_CFLAGS_REQUIRED)
+	SET(LIBICONV_DEFINITIONS &quot;-DICONV_NEED_CONST&quot;)
+	SET(ICONV_NEED_CONST 1)
+ENDIF(LIBICONV_CFLAGS_REQUIRED)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Libxml2
+########################################
+MESSAGE(STATUS &quot;Checking for Libxml2&quot;)
+MESSAGE(STATUS &quot;********************&quot;)
+
+SET(LibXml2_FIND_QUIETLY TRUE)
+
+FIND_PACKAGE(LibXml2)
+PRINT_LIBRARY_INFO(&quot;Libxml2&quot; LIBXML2_FOUND &quot;${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS}&quot; &quot;${LIBXML2_LIBRARIES}&quot; FATAL_ERROR)
+
+SET(USE_LIBXML2 1)
+MESSAGE(&quot;&quot;)
+
+########################################
+# libpng
+########################################
+MESSAGE(STATUS &quot;Checking for libpng&quot;)
+MESSAGE(STATUS &quot;*******************&quot;)
+
+FIND_PACKAGE(png)
+PRINT_LIBRARY_INFO(&quot;libpng&quot; PNG_FOUND &quot;${PNG_INCLUDE_DIR} ${PNG_DEFINITIONS}&quot; &quot;${PNG_LIBRARIES}&quot; FATAL_ERROR)
+
+SET(USE_PNG 1)
+MESSAGE(&quot;&quot;)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,117 @@
+########################################
+# X11
+########################################
+IF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+	MESSAGE(STATUS &quot;Checking for X11&quot;)
+	MESSAGE(STATUS &quot;****************&quot;)
+	
+	FIND_PACKAGE(X11)
+	
+	PRINT_LIBRARY_INFO(&quot;X11&quot; X11_FOUND &quot;${X11_INCLUDE_DIR}&quot; &quot;${X11_LIBRARIES}&quot;)
+	
+	IF (NOT X11_FOUND)
+		SET(ADM_UI_GTK 0)
+		
+		IF (ADM_OS_LINUX)
+			SET(ADM_UI_QT4 0)
+		ENDIF (ADM_OS_LINUX)
+	ENDIF (NOT X11_FOUND)
+	
+	MESSAGE(&quot;&quot;)
+ENDIF (ADM_OS_LINUX OR ADM_OS_DARWIN)
+
+########################################
+# GLib
+########################################
+MESSAGE(STATUS &quot;Checking for GLib&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+PKG_CHECK_MODULES(GLIB glib-2.0)
+
+PRINT_LIBRARY_INFO(&quot;GLib&quot; GLIB_FOUND &quot;${GLIB_CFLAGS}&quot; &quot;${GLIB_LDFLAGS}&quot; FATAL_ERROR)
+MESSAGE(&quot;&quot;)
+
+########################################
+# GTK+
+########################################
+OPTION(GTK &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for GTK+&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (GTK)
+	PKG_CHECK_MODULES(GTK gtk+-2.0)
+	PRINT_LIBRARY_INFO(&quot;GTK+&quot; GTK_FOUND &quot;${GTK_CFLAGS}&quot; &quot;${GTK_LDFLAGS}&quot;)
+
+	IF (NOT GTK_FOUND)
+		SET(ADM_UI_GTK 0)
+	ENDIF (NOT GTK_FOUND)
+ELSE (GTK)
+	SET(ADM_UI_GTK 0)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (GTK)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# GThread
+########################################
+MESSAGE(STATUS &quot;Checking for GThread&quot;)
+MESSAGE(STATUS &quot;********************&quot;)
+
+IF (GTK)
+	PKG_CHECK_MODULES(GTHREAD gthread-2.0)
+	PRINT_LIBRARY_INFO(&quot;GThread&quot; GTHREAD_FOUND &quot;${GTHREAD_CFLAGS}&quot; &quot;${GTHREAD_LDFLAGS}&quot;)
+
+	IF (NOT GTHREAD_FOUND)
+		SET(ADM_UI_GTK 0)
+		MESSAGE(STATUS &quot;Could not find GThread&quot;)
+	ENDIF(NOT GTHREAD_FOUND)
+ELSE (GTK)
+	SET(ADM_UI_GTK 0)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (GTK)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Qt4
+########################################
+OPTION(QT4 &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for QT4&quot;)
+MESSAGE(STATUS &quot;****************&quot;)
+
+IF (QT4)
+	FIND_PACKAGE(Qt4)	
+	STRING(REGEX REPLACE &quot;[\\]&quot; &quot;/&quot; QT_INCLUDES &quot;${QT_INCLUDES}&quot;)	# backslashes aren't taken care of properly on Windows
+	PRINT_LIBRARY_INFO(&quot;Qt4&quot; QT4_FOUND &quot;${QT_INCLUDES} ${QT_DEFINITIONS}&quot; &quot;${QT_QTCORE_LIBRARY} ${QT_QTGUI_LIBRARY}&quot;)
+	
+	MARK_AS_ADVANCED(LRELEASE_EXECUTABLE)
+	MARK_AS_ADVANCED(QT_MKSPECS_DIR)
+	MARK_AS_ADVANCED(QT_PLUGINS_DIR)
+	MARK_AS_ADVANCED(QT_QMAKE_EXECUTABLE)
+	
+	IF (QT4_FOUND)
+		IF (XMINGW)
+			SET(QTXM /rot2/qt_4.3)
+
+			SET(QT_QMAKE_EXECUTABLE qmake)
+			SET(QT_UIC_EXECUTABLE uic-qt4)
+			SET(QT_MOC_EXECUTABLE moc-qt4)
+			SET(QT_RCC_EXECUTABLE rcc)
+			SET(QT_QTGUI_LIBRARY QtGui4)   # FIXME
+			SET(QT_QTCORE_LIBRARY QtCore4) # FIXME
+
+			SET(CMAKE_CXX_FLAGS &quot;-I${QTXM}/include ${CMAKE_CXX_FLAGS}&quot;)
+			LINK_DIRECTORIES(${QTXM}/bin)
+			LINK_DIRECTORIES(${QTXM}/lib)
+		ENDIF (XMINGW)		
+	ELSE (QT4_FOUND)
+		SET(ADM_UI_QT4 0)
+	ENDIF (QT4_FOUND)	
+ELSE (QT4)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (QT4)
+
+MESSAGE(&quot;&quot;)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckVideoCodecLibs.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,41 @@
+########################################
+# x264
+########################################
+OPTION(X264 &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for x264&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (X264)
+	FIND_HEADER_AND_LIB(X264 x264.h x264 x264_encoder_open)
+	PRINT_LIBRARY_INFO(&quot;x264&quot; X264_FOUND &quot;${X264_INCLUDE_DIR}&quot; &quot;${X264_LIBRARY_DIR}&quot;)
+
+	IF (X264_FOUND)
+		SET(USE_X264 1)
+	ENDIF (X264_FOUND)
+ELSE (X264)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (X264)
+
+MESSAGE(&quot;&quot;)
+
+########################################
+# Xvid
+########################################
+OPTION(XVID &quot;&quot; ON)
+
+MESSAGE(STATUS &quot;Checking for Xvid&quot;)
+MESSAGE(STATUS &quot;*****************&quot;)
+
+IF (XVID)
+	FIND_HEADER_AND_LIB(XVID xvid.h xvidcore xvid_plugin_single)
+	PRINT_LIBRARY_INFO(&quot;Xvid&quot; XVID_FOUND &quot;${XVID_INCLUDE_DIR}&quot; &quot;${XVID_LIBRARY_DIR}&quot;)
+	
+	IF (XVID_FOUND)
+		SET(USE_XVID_4 1)
+	ENDIF (XVID_FOUND)
+ELSE (XVID)
+	MESSAGE(STATUS &quot;&lt;disabled per request&gt;&quot;)
+ENDIF (XVID)
+
+MESSAGE(&quot;&quot;)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigHelper.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,146 @@
+INCLUDE(CheckLibraryExists)		# required for FIND_HEADER_AND_LIB macro
+
+MACRO(PRINT_LIBRARY_INFO libraryName libraryDetected compilerFlags linkerFlags)
+	IF (${libraryDetected})
+		MESSAGE(STATUS &quot;Found ${libraryName}&quot;)
+		
+		IF (VERBOSE)
+			MESSAGE(STATUS &quot;Compiler Flags: ${compilerFlags}&quot;)
+			MESSAGE(STATUS &quot;Linker Flags  : ${linkerFlags}&quot;)
+		ENDIF (VERBOSE)
+	ELSE (${libraryDetected})
+		MESSAGE(${ARGV4} &quot;Could not find ${libraryName}&quot;)
+	ENDIF (${libraryDetected})
+ENDMACRO(PRINT_LIBRARY_INFO)
+
+
+MACRO(SDLify _source)
+	if(SDL_FOUND)
+        SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS &quot;-I${SDL_INCLUDE_DIR}&quot;)
+	endif(SDL_FOUND)
+ENDMACRO(SDLify)
+
+# ARGV2 = library to check
+# ARGV3 = function to check
+# ARVG4 = CMAKE_REQUIRED_FLAGS
+MACRO(FIND_HEADER_AND_LIB prefix headerFile)
+	IF (NOT DEFINED ${prefix}_FOUND)
+		SET(${prefix}_FOUND 0 CACHE INTERNAL &quot;&quot;)
+		SET(PROCEED 1)
+		
+		IF (NOT ${headerFile} STREQUAL &quot;&quot;)
+			FIND_PATH(${prefix}_INCLUDE_DIR ${headerFile})
+			MARK_AS_ADVANCED(${prefix}_INCLUDE_DIR)
+		
+			IF (${prefix}_INCLUDE_DIR)
+				MESSAGE(STATUS &quot;Found ${headerFile}&quot;)
+			ELSE (${prefix}_INCLUDE_DIR)
+				SET(PROCEED 0)
+				MESSAGE(&quot;Could not find ${headerFile}&quot;)
+			ENDIF (${prefix}_INCLUDE_DIR)
+		ENDIF (NOT ${headerFile} STREQUAL &quot;&quot;)
+		
+		IF (PROCEED AND NOT ${ARGV2} STREQUAL &quot;&quot;)
+			FIND_LIBRARY(${prefix}_LIBRARY_DIR ${ARGV2})
+			MARK_AS_ADVANCED(${prefix}_LIBRARY_DIR)
+
+			IF (${prefix}_LIBRARY_DIR)
+				MESSAGE(STATUS &quot;Found ${ARGV2} library&quot;)
+				
+				IF (NOT ${ARGV3} STREQUAL &quot;&quot;)
+					SET(CMAKE_REQUIRED_FLAGS_BACKUP &quot;${CMAKE_REQUIRED_FLAGS}&quot;)
+					SET(CMAKE_REQUIRED_FLAGS &quot;${CMAKE_REQUIRED_FLAGS} ${ARGV4}&quot;)
+
+					CHECK_LIBRARY_EXISTS(${ARGV2} ${ARGV3} ${prefix}_LIBRARY_DIR ${prefix}_FUNCTION_FOUND)
+
+					SET(CMAKE_REQUIRED_FLAGS &quot;${CMAKE_REQUIRED_FLAGS_BACKUP}&quot;)
+
+					IF (${prefix}_FUNCTION_FOUND)
+						SET(${prefix}_FOUND 1 CACHE INTERNAL &quot;&quot;)
+					ENDIF (${prefix}_FUNCTION_FOUND)
+				ELSE (NOT ${ARGV3} STREQUAL &quot;&quot;)
+					SET(${prefix}_FOUND 1 CACHE INTERNAL &quot;&quot;)
+				ENDIF (NOT ${ARGV3} STREQUAL &quot;&quot;)
+			ELSE (${prefix}_LIBRARY_DIR)
+				MESSAGE(STATUS &quot;Cound not find ${ARGV2} library&quot;)
+			ENDIF (${prefix}_LIBRARY_DIR)
+		ELSE (PROCEED AND NOT ${ARGV2} STREQUAL &quot;&quot;)
+			SET(${prefix}_FOUND 1 CACHE INTERNAL &quot;&quot;)
+		ENDIF (PROCEED AND NOT ${ARGV2} STREQUAL &quot;&quot;)
+	ENDIF (NOT DEFINED ${prefix}_FOUND)
+ENDMACRO(FIND_HEADER_AND_LIB)
+
+
+MACRO (ADM_COMPILE _file _def _include _lib _varToSet _output)
+	IF (NOT DEFINED ${_varToSet}_COMPILED)
+		SET(${_varToSet}_COMPILED 1 CACHE INTERNAL &quot;&quot;)
+		
+		TRY_COMPILE(${_varToSet}
+			  ${CMAKE_BINARY_DIR}
+			  ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
+			  CMAKE_FLAGS -DINCLUDE_DIRECTORIES=${_include} -DCOMPILE_DEFINITIONS=${_def} -DLINK_LIBRARIES=${_lib}
+			  COMPILE_DEFINITIONS &quot;${_cflags}&quot;
+			  OUTPUT_VARIABLE ${_output})
+	ENDIF (NOT DEFINED ${_varToSet}_COMPILED)
+ENDMACRO (ADM_COMPILE)
+
+
+MACRO (CHECK_CFLAGS_REQUIRED _file _cflags _include _lib _varToSet)
+	IF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
+		SET(${_varToSet}_CFLAGS_CHECKED 1 CACHE INTERNAL &quot;&quot;)
+		
+		ADM_COMPILE(${_file} ${_cflags} ${_include} ${_lib} ${_varToSet}_COMPILE_WITH logwith)
+		ADM_COMPILE(${_file} &quot;&quot; ${_include} ${_lib} ${_varToSet}_COMPILE_WITHOUT logwithout)
+
+		IF (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+			SET(${_varToSet} 1 CACHE INTERNAL &quot;&quot;)
+			
+			IF (VERBOSE)
+				MESSAGE(STATUS &quot;(${_cflags}) required&quot;)
+			ENDIF (VERBOSE)
+		ELSE (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+			IF (NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+				IF (VERBOSE)
+					MESSAGE (STATUS &quot;(${_cflags}) not required&quot;)
+				ENDIF (VERBOSE)
+			ELSE (NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+				MESSAGE(STATUS &quot;Inconsistent compiler output with: ${${_varToSet}_COMPILE_WITH}, without: ${${_varToSet}_COMPILE_WITHOUT}&quot;)
+				MESSAGE(STATUS &quot;${logwith}&quot;)
+				MESSAGE(STATUS &quot;&quot;)
+				MESSAGE(STATUS &quot;${logwithout}&quot;)
+			endif(NOT ${_varToSet}_COMPILE_WITH AND ${_varToSet}_COMPILE_WITHOUT)
+		ENDIF (${_varToSet}_COMPILE_WITH AND NOT ${_varToSet}_COMPILE_WITHOUT)
+	ENDIF (NOT DEFINED ${_varToSet}_CFLAGS_CHECKED)
+ENDMACRO (CHECK_CFLAGS_REQUIRED)
+
+MACRO (append_flags _flags _varToAppend)
+	if (_flags)
+		set(_flags &quot;${_flags} ${_varToAppend}&quot;)
+	else (_flags)
+		set(_flags &quot;${_varToAppend}&quot;)
+	endif (_flags)
+ENDMACRO (append_flags)
+
+MACRO (add_link_flags _target _flg)
+	GET_TARGET_PROPERTY(_flags ${_target} LINK_FLAGS)
+
+	append_flags(&quot;${_flags}&quot; &quot;${_flg}&quot;)
+
+	SET_TARGET_PROPERTIES(${_target} PROPERTIES LINK_FLAGS &quot;${_flags}&quot;)
+ENDMACRO (add_link_flags)
+
+MACRO (add_source_compile_flags _target _flg)
+	GET_SOURCE_FILE_PROPERTY(_flags ${_target} COMPILE_FLAGS)
+
+	append_flags(&quot;${_flags}&quot; &quot;${_flg}&quot;)
+   
+	SET_SOURCE_FILES_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS &quot;${_flags}&quot;)   
+ENDMACRO (add_source_compile_flags)
+
+MACRO (add_target_compile_flags _target _flg)
+	GET_TARGET_PROPERTY(_flags ${_target} COMPILE_FLAGS)
+
+	append_flags(&quot;${_flags}&quot; &quot;${_flg}&quot;)
+   
+	SET_TARGET_PROPERTIES(${_target} PROPERTIES COMPILE_FLAGS &quot;${_flags}&quot;)
+ENDMACRO (add_target_compile_flags)
\ No newline at end of file

Copied: branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admConfigSummary.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,64 @@
+# ARGV2 - capable flag
+MACRO(ADM_DISPLAY _name _val)
+	SET(PROCEED TRUE)
+	
+	IF (${ARGC} EQUAL 3)
+		IF (NOT ${ARGV2})
+			SET(PROCEED FALSE)
+		ENDIF (NOT ${ARGV2})
+	ENDIF (${ARGC} EQUAL 3)
+	
+	IF (${PROCEED} STREQUAL &quot;TRUE&quot;)
+		IF (${_val} EQUAL 1)
+			SET(s &quot;Yes&quot;)
+		ELSE (${_val} EQUAL 1)
+			SET(s &quot;No&quot;)
+		ENDIF (${_val} EQUAL 1)
+	
+		MESSAGE(&quot;   ${_name}  ${s}&quot;)
+	ENDIF (${PROCEED} STREQUAL &quot;TRUE&quot;)
+ENDMACRO(ADM_DISPLAY)
+
+MESSAGE(&quot;*********************&quot;)
+MESSAGE(&quot;***    SUMMARY    ***&quot;)
+MESSAGE(&quot;*********************&quot;)
+ADM_DISPLAY(&quot;GTK+      &quot; ADM_UI_GTK)
+ADM_DISPLAY(&quot;Qt4       &quot; ADM_UI_QT4)
+
+MESSAGE(&quot;***  Video Codec  ***&quot;)
+ADM_DISPLAY(&quot;x264      &quot; USE_X264)
+ADM_DISPLAY(&quot;Xvid      &quot; USE_XVID_4)
+
+MESSAGE(&quot;***  Audio Codec  ***&quot;)
+ADM_DISPLAY(&quot;Aften     &quot; USE_AFTEN)
+ADM_DISPLAY(&quot;amrnb     &quot; USE_AMR_NB)
+ADM_DISPLAY(&quot;LAME      &quot; HAVE_LIBMP3LAME)
+ADM_DISPLAY(&quot;FAAC      &quot; USE_FAAC)
+ADM_DISPLAY(&quot;FAAD      &quot; USE_FAAD)
+ADM_DISPLAY(&quot;libdca    &quot; USE_LIBDCA)
+ADM_DISPLAY(&quot;Vorbis    &quot; USE_VORBIS)
+
+MESSAGE(&quot;*** Audio Device  ***&quot;)
+ADM_DISPLAY(&quot;ALSA      &quot; ALSA_SUPPORT ${ALSA_CAPABLE})
+ADM_DISPLAY(&quot;aRts      &quot; USE_ARTS ${ARTS_CAPABLE})
+ADM_DISPLAY(&quot;ESD       &quot; USE_ESD ${ESD_CAPABLE})
+ADM_DISPLAY(&quot;JACK      &quot; USE_JACK ${JACK_CAPABLE})
+ADM_DISPLAY(&quot;OSS       &quot; OSS_SUPPORT ${OSS_CAPABLE})
+ADM_DISPLAY(&quot;SRC       &quot; USE_SRC ${JACK_CAPABLE})
+
+MESSAGE(&quot;*** Miscellaneous ***&quot;)
+ADM_DISPLAY(&quot;FontConfig&quot; USE_FONTCONFIG)
+ADM_DISPLAY(&quot;FreeType2 &quot; FREETYPE2_FOUND)
+ADM_DISPLAY(&quot;gettext   &quot; HAVE_GETTEXT)
+ADM_DISPLAY(&quot;SDL       &quot; USE_SDL)
+ADM_DISPLAY(&quot;XVideo    &quot; USE_XV ${XVIDEO_CAPABLE})
+
+MESSAGE(&quot;*********************&quot;)
+
+IF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+	MESSAGE(&quot;***  Debug Build  ***&quot;)
+ELSE (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+	MESSAGE(&quot;*** Release Build ***&quot;)
+ENDIF(CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+
+MESSAGE(&quot;*********************&quot;)

Added: branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admDetermineSystem.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,38 @@
+# - determine CPU and Operating System
+#  ADM_CPU_X86      - x86 CPU architecture was detected
+#  ADM_CPU_X86_64   - x86-64 CPU architecture was detected
+#  ADM_OS_DARWIN    - Mac OS X was detected
+#  ADM_OS_LINUX     - Linux was detected
+#  ADM_OS_WINDOWS   - Microsoft Windows was detected
+
+INCLUDE(CMakeDetermineSystem)
+
+IF (WIN32)
+	SET(ADM_OS_WINDOWS 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86&quot;)
+		SET(ADM_CPU_X86 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86&quot;)
+ELSEIF (APPLE)
+	SET(ADM_OS_DARWIN 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i386&quot;)
+		SET(ADM_CPU_X86 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i386&quot;)
+ELSEIF (UNIX)
+	SET(ADM_OS_LINUX 1)
+	
+	IF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i586&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i686&quot;)
+		SET(ADM_CPU_X86 1)
+	ELSEIF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;x86_64&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;amd64&quot;)
+		SET(ADM_CPU_X86_64 1)
+	ENDIF (${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i586&quot; OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL &quot;i686&quot;)
+ENDIF (WIN32)
+
+IF (NOT ADM_OS_DARWIN AND NOT ADM_OS_WINDOWS AND NOT ADM_OS_LINUX)
+	MESSAGE(FATAL_ERROR &quot;Operating System not supported (${CMAKE_SYSTEM_NAME})&quot;)
+ENDIF (NOT ADM_OS_DARWIN AND NOT ADM_OS_WINDOWS AND NOT ADM_OS_LINUX)
+
+IF (NOT ADM_CPU_X86 AND NOT ADM_CPU_X86_64)
+	MESSAGE(FATAL_ERROR &quot;CPU not supported (${CMAKE_SYSTEM_PROCESSOR})&quot;)
+ENDIF (NOT ADM_CPU_X86 AND NOT ADM_CPU_X86_64)	
\ No newline at end of file

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admSDL.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,45 +0,0 @@
-# - Locate the SDL library using sdl-config
-# This module defines
-#  SDL_LIBRARY, the library to link against
-#  SDL_FOUND, if false, do not try to link to SDL
-#  SDL_INCLUDE_DIR, where to find SDL.h
-#
-#MACRO(ADM_FIND_SDL)
-#
-#FIND_PROGRAM(SDL_EXECUTABLE
-#  NAMES sdl-config
-#  PATHS
-#  $ENV{SDLDIR}/bin
-#)
-#if(SDL_EXECUTABLE)
-#  MESSAGE(STATUS &quot;sdl-config found ${SDL_EXECUTABLE}&quot;)
-## Check we can run it
-#    FIND_PROGRAM(SH_EXECUTABLE NAMES sh)
-#
-#    IF(SH_EXECUTABLE)
-#      MESSAGE(STATUS &quot;sh found ${SH_EXECUTABLE}&quot;)
-#    
-#      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS &quot;${SDL_EXECUTABLE} --libs&quot;   OUTPUT_VARIABLE SDL_LDFLAGS )
-#      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS &quot;${SDL_EXECUTABLE} --cflags&quot; OUTPUT_VARIABLE SDL_CFLAGS )
-#      SET(SDL_FOUND TRUE)
-#    ELSEIF(WIN32)
-#      SET(SDL_FOUND TRUE)
-#      SET(SDL_LDFLAGS &quot;-L/mingw/lib -lmingw32 -lSDLmain -lSDL -mwindows&quot;)
-#      SET(SDL_CFLAGS &quot;-I/mingw/include/SDL -D_GNU_SOURCE=1 -Dmain=SDL_main&quot;)
-#    ENDIF(SH_EXECUTABLE)
-#    
-#    IF(SDL_FOUND)
-#      MESSAGE(STATUS &quot;cflags : ${SDL_CFLAGS}&quot;)
-#      MESSAGE(STATUS &quot;libs   : ${SDL_LDFLAGS}&quot;)
-#    ENDIF(SDL_FOUND)
-#else(SDL_EXECUTABLE)
-#  MESSAGE(STATUS &quot;sdl-config not found &quot;)
-#endif(SDL_EXECUTABLE)
-#
-#ENDMACRO(ADM_FIND_SDL)
-
-MACRO(SDLify _source)
-	if(SDL_FOUND)
-        SET_SOURCE_FILES_PROPERTIES(${_source} PROPERTIES COMPILE_FLAGS &quot;-I${SDL_INCLUDE_DIR}&quot;)
-	endif(SDL_FOUND)
-ENDMACRO(SDLify)

Copied: branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admSetLavcodecFlags.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,40 @@
+SET(CONFIG_ENCODERS 1)
+SET(CONFIG_DVVIDEO_ENCODER 1)
+
+SET(CONFIG_DECODERS 1)
+SET(CONFIG_DVVIDEO_DECODER 1)
+SET(CONFIG_H263_DECODER 1)
+SET(CONFIG_MPEG4_DECODER 1)
+SET(CONFIG_MPEGAUDIO_HP 1)
+SET(CONFIG_SNOW_DECODER 1)
+SET(CONFIG_VC1_DECODER 1)
+SET(CONFIG_WMV2_DECODER 1)
+SET(CONFIG_WMV3_DECODER 1)
+SET(CONFIG_ZLIB 1)
+
+SET(CONFIG_MUXERS 1)
+SET(CONFIG_MOV_MUXER 1)
+SET(CONFIG_MP4_MUXER 1)
+SET(CONFIG_PSP_MUXER 1)
+SET(CONFIG_TG2_MUXER 1)
+SET(CONFIG_TGP_MUXER 1)
+
+SET(ENABLE_MMX 1)
+SET(ENABLE_THREADS 1)
+SET(HAVE_FAST_UNALIGNED 1)
+SET(HAVE_LRINTF 1)
+SET(HAVE_MMX 1)
+SET(HAVE_THREADS 1)
+SET(RUNTIME_CPUDETECT 1)
+
+IF (ADM_CPU_X86_64)
+	SET(HAVE_FAST_64BIT 1)
+ENDIF (ADM_CPU_X86_64)
+
+IF (NOT NO_SSSE3)
+	SET(HAVE_SSSE3 1)
+ENDIF (NOT NO_SSSE3)
+
+IF (ADM_OS_DARWIN)
+	SET(CONFIG_DARWIN 1)
+ENDIF (ADM_OS_DARWIN)

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/adm_checkHeaderLib.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,38 +0,0 @@
-# Small Macro to check head &amp; lib and set output variable
-# all in one line, cmake is cool :)
-MACRO (ADM_CHECK_HL _banner _includeName _libName _libFunc _varToSet)
-MESSAGE(STATUS &quot;&lt;Checking for ${_banner}&gt;&quot;)
-MESSAGE(STATUS &quot;&lt;******************************&gt;&quot;)
-if(NO_${_banner})
-message(status &quot;&lt;disabled per request&gt;&quot;)
-else(NO_${_banner})
- SET(_oldCRF ${CMAKE_REQUIRED_FLAGS})
- SET(CMAKE_REQUIRED_FLAGS &quot;$ENV{CFLAGS} ${_oldCRF}&quot;)
-#MESSAGE(STATUS &quot;CMAKE_REQUIRED_FLAGS:${CMAKE_REQUIRED_FLAGS}&quot;)
-#MESSAGE(STATUS &quot;ENV:&quot;$ENV{CFLAGS})
-CHECK_INCLUDE_FILES(&quot;${_includeName}&quot; &quot;${_varToSet}_H&quot;)
-#MESSAGE(&quot;OUT ${HAVE_IT_H}&quot;)
-if(${_varToSet}_H)
-  MESSAGE(STATUS &quot;Header ${_includeName} Found&quot;)
-#FIND_LIBRARY(ADM_PATH_LIB ${_libName})
-  CHECK_LIBRARY_EXISTS(${_libName} ${_libFunc} &quot;&quot; ${_varToSet}_L)
-  if(${_varToSet}_L)
-        MESSAGE(STATUS &quot;Lib ${_libName} Found&quot;)
-        SET(${_varToSet}  1)
-  else(${_varToSet}_L)
-        MESSAGE(&quot;Lib not found&quot;)
-  endif(${_varToSet}_L)
-else(${_varToSet}_H)
-  MESSAGE(&quot;Header not found(${_includeName})&quot;)
-endif(${_varToSet}_H)
-
-if(${_varToSet})
-   MESSAGE(STATUS &quot;${_banner} OK&quot;)
-else(${_varToSet})
-     MESSAGE(STATUS &quot;${_banner} support off&quot;)
-endif(${_varToSet})
-SET(CMAKE_REQUIRED_FLAGS &quot;${_oldCRF}&quot;)
-endif(NO_${_banner})
-ENDMACRO (ADM_CHECK_HL _includeName _libName _libFunc _varToSet)
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/adm_compile.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,39 +0,0 @@
-# Small Macro to check head &amp; lib and set output variable
-# all in one line, cmake is cool :)
-MACRO (ADM_COMPILE _file _cflags _lib _varToSet _output)
-TRY_COMPILE(${_varToSet}
-      ${CMAKE_BINARY_DIR}
-      ${CMAKE_SOURCE_DIR}/cmake_compile_check/${_file}
-      CMAKE_FLAGS -DLINK_LIBRARIES:STRING=${_lib}
-      COMPILE_DEFINITIONS  ${_cflags}
-      
-      OUTPUT_VARIABLE ${_output}) 
-#MESSAGE( ./compile.log &quot;Compile:${MYOUTPUT}&quot;)
-ENDMACRO (ADM_COMPILE _file _cflags _varToSet _output)
-#########################################################
-MACRO (ADM_COMPILE_WITH_WITHOUT _file _cflags _lib _varToSet)
-
-ADM_COMPILE( ${_file} ${_cflags} ${_lib} CWITH logwith)
-ADM_COMPILE( ${_file} &quot;&quot; ${_lib}  CWITHOUT logwithout)
-
-if(CWITH AND NOT CWITHOUT)
-  SET(${_varToSet}  1)
-  MESSAGE (STATUS &quot;&lt;${_cflags}&gt; needed&quot;)
-else(CWITH AND NOT CWITHOUT)
-  if(NOT CWITH AND CWITHOUT)
-    MESSAGE (STATUS &quot;&lt;${_cflags}&gt; Not needed&quot;)
-  else(NOT CWITH AND CWITHOUT)
-    if(NOT CWIDTH AND NOT CWITHOUT)
-      MESSAGE(STATUS &quot;Inconsistent compiler output with:${CWITH}, without:${CWITHOUT}&quot;)
-      MESSAGE(STATUS &quot;**********************************&quot;)
-      MESSAGE(STATUS &quot;${logwith}&quot;)
-      MESSAGE(STATUS &quot;**********************************&quot;)
-      MESSAGE(STATUS &quot;${logwithout}&quot;)
-    endif(NOT CWIDTH AND NOT CWITHOUT)
-  endif(NOT CWITH AND CWITHOUT)
-endif(CWITH AND NOT CWITHOUT)
-ENDMACRO (ADM_COMPILE_WITH_WITHOUT _file _cflags _varToSet)
-
-
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/conf_summary.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,44 +0,0 @@
-MACRO(ADM_DISPLAY _name _val)
-#MESSAGE(&quot;${_val}&quot;)
-if(${_val} EQUAL 1)
-  set(s &quot;Yes&quot;)
-else(${_val} EQUAL 1)
-  set(s &quot;No&quot;)
-endif(${_val} EQUAL 1)
-MESSAGE(&quot;${_name}  ${s}&quot;) 
-ENDMACRO(ADM_DISPLAY _name _val)
-
-
-
-MESSAGE(&quot;*******************&quot;)
-MESSAGE(&quot;**  Summary      **&quot;)
-MESSAGE(&quot;*******************&quot;)
-MESSAGE(&quot;Gtk         ${GTK_FOUND}&quot;)
-MESSAGE(&quot;Qt4         ${QT4_FOUND}&quot;)
-MESSAGE(&quot;*** Video Codec ***&quot;)
-ADM_DISPLAY(&quot;X264      &quot; USE_X264)
-ADM_DISPLAY(&quot;Xvid4     &quot; USE_XVID_4)
-MESSAGE(&quot;*** Audio Codec ***&quot;)
-ADM_DISPLAY(&quot;LAME      &quot; HAVE_LIBMP3LAME)
-ADM_DISPLAY(&quot;FAAD      &quot; USE_FAAD)
-ADM_DISPLAY(&quot;FAAC      &quot; USE_FAAC)
-ADM_DISPLAY(&quot;Vorbis    &quot; USE_VORBIS)
-ADM_DISPLAY(&quot;Aften     &quot; USE_AFTEN)
-ADM_DISPLAY(&quot;libDCA    &quot; USE_LIBDCA)
-ADM_DISPLAY(&quot;libAMRNB  &quot; USE_AMR_NB)
-
-MESSAGE(&quot;*** Audio Device ***&quot;)
-ADM_DISPLAY(&quot;ESD       &quot; USE_ESD)
-ADM_DISPLAY(&quot;OSS       &quot; OSS_SUPPORT)
-ADM_DISPLAY(&quot;ARTS      &quot; USE_ARTS)
-ADM_DISPLAY(&quot;JACK      &quot; USE_JACK)
-
-MESSAGE(&quot;*** Misc       ***&quot;)
-ADM_DISPLAY(&quot;SDL       &quot; USE_SDL)
-ADM_DISPLAY(&quot;FreeType  &quot; USE_FREETYPE)
-ADM_DISPLAY(&quot;FontConfig&quot; USE_FONTCONFIG)
-ADM_DISPLAY(&quot;Gettext   &quot; HAVE_GETTEXT)
-ADM_DISPLAY(&quot;Xvideo    &quot; USE_XV)
-ADM_DISPLAY(&quot;samplerate&quot; USE_SRC)
-MESSAGE(&quot;*******************&quot;)
-MESSAGE(&quot;*******************&quot;)

Copied: branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake (from rev 3689, branches/avidemux_2.5_branch_gruntster/config.h.cmake)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/config.h.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -0,0 +1,246 @@
+/* config.h.in.  Generated from configure.in by autoheader.  */
+
+/* Jog Shuttle */
+#cmakedefine USE_JOG
+
+/* MPEG2DEC */
+#cmakedefine ACCEL_DETECT
+
+/* Big endian CPU - SPARC or PowerPC */
+#cmakedefine ADM_BIG_ENDIAN
+
+#define PACKAGE   &quot;avidemux&quot;
+#define ADMLOCALE &quot;${ADM_LOCALE}&quot;
+
+/* BSD OS specific ifdef */
+#cmakedefine ADM_BSD_FAMILY
+
+#cmakedefine HAVE_AUDIO
+
+/* Sparc workstations */
+#cmakedefine ADM_SPARC
+
+/* Build for Windows 32bits */
+#cmakedefine ADM_WIN32
+
+/* use ALSA as possible audio device */
+#cmakedefine ALSA_SUPPORT
+
+/* AMR_NB */
+#cmakedefine AMR_NB
+
+/* X86_64 AMD64 assembly */
+#cmakedefine ARCH_64_BITS
+
+/* Enable PowerPC optim */
+#cmakedefine ARCH_POWERPC
+
+/* AltiVec for libmpeg2 */
+#cmakedefine ARCH_PPC
+
+/* post proc */
+#cmakedefine ARCH_X86
+
+/* X86_32 assembly */
+#cmakedefine ARCH_X86_32
+
+/* X86_64 AMD64 assembly */
+#cmakedefine ARCH_X86_64
+
+/* FFMPEG */
+#cmakedefine CONFIG_ENCODERS
+#cmakedefine CONFIG_DVVIDEO_ENCODER
+
+#cmakedefine CONFIG_DECODERS
+#cmakedefine CONFIG_DVVIDEO_DECODER
+#cmakedefine CONFIG_H263_DECODER
+#cmakedefine CONFIG_MPEG4_DECODER
+#cmakedefine CONFIG_MPEGAUDIO_HP
+#cmakedefine CONFIG_SNOW_DECODER
+#cmakedefine CONFIG_VC1_DECODER
+#cmakedefine CONFIG_WMV2_DECODER
+#cmakedefine CONFIG_WMV3_DECODER
+#cmakedefine CONFIG_ZLIB
+
+#cmakedefine CONFIG_MUXERS
+#cmakedefine CONFIG_MOV_MUXER
+#cmakedefine CONFIG_MP4_MUXER
+#cmakedefine CONFIG_PSP_MUXER
+#cmakedefine CONFIG_TG2_MUXER
+#cmakedefine CONFIG_TGP_MUXER
+
+#cmakedefine ENABLE_MMX ${ENABLE_MMX}
+#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
+#cmakedefine HAVE_FAST_UNALIGNED
+#cmakedefine HAVE_LRINTF
+#cmakedefine HAVE_MMX
+#cmakedefine HAVE_THREADS
+#cmakedefine RUNTIME_CPUDETECT
+
+#cmakedefine HAVE_FAST_64BIT
+#cmakedefine HAVE_SSSE3
+#cmakedefine CONFIG_DARWIN
+
+/* Name mangling */
+#cmakedefine CYG_MANGLING
+
+/* Mad */
+#cmakedefine FPM_DEFAULT
+#cmakedefine FPM_INTEL
+#cmakedefine FPM_PPC
+#cmakedefine FPM_SPARC
+
+/* Using GCC 2.9x.x */
+#cmakedefine GCC_2_95_X
+
+/* gettext package name */
+#cmakedefine GETTEXT_PACKAGE
+
+/* AltiVec for mpeg2enc */
+#cmakedefine HAVE_ALTIVEC
+
+/* Enable AltiVec by default */
+#cmakedefine HAVE_ALTIVEC_H
+
+/* Enable AltiVec by default */
+#cmakedefine HAVE_BUILTIN_VECTOR
+
+/* FontConfig detected */
+#cmakedefine HAVE_FONTCONFIG
+
+/* Define if the GNU gettext() function is already present or preinstalled. */
+#cmakedefine HAVE_GETTEXT
+
+/* Define to 1 if you have the `gettimeofday' function. */
+#cmakedefine HAVE_GETTIMEOFDAY
+
+/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */
+#cmakedefine HAVE_INTTYPES_H
+
+/* Define to 1 if you have the `mp3lame' library (-lmp3lame). */
+#cmakedefine HAVE_LIBMP3LAME
+
+/* Use malloc.h */
+#cmakedefine HAVE_MALLOC_H
+
+/* Define to 1 if you have the &lt;stdint.h&gt; header file. */
+#cmakedefine HAVE_STDINT_H
+
+/* Define to 1 if you have the &lt;sys/types.h&gt; header file. */
+#cmakedefine HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the &lt;unistd.h&gt; header file. */
+#cmakedefine HAVE_UNISTD_H
+
+/* stricter prototyping */
+#cmakedefine ICONV_NEED_CONST
+
+/* use classing FAAD support */
+#cmakedefine OLD_FAAD_PROTO
+
+/* OSS detected */
+#cmakedefine OSS_SUPPORT
+
+/* use liba52 */
+#cmakedefine USE_AC3
+
+/* use Aften AC3 encoder */
+#cmakedefine USE_AFTEN
+
+/* Use Aften 0.07 */
+#cmakedefine USE_AFTEN_07
+
+/* Use Aften 0.08 */
+#cmakedefine USE_AFTEN_08
+
+/* AltiVec for mpeg2enc */
+#cmakedefine USE_ALTIVEC
+
+/* Tell avidemux to use libamrnb */
+#cmakedefine USE_AMR_NB
+
+/* aRts detected */
+#cmakedefine USE_ARTS
+
+/* ESD detected */
+#cmakedefine USE_ESD
+
+/* Jack detected */
+#cmakedefine USE_JACK
+
+/* Use faac audio enccoder */
+#cmakedefine USE_FAAC
+
+/* FAAD2 detected */
+#cmakedefine USE_FAAD
+
+/* FFmpeg */
+#cmakedefine USE_FFMPEG
+
+/* FontConfig detected */
+#cmakedefine USE_FONTCONFIG
+
+/* FreeType2 detected */
+#cmakedefine USE_FREETYPE
+
+/* use late binding of selected libraries */
+#cmakedefine USE_LATE_BINDING
+
+/* libdca detected */
+#cmakedefine USE_LIBDCA
+
+/* Libxml2 is available */
+#cmakedefine USE_LIBXML2
+
+/* MJPEG */
+#cmakedefine USE_MJPEG
+
+/* use libmad */
+#cmakedefine USE_MP3
+
+/* libpng is available */
+#cmakedefine USE_PNG
+
+/* use libsamplerate */
+#cmakedefine USE_SRC
+
+/* SDL detected */
+#cmakedefine USE_SDL
+
+/* Vorbis detected */
+#cmakedefine USE_VORBIS
+
+/* use x264 encoder */
+#cmakedefine USE_X264
+
+/* XVideo detected */
+#cmakedefine USE_XV
+
+/* use Xvid 1.x API */
+#cmakedefine USE_XVID_4
+
+/* use Xvid 0.9 API */
+#cmakedefine USE_XX_XVID
+
+/* Version number of package */
+#define  VERSION &quot;${VERSION}&quot;
+
+/* Big endian CPU - SPARC or PowerPC */
+#cmakedefine WORDS_BIGENDIAN
+
+/* use Nvwa memory leak detector */
+#cmakedefine FIND_LEAKS
+
+#cmakedefine ADM_OS_DARWIN
+#cmakedefine ADM_OS_LINUX
+#cmakedefine ADM_OS_WINDOWS
+
+#cmakedefine ADM_CPU_X86
+#cmakedefine ADM_CPU_X86_64
+
+#ifdef ADM_OS_WINDOWS
+#define rindex strrchr
+#define index strchr
+#define ftello ftello64
+#define fseeko fseeko64
+#endif

Deleted: branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/cmake/lavcodec.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,43 +0,0 @@
-MACRO(SET_LAVCODEC_FLAGS)
-	SET(CONFIG_ENCODERS 1)
-	SET(CONFIG_DVVIDEO_ENCODER 1)
-
-	SET(CONFIG_DECODERS 1)
-	SET(CONFIG_DVVIDEO_DECODER 1)
-	SET(CONFIG_H263_DECODER 1)
-	SET(CONFIG_MPEG4_DECODER 1)
-	SET(CONFIG_MPEGAUDIO_HP 1)
-	SET(CONFIG_SNOW_DECODER 1)
-	SET(CONFIG_VC1_DECODER 1)
-	SET(CONFIG_WMV2_DECODER 1)
-	SET(CONFIG_WMV3_DECODER 1)
-	SET(CONFIG_ZLIB 1)
-
-	SET(CONFIG_MUXERS 1)
-	SET(CONFIG_MOV_MUXER 1)
-	SET(CONFIG_MP4_MUXER 1)
-	SET(CONFIG_PSP_MUXER 1)
-	SET(CONFIG_TG2_MUXER 1)
-	SET(CONFIG_TGP_MUXER 1)
-
-	SET(ENABLE_MMX 1)
-	SET(ENABLE_THREADS 1)
-	SET(HAVE_FAST_UNALIGNED 1)
-	SET(HAVE_LRINTF 1)
-	SET(HAVE_MMX 1)
-	SET(HAVE_THREADS 1)
-	SET(RUNTIME_CPUDETECT 1)
-	
-	IF (ADM_CPU_X86_64)
-		SET(HAVE_FAST_64BIT 1)
-	ENDIF (ADM_CPU_X86_64)
-
-	IF (NOT NO_SSSE3)
-		SET(HAVE_SSSE3 1)
-	ENDIF (NOT NO_SSSE3)
-
-	IF (ADM_OS_APPLE)
-		SET(CONFIG_DARWIN 1)
-	ENDIF (ADM_OS_APPLE)
-ENDMACRO(SET_LAVCODEC_FLAGS)
-

Deleted: branches/avidemux_2.5_branch_gruntster/config.h.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-12 12:29:32 UTC (rev 3689)
+++ branches/avidemux_2.5_branch_gruntster/config.h.cmake	2007-11-14 16:59:14 UTC (rev 3690)
@@ -1,276 +0,0 @@
-/* config.h.in.  Generated from configure.in by autoheader.  */
-
-/* Jog Shuttle */
-#cmakedefine USE_JOG
-
-/* MPEG2DEC */
-#cmakedefine ACCEL_DETECT
-
-/* Big endian CPU - SPARC or PowerPC */
-#cmakedefine ADM_BIG_ENDIAN
-
-#define PACKAGE   &quot;avidemux&quot;
-#define ADMLOCALE &quot;${ADM_LOCALE}&quot;
-
-/* BSD OS specific ifdef */
-#cmakedefine ADM_BSD_FAMILY
-
-#cmakedefine HAVE_AUDIO
-
-/* Sparc workstations */
-#cmakedefine ADM_SPARC
-
-/* Build for Windows 32bits */
-#cmakedefine ADM_WIN32
-
-/* ALSA is 1.0 */
-#cmakedefine ALSA_1_0_SUPPORT
-
-/* use ALSA as possible audio device */
-#cmakedefine ALSA_SUPPORT
-
-/* AMR_NB */
-#cmakedefine AMR_NB
-
-/* X86_64 AMD64 assembly */
-#cmakedefine ARCH_64_BITS
-
-/* Enable PowerPC optim */
-#cmakedefine ARCH_POWERPC
-
-/* AltiVec for libmpeg2 */
-#cmakedefine ARCH_PPC
-
-/* post proc */
-#cmakedefine ARCH_X86
-
-/* X86_32 assembly */
-#cmakedefine ARCH_X86_32
-
-/* X86_64 AMD64 assembly */
-#cmakedefine ARCH_X86_64
-
-/* FFMPEG */
-#cmakedefine CONFIG_ENCODERS
-#cmakedefine CONFIG_DVVIDEO_ENCODER
-
-#cmakedefine CONFIG_DECODERS
-#cmakedefine CONFIG_DVVIDEO_DECODER
-#cmakedefine CONFIG_H263_DECODER
-#cmakedefine CONFIG_MPEG4_DECODER
-#cmakedefine CONFIG_MPEGAUDIO_HP
-#cmakedefine CONFIG_SNOW_DECODER
-#cmakedefine CONFIG_VC1_DECODER
-#cmakedefine CONFIG_WMV2_DECODER
-#cmakedefine CONFIG_WMV3_DECODER
-#cmakedefine CONFIG_ZLIB
-
-#cmakedefine CONFIG_MUXERS
-#cmakedefine CONFIG_MOV_MUXER
-#cmakedefine CONFIG_MP4_MUXER
-#cmakedefine CONFIG_PSP_MUXER
-#cmakedefine CONFIG_TG2_MUXER
-#cmakedefine CONFIG_TGP_MUXER
-
-#cmakedefine ENABLE_MMX ${ENABLE_MMX}
-#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
-#cmakedefine HAVE_FAST_UNALIGNED
-#cmakedefine HAVE_LRINTF
-#cmakedefine HAVE_MMX
-#cmakedefine HAVE_THREADS
-#cmakedefine RUNTIME_CPUDETECT
-
-#cmakedefine HAVE_FAST_64BIT
-#cmakedefine HAVE_SSSE3
-#cmakedefine CONFIG_DARWIN
-
-/* Name mangling */
-#cmakedefine CYG_MANGLING
-
-/* Mad */
-#cmakedefine FPM_DEFAULT
-#cmakedefine FPM_INTEL
-#cmakedefine FPM_PPC
-#cmakedefine FPM_SPARC
-
-/* Using GCC 2.9x.x */
-#cmakedefine GCC_2_95_X
-
-/* gettext package name */
-#cmakedefine GETTEXT_PACKAGE
-
-/* AltiVec for mpeg2enc */
-#cmakedefine HAVE_ALTIVEC
-
-/* Enable AltiVec by default */
-#cmakedefine HAVE_ALTIVEC_H
-
-/* Enable AltiVec by default */
-#cmakedefine HAVE_BUILTIN_VECTOR
-
-/* FontConfig detected */
-#cmakedefine HAVE_FONTCONFIG
-
-/* Define if the GNU gettext() function is already present or preinstalled. */
-#cmakedefine HAVE_GETTEXT
-
-/* Define to 1 if you have the `gettimeofday' function. */
-#cmakedefine HAVE_GETTIMEOFDAY
-
-/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */
-#cmakedefine HAVE_INTTYPES_H
-
-/* Define to 1 if you have the `mp3lame' library (-lmp3lame). */
-#cmakedefine HAVE_LIBMP3LAME
-
-/* Use malloc.h */
-#cmakedefine HAVE_MALLOC_H
-
-/* Define to 1 if you have the &lt;stdint.h&gt; header file. */
-#cmakedefine HAVE_STDINT_H
-
-/* Define to 1 if you have the &lt;stdlib.h&gt; header file. */
-#cmakedefine HAVE_STDLIB_H
-
-/* Define to 1 if you have the &lt;string.h&gt; header file. */
-#cmakedefine HAVE_STRING_H
-
-/* Define to 1 if you have the &lt;sys/stat.h&gt; header file. */
-#cmakedefine HAVE_SYS_STAT_H
-
-/* Define to 1 if you have the &lt;sys/types.h&gt; header file. */
-#cmakedefine HAVE_SYS_TYPES_H
-
-/* Define to 1 if you have the &lt;unistd.h&gt; header file. */
-#cmakedefine HAVE_UNISTD_H
-
-/* stricter prototyping */
-#cmakedefine ICONV_NEED_CONST
-
-/* use classing FAAD support */
-#cmakedefine OLD_FAAD_PROTO
-
-/* OSS detected */
-#cmakedefine OSS_SUPPORT
-
-/* Name of package */
-#cmakedefine PACKAGE
-
-/* Define to the address where bug reports for this package should be sent. */
-#cmakedefine PACKAGE_BUGREPORT
-
-/* Define to the full name of this package. */
-#cmakedefine PACKAGE_NAME
-
-/* Define to the full name and version of this package. */
-#cmakedefine PACKAGE_STRING
-
-/* Define to the one symbol short name of this package. */
-#cmakedefine PACKAGE_TARNAME
-
-/* Define to the version of this package. */
-#cmakedefine PACKAGE_VERSION
-
-/* use liba52 */
-#cmakedefine USE_AC3
-
-/* use Aften AC3 encoder */
-#cmakedefine USE_AFTEN
-
-/* Use Aften 0.07 */
-#cmakedefine USE_AFTEN_07
-
-/* Use Aften 0.08 */
-#cmakedefine USE_AFTEN_08
-
-/* AltiVec for mpeg2enc */
-#cmakedefine USE_ALTIVEC
-
-/* Tell avidemux to use libamrnb */
-#cmakedefine USE_AMR_NB
-
-/* aRts detected */
-#cmakedefine USE_ARTS
-
-/* ESD detected */
-#cmakedefine USE_ESD
-
-/* Jack detected */
-#cmakedefine USE_JACK
-
-/* Use faac audio enccoder */
-#cmakedefine USE_FAAC
-
-/* FAAD2 detected */
-#cmakedefine USE_FAAD
-
-/* FFmpeg */
-#cmakedefine USE_FFMPEG
-
-/* FontConfig detected */
-#cmakedefine USE_FONTCONFIG
-
-/* FreeType2 detected */
-#cmakedefine USE_FREETYPE
-
-/* use late binding of selected libraries */
-#cmakedefine USE_LATE_BINDING
-
-/* libdca detected */
-#cmakedefine USE_LIBDCA
-
-/* Libxml2 is available */
-#cmakedefine USE_LIBXML2
-
-/* MJPEG */
-#cmakedefine USE_MJPEG
-
-/* use libmad */
-#cmakedefine USE_MP3
-
-/* libpng is available */
-#cmakedefine USE_PNG
-
-/* use libsamplerate */
-#cmakedefine USE_SRC
-
-/* SDL detected */
-#cmakedefine USE_SDL
-
-/* Vorbis detected */
-#cmakedefine USE_VORBIS
-
-/* use x264 encoder */
-#cmakedefine USE_X264
-
-/* XVideo detected */
-#cmakedefine USE_XV
-
-/* use Xvid 1.x API */
-#cmakedefine USE_XVID_4
-
-/* use Xvid 0.9 API */
-#cmakedefine USE_XX_XVID
-
-/* Version number of package */
-#define  VERSION &quot;${VERSION}&quot;
-
-/* Big endian CPU - SPARC or PowerPC */
-#cmakedefine WORDS_BIGENDIAN
-
-/* use Nvwa memory leak detector */
-#cmakedefine FIND_LEAKS
-
-#cmakedefine ADM_OS_APPLE
-#cmakedefine ADM_OS_UNIX
-#cmakedefine ADM_OS_WINDOWS
-
-#cmakedefine ADM_CPU_X86
-#cmakedefine ADM_CPU_X86_64
-
-#ifdef ADM_OS_WINDOWS
-#define rindex strrchr
-#define index strchr
-#define ftello ftello64
-#define fseeko fseeko64
-#endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000958.html">[Avidemux-svn-commit] r3689 - branches
</A></li>
	<LI>Next message: <A HREF="000960.html">[Avidemux-svn-commit] r3691 - in	branches/avidemux_2.5_branch_gruntster: avidemux cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#959">[ date ]</a>
              <a href="thread.html#959">[ thread ]</a>
              <a href="subject.html#959">[ subject ]</a>
              <a href="author.html#959">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
