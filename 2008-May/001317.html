<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4060 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_plugin	plugins/ADM_videoEncoder/ADM_vidEnc_x264	plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4	plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4060%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%20.%20ADM_plugin%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml&In-Reply-To=%3C200805231639.m4NGdNrN012277%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001316.html">
   <LINK REL="Next"  HREF="001318.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4060 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_plugin	plugins/ADM_videoEncoder/ADM_vidEnc_x264	plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4	plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4060%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%20.%20ADM_plugin%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml&In-Reply-To=%3C200805231639.m4NGdNrN012277%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4060 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_plugin	plugins/ADM_videoEncoder/ADM_vidEnc_x264	plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4	plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml">gruntster at mail.berlios.de
       </A><BR>
    <I>Fri May 23 18:39:23 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001316.html">[Avidemux-svn-commit] r4059 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_UIs/ADM_GTK/include avidemux/ADM_UIs/ADM_GTK/src	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/plugins/ADM_videoFilters/MPDelogo/gtk cmake
</A></li>
        <LI>Next message: <A HREF="001318.html">[Avidemux-svn-commit] r4061 - in	branches/avidemux_2.5_branch_gruntster: .	avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1317">[ date ]</a>
              <a href="thread.html#1317">[ thread ]</a>
              <a href="subject.html#1317">[ subject ]</a>
              <a href="author.html#1317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2008-05-23 18:39:03 +0200 (Fri, 23 May 2008)
New Revision: 4060

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
Log:
[x264] multiple configurations

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h	2008-05-23 16:39:03 UTC (rev 4060)
@@ -28,15 +28,15 @@
 #define ADM_VIDENC_ERR_PASS_ALREADY_OPEN -5
 #define ADM_VIDENC_ERR_PASS_COUNT_REACHED -6
 
-#define ADM_VIDENC_MODE_CBR 0
-#define ADM_VIDENC_MODE_CQP 1
-#define ADM_VIDENC_MODE_AQP 2
-#define ADM_VIDENC_MODE_2PASS_SIZE 3
-#define ADM_VIDENC_MODE_2PASS_ABR 4
+#define ADM_VIDENC_MODE_CBR 1
+#define ADM_VIDENC_MODE_CQP 2
+#define ADM_VIDENC_MODE_AQP 3
+#define ADM_VIDENC_MODE_2PASS_SIZE 4
+#define ADM_VIDENC_MODE_2PASS_ABR 5
 
-#define ADM_VIDENC_FRAMETYPE_IDR 0
-#define ADM_VIDENC_FRAMETYPE_B 1
-#define ADM_VIDENC_FRAMETYPE_P 2
+#define ADM_VIDENC_FRAMETYPE_IDR 1
+#define ADM_VIDENC_FRAMETYPE_B 2
+#define ADM_VIDENC_FRAMETYPE_P 3
 
 #include &quot;DIA_uiTypes.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-05-23 16:39:03 UTC (rev 4060)
@@ -110,11 +110,11 @@
 
 IF (WIN32)
 	# add icon and version info
-	SET(FILEVERSION_STRING &quot;${VERSION}.0.${ADM_SUBVERSION}&quot;)
+	SET(FILEVERSION_STRING &quot;${VERSION}.${ADM_SUBVERSION}&quot;)
 	SET(PRODUCTVERSION_STRING &quot;${VERSION}&quot;)
 	STRING(REPLACE &quot;.&quot; &quot;,&quot; FILEVERSION ${FILEVERSION_STRING})
 	STRING(REPLACE &quot;.&quot; &quot;,&quot; PRODUCTVERSION ${PRODUCTVERSION_STRING})
-	SET(PRODUCTVERSION &quot;${PRODUCTVERSION},0,0&quot;)
+	SET(PRODUCTVERSION &quot;${PRODUCTVERSION},0&quot;)
 
 	CONFIGURE_FILE(&quot;${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in&quot; ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
 	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2008-05-23 16:39:03 UTC (rev 4060)
@@ -14,12 +14,13 @@
 		SET(QT_PLUGIN_NAME &quot;ADM_vidEnc_x264_Qt&quot;)
 		SET(GTK_PLUGIN_NAME &quot;ADM_vidEnc_x264_Gtk&quot;)
 		SET(PLUGIN_SUBDIR &quot;x264&quot;)
-		SET(ADM_vidEnc_x264_SRCS interface.c configGuiLoader.cpp encoder.cpp guiHelper.cpp options.cpp zoneOptions.cpp)
+		SET(ADM_vidEnc_x264_SRCS interface.c configGuiLoader.cpp encoder.cpp guiHelper.cpp options.cpp presetOptions.cpp zoneOptions.cpp)
 
 		CONFIGURE_FILE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
 
 		ADD_SUBDIRECTORY(gtk)
 		ADD_SUBDIRECTORY(qt4)
+		ADD_SUBDIRECTORY(xml)
 		ADD_LIBRARY(ADM_vidEnc_x264 SHARED ${ADM_vidEnc_x264_SRCS})
 		TARGET_LINK_LIBRARIES(ADM_vidEnc_x264 ADM_core ${X264_LIBRARY_DIR} ${LIBXML2_LIBRARIES})
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2008-05-23 16:39:03 UTC (rev 4060)
@@ -1,6 +1,13 @@
  /***************************************************************************
                                x264Options.cpp
 
+	These settings are intended for scripting and can contain a Preset 
+	Configuration block.  If this block exists then &quot;internal&quot; settings are
+	ignored and an external configuration file should be read instead, 
+	e.g. PlayStation Portable profile.  However, if the external file is 
+	missing, internal settings have to be used and will reflect a snapshot
+	of the external configuration file at the time the script was generated.
+
     begin                : Mon Apr 21 2008
     copyright            : (C) 2008 by gruntster
  ***************************************************************************/
@@ -25,23 +32,44 @@
 
 x264Options::x264Options(void)
 {
-	x264_param_default(&amp;_param);
-	_param.rc.psz_rc_eq = strdup(_param.rc.psz_rc_eq);
-	_param.vui.i_sar_height = 1;
-	_param.vui.i_sar_width = 1;
-	_param.i_threads = 0;	// set to auto-detect, default is disabled
+	_configurationName = NULL;
+	memset(&amp;_param, 0, sizeof(x264_param_t));
 
-	_sarAsInput = false;
+	reset();
 }
 
 x264Options::~x264Options(void)
 {
+	cleanUp();
+}
+
+void x264Options::cleanUp(void)
+{
 	if (_param.rc.psz_rc_eq)
+	{
 		free(_param.rc.psz_rc_eq);
+		_param.rc.psz_rc_eq = NULL;
+	}
 
+	clearPresetConfiguration();
 	clearZones();
 }
 
+void x264Options::reset(void)
+{
+	cleanUp();
+
+	x264_param_default(&amp;_param);
+	_param.rc.psz_rc_eq = strdup(_param.rc.psz_rc_eq);
+	_param.vui.i_sar_height = 1;
+	_param.vui.i_sar_width = 1;
+	_param.i_threads = 0;	// set to auto-detect; default is disabled
+
+	_sarAsInput = false;
+
+	setPresetConfiguration(&quot;&lt;default&gt;&quot;, CONFIG_DEFAULT);
+}
+
 x264_param_t* x264Options::getParameters(void)
 {
 	x264_param_t *param = new x264_param_t;
@@ -61,6 +89,33 @@
 	return param;
 }
 
+void x264Options::getPresetConfiguration(char** configurationName, configType *configurationType)
+{
+	if (_configurationName)
+		*configurationName = strdup(_configurationName);
+	else
+		*configurationName = NULL;
+
+	*configurationType = _configurationType;
+}
+
+void x264Options::setPresetConfiguration(const char* configurationName, configType configurationType)
+{
+	clearPresetConfiguration();
+
+	_configurationName = strdup(configurationName);
+	_configurationType = configurationType;
+}
+
+void x264Options::clearPresetConfiguration(void)
+{
+	if (_configurationName)
+		free(_configurationName);
+
+	_configurationName = &quot;&lt;custom&gt;&quot;;
+	_configurationType = CONFIG_CUSTOM;
+}
+
 int x264Options::getThreads(void)
 {
 	return _param.i_threads;
@@ -962,10 +1017,7 @@
 char* x264Options::toXml(void)
 {
 	xmlDocPtr xmlDoc = xmlNewDoc((const xmlChar*)&quot;1.0&quot;);
-	xmlNodePtr xmlNodeRoot;
-	xmlNodePtr xmlNodeChild, xmlNodeChild2;
-	xmlChar *tempBuffer;
-	int tempBufferSize;
+	xmlNodePtr xmlNodeRoot, xmlNodeChild;
 	const int bufferSize = 100;
 	xmlChar xmlBuffer[bufferSize + 1];
 	char *xml = NULL;
@@ -975,411 +1027,444 @@
 		if (!xmlDoc)
 			break;
 
-		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)&quot;x264Param&quot;, NULL)))
+		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)&quot;x264Config&quot;, NULL)))
 			break;
 
 		xmlDocSetRootElement(xmlDoc, xmlNodeRoot);
 
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;threads&quot;, number2String(xmlBuffer, bufferSize, getThreads()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;deterministic&quot;, boolean2String(xmlBuffer, bufferSize, getDeterministic()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;idcLevel&quot;, number2String(xmlBuffer, bufferSize, getIdcLevel()));
+		if (_configurationType != CONFIG_CUSTOM)
+		{
+			xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;presetConfiguration&quot;, NULL);
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;vui&quot;, NULL);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarAsInput&quot;, boolean2String(xmlBuffer, bufferSize, getSarAsInput()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarHeight&quot;, number2String(xmlBuffer, bufferSize, getSarHeight()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarWidth&quot;, number2String(xmlBuffer, bufferSize, getSarWidth()));
+			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;name&quot;, (xmlChar*)_configurationName);
 
-		switch (getOverscan())
-		{
-			case 0:
-				strcpy((char*)xmlBuffer, &quot;undefined&quot;);
-				break;
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;show&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;crop&quot;);
-				break;
+			if (_configurationType == CONFIG_USER)
+				strcpy((char*)xmlBuffer, &quot;user&quot;);
+			else if (_configurationType == CONFIG_SYSTEM)
+				strcpy((char*)xmlBuffer, &quot;system&quot;);
+			else
+				strcpy((char*)xmlBuffer, &quot;default&quot;);
+
+			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;type&quot;, xmlBuffer);
 		}
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;overscan&quot;, xmlBuffer);
+		addX264OptionsToXml(xmlNodeRoot);
+		xml = dumpXmlDocToMemory(xmlDoc);
+		xmlFreeDoc(xmlDoc);
 
-		switch (getVideoFormat())
-		{
-			case 0:
-				strcpy((char*)xmlBuffer, &quot;component&quot;);
-				break;
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;pal&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;ntsc&quot;);
-				break;
-			case 3:
-				strcpy((char*)xmlBuffer, &quot;secam&quot;);
-				break;
-			case 4:
-				strcpy((char*)xmlBuffer, &quot;mac&quot;);
-				break;
-			case 5:
-				strcpy((char*)xmlBuffer, &quot;undefined&quot;);
-				break;
-		}
+		break;
+	}
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;videoFormat&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;fullRangeSamples&quot;, boolean2String(xmlBuffer, bufferSize, getFullRangeSamples()));
+	return xml;
+}
 
-		switch (getColorPrimaries())
-		{
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;bt709&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;undefined&quot;);
-				break;
-			case 4:
-				strcpy((char*)xmlBuffer, &quot;bt470m&quot;);
-				break;
-			case 5:
-				strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
-				break;
-			case 6:
-				strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
-				break;
-			case 7:
-				strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
-				break;
-			case 8:
-				strcpy((char*)xmlBuffer, &quot;film&quot;);
-				break;
-		}
+char* x264Options::dumpXmlDocToMemory(xmlDocPtr xmlDoc)
+{
+	xmlChar *tempBuffer;
+	int tempBufferSize;
+	char *xml = NULL;
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;colorPrimaries&quot;, xmlBuffer);
+	xmlDocDumpMemory(xmlDoc, &amp;tempBuffer, &amp;tempBufferSize);
 
-		switch (getTransfer())
+	// remove carriage returns (even though libxml was instructed not to format the XML)
+	xmlChar* bufferChar = tempBuffer;
+	int bufferCharIndex = 0;
+
+	while (*bufferChar != '\0')
+	{
+		if (*bufferChar == '\n')
 		{
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;bt709&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;undefined&quot;);
-				break;
-			case 4:
-				strcpy((char*)xmlBuffer, &quot;bt470m&quot;);
-				break;
-			case 5:
-				strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
-				break;
-			case 6:
-				strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
-				break;
-			case 7:
-				strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
-				break;
-			case 8:
-				strcpy((char*)xmlBuffer, &quot;linear&quot;);
-				break;
-			case 9:
-				strcpy((char*)xmlBuffer, &quot;log100&quot;);
-				break;
-			case 10:
-				strcpy((char*)xmlBuffer, &quot;log316&quot;);
-				break;
+			memmove(bufferChar, bufferChar + 1, tempBufferSize - bufferCharIndex);
+			tempBufferSize--;
 		}
+		else if (*bufferChar == '\&quot;')
+			*bufferChar = '\'';
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;transfer&quot;, xmlBuffer);
+		bufferChar++;
+		bufferCharIndex++;
+	}
 
-		switch (getColorMatrix())
-		{
-			case 0:
-				strcpy((char*)xmlBuffer, &quot;gbr&quot;);
-				break;
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;bt709&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;undefined&quot;);
-				break;
-			case 4:
-				strcpy((char*)xmlBuffer, &quot;fcc&quot;);
-				break;
-			case 5:
-				strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
-				break;
-			case 6:
-				strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
-				break;
-			case 7:
-				strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
-				break;
-			case 8:
-				strcpy((char*)xmlBuffer, &quot;ycgco&quot;);
-				break;
-		}
+	xml = new char[tempBufferSize + 1];
+	memcpy(xml, tempBuffer, tempBufferSize);
+	xml[tempBufferSize] = 0;
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;colorMatrix&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaSampleLocation&quot;, number2String(xmlBuffer, bufferSize, getChromaSampleLocation()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;referenceFrames&quot;, number2String(xmlBuffer, bufferSize, getReferenceFrames()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;gopMaximumSize&quot;, number2String(xmlBuffer, bufferSize, getGopMaximumSize()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;gopMinimumSize&quot;, number2String(xmlBuffer, bufferSize, getGopMinimumSize()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;scenecutThreshold&quot;, number2String(xmlBuffer, bufferSize, getScenecutThreshold()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;preScenecutDetection&quot;, boolean2String(xmlBuffer, bufferSize, getPreScenecutDetection()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrames&quot;, number2String(xmlBuffer, bufferSize, getBFrames()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;adaptiveBframeDecision&quot;, boolean2String(xmlBuffer, bufferSize, getAdaptiveBFrameDecision()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrameBias&quot;, number2String(xmlBuffer, bufferSize, getBFrameBias()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrameReferences&quot;, number2String(xmlBuffer, bufferSize, getBFrameReferences()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilter&quot;, boolean2String(xmlBuffer, bufferSize, getLoopFilter()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilterAlphaC0&quot;, number2String(xmlBuffer, bufferSize, getLoopFilterAlphaC0()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilterBeta&quot;, number2String(xmlBuffer, bufferSize, getLoopFilterBeta()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;cabac&quot;, boolean2String(xmlBuffer, bufferSize, getCabac()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;interlaced&quot;, boolean2String(xmlBuffer, bufferSize, getInterlaced()));
+	return xml;
+}
 
-		switch (getCqmPreset())
-		{
-			case X264_CQM_FLAT:
-				strcpy((char*)xmlBuffer, &quot;flat&quot;);
-				break;
-			case X264_CQM_JVT:
-				strcpy((char*)xmlBuffer, &quot;jvt&quot;);
-				break;
-			case X264_CQM_CUSTOM:
-				strcpy((char*)xmlBuffer, &quot;custom&quot;);
-				break;
-		}
+void x264Options::addX264OptionsToXml(xmlNodePtr xmlNodeRoot)
+{
+	const int bufferSize = 100;
+	xmlChar xmlBuffer[bufferSize + 1];
+	xmlNodePtr xmlNodeChild, xmlNodeChild2;
 
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;cqmPreset&quot;, xmlBuffer);
+	xmlNodeRoot = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;x264Options&quot;, NULL);
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;threads&quot;, number2String(xmlBuffer, bufferSize, getThreads()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;deterministic&quot;, boolean2String(xmlBuffer, bufferSize, getDeterministic()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;idcLevel&quot;, number2String(xmlBuffer, bufferSize, getIdcLevel()));
 
-		uint8_t* intra4x4Luma = getIntra4x4Luma();
-		uint8_t* intraChroma = getIntraChroma();
-		uint8_t* inter4x4Luma = getInter4x4Luma();
-		uint8_t* interChroma = getInterChroma();
-		uint8_t* intra8x8Luma = getIntra8x8Luma();
-		uint8_t* inter8x8Luma = getInter8x8Luma();
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;vui&quot;, NULL);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarAsInput&quot;, boolean2String(xmlBuffer, bufferSize, getSarAsInput()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarHeight&quot;, number2String(xmlBuffer, bufferSize, getSarHeight()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarWidth&quot;, number2String(xmlBuffer, bufferSize, getSarWidth()));
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intra4x4Luma&quot;, NULL);
+	switch (getOverscan())
+	{
+		case 0:
+			strcpy((char*)xmlBuffer, &quot;undefined&quot;);
+			break;
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;show&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;crop&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 16; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intra4x4Luma[i]));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;overscan&quot;, xmlBuffer);
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intraChroma&quot;, NULL);
+	switch (getVideoFormat())
+	{
+		case 0:
+			strcpy((char*)xmlBuffer, &quot;component&quot;);
+			break;
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;pal&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;ntsc&quot;);
+			break;
+		case 3:
+			strcpy((char*)xmlBuffer, &quot;secam&quot;);
+			break;
+		case 4:
+			strcpy((char*)xmlBuffer, &quot;mac&quot;);
+			break;
+		case 5:
+			strcpy((char*)xmlBuffer, &quot;undefined&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 16; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intraChroma[i]));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;videoFormat&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;fullRangeSamples&quot;, boolean2String(xmlBuffer, bufferSize, getFullRangeSamples()));
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;inter4x4Luma&quot;, NULL);
+	switch (getColorPrimaries())
+	{
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;bt709&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;undefined&quot;);
+			break;
+		case 4:
+			strcpy((char*)xmlBuffer, &quot;bt470m&quot;);
+			break;
+		case 5:
+			strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
+			break;
+		case 6:
+			strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
+			break;
+		case 7:
+			strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
+			break;
+		case 8:
+			strcpy((char*)xmlBuffer, &quot;film&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 16; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, inter4x4Luma[i]));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;colorPrimaries&quot;, xmlBuffer);
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;interChroma&quot;, NULL);
+	switch (getTransfer())
+	{
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;bt709&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;undefined&quot;);
+			break;
+		case 4:
+			strcpy((char*)xmlBuffer, &quot;bt470m&quot;);
+			break;
+		case 5:
+			strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
+			break;
+		case 6:
+			strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
+			break;
+		case 7:
+			strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
+			break;
+		case 8:
+			strcpy((char*)xmlBuffer, &quot;linear&quot;);
+			break;
+		case 9:
+			strcpy((char*)xmlBuffer, &quot;log100&quot;);
+			break;
+		case 10:
+			strcpy((char*)xmlBuffer, &quot;log316&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 16; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, interChroma[i]));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;transfer&quot;, xmlBuffer);
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intra8x8Luma&quot;, NULL);
+	switch (getColorMatrix())
+	{
+		case 0:
+			strcpy((char*)xmlBuffer, &quot;gbr&quot;);
+			break;
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;bt709&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;undefined&quot;);
+			break;
+		case 4:
+			strcpy((char*)xmlBuffer, &quot;fcc&quot;);
+			break;
+		case 5:
+			strcpy((char*)xmlBuffer, &quot;bt470bg&quot;);
+			break;
+		case 6:
+			strcpy((char*)xmlBuffer, &quot;smpte170m&quot;);
+			break;
+		case 7:
+			strcpy((char*)xmlBuffer, &quot;smpte240m&quot;);
+			break;
+		case 8:
+			strcpy((char*)xmlBuffer, &quot;ycgco&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 64; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intra8x8Luma[i]));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;colorMatrix&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaSampleLocation&quot;, number2String(xmlBuffer, bufferSize, getChromaSampleLocation()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;referenceFrames&quot;, number2String(xmlBuffer, bufferSize, getReferenceFrames()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;gopMaximumSize&quot;, number2String(xmlBuffer, bufferSize, getGopMaximumSize()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;gopMinimumSize&quot;, number2String(xmlBuffer, bufferSize, getGopMinimumSize()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;scenecutThreshold&quot;, number2String(xmlBuffer, bufferSize, getScenecutThreshold()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;preScenecutDetection&quot;, boolean2String(xmlBuffer, bufferSize, getPreScenecutDetection()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrames&quot;, number2String(xmlBuffer, bufferSize, getBFrames()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;adaptiveBframeDecision&quot;, boolean2String(xmlBuffer, bufferSize, getAdaptiveBFrameDecision()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrameBias&quot;, number2String(xmlBuffer, bufferSize, getBFrameBias()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;bFrameReferences&quot;, number2String(xmlBuffer, bufferSize, getBFrameReferences()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilter&quot;, boolean2String(xmlBuffer, bufferSize, getLoopFilter()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilterAlphaC0&quot;, number2String(xmlBuffer, bufferSize, getLoopFilterAlphaC0()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;loopFilterBeta&quot;, number2String(xmlBuffer, bufferSize, getLoopFilterBeta()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;cabac&quot;, boolean2String(xmlBuffer, bufferSize, getCabac()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;interlaced&quot;, boolean2String(xmlBuffer, bufferSize, getInterlaced()));
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;inter8x8Luma&quot;, NULL);
+	switch (getCqmPreset())
+	{
+		case X264_CQM_FLAT:
+			strcpy((char*)xmlBuffer, &quot;flat&quot;);
+			break;
+		case X264_CQM_JVT:
+			strcpy((char*)xmlBuffer, &quot;jvt&quot;);
+			break;
+		case X264_CQM_CUSTOM:
+			strcpy((char*)xmlBuffer, &quot;custom&quot;);
+			break;
+	}
 
-		for (int i = 0; i &lt; 64; i++)
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, inter8x8Luma[i]));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;cqmPreset&quot;, xmlBuffer);
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;analyse&quot;, NULL);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionI4x4&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionI4x4()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionI8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionI8x8()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionP8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionP8x8()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionP4x4&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionP4x4()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionB8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionB8x8()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;dct8x8&quot;, boolean2String(xmlBuffer, bufferSize, getDct8x8()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;weightedPrediction&quot;, boolean2String(xmlBuffer, bufferSize, getWeightedPrediction()));
+	uint8_t* intra4x4Luma = getIntra4x4Luma();
+	uint8_t* intraChroma = getIntraChroma();
+	uint8_t* inter4x4Luma = getInter4x4Luma();
+	uint8_t* interChroma = getInterChroma();
+	uint8_t* intra8x8Luma = getIntra8x8Luma();
+	uint8_t* inter8x8Luma = getInter8x8Luma();
 
-		switch (getDirectPredictionMode())
-		{
-			case X264_DIRECT_PRED_NONE:
-				strcpy((char*)xmlBuffer, &quot;none&quot;);
-				break;
-			case X264_DIRECT_PRED_SPATIAL:
-				strcpy((char*)xmlBuffer, &quot;spatial&quot;);
-				break;
-			case X264_DIRECT_PRED_TEMPORAL:
-				strcpy((char*)xmlBuffer, &quot;temporal&quot;);
-				break;
-			case X264_DIRECT_PRED_AUTO:
-				strcpy((char*)xmlBuffer, &quot;auto&quot;);
-				break;
-		}
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intra4x4Luma&quot;, NULL);
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;directPredictionMode&quot;, xmlBuffer);
+	for (int i = 0; i &lt; 16; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intra4x4Luma[i]));
 
-		switch (getDirectPredictionSize())
-		{
-			case 0:
-				strcpy((char*)xmlBuffer, &quot;4x4&quot;);
-				break;
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;8x8&quot;);
-				break;
-			case -1:
-				strcpy((char*)xmlBuffer, &quot;smallest&quot;);
-				break;
-		}
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intraChroma&quot;, NULL);
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;directPredictionSize&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaLumaQuantiserDifference&quot;, number2String(xmlBuffer, bufferSize, getChromaLumaQuantiserDifference()));
+	for (int i = 0; i &lt; 16; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intraChroma[i]));
 
-		switch (getMotionEstimationMethod())
-		{
-			case X264_ME_DIA:
-				strcpy((char*)xmlBuffer, &quot;diamond&quot;);
-				break;
-			case X264_ME_UMH:
-				strcpy((char*)xmlBuffer, &quot;multi-hexagonal&quot;);
-				break;
-			case X264_ME_ESA:
-				strcpy((char*)xmlBuffer, &quot;exhaustive&quot;);
-				break;
-#if X264_BUILD &gt;= 57
-			case X264_ME_TESA:
-				strcpy((char*)xmlBuffer, &quot;hadamard&quot;);
-				break;
-#endif
-			case X264_ME_HEX:
-			default:
-				strcpy((char*)xmlBuffer, &quot;hexagonal&quot;);
-				break;
-		}
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;inter4x4Luma&quot;, NULL);
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionEstimationMethod&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorSearchRange&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorSearchRange()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorLength&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorLength()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorThreadBuffer&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorThreadBuffer()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;subpixelRefinement&quot;, number2String(xmlBuffer, bufferSize, getSubpixelRefinement()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;bidirectionalMotionEstimation&quot;, boolean2String(xmlBuffer, bufferSize, getBidirectionalMotionEstimation()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaMotionEstimation&quot;, boolean2String(xmlBuffer, bufferSize, getChromaMotionEstimation()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;bFrameRdo&quot;, boolean2String(xmlBuffer, bufferSize, getBFrameRdo()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;mixedReferences&quot;, boolean2String(xmlBuffer, bufferSize, getMixedReferences()));
+	for (int i = 0; i &lt; 16; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, inter4x4Luma[i]));
 
-		switch (getTrellis())
-		{
-			case 0:
-				strcpy((char*)xmlBuffer, &quot;disabled&quot;);
-				break;
-			case 1:
-				strcpy((char*)xmlBuffer, &quot;finalMacroblock&quot;);
-				break;
-			case 2:
-				strcpy((char*)xmlBuffer, &quot;allModeDecisions&quot;);
-				break;
-		}
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;interChroma&quot;, NULL);
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;trellis&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;fastPSkip&quot;, boolean2String(xmlBuffer, bufferSize, getFastPSkip()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;dctDecimate&quot;, boolean2String(xmlBuffer, bufferSize, getDctDecimate()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;noiseReduction&quot;, number2String(xmlBuffer, bufferSize, getNoiseReduction()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;interLumaDeadzone&quot;, number2String(xmlBuffer, bufferSize, getInterLumaDeadzone()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;intraLumaDeadzone&quot;, number2String(xmlBuffer, bufferSize, getIntraLumaDeadzone()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;computePsnr&quot;, boolean2String(xmlBuffer, bufferSize, getComputePsnr()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;computeSsim&quot;, boolean2String(xmlBuffer, bufferSize, getComputeSsim()));
+	for (int i = 0; i &lt; 16; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, interChroma[i]));
 
-		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;rateControl&quot;, NULL);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserMinimum&quot;, number2String(xmlBuffer, bufferSize, getQuantiserMinimum()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserMaximum&quot;, number2String(xmlBuffer, bufferSize, getQuantiserMaximum()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserStep&quot;, number2String(xmlBuffer, bufferSize, getQuantiserStep()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;averageBitrateTolerance&quot;, number2String(xmlBuffer, bufferSize, getAverageBitrateTolerance()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvMaximumBitrate&quot;, number2String(xmlBuffer, bufferSize, getVbvMaximumBitrate()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvBufferSize&quot;, number2String(xmlBuffer, bufferSize, getVbvBufferSize()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvInitialOccupancy&quot;, number2String(xmlBuffer, bufferSize, getVbvInitialOccupancy()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;ipFrameQuantiser&quot;, number2String(xmlBuffer, bufferSize, getIpFrameQuantiser()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;pbFrameQuantiser&quot;, number2String(xmlBuffer, bufferSize, getPbFrameQuantiser()));
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;intra8x8Luma&quot;, NULL);
 
-#if X264_BUILD &gt;= 59
-		switch (getAdaptiveQuantiserMode())
-		{
-			case X264_AQ_NONE:
-				strcpy((char*)xmlBuffer, &quot;none&quot;);
-				break;
-			case X264_AQ_LOCAL:
-				strcpy((char*)xmlBuffer, &quot;local&quot;);
-				break;
-			case X264_AQ_GLOBAL:
-				strcpy((char*)xmlBuffer, &quot;global&quot;);
-				break;
-		}
+	for (int i = 0; i &lt; 64; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, intra8x8Luma[i]));
 
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;adaptiveQuantiserMode&quot;, xmlBuffer);
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;adaptiveQuantiserStrength&quot;, number2String(xmlBuffer, bufferSize, getAdaptiveQuantiserStrength()));
-#endif
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;rateControlEquation&quot;, (xmlChar*)getRateControlEquation());
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getQuantiserCurveCompression()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;reduceFluxBeforeCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getReduceFluxBeforeCurveCompression()));
-		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;reduceFluxAfterCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getReduceFluxAfterCurveCompression()));
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;inter8x8Luma&quot;, NULL);
 
-		int zoneCount = getZoneCount();
+	for (int i = 0; i &lt; 64; i++)
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;value&quot;, number2String(xmlBuffer, bufferSize, inter8x8Luma[i]));
 
-		if (zoneCount)
-		{
-			x264ZoneOptions** zoneOptions = getZones();
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;analyse&quot;, NULL);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionI4x4&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionI4x4()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionI8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionI8x8()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionP8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionP8x8()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionP4x4&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionP4x4()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;partitionB8x8&quot;, boolean2String(xmlBuffer, bufferSize, getPartitionB8x8()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;dct8x8&quot;, boolean2String(xmlBuffer, bufferSize, getDct8x8()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;weightedPrediction&quot;, boolean2String(xmlBuffer, bufferSize, getWeightedPrediction()));
 
-			for (int zoneIndex = 0; zoneIndex &lt; zoneCount; zoneIndex++)
-			{
-				xmlNodeChild2 = xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;zone&quot;, NULL);
-				x264ZoneOptions* option = zoneOptions[zoneIndex];
+	switch (getDirectPredictionMode())
+	{
+		case X264_DIRECT_PRED_NONE:
+			strcpy((char*)xmlBuffer, &quot;none&quot;);
+			break;
+		case X264_DIRECT_PRED_SPATIAL:
+			strcpy((char*)xmlBuffer, &quot;spatial&quot;);
+			break;
+		case X264_DIRECT_PRED_TEMPORAL:
+			strcpy((char*)xmlBuffer, &quot;temporal&quot;);
+			break;
+		case X264_DIRECT_PRED_AUTO:
+			strcpy((char*)xmlBuffer, &quot;auto&quot;);
+			break;
+	}
 
-				xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;frameStart&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getFrameStart()));
-				xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;frameEnd&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getFrameEnd()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;directPredictionMode&quot;, xmlBuffer);
 
-				if (zoneOptions[zoneIndex]-&gt;getZoneMode() == ZONE_MODE_QUANTISER)
-					xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;quantiser&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getZoneParameter()));
-				else
-					xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;bitrateFactor&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getZoneParameter() / 100.f));
+	switch (getDirectPredictionSize())
+	{
+		case 0:
+			strcpy((char*)xmlBuffer, &quot;4x4&quot;);
+			break;
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;8x8&quot;);
+			break;
+		case -1:
+			strcpy((char*)xmlBuffer, &quot;smallest&quot;);
+			break;
+	}
 
-				delete option;
-			}
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;directPredictionSize&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaLumaQuantiserDifference&quot;, number2String(xmlBuffer, bufferSize, getChromaLumaQuantiserDifference()));
 
-			delete [] zoneOptions;
-		}
+	switch (getMotionEstimationMethod())
+	{
+		case X264_ME_DIA:
+			strcpy((char*)xmlBuffer, &quot;diamond&quot;);
+			break;
+		case X264_ME_UMH:
+			strcpy((char*)xmlBuffer, &quot;multi-hexagonal&quot;);
+			break;
+		case X264_ME_ESA:
+			strcpy((char*)xmlBuffer, &quot;exhaustive&quot;);
+			break;
+#if X264_BUILD &gt;= 57
+		case X264_ME_TESA:
+			strcpy((char*)xmlBuffer, &quot;hadamard&quot;);
+			break;
+#endif
+		case X264_ME_HEX:
+		default:
+			strcpy((char*)xmlBuffer, &quot;hexagonal&quot;);
+			break;
+	}
 
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;accessUnitDelimiters&quot;, boolean2String(xmlBuffer, bufferSize, getAccessUnitDelimiters()));
-		xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;spsIdentifier&quot;, number2String(xmlBuffer, bufferSize, getSpsIdentifier()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionEstimationMethod&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorSearchRange&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorSearchRange()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorLength&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorLength()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;motionVectorThreadBuffer&quot;, number2String(xmlBuffer, bufferSize, getMotionVectorThreadBuffer()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;subpixelRefinement&quot;, number2String(xmlBuffer, bufferSize, getSubpixelRefinement()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;bidirectionalMotionEstimation&quot;, boolean2String(xmlBuffer, bufferSize, getBidirectionalMotionEstimation()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;chromaMotionEstimation&quot;, boolean2String(xmlBuffer, bufferSize, getChromaMotionEstimation()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;bFrameRdo&quot;, boolean2String(xmlBuffer, bufferSize, getBFrameRdo()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;mixedReferences&quot;, boolean2String(xmlBuffer, bufferSize, getMixedReferences()));
 
-		xmlDocDumpMemory(xmlDoc, &amp;tempBuffer, &amp;tempBufferSize);
+	switch (getTrellis())
+	{
+		case 0:
+			strcpy((char*)xmlBuffer, &quot;disabled&quot;);
+			break;
+		case 1:
+			strcpy((char*)xmlBuffer, &quot;finalMacroblock&quot;);
+			break;
+		case 2:
+			strcpy((char*)xmlBuffer, &quot;allModeDecisions&quot;);
+			break;
+	}
 
-		// remove carriage returns (even though libxml was instructed not to format the XML)
-		xmlChar* bufferChar = tempBuffer;
-		int bufferCharIndex = 0;
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;trellis&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;fastPSkip&quot;, boolean2String(xmlBuffer, bufferSize, getFastPSkip()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;dctDecimate&quot;, boolean2String(xmlBuffer, bufferSize, getDctDecimate()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;noiseReduction&quot;, number2String(xmlBuffer, bufferSize, getNoiseReduction()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;interLumaDeadzone&quot;, number2String(xmlBuffer, bufferSize, getInterLumaDeadzone()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;intraLumaDeadzone&quot;, number2String(xmlBuffer, bufferSize, getIntraLumaDeadzone()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;computePsnr&quot;, boolean2String(xmlBuffer, bufferSize, getComputePsnr()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;computeSsim&quot;, boolean2String(xmlBuffer, bufferSize, getComputeSsim()));
 
-		while (*bufferChar != '\0')
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;rateControl&quot;, NULL);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserMinimum&quot;, number2String(xmlBuffer, bufferSize, getQuantiserMinimum()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserMaximum&quot;, number2String(xmlBuffer, bufferSize, getQuantiserMaximum()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserStep&quot;, number2String(xmlBuffer, bufferSize, getQuantiserStep()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;averageBitrateTolerance&quot;, number2String(xmlBuffer, bufferSize, getAverageBitrateTolerance()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvMaximumBitrate&quot;, number2String(xmlBuffer, bufferSize, getVbvMaximumBitrate()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvBufferSize&quot;, number2String(xmlBuffer, bufferSize, getVbvBufferSize()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;vbvInitialOccupancy&quot;, number2String(xmlBuffer, bufferSize, getVbvInitialOccupancy()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;ipFrameQuantiser&quot;, number2String(xmlBuffer, bufferSize, getIpFrameQuantiser()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;pbFrameQuantiser&quot;, number2String(xmlBuffer, bufferSize, getPbFrameQuantiser()));
+
+#if X264_BUILD &gt;= 59
+	switch (getAdaptiveQuantiserMode())
+	{
+		case X264_AQ_NONE:
+			strcpy((char*)xmlBuffer, &quot;none&quot;);
+			break;
+		case X264_AQ_LOCAL:
+			strcpy((char*)xmlBuffer, &quot;local&quot;);
+			break;
+		case X264_AQ_GLOBAL:
+			strcpy((char*)xmlBuffer, &quot;global&quot;);
+			break;
+	}
+
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;adaptiveQuantiserMode&quot;, xmlBuffer);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;adaptiveQuantiserStrength&quot;, number2String(xmlBuffer, bufferSize, getAdaptiveQuantiserStrength()));
+#endif
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;rateControlEquation&quot;, (xmlChar*)getRateControlEquation());
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;quantiserCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getQuantiserCurveCompression()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;reduceFluxBeforeCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getReduceFluxBeforeCurveCompression()));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;reduceFluxAfterCurveCompression&quot;, number2String(xmlBuffer, bufferSize, getReduceFluxAfterCurveCompression()));
+
+	int zoneCount = getZoneCount();
+
+	if (zoneCount)
+	{
+		x264ZoneOptions** zoneOptions = getZones();
+
+		for (int zoneIndex = 0; zoneIndex &lt; zoneCount; zoneIndex++)
 		{
-			if (*bufferChar == '\n')
-			{
-				memmove(bufferChar, bufferChar + 1, tempBufferSize - bufferCharIndex);
-				tempBufferSize--;
-			}
-			else if (*bufferChar == '\&quot;')
-				*bufferChar = '\'';
+			xmlNodeChild2 = xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;zone&quot;, NULL);
+			x264ZoneOptions* option = zoneOptions[zoneIndex];
 
-			bufferChar++;
-			bufferCharIndex++;
-		}
+			xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;frameStart&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getFrameStart()));
+			xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;frameEnd&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getFrameEnd()));
 
-		xml = new char[tempBufferSize + 1];
-		memcpy(xml, tempBuffer, tempBufferSize);
-		xml[tempBufferSize] = 0;
+			if (zoneOptions[zoneIndex]-&gt;getZoneMode() == ZONE_MODE_QUANTISER)
+				xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;quantiser&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getZoneParameter()));
+			else
+				xmlNewChild(xmlNodeChild2, NULL, (xmlChar*)&quot;bitrateFactor&quot;, number2String(xmlBuffer, bufferSize, option-&gt;getZoneParameter() / 100.f));
 
-		xmlFreeDoc(xmlDoc);
+			delete option;
+		}
 
-		break;
+		delete [] zoneOptions;
 	}
 
-	return xml;
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;accessUnitDelimiters&quot;, boolean2String(xmlBuffer, bufferSize, getAccessUnitDelimiters()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;spsIdentifier&quot;, number2String(xmlBuffer, bufferSize, getSpsIdentifier()));
 }
 
-int x264Options::fromXml(char *xml)
+bool x264Options::validateXml(xmlDocPtr doc)
 {
-	clearZones();
-
 	const char *schemaFile = &quot;x264Param.xsd&quot;;
 	char *pluginDir = ADM_getPluginPath();
 	char schemaPath[strlen(pluginDir) + strlen(PLUGIN_SUBDIR) + 1 + strlen(schemaFile) + 1];
@@ -1391,8 +1476,6 @@
 	strcat(schemaPath, schemaFile);
 	delete [] pluginDir;
 
-	// Validate XML
-	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;x264.xml&quot;, NULL, 0);
 	xmlSchemaParserCtxtPtr xmlSchemaParserCtxt = xmlSchemaNewParserCtxt(schemaPath);
 	xmlSchemaPtr xmlSchema = xmlSchemaParse(xmlSchemaParserCtxt);
 
@@ -1409,8 +1492,19 @@
 	else
  		xmlSchemaFree(xmlSchema);
 
-	// Read XML
-	if (success)
+	return success;
+}
+
+int x264Options::fromXml(const char *xml)
+{
+	bool success = false;
+
+	clearPresetConfiguration();
+	clearZones();
+
+	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;x264.xml&quot;, NULL, 0);
+
+	if (success = validateXml(doc))
 	{
 		xmlNode *xmlNodeRoot = xmlDocGetRootElement(doc);
 
@@ -1420,114 +1514,163 @@
 			{
 				char *content = (char*)xmlNodeGetContent(xmlChild);
 
-				if (strcmp((char*)xmlChild-&gt;name, &quot;threads&quot;) == 0)
-					setThreads(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;deterministic&quot;) == 0)
-					setDeterministic(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;idcLevel&quot;) == 0)
-					setIdcLevel(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;vui&quot;) == 0)
-					parseVuiOptions(xmlChild);
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;referenceFrames&quot;) == 0)
-					setReferenceFrames(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;gopMaximumSize&quot;) == 0)
-					setGopMaximumSize(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;gopMinimumSize&quot;) == 0)
-					setGopMinimumSize(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;scenecutThreshold&quot;) == 0)
-					setScenecutThreshold(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;preScenecutDetection&quot;) == 0)
-					setPreScenecutDetection(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrames&quot;) == 0)
-					setBFrames(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;adaptiveBframeDecision&quot;) == 0)
-					setAdaptiveBFrameDecision(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrameBias&quot;) == 0)
-					setBFrameBias(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrameReferences&quot;) == 0)
-					setBFrameReferences(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilter&quot;) == 0)
-					setLoopFilter(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilterAlphaC0&quot;) == 0)
-					setLoopFilterAlphaC0(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilterBeta&quot;) == 0)
-					setLoopFilterBeta(atoi(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;cabac&quot;) == 0)
-					setCabac(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;interlaced&quot;) == 0)
-					setInterlaced(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;cqmPreset&quot;) == 0)
-				{
-					int cqmPreset = 0;
+				if (strcmp((char*)xmlChild-&gt;name, &quot;presetConfiguration&quot;) == 0)
+					parsePresetConfiguration(xmlChild);
+				else if (strcmp((char*)xmlChild-&gt;name, &quot;x264Options&quot;) == 0)
+					parseX264Options(xmlChild);
 
-					if (strcmp(content, &quot;flat&quot;) == 0)
-						cqmPreset = X264_CQM_FLAT;
-					else if (strcmp(content, &quot;jvt&quot;) == 0)
-						cqmPreset = X264_CQM_JVT;
-					else if (strcmp(content, &quot;custom&quot;) == 0)
-						cqmPreset = X264_CQM_CUSTOM;
+				xmlFree(content);
+			}
+		}
+	}
 
-					setCqmPreset(cqmPreset);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;intra4x4Luma&quot;) == 0)
-				{
-					uint8_t intra4x4Luma[16];
+	xmlFreeDoc(doc);
 
-					parseCqmOption(xmlChild, intra4x4Luma);
-					setIntra4x4Luma(intra4x4Luma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;intraChroma&quot;) == 0)
-				{
-					uint8_t intraChroma[16];
+	return success;
+}
 
-					parseCqmOption(xmlChild, intraChroma);
-					setIntraChroma(intraChroma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;inter4x4Luma&quot;) == 0)
-				{
-					uint8_t inter4x4Luma[16];
+void x264Options::parsePresetConfiguration(xmlNode *node)
+{
+	char* name = NULL;
+	configType type = CONFIG_CUSTOM;
 
-					parseCqmOption(xmlChild, inter4x4Luma);
-					setInter4x4Luma(inter4x4Luma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;interChroma&quot;) == 0)
-				{
-					uint8_t interChroma[16];
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
 
-					parseCqmOption(xmlChild, interChroma);
-					setInterChroma(interChroma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;intra8x8Luma&quot;) == 0)
-				{
-					uint8_t intra8x8Luma[64];
+			if (strcmp((char*)xmlChild-&gt;name, &quot;name&quot;) == 0)
+				name = strdup((char*)content);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;type&quot;) == 0)
+			{
+				if (strcmp(content, &quot;user&quot;) == 0)
+					type = CONFIG_USER;
+				else if (strcmp(content, &quot;system&quot;) == 0)
+					type = CONFIG_SYSTEM;
+				else
+					type = CONFIG_DEFAULT;
+			}
 
-					parseCqmOption(xmlChild, intra8x8Luma);
-					setIntra8x8Luma(intra8x8Luma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;inter8x8Luma&quot;) == 0)
-				{
-					uint8_t inter8x8Luma[64];
+			xmlFree(content);
+		}
+	}
 
-					parseCqmOption(xmlChild, inter8x8Luma);
-					setInter8x8Luma(inter8x8Luma);
-				}
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;analyse&quot;) == 0)
-					parseAnalyseOptions(xmlChild);
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;rateControl&quot;) == 0)
-					parseRateControlOptions(xmlChild);
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;accessUnitDelimiters&quot;) == 0)
-					setAccessUnitDelimiters(string2Boolean(content));
-				else if (strcmp((char*)xmlChild-&gt;name, &quot;spsIdentifier&quot;) == 0)
-					setSpsIdentifier(atoi(content));
+	setPresetConfiguration(name, type);
+	free(name);
+}
 
-				xmlFree(content);
+void x264Options::parseX264Options(xmlNode *node)
+{
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;threads&quot;) == 0)
+				setThreads(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;deterministic&quot;) == 0)
+				setDeterministic(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;idcLevel&quot;) == 0)
+				setIdcLevel(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;vui&quot;) == 0)
+				parseVuiOptions(xmlChild);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;referenceFrames&quot;) == 0)
+				setReferenceFrames(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;gopMaximumSize&quot;) == 0)
+				setGopMaximumSize(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;gopMinimumSize&quot;) == 0)
+				setGopMinimumSize(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;scenecutThreshold&quot;) == 0)
+				setScenecutThreshold(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;preScenecutDetection&quot;) == 0)
+				setPreScenecutDetection(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrames&quot;) == 0)
+				setBFrames(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;adaptiveBframeDecision&quot;) == 0)
+				setAdaptiveBFrameDecision(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrameBias&quot;) == 0)
+				setBFrameBias(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;bFrameReferences&quot;) == 0)
+				setBFrameReferences(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilter&quot;) == 0)
+				setLoopFilter(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilterAlphaC0&quot;) == 0)
+				setLoopFilterAlphaC0(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;loopFilterBeta&quot;) == 0)
+				setLoopFilterBeta(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;cabac&quot;) == 0)
+				setCabac(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;interlaced&quot;) == 0)
+				setInterlaced(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;cqmPreset&quot;) == 0)
+			{
+				int cqmPreset = 0;
+
+				if (strcmp(content, &quot;flat&quot;) == 0)
+					cqmPreset = X264_CQM_FLAT;
+				else if (strcmp(content, &quot;jvt&quot;) == 0)
+					cqmPreset = X264_CQM_JVT;
+				else if (strcmp(content, &quot;custom&quot;) == 0)
+					cqmPreset = X264_CQM_CUSTOM;
+
+				setCqmPreset(cqmPreset);
 			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;intra4x4Luma&quot;) == 0)
+			{
+				uint8_t intra4x4Luma[16];
+
+				parseCqmOption(xmlChild, intra4x4Luma);
+				setIntra4x4Luma(intra4x4Luma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;intraChroma&quot;) == 0)
+			{
+				uint8_t intraChroma[16];
+
+				parseCqmOption(xmlChild, intraChroma);
+				setIntraChroma(intraChroma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;inter4x4Luma&quot;) == 0)
+			{
+				uint8_t inter4x4Luma[16];
+
+				parseCqmOption(xmlChild, inter4x4Luma);
+				setInter4x4Luma(inter4x4Luma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;interChroma&quot;) == 0)
+			{
+				uint8_t interChroma[16];
+
+				parseCqmOption(xmlChild, interChroma);
+				setInterChroma(interChroma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;intra8x8Luma&quot;) == 0)
+			{
+				uint8_t intra8x8Luma[64];
+
+				parseCqmOption(xmlChild, intra8x8Luma);
+				setIntra8x8Luma(intra8x8Luma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;inter8x8Luma&quot;) == 0)
+			{
+				uint8_t inter8x8Luma[64];
+
+				parseCqmOption(xmlChild, inter8x8Luma);
+				setInter8x8Luma(inter8x8Luma);
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;analyse&quot;) == 0)
+				parseAnalyseOptions(xmlChild);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;rateControl&quot;) == 0)
+				parseRateControlOptions(xmlChild);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;accessUnitDelimiters&quot;) == 0)
+				setAccessUnitDelimiters(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;spsIdentifier&quot;) == 0)
+				setSpsIdentifier(atoi(content));
+
+			xmlFree(content);
 		}
 	}
-
-	xmlFreeDoc(doc);
-
-	return success;
 }
 
 void x264Options::parseVuiOptions(xmlNode *node)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2008-05-23 16:39:03 UTC (rev 4060)
@@ -31,18 +31,39 @@
 #define DEFAULT_ENCODE_MODE ADM_VIDENC_MODE_AQP
 #define DEFAULT_ENCODE_MODE_PARAMETER 26
 
+typedef enum
+{
+	CONFIG_CUSTOM,
+	CONFIG_DEFAULT,
+	CONFIG_USER,
+	CONFIG_SYSTEM
+} configType;
+
 class x264Options
 {
-private:
+protected:
 	x264_param_t _param;
 	std::vector&lt;x264ZoneOptions*&gt; _zoneOptions;
+
+	char* _configurationName;
+	configType _configurationType;
+
 	bool _sarAsInput;
 
+	void cleanUp(void);
 	xmlChar* number2String(xmlChar *buffer, size_t size, int number);
 	xmlChar* number2String(xmlChar *buffer, size_t size, unsigned int number);
 	xmlChar* number2String(xmlChar *buffer, size_t size, float number);
 	xmlChar* boolean2String(xmlChar *buffer, size_t size, bool boolean);
 	bool string2Boolean(char *buffer);
+
+	void addX264OptionsToXml(xmlNodePtr xmlNodeRoot);
+	char* dumpXmlDocToMemory(xmlDocPtr xmlDoc);
+	bool validateXml(xmlDocPtr doc);
+	void parsePresetConfiguration(xmlNode *node);
+	void parseX264Options(xmlNode *node);
+
+private:
 	void parseVuiOptions(xmlNode *node);
 	void parseCqmOption(xmlNode *node, uint8_t cqm[]);
 	void parseAnalyseOptions(xmlNode *node);
@@ -53,8 +74,13 @@
 	x264Options(void);
 	~x264Options(void);
 
+	void reset(void);
 	x264_param_t* getParameters(void);
 
+	void getPresetConfiguration(char** configurationName, configType *configurationType);
+	void setPresetConfiguration(const char* configurationName, configType configurationType);
+	void clearPresetConfiguration(void);
+
 	int getThreads(void);
 	void setThreads(int threads);
 
@@ -296,8 +322,8 @@
 	unsigned int getSpsIdentifier(void);
 	void setSpsIdentifier(unsigned int spsIdentifier);
 
-	char* toXml(void);
-	int fromXml(char *xml);
+	virtual char* toXml(void);
+	virtual int fromXml(const char *xml);
 };
 
 #endif	// options_h

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.cpp	2008-05-23 16:39:03 UTC (rev 4060)
@@ -0,0 +1,163 @@
+ /***************************************************************************
+                             presetOptions.cpp
+
+	These settings are intended for external configuration files and don't
+	contain a Preset Configuration block but may contain an Encode Options
+	block.
+
+    begin                : Fri May 23 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;libxml/parser.h&gt;
+#include &quot;presetOptions.h&quot;
+
+x264PresetOptions::x264PresetOptions(void) : x264Options()
+{
+	setEncodeOptionsToDefaults();
+}
+
+vidEncOptions* x264PresetOptions::getEncodeOptions(void)
+{
+	vidEncOptions *encodeOptions = new vidEncOptions;
+
+	memcpy(encodeOptions, &amp;_encodeOptions, sizeof(vidEncOptions));
+
+	return encodeOptions;
+}
+
+void x264PresetOptions::setEncodeOptions(vidEncOptions* encodeOptions)
+{
+	memcpy(&amp;_encodeOptions, encodeOptions, sizeof(vidEncOptions));
+}
+
+char* x264PresetOptions::toXml(void)
+{
+	xmlDocPtr xmlDoc = xmlNewDoc((const xmlChar*)&quot;1.0&quot;);
+	xmlNodePtr xmlNodeRoot, xmlNodeChild;
+	const int bufferSize = 100;
+	xmlChar xmlBuffer[bufferSize + 1];
+	char *xml = NULL;
+
+	while (true)
+	{
+		if (!xmlDoc)
+			break;
+
+		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)&quot;x264Config&quot;, NULL)))
+			break;
+
+		xmlDocSetRootElement(xmlDoc, xmlNodeRoot);
+
+		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;encodeOptions&quot;, NULL);
+
+		switch (_encodeOptions.encodeMode)
+		{
+			case ADM_VIDENC_MODE_CBR:
+				strcpy((char*)xmlBuffer, &quot;CBR&quot;);
+				break;
+			case ADM_VIDENC_MODE_CQP:
+				strcpy((char*)xmlBuffer, &quot;CQP&quot;);
+				break;
+			case ADM_VIDENC_MODE_AQP:
+				strcpy((char*)xmlBuffer, &quot;AQP&quot;);
+				break;
+			case ADM_VIDENC_MODE_2PASS_SIZE:
+				strcpy((char*)xmlBuffer, &quot;2PASS SIZE&quot;);
+				break;
+			case ADM_VIDENC_MODE_2PASS_ABR:
+				strcpy((char*)xmlBuffer, &quot;2PASS ABR&quot;);
+				break;
+		}
+
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;mode&quot;, xmlBuffer);
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;parameter&quot;, number2String(xmlBuffer, bufferSize, _encodeOptions.encodeModeParameter));
+
+		addX264OptionsToXml(xmlNodeRoot);
+		xml = dumpXmlDocToMemory(xmlDoc);
+		xmlFreeDoc(xmlDoc);
+
+		break;
+	}
+
+	return xml;
+}
+
+int x264PresetOptions::fromXml(const char *xml)
+{
+	bool success = false;
+
+	clearPresetConfiguration();
+	clearZones();
+	setEncodeOptionsToDefaults();
+
+	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;x264.xml&quot;, NULL, 0);
+
+	if (success = validateXml(doc))
+	{
+		xmlNode *xmlNodeRoot = xmlDocGetRootElement(doc);
+
+		for (xmlNode *xmlChild = xmlNodeRoot-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+		{
+			if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+			{
+				char *content = (char*)xmlNodeGetContent(xmlChild);
+
+				if (strcmp((char*)xmlChild-&gt;name, &quot;encodeOptions&quot;) == 0)
+					parseEncodeOptions(xmlChild, &amp;_encodeOptions);
+				else if (strcmp((char*)xmlChild-&gt;name, &quot;x264Options&quot;) == 0)
+					parseX264Options(xmlChild);
+
+				xmlFree(content);
+			}
+		}
+	}
+
+	xmlFreeDoc(doc);
+
+	return success;
+}
+
+void x264PresetOptions::parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions)
+{
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;mode&quot;) == 0)
+			{
+				if (strcmp(content, &quot;CBR&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CBR;
+				else if (strcmp(content, &quot;CQP&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CQP;
+				else if (strcmp(content, &quot;AQP&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_AQP;
+				else if (strcmp(content, &quot;2PASS SIZE&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_SIZE;
+				else if (strcmp(content, &quot;2PASS ABR&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_ABR;
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;parameter&quot;) == 0)
+				encodeOptions-&gt;encodeModeParameter = atoi(content);
+
+			xmlFree(content);
+		}
+	}
+}
+
+void x264PresetOptions::setEncodeOptionsToDefaults(void)
+{
+	_encodeOptions.encodeMode = DEFAULT_ENCODE_MODE;
+	_encodeOptions.encodeModeParameter = DEFAULT_ENCODE_MODE_PARAMETER;
+}

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.h	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/presetOptions.h	2008-05-23 16:39:03 UTC (rev 4060)
@@ -0,0 +1,39 @@
+/***************************************************************************
+                              presetOptions.h
+
+    begin                : Fri May 23 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef presetOptions_h
+#define presetOptions_h
+
+#include &quot;options.h&quot;
+
+class x264PresetOptions : public x264Options
+{
+private:
+	vidEncOptions _encodeOptions;
+
+	void parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions);
+	void setEncodeOptionsToDefaults(void);
+
+public:
+	x264PresetOptions(void);
+
+	vidEncOptions* getEncodeOptions(void);
+	void setEncodeOptions(vidEncOptions* encodeOptions);
+	char* toXml(void);
+	int fromXml(const char *xml);
+};
+
+#endif	// presetOptions_h

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2008-05-23 16:39:03 UTC (rev 4060)
@@ -18,17 +18,28 @@
  ***************************************************************************/
 
 #include &lt;math.h&gt;
+#include &lt;QtGui/QFileDialog&gt;
 
+#include &quot;../config.h&quot;
+#include &quot;../presetOptions.h&quot;
 #include &quot;x264ConfigDialog.h&quot;
 #include &quot;x264CustomMatrixDialog.h&quot;
 
-#include &quot;ADM_default.h&quot;
+#include &quot;ADM_inttype.h&quot;
+#include &quot;ADM_files.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_fileSel.h&quot;
 
+// Stay away from ADM_assert.h since it hacks memory functions.
+// Duplicating ADM_mkdir declaration here instead.
+extern &quot;C&quot; {
+extern uint8_t ADM_mkdir(const char *name);
+}
+
 x264ConfigDialog::x264ConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, x264Options *options) :
 	QDialog((QWidget*)configParameters-&gt;parent, Qt::Dialog)
 {
+	disableGenericSlots = false;
 	static const int _predefinedARs[aspectRatioCount][2] = {{16, 15}, {64, 45}, {8, 9}, {32, 27}};
 
 	// Mappings for x264 array index -&gt; UI combobox index
@@ -47,6 +58,10 @@
 
 	ui.setupUi(this);
 
+	connect(ui.configurationComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(configurationComboBox_currentIndexChanged(int)));
+	connect(ui.saveAsButton, SIGNAL(pressed()), this, SLOT(saveAsButton_pressed()));
+	connect(ui.deleteButton, SIGNAL(pressed()), this, SLOT(deleteButton_pressed()));
+
 	// General tab
 	lastBitrate = 1500;
 	lastVideoSize = 700;
@@ -83,8 +98,8 @@
 
 	// Advanced tab
 	ui.zoneTableView-&gt;sortByColumn(0, Qt::AscendingOrder);
-	ui.zoneTableView-&gt;setModel(&amp;_zoneTableModel);
-	ui.zoneTableView-&gt;setItemDelegate(&amp;_zoneTableDelegate);
+	ui.zoneTableView-&gt;setModel(&amp;zoneTableModel);
+	ui.zoneTableView-&gt;setItemDelegate(&amp;zoneTableDelegate);
 
 	ui.zoneTableView-&gt;setColumnWidth(0, 80);
 	ui.zoneTableView-&gt;setColumnWidth(1, 80);
@@ -95,23 +110,225 @@
 	connect(ui.zoneEditButton, SIGNAL(pressed()), this, SLOT(zoneEditButton_pressed()));
 	connect(ui.zoneDeleteButton, SIGNAL(pressed()), this, SLOT(zoneDeleteButton_pressed()));
 
-	loadSettings(encodeOptions, options);
+	QWidgetList widgetList = QApplication::allWidgets();
+
+	for (int widgetIndex = 0; widgetIndex &lt; widgetList.size(); widgetIndex++)
+	{
+		QWidget *widget = widgetList.at(widgetIndex);
+
+		if (widget-&gt;parentWidget() != NULL &amp;&amp; widget-&gt;parentWidget()-&gt;parentWidget() != NULL &amp;&amp; 
+			widget-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget() != NULL &amp;&amp;
+			widget-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget() == ui.tabWidget)
+		{
+			if (widget-&gt;inherits(&quot;QComboBox&quot;))
+				connect(widget, SIGNAL(currentIndexChanged(int)), this, SLOT(generic_currentIndexChanged(int)));
+			else if (widget-&gt;inherits(&quot;QSpinBox&quot;))
+				connect(widget, SIGNAL(valueChanged(int)), this, SLOT(generic_valueChanged(int)));
+			else if (widget-&gt;inherits(&quot;QAbstractButton&quot;))
+				connect(widget, SIGNAL(pressed()), this, SLOT(generic_pressed()));
+			else if (widget-&gt;inherits(&quot;QLineEdit&quot;))
+				connect(widget, SIGNAL(textEdited(QString)), this, SLOT(generic_textEdited(QString)));
+		}
+	}
+
+	fillConfigurationComboBox();
+
+	if (!loadPresetSettings(encodeOptions, options))
+		loadSettings(encodeOptions, options);
 }
-/*
-void x264ConfigDialog::defaultButton_pressed()
+
+void x264ConfigDialog::fillConfigurationComboBox(void)
 {
-	if (GUI_Question(QT_TR_NOOP(&quot;Are you sure you wish to reset all options to defaults?&quot;)))
+	bool origDisableGenericSlots = disableGenericSlots;
+	QMap&lt;QString, int&gt; configs;
+	QStringList filter(&quot;*.xml&quot;);
+	QStringList list = QDir(getUserConfigDirectory()).entryList(filter, QDir::Files | QDir::Readable);
+
+	disableGenericSlots = true;
+
+	for (int item = 0; item &lt; list.size(); item++)
+		configs.insert(QFileInfo(list[item]).baseName(), CONFIG_USER);
+
+	list = QDir(getSystemConfigDirectory()).entryList(filter, QDir::Files | QDir::Readable);
+
+	for (int item = 0; item &lt; list.size(); item++)
+		configs.insert(QFileInfo(list[item]).baseName(), CONFIG_SYSTEM);
+
+	ui.configurationComboBox-&gt;clear();
+	ui.configurationComboBox-&gt;addItem(QT_TR_NOOP(&quot;&lt;default&gt;&quot;), CONFIG_DEFAULT);
+	ui.configurationComboBox-&gt;addItem(QT_TR_NOOP(&quot;&lt;custom&gt;&quot;), CONFIG_CUSTOM);
+
+	QMap&lt;QString, int&gt;::const_iterator mapIterator = configs.constBegin();
+
+	while (mapIterator != configs.constEnd())
 	{
-		x264Options defaultOptions;
-		vidEncOptions defaultEncodeOptions;
+		ui.configurationComboBox-&gt;addItem(mapIterator.key(), mapIterator.value());
+		mapIterator++;
+	}
 
-		defaultEncodeOptions.encodeMode = DEFAULT_ENCODE_MODE;
-		defaultEncodeOptions.encodeModeParameter = DEFAULT_ENCODE_MODE_PARAMETER;
+	disableGenericSlots = origDisableGenericSlots;
+}
 
-		loadSettings(&amp;defaultEncodeOptions, &amp;defaultOptions);
+bool x264ConfigDialog::selectConfiguration(QString *selectFile, configType configurationType)
+{
+	bool success = false;
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
+	if (configurationType == CONFIG_DEFAULT)
+	{
+		ui.configurationComboBox-&gt;setCurrentIndex(0);
+		success = true;
 	}
+	else
+	{
+		for (int index = 0; index &lt; ui.configurationComboBox-&gt;count(); index++)
+		{
+			if (ui.configurationComboBox-&gt;itemText(index) == selectFile &amp;&amp; ui.configurationComboBox-&gt;itemData(index).toInt() == configurationType)
+			{
+				ui.configurationComboBox-&gt;setCurrentIndex(index);
+				success = true;
+				break;
+			}
+		}
+
+		if (!success)
+			ui.configurationComboBox-&gt;setCurrentIndex(1);
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+
+	return success;
 }
-*/
+
+void x264ConfigDialog::generic_currentIndexChanged(int index)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void x264ConfigDialog::generic_valueChanged(int value)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void x264ConfigDialog::generic_pressed(void)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void x264ConfigDialog::generic_textEdited(QString text)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void x264ConfigDialog::configurationComboBox_currentIndexChanged(int index)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
+	if (index == 0)		// default
+	{
+		ui.deleteButton-&gt;setEnabled(false);
+
+		x264PresetOptions defaultOptions;
+		vidEncOptions *defaultEncodeOptions = defaultOptions.getEncodeOptions();
+
+		loadSettings(defaultEncodeOptions, &amp;defaultOptions);
+
+		delete defaultEncodeOptions;
+	}
+	else if (index == 1)	// custom
+		ui.deleteButton-&gt;setEnabled(false);
+	else
+	{
+		int configType = ui.configurationComboBox-&gt;itemData(index).toInt();
+		QString configFileName;
+
+		ui.deleteButton-&gt;setEnabled(configType == CONFIG_USER);
+
+		if (configType == CONFIG_SYSTEM)
+			configFileName = QFileInfo(getSystemConfigDirectory(), ui.configurationComboBox-&gt;itemText(index) + &quot;.xml&quot;).filePath();
+		else	// CONFIG_USER
+			configFileName = QFileInfo(getUserConfigDirectory(), ui.configurationComboBox-&gt;itemText(index) + &quot;.xml&quot;).filePath();
+
+		QFile configFile(configFileName);
+
+		if (configFile.exists())
+		{
+			configFile.open(QIODevice::ReadOnly | QIODevice::Text);
+
+			QByteArray fileContents = configFile.readAll();
+			x264PresetOptions options;
+			vidEncOptions *encodeOptions;
+
+			configFile.close();
+			options.fromXml(fileContents.constData());
+			encodeOptions = options.getEncodeOptions();
+
+			loadSettings(encodeOptions, &amp;options);
+
+			delete encodeOptions;
+		}
+		else
+			ui.configurationComboBox-&gt;setCurrentIndex(0);
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+}
+
+void x264ConfigDialog::saveAsButton_pressed(void)
+{
+	char *configDirectory = ADM_getHomeRelativePath(&quot;x264&quot;);
+
+	ADM_mkdir(configDirectory);
+
+	QString configFileName = QFileDialog::getSaveFileName(this, QT_TR_NOOP(&quot;Save As&quot;), configDirectory, QT_TR_NOOP(&quot;x264 Configuration File (*.xml)&quot;));
+
+	if (!configFileName.isNull())
+	{
+		QFile configFile(configFileName);
+		vidEncOptions encodeOptions;
+		x264PresetOptions presetOptions;
+
+		configFile.open(QIODevice::WriteOnly | QIODevice::Truncate | QIODevice::Text);
+		saveSettings(&amp;encodeOptions, &amp;presetOptions);
+		presetOptions.setEncodeOptions(&amp;encodeOptions);
+
+		char* xml = presetOptions.toXml();
+
+		configFile.write(xml, strlen(xml));
+		configFile.close();
+
+		delete [] xml;
+
+		fillConfigurationComboBox();
+		selectConfiguration(&amp;QFileInfo(configFileName).baseName(), CONFIG_USER);
+	}
+
+	delete [] configDirectory;
+}
+
+void x264ConfigDialog::deleteButton_pressed(void)
+{
+	QString configFileName = QFileInfo(getUserConfigDirectory(), ui.configurationComboBox-&gt;currentText() + &quot;.xml&quot;).filePath();
+	QFile configFile(configFileName);
+
+	if (GUI_Question(QT_TR_NOOP(&quot;Are you sure you wish to delete the selected configuration?&quot;)) &amp;&amp; configFile.exists())
+	{
+		disableGenericSlots = true;
+		configFile.remove();
+		ui.configurationComboBox-&gt;removeItem(ui.configurationComboBox-&gt;currentIndex());
+		disableGenericSlots = false;
+		ui.configurationComboBox-&gt;setCurrentIndex(0);	// default
+	}
+}
+
 // General tab
 void x264ConfigDialog::encodingModeComboBox_currentIndexChanged(int index)
 {
@@ -242,7 +459,7 @@
 
 void x264ConfigDialog::zoneAddButton_pressed()
 {
-	_zoneTableModel.insertRows(0, 1, QModelIndex());
+	zoneTableModel.insertRows(0, 1, QModelIndex());
 	ui.zoneTableView-&gt;selectRow(0);
 	ui.zoneTableView-&gt;edit(ui.zoneTableView-&gt;currentIndex());
 }
@@ -255,7 +472,7 @@
 void x264ConfigDialog::zoneDeleteButton_pressed()
 {
 	if (ui.zoneTableView-&gt;currentIndex().row() &gt;= 0 &amp;&amp; GUI_Question(QT_TR_NOOP(&quot;Are you sure you wish to delete the selected zone?&quot;)))
-		_zoneTableModel.removeRows(ui.zoneTableView-&gt;currentIndex().row(), 1, QModelIndex());
+		zoneTableModel.removeRows(ui.zoneTableView-&gt;currentIndex().row(), 1, QModelIndex());
 }
 
 int x264ConfigDialog::getValueIndexInArray(uint8_t value, const uint8_t valueArray[], int elementCount)
@@ -274,8 +491,34 @@
 	return valueIndex;
 }
 
+bool x264ConfigDialog::loadPresetSettings(vidEncOptions *encodeOptions, x264Options *options)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+	char *configurationName;
+	configType configurationType;
+
+	disableGenericSlots = true;
+	options-&gt;getPresetConfiguration(&amp;configurationName, &amp;configurationType);		
+
+	bool foundConfig = selectConfiguration(&amp;QString(configurationName), configurationType);
+
+	if (!foundConfig)
+		printf(&quot;Configuration %s (type %d) could not be found.  Using snapshot.\n&quot;, configurationName, configurationType);
+
+	if (configurationName)
+		free(configurationName);
+
+	disableGenericSlots = origDisableGenericSlots;
+
+	return (foundConfig &amp;&amp; configurationType != CONFIG_CUSTOM);
+}
+
 void x264ConfigDialog::loadSettings(vidEncOptions *encodeOptions, x264Options *options)
 {
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
 	// General tab
 	switch (encodeOptions-&gt;encodeMode)
 	{
@@ -467,7 +710,7 @@
 	ui.vbvBufferSizeSpinBox-&gt;setValue(options-&gt;getVbvBufferSize());
 	ui.vbvBufferOccupancySpinBox-&gt;setValue((int)floor(options-&gt;getVbvInitialOccupancy() * 100 + .5));
 
-	_zoneTableModel.removeRows();
+	zoneTableModel.removeRows();
 
 	int zoneCount = options-&gt;getZoneCount();
 
@@ -475,7 +718,7 @@
 	{
 		x264ZoneOptions** zoneOptions = options-&gt;getZones();
 
-		_zoneTableModel.insertRows(0, zoneCount, QModelIndex(), zoneOptions);
+		zoneTableModel.insertRows(0, zoneCount, QModelIndex(), zoneOptions);
 
 		delete [] zoneOptions;
 	}
@@ -503,6 +746,8 @@
 	ui.colourMatrixComboBox-&gt;setCurrentIndex(getValueIndexInArray(options-&gt;getColorMatrix(), colourMatrix, colourMatrixCount));
 	ui.chromaSampleSpinBox-&gt;setValue(options-&gt;getChromaSampleLocation());
 	ui.fullRangeSamplesCheckBox-&gt;setChecked(options-&gt;getFullRangeSamples());
+
+	disableGenericSlots = origDisableGenericSlots;
 }
 
 void x264ConfigDialog::saveSettings(vidEncOptions *encodeOptions, x264Options *options)
@@ -534,6 +779,9 @@
 			break;
 	}
 
+	configType configurationType = (configType)ui.configurationComboBox-&gt;itemData(ui.configurationComboBox-&gt;currentIndex()).toInt();
+
+	options-&gt;setPresetConfiguration(ui.configurationComboBox-&gt;currentText().toUtf8().constData(), configurationType);
 	options-&gt;setSarAsInput(ui.sarAsInputRadioButton-&gt;isChecked());
 
 	if (ui.sarCustomRadioButton-&gt;isChecked())
@@ -675,7 +923,7 @@
 
 	options-&gt;clearZones();
 
-	QList&lt;x264ZoneOptions*&gt; zoneOptions = _zoneTableModel.getList();
+	QList&lt;x264ZoneOptions*&gt; zoneOptions = zoneTableModel.getList();
 
 	for (int zone = 0; zone &lt; zoneOptions.count(); zone++)
 		options-&gt;addZone(zoneOptions[zone]);
@@ -698,6 +946,26 @@
 	options-&gt;setFullRangeSamples(ui.fullRangeSamplesCheckBox-&gt;isChecked());
 }
 
+QString x264ConfigDialog::getUserConfigDirectory(void)
+{
+	char *userConfigDirectory = ADM_getHomeRelativePath(&quot;x264&quot;);
+	QString qstring = QString(userConfigDirectory);
+
+	delete [] userConfigDirectory;
+
+	return qstring;
+}
+
+QString x264ConfigDialog::getSystemConfigDirectory(void)
+{
+	char* pluginPath = ADM_getPluginPath();
+	QString qstring = QString(pluginPath).append(&quot;/&quot;).append(PLUGIN_SUBDIR);
+
+	delete [] pluginPath;
+
+	return qstring;
+}
+
 extern &quot;C&quot; int showX264ConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, x264Options *options)
 {
 	x264ConfigDialog dialog(configParameters, properties, encodeOptions, options);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2008-05-23 16:39:03 UTC (rev 4060)
@@ -17,8 +17,9 @@
 
 private:
 	Ui_x264ConfigDialog ui;
-	x264ZoneTableModel _zoneTableModel;
-	x264ZoneTableDelegate _zoneTableDelegate;
+	x264ZoneTableModel zoneTableModel;
+	x264ZoneTableDelegate zoneTableDelegate;
+	bool disableGenericSlots;
 
 	static const int aspectRatioCount = 4;
 	int predefinedARs[aspectRatioCount][2];
@@ -43,14 +44,28 @@
 	uint8_t inter4x4Luma[16], interChroma[16];
 	uint8_t intra8x8Luma[64], inter8x8Luma[64];
 
+	void fillConfigurationComboBox(void);
+	bool selectConfiguration(QString *selectFile, configType configurationType);
+	bool loadPresetSettings(vidEncOptions *encodeOptions, x264Options *options);
 	void loadSettings(vidEncOptions *encodeOptions, x264Options *options);
 	int getValueIndexInArray(uint8_t value, const uint8_t valueArray[], int elementCount);
+	QString getUserConfigDirectory(void);
+	QString getSystemConfigDirectory(void);
 
 public:
 	x264ConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, x264Options *options);
 	void saveSettings(vidEncOptions *encodeOptions, x264Options *options);
 
 private slots:
+	void generic_currentIndexChanged(int index);
+	void generic_valueChanged(int value);
+	void generic_pressed(void);
+	void generic_textEdited(QString text);
+
+	void configurationComboBox_currentIndexChanged(int index);
+	void saveAsButton_pressed(void);
+	void deleteButton_pressed(void);
+
 	// General tab
 	void encodingModeComboBox_currentIndexChanged(int index);
 	void quantiserSlider_valueChanged(int value);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2008-05-23 16:39:03 UTC (rev 4060)
@@ -54,23 +54,13 @@
       &lt;/widget&gt;
      &lt;/item&gt;
      &lt;item&gt;
-      &lt;widget class=&quot;QComboBox&quot; name=&quot;comboBox&quot; &gt;
+      &lt;widget class=&quot;QComboBox&quot; name=&quot;configurationComboBox&quot; &gt;
        &lt;property name=&quot;minimumSize&quot; &gt;
         &lt;size&gt;
          &lt;width&gt;200&lt;/width&gt;
          &lt;height&gt;0&lt;/height&gt;
         &lt;/size&gt;
        &lt;/property&gt;
-       &lt;item&gt;
-        &lt;property name=&quot;text&quot; &gt;
-         &lt;string&gt;&lt;default&gt;&lt;/string&gt;
-        &lt;/property&gt;
-       &lt;/item&gt;
-       &lt;item&gt;
-        &lt;property name=&quot;text&quot; &gt;
-         &lt;string&gt;&lt;custom&gt;&lt;/string&gt;
-        &lt;/property&gt;
-       &lt;/item&gt;
       &lt;/widget&gt;
      &lt;/item&gt;
      &lt;item&gt;
@@ -123,7 +113,7 @@
      &lt;property name=&quot;currentIndex&quot; &gt;
       &lt;number&gt;0&lt;/number&gt;
      &lt;/property&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_1&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;General&lt;/string&gt;
       &lt;/attribute&gt;
@@ -780,7 +770,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_6&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_2&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Motion&lt;/string&gt;
       &lt;/attribute&gt;
@@ -1365,7 +1355,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_8&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_3&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Partition&lt;/string&gt;
       &lt;/attribute&gt;
@@ -2013,7 +2003,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_7&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_5&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Analysis&lt;/string&gt;
       &lt;/attribute&gt;
@@ -2370,7 +2360,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_2&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_6&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Quantiser&lt;/string&gt;
       &lt;/attribute&gt;
@@ -3016,7 +3006,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_5&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_7&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Advanced&lt;/string&gt;
       &lt;/attribute&gt;
@@ -3404,7 +3394,7 @@
        &lt;/item&gt;
       &lt;/layout&gt;
      &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_3&quot; &gt;
+     &lt;widget class=&quot;QWidget&quot; name=&quot;tab_8&quot; &gt;
       &lt;attribute name=&quot;title&quot; &gt;
        &lt;string&gt;Output&lt;/string&gt;
       &lt;/attribute&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2008-05-23 16:39:03 UTC (rev 4060)
@@ -1,506 +1,547 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 &lt;xs:schema xmlns:xs=&quot;<A HREF="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</A>&quot; elementFormDefault=&quot;qualified&quot;&gt;
-	&lt;xs:element name=&quot;x264Param&quot;&gt;
-		&lt;xs:complexType&gt;
-			&lt;xs:sequence&gt;
-				&lt;xs:element name=&quot;threads&quot; type=&quot;uint&quot;/&gt;
-				&lt;xs:element name=&quot;deterministic&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;idcLevel&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:enumeration value=&quot;1&quot;/&gt;
-							&lt;xs:enumeration value=&quot;11&quot;/&gt;
-							&lt;xs:enumeration value=&quot;12&quot;/&gt;
-							&lt;xs:enumeration value=&quot;13&quot;/&gt;
-							&lt;xs:enumeration value=&quot;2&quot;/&gt;
-							&lt;xs:enumeration value=&quot;21&quot;/&gt;
-							&lt;xs:enumeration value=&quot;22&quot;/&gt;
-							&lt;xs:enumeration value=&quot;3&quot;/&gt;
-							&lt;xs:enumeration value=&quot;31&quot;/&gt;
-							&lt;xs:enumeration value=&quot;32&quot;/&gt;
-							&lt;xs:enumeration value=&quot;4&quot;/&gt;
-							&lt;xs:enumeration value=&quot;41&quot;/&gt;
-							&lt;xs:enumeration value=&quot;42&quot;/&gt;
-							&lt;xs:enumeration value=&quot;5&quot;/&gt;
-							&lt;xs:enumeration value=&quot;51&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;vui&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;sarAsInput&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;sarHeight&quot; type=&quot;uint&quot;/&gt;
-							&lt;xs:element name=&quot;sarWidth&quot; type=&quot;uint&quot;/&gt;
-							&lt;xs:element name=&quot;overscan&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;undefined&quot;/&gt;
-										&lt;xs:enumeration value=&quot;show&quot;/&gt;
-										&lt;xs:enumeration value=&quot;crop&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;videoFormat&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;component&quot;/&gt;
-										&lt;xs:enumeration value=&quot;pal&quot;/&gt;
-										&lt;xs:enumeration value=&quot;ntsc&quot;/&gt;
-										&lt;xs:enumeration value=&quot;secam&quot;/&gt;
-										&lt;xs:enumeration value=&quot;mac&quot;/&gt;
-										&lt;xs:enumeration value=&quot;undefined&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;fullRangeSamples&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;colorPrimaries&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;undefined&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt709&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt470m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;film&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;transfer&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;undefined&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt709&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt470m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
-										&lt;xs:enumeration value=&quot;linear&quot;/&gt;
-										&lt;xs:enumeration value=&quot;log100&quot;/&gt;
-										&lt;xs:enumeration value=&quot;log316&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;colorMatrix&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;undefined&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt709&quot;/&gt;
-										&lt;xs:enumeration value=&quot;fcc&quot;/&gt;
-										&lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
-										&lt;xs:enumeration value=&quot;gbr&quot;/&gt;
-										&lt;xs:enumeration value=&quot;ycgco&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;chromaSampleLocation&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;5&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;referenceFrames&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;16&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;gopMaximumSize&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;1000&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;gopMinimumSize&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;100&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;scenecutThreshold&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;100&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;preScenecutDetection&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;bFrames&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;15&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;adaptiveBframeDecision&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;bFrameBias&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;-100&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;100&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;bFrameReferences&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;loopFilter&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;loopFilterAlphaC0&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;-6&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;6&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;loopFilterBeta&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:minInclusive value=&quot;-6&quot;/&gt;
-							&lt;xs:maxInclusive value=&quot;6&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;cabac&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;interlaced&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;cqmPreset&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-							&lt;xs:enumeration value=&quot;flat&quot;/&gt;
-							&lt;xs:enumeration value=&quot;jvt&quot;/&gt;
-							&lt;xs:enumeration value=&quot;custom&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;intra4x4Luma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;intraChroma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;inter4x4Luma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;interChroma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;intra8x8Luma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;64&quot; maxOccurs=&quot;64&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;inter8x8Luma&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;64&quot; maxOccurs=&quot;64&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;analyse&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;partitionI4x4&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;partitionI8x8&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;partitionP8x8&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;partitionP4x4&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;partitionB8x8&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;dct8x8&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;weightedPrediction&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;directPredictionMode&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;none&quot;/&gt;
-										&lt;xs:enumeration value=&quot;spatial&quot;/&gt;
-										&lt;xs:enumeration value=&quot;temporal&quot;/&gt;
-										&lt;xs:enumeration value=&quot;auto&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;directPredictionSize&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;4x4&quot;/&gt;
-										&lt;xs:enumeration value=&quot;8x8&quot;/&gt;
-										&lt;xs:enumeration value=&quot;smallest&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;chromaLumaQuantiserDifference&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;-12&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;12&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;motionEstimationMethod&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;diamond&quot;/&gt;
-										&lt;xs:enumeration value=&quot;hexagonal&quot;/&gt;
-										&lt;xs:enumeration value=&quot;multi-hexagonal&quot;/&gt;
-										&lt;xs:enumeration value=&quot;exhaustive&quot;/&gt;
-										&lt;xs:enumeration value=&quot;hadamard&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;motionVectorSearchRange&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;64&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;motionVectorLength&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;-1&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;512&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;motionVectorThreadBuffer&quot; type=&quot;xs:integer&quot;/&gt;
-							&lt;xs:element name=&quot;subpixelRefinement&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;1&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;7&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;bidirectionalMotionEstimation&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;chromaMotionEstimation&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;bFrameRdo&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;mixedReferences&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;trellis&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;disabled&quot;/&gt;
-										&lt;xs:enumeration value=&quot;finalMacroblock&quot;/&gt;
-										&lt;xs:enumeration value=&quot;allModeDecisions&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;fastPSkip&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;dctDecimate&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;noiseReduction&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;65536&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;interLumaDeadzone&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;32&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;intraLumaDeadzone&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;32&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;computePsnr&quot; type=&quot;xs:boolean&quot;/&gt;
-							&lt;xs:element name=&quot;computeSsim&quot; type=&quot;xs:boolean&quot;/&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;rateControl&quot;&gt;
-					&lt;xs:complexType&gt;
-						&lt;xs:sequence&gt;
-							&lt;xs:element name=&quot;quantiserMinimum&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;10&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;51&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;quantiserMaximum&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;10&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;51&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;quantiserStep&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;10&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;averageBitrateTolerance&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;1&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;vbvMaximumBitrate&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;99999&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;vbvBufferSize&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;99999&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;vbvInitialOccupancy&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;1&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;ipFrameQuantiser&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;1&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;10&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;pbFrameQuantiser&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;1&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;10&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;adaptiveQuantiserMode&quot; minOccurs=&quot;0&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:string&quot;&gt;
-										&lt;xs:enumeration value=&quot;none&quot;/&gt;
-										&lt;xs:enumeration value=&quot;local&quot;/&gt;
-										&lt;xs:enumeration value=&quot;global&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;adaptiveQuantiserStrength&quot; type=&quot;xs:float&quot; minOccurs=&quot;0&quot;/&gt;
-							&lt;xs:element name=&quot;rateControlEquation&quot; type=&quot;xs:string&quot;/&gt;
-							&lt;xs:element name=&quot;quantiserCurveCompression&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;1&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;reduceFluxBeforeCurveCompression&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;999&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;reduceFluxAfterCurveCompression&quot;&gt;
-								&lt;xs:simpleType&gt;
-									&lt;xs:restriction base=&quot;xs:float&quot;&gt;
-										&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-										&lt;xs:maxInclusive value=&quot;1&quot;/&gt;
-									&lt;/xs:restriction&gt;
-								&lt;/xs:simpleType&gt;
-							&lt;/xs:element&gt;
-							&lt;xs:element name=&quot;zone&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;
-								&lt;xs:complexType&gt;
-									&lt;xs:sequence&gt;
-										&lt;xs:element name=&quot;frameStart&quot; type=&quot;xs:integer&quot;/&gt;
-										&lt;xs:element name=&quot;frameEnd&quot; type=&quot;xs:integer&quot;/&gt;
-										&lt;xs:choice&gt;
-											&lt;xs:element name=&quot;quantiser&quot; type=&quot;quantiser&quot;/&gt;
-											&lt;xs:element name=&quot;bitrateFactor&quot; type=&quot;xs:float&quot;/&gt;
-										&lt;/xs:choice&gt;
-									&lt;/xs:sequence&gt;
-								&lt;/xs:complexType&gt;
-							&lt;/xs:element&gt;
-						&lt;/xs:sequence&gt;
-					&lt;/xs:complexType&gt;
-				&lt;/xs:element&gt;
-				&lt;xs:element name=&quot;accessUnitDelimiters&quot; type=&quot;xs:boolean&quot;/&gt;
-				&lt;xs:element name=&quot;spsIdentifier&quot;&gt;
-					&lt;xs:simpleType&gt;
-						&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-							&lt;xs:enumeration value=&quot;0&quot;/&gt;
-							&lt;xs:enumeration value=&quot;1&quot;/&gt;
-							&lt;xs:enumeration value=&quot;3&quot;/&gt;
-							&lt;xs:enumeration value=&quot;7&quot;/&gt;
-							&lt;xs:enumeration value=&quot;15&quot;/&gt;
-							&lt;xs:enumeration value=&quot;31&quot;/&gt;
-						&lt;/xs:restriction&gt;
-					&lt;/xs:simpleType&gt;
-				&lt;/xs:element&gt;
-			&lt;/xs:sequence&gt;
-		&lt;/xs:complexType&gt;
-	&lt;/xs:element&gt;
-	&lt;xs:simpleType name=&quot;uint&quot;&gt;
-		&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-			&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-		&lt;/xs:restriction&gt;
-	&lt;/xs:simpleType&gt;
-	&lt;xs:simpleType name=&quot;uint8&quot;&gt;
-		&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-			&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-			&lt;xs:maxInclusive value=&quot;255&quot;/&gt;
-		&lt;/xs:restriction&gt;
-	&lt;/xs:simpleType&gt;
-	&lt;xs:simpleType name=&quot;quantiser&quot;&gt;
-		&lt;xs:restriction base=&quot;xs:integer&quot;&gt;
-			&lt;xs:minInclusive value=&quot;0&quot;/&gt;
-			&lt;xs:maxInclusive value=&quot;51&quot;/&gt;
-		&lt;/xs:restriction&gt;
-	&lt;/xs:simpleType&gt;
+  &lt;xs:element name=&quot;x264Config&quot;&gt;
+    &lt;xs:complexType&gt;
+      &lt;xs:sequence&gt;
+        &lt;xs:element name=&quot;presetConfiguration&quot; minOccurs=&quot;0&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;name&quot; type=&quot;xs:string&quot;/&gt;
+              &lt;xs:element name=&quot;type&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                    &lt;xs:enumeration value=&quot;default&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;user&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;system&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+        &lt;xs:element name=&quot;encodeOptions&quot; minOccurs=&quot;0&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;mode&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                    &lt;xs:enumeration value=&quot;CBR&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;CQP&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;AQP&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;2PASS SIZE&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;2PASS ABR&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;parameter&quot; type=&quot;uint&quot;/&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+        &lt;xs:element name=&quot;x264Options&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;threads&quot; type=&quot;uint&quot;/&gt;
+              &lt;xs:element name=&quot;deterministic&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;idcLevel&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:enumeration value=&quot;1&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;11&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;12&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;13&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;2&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;21&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;22&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;3&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;31&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;32&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;4&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;41&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;42&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;5&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;51&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;vui&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;sarAsInput&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;sarHeight&quot; type=&quot;uint&quot;/&gt;
+                    &lt;xs:element name=&quot;sarWidth&quot; type=&quot;uint&quot;/&gt;
+                    &lt;xs:element name=&quot;overscan&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;undefined&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;show&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;crop&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;videoFormat&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;component&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;pal&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;ntsc&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;secam&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;mac&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;undefined&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;fullRangeSamples&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;colorPrimaries&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;undefined&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt709&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt470m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;film&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;transfer&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;undefined&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt709&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt470m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;linear&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;log100&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;log316&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;colorMatrix&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;undefined&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt709&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;fcc&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;bt470bg&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte170m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smpte240m&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;gbr&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;ycgco&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;chromaSampleLocation&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;5&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;referenceFrames&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;16&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;gopMaximumSize&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;1000&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;gopMinimumSize&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;100&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;scenecutThreshold&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;100&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;preScenecutDetection&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;bFrames&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;15&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;adaptiveBframeDecision&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;bFrameBias&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;-100&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;100&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;bFrameReferences&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;loopFilter&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;loopFilterAlphaC0&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;-6&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;6&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;loopFilterBeta&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:minInclusive value=&quot;-6&quot;/&gt;
+                    &lt;xs:maxInclusive value=&quot;6&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;cabac&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;interlaced&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;cqmPreset&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                    &lt;xs:enumeration value=&quot;flat&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;jvt&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;custom&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;intra4x4Luma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;intraChroma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;inter4x4Luma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;interChroma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;16&quot; maxOccurs=&quot;16&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;intra8x8Luma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;64&quot; maxOccurs=&quot;64&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;inter8x8Luma&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;value&quot; type=&quot;uint8&quot; minOccurs=&quot;64&quot; maxOccurs=&quot;64&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;analyse&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;partitionI4x4&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;partitionI8x8&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;partitionP8x8&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;partitionP4x4&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;partitionB8x8&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;dct8x8&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;weightedPrediction&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;directPredictionMode&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;none&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;spatial&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;temporal&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;auto&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;directPredictionSize&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;4x4&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;8x8&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;smallest&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;chromaLumaQuantiserDifference&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;-12&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;12&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;motionEstimationMethod&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;diamond&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;hexagonal&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;multi-hexagonal&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;exhaustive&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;hadamard&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;motionVectorSearchRange&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;64&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;motionVectorLength&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;-1&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;512&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;motionVectorThreadBuffer&quot; type=&quot;xs:integer&quot;/&gt;
+                    &lt;xs:element name=&quot;subpixelRefinement&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;1&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;7&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;bidirectionalMotionEstimation&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;chromaMotionEstimation&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;bFrameRdo&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;mixedReferences&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;trellis&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;disabled&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;finalMacroblock&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;allModeDecisions&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;fastPSkip&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;dctDecimate&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;noiseReduction&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;65536&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;interLumaDeadzone&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;32&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;intraLumaDeadzone&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;32&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;computePsnr&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;computeSsim&quot; type=&quot;xs:boolean&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;rateControl&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;quantiserMinimum&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;10&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;51&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;quantiserMaximum&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;10&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;51&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;quantiserStep&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;10&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;averageBitrateTolerance&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;1&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;vbvMaximumBitrate&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;99999&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;vbvBufferSize&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;99999&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;vbvInitialOccupancy&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;1&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;ipFrameQuantiser&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;1&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;10&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;pbFrameQuantiser&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;1&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;10&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;adaptiveQuantiserMode&quot; minOccurs=&quot;0&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                          &lt;xs:enumeration value=&quot;none&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;local&quot;/&gt;
+                          &lt;xs:enumeration value=&quot;global&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;adaptiveQuantiserStrength&quot; type=&quot;xs:float&quot; minOccurs=&quot;0&quot;/&gt;
+                    &lt;xs:element name=&quot;rateControlEquation&quot; type=&quot;xs:string&quot;/&gt;
+                    &lt;xs:element name=&quot;quantiserCurveCompression&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;1&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;reduceFluxBeforeCurveCompression&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;999&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;reduceFluxAfterCurveCompression&quot;&gt;
+                      &lt;xs:simpleType&gt;
+                        &lt;xs:restriction base=&quot;xs:float&quot;&gt;
+                          &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+                          &lt;xs:maxInclusive value=&quot;1&quot;/&gt;
+                        &lt;/xs:restriction&gt;
+                      &lt;/xs:simpleType&gt;
+                    &lt;/xs:element&gt;
+                    &lt;xs:element name=&quot;zone&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;
+                      &lt;xs:complexType&gt;
+                        &lt;xs:sequence&gt;
+                          &lt;xs:element name=&quot;frameStart&quot; type=&quot;xs:integer&quot;/&gt;
+                          &lt;xs:element name=&quot;frameEnd&quot; type=&quot;xs:integer&quot;/&gt;
+                          &lt;xs:choice&gt;
+                            &lt;xs:element name=&quot;quantiser&quot; type=&quot;quantiser&quot;/&gt;
+                            &lt;xs:element name=&quot;bitrateFactor&quot; type=&quot;xs:float&quot;/&gt;
+                          &lt;/xs:choice&gt;
+                        &lt;/xs:sequence&gt;
+                      &lt;/xs:complexType&gt;
+                    &lt;/xs:element&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;accessUnitDelimiters&quot; type=&quot;xs:boolean&quot;/&gt;
+              &lt;xs:element name=&quot;spsIdentifier&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+                    &lt;xs:enumeration value=&quot;0&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;1&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;3&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;7&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;15&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;31&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+      &lt;/xs:sequence&gt;
+    &lt;/xs:complexType&gt;
+  &lt;/xs:element&gt;
+
+  &lt;xs:simpleType name=&quot;uint&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
+  &lt;xs:simpleType name=&quot;uint8&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+      &lt;xs:maxInclusive value=&quot;255&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
+  &lt;xs:simpleType name=&quot;quantiser&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+      &lt;xs:maxInclusive value=&quot;51&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
 &lt;/xs:schema&gt;

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt	2008-05-23 16:39:03 UTC (rev 4060)
@@ -0,0 +1 @@
+INSTALL(FILES &quot;PlayStation Portable.xml&quot; DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}&quot;)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml	2008-05-22 18:07:46 UTC (rev 4059)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/PlayStation Portable.xml	2008-05-23 16:39:03 UTC (rev 4060)
@@ -0,0 +1,291 @@
+&lt;?xml version='1.0'?&gt;
+&lt;x264Config&gt;
+  &lt;encodeOptions&gt;
+    &lt;mode&gt;CBR&lt;/mode&gt;
+    &lt;parameter&gt;768&lt;/parameter&gt;
+  &lt;/encodeOptions&gt;
+  &lt;x264Options&gt;
+    &lt;threads&gt;0&lt;/threads&gt;
+    &lt;deterministic&gt;true&lt;/deterministic&gt;
+    &lt;idcLevel&gt;3&lt;/idcLevel&gt;
+    &lt;vui&gt;
+      &lt;sarAsInput&gt;false&lt;/sarAsInput&gt;
+      &lt;sarHeight&gt;1&lt;/sarHeight&gt;
+      &lt;sarWidth&gt;1&lt;/sarWidth&gt;
+      &lt;overscan&gt;undefined&lt;/overscan&gt;
+      &lt;videoFormat&gt;undefined&lt;/videoFormat&gt;
+      &lt;fullRangeSamples&gt;false&lt;/fullRangeSamples&gt;
+      &lt;colorPrimaries&gt;undefined&lt;/colorPrimaries&gt;
+      &lt;transfer&gt;undefined&lt;/transfer&gt;
+      &lt;colorMatrix&gt;undefined&lt;/colorMatrix&gt;
+      &lt;chromaSampleLocation&gt;0&lt;/chromaSampleLocation&gt;
+    &lt;/vui&gt;
+    &lt;referenceFrames&gt;2&lt;/referenceFrames&gt;
+    &lt;gopMaximumSize&gt;100&lt;/gopMaximumSize&gt;
+    &lt;gopMinimumSize&gt;25&lt;/gopMinimumSize&gt;
+    &lt;scenecutThreshold&gt;0&lt;/scenecutThreshold&gt;
+    &lt;preScenecutDetection&gt;false&lt;/preScenecutDetection&gt;
+    &lt;bFrames&gt;3&lt;/bFrames&gt;
+    &lt;adaptiveBframeDecision&gt;true&lt;/adaptiveBframeDecision&gt;
+    &lt;bFrameBias&gt;0&lt;/bFrameBias&gt;
+    &lt;bFrameReferences&gt;0&lt;/bFrameReferences&gt;
+    &lt;loopFilter&gt;false&lt;/loopFilter&gt;
+    &lt;loopFilterAlphaC0&gt;0&lt;/loopFilterAlphaC0&gt;
+    &lt;loopFilterBeta&gt;0&lt;/loopFilterBeta&gt;
+    &lt;cabac&gt;true&lt;/cabac&gt;
+    &lt;interlaced&gt;false&lt;/interlaced&gt;
+    &lt;cqmPreset&gt;flat&lt;/cqmPreset&gt;
+    &lt;intra4x4Luma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/intra4x4Luma&gt;
+    &lt;intraChroma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/intraChroma&gt;
+    &lt;inter4x4Luma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/inter4x4Luma&gt;
+    &lt;interChroma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/interChroma&gt;
+    &lt;intra8x8Luma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/intra8x8Luma&gt;
+    &lt;inter8x8Luma&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+      &lt;value&gt;16&lt;/value&gt;
+    &lt;/inter8x8Luma&gt;
+    &lt;analyse&gt;
+      &lt;partitionI4x4&gt;false&lt;/partitionI4x4&gt;
+      &lt;partitionI8x8&gt;false&lt;/partitionI8x8&gt;
+      &lt;partitionP8x8&gt;false&lt;/partitionP8x8&gt;
+      &lt;partitionP4x4&gt;false&lt;/partitionP4x4&gt;
+      &lt;partitionB8x8&gt;false&lt;/partitionB8x8&gt;
+      &lt;dct8x8&gt;false&lt;/dct8x8&gt;
+      &lt;weightedPrediction&gt;false&lt;/weightedPrediction&gt;
+      &lt;directPredictionMode&gt;spatial&lt;/directPredictionMode&gt;
+      &lt;directPredictionSize&gt;smallest&lt;/directPredictionSize&gt;
+      &lt;chromaLumaQuantiserDifference&gt;0&lt;/chromaLumaQuantiserDifference&gt;
+      &lt;motionEstimationMethod&gt;hexagonal&lt;/motionEstimationMethod&gt;
+      &lt;motionVectorSearchRange&gt;4&lt;/motionVectorSearchRange&gt;
+      &lt;motionVectorLength&gt;-1&lt;/motionVectorLength&gt;
+      &lt;motionVectorThreadBuffer&gt;-1&lt;/motionVectorThreadBuffer&gt;
+      &lt;subpixelRefinement&gt;5&lt;/subpixelRefinement&gt;
+      &lt;bidirectionalMotionEstimation&gt;false&lt;/bidirectionalMotionEstimation&gt;
+      &lt;chromaMotionEstimation&gt;false&lt;/chromaMotionEstimation&gt;
+      &lt;bFrameRdo&gt;false&lt;/bFrameRdo&gt;
+      &lt;mixedReferences&gt;false&lt;/mixedReferences&gt;
+      &lt;trellis&gt;disabled&lt;/trellis&gt;
+      &lt;fastPSkip&gt;true&lt;/fastPSkip&gt;
+      &lt;dctDecimate&gt;true&lt;/dctDecimate&gt;
+      &lt;noiseReduction&gt;0&lt;/noiseReduction&gt;
+      &lt;interLumaDeadzone&gt;21&lt;/interLumaDeadzone&gt;
+      &lt;intraLumaDeadzone&gt;11&lt;/intraLumaDeadzone&gt;
+      &lt;computePsnr&gt;true&lt;/computePsnr&gt;
+      &lt;computeSsim&gt;true&lt;/computeSsim&gt;
+    &lt;/analyse&gt;
+    &lt;rateControl&gt;
+      &lt;quantiserMinimum&gt;10&lt;/quantiserMinimum&gt;
+      &lt;quantiserMaximum&gt;51&lt;/quantiserMaximum&gt;
+      &lt;quantiserStep&gt;4&lt;/quantiserStep&gt;
+      &lt;averageBitrateTolerance&gt;1.000000&lt;/averageBitrateTolerance&gt;
+      &lt;vbvMaximumBitrate&gt;0&lt;/vbvMaximumBitrate&gt;
+      &lt;vbvBufferSize&gt;0&lt;/vbvBufferSize&gt;
+      &lt;vbvInitialOccupancy&gt;0.900000&lt;/vbvInitialOccupancy&gt;
+      &lt;ipFrameQuantiser&gt;1.400000&lt;/ipFrameQuantiser&gt;
+      &lt;pbFrameQuantiser&gt;1.300000&lt;/pbFrameQuantiser&gt;
+      &lt;adaptiveQuantiserMode&gt;global&lt;/adaptiveQuantiserMode&gt;
+      &lt;adaptiveQuantiserStrength&gt;1.000000&lt;/adaptiveQuantiserStrength&gt;
+      &lt;rateControlEquation&gt;blurCplx^(1-qComp)&lt;/rateControlEquation&gt;
+      &lt;quantiserCurveCompression&gt;0.600000&lt;/quantiserCurveCompression&gt;
+      &lt;reduceFluxBeforeCurveCompression&gt;20.000000&lt;/reduceFluxBeforeCurveCompression&gt;
+      &lt;reduceFluxAfterCurveCompression&gt;0.500000&lt;/reduceFluxAfterCurveCompression&gt;
+    &lt;/rateControl&gt;
+    &lt;accessUnitDelimiters&gt;false&lt;/accessUnitDelimiters&gt;
+    &lt;spsIdentifier&gt;0&lt;/spsIdentifier&gt;
+  &lt;/x264Options&gt;
+&lt;/x264Config&gt;
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001316.html">[Avidemux-svn-commit] r4059 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_UIs/ADM_GTK/include avidemux/ADM_UIs/ADM_GTK/src	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/plugins/ADM_videoFilters/MPDelogo/gtk cmake
</A></li>
	<LI>Next message: <A HREF="001318.html">[Avidemux-svn-commit] r4061 - in	branches/avidemux_2.5_branch_gruntster: .	avidemux/plugins/ADM_videoEncoder/ADM_vidEnc_x264
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1317">[ date ]</a>
              <a href="thread.html#1317">[ thread ]</a>
              <a href="subject.html#1317">[ subject ]</a>
              <a href="author.html#1317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
