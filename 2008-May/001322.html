<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4065 - in branches/avidemux_2.5_branch_gruntster: avidemux/ADM_UIs/ADM_CLI/include avidemux/ADM_UIs/ADM_CLI/src avidemux/ADM_UIs/ADM_GTK/include avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/include avidemux/ADM_UIs/ADM_QT4/src avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_coreUI/include avidemux/ADM_filter avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_videoFilter avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/ASharp avidemux/plugins/ADM_videoFilters/ASharp/gtk avidemux/plugins/ADM_videoFilters/ASharp/qt4 avidemux/plugins/ADM_videoFilters/AvisynthResize avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4 avidemux/plugins/ADM_videoFilters/ChromaShift avidemux/plugins/ADM_videoFilters/ChromaShift/qt4 avidemux/plugins/ADM_v! ideoFilters/Contrast avidemux/plugins/ADM_videoFilters/Contrast/gtk avidemux/plugins/ADM_videoFilters/Contrast/qt4 avidemux/plugins/ADM_videoFilters/Crop avidemux/plugins/ADM_videoFilters/Crop/gtk avidemux/plugins/ADM_videoFilters/Crop/qt4 avidemux/plugins/ADM_videoFilters/Eq2 avidemux/plugins/ADM_videoFilters/Eq2/gtk avidemux/plugins/ADM_videoFilters/Eq2/qt4 avidemux/plugins/ADM_videoFilters/Equalizer/gtk avidemux/plugins/ADM_videoFilters/Hue avidemux/plugins/ADM_videoFilters/Hue/gtk avidemux/plugins/ADM_videoFilters/Hue/qt4 avidemux/plugins/ADM_videoFilters/MplayerResize avidemux/plugins/ADM_videoFilters/MplayerResize/qt4 avidemux/plugins/ADM_videoFilters/Srt avidemux/plugins/ADM_videoFilters/Srt/gtk avidemux/plugins/ADM_videoFilters/Srt/qt4 cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4065%20-%20in%0A%20branches/avidemux_2.5_branch_gruntster%3A%20avidemux/ADM_UIs/ADM_CLI/include%0A%20avidemux/ADM_UIs/ADM_CLI/src%20avidemux/ADM_UIs/ADM_GTK/include%0A%20avidemux/ADM_UIs/ADM_GTK/src%20avidemux/ADM_UIs/ADM_QT4/include%0A%20avidemux/ADM_UIs/ADM_QT4/src%20avidemux/ADM_coreImage/include%0A%20avidemux/ADM_coreImage/src%20avidemux/ADM_coreUI/include%20avidemux/ADM_filter%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_videoFilter%0A%20avidemux/plugins/ADM_videoFilters%20avidemux/plugins/ADM_videoFilters/ASharp%0A%20avidemux/plugins/ADM_videoFilters/ASharp/gtk%0A%20avidemux/plugins/ADM_videoFilters/ASharp/qt4%0A%20avidemux/plugins/ADM_videoFilters/AvisynthResize%0A%20avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4%0A%20avidemux/plugins/ADM_videoFilters/ChromaShift%0A%20avidemux/plugins/ADM_videoFilters/ChromaShift/qt4%20avidemux/plugins/ADM_v%21%0A%20ideoFilters/Contrast%20avidemux/plugins/ADM_videoFilters/Contrast/gtk%0A%20avidemux/plugins/ADM_videoFilters/Contrast/qt4%0A%20avidemux/plugins/ADM_videoFilters/Crop%0A%20avidemux/plugins/ADM_videoFilters/Crop/gtk%0A%20avidemux/plugins/ADM_videoFilters/Crop/qt4%0A%20avidemux/plugins/ADM_videoFilters/Eq2%0A%20avidemux/plugins/ADM_videoFilters/Eq2/gtk%0A%20avidemux/plugins/ADM_videoFilters/Eq2/qt4%0A%20avidemux/plugins/ADM_videoFilters/Equalizer/gtk%0A%20avidemux/plugins/ADM_videoFilters/Hue%0A%20avidemux/plugins/ADM_videoFilters/Hue/gtk%0A%20avidemux/plugins/ADM_videoFilters/Hue/qt4%0A%20avidemux/plugins/ADM_videoFilters/MplayerResize%0A%20avidemux/plugins/ADM_videoFilters/MplayerResize/qt4%0A%20avidemux/plugins/ADM_videoFilters/Srt%0A%20avidemux/plugins/ADM_videoFilters/Srt/gtk%0A%20avidemux/plugins/ADM_videoFilters/Srt/qt4%20cmake&In-Reply-To=%3C200805251748.m4PHmMhf007033%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001321.html">
   <LINK REL="Next"  HREF="001323.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4065 - in branches/avidemux_2.5_branch_gruntster: avidemux/ADM_UIs/ADM_CLI/include avidemux/ADM_UIs/ADM_CLI/src avidemux/ADM_UIs/ADM_GTK/include avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/include avidemux/ADM_UIs/ADM_QT4/src avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_coreUI/include avidemux/ADM_filter avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_videoFilter avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/ASharp avidemux/plugins/ADM_videoFilters/ASharp/gtk avidemux/plugins/ADM_videoFilters/ASharp/qt4 avidemux/plugins/ADM_videoFilters/AvisynthResize avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4 avidemux/plugins/ADM_videoFilters/ChromaShift avidemux/plugins/ADM_videoFilters/ChromaShift/qt4 avidemux/plugins/ADM_v! ideoFilters/Contrast avidemux/plugins/ADM_videoFilters/Contrast/gtk avidemux/plugins/ADM_videoFilters/Contrast/qt4 avidemux/plugins/ADM_videoFilters/Crop avidemux/plugins/ADM_videoFilters/Crop/gtk avidemux/plugins/ADM_videoFilters/Crop/qt4 avidemux/plugins/ADM_videoFilters/Eq2 avidemux/plugins/ADM_videoFilters/Eq2/gtk avidemux/plugins/ADM_videoFilters/Eq2/qt4 avidemux/plugins/ADM_videoFilters/Equalizer/gtk avidemux/plugins/ADM_videoFilters/Hue avidemux/plugins/ADM_videoFilters/Hue/gtk avidemux/plugins/ADM_videoFilters/Hue/qt4 avidemux/plugins/ADM_videoFilters/MplayerResize avidemux/plugins/ADM_videoFilters/MplayerResize/qt4 avidemux/plugins/ADM_videoFilters/Srt avidemux/plugins/ADM_videoFilters/Srt/gtk avidemux/plugins/ADM_videoFilters/Srt/qt4 cmake</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4065%20-%20in%0A%20branches/avidemux_2.5_branch_gruntster%3A%20avidemux/ADM_UIs/ADM_CLI/include%0A%20avidemux/ADM_UIs/ADM_CLI/src%20avidemux/ADM_UIs/ADM_GTK/include%0A%20avidemux/ADM_UIs/ADM_GTK/src%20avidemux/ADM_UIs/ADM_QT4/include%0A%20avidemux/ADM_UIs/ADM_QT4/src%20avidemux/ADM_coreImage/include%0A%20avidemux/ADM_coreImage/src%20avidemux/ADM_coreUI/include%20avidemux/ADM_filter%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_videoFilter%0A%20avidemux/plugins/ADM_videoFilters%20avidemux/plugins/ADM_videoFilters/ASharp%0A%20avidemux/plugins/ADM_videoFilters/ASharp/gtk%0A%20avidemux/plugins/ADM_videoFilters/ASharp/qt4%0A%20avidemux/plugins/ADM_videoFilters/AvisynthResize%0A%20avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4%0A%20avidemux/plugins/ADM_videoFilters/ChromaShift%0A%20avidemux/plugins/ADM_videoFilters/ChromaShift/qt4%20avidemux/plugins/ADM_v%21%0A%20ideoFilters/Contrast%20avidemux/plugins/ADM_videoFilters/Contrast/gtk%0A%20avidemux/plugins/ADM_videoFilters/Contrast/qt4%0A%20avidemux/plugins/ADM_videoFilters/Crop%0A%20avidemux/plugins/ADM_videoFilters/Crop/gtk%0A%20avidemux/plugins/ADM_videoFilters/Crop/qt4%0A%20avidemux/plugins/ADM_videoFilters/Eq2%0A%20avidemux/plugins/ADM_videoFilters/Eq2/gtk%0A%20avidemux/plugins/ADM_videoFilters/Eq2/qt4%0A%20avidemux/plugins/ADM_videoFilters/Equalizer/gtk%0A%20avidemux/plugins/ADM_videoFilters/Hue%0A%20avidemux/plugins/ADM_videoFilters/Hue/gtk%0A%20avidemux/plugins/ADM_videoFilters/Hue/qt4%0A%20avidemux/plugins/ADM_videoFilters/MplayerResize%0A%20avidemux/plugins/ADM_videoFilters/MplayerResize/qt4%0A%20avidemux/plugins/ADM_videoFilters/Srt%0A%20avidemux/plugins/ADM_videoFilters/Srt/gtk%0A%20avidemux/plugins/ADM_videoFilters/Srt/qt4%20cmake&In-Reply-To=%3C200805251748.m4PHmMhf007033%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4065 - in branches/avidemux_2.5_branch_gruntster: avidemux/ADM_UIs/ADM_CLI/include avidemux/ADM_UIs/ADM_CLI/src avidemux/ADM_UIs/ADM_GTK/include avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/include avidemux/ADM_UIs/ADM_QT4/src avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_coreUI/include avidemux/ADM_filter avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_videoFilter avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/ASharp avidemux/plugins/ADM_videoFilters/ASharp/gtk avidemux/plugins/ADM_videoFilters/ASharp/qt4 avidemux/plugins/ADM_videoFilters/AvisynthResize avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4 avidemux/plugins/ADM_videoFilters/ChromaShift avidemux/plugins/ADM_videoFilters/ChromaShift/qt4 avidemux/plugins/ADM_v! ideoFilters/Contrast avidemux/plugins/ADM_videoFilters/Contrast/gtk avidemux/plugins/ADM_videoFilters/Contrast/qt4 avidemux/plugins/ADM_videoFilters/Crop avidemux/plugins/ADM_videoFilters/Crop/gtk avidemux/plugins/ADM_videoFilters/Crop/qt4 avidemux/plugins/ADM_videoFilters/Eq2 avidemux/plugins/ADM_videoFilters/Eq2/gtk avidemux/plugins/ADM_videoFilters/Eq2/qt4 avidemux/plugins/ADM_videoFilters/Equalizer/gtk avidemux/plugins/ADM_videoFilters/Hue avidemux/plugins/ADM_videoFilters/Hue/gtk avidemux/plugins/ADM_videoFilters/Hue/qt4 avidemux/plugins/ADM_videoFilters/MplayerResize avidemux/plugins/ADM_videoFilters/MplayerResize/qt4 avidemux/plugins/ADM_videoFilters/Srt avidemux/plugins/ADM_videoFilters/Srt/gtk avidemux/plugins/ADM_videoFilters/Srt/qt4 cmake">mean at mail.berlios.de
       </A><BR>
    <I>Sun May 25 19:48:22 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001321.html">[Avidemux-svn-commit] r4064 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_UIs/ADM_GTK/src ADM_UIs/ADM_QT4/include	ADM_UIs/ADM_QT4/src ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
        <LI>Next message: <A HREF="001323.html">[Avidemux-svn-commit] r4066 - in	branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters:	AvisynthResize/qt4 MplayerResize/qt4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1322">[ date ]</a>
              <a href="thread.html#1322">[ thread ]</a>
              <a href="subject.html#1322">[ subject ]</a>
              <a href="author.html#1322">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-05-25 19:48:15 +0200 (Sun, 25 May 2008)
New Revision: 4065

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/gtk/DIA_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/asharp.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4/Q_resize.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/gtk/DIA_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/crop.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/gtk/DIA_eq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/gtk/DIA_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/hue.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTload.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/gtk/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/gtk/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/srt.ui
Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/include/DIA_flyDialogCli.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/include/DIA_flyDialogGtk.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_flyDialogGtk.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_QCanvas.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_flyDialogQt4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/DIA_flyDialog.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/DIA_flyDialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_uiTypes.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Equalizer/gtk/DIA_equalizer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/resizing.h
   branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake
Log:
[Merge] flyDialog


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/include/DIA_flyDialogCli.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/include/DIA_flyDialogCli.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/include/DIA_flyDialogCli.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -14,12 +14,16 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#ifndef ADM_FLY_DIALOG_CLI4H
-#define ADM_FLY_DIALOG_CLIH
+#ifndef ADM_FLY_DIALOG_CLI_H
+#define ADM_FLY_DIALOG_CLI_H
 #include &quot;DIA_flyDialog.h&quot;
 class ADM_flyDialogCli : public ADM_flyDialog
 {
 public:
+  ADM_flyDialogCli(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod):
+                                ADM_flyDialog(width,height,in,canvas,slider,yuv,resizeMethod) {};
+
   virtual uint8_t  cleanup2(void);
   virtual uint8_t  isRgbInverted(void);
   virtual uint8_t  display(void);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_CLI/src/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -7,5 +7,5 @@
 )
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../include)
 ADD_LIBRARY(${ADM_LIB}  SHARED ${${ADM_LIB}_SRCS})
-
+ADD_SOURCE_CFLAGS(DIA_flyDialogCli.cpp &quot; -DADM_UI_TYPE_BUILD=1&quot;)
 INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/include/DIA_flyDialogGtk.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/include/DIA_flyDialogGtk.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/include/DIA_flyDialogGtk.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -28,6 +28,8 @@
 class ADM_flyDialogGtk : public ADM_flyDialog
 {
 public:
+  ADM_flyDialogGtk(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod);
   virtual uint8_t  cleanup2(void);
   virtual uint8_t  isRgbInverted(void);
   virtual uint8_t  display(void);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -28,4 +28,5 @@
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})
 TARGET_LINK_LIBRARIES(${ADM_LIB} ${GTK_LDFLAGS} ADM_core ADM_coreUI ADM_render_gtk)
 ADD_TARGET_CFLAGS(${ADM_LIB} ${GTK_CFLAGS})
+ADD_SOURCE_CFLAGS(DIA_flyDialogGtk.cpp &quot; -DADM_UI_TYPE_BUILD=2&quot;)
 INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_flyDialogGtk.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_flyDialogGtk.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_flyDialogGtk.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -209,5 +209,10 @@
 
     return 0;
 }
-
+ADM_flyDialogGtk::ADM_flyDialogGtk(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod):
+                                ADM_flyDialog(width,height,in,canvas,slider,yuv,resizeMethod) 
+{
+    EndConstructor();
+};
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -22,6 +22,9 @@
 class ADM_flyDialogQt4 : public ADM_flyDialog
 {
 public:
+  ADM_flyDialogQt4(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod);
+
   virtual uint8_t  cleanup2(void);
   virtual uint8_t  isRgbInverted(void);
   virtual uint8_t  display(void);
@@ -41,7 +44,6 @@
   virtual uint32_t  getMenuValue (const MenuMapping * mm) ;          
 };
 
-#include &lt;QtGui/QWidget&gt;
 
 class ADM_QCanvas : public QWidget
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -6,7 +6,8 @@
 
 SET(${ADM_LIB}_T
 	T_bitrate.cpp  T_button.cpp  T_dialogFactory.cpp  T_filesel.cpp  T_menu.cpp
-	T_slider.cpp  T_threadCount.cpp  T_toggle.cpp  T_flyDialogQt4.cpp  T_QCanvas.cpp
+	T_slider.cpp  T_threadCount.cpp  T_toggle.cpp
+        T_flyDialogQt4.cpp T_QCanvas.cpp
 )
 
 SET(${ADM_LIB}_SRCS
@@ -17,5 +18,7 @@
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${QT_INCLUDE_DIR})
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../include)
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})
+ADD_SOURCE_CFLAGS(T_flyDialogQt4.cpp &quot; -DADM_UI_TYPE_BUILD=4&quot;)
+ADD_SOURCE_CFLAGS(T_QCanvas.cpp &quot; -DADM_UI_TYPE_BUILD=4&quot;)
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core ADM_coreUI ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY} ADM_render_qt4)
 INSTALL(TARGETS ${ADM_LIB} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_QCanvas.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_QCanvas.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_QCanvas.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -13,8 +13,12 @@
 ***************************************************************************///
 
 #include &lt;QtGui/QPainter&gt;
+#include &lt;QtGui/QGraphicsView&gt;
+#include &lt;QtGui/QSlider&gt;
 
 #include &quot;ADM_default.h&quot;
+
+#include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 
 void ADM_QCanvas::changeSize(uint32_t w,uint32_t h)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_flyDialogQt4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_flyDialogQt4.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_flyDialogQt4.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -21,6 +21,12 @@
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
+  ADM_flyDialogQt4::ADM_flyDialogQt4(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod):
+                                ADM_flyDialog(width,height,in,canvas,slider,yuv,resizeMethod) 
+{
+        EndConstructor();
+}
 
 void ADM_flyDialogQt4::postInit(uint8_t reInit)
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/DIA_flyDialog.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/DIA_flyDialog.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -24,7 +24,20 @@
  ***************************************************************************/
 #ifndef ADM_FLY_DIALOG_H
 #define ADM_FLY_DIALOG_H
+
+#if !defined(ADM_UI_TYPE_BUILD)
+#error No ADM_UI_TYPE_BUILD defined
+#endif
+#include &quot;DIA_uiTypes.h&quot;
+
+#if ADM_UI_TYPE_BUILD == ADM_UI_QT4
+        #include &lt;QtGui/QWidget&gt;
+        #include &lt;QtGui/QDialog&gt;
+#endif 
+
+#include &quot;ADM_default.h&quot;
 #include &quot;ADM_colorspace.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
 enum ResizeMethod {
         RESIZE_NONE = 0,	// No automatic resize
 	RESIZE_AUTO = 1,	// Resize image when convenient (YUV: after filter, RGB: before applying filter)
@@ -61,7 +74,7 @@
           ADMImageResizer *_resizer;
 
   
-  
+          void EndConstructor(void);
           void copyYuvFinalToRgb(void);
           void copyYuvScratchToRgb(void);
           void copyRgbFinalToDisplay(void);
@@ -120,9 +133,30 @@
   virtual  const MenuMapping *lookupMenu (const char * widgetName,
                                                const MenuMapping * menu_mapping,
                                                uint32_t menu_mapping_count)  {ADM_assert(0);return NULL;};
-             
-                    
+};          
+#ifdef ADM_UI_TYPE_BUILD
+#if ADM_UI_TYPE_BUILD == ADM_UI_QT4
+  #include &quot;DIA_flyDialogQt4.h&quot;
+  #define FLY_DIALOG_TYPE ADM_flyDialogQt4
+#else 
+  #if ADM_UI_TYPE_BUILD == ADM_UI_GTK
+    #include &quot;DIA_flyDialogGtk.h&quot;
+    #define FLY_DIALOG_TYPE ADM_flyDialogGtk
+  #else 
+    #if ADM_UI_TYPE_BUILD == ADM_UI_CLI
+      #include &quot;DIA_flyDialogCli.h&quot;
+      #define FLY_DIALOG_TYPE ADM_flyDialogCli
+    #else
+        #if ADM_UI_TYPE_BUILD != ADM_UI_NONE
+#error unknown UI type
+        #endif
+    #endif //CLI
+  #endif //GTK
+#endif // QT
+#else
+  #define FLY_DIALOG_TYPE ADM_UI_TYPE_BUILD_IS_NOT_DEFINED
+#endif
  
- };
+ 
 
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -20,7 +20,7 @@
 )
 
 ADD_LIBRARY(ADM_coreImage SHARED ${ADM_coreImage_SRCS})
-
+ADD_SOURCE_CFLAGS(DIA_flyDialog.cpp &quot; -DADM_UI_TYPE_BUILD=99&quot;)
 IF (APPLE)
 	TARGET_LINK_LIBRARIES(ADM_coreImage -Wl,-read_only_relocs,suppress)
 ENDIF (APPLE)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/DIA_flyDialog.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/DIA_flyDialog.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -39,14 +39,11 @@
 	_cookie = NULL;
 	_resizeMethod = resizeMethod;
         _zoomChangeCount = 0;
+        _resizer=NULL;
+        _rgbBufferDisplay=NULL;
 
-	if (isRgbInverted())
-		_rgb=new ColYuvRgb(_w,_h,1);
-	else
-		_rgb=new ColYuvRgb(_w,_h);
+	_rgb=NULL;
 
-	_rgb-&gt;reset(_w,_h);
-
 	_yuvBuffer=new ADMImage(_w,_h);
 
 	if(_isYuvProcessing)
@@ -62,45 +59,59 @@
 
 	_rgbBufferOut =new uint8_t [_w*_h*4];
 
-	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
-	{
-		_zoom = calcZoomFactor();
+	
 
-		if (_zoom == 1)
-			_resizeMethod = RESIZE_NONE;
-		else
-		{
-			_zoomW = uint32_t (_w * _zoom);
-			_zoomH = uint32_t (_h * _zoom);
-		}
-	}
+	
+}
+/**
+ *      \fn Endconstructor
+ *      \brief We call some virtual functions in the constructor; it does not work, so we do the 2nd part of the constructor here
+ */
+void ADM_flyDialog::EndConstructor(void)
+  {
+    if (isRgbInverted())
+                _rgb=new ColYuvRgb(_w,_h,1);
         else
-		_zoom = 1;
+                _rgb=new ColYuvRgb(_w,_h);
 
-	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
-	{
-		PixelFormat sourceColour;
+        _rgb-&gt;reset(_w,_h);
+        if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
+                {
+                        _zoom = calcZoomFactor();
 
-		if (_resizeMethod == RESIZE_AUTO || _isYuvProcessing)
-			sourceColour = PIX_FMT_YUV420P;
-		else
-			sourceColour = PIX_FMT_RGB32;
+                        if (_zoom == 1)
+                                _resizeMethod = RESIZE_NONE;
+                        else
+                        {
+                                _zoomW = uint32_t (_w * _zoom);
+                                _zoomH = uint32_t (_h * _zoom);
+                        }
+                }
+                else
+                        _zoom = 1;
 
-		_resizer = new ADMImageResizer(_w, _h, _zoomW, _zoomH, sourceColour, PIX_FMT_RGB32);
-		_rgbBufferDisplay = new uint8_t[_w * _h * 4];
-	}
-	else
-	{
-		_zoomW = _w;
-		_zoomH = _h;
+                if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
+                {
+                        PixelFormat sourceColour;
 
-		_resizer = NULL;
-		_rgbBufferDisplay = NULL;
-	}
+                        if (_resizeMethod == RESIZE_AUTO || _isYuvProcessing)
+                                sourceColour = PIX_FMT_YUV420P;
+                        else
+                                sourceColour = PIX_FMT_RGB32;
 
-	postInit (false);
-}
+                        _resizer = new ADMImageResizer(_w, _h, _zoomW, _zoomH, sourceColour, PIX_FMT_RGB32);
+                        _rgbBufferDisplay = new uint8_t[_w * _h * 4];
+                }
+                else
+                {
+                        _zoomW = _w;
+                        _zoomH = _h;
 
+                        _resizer = NULL;
+                        _rgbBufferDisplay = NULL;
+                }
+                postInit (false);
+  }
 void ADM_flyDialog::recomputeSize(void)
 {
     float new_zoom = calcZoomFactor();
@@ -189,7 +200,8 @@
 */
 ADM_flyDialog::~ADM_flyDialog(void)
 {
-  cleanup2();
+  
+  // FIXME cleanup2();
   cleanup(); 
 }
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_uiTypes.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_uiTypes.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_uiTypes.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -19,6 +19,7 @@
 #define ADM_UI_CLI 1
 #define ADM_UI_GTK 2
 #define ADM_UI_QT4 4
+#define ADM_UI_NONE 99
 #define ADM_UI_ALL (ADM_UI_CLI+ADM_UI_GTK+ADM_UI_QT4)
 typedef  int  ADM_UI_TYPE;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -48,35 +48,38 @@
 REGISTERX(VF_INTERLACING, &quot;tdeint&quot;,QT_TR_NOOP(&quot;TDeint&quot;),QT_TR_NOOP(&quot;Motion adaptative deinterlacer by Tritical.&quot;),VF_TDEINT,1,tdeint_create,tdeint_script);
 
 //FLyDyalog
+#if 0
     REGISTERX(VF_COLORS, &quot;eq2&quot;,QT_TR_NOOP(&quot;MPlayer eq2&quot;),QT_TR_NOOP(&quot;Adjust contrast, brightness, saturation and gamma.&quot;),VF_EQ2,1,Eq2_create,Eq2_script);
     REGISTERX(VF_COLORS, &quot;hue&quot;,QT_TR_NOOP(&quot;MPlayer hue&quot;),QT_TR_NOOP(&quot;Adjust hue and saturation.&quot;),VF_HUE,1,hue_create,hue_script);
     REGISTERX(VF_COLORS, &quot;contrast&quot;,QT_TR_NOOP(&quot;Contrast&quot;),QT_TR_NOOP(&quot;Adjust contrast, brightness and colors.&quot;),VF_CONTRAST,1,contrast_create,contrast_script);
-    
-    
+    REGISTERX(VF_SHARPNESS, &quot;asharp&quot;,QT_TR_NOOP(&quot;asharp&quot;),QT_TR_NOOP(&quot;Adaptative sharpener by MarcFD.&quot;),VF_ASHARP,1,asharp_create,asharp_script);    
+#endif    
 
 // Custom UI    
 	
-REGISTERX(VF_SHARPNESS, &quot;asharp&quot;,QT_TR_NOOP(&quot;asharp&quot;),QT_TR_NOOP(&quot;Adaptative sharpener by MarcFD.&quot;),VF_ASHARP,1,asharp_create,asharp_script);
 
+
 REGISTERX(VF_MISC, &quot;animatedmenu&quot;,QT_TR_NOOP(&quot;Animated Menu&quot;), QT_TR_NOOP(&quot;Create a video made of 6 mini windows, very useful to do DVD menus.&quot;),
         VF_ANIMATED,1,animated_create,animated_script);
     
-  
+#if 0  
 #ifdef USE_FREETYPE   
 	REGISTERX(VF_SUBTITLE, &quot;subtitle&quot;,QT_TR_NOOP(&quot;Subtitler&quot;),QT_TR_NOOP(&quot;Add srt/sub subtitles to the picture.&quot;),VF_SUBTILE,1,subtitle_create,subtitle_script);
 // Ass can be moved &amp; linked to libass	
 	REGISTERX(VF_SUBTITLE, &quot;ass&quot;,QT_TR_NOOP(&quot;ASS&quot;),QT_TR_NOOP(&quot;Add ASS/SSA subtitles to the picture.&quot;),VF_ASS,1,ass_create,ass_script);
 #endif
+#endif	
 
         REGISTERX(VF_SUBTITLE,&quot;vobsub&quot;,QT_TR_NOOP(&quot;VobSub&quot;),QT_TR_NOOP(&quot;Embed VobSub subtitles into picture.&quot;),VF_VOBSUB,1,vobsub_create,vobsub_script);
         REGISTERX(VF_SUBTITLE,&quot;dvbsub&quot;,QT_TR_NOOP(&quot;DVB sub&quot;),QT_TR_NOOP(&quot;Embed DVB-T subtitle.&quot;),VF_DVBSUB,1,dvbsub_create,dvbsub_script);
         //*********************
+#if 0        
 	REGISTERX(VF_MISC, &quot;computeaverage&quot;,QT_TR_NOOP(&quot;Compute Average&quot;),QT_TR_NOOP(&quot;Compute average luma value for each pixel throughout all frames, and save to file&quot;),VF_COMPUTEAVERAGE,1,computeaverage_create,computeaverage_script);
 	REGISTERX(VF_MISC, &quot;threshold&quot;,QT_TR_NOOP(&quot;Threshold&quot;),QT_TR_NOOP(&quot;Force too-bright/too-dim pixels to 0 and the rest to 255 or vice-versa&quot;),VF_THRESHOLD,1,threshold_create,threshold_script);
 	//REGISTERX(&quot;particlelist&quot;,QT_TR_NOOP(&quot;Particle List&quot;),QT_TR_NOOP(&quot;Identify 'particles' (groups of pixels)&quot;),VF_PARTICLELIST,1,particle_create,particle_script);
 	//REGISTERX(&quot;eraser&quot;,QT_TR_NOOP(&quot;Eraser&quot;),QT_TR_NOOP(&quot;\&quot;Erase\&quot; arbitrary areas of each frame&quot;),VF_ERASER,1,eraser_create,eraser_script);
 	//REGISTERX(&quot;swissarmyknife&quot;,QT_TR_NOOP(&quot;Swiss Army Knife&quot;),QT_TR_NOOP(&quot;Apply operation like P'=P*A, P-A, P+A, etc. using a convolution, rolling average, image from file, or constant&quot;),VF_SWISSARMYKNIFE,1,swissarmyknife_create,swissarmyknife_script);
-
+#endif
 // Misc filter, internal only        
 	REGISTERX(VF_MISC,&quot;partial&quot;,QT_TR_NOOP(&quot;Partial&quot;),&quot;&quot;,VF_PARTIAL,0,partial_create,partial_script);
  printf(&quot;\n&quot;);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,15 +1,44 @@
 SET(ADM_LIB ADM_dialogGtk)
 
 SET(${ADM_LIB}_SRCS
-	DIA_about.cpp     DIA_calculator.cpp   DIA_crop.cpp       DIA_preview.cpp     DIA_srt.cpp      DIA_xvid4.cpp
-	DIA_acodec.cpp    DIA_encoding.cpp   DIA_hue.cpp        DIA_ocr.cpp       DIA_properties.cpp  DIA_vcodec.cpp   DIA_xvid.cpp
-	DIA_eq2.cpp        DIA_idx_pg.cpp     DIA_partial.cpp   DIA_quota.cpp       DIA_vobsub.cpp
-	DIA_asharp.cpp    DIA_jobs.cpp       DIA_pause.cpp     DIA_recent.cpp      DIA_working.cpp
-	DIA_busy.cpp      DIA_contrast.cpp     DIA_exLame.cpp     DIA_pipe.cpp      DIA_resize.cpp
-	DIA_threshold.cpp DIA_SwissArmyKnife.cpp DIA_particle.cpp DIA_eraser.cpp
+DIA_about.cpp    
+ DIA_calculator.cpp  
+ DIA_preview.cpp    
+ DIA_xvid4.cpp
+DIA_acodec.cpp   
+ DIA_encoding.cpp  
+ DIA_ocr.cpp      
+ DIA_properties.cpp 
+ DIA_vcodec.cpp  
+ DIA_xvid.cpp
+ DIA_idx_pg.cpp    
+ DIA_partial.cpp  
+ DIA_quota.cpp      
+ DIA_vobsub.cpp
+ DIA_jobs.cpp      
+ DIA_pause.cpp    
+ DIA_recent.cpp     
+ DIA_working.cpp
+DIA_busy.cpp     
+ DIA_exLame.cpp    
+ DIA_pipe.cpp     
+ DIA_resize.cpp
+DIA_threshold.cpp
+ DIA_SwissArmyKnife.cpp
+ DIA_particle.cpp
+ DIA_eraser.cpp
         toolkit_dialog.cpp
         TLK_filesel.cpp
 )
+SET(OBSOLETE_SRCS
+ DIA_hue.cpp       
+ DIA_srt.cpp     
+ DIA_crop.cpp      
+DIA_eq2.cpp       
+DIA_asharp.cpp   
+ DIA_contrast.cpp    
 
+
+)
 ADD_ADM_LIB_GTK_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})
 ADD_CFLAGS_GTK_TARGET(${ADM_LIB} ${GTK_CFLAGS} -DADM_SUBVERSION=${ADM_SUBVERSION})

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,291 +0,0 @@
-/**/
-/***************************************************************************
-                          DIA_hue
-                             -------------------
-
-                           Ui for hue &amp; sat
-
-    begin                : 08 Apr 2005
-    copyright            : (C) 2004/5 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-
-
-#include &quot;ADM_toolkitGtk.h&quot;
-
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyAsharp.h&quot;
-
-
-uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in);
-
-static GtkWidget        *create_dialog1 (void);
-static gboolean         draw (void );
-static void             upload(void);
-static void             download(void);
-static void             frame_changed( void );
-static void             hue_changed( void);
-
-static int lock=0;
-static GtkWidget *dialog=NULL;
-static flyASharp *myCrop=NULL;
-
-//
-//      Video is in YV12 Colorspace
-//
-//
-uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in)
-{
-      uint32_t width,height;
-      uint8_t ret=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;ASHARP&quot;));
-        gtk_widget_show(dialog);
-
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
-            GTK_SIGNAL_FUNC(draw),
-            NULL);
-//
-        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonT)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonD)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonB)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
-        gtk_widget_show(dialog);
-
-          
-        myCrop=new flyASharp( width, height,in,WID(drawingarea1),WID(hscale1));
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(ASHARP_PARAM));
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop-&gt;download();
-            memcpy(param,&amp;(myCrop-&gt;param),sizeof(ASHARP_PARAM));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-void hue_changed( void)
-{
-  if(lock) return;
-  
-   myCrop-&gt;update();
-  
-}
-void frame_changed( void )
-{
-  myCrop-&gt;sliderChanged();
-}
-gboolean draw (void)
-{
-    myCrop-&gt;display();
-}
-//
-#define SPIN_GET(x,y) {param.x= gtk_spin_button_get_value(GTK_SPIN_BUTTON(WID(y))) ;}
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(y)),(gfloat)param.x) ;}
-
-#define CHECK_GET(x,y) {param.x=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(y)));}
-#define CHECK_SET(x,y) {gtk_toggle_button_set_active( GTK_TOGGLE_BUTTON(WID(y)),param.x);}
-
-void upload( void)
-{
-    myCrop-&gt;upload();
-}
-void download (void)
-{
-     myCrop-&gt;download();
-}
-/**************************************/
-uint8_t flyASharp::upload(void)
-{
-    lock++;
-        SPIN_SET(t,spinbuttonT);
-        SPIN_SET(d,spinbuttonD);
-        SPIN_SET(b,spinbuttonB);
-
-        CHECK_SET(bf,checkbuttonBF);
-    lock--;
-        return 1;
-}
-uint8_t flyASharp::download (void)
-{
-    
-        SPIN_GET(t,spinbuttonT);
-        SPIN_GET(d,spinbuttonD);
-        SPIN_GET(b,spinbuttonB);
-
-        CHECK_GET(bf,checkbuttonBF);
-        return 1;
-}
-
-/**************************************************/
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *table1;
-  GtkWidget *label1;
-  GtkWidget *label2;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkObject *spinbuttonT_adj;
-  GtkWidget *spinbuttonT;
-  GtkObject *spinbuttonD_adj;
-  GtkWidget *spinbuttonD;
-  GtkObject *spinbuttonB_adj;
-  GtkWidget *spinbuttonB;
-  GtkWidget *checkbuttonBF;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;ASharp by MarcFD&quot;));
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  table1 = gtk_table_new (4, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, TRUE, TRUE, 0);
-
-  label1 = gtk_label_new (QT_TR_NOOP(&quot;Threshold :&quot;));
-  gtk_widget_show (label1);
-  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
-
-  label2 = gtk_label_new (QT_TR_NOOP(&quot;Strength :&quot;));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  label3 = gtk_label_new (QT_TR_NOOP(&quot;Block Adaptative :&quot;));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (QT_TR_NOOP(&quot;Unknown flag :&quot;));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  spinbuttonT_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
-  spinbuttonT = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonT_adj), 1, 1);
-  gtk_widget_show (spinbuttonT);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonT, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonT), TRUE);
-
-  spinbuttonD_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
-  spinbuttonD = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonD_adj), 1, 1);
-  gtk_widget_show (spinbuttonD);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonD, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonD), TRUE);
-
-  spinbuttonB_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
-  spinbuttonB = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonB_adj), 1, 1);
-  gtk_widget_show (spinbuttonB);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonB, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonB), TRUE);
-
-  checkbuttonBF = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot; &quot;));
-  gtk_widget_show (checkbuttonBF);
-  gtk_table_attach (GTK_TABLE (table1), checkbuttonBF, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonT, &quot;spinbuttonT&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonD, &quot;spinbuttonD&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonB, &quot;spinbuttonB&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBF, &quot;checkbuttonBF&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,273 +0,0 @@
-/***************************************************************************
-                          DIA_contrast.cpp  -  description
-                             -------------------
-    begin                : Mon Sep 23 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_toolkitGtk.h&quot;
-#include &quot;fourcc.h&quot;
-
-
-
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
-
-
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyContrast.h&quot;
-
-/********************************************************************/
-static GtkWidget *create_dialog1 (void);
-static GtkWidget *dialog = NULL;
-
-static gboolean gui_draw (GtkWidget * widget,
-			  GdkEventExpose * event, gpointer user_data);
-static void gui_update (GtkButton * button, gpointer user_data);
-static void frame_changed( void );
-
-static int lock=0;
-static flyContrast *myCrop=NULL;
-
-/********************************************************************/
-uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
-{
-  
-   uint32_t width,height;
-      uint8_t ret=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Contrast&quot;));
-        gtk_widget_show(dialog);	
-        
-          // and value changed
-#define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
-
-        CNX (checkLuma, &quot;toggled&quot;);
-        CNX (checkbuttonU, &quot;toggled&quot;);
-        CNX (checkbuttonV, &quot;toggled&quot;);
-        
-        
-        CNX (hscaleContrast, &quot;value_changed&quot;);
-        CNX (hscaleContrast, &quot;drag_data_received&quot;);
-      
-        CNX (hscaleBright, &quot;value_changed&quot;);
-        CNX (hscaleBright, &quot;drag_data_received&quot;);
-        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
-            GTK_SIGNAL_FUNC(gui_draw),
-            NULL);
-
-
-          
-        myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(CONTRAST_PARAM));
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop-&gt;download();
-            memcpy(param,&amp;(myCrop-&gt;param),sizeof(CONTRAST_PARAM));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-
-
-//
-//        Check entered values and green-out the selected portion on the screen
-//        Each value must be even
-//
-void frame_changed( void )
-{
-  myCrop-&gt;sliderChanged();
-}
-void gui_update (GtkButton * button, gpointer user_data)
-{
-  if(lock) return;
-    myCrop-&gt;update();
-}
-
-gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
-{
-  myCrop-&gt;display();
-  return TRUE;
-}
-
-/**************************************/
-#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
-			y=1; else y=0;
-#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
-
-
-uint8_t flyContrast::upload(void)
-{
-    lock++;
-      SCHECKBOX (checkLuma, param.doLuma);
-      SCHECKBOX (checkbuttonU, param.doChromaU);
-      SCHECKBOX (checkbuttonV, param.doChromaV);
-
-      GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
-      GTK_ADJUSTMENT(adj)-&gt;value=param.offset;
-  
-      adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
-      GTK_ADJUSTMENT(adj)-&gt;value=param.coef;
-    lock--;
-    return 1;
-}
-uint8_t flyContrast::download (void)
-{
-  CHECKBOX (checkLuma, param.doLuma);
-  CHECKBOX (checkbuttonU, param.doChromaU);
-  CHECKBOX (checkbuttonV, param.doChromaV);
-  
-  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
-  param.offset= (int32_t)GTK_ADJUSTMENT(adj)-&gt;value;
-  
-  adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
-  param.coef=GTK_ADJUSTMENT(adj)-&gt;value;
-   return 1;
-}
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *vbox3;
-  GtkWidget *label1;
-  GtkWidget *hscaleContrast;
-  GtkWidget *label2;
-  GtkWidget *hscaleBright;
-  GtkWidget *vbox2;
-  GtkWidget *checkLuma;
-  GtkWidget *checkbuttonU;
-  GtkWidget *checkbuttonV;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Contrast&quot;));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
-
-  vbox3 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox3);
-  gtk_box_pack_start (GTK_BOX (hbox1), vbox3, TRUE, TRUE, 0);
-
-  label1 = gtk_label_new (QT_TR_NOOP(&quot;Contrast&quot;));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (vbox3), label1, FALSE, FALSE, 0);
-
-  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0)));
-  gtk_widget_show (hscaleContrast);
-  gtk_box_pack_start (GTK_BOX (vbox3), hscaleContrast, FALSE, TRUE, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_LEFT);
-
-  label2 = gtk_label_new (QT_TR_NOOP(&quot;Brightness&quot;));
-  gtk_widget_show (label2);
-  gtk_box_pack_start (GTK_BOX (vbox3), label2, FALSE, FALSE, 0);
-
-  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -127, 127, 1, 1, 0)));
-  gtk_widget_show (hscaleBright);
-  gtk_box_pack_start (GTK_BOX (vbox3), hscaleBright, FALSE, TRUE, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleBright), GTK_POS_LEFT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleBright), 0);
-
-  vbox2 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox2);
-  gtk_box_pack_start (GTK_BOX (hbox1), vbox2, TRUE, TRUE, 0);
-
-  checkLuma = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Luma&quot;));
-  gtk_widget_show (checkLuma);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkLuma, FALSE, FALSE, 0);
-
-  checkbuttonU = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Chroma U&quot;));
-  gtk_widget_show (checkbuttonU);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonU, FALSE, FALSE, 0);
-
-  checkbuttonV = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Chroma v&quot;));
-  gtk_widget_show (checkbuttonV);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonV, FALSE, FALSE, 0);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, -1, 300);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox3, &quot;vbox3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, &quot;hscaleContrast&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleBright, &quot;hscaleBright&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox2, &quot;vbox2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, checkLuma, &quot;checkLuma&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonU, &quot;checkbuttonU&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonV, &quot;checkbuttonV&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,423 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;ADM_toolkitGtk.h&quot;
-
-
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-
-
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyCrop.h&quot;
-#if 0
-static GtkWidget	*create_dialog1 (void);
-
-/* Link between UI and core */
-static gboolean 	ui_draw( void );
-static void 		ui_autocrop (void );
-static void 		ui_reset( void );
-static void 		ui_upload(void);
-static void  		ui_read ( void);
-static void  		ui_update ( void);
-static void 		ui_frame_changed( void );
-
-static GtkWidget *dialog=NULL;
-
-/* Prevent loop when updating value */
-
-static int lock=0;
-static flyCrop *myCrop=NULL;
-//
-//	Video is in YV12 Colorspace
-//
-//
-int DIA_getCropParams(char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
-{
-	uint32_t width, height;
-
-	// Allocate space for green-ised video
-	width = in-&gt;getInfo()-&gt;width;
-	height = in-&gt;getInfo()-&gt;height;
-
-	uint8_t ret=0;
-
-	dialog=create_dialog1();
-	gtk_register_dialog(dialog);
-	gtk_window_set_title(GTK_WINDOW(dialog), name);
-	gtk_widget_show(dialog);
-	
-#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y, GTK_SIGNAL_FUNC(z), NULL);
-
-	CONNECT(drawingarea1,expose_event,ui_draw);
-	CONNECT(buttonAutocrop,clicked,ui_autocrop);
-	CONNECT(buttonReset,clicked,ui_reset);
-	CONNECT(scale,value_changed,ui_frame_changed);
-	                  
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk), GTK_RESPONSE_OK);
-	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply), GTK_RESPONSE_APPLY);
-
-#define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_update)
-          
-	CONNECT_SPIN(Top);
-	CONNECT_SPIN(Left);
-	CONNECT_SPIN(Right);
-	CONNECT_SPIN(Bottom);
-
-	myCrop=new flyCrop(width, height,in,WID(drawingarea1),WID(scale));
-	myCrop-&gt;left=param-&gt;left;
-	myCrop-&gt;right=param-&gt;right;
-	myCrop-&gt;top=param-&gt;top;
-	myCrop-&gt;bottom=param-&gt;bottom;
-	myCrop-&gt;upload();	
-	myCrop-&gt;sliderChanged();	
-
-	int response;
-
-	while((response = gtk_dialog_run(GTK_DIALOG(dialog))) == GTK_RESPONSE_APPLY)
-	{
-	  ui_update();
-	}
-
-	if(response==GTK_RESPONSE_OK)
-	{
-		ui_read( );
-		param-&gt;left=myCrop-&gt;left;
-		param-&gt;right=myCrop-&gt;right;
-		param-&gt;top=myCrop-&gt;top;
-		param-&gt;bottom=myCrop-&gt;bottom;
-		ret=1;
-	}
-
-	gtk_unregister_dialog(dialog);
-	gtk_widget_destroy(dialog);
-	delete myCrop;
-	return ret;
-}
-
-/*
-      Link GTK dialog and core
-*/
-void ui_frame_changed( void )
-{
-  myCrop-&gt;sliderChanged();
-}
-void ui_update(void)
-{
-  if(lock) return;
-  myCrop-&gt;download();
-  myCrop-&gt;process();
-  myCrop-&gt;display();
-}
-/*---------------------------------------------------------------------------
-	Actually draw the working frame on screen
-*/
-gboolean ui_draw( void )
-{
-        myCrop-&gt;display();
-}
-void ui_read (void )
-{
-        myCrop-&gt;download();
-}
-void ui_upload(void)
-{
-    myCrop-&gt;upload();
-}
-void ui_autocrop( void )
-{
-  myCrop-&gt;autocrop();
- 
-}
-void ui_reset( void )
-{
-        myCrop-&gt;left=0;
-        myCrop-&gt;right=0;
-        myCrop-&gt;bottom=0;
-        myCrop-&gt;top=0;
-        
-	myCrop-&gt;upload();
-        myCrop-&gt;process();
-        myCrop-&gt;display();
-}
-
-/*---------------------------------------------------------------------------
-	Read entried from dialog box
-*/
-
-#define SPIN_GET(x,y) {x= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(spinbutton##y))) ;}
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton##y)),(gfloat)x) ;}
-
-
-//____________________________________
-uint8_t flyCrop::upload(void)
-{
-        lock++;
-        SPIN_SET(left,Left);
-        SPIN_SET(right,Right);
-        SPIN_SET(top,Top);
-        SPIN_SET(bottom,Bottom);
-        lock--;
-        return 1;
-}
-uint8_t flyCrop::download(void)
-{
-        int reject=0;
-        
-                        SPIN_GET(left,Left);
-                        SPIN_GET(right,Right);
-                        SPIN_GET(top,Top);
-                        SPIN_GET(bottom,Bottom);
-                        
-                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
-                        
-                        left&amp;=0xffffe;
-                        right&amp;=0xffffe;
-                        top&amp;=0xffffe;
-                        bottom&amp;=0xffffe;
-                        
-                        if((top+bottom)&gt;_h)
-                                {
-                                        top=bottom=0;
-                                        reject=1;
-                                }
-                        if((left+right)&gt;_w)
-                                {
-                                        left=right=0;
-                                        reject=1;
-                                }
-                        if(reject)
-                                upload();
-}
-// End common part
-//--------------------------------------------
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbuttonbox1;
-  GtkWidget *buttonCancel;
-  GtkWidget *buttonApply;
-  GtkWidget *buttonOk;
-  GtkWidget *hbuttonbox2;
-  GtkWidget *buttonAutocrop;
-  GtkWidget *buttonReset;
-  GtkWidget *alignment1;
-  GtkWidget *hbox1;
-  GtkWidget *image1;
-  GtkWidget *label1;
-  GtkWidget *table1;
-  GtkWidget *label2;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkWidget *label5;
-  GtkObject *spinbuttonLeft_adj;
-  GtkWidget *spinbuttonLeft;
-  GtkObject *spinbuttonTop_adj;
-  GtkWidget *spinbuttonTop;
-  GtkObject *spinbuttonBottom_adj;
-  GtkWidget *spinbuttonBottom;
-  GtkObject *spinbuttonRight_adj;
-  GtkWidget *spinbuttonRight;
-  GtkWidget *scale;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Crop Settings&quot;));
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbuttonbox1 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox1, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox1), GTK_BUTTONBOX_END);
-
-  buttonCancel = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (buttonCancel);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonCancel);
-  GTK_WIDGET_SET_FLAGS (buttonCancel, GTK_CAN_DEFAULT);
-
-  buttonApply = gtk_button_new_from_stock (&quot;gtk-apply&quot;);
-  gtk_widget_show (buttonApply);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonApply);
-  GTK_WIDGET_SET_FLAGS (buttonApply, GTK_CAN_DEFAULT);
-
-  buttonOk = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (buttonOk);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonOk);
-  GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
-
-  hbuttonbox2 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox2, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox2), GTK_BUTTONBOX_START);
-
-  buttonAutocrop = gtk_button_new_with_mnemonic (QT_TR_NOOP(&quot;AutoCrop&quot;));
-  gtk_widget_show (buttonAutocrop);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonAutocrop);
-  GTK_WIDGET_SET_FLAGS (buttonAutocrop, GTK_CAN_DEFAULT);
-
-  buttonReset = gtk_button_new ();
-  gtk_widget_show (buttonReset);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonReset);
-  GTK_WIDGET_SET_FLAGS (buttonReset, GTK_CAN_DEFAULT);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 0, 0);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (buttonReset), alignment1);
-
-  hbox1 = gtk_hbox_new (FALSE, 2);
-  gtk_widget_show (hbox1);
-  gtk_container_add (GTK_CONTAINER (alignment1), hbox1);
-
-  image1 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_BUTTON);
-  gtk_widget_show (image1);
-  gtk_box_pack_start (GTK_BOX (hbox1), image1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;Reset&quot;));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-
-  table1 = gtk_table_new (2, 4, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, TRUE, 0);
-
-  label2 = gtk_label_new (QT_TR_NOOP(&quot;Crop Left :&quot;));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  label3 = gtk_label_new (QT_TR_NOOP(&quot;Crop Top:&quot;));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (QT_TR_NOOP(&quot;Crop Right:&quot;));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 2, 3, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  label5 = gtk_label_new (QT_TR_NOOP(&quot;Crop Bottom:&quot;));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table1), label5, 2, 3, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
-
-  spinbuttonLeft_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonLeft = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonLeft_adj), 1, 0);
-  gtk_widget_show (spinbuttonLeft);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonLeft, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonLeft), TRUE);
-
-  spinbuttonTop_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonTop = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTop_adj), 1, 0);
-  gtk_widget_show (spinbuttonTop);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTop, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTop), TRUE);
-
-  spinbuttonBottom_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonBottom = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBottom_adj), 1, 0);
-  gtk_widget_show (spinbuttonBottom);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonBottom, 3, 4, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBottom), TRUE);
-
-  spinbuttonRight_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonRight = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRight_adj), 1, 0);
-  gtk_widget_show (spinbuttonRight);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonRight, 3, 4, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRight), TRUE);
-
-  scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 110, 1, 10, 10)));
-  gtk_widget_show (scale);
-  gtk_box_pack_start (GTK_BOX (vbox1), scale, FALSE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, FALSE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, 100, 100);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox1, &quot;hbuttonbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonCancel, &quot;buttonCancel&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonApply, &quot;buttonApply&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonOk, &quot;buttonOk&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox2, &quot;hbuttonbox2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonAutocrop, &quot;buttonAutocrop&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, &quot;buttonReset&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, alignment1, &quot;alignment1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, image1, &quot;image1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label5, &quot;label5&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonLeft, &quot;spinbuttonLeft&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTop, &quot;spinbuttonTop&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBottom, &quot;spinbuttonBottom&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRight, &quot;spinbuttonRight&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, scale, &quot;scale&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-
-  return dialog1;
-}
-
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,442 +0,0 @@
-/***************************************************************************
-                           Fly-Ui for hue &amp; sat
-
-    copyright            : (C) 2004/5/7 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-    
-    
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_toolkitGtk.h&quot;
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-
-#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyEq2.h&quot;
-
-
-static GtkWidget*create_dialog1 (void);
-static float getAdj(GtkWidget *widget);
-static void setAdj(GtkWidget *widget,float val);
-
-static GtkWidget *dialog=NULL;
-
-static void             update ( void);
-static gboolean         draw (void );
-static void             eq2_changed( void);
-static void 			frame_changed( void );
-
-static int lock=0;
-static flyEq2 *myCrop=NULL;
-
-/**
- * 		\fn DIA_getEQ2Param
- * 		\brief flyDialogGtk handling the mplayer EQ2 user Interface dialog.
- */
-uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
-{
-uint8_t r=0;
-uint32_t w,h;
-        // Allocate space for green-ised video
-        w=in-&gt;getInfo()-&gt;width;
-        h=in-&gt;getInfo()-&gt;height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_widget_show(dialog);	
-        
-        myCrop=new flyEq2( w, h,in,WID(drawingarea1),WID(hscale1));
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Eq2_Param));
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        myCrop-&gt;update();
-        
-        int ret=0;
-        int response;
-        //-----------------------
-        
-#define HCONECT(x)  gtk_signal_connect(GTK_OBJECT(WID(hscale##x)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(eq2_changed),   NULL);
-
-        HCONECT(Brightness);
-        HCONECT(Saturation);
-        HCONECT(Contrast);
-
-        HCONECT(Gamma);        
-        HCONECT(GammaWeight);
-        HCONECT(GammaR);
-        HCONECT(GammaG);
-        HCONECT(GammaB);
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;, GTK_SIGNAL_FUNC(draw),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
-        //-----------------------
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop-&gt;download();
-            memcpy(param,&amp;(myCrop-&gt;param),sizeof(Eq2_Param));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        myCrop=NULL;
-        return ret;
-
-}
-/**************************************/
-#undef SET
-#undef GET
-#define SET(x,y)        gtk_range_set_value (GTK_RANGE(WID(hscale##x)),(gdouble)param.y)
-#define GET(x,y)        param.y= (float)gtk_range_get_value (GTK_RANGE(WID(hscale##x)))
-
-
-uint8_t flyEq2::upload(void)
-{
-  lock++;
-  SET(Contrast,contrast);
-  SET(Brightness,brightness);
-  SET(Saturation,saturation);
-
-  SET(Gamma,gamma);        
-  SET(GammaWeight,gamma_weight);
-  SET(GammaR,rgamma);
-  SET(GammaG,ggamma);
-  SET(GammaB,bgamma);
-  
-  lock--;
-  return 1;
-}
-uint8_t flyEq2::download (void)
-{
-
-  GET(Contrast,contrast);
-  GET(Brightness,brightness);
-  GET(Saturation,saturation);
-
-  GET(Gamma,gamma);        
-  GET(GammaWeight,gamma_weight);
-  GET(GammaR,rgamma);
-  GET(GammaG,ggamma);
-  GET(GammaB,bgamma);
-
- return 1;
-}
-
-/**********************/
-void frame_changed( void )
-{
-          myCrop-&gt;sliderChanged();
-}
-void eq2_changed( void)
-{
-    if(lock) return;
-    myCrop-&gt;update();
-}
-gboolean draw (void)
-{
-    myCrop-&gt;display();
-	return true;
-}
-//**
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *frame1;
-  GtkWidget *table2;
-  GtkWidget *label4;
-  GtkWidget *label5;
-  GtkWidget *hscaleBrightness;
-  GtkWidget *hscaleSaturation;
-  GtkWidget *hscaleContrast;
-  GtkWidget *label3;
-  GtkWidget *label1;
-  GtkWidget *frame2;
-  GtkWidget *table3;
-  GtkWidget *label6;
-  GtkWidget *hscaleGamma;
-  GtkWidget *hscaleGammaR;
-  GtkWidget *label8;
-  GtkWidget *hscaleGammaG;
-  GtkWidget *label9;
-  GtkWidget *label10;
-  GtkWidget *label7;
-  GtkWidget *hscaleGammaB;
-  GtkWidget *hscaleGammaWeight;
-  GtkWidget *label2;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_container_set_border_width (GTK_CONTAINER (dialog1), 6);
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;MPlayer eq2&quot;));
-  gtk_window_set_resizable (GTK_WINDOW (dialog1), FALSE);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
-
-  frame1 = gtk_frame_new (NULL);
-  gtk_widget_show (frame1);
-  gtk_box_pack_start (GTK_BOX (hbox1), frame1, TRUE, TRUE, 0);
-  gtk_frame_set_shadow_type (GTK_FRAME (frame1), GTK_SHADOW_NONE);
-
-  table2 = gtk_table_new (3, 2, FALSE);
-  gtk_widget_show (table2);
-  gtk_container_add (GTK_CONTAINER (frame1), table2);
-  gtk_container_set_border_width (GTK_CONTAINER (table2), 12);
-  gtk_table_set_row_spacings (GTK_TABLE (table2), 6);
-  gtk_table_set_col_spacings (GTK_TABLE (table2), 12);
-
-  label4 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;Brigh_tness:&quot;));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table2), label4, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  label5 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Saturation:&quot;));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table2), label5, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
-
-  hscaleBrightness = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -1, 1, 0.05, 1, 0)));
-  gtk_widget_show (hscaleBrightness);
-  gtk_table_attach (GTK_TABLE (table2), hscaleBrightness, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleBrightness, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleBrightness), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleBrightness), 2);
-
-  hscaleSaturation = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0, 3, 0.05, 1, 0)));
-  gtk_widget_show (hscaleSaturation);
-  gtk_table_attach (GTK_TABLE (table2), hscaleSaturation, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleSaturation, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleSaturation), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleSaturation), 2);
-
-  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, -2, 2, 0.05, 1, 0)));
-  gtk_widget_show (hscaleContrast);
-  gtk_table_attach (GTK_TABLE (table2), hscaleContrast, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleContrast, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleContrast), 2);
-
-  label3 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Contrast:&quot;));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table2), label3, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label1 = gtk_label_new (&quot;&quot;);
-  gtk_widget_show (label1);
-  gtk_frame_set_label_widget (GTK_FRAME (frame1), label1);
-  gtk_label_set_use_markup (GTK_LABEL (label1), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-
-  frame2 = gtk_frame_new (NULL);
-  gtk_widget_show (frame2);
-  gtk_box_pack_start (GTK_BOX (hbox1), frame2, TRUE, TRUE, 0);
-  gtk_frame_set_shadow_type (GTK_FRAME (frame2), GTK_SHADOW_NONE);
-
-  table3 = gtk_table_new (5, 2, FALSE);
-  gtk_widget_show (table3);
-  gtk_container_add (GTK_CONTAINER (frame2), table3);
-  gtk_container_set_border_width (GTK_CONTAINER (table3), 12);
-  gtk_table_set_row_spacings (GTK_TABLE (table3), 6);
-  gtk_table_set_col_spacings (GTK_TABLE (table3), 12);
-
-  label6 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Initial:&quot;));
-  gtk_widget_show (label6);
-  gtk_table_attach (GTK_TABLE (table3), label6, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label6), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label6), 0, 0.5);
-
-  hscaleGamma = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
-  gtk_widget_show (hscaleGamma);
-  gtk_table_attach (GTK_TABLE (table3), hscaleGamma, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleGamma, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleGamma), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleGamma), 2);
-
-  hscaleGammaR = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
-  gtk_widget_show (hscaleGammaR);
-  gtk_table_attach (GTK_TABLE (table3), hscaleGammaR, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleGammaR, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaR), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleGammaR), 2);
-
-  label8 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Red:&quot;));
-  gtk_widget_show (label8);
-  gtk_table_attach (GTK_TABLE (table3), label8, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label8), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
-
-  hscaleGammaG = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
-  gtk_widget_show (hscaleGammaG);
-  gtk_table_attach (GTK_TABLE (table3), hscaleGammaG, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleGammaG, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaG), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleGammaG), 2);
-
-  label9 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Green:&quot;));
-  gtk_widget_show (label9);
-  gtk_table_attach (GTK_TABLE (table3), label9, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label9), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
-
-  label10 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Blue:&quot;));
-  gtk_widget_show (label10);
-  gtk_table_attach (GTK_TABLE (table3), label10, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label10), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label10), 0, 0.5);
-
-  label7 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Weight:&quot;));
-  gtk_widget_show (label7);
-  gtk_table_attach (GTK_TABLE (table3), label7, 0, 1, 4, 5,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label7), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label7), 0, 0.5);
-
-  hscaleGammaB = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
-  gtk_widget_show (hscaleGammaB);
-  gtk_table_attach (GTK_TABLE (table3), hscaleGammaB, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleGammaB, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaB), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleGammaB), 2);
-
-  hscaleGammaWeight = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0, 1, 0.05, 1, 0)));
-  gtk_widget_show (hscaleGammaWeight);
-  gtk_table_attach (GTK_TABLE (table3), hscaleGammaWeight, 1, 2, 4, 5,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-  gtk_widget_set_size_request (hscaleGammaWeight, 144, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaWeight), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleGammaWeight), 2);
-
-  label2 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Gamma&lt;/b&gt;&quot;));
-  gtk_widget_show (label2);
-  gtk_frame_set_label_widget (GTK_FRAME (frame2), label2);
-  gtk_label_set_use_markup (GTK_LABEL (label2), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 0)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label4), hscaleBrightness);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label5), hscaleSaturation);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label3), hscaleContrast);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label6), hscaleGamma);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label8), hscaleGammaR);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label9), hscaleGammaG);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label10), hscaleGammaB);
-  gtk_label_set_mnemonic_widget (GTK_LABEL (label7), hscaleGammaWeight);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, frame1, &quot;frame1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table2, &quot;table2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label5, &quot;label5&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleBrightness, &quot;hscaleBrightness&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleSaturation, &quot;hscaleSaturation&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, &quot;hscaleContrast&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, frame2, &quot;frame2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table3, &quot;table3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label6, &quot;label6&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleGamma, &quot;hscaleGamma&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaR, &quot;hscaleGammaR&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label8, &quot;label8&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaG, &quot;hscaleGammaG&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label9, &quot;label9&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label10, &quot;label10&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label7, &quot;label7&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaB, &quot;hscaleGammaB&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaWeight, &quot;hscaleGammaWeight&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,235 +0,0 @@
-/**/
-/***************************************************************************
-                          DIA_hue
-                             -------------------
-
-			   Ui for hue &amp; sat
-
-    begin                : 08 Apr 2005
-    copyright            : (C) 2004/7 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_toolkitGtk.h&quot;
-
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyHue.h&quot;
-
-
-static GtkWidget	*create_dialog1 (void);
-static void  		update ( void);
-static gboolean 	draw (void );
-static void 		upload(void);
-static void 		download(void);
-static void 		frame_changed( void );
-static void             hue_changed( void);
-
-static int lock=0;
-static GtkWidget *dialog=NULL;
-static flyHue *myCrop=NULL;
-
-/**
-      \fn DIA_getHue
-      \brief Handle Hue (fly)Dialog
-*/
-uint8_t DIA_getHue(Hue_Param *param, AVDMGenericVideoStream *in)
-{
-      uint32_t width,height;
-      uint8_t ret=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        
-        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Hue&quot;));
-
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
-            GTK_SIGNAL_FUNC(draw),
-            NULL);
-//
-        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(hscaleHue)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(hscaleSaturation)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
-        gtk_widget_show(dialog);
-          
-        myCrop=new flyHue( width, height,in,WID(drawingarea1),WID(hscale1));
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Hue_Param));
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop-&gt;download();
-            memcpy(param,&amp;(myCrop-&gt;param),sizeof(Hue_Param));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-void hue_changed( void)
-{
-  if(lock) return;
-  
-   myCrop-&gt;update();
-  
-}
-void frame_changed( void )
-{
-  myCrop-&gt;sliderChanged();
-}
-gboolean draw (void)
-{
-    myCrop-&gt;display();
-}
-//
-void upload( void)
-{
-    myCrop-&gt;upload();
-}
-void download (void)
-{
-     myCrop-&gt;download();
-}
-/**************************************/
-uint8_t flyHue::upload(void)
-{
-    lock++;
-      gtk_range_set_value (GTK_RANGE(WID(hscaleHue)),(gdouble)param.hue);
-      gtk_range_set_value (GTK_RANGE(WID(hscaleSaturation)),(gdouble)param.saturation);
-    lock--;
-        return 1;
-}
-uint8_t flyHue::download (void)
-{
-    
-       GtkAdjustment *adj;	
-
-        adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleHue)));
-        param.hue=(float)GTK_ADJUSTMENT(adj)-&gt;value;
-        
-        adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleSaturation)));
-        param.saturation=(float)GTK_ADJUSTMENT(adj)-&gt;value;
-        return 1;
-}
-
-
-
-
-//******************
-GtkWidget   *create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *table1;
-  GtkWidget *label1;
-  GtkWidget *label2;
-  GtkWidget *hscaleHue;
-  GtkWidget *hscaleSaturation;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Hue/Saturation&quot;));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  table1 = gtk_table_new (2, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, TRUE, TRUE, 0);
-
-  label1 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Hue:&lt;/b&gt;&quot;));
-  gtk_widget_show (label1);
-  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_use_markup (GTK_LABEL (label1), TRUE);
-  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
-
-  label2 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Saturation:&lt;/b&gt;&quot;));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_use_markup (GTK_LABEL (label2), TRUE);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  hscaleHue = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -90, 90, 1, 1, 1)));
-  gtk_widget_show (hscaleHue);
-  gtk_table_attach (GTK_TABLE (table1), hscaleHue, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  hscaleSaturation = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -10, 10, 1, 1, 1)));
-  gtk_widget_show (hscaleSaturation);
-  gtk_table_attach (GTK_TABLE (table1), hscaleSaturation, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleHue, &quot;hscaleHue&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleSaturation, &quot;hscaleSaturation&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,275 +0,0 @@
-/***************************************************************************
-                          ADM_guiSRT.cpp  -  description
-                             -------------------
-    begin                : Wed Dec 18 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;config.h&quot;
-
-#ifdef USE_FREETYPE
-#include &quot;ADM_toolkitGtk.h&quot;
-
-
-#include &quot;DIA_fileSel.h&quot;
-
-#include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
-
-//#include &quot;ADM_video/ADM_vidFont.h&quot;
-class ADMfont;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-
-
-#include &quot;ADM_colorspace.h&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_FILTER
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flySrtPos.h&quot;
-
-
-static void read( void );
-static void upload ( void );
-static gboolean slider_update( void );
-static gboolean gui_update( void);
-static gboolean gui_draw( void );
-static GtkWidget *create_dialog1 (void);
-
-static GtkWidget *dialog=NULL;
-static flySrtPos *myCrop=NULL;
-static int lock=0;
-
-/**
-      \fn DIA_srtPos
-      \brief Dialog that handles subtitle size and position
-*/
-int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
-{
-  uint8_t ret=0;
-  
-        uint32_t width,height;
-
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Subtitle Size and Position&quot;));
-        gtk_widget_show(dialog);
-	
-        myCrop=new flySrtPos( width, height,in,WID(drawingarea1),WID(hscale1));
-        myCrop-&gt;param.fontSize=*size;
-        myCrop-&gt;param.position=*position;
-
-        gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
-
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
-            GTK_SIGNAL_FUNC(gui_draw),
-            NULL);
-        
-        gtk_signal_connect (GTK_OBJECT(WID( spinbutton1)), &quot;value_changed&quot;,
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-        
-         gtk_signal_connect (GTK_OBJECT(WID( hscale1)), &quot;value_changed&quot;,
-                    GTK_SIGNAL_FUNC (slider_update),
-                    NULL);
-
-          gtk_signal_connect (GTK_OBJECT(WID( vscale1)), &quot;value_changed&quot;,
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-       
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop-&gt;download();
-            *size=myCrop-&gt;param.fontSize;
-            *position=myCrop-&gt;param.position;
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-/**********************************/
-void read( void )
-{
-	myCrop-&gt;download();
-}
-gboolean slider_update( void )
-{
-        myCrop-&gt;sliderChanged();
-        return true;
-}
-gboolean gui_update( void)
-{
-  if(lock) return true;
-      myCrop-&gt;update();
-  return true;
-}
-gboolean gui_draw( void )
-{
-	myCrop-&gt;display();
-	return true;
-}
-
-/******************************/
-#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
-				printf(#x&quot;:%d\n&quot;, y);}
-
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x&quot;:%d\n&quot;, y);}
-
-
-uint8_t    flySrtPos::upload(void)
-{
-        SPIN_SET(spinbutton1,param.fontSize);
-        
-        int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max&lt;0) max=0;
-        if(param.position&gt;=max)
-        {
-          param.position=max;
-        }
-        
-        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
-        GTK_ADJUSTMENT(adj)-&gt;value=param.position;
-        return 1;
-}
-uint8_t    flySrtPos::download(void)
-{
-        SPIN_GET(spinbutton1,param.fontSize);
-        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
-        param.position=(uint32_t)GTK_ADJUSTMENT(adj)-&gt;value;
-        
-        int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max&lt;0) max=0;
-        if(param.position&gt;=max)
-        {
-          param.position=max;
-          upload(); 
-        }
-        
-        return 1;
-}
-
-/*
-	Almost straigh out of glade2
-
-*/
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *label1;
-  GtkObject *spinbutton1_adj;
-  GtkWidget *spinbutton1;
-  GtkWidget *hscale1;
-  GtkWidget *hbox2;
-  GtkWidget *drawingarea1;
-  GtkWidget *vscale1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Subtitle Size and Position&quot;));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new (QT_TR_NOOP(&quot;Font Size:&quot;));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
-
-  spinbutton1_adj = gtk_adjustment_new (1, 6, 99, 1, 10, 10);
-  spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 2);
-  gtk_widget_show (spinbutton1);
-  gtk_box_pack_start (GTK_BOX (hbox1), spinbutton1, FALSE, FALSE, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton1), TRUE);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
-
-  hbox2 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox2, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (hbox2), drawingarea1, TRUE, TRUE, 0);
-
-  vscale1 = gtk_vscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 100, 1, 1, 1, 1)));
-  gtk_widget_show (vscale1);
-  gtk_box_pack_start (GTK_BOX (hbox2), vscale1, FALSE, FALSE, 0);
-  gtk_scale_set_digits (GTK_SCALE (vscale1), 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbutton1, &quot;spinbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox2, &quot;hbox2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vscale1, &quot;vscale1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-
-//-------------------------------
-#endif //FREETYPE

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -32,11 +32,13 @@
 
 
 #include &quot;ADM_videoFilter/ADM_vidAnimated_param.h&quot;
+#if 0
 #include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidChromaShift_param.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
+#endif
 #include &quot;ADM_videoFilter/ADM_vobsubinfo.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidVobSub.h&quot;
 
@@ -66,10 +68,7 @@
 
 uint8_t DIA_animated(ANIMATED_PARAM *param) {return 0;}
 
-uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in) {return 0;}
-uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in) {return 0;}
 
-uint8_t DIA_getHue(Hue_Param *param, AVDMGenericVideoStream *in) {return 0;}
 
 uint8_t DIA_getPartial(PARTIAL_CONFIG *param,AVDMGenericVideoStream *son,AVDMGenericVideoStream *previous) {return 0;}
 uint8_t DIA_pipe(char **cmd,char **param) {return 0;}
@@ -94,12 +93,9 @@
                           uint32_t *twoway, uint32_t *map) {return 0;}
 uint8_t DIA_4entries(char *title,uint32_t *left,uint32_t *right,uint32_t *top,uint32_t *bottom) {return 0;}
 uint8_t DIA_videoCodec(int *codecIndex) {return 0;}
-uint8_t DIA_getChromaShift( AVDMGenericVideoStream *instream,CHROMASHIFT_PARAM *param ) {return 0;}
-uint8_t DIA_contrast(AVDMGenericVideoStream *astream,CONTRAST_PARAM *param) {return 0;}
 uint8_t DIA_audioCodec( AUDIOENCODER *codec ) {return 0;}
 uint8_t DIA_dnr(uint32_t *llock,uint32_t *lthresh, uint32_t *clock,
 			uint32_t *cthresh, uint32_t *scene) {return 0;}
-int DIA_srtPos(AVDMGenericVideoStream *source,uint32_t *size,uint32_t *position) {return 0;}
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}			
 uint8_t DIA_glyphEdit(void) {return 0;}
 struct THRESHOLD_PARAM;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,29 +1,31 @@
 SET(ADM_LIB ADM_dialogQt4)
 
 SET(uiFiles
-	about.ui  asharp.ui    contrast.ui  eq2.ui  crop.ui  encoding.ui  hue.ui  license.ui
+	about.ui    encoding.ui    license.ui
 	jobs.ui  props.ui    vobsub.ui  working.ui)
 
 SET(headers
-	Q_about.h  Q_asharp.h   Q_contrast.h  Q_crop.h  Q_encoding.h  Q_eq2.h  Q_hue.h
+	Q_about.h    Q_encoding.h  
 	Q_license.h  Q_jobs.h  Q_props.h    Q_vobsub.h  Q_working.h  T_index_pg.h)
-
+if(false)
 IF (USE_FREETYPE)
 	SET(uiFiles ${uiFiles} srt.ui)
 	SET(headers ${headers} Q_srt.h)
 	SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} Q_srt.cpp)
 ENDIF (USE_FREETYPE)
+endif(false)
 
 QT4_WRAP_UI(${ADM_LIB}_headers ${uiFiles})
 QT4_WRAP_CPP(${ADM_LIB}_source ${headers})
 QT4_ADD_RESOURCES(${ADM_LIB}_resource  about.qrc)
 
 SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS}
-	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  Q_about.cpp  Q_asharp.cpp
-	Q_contrast.cpp  Q_crop.cpp  Q_encoding.cpp  Q_eq2.cpp  Q_hue.cpp  Q_license.cpp
+	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  Q_about.cpp  
+        Q_license.cpp Q_encoding.cpp
 	Q_jobs.cpp  Q_props.cpp   Q_vobsub.cpp  Q_working.cpp   T_index_pg.cpp
 	alert_qt4.cpp  DIA_busy.cpp  DIA_none.cpp  DIA_xvid4.cpp  OCR_none.cpp)
 
 ADD_DEFINITIONS(-DADM_SUBVERSION=${ADM_SUBVERSION})
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
+INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_UIs/ADM_QT4/include&quot;)
 ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,125 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;Q_asharp.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_asharpWindow::Ui_asharpWindow(ASHARP_PARAM *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flyASharp( width, height,in,canvas,ui.horizontalSlider);
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(ASHARP_PARAM));
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-
-
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-#define SPINNER(x) connect( ui.doubleSpinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
-          SPINNER(Treshold);
-          SPINNER(Strength);
-          SPINNER(Block);
-          connect( ui.checkBox,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int))); 
-
-  }
-  void Ui_asharpWindow::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_asharpWindow::gather(ASHARP_PARAM *param)
-  {
-    
-        myCrop-&gt;download();
-        memcpy(param,&amp;(myCrop-&gt;param),sizeof(ASHARP_PARAM));
-  }
-Ui_asharpWindow::~Ui_asharpWindow()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_asharpWindow::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;update();
-  lock--;
-}
-
-#define MYSPIN(x) w-&gt;doubleSpinBox##x
-//************************
-uint8_t flyASharp::upload(void)
-{
-      Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
-
-        MYSPIN(Treshold)-&gt;setValue(param.t);
-        MYSPIN(Strength)-&gt;setValue(param.d);
-        MYSPIN(Block)-&gt;setValue(param.b);
-        
-        //w-&gt;bf-&gt;w-&gt;checkBox-&gt;isChecked();
-        w-&gt;checkBox-&gt;setChecked(param.bf);
-
-        return 1;
-}
-uint8_t flyASharp::download(void)
-{
-       Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
-       param.t= MYSPIN(Treshold)-&gt;value();
-       param.d= MYSPIN(Strength)-&gt;value();
-       param.b= MYSPIN(Block)-&gt;value();
-       
-       //w-&gt;spinBoxBottom-&gt;setValue(bottom);
-       param.bf=w-&gt;checkBox-&gt;isChecked();
-}
-
-/**
-      \fn     DIA_getCropParams
-      \brief  Handle crop dialog
-*/
-uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in)
-{
-        uint8_t ret=0;
-        
-        Ui_asharpWindow dialog(param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(param); 
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,33 +0,0 @@
-#ifndef Q_asharp_h
-#define Q_asharp_h
-
-#include &quot;ui_asharp.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyAsharp.h&quot;
-
-class Ui_asharpWindow : public QDialog
-{
-	Q_OBJECT
-
-protected: 
-	int lock;
-
-public:
-	flyASharp *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_asharpWindow(ASHARP_PARAM *param, AVDMGenericVideoStream *in);
-	~Ui_asharpWindow();
-	Ui_asharpDialog ui;
-
-public slots:
-	void gather(ASHARP_PARAM *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_asharp_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,33 +0,0 @@
-#ifndef Q_chromashift_h
-#define Q_chromashift_h
-
-#include &quot;ui_chromashift.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidChromaShift_param.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyChromaShift.h&quot;
-
-class Ui_chromaShiftWindow : public QDialog
-{
-	Q_OBJECT
-
-protected: 
-	int lock;
-
-public:
-	flyChromaShift *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_chromaShiftWindow(CHROMASHIFT_PARAM *param,AVDMGenericVideoStream *in);
-	~Ui_chromaShiftWindow();
-	Ui_chromashiftDialog ui;
-
-public slots:
-	void gather(CHROMASHIFT_PARAM *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_chromashift_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,130 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;Q_contrast.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_contrastWindow::Ui_contrastWindow(CONTRAST_PARAM *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flyContrast( width, height,in,canvas,ui.horizontalSlider);
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(CONTRAST_PARAM));
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-
-
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
-          SPINNER(Brightness);
-          SPINNER(Contrast);
-          connect( ui.checkBoxU,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int)));
-          connect( ui.checkBoxV,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int))); 
-          connect( ui.checkBoxY,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int)));  
-
-  }
-  void Ui_contrastWindow::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_contrastWindow::gather(CONTRAST_PARAM *param)
-  {
-    
-        myCrop-&gt;download();
-        memcpy(param,&amp;(myCrop-&gt;param),sizeof(CONTRAST_PARAM));
-  }
-Ui_contrastWindow::~Ui_contrastWindow()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_contrastWindow::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;update();
-  lock--;
-}
-
-#define MYSPIN(x) w-&gt;horizontalSlider##x
-#define MYCHECK(x) w-&gt;checkBox##x
-//************************
-uint8_t flyContrast::upload(void)
-{
-      Ui_contrastDialog *w=(Ui_contrastDialog *)_cookie;
-
-        MYSPIN(Contrast)-&gt;setValue((uint32_t)(param.coef*10));
-        MYSPIN(Brightness)-&gt;setValue(param.offset);
-#define CHECKSET(a,b) MYCHECK(a)-&gt;setChecked(param.b)
-        
-        CHECKSET(Y,doLuma);
-        CHECKSET(U,doChromaU);
-        CHECKSET(V,doChromaV);
-
-        return 1;
-}
-uint8_t flyContrast::download(void)
-{
-       Ui_contrastDialog *w=(Ui_contrastDialog *)_cookie;
-         param.coef=MYSPIN(Contrast)-&gt;value()/10.;
-         param.offset=MYSPIN(Brightness)-&gt;value();
-#define CHECKGET(a,b) param.b=MYCHECK(a)-&gt;isChecked()
-        
-        CHECKGET(Y,doLuma);
-        CHECKGET(U,doChromaU);
-        CHECKGET(V,doChromaV);
-return 1;
-}
-
-/**
-      \fn     DIA_getCropParams
-      \brief  Handle crop dialog
-*/
-uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
-{
-        uint8_t ret=0;
-        
-        Ui_contrastWindow dialog(param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(param); 
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,33 +0,0 @@
-#ifndef Q_contrast_h
-#define Q_contrast_h
-
-#include &quot;ui_contrast.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyContrast.h&quot;
-
-class Ui_contrastWindow : public QDialog
-{
-	Q_OBJECT
-
-protected : 
-	int lock;
-
-public:
-	flyContrast *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_contrastWindow(CONTRAST_PARAM *param,AVDMGenericVideoStream *in);
-	~Ui_contrastWindow();
-	Ui_contrastDialog ui;
-
-public slots:
-	void gather(CONTRAST_PARAM *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_contrast_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,171 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#if 0
-#include &quot;Q_crop.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_cropWindow::Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flyCrop( width, height,in,canvas,ui.horizontalSlider);
-        myCrop-&gt;left=param-&gt;left;
-        myCrop-&gt;right=param-&gt;right;
-        myCrop-&gt;top=param-&gt;top;
-        myCrop-&gt;bottom=param-&gt;bottom;
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-
-
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-        connect( ui.pushButtonAutoCrop,SIGNAL(clicked(bool)),this,SLOT(autoCrop(bool)));
-        connect( ui.pushButtonReset,SIGNAL(clicked(bool)),this,SLOT(reset(bool)));
-#define SPINNER(x) connect( ui.spinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
-          SPINNER(Left);
-          SPINNER(Right);
-          SPINNER(Top);
-          SPINNER(Bottom);
-
-  }
-  void Ui_cropWindow::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_cropWindow::gather(CROP_PARAMS *param)
-  {
-    
-        myCrop-&gt;download();
-        param-&gt;left=myCrop-&gt;left;
-        param-&gt;right=myCrop-&gt;right;
-        param-&gt;top=myCrop-&gt;top;
-        param-&gt;bottom=myCrop-&gt;bottom;
-  }
-Ui_cropWindow::~Ui_cropWindow()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_cropWindow::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;download();
-  myCrop-&gt;process();
-  myCrop-&gt;display();
-  lock--;
-}
-
-void Ui_cropWindow::autoCrop( bool f )
-{
-  lock++;
-  myCrop-&gt;autocrop();
-  lock--;
-}
-void Ui_cropWindow::reset( bool f )
-{
-         myCrop-&gt;left=0;
-         myCrop-&gt;right=0;
-         myCrop-&gt;bottom=0;
-         myCrop-&gt;top=0;
-         lock++;
-         myCrop-&gt;upload();
-         myCrop-&gt;process();
-         myCrop-&gt;display();
-         lock--;
-}
-
-//************************
-uint8_t flyCrop::upload(void)
-{
-      Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
-        
-        w-&gt;spinBoxLeft-&gt;setValue(left);
-        w-&gt;spinBoxRight-&gt;setValue(right);
-        w-&gt;spinBoxTop-&gt;setValue(top);
-        w-&gt;spinBoxBottom-&gt;setValue(bottom);
-        
-        return 1;
-}
-uint8_t flyCrop::download(void)
-{
-        int reject=0;
-Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
-#define SPIN_GET(x,y) x=w-&gt;spinBox##y-&gt;value();
-                        SPIN_GET(left,Left);
-                        SPIN_GET(right,Right);
-                        SPIN_GET(top,Top);
-                        SPIN_GET(bottom,Bottom);
-                        
-                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
-                        
-                        left&amp;=0xffffe;
-                        right&amp;=0xffffe;
-                        top&amp;=0xffffe;
-                        bottom&amp;=0xffffe;
-                        
-                        if((top+bottom)&gt;_h)
-                                {
-                                        top=bottom=0;
-                                        reject=1;
-                                }
-                        if((left+right)&gt;_w)
-                                {
-                                        left=right=0;
-                                        reject=1;
-                                }
-                        if(reject)
-                                upload();
-}
-
-/**
-      \fn     DIA_getCropParams
-      \brief  Handle crop dialog
-*/
-int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
-{
-        uint8_t ret=0;
-        
-        Ui_cropWindow dialog(param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(param); 
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,37 +0,0 @@
-#ifndef Q_crop_h
-#define Q_crop_h
-
-#include &quot;ui_crop.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyCrop.h&quot;
-#if 0
-class Ui_cropWindow : public QDialog
-{
-	Q_OBJECT
-
-protected: 
-	int lock;
-
-public:
-	flyCrop *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in);
-	~Ui_cropWindow();
-	Ui_cropDialog ui;
-
-public slots:
-	void gather(CROP_PARAMS *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-	void autoCrop(bool f);
-	void reset(bool f);
-};
-
-#endif	// Q_crop_h
-#endif
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,137 +0,0 @@
-/***************************************************************************
-                          Q_eq2.cpp  -  description
-
-                flyDialog for MPlayer EQ2 filter
-    copyright            : (C) 2002/2007 by mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;Q_eq2.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_eq2Window::Ui_eq2Window(Eq2_Param *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flyEq2( width, height,in,canvas,ui.horizontalSlider);
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Eq2_Param));
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        myCrop-&gt;update();
-
-
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
-        SPINNER(Red);
-        SPINNER(Blue);
-        SPINNER(Green);
-         
-        SPINNER(Contrast);
-        SPINNER(Brightness);
-        SPINNER(Saturation);
-
-        SPINNER(Initial);
-        SPINNER(Weight);
-  }
-  void Ui_eq2Window::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_eq2Window::gather(Eq2_Param *param)
-  {
-    
-        myCrop-&gt;download();
-        memcpy(param,&amp;(myCrop-&gt;param),sizeof(Eq2_Param));
-  }
-Ui_eq2Window::~Ui_eq2Window()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_eq2Window::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;update();
-  lock--;
-}
-
-#define sliderSet(x,y) w-&gt;horizontalSlider##x-&gt;setValue((int)(param.y*100));
-#define sliderGet(x,y) param.y=w-&gt;horizontalSlider##x-&gt;value()/100.;
-//************************
-uint8_t flyEq2::upload(void)
-{
-Ui_eq2Dialog *w=(Ui_eq2Dialog *)_cookie;
-
-
-        sliderSet(Contrast,contrast);
-        sliderSet(Brightness,brightness);
-        sliderSet(Saturation,saturation);
-
-        sliderSet(Red,rgamma);
-        sliderSet(Green,ggamma);
-        sliderSet(Blue,bgamma);
-
-        sliderSet(Initial,gamma);
-        sliderSet(Weight,gamma_weight);
-        
-       return 1;
-}
-uint8_t flyEq2::download(void)
-{
-	Ui_eq2Dialog *w=(Ui_eq2Dialog *)_cookie;
-
-        sliderGet(Contrast,contrast);
-        sliderGet(Brightness,brightness);
-        sliderGet(Saturation,saturation);
-
-        sliderGet(Red,rgamma);
-        sliderGet(Green,ggamma);
-        sliderGet(Blue,bgamma);
-
-        sliderGet(Initial,gamma);
-        sliderGet(Weight,gamma_weight);
-
-return 1;
-}
-/**
-      \fn     DIA_getEQ2Param
-      \brief  Handle MPlayer EQ2 flyDialog
-*/
-uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
-{
-        uint8_t ret=0;
-        
-        Ui_eq2Window dialog(param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(param); 
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,33 +0,0 @@
-#ifndef Q_eq2_h
-#define Q_eq2_h
-
-#include &quot;ui_eq2.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyEq2.h&quot;
-
-class Ui_eq2Window : public QDialog
-{
-	Q_OBJECT
-
-protected:
-	int lock;
-
-public:
-	flyEq2 *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_eq2Window(Eq2_Param *param,AVDMGenericVideoStream *in);
-	~Ui_eq2Window();
-	Ui_eq2Dialog ui;
-
-public slots:
-	void gather(Eq2_Param *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_eq2_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,116 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;Q_hue.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_hueWindow::Ui_hueWindow(Hue_Param *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flyHue( width, height,in,canvas,ui.horizontalSlider);
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Hue_Param));
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-
-
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
-          SPINNER(Hue);
-          SPINNER(Saturation);
-
-  }
-  void Ui_hueWindow::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_hueWindow::gather(Hue_Param *param)
-  {
-    
-        myCrop-&gt;download();
-        memcpy(param,&amp;(myCrop-&gt;param),sizeof(Hue_Param));
-  }
-Ui_hueWindow::~Ui_hueWindow()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_hueWindow::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;update();
-  lock--;
-}
-
-#define MYSPIN(x) w-&gt;horizontalSlider##x
-#define MYCHECK(x) w-&gt;checkBox##x
-//************************
-uint8_t flyHue::upload(void)
-{
-      Ui_hueDialog *w=(Ui_hueDialog *)_cookie;
-
-        MYSPIN(Saturation)-&gt;setValue((int)param.saturation);
-        MYSPIN(Hue)-&gt;setValue((int)param.hue);
-        return 1;
-}
-uint8_t flyHue::download(void)
-{
-       Ui_hueDialog *w=(Ui_hueDialog *)_cookie;
-         param.hue=MYSPIN(Hue)-&gt;value();
-         param.saturation=MYSPIN(Saturation)-&gt;value();
-return 1;
-}
-
-/**
-      \fn     DIA_getCropParams
-      \brief  Handle crop dialog
-*/
-uint8_t DIA_getHue(Hue_Param *param,AVDMGenericVideoStream *in)
-{
-        uint8_t ret=0;
-        
-        Ui_hueWindow dialog(param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(param); 
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,33 +0,0 @@
-#ifndef Q_hue_h
-#define Q_hue_h
-
-#include &quot;ui_hue.h&quot;
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flyHue.h&quot;
-
-class Ui_hueWindow : public QDialog
-{
-	Q_OBJECT
-
-protected:
-	int lock;
-
-public:
-	flyHue *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_hueWindow(Hue_Param *param,AVDMGenericVideoStream *in);
-	~Ui_hueWindow();
-	Ui_hueDialog ui;
-
-public slots:
-	void gather(Hue_Param *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_hue_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,139 +0,0 @@
-/***************************************************************************
-                          Q_SRT.cpp  -  description
-                             -------------------
-
-    Handle the QT specific part of the fontsize &amp; position dialog box
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-#include &quot;Q_srt.h&quot;
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-  Ui_srtWindow::Ui_srtWindow(SRT_POS_PARAM *param,AVDMGenericVideoStream *in)
-  {
-    uint32_t width,height;
-        ui.setupUi(this);
-        lock=0;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-
-        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
-        
-        myCrop=new flySrtPos( width, height,in,canvas,ui.horizontalSlider);
-        memcpy(&amp;(myCrop-&gt;param),param,sizeof(SRT_POS_PARAM));
-        myCrop-&gt;_cookie=&ui;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-
-        ui.verticalSlider-&gt;setMaximum(height-1);
-        
-        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
-        connect( ui.verticalSlider,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int)));
-        connect( ui.spinBox,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int)));  
-        
-          
-
-  }
-  void Ui_srtWindow::sliderUpdate(int foo)
-  {
-    myCrop-&gt;sliderChanged();
-  }
-  void Ui_srtWindow::gather(SRT_POS_PARAM *param)
-  {
-    
-        myCrop-&gt;download();
-        memcpy(param,&amp;(myCrop-&gt;param),sizeof(SRT_POS_PARAM));
-  }
-Ui_srtWindow::~Ui_srtWindow()
-{
-  if(myCrop) delete myCrop;
-  myCrop=NULL; 
-  if(canvas) delete canvas;
-  canvas=NULL;
-}
-void Ui_srtWindow::valueChanged( int f )
-{
-  if(lock) return;
-  lock++;
-  myCrop-&gt;update();
-  lock--;
-}
-
-#define MYSPIN(x) w-&gt;x
-#define MYCHECK(x) w-&gt;checkBox##x
-//************************
-uint8_t flySrtPos::upload(void)
-{
-      Ui_srtDialog *w=(Ui_srtDialog *)_cookie;
-
-        MYSPIN(spinBox)-&gt;setValue(param.fontSize);
-        int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max&lt;0) max=0;
-        if(param.position&gt;=max)
-        {
-          param.position=max;
-        }
-        QSlider  *slide=w-&gt;verticalSlider;
-        slide-&gt;setValue(param.position);
-        return 1;
-}
-uint8_t flySrtPos::download(void)
-{
-       Ui_srtDialog *w=(Ui_srtDialog *)_cookie;
-         param.fontSize=MYSPIN(spinBox)-&gt;value();
-         int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max&lt;0) max=0;
-        
-        QSlider  *slide=w-&gt;verticalSlider;
-        param.position=slide-&gt;value();
-        
-        if(param.position&gt;=max)
-        {
-          param.position=max;
-          upload();
-        }
-         
-return 1;
-}
-
-/**
-      \fn     DIA_srtPos
-      \brief  Handle srt fontsize/position dialog
-*/
-int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
-{
-        uint8_t ret=0;
-        SRT_POS_PARAM param;
-        param.fontSize=*size;
-        param.position=*position;
-        Ui_srtWindow dialog(&amp;param,in);        
-        if(dialog.exec()==QDialog::Accepted)
-        {
-            dialog.gather(&amp;param);
-            *size=param.fontSize;
-            *position=param.position;
-            ret=1;
-        }
-        return ret;
-}
-//____________________________________
-// EOF
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,36 +0,0 @@
-#ifndef Q_srt_h
-#define Q_srt_h
-
-#include &quot;ui_srt.h&quot;
-#include &quot;ADM_image.h&quot;
-
-class ADMfont;
-
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
-#include &quot;DIA_flySrtPos.h&quot;
-
-class Ui_srtWindow : public QDialog
-{
-	Q_OBJECT
-
-protected:
-	int lock;
-
-public:
-	flySrtPos *myCrop;
-	ADM_QCanvas *canvas;
-	Ui_srtWindow(SRT_POS_PARAM *param, AVDMGenericVideoStream *in);
-	~Ui_srtWindow();
-	Ui_srtDialog ui;
-
-public slots:
-	void gather(SRT_POS_PARAM *param);
-
-private slots:
-	void sliderUpdate(int foo);
-	void valueChanged(int foo);
-};
-#endif	// Q_srt_h

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,180 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;asharpDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;asharpDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;481&lt;/width&gt;
-    &lt;height&gt;454&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;ASharp&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;3&quot; column=&quot;3&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;3&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;3&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;3&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;4&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;6&quot; column=&quot;1&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;5&quot; column=&quot;0&quot; colspan=&quot;4&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Strength&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Threshold&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Block Adaptative&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBox&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Unknown flag&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxTreshold&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxStrength&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxBlock&quot; /&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;asharpDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;asharpDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,219 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;contrastDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;contrastDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;558&lt;/width&gt;
-    &lt;height&gt;390&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Contrast&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeType&quot; &gt;
-      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;20&lt;/width&gt;
-       &lt;height&gt;40&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
-     &lt;property name=&quot;spacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;leftMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;topMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;rightMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;bottomMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxY&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Luma&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxU&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;ChromaU&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxV&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;ChromaV&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-    &lt;/layout&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
-     &lt;property name=&quot;spacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;leftMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;topMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;rightMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;bottomMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Contrast&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderContrast&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;5&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;15&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Brightness&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBrightness&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;-127&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;127&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-    &lt;/layout&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;contrastDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;contrastDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,145 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;cropDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;cropDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;400&lt;/width&gt;
-    &lt;height&gt;300&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Dialog&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;4&quot; &gt;
-    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonReset&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Reset&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Left:&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Top:&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Bottom:&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxBottom&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Right:&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxRight&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxLeft&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
-    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxTop&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;4&quot; &gt;
-    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonAutoCrop&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;AutCrop&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;cropDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;cropDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,306 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;eq2Dialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;eq2Dialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;651&lt;/width&gt;
-    &lt;height&gt;560&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Contrast&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;5&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;4&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeType&quot; &gt;
-      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;20&lt;/width&gt;
-       &lt;height&gt;40&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;&lt;b&gt;Gamma&lt;/b&gt;&lt;/string&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;textFormat&quot; &gt;
-      &lt;enum&gt;Qt::RichText&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-    &lt;layout class=&quot;QGridLayout&quot; &gt;
-     &lt;property name=&quot;leftMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;topMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;rightMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;bottomMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;horizontalSpacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;verticalSpacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;item row=&quot;4&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Saturation&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;2&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Brightness&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Contrast&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderContrast&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;-200&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;200&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;3&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBrightness&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;-100&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;100&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;5&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderSaturation&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;tickInterval&quot; &gt;
-        &lt;number&gt;1&lt;/number&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-    &lt;/layout&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
-    &lt;layout class=&quot;QGridLayout&quot; &gt;
-     &lt;property name=&quot;leftMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;topMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;rightMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;bottomMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;horizontalSpacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;verticalSpacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;item row=&quot;2&quot; column=&quot;1&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderGreen&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;3&quot; column=&quot;1&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBlue&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;3&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_9&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Blue&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_6&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Red&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_5&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Initial&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;4&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_7&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Weight&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderRed&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;2&quot; column=&quot;0&quot; &gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_8&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Green&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderInitial&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item row=&quot;4&quot; column=&quot;1&quot; &gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderWeight&quot; &gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;300&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-    &lt;/layout&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;eq2Dialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;eq2Dialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,179 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;hueDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;hueDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;505&lt;/width&gt;
-    &lt;height&gt;475&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Hue&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeType&quot; &gt;
-      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;20&lt;/width&gt;
-       &lt;height&gt;40&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
-     &lt;property name=&quot;spacing&quot; &gt;
-      &lt;number&gt;6&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;leftMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;topMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;rightMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;bottomMargin&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Hue&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderHue&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;-90&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;90&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
-       &lt;property name=&quot;text&quot; &gt;
-        &lt;string&gt;Saturation&lt;/string&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-     &lt;item&gt;
-      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderSaturation&quot; &gt;
-       &lt;property name=&quot;minimum&quot; &gt;
-        &lt;number&gt;-10&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;maximum&quot; &gt;
-        &lt;number&gt;10&lt;/number&gt;
-       &lt;/property&gt;
-       &lt;property name=&quot;orientation&quot; &gt;
-        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-       &lt;/property&gt;
-      &lt;/widget&gt;
-     &lt;/item&gt;
-    &lt;/layout&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;hueDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;hueDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,143 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;srtDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;srtDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;608&lt;/width&gt;
-    &lt;height&gt;423&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Subtitle Font Size and Position&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;property name=&quot;leftMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;topMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;rightMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;bottomMargin&quot; &gt;
-    &lt;number&gt;9&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;horizontalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;verticalSpacing&quot; &gt;
-    &lt;number&gt;6&lt;/number&gt;
-   &lt;/property&gt;
-   &lt;item row=&quot;4&quot; column=&quot;2&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeType&quot; &gt;
-      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;20&lt;/width&gt;
-       &lt;height&gt;40&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-   &lt;item rowspan=&quot;2&quot; row=&quot;1&quot; column=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;verticalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;invertedAppearance&quot; &gt;
-      &lt;bool&gt;true&lt;/bool&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;invertedControls&quot; &gt;
-      &lt;bool&gt;false&lt;/bool&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
-    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBox&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Font Size :&lt;/string&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
-    &lt;spacer&gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;sizeHint&quot; &gt;
-      &lt;size&gt;
-       &lt;width&gt;40&lt;/width&gt;
-       &lt;height&gt;20&lt;/height&gt;
-      &lt;/size&gt;
-     &lt;/property&gt;
-    &lt;/spacer&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;srtDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;248&lt;/x&gt;
-     &lt;y&gt;254&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;srtDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;316&lt;/x&gt;
-     &lt;y&gt;260&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -7,4 +7,6 @@
 	Q_ocr.cpp  ${${ADM_LIB}_header}  ${${ADM_LIB}_source})
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
-ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})
\ No newline at end of file
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
+INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_UIs/ADM_QT4/include&quot;)
+ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,14 +1,43 @@
 SET(ADM_LIB ADM_commonUI)
 
 SET(${ADM_LIB}_SRCS
-DIA_audioconfig.cpp   DIA_DVDff.cpp           DIA_flyContrast.cpp  DIA_flySrtPos.cpp   DIA_mjpeg.cpp     DIA_resizeWiz.cpp  DIA_v2v.cpp
-DIA_audioFilter.cpp   DIA_flyCrop.cpp      DIA_gototime.cpp    DIA_postproc.cpp  DIA_srt.cpp        
-DIA_bitrateHisto.cpp  DIA_flyAsharp.cpp    DIA_lavcodec.cpp    DIA_prefs.cpp     DIA_SVCD.cpp       
-DIA_builtin.cpp       DIA_flyHue.cpp       DIA_lavDecoder.cpp  DIA_requant.cpp   DIA_tdeint.cpp     
-DIA_animated.cpp      DIA_ocr.cpp             DIA_tsSub.cpp        DIA_jobs_save.cpp
-DIA_flyEq2.cpp        DIA_flv1.cpp            DIA_flyThreshold.cpp DIA_flyParticle.cpp DIA_flyEraser.cpp DIA_flySwissArmyKnife.cpp
+DIA_audioconfig.cpp   
+DIA_DVDff.cpp           
+DIA_mjpeg.cpp     
+DIA_resizeWiz.cpp  
+DIA_v2v.cpp
+DIA_audioFilter.cpp   
+DIA_gototime.cpp    
+DIA_postproc.cpp  
+DIA_bitrateHisto.cpp  
+DIA_lavcodec.cpp    
+DIA_prefs.cpp     
+DIA_SVCD.cpp       
+DIA_builtin.cpp       
+DIA_lavDecoder.cpp  
+DIA_requant.cpp   
+DIA_tdeint.cpp     
+DIA_animated.cpp      
+DIA_ocr.cpp             
+DIA_tsSub.cpp        
+DIA_jobs_save.cpp
+DIA_flv1.cpp            
 )
 
+SET(OBSOLETE_SRCS
+DIA_flyThreshold.cpp 
+DIA_flyParticle.cpp 
+DIA_flyEraser.cpp 
+DIA_flySwissArmyKnife.cpp
+DIA_flyContrast.cpp  
+DIA_flySrtPos.cpp   
+DIA_srt.cpp        
+DIA_flyCrop.cpp      
+DIA_flyAsharp.cpp    
+DIA_flyHue.cpp       
+DIA_flyEq2.cpp        
 
+)
+
 ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
 

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,95 +0,0 @@
-/**/
-/***************************************************************************
-                          DIA_Asharp
-                             -------------------
-
-                           Ui for Asharp
-
-    begin                : 08 Apr 2005
-    copyright            : (C) 2004/5 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;ADM_default.h&quot;
-
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyAsharp.h&quot;
-#include &quot;ADM_assert.h&quot;
-
-/************* COMMON PART *********************/
-uint8_t  flyASharp::update(void)
-{
-    download();
-    process();
-	copyYuvFinalToRgb();
-    display();
-    return 1;
-}
-uint8_t flyASharp::process(void)
-{
-uint8_t *src,*dst;
-uint32_t stride;
-int32_t T,D,B,B2;
-uint32_t ww,hh;
-
-
-                ww=_w;
-                hh=_h;
-                // parameters floating point to fixed point convertion
-                T = (int)(param.t*(4&lt;&lt;7));
-                D = (int)(param.d*(4&lt;&lt;7));
-                B = (int)(256-param.b*64);
-                B2= (int)(256-param.b*48);
-
-                // clipping (recommended for SIMD code)
-
-                if (T&lt;-(4&lt;&lt;7)) T = -(4&lt;&lt;7); // yes, negatives values are accepted
-                if (D&lt;0) D = 0;
-                if (B&lt;0) B = 0;
-                if (B2&lt;0) B2 = 0;
-
-                if (T&gt;(32*(4&lt;&lt;7))) T = (32*(4&lt;&lt;7));
-                if (D&gt;(16*(4&lt;&lt;7))) D = (16*(4&lt;&lt;7));
-                if (B&gt;256) B = 256;
-                if (B2&gt;256) B2 = 256;
-
-
-                memcpy(YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),ww*hh);
-                memcpy(UPLANE(_yuvBufferOut),UPLANE(_yuvBuffer),ww*hh/4);
-                memcpy(VPLANE(_yuvBufferOut),VPLANE(_yuvBuffer),ww*hh/4);
-                asharp_run_c(     _yuvBufferOut-&gt;GetWritePtr(PLANAR_Y),
-                        _yuvBufferOut-&gt;GetPitch(PLANAR_Y), 
-                        hh,
-                        ww,
-                        T,
-                        D,
-                        B,
-                        B2,
-                        param.bf);
-    
-    // Copy back half source to display
-    dst=_yuvBufferOut-&gt;data;
-    src=_yuvBuffer-&gt;data;
-    stride=ww;
-    for(uint32_t y=0;y&lt;hh;y++)   // We do both u &amp; v!
-    {
-        memcpy(dst,src,stride&gt;&gt;1);
-        dst+=stride;
-        src+=stride;
-    }
-    return 1;
-}
-//EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,18 +0,0 @@
-
-
-#ifndef FLY_ASHARP_H
-#define FLY_ASHARP_H
-class flyASharp : public ADM_flyDialog
-{
-  
-  public:
-   ASHARP_PARAM  param;
-  public:
-   uint8_t    process(void);
-   uint8_t    download(void);
-   uint8_t    upload(void);
-   uint8_t    update(void);
-   flyASharp (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
-};
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,60 +0,0 @@
-/***************************************************************************
-                          ADM_guiContrast.cpp  -  description
-                             -------------------
-    begin                : Mon Sep 23 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;ADM_default.h&quot;
-
-//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyContrast.h&quot;
-/************* COMMON PART *********************/
-uint8_t  flyContrast::update(void)
-{
-    download();
-    process();
-	copyYuvFinalToRgb();
-    display();
-    return 1;
-}
-// Ugly !
-static uint8_t tableluma[256], tablechroma[256];
-
-uint8_t flyContrast::process(void)
-
-{
-  buildContrastTable (param.coef, param.offset, tableluma, tablechroma);
-
-  memcpy (_yuvBufferOut-&gt;data, _yuvBuffer-&gt;data, (_h * _w * 3)&gt;&gt;1);
-  if (param.doLuma)
-    {
-      doContrast (YPLANE(_yuvBuffer), YPLANE(_yuvBufferOut), tableluma, _w, _h);
-    }
-  if (param.doChromaU)
-    {
-      doContrast (UPLANE(_yuvBuffer), UPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
-    }
-
-  if (param.doChromaV)
-    {
-     doContrast (VPLANE(_yuvBuffer), VPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
-    }
-    return 1;
-}
-/************* COMMON PART *********************/

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,22 +0,0 @@
-
-
-#ifndef FLY_CONTRAST_H
-#define FLY_CONTRAST_H
-class flyContrast : public ADM_flyDialog
-{
-  
-  public:
-   CONTRAST_PARAM  param;
-  public:
-   uint8_t    process(void);
-   uint8_t    download(void);
-   uint8_t    upload(void);
-   uint8_t    update(void);
-   flyContrast (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO)
-                    {
-                      
-                    };
-};
-
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,235 +0,0 @@
-/***************************************************************************
-                          DIA_flyCrop.cpp  -  description
-                             -------------------
-
-        Common part of the crop dialog
-    
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-#include &quot;ADM_assert.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyCrop.h&quot;
-
-
-static uint8_t 		Metrics( uint8_t *in, uint32_t width,uint32_t *avg, uint32_t *eqt);
-static uint8_t 		MetricsV( uint8_t *in, uint32_t width,uint32_t height,uint32_t *avg, uint32_t *eqt);
-
-uint8_t    flyCrop::process(void)
-{
-        uint32_t x,y;
-        uint8_t  *in;
-        uint32_t w=_w,h=_h;
-  
-        
-        memcpy(_rgbBufferOut,_rgbBuffer,_w*_h*4);
-        in=_rgbBufferOut;
-        for(y=0;y&lt;top;y++)
-        {
-                for(x=0;x&lt;w;x++)
-                {
-                        *in++=0;
-                        
-                        
-                        *in++=0xff;
-                        
-                        *in++=0;
-                        *in++=0;
-                }
-        }
-        // bottom
-        in=_rgbBufferOut+(w*4)*(h-bottom);
-        for(y=0;y&lt;bottom;y++)
-        {
-                for(x=0;x&lt;w;x++)
-                {
-                        *in++=0;
-                        
-                        
-                        *in++=0xff;
-                        *in++=0;
-                        *in++=0;
-                }
-        }
-        // left
-        in=_rgbBufferOut;
-        uint32_t stride=4*w-4;
-        for(y=0;y&lt;h;y++)
-        {
-                for(x=0;x&lt;left;x++)
-                {
-                        *(in+4*x)=0;
-                        
-                        
-                        *(in+4*x+1)=0xff;
-                        *(in+4*x+2)=0;
-                        *(in+4*x+3)=0;
-                }
-                for(x=0;x&lt;right;x++)
-                {
-                        *(in-4*x+stride-4)=0;
-                        
-                        
-                        *(in-4*x+stride-3)=0xff;
-                        *(in-4*x+stride-2)=0;
-                        *(in-4*x+stride-1)=0;
-                        
-                }
-                in+=4*w;
-  
-        }
-
-		copyRgbFinalToDisplay();
-}
-
-/*----------------------------------
-  autocrop
------------------------------------*/
-
-uint8_t  flyCrop::autocrop(void)
-{
-uint8_t *in;
-uint32_t y,avg,eqt;
-	// Top
-
-#define THRESH_AVG   30
-#define THRESH_EQT   50
-        
-        in=_yuvBuffer-&gt;data;
-        for(y=0;y&lt;((_h&gt;&gt;1)-2);y++)	
-        {
-                Metrics(in,_w,&amp;avg,&amp;eqt);
-                in+=_w;
-                //printf(&quot;LineT :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
-                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
-                        break;
-        }
-//gotcha_:	
-        if(y)
-                top=y-1;
-        else 
-                top=0;
-                
-        in=_yuvBuffer-&gt;data+_w*(_h-1);
-        for(y=0;y&lt;((_h&gt;&gt;1)-2);y++)	
-        {
-                Metrics(in,_w,&amp;avg,&amp;eqt);
-                in-=_w;
-                //printf(&quot;Line B :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
-                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
-                                break;
-        }
-//gotcha_:	
-        if(y)
-                bottom=y-1;
-        else
-                bottom=0;
-
-                
-// Left
-        in=_yuvBuffer-&gt;data;
-        for(y=0;y&lt;((_w&gt;&gt;1)-2);y++)	
-        {
-                MetricsV(in,_w,_h,&amp;avg,&amp;eqt);
-                in++;
-                //printf(&quot;Line L :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
-                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
-                                break;
-        }
-//gotcha_:	
-        if(y)
-                left=y-1;
-        else
-                left=0;		
-// Right
-        in=_yuvBuffer-&gt;data+_w-1;
-        for(y=0;y&lt;((_w&gt;&gt;1)-2);y++)	
-        {
-                MetricsV(in,_w,_h,&amp;avg,&amp;eqt);
-                in--;
-                //printf(&quot;Line R :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
-                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
-                                break;
-        }
-//gotcha_:	
-        if(y)
-                right=y-1;
-        else
-                right=0;
-  
-              
-        // Update display
-        top=top &amp; 0xfffe;
-        bottom=bottom &amp; 0xfffe;
-        upload();
-        process();
-        display();
-        return 1;
-}
-/*---------------------------------------------
-	Compute the average value of pixels
-	and eqt is the &quot;ecart type&quot;
-*/
-uint8_t Metrics( uint8_t *in, uint32_t width,uint32_t *avg, uint32_t *eqt)
-{
-
-uint32_t x;
-uint32_t sum=0,eq=0;
-uint8_t v;
-              for(x=0;x&lt;width;x++)
-              {
-                      sum+=*(in+x);
-              }
-              sum=sum/width;
-              *avg=sum;
-              for(x=0;x&lt;width;x++)
-              {
-                      v=*(in+x)-sum;
-                      eq+=v*v;
-              }
-              eq=eq/(width*width);
-              *eqt=eq;
-              return 1;
-}
-/*---------------------------------------------
-	Compute the average value of pixels
-	and eqt is the &quot;ecart type&quot;
-*/
-uint8_t MetricsV( uint8_t *in,uint32_t width, uint32_t height,uint32_t *avg, uint32_t *eqt)
-{
-
-uint32_t x;
-uint32_t sum=0,eq=0;
-uint8_t v;
-              for(x=0;x&lt;height;x++)
-              {
-                      sum+=*(in+x*width);
-              }
-              sum=sum/height;
-              *avg=sum;
-              for(x=0;x&lt;height;x++)
-              {
-                      v=*(in+x*width)-sum;
-                      eq+=v*v;
-              }
-              eq=eq/(height*height);
-              *eqt=eq;
-              return 1;
-}
-//EOF
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,16 +0,0 @@
-#ifndef FLY_CROP_H
-#define FLY_CROP_H
-class flyCrop : public ADM_flyDialog
-{
-  
-  public:
-   uint32_t left,right,top,bottom;
-  public:
-   uint8_t    process(void);
-   uint8_t    download(void);
-   uint8_t    upload(void);
-   uint8_t    autocrop(void);
-   flyCrop (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,0,RESIZE_LAST) {};
-};
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,85 +0,0 @@
-/***************************************************************************
-                          ADM_guiContrast.cpp  -  description
-                             -------------------
-    begin                : Mon Sep 23 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;config.h&quot;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;math.h&gt;
-#include &quot;ADM_default.h&quot;
-
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyEq2.h&quot;
-
-/************* COMMON PART *********************/
-uint8_t  flyEq2::update(void)
-{
-    download();
-    process();
-    copyYuvFinalToRgb();
-    display();
-    return 1;
-}
-
-uint8_t flyEq2::process(void)
-
-{
-	Eq2Settings mySettings;
-
-#if 0
-	printf(&quot;Contrast   :%f\n&quot;,param.contrast);
-	printf(&quot;brightness :%f\n&quot;,param.brightness);
-	printf(&quot;saturation :%f\n&quot;,param.saturation);
-	
-	printf(&quot;gamma_weight :%f\n&quot;,param.gamma_weight);
-	printf(&quot;gamma :%f\n&quot;,param.gamma);
-	
-	
-	
-	printf(&quot;rgamma :%f\n&quot;,param.rgamma);
-	printf(&quot;bgamma :%f\n&quot;,param.bgamma);
-	printf(&quot;ggamma :%f\n&quot;,param.ggamma);
-	printf(&quot;******************\n&quot;);
-#endif	
-	
-	        update_lut(&amp;mySettings,&amp;param);
-	        
-typedef void lutMeType(oneSetting *par, unsigned char *dst, unsigned char *src, unsigned int w, unsigned int h);
-
-			lutMeType *lutMe=apply_lut;
-			
-
-#ifdef ADM_CPU_X86
-	        if(CpuCaps::hasMMX())
-	        {
-	        		lutMe=affine_1d_MMX;
-	        }
-#endif	
-	        lutMe(&amp;(mySettings.param[0]),YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),_w,_h);
-	        lutMe(&amp;(mySettings.param[2]),UPLANE(_yuvBufferOut),UPLANE(_yuvBuffer),_w&gt;&gt;1,_h&gt;&gt;1);
-	        lutMe(&amp;(mySettings.param[1]),VPLANE(_yuvBufferOut),VPLANE(_yuvBuffer),_w&gt;&gt;1,_h&gt;&gt;1);       
-
-	        	
-	        	#if 1
-	        _yuvBuffer-&gt;copyLeftSideTo(_yuvBufferOut);
-#endif
-		return 1;
-}
-
-/************* COMMON PART *********************/

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,35 +0,0 @@
-
-/***************************************************************************
-                        flyDialog for Eq2-Gtk
-                        (C) Mean 2007
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef FLY_EQ2_H
-#define FLY_EQ2_H
-#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
-class flyEq2 : public ADM_flyDialog
-{
-  
-  public:
-   Eq2_Param  param;
-  public:
-   uint8_t    process(void);
-   uint8_t    download(void);
-   uint8_t    upload(void);
-   uint8_t    update(void);
-   			  flyEq2 (uint32_t width,uint32_t height,AVDMGenericVideoStream *in, void *canvas, void *slider) : 
-                                    	ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO)
-                    {
-                      
-                    };
-};
-
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,80 +0,0 @@
-/**/
-/***************************************************************************
-                          DIA_hue
-                             -------------------
-
-			   Ui for hue &amp; sat
-
-    begin                : 08 Apr 2005
-    copyright            : (C) 2004/7 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-
-
-#include &quot;config.h&quot;
-
-
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyHue.h&quot;
-
-#include &quot;ADM_assert.h&quot;
-// FIXME
-#ifndef M_PI
-#define M_PI    3.14159265358979323846
-#endif
-
-/************* COMMON PART *********************/
-uint8_t  flyHue::update(void)
-{
-    download();
-    process();
-	copyYuvFinalToRgb();
-    display();
-    return 1;
-}        
-
-uint8_t  flyHue::process(void )
-{
-uint8_t *src,*dst;
-uint32_t stride;
-float hue,sat;
-    hue=param.hue*M_PI/180.;
-    sat=(100+param.saturation)/100.;
-    memcpy(YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),_w*_h); // copy luma
-    // Do it!
-    HueProcess_C(VPLANE(_yuvBufferOut), UPLANE(_yuvBufferOut),
-        VPLANE(_yuvBuffer), UPLANE(_yuvBuffer),
-        _w&gt;&gt;1,_w&gt;&gt;1,
-        _w&gt;&gt;1,_h&gt;&gt;1, 
-        hue, sat);
-    // Copy half source to display
-    dst=_yuvBufferOut-&gt;data+_w*_h;
-    src=_yuvBuffer-&gt;data+_w*_h;
-    stride=_w&gt;&gt;1;
-    for(uint32_t y=0;y&lt;_h;y++)   // We do both u &amp; v!
-    {
-        memcpy(dst,src,stride&gt;&gt;1);
-        dst+=stride;
-        src+=stride;
-    }
-    return 1;
-}
-//EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,16 +0,0 @@
-#ifndef FLY_HUE_H
-#define FLY_HUE_H
-class flyHue : public ADM_flyDialog
-{
-  
-  public:
-   Hue_Param  param;
-  public:
-   uint8_t    process(void);
-   uint8_t    download(void);
-   uint8_t    upload(void);
-   uint8_t    update(void);
-   flyHue (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
-};
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,157 +0,0 @@
-//
-// C++ Implementation: ADM_vidForcedPP
-//
-// Description: 
-//
-//	Force postprocessing assuming constant quant &amp; image type
-//	Uselefull on some badly authored DVD for example
-//
-// Author: mean &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>&gt;, (C) 2004
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-#include &quot;config.h&quot;
-
-#ifdef USE_FREETYPE
-#include &quot;ADM_default.h&quot;
-#include &quot;ADM_userInterfaces/ADM_render/GUI_render.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-
-
-
-#include &quot;DIA_factory.h&quot;
-#include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
-//#include &quot;ADM_video/ADM_vidFont.h&quot;
-class ADMfont;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-//#include &quot;ADM_colorspace/colorspace.h&quot;
-/*****************************************************************/
-extern int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b);
-extern int DIA_srtPos(AVDMGenericVideoStream *source,uint32_t *size,uint32_t *position);
-static void colorCallBack(void *cookie);
-static void sizePositionCallback(void *cookie);
-/*****************************************************************/
-typedef struct unicd
-{
-	char *display,*name;
-}unicd;
-
-  static unicd  names[]=
-{
-	{(char *)&quot;Ascii&quot;	,(char *)&quot;ISO-8859-1&quot;},
-	{(char *)&quot;Cyrillic&quot;	,(char *)&quot;WINDOWS-1251&quot;}, // ru
-	{(char *)&quot;Czech&quot;	,(char *)&quot;ISO-8859-2&quot;},	// cz
-	{(char *)&quot;German&quot;	,(char *)&quot;ISO-8859-9&quot;}		// german ?
-	,{(char *)&quot;Slovene&quot;	,(char *)&quot;CP1250&quot;}		// UTF8
-        
-        ,{(char *)&quot;UTF16&quot;	,(char *)&quot;UTF16&quot;}		// UTF8
-	,{(char *)&quot;UTF8&quot;	,(char *)&quot;UTF8&quot;}		// UTF8
-	,{(char *)&quot;Chinese Traditionnal(Big5)&quot;	,(char *)&quot;CP950&quot;}		// UTF8
-	,{(char *)&quot;Chinese Simplified (GB2312)&quot;	,(char *)&quot;CP936&quot;}		// UTF8
-};
-typedef struct 
-{
-  AVDMGenericVideoStream *source;
-  uint32_t               *size;
-  uint32_t               *position;
-}sizePosition;
-
-/**
-      \fn    DIA_srt
-      \brief Dialog to handle srt, generic part
-*/
-uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param)
-{
-#define item(x) QT_TR_NOOP(names[x].display)
-#define Mitem(x) {x,item(x)}
-diaMenuEntry encoding[]={
-  Mitem(0),
-  Mitem(1),
-  Mitem(2),
-  Mitem(3),
-  Mitem(4),
-  Mitem(5),
-  Mitem(6),
-  Mitem(7),
-};       
-
-#define PX(x) &amp;(param-&gt;x)
-  diaElemFile subtitle(0,(char **)PX(_subname),QT_TR_NOOP(&quot;_Subtitle file:&quot;), NULL, QT_TR_NOOP(&quot;Select Subtitle file&quot;));
-  diaElemFile font(0,(char **)PX(_fontname),QT_TR_NOOP(&quot;_Font (TTF):&quot;), NULL, QT_TR_NOOP(&quot;Select TTF file&quot;));
-  int colors[3]={param-&gt;_Y_percent,param-&gt;_U_percent,param-&gt;_V_percent};
-  
-  uint32_t fontSize=param-&gt;_fontsize;
-  uint32_t baseLine=param-&gt;_baseLine;
-  
-  sizePosition sizePos={source,&amp;fontSize,&amp;baseLine};
-  
-  uint32_t myEncoding=0;
-      // convert internal to display
-      if(param-&gt;_charset)
-      for(int i=0;i&lt;sizeof(names)/sizeof(unicd);i++)
-      {
-          if(!strcmp(param-&gt;_charset,names[i].name)) myEncoding=i;
-      }
-      diaElemMenu      encodingM(&amp;myEncoding,QT_TR_NOOP(&quot;_Encoding:&quot;),8,encoding);
-    //  diaElemUInteger  fontSize(PX(_fontsize),QT_TR_NOOP(&quot;Font Si_Ze:&quot;),8,120);
-      diaElemButton    color(QT_TR_NOOP(&quot;S_elect C_olor&quot;), colorCallBack,&amp;(colors[0]));
-      diaElemButton    setBase(QT_TR_NOOP(&quot;Set Size and _Position&quot;), sizePositionCallback,&amp;sizePos);
-      diaElemToggle    autoSplit(PX(_selfAdjustable),QT_TR_NOOP(&quot;_Auto split&quot;));
-      diaElemInteger   delay(PX(_delay),QT_TR_NOOP(&quot;_Delay (ms):&quot;),-100000,100000);
-         
-      diaElem *tabs[]={&amp;subtitle,&amp;font,&amp;encodingM,&amp;color,&amp;setBase,&amp;autoSplit,&amp;delay};
-      if( diaFactoryRun(QT_TR_NOOP(&quot;Subtitler&quot;),7,tabs))
-	{
-          if(param-&gt;_charset) ADM_dealloc(param-&gt;_charset);
-          param-&gt;_charset=ADM_strdup(names[myEncoding].name);
-            param-&gt;_Y_percent=colors[0];
-            param-&gt;_U_percent=colors[1];
-            param-&gt;_V_percent=colors[2];
-            param-&gt;_fontsize=fontSize;
-            param-&gt;_baseLine=baseLine;
-          return 1;
-        }
-         return 0;
-}
-/**
-      \fn colorCallBack
-      \brief Callback used to select a color
-*/
-void colorCallBack(void *cookie)
-{
-  
-      int32_t *colors=(int32_t *)cookie;
-        
-        uint8_t r,g,b;
-        uint8_t y;
-        int8_t u,v;
-  
-        y=colors[0];
-        u=colors[1];
-        v=colors[2];
-
-        COL_YuvToRgb(   y,  u,  v, &amp;b,&amp;g,&amp;r);
-        if(DIA_colorSel(&amp;r,&amp;g,&amp;b))
-        {
-                COL_RgbToYuv(b,  g,  r, &amp;y, &amp;u,&amp;v);
-                colors[0]=y;
-                if(abs(u)&lt;2) u=0;
-                if(abs(v)&lt;2) v=0;
-                colors[1]=u;
-                colors[2]=v;
-        }
-}
-/**
-      \fn sizePositionCallback
-      \brief Callback used to set size and position
-*/
-void sizePositionCallback(void *cookie)
-{
-    sizePosition *sz=(sizePosition *)cookie;
-    printf(&quot;Size and position invoked\n&quot;);
-    DIA_srtPos(sz-&gt;source,sz-&gt;size,sz-&gt;position);
-}
-#endif
-// EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,402 +0,0 @@
-/***************************************************************************
-                          ADM_vidSRT.cpp  -  description
-                             -------------------
-    begin                : Thu Dec 12 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-
-#ifdef USE_FREETYPE
-#include &quot;ADM_default.h&quot;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-
-#include &quot;ADM_video/ADM_vidFont.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_FILTER
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-
-#include &quot;prefs.h&quot;
-
-static FILTER_PARAM subParam={15,{&quot;_fontsize&quot;,&quot;_subname&quot;,&quot;_fontname&quot;,&quot;_charset&quot;,
-				&quot;_baseLine&quot;,&quot;_Y_percent&quot;,&quot;_U_percent&quot;,&quot;_V_percent&quot;,
-				&quot;_selfAdjustable&quot;,&quot;_delay&quot;,&quot;_useBackgroundColor&quot;,&quot;_bg_Y_percent&quot;,
-      				&quot;_bg_U_percent&quot;,&quot;_bg_V_percent&quot;,&quot;_blend&quot;}};
-
-SCRIPT_CREATE(subtitle_script,ADMVideoSubtitle,subParam);
-
-BUILD_CREATE(subtitle_create,ADMVideoSubtitle);
-
-//__________________________________________________________________
-
-//_______________________________________________________________
-
-//__________________________________________________________________
-
-char 								*ADMVideoSubtitle::printConf(void)
- {
-	  	static char buf[50];
- 	
- 				sprintf((char *)buf,&quot;Subtitle &quot;);
-        return buf;
-	}
-
-//--------------------------------------------------------	
-ADMVideoSubtitle::ADMVideoSubtitle(AVDMGenericVideoStream *in,CONFcouple *couples)
-{
-
-  uint32_t frame;
-//  char c;
-
-  _uncompressed=NULL;
-  _font=NULL;
-
-
-  _in=in;
-  memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));
-
-	frame=3*_in-&gt;getInfo()-&gt;width*_in-&gt;getInfo()-&gt;height;
-
-	_subs=NULL;
-	_fd=NULL;
- 	_line=0;
-	_oldframe=0;
-	_oldline=0;
-	_font = new ADMfont();	
-	if(couples)
-	{
-                int32_t b;
-			SUBCONF *_param;
-			_conf=NEW( SUBCONF);
-
-
-			_param=_conf; // keep macro happy
-
-			GET(_fontsize);
-			GET(_subname);
-			GET(_fontname);
-			GET(_charset);
-			GET(_baseLine);
-			GET(_Y_percent);
-			GET(_U_percent);
-			GET(_V_percent);
-			GET(_selfAdjustable);
-			GET(_delay);
-			GET(_useBackgroundColor);
-			GET(_bg_Y_percent);
-      			GET(_bg_U_percent);
-      			GET(_bg_V_percent);
-//                        GET(_blend);
-                        couples-&gt;getCouple(&quot;_blend&quot;,&amp;b);
-                        _param-&gt;_blend=(BlendMode)b;
-			if(_conf-&gt;_baseLine&gt;_info.height-_conf-&gt;_fontsize*SRT_MAX_LINE)
-                        {
-                                printf(&quot;Base exceeded : base :%lu height :%lu bottom:%lu\n&quot;,
-                                        _conf-&gt;_baseLine,_info.height,_info.height-_conf-&gt;_fontsize*SRT_MAX_LINE);
-                                _conf-&gt;_baseLine=_conf-&gt;_fontsize*SRT_MAX_LINE;
-                        }
-
-                    char *ft,*sub;
-                        ft=(char *)ADM_alloc(500);
-                        sub=(char *)ADM_alloc(500);
-                        strcpy(ft,(char *)_conf-&gt;_subname); 
-                        _conf-&gt;_subname=(ADM_filename *)ft;
-                        strcpy(sub,(char *)_conf-&gt;_fontname); 
-                        _conf-&gt;_fontname=(ADM_filename *)sub;
-
-                        sub=(char *)ADM_alloc(500);
-                        strcpy(sub,_conf-&gt;_charset);
-                        _conf-&gt;_charset=sub;
-                        loadSubtitle();
-                        loadFont();
-
-	}
-	else
-	{
-			_conf=NEW( SUBCONF);
-
-			_conf-&gt;_fontname=(ADM_filename *)ADM_alloc(500);
-			_conf-&gt;_subname=(ADM_filename *)ADM_alloc(500);
-			_conf-&gt;_charset=(char *)ADM_alloc(500);
-			_conf-&gt;_fontname[0]=0;
-			_conf-&gt;_subname[0]=0;
-			_conf-&gt;_charset[0]=0;
-			
-			
-			_conf-&gt;_baseLine=_info.height-24*SRT_MAX_LINE;
-			_conf-&gt;_Y_percent=255;
-			_conf-&gt;_U_percent=0;
-			_conf-&gt;_V_percent=0;
-                        _conf-&gt;_fontsize=24; 
-			_conf-&gt;_selfAdjustable=0;
-			_conf-&gt;_delay=0;
-			_conf-&gt;_useBackgroundColor=0;
-			
-			_conf-&gt;_bg_Y_percent=0;
-			_conf-&gt;_bg_U_percent=0;
-			_conf-&gt;_bg_V_percent=0;
-                        _conf-&gt;_blend=BLEND_SOLID;
-
-			prefs-&gt;get(FILTERS_SUBTITLE_FONTSIZE,&amp;(_conf-&gt;_fontsize));
-			prefs-&gt;get(FILTERS_SUBTITLE_YPERCENT,&amp;(_conf-&gt;_Y_percent));
-			prefs-&gt;get(FILTERS_SUBTITLE_UPERCENT,&amp;(_conf-&gt;_U_percent));
-			prefs-&gt;get(FILTERS_SUBTITLE_VPERCENT,&amp;(_conf-&gt;_V_percent));
-			prefs-&gt;get(FILTERS_SUBTITLE_SELFADJUSTABLE,&amp;(_conf-&gt;_selfAdjustable));			
-			prefs-&gt;get(FILTERS_SUBTITLE_USEBACKGROUNDCOLOR,&amp;(_conf-&gt;_useBackgroundColor));
-			
-			// _conf-&gt;_fontname, ... are used as memory for a dialog
-			// later. we can't used the length of the current string
-			{ char *tmp;
-			   prefs-&gt;get(FILTERS_SUBTITLE_FONTNAME,&amp;tmp);
-			   strcpy((char *)_conf-&gt;_fontname,tmp);
-			   ADM_dealloc(tmp);
-			   
-			   prefs-&gt;get(FILTERS_SUBTITLE_CHARSET,&amp;tmp);
-			   strcpy(_conf-&gt;_charset,tmp); 
-                           ADM_dealloc(tmp);
-			}
-			
-	}
-
-  
-  	_info.encoding=1;
-
-
-	_bitmap=0xffffffff;
-#define BITMAP_SIZE _info.width*_conf-&gt;_fontsize*SRT_MAX_LINE
-	_bitmapBuffer=new uint8_t[_info.width*_info.height];
-	_maskBuffer=new uint8_t[_info.width*_info.height];
-  _bgBitmapBuffer=new uint8_t[(_info.width*_info.height)&gt;&gt;1];
-	_bgMaskBuffer=new uint8_t[_info.width*_info.height];
-        _dirty=new uint8_t[_info.height];
-	ADM_assert(_bitmapBuffer);
-	ADM_assert(_maskBuffer);
-	ADM_assert(_bgBitmapBuffer);
-	ADM_assert(_bgMaskBuffer);
-        ADM_assert(_dirty);
-}
-uint8_t	ADMVideoSubtitle::loadSubtitle( void )
-{
-unsigned char c,d;
-			_fd=fopen((char *)_conf-&gt;_subname,&quot;rt&quot;);
-			if(!_fd)
-			{
-                          GUI_Error_HIG(QT_TR_NOOP(&quot;Could not open subtitle file&quot;), NULL);
-				return 0;
-			}
-			// Try to detect utf16 files			
-			c=fgetc(_fd);
-			// Skip utf identifier if any
-			if( (c&amp;0xef)==0xef)
-			{
-                          int count=4;
-                                while(count-- &amp;&amp; c&amp;0x80) c=fgetc(_fd);
-			}
-			switch(c)
-			{
-			case '{' :
-						loadSubTitle();
-						break;
-			case '1' :
-						loadSRT();
-						break;
-			default:
-                          GUI_Error_HIG(QT_TR_NOOP(&quot;Cannot identify subtitle format&quot;), NULL);
-			}
-
-  // Apply delay to subtitles
-  
-  aprintf(&quot;[debug] DELAY %d\n&quot;, _conf-&gt;_delay);
-  if(_conf-&gt;_delay)
-  {
-  	int32_t newStartTime;
-	int32_t newEndTime;
-	for(uint32_t i=0;i&lt;_line;i++) 
-	{
-		aprintf(&quot;[debug] BEFORE DELAY (%d) %d %d\n&quot;,i, _subs[i].startTime,_subs[i].endTime);
-		newStartTime=_subs[i].startTime;
-		newStartTime+=_conf-&gt;_delay;
-		_subs[i].startTime=(newStartTime);
-		newEndTime=_subs[i].endTime;
-		newEndTime+=_conf-&gt;_delay;
-		_subs[i].endTime=(newEndTime);
-		// put them at infinit display time
-		// should get rid of them
-		if(newEndTime&lt;0 || newStartTime&lt;0)
-		{
-			_subs[i].startTime=_subs[i].endTime=0;
-		}
-		aprintf(&quot;[debug] AFTER DELAY (%d) %d %d\n&quot;,i, _subs[i].startTime,_subs[i].endTime);
-  	}
-  }
-
-
-	fclose(_fd);
-	_fd=NULL;
-	_bitmap=0xffffffff;
-	if(_line)	// that way we will have the first sub
-		_oldline=_line-1;
-	return 1;
-}
-uint8_t	ADMVideoSubtitle::getCoupledConf( CONFcouple **couples)
-{
-SUBCONF *_param;
-
-			_param=_conf; // keep macro happy
-			ADM_assert(_param);
-			*couples=new CONFcouple(15);
-
-			CSET(_fontsize);
-			CSET(_subname);
-			CSET(_fontname);
-			CSET(_charset);
-			CSET(_baseLine);
-			CSET(_Y_percent);
-			CSET(_U_percent);
-			CSET(_V_percent);
-			CSET(_selfAdjustable);
-			CSET(_delay);
-			CSET(_useBackgroundColor);
-			CSET(_bg_Y_percent);
-			CSET(_bg_U_percent);
-			CSET(_bg_V_percent);
-                        (*couples)-&gt;setCouple(&quot;_blend&quot;,(uint32_t)_param-&gt;_blend);
-
-		return 1;
-
-}
-//__________________________________________________________________
-
-ADMVideoSubtitle::~ADMVideoSubtitle()
-{
-
-		if(_bitmapBuffer)
-			{
-				delete [] _bitmapBuffer;
-				_bitmapBuffer=0;
-			}
-		if(_maskBuffer)
-			{
-				delete [] _maskBuffer;
-				_maskBuffer=0;
-			}
-
- 		if(_bgBitmapBuffer) 
-			{
-				delete [] _bgBitmapBuffer;
-				_bgBitmapBuffer=0;
-			}
- 
-		if(_bgMaskBuffer) 
-			{
-				delete [] _bgMaskBuffer;
-				_bgMaskBuffer=0;
-			}
-                if(_dirty)
-                {
-                                delete [] _dirty;
-                                _dirty=0;
-                }
-
-		if(_fd)
-		{
-				fclose(_fd);
-				_fd=NULL;
-		}
-		if(_subs)
-		{
-				for(uint32_t i=0;i&lt;_line;i++)
-				{
-					if(_subs[i].nbLine)
-					{
-					for(uint32_t k=0;k&lt;_subs[i].nbLine;k++)
-					{					
-						if(_subs[i].string[k])
-						{
-							delete [] _subs[i].string[k];
-							_subs[i].string[k]=NULL;
-						}
-					}					
-					
-					delete _subs[i].string;
-					_subs[i].string=NULL;
-					delete _subs[i].lineSize;
-					_subs[i].lineSize=NULL;
-					}
-				}
-				delete [] _subs;
-				_subs=NULL;
-		}
-	if(_conf)
-	{
-			ADM_dealloc(_conf-&gt;_subname);
-			ADM_dealloc(_conf-&gt;_fontname);
-			ADM_dealloc(_conf-&gt;_charset);
-
-		 	DELETE(_conf);
-	}
-	if(_font)
-	{
-		delete _font;
-		_font=NULL;
-	}
-}
-
-uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param);
-    
-uint8_t ADMVideoSubtitle::configure(AVDMGenericVideoStream *instream)
-{
-  
-  UNUSED_ARG(instream);
-//char c;
-uint8_t ret=0;
-int charset=0;
-uint32_t l,f;
-
-                        
-          if(DIA_srt(	instream,_conf))
-          {
-            printf(&quot;\n Font : %s&quot;, _conf-&gt;_fontname);
-            printf(&quot;\n Sub  : %s&quot;, _conf-&gt;_subname);
-            printf(&quot;\n Font size : %ld&quot;,_conf-&gt;_fontsize);
-            printf(&quot;\n Charset : %d&quot;,charset);
-            printf(&quot;\n Y : %ld&quot;,_conf-&gt;_Y_percent);
-            printf(&quot;\n U : %ld&quot;,_conf-&gt;_U_percent);
-            printf(&quot;\n V : %ld&quot;,_conf-&gt;_V_percent);
-
-
-            loadSubtitle();
-            loadFont();
-                        
-            prefs-&gt;set(FILTERS_SUBTITLE_FONTNAME,
-                    (ADM_filename *)_conf-&gt;_fontname);
-            prefs-&gt;set(FILTERS_SUBTITLE_CHARSET,
-                    _conf-&gt;_charset);
-            prefs-&gt;set(FILTERS_SUBTITLE_FONTSIZE,_conf-&gt;_fontsize);
-            prefs-&gt;set(FILTERS_SUBTITLE_YPERCENT,_conf-&gt;_Y_percent);
-            prefs-&gt;set(FILTERS_SUBTITLE_UPERCENT,_conf-&gt;_U_percent);
-            prefs-&gt;set(FILTERS_SUBTITLE_VPERCENT,_conf-&gt;_V_percent);
-            prefs-&gt;set(FILTERS_SUBTITLE_SELFADJUSTABLE,
-                        _conf-&gt;_selfAdjustable);
-            prefs-&gt;set(FILTERS_SUBTITLE_USEBACKGROUNDCOLOR,
-                        _conf-&gt;_useBackgroundColor);
-            ret=1;
-        }
-        return ret;
-
-}
-#endif
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,128 +0,0 @@
-/***************************************************************************
-                          ADM_vidSRT.h  -  description
-                             -------------------
-    begin                : Thu Dec 12 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-    
-    Lots of bugfixes / enhancement by Daniel Lima
-    
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifdef USE_FREETYPE
-
-#define SRT_MAX_LINE 3
-#define SRT_MAX_LINE_LENGTH 512
-
-#define ADM_GLYPH_T uint16_t 
-// UTF16 -&gt; Ascii
-
-#define ADM_ASC(x) x
-
-typedef struct subLine
-{
-  
-	uint32_t 		startTime;
-	uint32_t 		endTime;
-	uint32_t		nbLine;
-	uint32_t		*lineSize;
-	ADM_GLYPH_T		**string;
-	
-}subLine;
-
-typedef enum 
-{
-        BLEND_SOLID=1,
-        BLEND_DOTTED,
-        BLEND_DIMMER
-}BlendMode;
-
-typedef struct SUBCONF
-{
-		uint32_t _fontsize;
-		uint32_t _baseLine;
-
-  /** YUV font color components */
-		int32_t    _Y_percent;
-		int32_t    _U_percent;
-		int32_t    _V_percent;
-		ADM_filename	*_fontname;
-		ADM_filename	*_subname;
-		char 		*_charset;
-		uint32_t	_selfAdjustable;   /** Automatic line breaks */
-		int32_t		_delay;            
-		/** Wait x miliseconds before show subtitles. If negative, it will to show subtitles x */
-		/* miliseconds before. */
-
-
-		uint32_t	_useBackgroundColor;
-
-  /** YUV background color components */
-		int32_t   _bg_Y_percent;
-		int32_t   _bg_U_percent;
-		int32_t   _bg_V_percent;
-                BlendMode _blend;
-
-
-	}SUBCONF;
-
-  class  ADMVideoSubtitle:public AVDMGenericVideoStream
- {
-
- protected:
-
-	    	SUBCONF					*_conf;		
-       virtual char 					*printConf(void) ;
-        FILE						*_fd;
-        uint8_t						loadSubTitle( void );
-	uint8_t  					loadSRT( void )        ;
-        uint32_t					_line;
-        subLine						*_subs;
-        uint32_t					_oldframe;
-        uint32_t					_oldline;
-        uint32_t					_bitmap;
-        uint32_t					search(uint32_t time);
-        void 						displayString(subLine *string);
-	void 						displayString_autoadj(char *string);
-        void 						displayChar(uint32_t w,uint32_t h,char c);
-  	uint32_t					displayLine(ADM_GLYPH_T *string,uint32_t line, uint32_t len);
-  
-	uint8_t 					lowPass(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h);
-	uint8_t 					decimate(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h);
-
-
-        uint8_t						*_bitmapBuffer;
-	uint8_t						*_maskBuffer;
-	uint8_t						*_bgBitmapBuffer;
-	uint8_t						*_bgMaskBuffer;
-        uint8_t                                         *_dirty;
-	uint8_t						blend(uint8_t *target,uint32_t baseLine);
-	ADMfont						*_font;
-	uint8_t						loadSubtitle(void);
-	uint8_t						loadFont(void);
-	uint8_t 					subParse( subLine *in, char *string );
-        uint8_t                                         doChroma(void);
-        uint8_t                                         clearBuffers(void);
-        void                                            doAutoSplit(subLine *string);
-        uint8_t                                         isDirty(int line);
-
- public:
- 		
-  						ADMVideoSubtitle(  AVDMGenericVideoStream *in,CONFcouple *setup);
-  						~ADMVideoSubtitle();
-		      virtual uint8_t 		getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-       								ADMImage *data,uint32_t *flags);
-
-			virtual uint8_t	getCoupledConf( CONFcouple **couples)		;
-			virtual uint8_t 	configure( AVDMGenericVideoStream *instream);
-							
- }     ;
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,783 +0,0 @@
-/***************************************************************************
-                          ADM_vidSRT.cpp  -  description
-                             -------------------
-    begin                : Thu Dec 12 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-
-#ifdef USE_FREETYPE
-#include &lt;math.h&gt;
-
-#include &quot;ADM_default.h&quot;
-
-
-#include &quot;ADM_videoFilter.h&quot;
-
-#include &quot;ADM_video/ADM_vidFont.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_FILTER
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-
-#define SUB_OUT 0xf0000000
-#define ALPHA
-#define LUMA_LEVEL 10
-
-#define SAFE_STRCPY(dest,destLen,src,srcLen) \
-memcpy(dest,src,srcLen&lt;destLen?srcLen:destLen-1); \
-dest[srcLen&lt;destLen?srcLen:destLen-1]='\0'; \
-
-
-//                     1
-//		Get in range in 121 + coeff matrix
-//                     1
-//
-// If the value is too far away we ignore it
-// else we blend
-//__________________________________________________________________
-uint8_t ADMVideoSubtitle::getFrameNumberNoAlloc(uint32_t frame,
-						uint32_t *len,
-   						ADMImage *data,
-   						uint32_t *flags)
-{
-
-double f;
-uint32_t time,srch;
-uint32_t absFrame=frame+_info.orgFrame;
-
-	//		printf(&quot;\n Stabilize : %lu\n&quot;,frame);
-          _uncompressed=data;
-	if(frame&gt;=_info.nb_frames) 
-	{
-		printf(&quot;Filter : out of bound!\n&quot;);
-		return 0;
-	}
-	if(!_in-&gt;getFrameNumberNoAlloc(frame, len,data,flags)) return 0;
-
-	// if no subtitle return...
-	if(!_subs) return 1;
-
-	// compute time stamp
-	      f=absFrame*1000000./_info.fps1000;
-	      time=(uint32_t) floor(f);
-	      // Do we have it already ?
-
-	      if(time&lt;=_subs[_oldline].endTime &amp;&amp; time &gt;=_subs[_oldline].startTime)
-	      {
-	      		aprintf(&quot;Sub: cached %lu %lu %lu\n&quot;,time,_subs[_oldline].startTime,_subs[_oldline].endTime);
-			blend(YPLANE(data),_conf-&gt;_baseLine); // re-use it
-			return 1;	
-
-	      }
-	      srch=search(time);
-	      // we got the right one
-     
-	      if(srch!=SUB_OUT) // we got something...
-			{
-					_oldline=srch;
-					aprintf(&quot;Sub: Using line %d\n&quot;,srch);
-					//printf(&quot;\n %s \n&quot;,_subs[_oldline].string);
-					displayString(&amp;(_subs[_oldline]));
-					blend(YPLANE(data),_conf-&gt;_baseLine);
-			}
-
-		return 1;
-
-}
-//_________________________________________________________________
-uint32_t	ADMVideoSubtitle::search(uint32_t time)
-{
-	if(time&lt;_subs[0].startTime)
-		return SUB_OUT;
-
-	  for(uint32_t i=0;i&lt;_line;i++)
-	  {
-				if((time&lt;=_subs[i].endTime)  &amp;&amp;
-					(time&gt;=_subs[i].startTime)
-				)
-				return i;
-
-		}
-		return SUB_OUT;
-}
-//
-//	Display up to 3 lines of text centered on screen
-//  Each line is separated by a |
-// It is the basic version that tries to use only 2 lines
-// in most cases, 3 when needed
-//______________________________________
-void ADMVideoSubtitle::displayString(subLine *string)
-{
- 
-	uint32_t base=0;	
-	uint32_t nbLine=0;
-	uint32_t i=0;
-	uint32_t overflow=0;
-
-      aprintf(&quot;Sub: Rendering string %s\n&quot;,string);
-// bbase is the final position in line
-// in the image
-
-	clearBuffers();
-	nbLine=string-&gt;nbLine;
-	if(nbLine&gt;SRT_MAX_LINE )
-	{
-		nbLine=SRT_MAX_LINE;
-		printf(&quot;Too much lines\n&quot;);
-	}
-	switch(nbLine)
-	{
-		case 0:
-			base=2*_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line		
-			break;
-		case 1:
-			base=_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line		
-			break;
-		default:
-                        base=0;
-                        break;
-	}	
-		
-	aprintf(&quot;Sub: %d lines to render\n&quot;,nbLine);
-	// scan and display each line
-	for(i=0;i&lt;nbLine;i++)
-	{
-		
-			if(string-&gt;lineSize[i]!=displayLine(string-&gt;string[i],base,string-&gt;lineSize[i]))
-                                overflow=1;
-			base+=_conf-&gt;_fontsize;
-		
-	}
-        if(overflow &amp;&amp; _conf-&gt;_selfAdjustable) 
-        {
-                printf(&quot;Do autosplit\n&quot;);
-                doAutoSplit(string);
-        }
-    	doChroma();
-	// Compute the dirty state
-        // If a line is not set as dirty, it means it has no pixel in it
-        // In fact we do top/bottom and add a tiny bit to it
-        memset(_dirty,1,_info.height);
-
-        // First to top
-
-        int top=0,bottom=_info.height-1,limit;
-        while(top&lt;_info.height &amp;&amp; !isDirty(top)) top++;
-        if(top&gt;_conf-&gt;_fontsize&gt;&gt;1) top-=_conf-&gt;_fontsize&gt;&gt;1;
-        memset(&amp;(_dirty[0]),0,top); // Clear top
-        
-        // Then bottom
-        limit=(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
-        if(limit&gt;=_info.height) limit=_info.height-1;
-
-
-        bottom=limit;
-        while(bottom&gt;top &amp;&amp; !isDirty(bottom)) bottom--;
-        if(bottom+(_conf-&gt;_fontsize&gt;&gt;1)&lt;limit) bottom+=_conf-&gt;_fontsize&gt;&gt;1;
-        ADM_assert(bottom&lt;=limit);
-        memset(&amp;(_dirty[bottom]),0,limit-bottom+1);
-        //printf(&quot;Top:%d bottom :%d limit:%d\n&quot;,top,bottom,limit);
-	
-}
-uint8_t ADMVideoSubtitle::isDirty(int line)
-{
-        uint8_t *base=_maskBuffer+_info.width*line;
-        for(int x=0;x&lt;_info.width;x++)
-        {
-                if(base[x]) return 1;
-        }
-        return 0;
-}
-/*
-        We merge the whole lines into one then split it
-        to avoid truncated subs
-*/
-void ADMVideoSubtitle::doAutoSplit(subLine *string)
-{
-        uint32_t base=0;    
-        uint32_t nbLine=0;
-        uint32_t i=0;
-        int      total=0,start,end,pivot;
-
-        aprintf(&quot;Sub: Autospliting \n&quot;);
-        nbLine=string-&gt;nbLine;
-
-        // Merge all strings into one
-
-        for(int i=0;i&lt;nbLine;i++) 
-                total+=1+string-&gt;lineSize[i];
-
-        ADM_GLYPH_T allwords[total];
-        int         offset[total];
-        int         sentence[total];
-        int         nbWords=0;
-        //
-        start=0;
-        for(int i=0;i&lt;nbLine;i++) 
-        {
-                memcpy(&amp;(allwords[start]),string-&gt;string[i],string-&gt;lineSize[i]*sizeof(ADM_GLYPH_T));
-                start+=string-&gt;lineSize[i];
-                allwords[start]=' ';
-                start++;
-        }
-        // Remove the last ' '
-        start--;
-        end=start;
-        // Here we go, we have now one line made of all merged sub
-        // We will put as much as possible into one displayed line
-        // then switch to the next one
-        //
-        printf(&quot;The new stuff is :&lt;&quot;);
-        for(i=0;i&lt;end;i++)
-                printf(&quot;%c&quot;,allwords[i]);
-        printf(&quot;&gt;\n&quot;);
-        
-        // Split into words
-        pivot=0;
-        int car;
-        offset[0]=0;
-        nbWords=1;
-        while(pivot&lt;end)
-        {
-                car=ADM_ASC(allwords[pivot]);
-                if(car==' ' || car=='.' || car ==',')
-                        {
-                                offset[nbWords++]=pivot;
-                        }
-                pivot++;
-        }
-        printf(&quot;Found %d words\n&quot;,nbWords); 
-        // Now  split
-        int nbSentence=0,len;
-        pivot=0;
-        sentence[0]=0;
-        // Try to display as much as possible in one line
-        // We build sentence here
-        while(pivot&lt;nbWords)
-        {
-                for(i=pivot+1;i&lt;nbWords;i++)
-                {
-                        len=offset[i]-offset[pivot];
-                        if(len!=displayLine(&amp;(allwords[offset[pivot]]),0,len)) break;
-                }
-                sentence[nbSentence]=offset[pivot];
-                nbSentence++;
-                if(i&gt;1 &amp;&amp; i!=nbWords) i--;
-                pivot=i;
-        }
-        printf(&quot;0: %d,off:%d\n&quot;,sentence[0],offset[0]);
-        // Take the last word
-        sentence[nbSentence]=end;
-
-        if(nbSentence&gt;SRT_MAX_LINE) nbSentence=SRT_MAX_LINE;
-        // now display
-        printf(&quot;Nb sentence:%d\n&quot;,nbSentence);
-        for(int j=0;j&lt;nbSentence;j++)
-        {
-                printf(&quot;Sentence %d:&quot;,j);
-                for(int k=sentence[j];k&lt;sentence[j+1];k++)
-                        printf(&quot;%c&quot;,allwords[k]);
-                printf(&quot;\n&quot;);
-        }
-        // now display
-        
-        switch(nbSentence)
-        {
-                case 0:
-                        base=2*_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line            
-                        break;
-                case 1:
-                        base=_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line              
-                        break;
-                default:
-                        base=0;
-                        break;
-        }
-        // scan and display each line
-        clearBuffers();
-        printf(&quot;Display\n&quot;);
-        for(i=0;i&lt;nbSentence;i++)
-        {
-                        len=sentence[i+1]-sentence[i];
-                        displayLine(&amp;(allwords[sentence[i]]),base,len);
-                        //displayLine(allwords,base,10);
-                        base+=_conf-&gt;_fontsize;
-        }
-        printf(&quot;/Display\n&quot;);
-        
-}
-/*
-        Once we have the subtitle built, we do the u&amp; v planes
-        and some smoothing to avoid over sharpening on the chroma plane
-
-*/
-uint8_t ADMVideoSubtitle::doChroma(void)
-{
-// now blur bitmap into mask..
-        memset(_maskBuffer,0,SRT_MAX_LINE*_conf-&gt;_fontsize*_info.width);
-
-        uint32_t off;
-        uint8_t *src,*dst;
-
-        off=0;
-
-        src=_bitmapBuffer;
-        dst=_maskBuffer;
-
-
-        // We shrink it down for u &amp; v by 2x2
-        // mask buffer-&gt;bitmap buffer
-
-        uint8_t tmp[_info.width*_info.height];
-
-        decimate(src,tmp,_info.width,_info.height);
-        lowPass(src,dst,_info.width,_info.height);
-        lowPass(tmp,src,_info.width&gt;&gt;1,_info.height&gt;&gt;1);
-
-        if (_conf-&gt;_useBackgroundColor) 
-        {
-                decimate(_bgMaskBuffer,_bgBitmapBuffer,_info.width,_info.height);
-                //lowPass(tmp,_bgBitmapBuffer,_info.width&gt;&gt;1,_info.height&gt;&gt;1);
-        }
-  
-}
-/*
-        Clear the buffers in case we do a new sub or
-                redo one in case it overflows
-*/
-uint8_t ADMVideoSubtitle::clearBuffers(void)
-{
-        memset(_bitmapBuffer,0,_info.height*_info.width);
-        memset(_maskBuffer,0,_info.height*_info.width);
-        memset(_bgBitmapBuffer,0,(_info.height*_info.width)&gt;&gt;1);
-        memset(_bgMaskBuffer,0,_info.height*_info.width);
-        return 1;
-}
-// Display a full line centered on screen. It returns the
-// number of displayed chars.
-//____________________________________________________________
-
-// It also returns the suggested len for this line string (just when display fail)
-//
-uint32_t ADMVideoSubtitle::displayLine(ADM_GLYPH_T *string,uint32_t line, uint32_t len)
-{
-  // n first chars in string that can &quot;fit&quot; in this line
- 
-
-	//uint32_t pixstart;
-	uint8_t *target;
-	int car;
-
-
-	aprintf(&quot;Sub DisplayString  line %lu len %lu\n&quot;,line,len);
-
-	if(!len)
-	{
-		printf(&quot;\n null string\n&quot;);
-      		return 0;
-	}
-
-
-  
-	uint32_t w=0,next;
-	int ww;
-
-	// we dummy do it one time to get the actual width of the string
-	// and hence perfectly center it
-	target=_maskBuffer+_info.width*line;
-	for(uint32_t i=0;i&lt;len;i++)
-	{
-			if(ADM_ASC(*(string+i))==' ')
-			{
-					w+=_conf-&gt;_fontsize&gt;&gt;2;
-			}
-			else
-			{
-				ww=0;
-				car=string[i];
-				if(i) next=string[i-1];
-					else next=0;
-				// Change ' to &quot;
-				//if(ADM_ASC(car)==0x27)
-				//	car=0x22;
-	        		if(!_font-&gt;fontDraw((char *)(target+1+w),car,next , _info.width,_conf-&gt;_fontsize,&amp;ww))
-				{
-					printf(&quot;Font error\n&quot;);
-              return 0;
-				}
-				if((ww&lt;0)||(ww&gt;64))
-				{
-					printf(&quot;Warning w out of bound (%d)\n&quot;,ww);
-					ww=0;
-				}
-				if(w+ww&gt;_info.width)
-				{
-					printf(&quot;Line too long!\n&quot;);
-					len=i;
-					goto _abt;
-					break;
-				}
-				w=w+ww;
-			}
-      
-	}
-_abt:
-	//Now we can render it at its final position
-	if(w&lt;_info.width)
-	{
-		target=_bitmapBuffer+_info.width*line+((_info.width-w)&gt;&gt;1);
-	}
-	else
-	{
-		target=_bitmapBuffer+_info.width*line+1;
-	}
-
-  //printf(&quot;[debug] line %s\n&quot;,string);
-
-	ww=0;
-	w=0;
-	for(uint32_t i=0;i&lt;len;i++)
-	{
-			if(*(string+i)==' ')
-			{
-					w+=_conf-&gt;_fontsize&gt;&gt;2;
-
-			}
-			else
-			{
-				ww=0;
-				car=string[i];
-				if(i) next=string[i-1];
-					else next=0;
-	        		if(!_font-&gt;fontDraw((char *)(target+1+w),car,next , _info.width,_conf-&gt;_fontsize,&amp;ww))
-				{
-					printf(&quot;Font error\n&quot;);
-              return 0;
-				}
-				if((ww&lt;0)||(ww&gt;64))
-				{
-					printf(&quot;Warning w out of bound (%d)\n&quot;,ww);
-					ww=0;
-				}
-				w=w+ww;
-			}
-      
-	}
-
-  {
-    if (_conf-&gt;_useBackgroundColor) {
-      //Create background info
-      
-      int32_t delta=_info.width*line+((_info.width-w)&gt;&gt;1);
-      uint8_t *bitmapTarget=_bitmapBuffer+delta;
-      uint8_t *maskTarget=_maskBuffer+delta;
-      //uint8_t *bgBitmapTarget=_bgBitmapBuffer+delta;
-      uint8_t *bgMaskTarget=_bgMaskBuffer+delta;
-      
-      delta=3*_info.width;
-      bitmapTarget+=delta;
-      maskTarget+=delta;
-      //bgBitmapTarget+=delta;
-      bgMaskTarget+=delta;
-      
-      for (uint32_t i=0;i&lt;_conf-&gt;_fontsize;i++) {
-	//memset(bgTarget,1,w);
-	for (uint32_t j=0;j&lt;w;j++) {
-	  if (*(bitmapTarget+j)==0) {
-	    *(bgMaskTarget+j)=1;   //at this position, we will apply a different color
-	    //*(bgBitmapTarget+j)=1;
-	    *(maskTarget+j)=0;
-	    *(bitmapTarget+j)=0;
-	  }
-	}
-	bgMaskTarget+=_info.width;
-	//bgBitmapTarget+=_info.width;
-	maskTarget+=_info.width;
-	bitmapTarget+=_info.width;
-      }
-
-    }
-  }
-	
-
- 
-  return len;
-}
-//--------------------------------------------------------------------
-//
-//	Blend bitmap buffer into final screen
-//      We scan the SRT_MAX_LINE last line
-//--------------------------------------------------------------------
-uint8_t ADMVideoSubtitle::blend(uint8_t *target,uint32_t baseLine)
-{
-
-	uint8_t  *mask; //*oldtarget=target,*
-  uint8_t  *bgMask;
-	int8_t *chromatarget;
-	uint32_t hei,start;
-	uint32_t y;
-	uint32_t val;
-	int32_t ssigned;
-	double alpha,alpha2;
-#define SHADOW_UP 	8
-#define SHADOW_DOWN 	16
-
-	hei=(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
-	if(hei&gt;=_info.height-1) hei=_info.height-1;
-	hei*=_info.width;  // max height of our subtitle
-	
-
-	aprintf(&quot;Sub:Rendering : %d %d %d (yuv)\n&quot;,_conf-&gt;_Y_percent,_conf-&gt;_U_percent,_conf-&gt;_V_percent);
-	
-	// keep a little margin for renderin
-	// to render f y or g
-	if((baseLine) &gt; _conf-&gt;_fontsize)
-		baseLine-=_conf-&gt;_fontsize&gt;&gt;1;
-	
-		
-	//__________________________
-		
-		// Shadow ..
-		uint8_t *shadow=target;
-		uint32_t shadow_pos;
-		
-		shadow_pos=_conf-&gt;_fontsize/10;
-		start=_info.width*baseLine;  // base line in final image
-		// mask out left and right
-		mask=_maskBuffer; 
-				
- 		shadow+=start+(1+_info.width)*shadow_pos;
-  		for( y=hei;y&gt;0;y--)
-		{
-     		 if(*mask) 
-		 {
-				if(*mask&gt;LUMA_LEVEL)
-				{
-					val=*shadow;
-					val=(val*SHADOW_UP)/SHADOW_DOWN;
-					*shadow=(uint8_t )val;
-				}				
-     		 } 	  
-      
-		shadow++;
-		mask++;
-		}
-	
-	// /Shadow
-	//__________________________
-	start=_info.width*baseLine;  // base line in final image
-
-	chromatarget=(int8_t *)(target+(_info.width*_info.height));
-
-	// mask out left and right
-
-	mask=_maskBuffer;
-  	bgMask=_bgMaskBuffer;
- 	target+=start;
-        // clip 
-        if(hei+start&gt;_info.width*_info.height)
-        {
-                hei=_info.width*_info.height-start;
-        }
-// Luma
-        int bottom=baseLine+(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
-        if(bottom&gt;_info.height) bottom=_info.height;
-        for( y=baseLine;y&lt;bottom;y++)
-        {
-            if(!_dirty[y-baseLine])
-            {
-                target+=_info.width;
-                mask+=_info.width;
-                bgMask+=_info.width;
-                 continue;
-            }
-            for(int x=0;x&lt;_info.width;x++)
-            {
-                if(*mask) {
-                                if(*mask&gt;LUMA_LEVEL || _conf-&gt;_useBackgroundColor)
-                                {
-                                        val=*mask*_conf-&gt;_Y_percent+128;
-                                        val&gt;&gt;=8;
-                                        *target=(uint8_t )val;
-                                }
-                                else 
-                                        { *target=0; }
-                        } else 
-                        if(*bgMask)
-                        {
-                                if(_conf-&gt;_useBackgroundColor) 
-                                {
-                                        *target=(uint8_t )_conf-&gt;_bg_Y_percent;
-                                }
-                        }
-                        else
-                                {
-                                        switch(_conf-&gt;_blend)
-                                        {
-                                                case BLEND_SOLID: break;
-                                                case BLEND_DIMMER: *target=(*target*3)&gt;&gt;2;break;
-                                                case BLEND_DOTTED: 
-                                                {
-                                                        int odd;
-                                                                odd= y%_info.width;
-                                                                odd=odd&amp;1;
-                                                                odd+=(1&amp;(y/_info.width));
-                                                                odd&amp;=1;
-                                                                if(odd) *target=0; 
-                                                }
-                                        }
-                                }
-                        
-                target++;
-                mask++;
-                bgMask++;
-              }
-        }
-	
-
-// do u &amp; v
-	int8_t *ctarget;
-
-	baseLine&amp;=0xffffe;
-	start=(_info.width*baseLine)&gt;&gt;2;
-	hei&gt;&gt;=2;
-
-	mask=_bitmapBuffer;
-  	bgMask=_bgBitmapBuffer;
-	ctarget=chromatarget+start;
-	target=(uint8_t *)ctarget;
-
-	ssigned=_conf-&gt;_U_percent;
-	ssigned+=128;
-
-  uint8_t bg_val=(uint8_t) _conf-&gt;_bg_U_percent+128;
-
-//#define MAXVAL(x) {val=*mask*(x)+127;val&gt;&gt;=8;*ctarget=(uint8_t)(val&amp;0xff);}
-
-#define BLEND_LEVEL 	3
-#define BLEND_PERCENT 	20
-
-#define MAXVAL(x)  *target=(uint8_t )ssigned
-#define DOIT if(*mask) \
-		{ \
-			alpha=*mask; \
-			if(alpha&gt;BLEND_LEVEL) \
-				*target=(uint8_t)ssigned; \
-			else			\
-			{			\
-				alpha2=(100-BLEND_PERCENT)*(*target-128); \
-				alpha=BLEND_PERCENT*(ssigned-128); \
-				alpha=(alpha2+alpha)/100; \
-				*target=(uint8_t)(alpha+128) ;\
-			} \
-                } \
-             else if (_conf-&gt;_useBackgroundColor &amp;&amp; *bgMask) {*target=(uint8_t)bg_val;}
-	     
-#define RENDER	     \
-	\
-	for( y=hei;y&gt;0;y--) \
-	{ \
-		DOIT; \
-		ctarget++; \
-		target++; \
-		mask++; \
-	bgMask++; \
-	} \
-	
-	RENDER;
-
-	mask=_bitmapBuffer;
-  	bgMask=_bgBitmapBuffer;
-	ctarget=chromatarget+start+((_info.width*_info.height)&gt;&gt;2);;
-	target=(uint8_t *)ctarget;
-	ssigned=_conf-&gt;_V_percent;
-	ssigned+=128;
-
-  	bg_val=(uint8_t) _conf-&gt;_bg_V_percent+128;
-
-	RENDER;
-
-
-	return 1;
-}
-//
-//	Apply a low pass to alias it
-//					1
-// The softening is a 1 4 1  convolution filter
-//					1
-uint8_t ADMVideoSubtitle::lowPass(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h)
-{
-	uint8_t *prevline, *nextline,*curline,*target;
-	uint32_t val;
-
-	memcpy(dst,src,w*h);
-
-	src++;dst++;
-
-			for(uint32_t line=h-1;line&gt;0;line--)
-			{
-				curline=src+line*w;
-				nextline=curline+w;
-				prevline=curline-w;
-				target=dst+line*w;
-				for(uint32_t col=w-1;col&gt;1;col--)
-				{
-#define LEVEL 8*90
-					// 1 4 1
-					val= (*(curline)*4+*prevline+*nextline+*(curline-1)+*(curline+1));
-					if(val&gt; 0 )
-					if(val&lt;LEVEL)
-						val=1;  // just enough to trigger masking
-					else
-						val&gt;&gt;=3;
-					*target=val;
-					target++;
-					curline++;
-					prevline++;
-					nextline++;
-				}
-
-			}
-	return 1;
-}
-//
-//	Decimate 2x2 (luma-&gt;chroma)
-//					1
-//					1
-uint8_t ADMVideoSubtitle::decimate(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h)
-{
-	uint8_t	*curline, *nextline;
-	uint8_t *target=dst;
-
-			for(uint32_t line=0;line&lt;h&gt;&gt;1;line++)
-			{
-				curline=src+line*w*2;
-				nextline=curline+w;
-				target=dst+line*(w&gt;&gt;1);
-				for(uint32_t col=0;col&lt;w&gt;&gt;1;col++)
-				{
-					// 1 4 1
-					*target= (*(curline)+*(curline+1)+*nextline+*(nextline+1))&gt;&gt;2;
-					target++;
-					curline+=2;
-					nextline+=2;
-				}
-
-			}
-	return 1;
-}
-
-#endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,490 +0,0 @@
-/***************************************************************************
-                          ADM_vidload.cpp  -  description
-                             -------------------
-
-	Load the subtitles either in srt or sub format
-
-	The structure is
-		uint32_t 		startTime in ms from beginning
-		uint32_t 		endTime  in ms from beginning
-	
-	All text are stored as utf16 after loading
-
-
-    begin                : Thu Aug 09 2003
-    copyright            : (C) 2003 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-
-#ifdef USE_FREETYPE
-#include &lt;math.h&gt;
-#include &lt;iconv.h&gt;
-#include &lt;errno.h&gt;
-
-//#define __STDC_ISO_10646__
-
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_videoFilter.h&quot;
-
-#include &quot;ADM_video/ADM_vidFont.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_FILTER
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-
-#define ADM_RAW 1024
-
-static iconv_t myConv=(iconv_t)-1;;
-static int ADM_SubAtoi(uint16_t *in);
-
-static uint8_t	ADM_utfInit( char *charset );
-static uint8_t ADM_utfConv(ADM_GLYPH_T *out, char *in,uint32_t nbIn, uint32_t *nbOut);
-static uint8_t ADM_utfEnd( void);
-
-
-
-
-uint8_t	ADMVideoSubtitle::loadFont (void)
-{
- 
-  if (!_font-&gt;initFreeType ((char *)_conf-&gt;_fontname))
-    {
-      printf (&quot;\n Free type init failed for font %s!&quot;, _conf-&gt;_fontname);
-    }
-  else
-    {
-      _font-&gt;fontSetSize (_conf-&gt;_fontsize);
-    }
-   
-  return 1;
-}
-
-//
-//      Load subtitles in .sub format i.e. {xx}{yy} |   |
-//
-// {3610}{3656}Pripraven&#65533;uv&#65533;a ich|v naom dome s primeranou ctou.
-//__________________________________________________________________
-uint8_t  ADMVideoSubtitle::loadSubTitle (void)
-{
-
-  char string[500];
-  uint32_t current_line = 0;
-  // first cound how many line
-  _line = 0;
-   // init iconv...  
-  if(! ADM_utfInit(_conf-&gt;_charset))
-  {
-  	printf(&quot;Problem initializing iconv, aborting\n&quot;);
-	return 0;
-  
-  }
-  while (fgets (string, 200, _fd))
-    {
-      _line++;
-    }
-  printf (&quot;\n subs : %ld lines\n&quot;, _line);
-  // rewind
-  fseek (_fd, 0, SEEK_SET);
-  //
-  _subs = new subLine[_line];
-  if (!_subs)
-    return 0;
-  memset (_subs, 0, sizeof (subLine) * _line);
-
-
- 
-//	
-  for (uint32_t i = 0; i &lt; _line; i++)
-    {
-      fgets (string, ADM_RAW, _fd);
-      //printf(&quot;\n in : %s &quot;,string);
-      if (string[0] != '{')
-	continue;
-      subParse ((subLine *) &amp; (_subs[current_line]), string);
-      current_line++;
-    }
-	
-  // the effective number of line we have
-  _line = current_line;
-  return 1;
-  
- ADM_utfEnd( );
-}
-
-//___________________________________________________________________
-//      In case of sub file, take one line and convert it to unicode
-//	we also extract the start/end and split it to N lines
-//	Does not work if input is UTF16. UTF8 is ok.
-//___________________________________________________________________
-uint8_t	ADMVideoSubtitle::subParse (subLine * in, char *string)
-{
-
-
-  static ADM_GLYPH_T 	final[ADM_RAW];	// convert to unicode
-  uint32_t   	startindex, endindex,textindex;
-  uint32_t 	j;
-  float 	f;
- 
-  uint32_t 	finallen=0;
-  uint32_t	alpha;
- 
-  j = 1;
-  
-  
-  ADM_utfConv(final,string,strlen(string),&amp;finallen);
-  
-  // ignore { }
-  while (ADM_ASC(final[j]) != '}' &amp;&amp; j &lt; finallen)
-    j++;
- 
-  startindex =1;
-  j += 2;			// skip }{
-  endindex =j;
-  while (ADM_ASC(final[j]) != '}' &amp;&amp; j &lt; finallen)
-    j++;
-  // The text starts here
-  textindex = j + 1;
-
-  if (j &gt;= finallen - 1)
-    {
-      printf (&quot;***ERR: Suspicious line !!!\n&quot;);
-      return 0;
-
-    }
-
-  // convert frame -&gt; time in ms
-  // skip utf marker if present
-  alpha= ADM_SubAtoi (&amp;final[1]);
-  f=(float)alpha;
-  aprintf(&quot;%s start:%d&quot;,string,alpha);
-  f = f * 1000000. / _info.fps1000;
-  in-&gt;startTime = (uint32_t) floor (f);
-
-  alpha = ADM_SubAtoi (&amp;final[endindex]);
-  f=(float)alpha;
-  aprintf(&quot; end:%d\n&quot;,alpha);
-  f = f * 1000000. / _info.fps1000;
-  
-  in-&gt;endTime = (uint32_t) floor (f);
-
-  uint32_t lllines=0;
-  finallen-=textindex;
-  if(finallen==0)
-  	{
-		printf(&quot;Empty line\n&quot;);
-		in-&gt;nbLine=0;
-		return 1;
-	}
-  // Count the number of | found
-  for(j=0;j&lt;finallen;j++)
-  {
-  	if(ADM_ASC(final[j+textindex])=='|') lllines++;
-  }
-
-  aprintf(&quot;%lu --&gt;%lu\n&quot;,in-&gt;startTime,in-&gt;endTime);
-  in-&gt;nbLine=lllines+1;
-  in-&gt;string=new ADM_GLYPH_T *[in-&gt;nbLine];
-  in-&gt;lineSize=new uint32_t[in-&gt;nbLine];
-  
-  for(uint32_t i=0;i&lt;in-&gt;nbLine;i++)
-  {
-  	in-&gt;string[i]=new ADM_GLYPH_T[finallen]; 	// yes, we overshot
-	in-&gt;lineSize[i]=0;
-  }
-  
-  uint32_t curline=0, curindex=0;
-  for(uint32_t i=0;i&lt;finallen;i++)
-  {
-  	if(ADM_ASC(final[i+textindex])=='|')
-	{
-		in-&gt;lineSize[curline]=curindex;
-		curindex=0;
-		curline++;		
-	}
-	else
-	{
-		in-&gt;string[curline][curindex++]=final[i+textindex];
-	}
-  
-  }  
-  if(curindex)
-  	in-&gt;lineSize[curline]=curindex;
-  return 1;
-}
-
-//
-//      Load subtitles in .srt format i.e. {xx}{yy} |   |
-//__________________________________________________________________
-uint8_t
-ADMVideoSubtitle::loadSRT (void)
-{
-
-
-  static ADM_GLYPH_T 	final[ADM_RAW];	// convert to unicode
-  ADM_GLYPH_T  		temp[SRT_MAX_LINE][ADM_RAW];
-  uint32_t		tempSize[SRT_MAX_LINE];
-  char			string[ADM_RAW];
-  
-  
-  uint32_t line;  
-  uint32_t len;
-  // Init iconv
-   uint32_t 	finallen=0;
-  subLine	*current;
-  
-  if(! ADM_utfInit(_conf-&gt;_charset))
-  {
-  	printf(&quot;Problem initializing iconv, aborting\n&quot;);
-	return 0;
-  
-  } 
-  
-  // first cound how many line
-  line = 0;
-  _line = 0;
-  while (fgets (string, 300, _fd))
-    line++;
-  printf (&quot;\n subs : %ld lines\n&quot;, line);
-  // rewind
-  fseek (_fd, 0, SEEK_SET);
-  //
-  _subs = new subLine[line];
-
-  if (!_subs)
-    return 0;
-  
-  memset (_subs, 0, sizeof (subLine) * line);
-  
-  // read and allocate
-  
-  uint32_t j;
-  int state = 0;
-  int stored=0;
-  
-  for (uint32_t i = 0; i &lt; line; i++)
-    {
-	current=&amp;_subs[_line];
-	fgets (string, ADM_RAW, _fd);
-	ADM_utfConv(final,string,strlen(string),&amp;finallen);
-	// Purge cr/lf	
-	switch (state)
-	{
-	case 0:		// waiting for number	 
-                  if(!_line &amp;&amp; (final[0]&amp;0xfefe)==0xfefe)
-                  {
-                      j=ADM_SubAtoi (final+1);
-                  }
-                  else
-		      j = ADM_SubAtoi (final);
-		if (j == _line + 1)
-		{
-			stored=0;
-			state = 1;
-		}
-		break;
-	case 1:		// waiting for time
-		{
-			uint32_t sh, sm, ss, ms;
-			uint32_t dh, dm, ds, md;
-
-			ADM_GLYPH_T *cur=&amp;final[0];
-				
-	  		sh=ADM_SubAtoi(cur);
-			cur+=3;
-			sm=ADM_SubAtoi(cur);
-			cur+=3;
-			ss=ADM_SubAtoi(cur);
-			cur+=3;
-			ms=ADM_SubAtoi(cur);
-			cur+=3;
-			
-			cur+=5;
-			
-			dh=ADM_SubAtoi(cur);
-			cur+=3;
-			dm=ADM_SubAtoi(cur);
-			cur+=3;
-			ds=ADM_SubAtoi(cur);
-			cur+=3;
-			md=ADM_SubAtoi(cur);
-			
-			_subs[_line].startTime = ms + 1000 * (ss + sm * 60 + sh * 3600);
-			_subs[_line].endTime = md + 1000 * (ds + dm * 60 + dh * 3600);
-			state = 2;
-			
-			aprintf(&quot;%d %d %d %d / %d %d %d %d&gt;%s&lt;\n&quot;,sh,sm,ss,ms,dh,dm,ds,md,string);
-			
-		}
-
-		break;
-	case 2:		
-	   // looking for text
-	   // We append each line to text with a | to separate the lines	 	  
-	  {
-	  	if (finallen &lt; 2)
-	    	{
-	   		// Finished
-	      		_line++;
-	      		state = 0;
-			current-&gt;nbLine=stored;
-			current-&gt;lineSize=new uint32_t[stored];
-			current-&gt;string=new ADM_GLYPH_T *[stored];
-			for(uint32_t i=0;i&lt;stored;i++)
-			{
-				current-&gt;lineSize[i]=tempSize[i];
-				current-&gt;string[i]=new ADM_GLYPH_T[tempSize[i]];
-				memcpy(current-&gt;string[i],temp[i],sizeof(ADM_GLYPH_T)*tempSize[i]);
-			}
-	      		break;
-	    	}
-	  	else
-	    	{
-			if(stored&gt;=SRT_MAX_LINE)
-			{
-				printf(&quot;sub:Too much lines, ignoring..\n&quot;);
-				continue;
-			}
-	      		// We add it
-			memcpy(temp[stored],final,finallen*sizeof(ADM_GLYPH_T));
-			tempSize[stored]=finallen;
-			stored++;
-	    	}
-	  }
-	  break;
-
-	}
-
-    }
-  ADM_utfEnd( );
-  aprintf(&quot;&gt;&gt; Sub: %d subs stored and loaded\n&quot;,_line); 	
-  return 1;
-  
-}
-// Sort of atoi for utf16
-// Very basic
-int ADM_SubAtoi(uint16_t *in)
-{
-	int result=0;
-	int d;
-	do
-	{
-		d=ADM_ASC(*in);		
-		in++;
-		if(d&gt;='0' &amp;&amp; d&lt;='9')
-		{
-			result*=10;
-			result+=d-'0';
-		}
-		else
-			return result;
-	}while(1);
-	
-
-}
-//	Init iconv, so that we can go utf16
-//
-uint8_t	ADM_utfInit( char *charset )
-{
-	myConv=iconv_open(&quot;UTF-16&quot;,charset); //&quot;WINDOWS-1251&quot;);
-	if((long int)myConv==-1)
-	{
-		printf(&quot;\n Error initializing iconv...\n&quot;);
-		return  0;
-	}
-	return 1;
-}
-//
-//	Convert the incoming string to utf16
-//	While doing it, remove the utf16 makers from input/output
-//	(fffe)
-//
-uint8_t ADM_utfConv(ADM_GLYPH_T *out, char *in,uint32_t nbIn, uint32_t *nbOut)
-{
-size_t sin,sout,sz;
-char *cout,*cin;
-uint32_t done=0;
-
-	memset(out,0,ADM_RAW*sizeof(ADM_GLYPH_T));
-	sin=strlen(in);
-	sout=ADM_RAW;
-	cin=in;
-	cout=(char *)(out);
-	
-	if((uint8_t)in[0]==0xff &amp;&amp; (uint8_t)in[1]==0xfe)
-	{
-		 cin+=2;
-		 sin-=2;
-	}
-	if(!sin) 
-	{
-		*nbOut=0;
-		return 1;
-	}
-#ifdef  ICONV_NEED_CONST 
-  	sz=iconv(myConv,(const char **)&amp;cin,&amp;sin,&amp;cout,&amp;sout);
-#else
-	sz=iconv(myConv,&amp;cin,&amp;sin,&amp;cout,&amp;sout);
-#endif	
-	if(sz==-1)
-	{
-  		printf(&quot;Iconv error:%s\n:%s:\n&quot;,strerror(errno),in);
-		//out[0]=' ';
-  	}
-	// Get the amound of utf16...
-	done=(ADM_RAW-sout)&gt;&gt;1;
-
-#if defined(__WIN32) || defined(ADM_BSD_FAMILY)
-	// For Win32 and BSD we swap le and be
-
-       ADM_GLYPH_T glyph;
-       for(uint32_t w=0;w&lt;done;w++)
-       {
-               glyph=out[w];
-               out[w]=((glyph&amp;0xff)&lt;&lt;8)+(glyph&gt;&gt;8);
-       }
-#endif
-	
-	if(done)
-	{
-		if(0xfeff==out[0])
-		{
-			//aprintf(&quot;Removing utf tag\n&quot;);
-			done--;
-			memmove(&amp;out[0],&amp;out[1],done*sizeof(ADM_GLYPH_T));
-			
-		}
-	}
-
-	while(done &amp;&amp;( ADM_ASC(out[done-1])==0x0a || ADM_ASC(out[done-1]==0x0d))) done--;
-	*nbOut=done;
-	return 1;
-	
-}
-// Close iconv
-//
-
-uint8_t ADM_utfEnd( void)
-{
-  // Purge iconv
-  if((long int)myConv!=-1)
-	{
-		iconv_close(myConv);
-		myConv=(iconv_t)-1;
-	}
-}
-
-
-#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -5,9 +5,6 @@
 	ADM_vidAnimated.cpp
 	ADM_vidDvbSub.cpp
 	ADM_vidHue.cpp
-	ADM_vidSRT.cpp
-	ADM_vidSRTload.cpp
-	ADM_vidSRTRender.cpp
 	ADM_vidCrop.cpp
 	ADM_vidEq2.cpp
 	ADM_vidContrast.cpp
@@ -20,9 +17,10 @@
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_videoFilter ${ADM_videoFilter_SRCS})
 
-
+if(false)
 IF (USE_FREETYPE)
 	ADD_SOURCE_CFLAGS(ADM_vidSRT.cpp &quot;${FREETYPE2_CFLAGS}&quot;)
 	ADD_SOURCE_CFLAGS(ADM_vidSRTload.cpp &quot;${FREETYPE2_CFLAGS}&quot; &quot;-I${LIBICONV_INCLUDE_DIR}&quot;)
 	ADD_SOURCE_CFLAGS(ADM_vidSRTRender.cpp &quot;${FREETYPE2_CFLAGS}&quot;)
 ENDIF (USE_FREETYPE)
+endif(false)

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,95 @@
+/**/
+/***************************************************************************
+                          DIA_Asharp
+                             -------------------
+
+                           Ui for Asharp
+
+    begin                : 08 Apr 2005
+    copyright            : (C) 2004/5 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_default.h&quot;
+
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyAsharp.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+/************* COMMON PART *********************/
+uint8_t  flyASharp::update(void)
+{
+    download();
+    process();
+	copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+uint8_t flyASharp::process(void)
+{
+uint8_t *src,*dst;
+uint32_t stride;
+int32_t T,D,B,B2;
+uint32_t ww,hh;
+
+
+                ww=_w;
+                hh=_h;
+                // parameters floating point to fixed point convertion
+                T = (int)(param.t*(4&lt;&lt;7));
+                D = (int)(param.d*(4&lt;&lt;7));
+                B = (int)(256-param.b*64);
+                B2= (int)(256-param.b*48);
+
+                // clipping (recommended for SIMD code)
+
+                if (T&lt;-(4&lt;&lt;7)) T = -(4&lt;&lt;7); // yes, negatives values are accepted
+                if (D&lt;0) D = 0;
+                if (B&lt;0) B = 0;
+                if (B2&lt;0) B2 = 0;
+
+                if (T&gt;(32*(4&lt;&lt;7))) T = (32*(4&lt;&lt;7));
+                if (D&gt;(16*(4&lt;&lt;7))) D = (16*(4&lt;&lt;7));
+                if (B&gt;256) B = 256;
+                if (B2&gt;256) B2 = 256;
+
+
+                memcpy(YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),ww*hh);
+                memcpy(UPLANE(_yuvBufferOut),UPLANE(_yuvBuffer),ww*hh/4);
+                memcpy(VPLANE(_yuvBufferOut),VPLANE(_yuvBuffer),ww*hh/4);
+                asharp_run_c(     _yuvBufferOut-&gt;GetWritePtr(PLANAR_Y),
+                        _yuvBufferOut-&gt;GetPitch(PLANAR_Y), 
+                        hh,
+                        ww,
+                        T,
+                        D,
+                        B,
+                        B2,
+                        param.bf);
+    
+    // Copy back half source to display
+    dst=_yuvBufferOut-&gt;data;
+    src=_yuvBuffer-&gt;data;
+    stride=ww;
+    for(uint32_t y=0;y&lt;hh;y++)   // We do both u &amp; v!
+    {
+        memcpy(dst,src,stride&gt;&gt;1);
+        dst+=stride;
+        src+=stride;
+    }
+    return 1;
+}
+//EOF

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/DIA_flyAsharp.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,18 @@
+
+
+#ifndef FLY_ASHARP_H
+#define FLY_ASHARP_H
+class flyASharp : public ADM_flyDialog
+{
+  
+  public:
+   ASHARP_PARAM  param;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    update(void);
+   flyASharp (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
+};
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/gtk/DIA_asharp.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/gtk/DIA_asharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,291 @@
+/**/
+/***************************************************************************
+                          DIA_hue
+                             -------------------
+
+                           Ui for hue &amp; sat
+
+    begin                : 08 Apr 2005
+    copyright            : (C) 2004/5 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+
+#include &quot;ADM_toolkitGtk.h&quot;
+
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyAsharp.h&quot;
+
+
+uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in);
+
+static GtkWidget        *create_dialog1 (void);
+static gboolean         draw (void );
+static void             upload(void);
+static void             download(void);
+static void             frame_changed( void );
+static void             hue_changed( void);
+
+static int lock=0;
+static GtkWidget *dialog=NULL;
+static flyASharp *myCrop=NULL;
+
+//
+//      Video is in YV12 Colorspace
+//
+//
+uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in)
+{
+      uint32_t width,height;
+      uint8_t ret=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;ASHARP&quot;));
+        gtk_widget_show(dialog);
+
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
+            GTK_SIGNAL_FUNC(draw),
+            NULL);
+//
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonT)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonD)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(spinbuttonB)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
+        gtk_widget_show(dialog);
+
+          
+        myCrop=new flyASharp( width, height,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(ASHARP_PARAM));
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            memcpy(param,&amp;(myCrop-&gt;param),sizeof(ASHARP_PARAM));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+void hue_changed( void)
+{
+  if(lock) return;
+  
+   myCrop-&gt;update();
+  
+}
+void frame_changed( void )
+{
+  myCrop-&gt;sliderChanged();
+}
+gboolean draw (void)
+{
+    myCrop-&gt;display();
+}
+//
+#define SPIN_GET(x,y) {param.x= gtk_spin_button_get_value(GTK_SPIN_BUTTON(WID(y))) ;}
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(y)),(gfloat)param.x) ;}
+
+#define CHECK_GET(x,y) {param.x=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(y)));}
+#define CHECK_SET(x,y) {gtk_toggle_button_set_active( GTK_TOGGLE_BUTTON(WID(y)),param.x);}
+
+void upload( void)
+{
+    myCrop-&gt;upload();
+}
+void download (void)
+{
+     myCrop-&gt;download();
+}
+/**************************************/
+uint8_t flyASharp::upload(void)
+{
+    lock++;
+        SPIN_SET(t,spinbuttonT);
+        SPIN_SET(d,spinbuttonD);
+        SPIN_SET(b,spinbuttonB);
+
+        CHECK_SET(bf,checkbuttonBF);
+    lock--;
+        return 1;
+}
+uint8_t flyASharp::download (void)
+{
+    
+        SPIN_GET(t,spinbuttonT);
+        SPIN_GET(d,spinbuttonD);
+        SPIN_GET(b,spinbuttonB);
+
+        CHECK_GET(bf,checkbuttonBF);
+        return 1;
+}
+
+/**************************************************/
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *table1;
+  GtkWidget *label1;
+  GtkWidget *label2;
+  GtkWidget *label3;
+  GtkWidget *label4;
+  GtkObject *spinbuttonT_adj;
+  GtkWidget *spinbuttonT;
+  GtkObject *spinbuttonD_adj;
+  GtkWidget *spinbuttonD;
+  GtkObject *spinbuttonB_adj;
+  GtkWidget *spinbuttonB;
+  GtkWidget *checkbuttonBF;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;ASharp by MarcFD&quot;));
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  table1 = gtk_table_new (4, 2, FALSE);
+  gtk_widget_show (table1);
+  gtk_box_pack_start (GTK_BOX (vbox1), table1, TRUE, TRUE, 0);
+
+  label1 = gtk_label_new (QT_TR_NOOP(&quot;Threshold :&quot;));
+  gtk_widget_show (label1);
+  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
+
+  label2 = gtk_label_new (QT_TR_NOOP(&quot;Strength :&quot;));
+  gtk_widget_show (label2);
+  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
+
+  label3 = gtk_label_new (QT_TR_NOOP(&quot;Block Adaptative :&quot;));
+  gtk_widget_show (label3);
+  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
+
+  label4 = gtk_label_new (QT_TR_NOOP(&quot;Unknown flag :&quot;));
+  gtk_widget_show (label4);
+  gtk_table_attach (GTK_TABLE (table1), label4, 0, 1, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
+
+  spinbuttonT_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
+  spinbuttonT = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonT_adj), 1, 1);
+  gtk_widget_show (spinbuttonT);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonT, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonT), TRUE);
+
+  spinbuttonD_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
+  spinbuttonD = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonD_adj), 1, 1);
+  gtk_widget_show (spinbuttonD);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonD, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonD), TRUE);
+
+  spinbuttonB_adj = gtk_adjustment_new (1, -1, 100, 0.5, 0.1, 0.1);
+  spinbuttonB = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonB_adj), 1, 1);
+  gtk_widget_show (spinbuttonB);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonB, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonB), TRUE);
+
+  checkbuttonBF = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot; &quot;));
+  gtk_widget_show (checkbuttonBF);
+  gtk_table_attach (GTK_TABLE (table1), checkbuttonBF, 1, 2, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonT, &quot;spinbuttonT&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonD, &quot;spinbuttonD&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonB, &quot;spinbuttonB&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonBF, &quot;checkbuttonBF&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
+
+  return dialog1;
+}
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,125 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;Q_asharp.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_asharpWindow::Ui_asharpWindow(ASHARP_PARAM *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyASharp( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(ASHARP_PARAM));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+#define SPINNER(x) connect( ui.doubleSpinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Treshold);
+          SPINNER(Strength);
+          SPINNER(Block);
+          connect( ui.checkBox,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int))); 
+
+  }
+  void Ui_asharpWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_asharpWindow::gather(ASHARP_PARAM *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(ASHARP_PARAM));
+  }
+Ui_asharpWindow::~Ui_asharpWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_asharpWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define MYSPIN(x) w-&gt;doubleSpinBox##x
+//************************
+uint8_t flyASharp::upload(void)
+{
+      Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
+
+        MYSPIN(Treshold)-&gt;setValue(param.t);
+        MYSPIN(Strength)-&gt;setValue(param.d);
+        MYSPIN(Block)-&gt;setValue(param.b);
+        
+        //w-&gt;bf-&gt;w-&gt;checkBox-&gt;isChecked();
+        w-&gt;checkBox-&gt;setChecked(param.bf);
+
+        return 1;
+}
+uint8_t flyASharp::download(void)
+{
+       Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
+       param.t= MYSPIN(Treshold)-&gt;value();
+       param.d= MYSPIN(Strength)-&gt;value();
+       param.b= MYSPIN(Block)-&gt;value();
+       
+       //w-&gt;spinBoxBottom-&gt;setValue(bottom);
+       param.bf=w-&gt;checkBox-&gt;isChecked();
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_asharpWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/Q_asharp.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,33 @@
+#ifndef Q_asharp_h
+#define Q_asharp_h
+
+#include &quot;ui_asharp.h&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyAsharp.h&quot;
+
+class Ui_asharpWindow : public QDialog
+{
+	Q_OBJECT
+
+protected: 
+	int lock;
+
+public:
+	flyASharp *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_asharpWindow(ASHARP_PARAM *param, AVDMGenericVideoStream *in);
+	~Ui_asharpWindow();
+	Ui_asharpDialog ui;
+
+public slots:
+	void gather(ASHARP_PARAM *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+};
+#endif	// Q_asharp_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/asharp.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/asharp.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ASharp/qt4/asharp.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,180 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;asharpDialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;asharpDialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;481&lt;/width&gt;
+    &lt;height&gt;454&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;ASharp&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;3&quot; column=&quot;3&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;3&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;3&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;3&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;6&quot; column=&quot;1&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;5&quot; column=&quot;0&quot; colspan=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Strength&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Threshold&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Block Adaptative&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBox&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Unknown flag&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxTreshold&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxStrength&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QDoubleSpinBox&quot; name=&quot;doubleSpinBoxBlock&quot; /&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;asharpDialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;asharpDialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/ADM_vidResize.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -193,11 +193,7 @@
 static int getResizeParams(uint32_t * w, uint32_t * h, uint32_t * algo,uint32_t ow,uint32_t oh,uint32_t fps);
 
 
-static uint8_t DIA_resize(uint32_t *width,uint32_t *height,uint32_t *algo,uint32_t originalw, uint32_t originalh,uint32_t fps1000)
-  {
-    
-      return 0;
-  }
+extern uint8_t DIA_resize(uint32_t *width,uint32_t *height,uint32_t *algo,uint32_t originalw, uint32_t originalh,uint32_t fps1000);
 
 uint8_t AVDMVideoStreamResize::configure(AVDMGenericVideoStream * instream)
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -4,14 +4,17 @@
 	ADM_resizebis.cpp  ADM_resizeter.cpp  ADM_vidResize.cpp
 )
 
+
+SET(resizeCommonGtk_SRCS gtk/gtk_resize.cpp)
+
+SET(resizeQt_SRCS qt4/Q_resize.cpp)
+SET(resizeQt_Headers qt4/Q_resize.h)
+SET(resizeQt_UI qt4/resizing)
+
 INCLUDE(vf_plugin_gtk)
 INCLUDE(vf_plugin_qt4)
 
-SET(resizeCommonGtk_SRCS gtk/gtk_resize.cpp)
-SET(resizeCommonQT_SRCS qt4/Q_resize.cpp)
-SET(resizeCommonQT_UI resizing)
-
 INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_avisynthResize_qt4 
-                ${resizeCommonQT_SRCS} ${resizeCommonQT_UI} ${avisynthResizeCommon_SRCS})
+                ${resizeQt_SRCS} ${resizeQt_Headers} ${resizeQt_UI} ${avisynthResizeCommon_SRCS})
 INIT_VIDEOFILTER_PLUGIN_GTK(ADM_vf_avisynthResize_gtk 
-                ${resizeCommonGtk_SRCS} ${avisynthResizeCommon_SRCS})
\ No newline at end of file
+                ${resizeCommonGtk_SRCS} ${avisynthResizeCommon_SRCS})

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/AvisynthResize/qt4/Q_resize.h
===================================================================

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -39,7 +39,7 @@
 ADD_SUBDIRECTORY(Soften)
 ADD_SUBDIRECTORY(lavDeinterlace)
 # Dependancy toward codecs ADD_SUBDIRECTORY(Logo)
-# Need flyDialog : ADD_SUBDIRECTORY(ChromaShift)
+ADD_SUBDIRECTORY(ChromaShift)
 ADD_SUBDIRECTORY(CNR2)
 ADD_SUBDIRECTORY(colorYUV)
 ADD_SUBDIRECTORY(Equalizer)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/ADM_vidChromaShift.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -16,10 +16,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;ADM_default.h&quot;
-
-
+#include &quot;DIA_flyDialog.h&quot;
 #include &quot;ADM_videoFilterDynamic.h&quot;
+
 #include &quot;ADM_vidChromaShift.h&quot;
 
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -10,11 +10,12 @@
 INCLUDE(vf_plugin_qt4)
 
 SET(chromashiftGtk_SRCS gtk/DIA_chromaShift.cpp)
-SET(chromashiftQT_SRCS Q_chromashift.cpp)
-SET(chromashiftQT_UI chromashift)
+SET(chromashiftQT_SRCS  qt4/Q_chromashift.cpp)
+SET(chromashiftQT_HEADERS  qt4/Q_chromashift.h)
+SET(chromashiftQT_UI    qt4/chromashift)
 
 INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_chromaShift_qt4 
-                ${chromashiftQT_SRCS} ${chromashiftQT_UI} ${chromashiftCommon_SRCS})
-INIT_VIDEOFILTER_PLUGIN_GTK(  ADM_vf__chromaShift_gtk 
+                ${chromashiftQT_SRCS} ${chromashiftQT_HEADERS} ${chromashiftQT_UI} ${chromashiftCommon_SRCS})
+INIT_VIDEOFILTER_PLUGIN_GTK(  ADM_vf_chromaShift_gtk 
                 ${chromashiftGtk_SRCS} ${chromashiftCommon_SRCS})
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -14,17 +14,17 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 #include &lt;string.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;math.h&gt;
+#include &quot;DIA_flyDialog.h&quot;
 #include &quot;ADM_default.h&quot;
 
 #include &quot;ADM_image.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidChromaShift.h&quot;
-#include &quot;ADM_videoFilter/ADM_vidChromaShift_param.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_videoFilterDynamic.h&quot;
+#include &quot;ADM_vidChromaShift.h&quot;
+#include &quot;ADM_vidChromaShift_param.h&quot;
+
 #include &quot;DIA_flyChromaShift.h&quot;
 
 /*********  COMMON PART *********/

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/DIA_flyChromaShift.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,6 +1,6 @@
 #ifndef FLY_CHROMASHIFT_H
 #define FLY_CHROMASHIFT_H
-class flyChromaShift : public ADM_flyDialog
+class flyChromaShift : public FLY_DIALOG_TYPE
 {
   
   public:
@@ -11,7 +11,7 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flyChromaShift (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
+                                    void *canvas, void *slider) : FLY_DIALOG_TYPE(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
 };
 
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -21,7 +21,7 @@
  ***************************************************************************/
 
 #include &quot;Q_chromashift.h&quot;
-
+#include &lt;math.h&gt;
 Ui_chromaShiftWindow::Ui_chromaShiftWindow(CHROMASHIFT_PARAM *param,AVDMGenericVideoStream *in)
   {
     uint32_t width,height;
@@ -112,6 +112,7 @@
         }
         return ret;
 }
+
 //____________________________________
 // EOF
 

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/ChromaShift/qt4/Q_chromashift.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,30 @@
+
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_vidChromaShift_param.h&quot;
+#include &quot;DIA_flyChromaShift.h&quot;
+
+#include &lt;math.h&gt;
+
+#include &quot;ui_chromashift.h&quot;
+class Ui_chromaShiftWindow : public QDialog
+ {
+     Q_OBJECT
+ protected : 
+    int lock;
+ public:
+     flyChromaShift *myCrop;
+     ADM_QCanvas *canvas;
+     Ui_chromaShiftWindow(CHROMASHIFT_PARAM *param,AVDMGenericVideoStream *in);
+     ~Ui_chromaShiftWindow();
+     Ui_chromashiftDialog ui;
+ public slots:
+      void gather(CHROMASHIFT_PARAM *param);
+      //void update(int i);
+ private slots:
+   void sliderUpdate(int foo);
+   void valueChanged(int foo);
+
+ private:
+     
+ };
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,60 @@
+/***************************************************************************
+                          ADM_guiContrast.cpp  -  description
+                             -------------------
+    begin                : Mon Sep 23 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_default.h&quot;
+
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyContrast.h&quot;
+/************* COMMON PART *********************/
+uint8_t  flyContrast::update(void)
+{
+    download();
+    process();
+	copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+// Ugly !
+static uint8_t tableluma[256], tablechroma[256];
+
+uint8_t flyContrast::process(void)
+
+{
+  buildContrastTable (param.coef, param.offset, tableluma, tablechroma);
+
+  memcpy (_yuvBufferOut-&gt;data, _yuvBuffer-&gt;data, (_h * _w * 3)&gt;&gt;1);
+  if (param.doLuma)
+    {
+      doContrast (YPLANE(_yuvBuffer), YPLANE(_yuvBufferOut), tableluma, _w, _h);
+    }
+  if (param.doChromaU)
+    {
+      doContrast (UPLANE(_yuvBuffer), UPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
+    }
+
+  if (param.doChromaV)
+    {
+     doContrast (VPLANE(_yuvBuffer), VPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
+    }
+    return 1;
+}
+/************* COMMON PART *********************/

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/DIA_flyContrast.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,22 @@
+
+
+#ifndef FLY_CONTRAST_H
+#define FLY_CONTRAST_H
+class flyContrast : public ADM_flyDialog
+{
+  
+  public:
+   CONTRAST_PARAM  param;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    update(void);
+   flyContrast (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO)
+                    {
+                      
+                    };
+};
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/gtk/DIA_contrast.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/gtk/DIA_contrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,273 @@
+/***************************************************************************
+                          DIA_contrast.cpp  -  description
+                             -------------------
+    begin                : Mon Sep 23 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;ADM_toolkitGtk.h&quot;
+#include &quot;fourcc.h&quot;
+
+
+
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
+
+
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyContrast.h&quot;
+
+/********************************************************************/
+static GtkWidget *create_dialog1 (void);
+static GtkWidget *dialog = NULL;
+
+static gboolean gui_draw (GtkWidget * widget,
+			  GdkEventExpose * event, gpointer user_data);
+static void gui_update (GtkButton * button, gpointer user_data);
+static void frame_changed( void );
+
+static int lock=0;
+static flyContrast *myCrop=NULL;
+
+/********************************************************************/
+uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
+{
+  
+   uint32_t width,height;
+      uint8_t ret=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Contrast&quot;));
+        gtk_widget_show(dialog);	
+        
+          // and value changed
+#define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
+
+        CNX (checkLuma, &quot;toggled&quot;);
+        CNX (checkbuttonU, &quot;toggled&quot;);
+        CNX (checkbuttonV, &quot;toggled&quot;);
+        
+        
+        CNX (hscaleContrast, &quot;value_changed&quot;);
+        CNX (hscaleContrast, &quot;drag_data_received&quot;);
+      
+        CNX (hscaleBright, &quot;value_changed&quot;);
+        CNX (hscaleBright, &quot;drag_data_received&quot;);
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
+
+
+          
+        myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(CONTRAST_PARAM));
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            memcpy(param,&amp;(myCrop-&gt;param),sizeof(CONTRAST_PARAM));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+
+
+//
+//        Check entered values and green-out the selected portion on the screen
+//        Each value must be even
+//
+void frame_changed( void )
+{
+  myCrop-&gt;sliderChanged();
+}
+void gui_update (GtkButton * button, gpointer user_data)
+{
+  if(lock) return;
+    myCrop-&gt;update();
+}
+
+gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
+{
+  myCrop-&gt;display();
+  return TRUE;
+}
+
+/**************************************/
+#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
+			y=1; else y=0;
+#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
+
+
+uint8_t flyContrast::upload(void)
+{
+    lock++;
+      SCHECKBOX (checkLuma, param.doLuma);
+      SCHECKBOX (checkbuttonU, param.doChromaU);
+      SCHECKBOX (checkbuttonV, param.doChromaV);
+
+      GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+      GTK_ADJUSTMENT(adj)-&gt;value=param.offset;
+  
+      adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+      GTK_ADJUSTMENT(adj)-&gt;value=param.coef;
+    lock--;
+    return 1;
+}
+uint8_t flyContrast::download (void)
+{
+  CHECKBOX (checkLuma, param.doLuma);
+  CHECKBOX (checkbuttonU, param.doChromaU);
+  CHECKBOX (checkbuttonV, param.doChromaV);
+  
+  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+  param.offset= (int32_t)GTK_ADJUSTMENT(adj)-&gt;value;
+  
+  adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+  param.coef=GTK_ADJUSTMENT(adj)-&gt;value;
+   return 1;
+}
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *vbox3;
+  GtkWidget *label1;
+  GtkWidget *hscaleContrast;
+  GtkWidget *label2;
+  GtkWidget *hscaleBright;
+  GtkWidget *vbox2;
+  GtkWidget *checkLuma;
+  GtkWidget *checkbuttonU;
+  GtkWidget *checkbuttonV;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Contrast&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
+
+  vbox3 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox3);
+  gtk_box_pack_start (GTK_BOX (hbox1), vbox3, TRUE, TRUE, 0);
+
+  label1 = gtk_label_new (QT_TR_NOOP(&quot;Contrast&quot;));
+  gtk_widget_show (label1);
+  gtk_box_pack_start (GTK_BOX (vbox3), label1, FALSE, FALSE, 0);
+
+  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0)));
+  gtk_widget_show (hscaleContrast);
+  gtk_box_pack_start (GTK_BOX (vbox3), hscaleContrast, FALSE, TRUE, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_LEFT);
+
+  label2 = gtk_label_new (QT_TR_NOOP(&quot;Brightness&quot;));
+  gtk_widget_show (label2);
+  gtk_box_pack_start (GTK_BOX (vbox3), label2, FALSE, FALSE, 0);
+
+  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -127, 127, 1, 1, 0)));
+  gtk_widget_show (hscaleBright);
+  gtk_box_pack_start (GTK_BOX (vbox3), hscaleBright, FALSE, TRUE, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleBright), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleBright), 0);
+
+  vbox2 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox2);
+  gtk_box_pack_start (GTK_BOX (hbox1), vbox2, TRUE, TRUE, 0);
+
+  checkLuma = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Luma&quot;));
+  gtk_widget_show (checkLuma);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkLuma, FALSE, FALSE, 0);
+
+  checkbuttonU = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Chroma U&quot;));
+  gtk_widget_show (checkbuttonU);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonU, FALSE, FALSE, 0);
+
+  checkbuttonV = gtk_check_button_new_with_mnemonic (QT_TR_NOOP(&quot;Chroma v&quot;));
+  gtk_widget_show (checkbuttonV);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonV, FALSE, FALSE, 0);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (drawingarea1, -1, 300);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox3, &quot;vbox3&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, &quot;hscaleContrast&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleBright, &quot;hscaleBright&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, &quot;vbox2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, checkLuma, &quot;checkLuma&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonU, &quot;checkbuttonU&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonV, &quot;checkbuttonV&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
+
+  return dialog1;
+}
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,130 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;Q_contrast.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_contrastWindow::Ui_contrastWindow(CONTRAST_PARAM *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyContrast( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(CONTRAST_PARAM));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Brightness);
+          SPINNER(Contrast);
+          connect( ui.checkBoxU,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int)));
+          connect( ui.checkBoxV,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int))); 
+          connect( ui.checkBoxY,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int)));  
+
+  }
+  void Ui_contrastWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_contrastWindow::gather(CONTRAST_PARAM *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(CONTRAST_PARAM));
+  }
+Ui_contrastWindow::~Ui_contrastWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_contrastWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define MYSPIN(x) w-&gt;horizontalSlider##x
+#define MYCHECK(x) w-&gt;checkBox##x
+//************************
+uint8_t flyContrast::upload(void)
+{
+      Ui_contrastDialog *w=(Ui_contrastDialog *)_cookie;
+
+        MYSPIN(Contrast)-&gt;setValue((uint32_t)(param.coef*10));
+        MYSPIN(Brightness)-&gt;setValue(param.offset);
+#define CHECKSET(a,b) MYCHECK(a)-&gt;setChecked(param.b)
+        
+        CHECKSET(Y,doLuma);
+        CHECKSET(U,doChromaU);
+        CHECKSET(V,doChromaV);
+
+        return 1;
+}
+uint8_t flyContrast::download(void)
+{
+       Ui_contrastDialog *w=(Ui_contrastDialog *)_cookie;
+         param.coef=MYSPIN(Contrast)-&gt;value()/10.;
+         param.offset=MYSPIN(Brightness)-&gt;value();
+#define CHECKGET(a,b) param.b=MYCHECK(a)-&gt;isChecked()
+        
+        CHECKGET(Y,doLuma);
+        CHECKGET(U,doChromaU);
+        CHECKGET(V,doChromaV);
+return 1;
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
+{
+        uint8_t ret=0;
+        
+        Ui_contrastWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/Q_contrast.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,33 @@
+#ifndef Q_contrast_h
+#define Q_contrast_h
+
+#include &quot;ui_contrast.h&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyContrast.h&quot;
+
+class Ui_contrastWindow : public QDialog
+{
+	Q_OBJECT
+
+protected : 
+	int lock;
+
+public:
+	flyContrast *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_contrastWindow(CONTRAST_PARAM *param,AVDMGenericVideoStream *in);
+	~Ui_contrastWindow();
+	Ui_contrastDialog ui;
+
+public slots:
+	void gather(CONTRAST_PARAM *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+};
+#endif	// Q_contrast_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/contrast.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,219 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;contrastDialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;contrastDialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;558&lt;/width&gt;
+    &lt;height&gt;390&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Contrast&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeType&quot; &gt;
+      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;20&lt;/width&gt;
+       &lt;height&gt;40&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
+     &lt;property name=&quot;spacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;leftMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;topMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;rightMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;bottomMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxY&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Luma&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxU&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;ChromaU&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QCheckBox&quot; name=&quot;checkBoxV&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;ChromaV&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+    &lt;/layout&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
+     &lt;property name=&quot;spacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;leftMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;topMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;rightMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;bottomMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Contrast&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderContrast&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;5&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;15&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Brightness&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBrightness&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;-127&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;127&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+    &lt;/layout&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;contrastDialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;contrastDialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,235 @@
+/***************************************************************************
+                          DIA_flyCrop.cpp  -  description
+                             -------------------
+
+        Common part of the crop dialog
+    
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_default.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyCrop.h&quot;
+
+
+static uint8_t 		Metrics( uint8_t *in, uint32_t width,uint32_t *avg, uint32_t *eqt);
+static uint8_t 		MetricsV( uint8_t *in, uint32_t width,uint32_t height,uint32_t *avg, uint32_t *eqt);
+
+uint8_t    flyCrop::process(void)
+{
+        uint32_t x,y;
+        uint8_t  *in;
+        uint32_t w=_w,h=_h;
+  
+        
+        memcpy(_rgbBufferOut,_rgbBuffer,_w*_h*4);
+        in=_rgbBufferOut;
+        for(y=0;y&lt;top;y++)
+        {
+                for(x=0;x&lt;w;x++)
+                {
+                        *in++=0;
+                        
+                        
+                        *in++=0xff;
+                        
+                        *in++=0;
+                        *in++=0;
+                }
+        }
+        // bottom
+        in=_rgbBufferOut+(w*4)*(h-bottom);
+        for(y=0;y&lt;bottom;y++)
+        {
+                for(x=0;x&lt;w;x++)
+                {
+                        *in++=0;
+                        
+                        
+                        *in++=0xff;
+                        *in++=0;
+                        *in++=0;
+                }
+        }
+        // left
+        in=_rgbBufferOut;
+        uint32_t stride=4*w-4;
+        for(y=0;y&lt;h;y++)
+        {
+                for(x=0;x&lt;left;x++)
+                {
+                        *(in+4*x)=0;
+                        
+                        
+                        *(in+4*x+1)=0xff;
+                        *(in+4*x+2)=0;
+                        *(in+4*x+3)=0;
+                }
+                for(x=0;x&lt;right;x++)
+                {
+                        *(in-4*x+stride-4)=0;
+                        
+                        
+                        *(in-4*x+stride-3)=0xff;
+                        *(in-4*x+stride-2)=0;
+                        *(in-4*x+stride-1)=0;
+                        
+                }
+                in+=4*w;
+  
+        }
+
+		copyRgbFinalToDisplay();
+}
+
+/*----------------------------------
+  autocrop
+-----------------------------------*/
+
+uint8_t  flyCrop::autocrop(void)
+{
+uint8_t *in;
+uint32_t y,avg,eqt;
+	// Top
+
+#define THRESH_AVG   30
+#define THRESH_EQT   50
+        
+        in=_yuvBuffer-&gt;data;
+        for(y=0;y&lt;((_h&gt;&gt;1)-2);y++)	
+        {
+                Metrics(in,_w,&amp;avg,&amp;eqt);
+                in+=_w;
+                //printf(&quot;LineT :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
+                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
+                        break;
+        }
+//gotcha_:	
+        if(y)
+                top=y-1;
+        else 
+                top=0;
+                
+        in=_yuvBuffer-&gt;data+_w*(_h-1);
+        for(y=0;y&lt;((_h&gt;&gt;1)-2);y++)	
+        {
+                Metrics(in,_w,&amp;avg,&amp;eqt);
+                in-=_w;
+                //printf(&quot;Line B :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
+                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
+                                break;
+        }
+//gotcha_:	
+        if(y)
+                bottom=y-1;
+        else
+                bottom=0;
+
+                
+// Left
+        in=_yuvBuffer-&gt;data;
+        for(y=0;y&lt;((_w&gt;&gt;1)-2);y++)	
+        {
+                MetricsV(in,_w,_h,&amp;avg,&amp;eqt);
+                in++;
+                //printf(&quot;Line L :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
+                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
+                                break;
+        }
+//gotcha_:	
+        if(y)
+                left=y-1;
+        else
+                left=0;		
+// Right
+        in=_yuvBuffer-&gt;data+_w-1;
+        for(y=0;y&lt;((_w&gt;&gt;1)-2);y++)	
+        {
+                MetricsV(in,_w,_h,&amp;avg,&amp;eqt);
+                in--;
+                //printf(&quot;Line R :%d avg: %d eqt: %d\n&quot;,y,avg,eqt);
+                if(avg&gt; THRESH_AVG || eqt &gt; THRESH_EQT)
+                                break;
+        }
+//gotcha_:	
+        if(y)
+                right=y-1;
+        else
+                right=0;
+  
+              
+        // Update display
+        top=top &amp; 0xfffe;
+        bottom=bottom &amp; 0xfffe;
+        upload();
+        process();
+        display();
+        return 1;
+}
+/*---------------------------------------------
+	Compute the average value of pixels
+	and eqt is the &quot;ecart type&quot;
+*/
+uint8_t Metrics( uint8_t *in, uint32_t width,uint32_t *avg, uint32_t *eqt)
+{
+
+uint32_t x;
+uint32_t sum=0,eq=0;
+uint8_t v;
+              for(x=0;x&lt;width;x++)
+              {
+                      sum+=*(in+x);
+              }
+              sum=sum/width;
+              *avg=sum;
+              for(x=0;x&lt;width;x++)
+              {
+                      v=*(in+x)-sum;
+                      eq+=v*v;
+              }
+              eq=eq/(width*width);
+              *eqt=eq;
+              return 1;
+}
+/*---------------------------------------------
+	Compute the average value of pixels
+	and eqt is the &quot;ecart type&quot;
+*/
+uint8_t MetricsV( uint8_t *in,uint32_t width, uint32_t height,uint32_t *avg, uint32_t *eqt)
+{
+
+uint32_t x;
+uint32_t sum=0,eq=0;
+uint8_t v;
+              for(x=0;x&lt;height;x++)
+              {
+                      sum+=*(in+x*width);
+              }
+              sum=sum/height;
+              *avg=sum;
+              for(x=0;x&lt;height;x++)
+              {
+                      v=*(in+x*width)-sum;
+                      eq+=v*v;
+              }
+              eq=eq/(height*height);
+              *eqt=eq;
+              return 1;
+}
+//EOF
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/DIA_flyCrop.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,16 @@
+#ifndef FLY_CROP_H
+#define FLY_CROP_H
+class flyCrop : public ADM_flyDialog
+{
+  
+  public:
+   uint32_t left,right,top,bottom;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    autocrop(void);
+   flyCrop (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,0,RESIZE_LAST) {};
+};
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/gtk/DIA_crop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,423 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_toolkitGtk.h&quot;
+
+
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+
+
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyCrop.h&quot;
+#if 0
+static GtkWidget	*create_dialog1 (void);
+
+/* Link between UI and core */
+static gboolean 	ui_draw( void );
+static void 		ui_autocrop (void );
+static void 		ui_reset( void );
+static void 		ui_upload(void);
+static void  		ui_read ( void);
+static void  		ui_update ( void);
+static void 		ui_frame_changed( void );
+
+static GtkWidget *dialog=NULL;
+
+/* Prevent loop when updating value */
+
+static int lock=0;
+static flyCrop *myCrop=NULL;
+//
+//	Video is in YV12 Colorspace
+//
+//
+int DIA_getCropParams(char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
+{
+	uint32_t width, height;
+
+	// Allocate space for green-ised video
+	width = in-&gt;getInfo()-&gt;width;
+	height = in-&gt;getInfo()-&gt;height;
+
+	uint8_t ret=0;
+
+	dialog=create_dialog1();
+	gtk_register_dialog(dialog);
+	gtk_window_set_title(GTK_WINDOW(dialog), name);
+	gtk_widget_show(dialog);
+	
+#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y, GTK_SIGNAL_FUNC(z), NULL);
+
+	CONNECT(drawingarea1,expose_event,ui_draw);
+	CONNECT(buttonAutocrop,clicked,ui_autocrop);
+	CONNECT(buttonReset,clicked,ui_reset);
+	CONNECT(scale,value_changed,ui_frame_changed);
+	                  
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk), GTK_RESPONSE_OK);
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply), GTK_RESPONSE_APPLY);
+
+#define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_update)
+          
+	CONNECT_SPIN(Top);
+	CONNECT_SPIN(Left);
+	CONNECT_SPIN(Right);
+	CONNECT_SPIN(Bottom);
+
+	myCrop=new flyCrop(width, height,in,WID(drawingarea1),WID(scale));
+	myCrop-&gt;left=param-&gt;left;
+	myCrop-&gt;right=param-&gt;right;
+	myCrop-&gt;top=param-&gt;top;
+	myCrop-&gt;bottom=param-&gt;bottom;
+	myCrop-&gt;upload();	
+	myCrop-&gt;sliderChanged();	
+
+	int response;
+
+	while((response = gtk_dialog_run(GTK_DIALOG(dialog))) == GTK_RESPONSE_APPLY)
+	{
+	  ui_update();
+	}
+
+	if(response==GTK_RESPONSE_OK)
+	{
+		ui_read( );
+		param-&gt;left=myCrop-&gt;left;
+		param-&gt;right=myCrop-&gt;right;
+		param-&gt;top=myCrop-&gt;top;
+		param-&gt;bottom=myCrop-&gt;bottom;
+		ret=1;
+	}
+
+	gtk_unregister_dialog(dialog);
+	gtk_widget_destroy(dialog);
+	delete myCrop;
+	return ret;
+}
+
+/*
+      Link GTK dialog and core
+*/
+void ui_frame_changed( void )
+{
+  myCrop-&gt;sliderChanged();
+}
+void ui_update(void)
+{
+  if(lock) return;
+  myCrop-&gt;download();
+  myCrop-&gt;process();
+  myCrop-&gt;display();
+}
+/*---------------------------------------------------------------------------
+	Actually draw the working frame on screen
+*/
+gboolean ui_draw( void )
+{
+        myCrop-&gt;display();
+}
+void ui_read (void )
+{
+        myCrop-&gt;download();
+}
+void ui_upload(void)
+{
+    myCrop-&gt;upload();
+}
+void ui_autocrop( void )
+{
+  myCrop-&gt;autocrop();
+ 
+}
+void ui_reset( void )
+{
+        myCrop-&gt;left=0;
+        myCrop-&gt;right=0;
+        myCrop-&gt;bottom=0;
+        myCrop-&gt;top=0;
+        
+	myCrop-&gt;upload();
+        myCrop-&gt;process();
+        myCrop-&gt;display();
+}
+
+/*---------------------------------------------------------------------------
+	Read entried from dialog box
+*/
+
+#define SPIN_GET(x,y) {x= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(spinbutton##y))) ;}
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton##y)),(gfloat)x) ;}
+
+
+//____________________________________
+uint8_t flyCrop::upload(void)
+{
+        lock++;
+        SPIN_SET(left,Left);
+        SPIN_SET(right,Right);
+        SPIN_SET(top,Top);
+        SPIN_SET(bottom,Bottom);
+        lock--;
+        return 1;
+}
+uint8_t flyCrop::download(void)
+{
+        int reject=0;
+        
+                        SPIN_GET(left,Left);
+                        SPIN_GET(right,Right);
+                        SPIN_GET(top,Top);
+                        SPIN_GET(bottom,Bottom);
+                        
+                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
+                        
+                        left&amp;=0xffffe;
+                        right&amp;=0xffffe;
+                        top&amp;=0xffffe;
+                        bottom&amp;=0xffffe;
+                        
+                        if((top+bottom)&gt;_h)
+                                {
+                                        top=bottom=0;
+                                        reject=1;
+                                }
+                        if((left+right)&gt;_w)
+                                {
+                                        left=right=0;
+                                        reject=1;
+                                }
+                        if(reject)
+                                upload();
+}
+// End common part
+//--------------------------------------------
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbuttonbox1;
+  GtkWidget *buttonCancel;
+  GtkWidget *buttonApply;
+  GtkWidget *buttonOk;
+  GtkWidget *hbuttonbox2;
+  GtkWidget *buttonAutocrop;
+  GtkWidget *buttonReset;
+  GtkWidget *alignment1;
+  GtkWidget *hbox1;
+  GtkWidget *image1;
+  GtkWidget *label1;
+  GtkWidget *table1;
+  GtkWidget *label2;
+  GtkWidget *label3;
+  GtkWidget *label4;
+  GtkWidget *label5;
+  GtkObject *spinbuttonLeft_adj;
+  GtkWidget *spinbuttonLeft;
+  GtkObject *spinbuttonTop_adj;
+  GtkWidget *spinbuttonTop;
+  GtkObject *spinbuttonBottom_adj;
+  GtkWidget *spinbuttonBottom;
+  GtkObject *spinbuttonRight_adj;
+  GtkWidget *spinbuttonRight;
+  GtkWidget *scale;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Crop Settings&quot;));
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbuttonbox1 = gtk_hbutton_box_new ();
+  gtk_widget_show (hbuttonbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox1, FALSE, TRUE, 0);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox1), GTK_BUTTONBOX_END);
+
+  buttonCancel = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (buttonCancel);
+  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonCancel);
+  GTK_WIDGET_SET_FLAGS (buttonCancel, GTK_CAN_DEFAULT);
+
+  buttonApply = gtk_button_new_from_stock (&quot;gtk-apply&quot;);
+  gtk_widget_show (buttonApply);
+  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonApply);
+  GTK_WIDGET_SET_FLAGS (buttonApply, GTK_CAN_DEFAULT);
+
+  buttonOk = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (buttonOk);
+  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonOk);
+  GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
+
+  hbuttonbox2 = gtk_hbutton_box_new ();
+  gtk_widget_show (hbuttonbox2);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox2, FALSE, TRUE, 0);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox2), GTK_BUTTONBOX_START);
+
+  buttonAutocrop = gtk_button_new_with_mnemonic (QT_TR_NOOP(&quot;AutoCrop&quot;));
+  gtk_widget_show (buttonAutocrop);
+  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonAutocrop);
+  GTK_WIDGET_SET_FLAGS (buttonAutocrop, GTK_CAN_DEFAULT);
+
+  buttonReset = gtk_button_new ();
+  gtk_widget_show (buttonReset);
+  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonReset);
+  GTK_WIDGET_SET_FLAGS (buttonReset, GTK_CAN_DEFAULT);
+
+  alignment1 = gtk_alignment_new (0.5, 0.5, 0, 0);
+  gtk_widget_show (alignment1);
+  gtk_container_add (GTK_CONTAINER (buttonReset), alignment1);
+
+  hbox1 = gtk_hbox_new (FALSE, 2);
+  gtk_widget_show (hbox1);
+  gtk_container_add (GTK_CONTAINER (alignment1), hbox1);
+
+  image1 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_BUTTON);
+  gtk_widget_show (image1);
+  gtk_box_pack_start (GTK_BOX (hbox1), image1, FALSE, FALSE, 0);
+
+  label1 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;Reset&quot;));
+  gtk_widget_show (label1);
+  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
+  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
+
+  table1 = gtk_table_new (2, 4, FALSE);
+  gtk_widget_show (table1);
+  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, TRUE, 0);
+
+  label2 = gtk_label_new (QT_TR_NOOP(&quot;Crop Left :&quot;));
+  gtk_widget_show (label2);
+  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
+
+  label3 = gtk_label_new (QT_TR_NOOP(&quot;Crop Top:&quot;));
+  gtk_widget_show (label3);
+  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
+
+  label4 = gtk_label_new (QT_TR_NOOP(&quot;Crop Right:&quot;));
+  gtk_widget_show (label4);
+  gtk_table_attach (GTK_TABLE (table1), label4, 2, 3, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
+
+  label5 = gtk_label_new (QT_TR_NOOP(&quot;Crop Bottom:&quot;));
+  gtk_widget_show (label5);
+  gtk_table_attach (GTK_TABLE (table1), label5, 2, 3, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
+
+  spinbuttonLeft_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonLeft = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonLeft_adj), 1, 0);
+  gtk_widget_show (spinbuttonLeft);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonLeft, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonLeft), TRUE);
+
+  spinbuttonTop_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonTop = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTop_adj), 1, 0);
+  gtk_widget_show (spinbuttonTop);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonTop, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTop), TRUE);
+
+  spinbuttonBottom_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonBottom = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBottom_adj), 1, 0);
+  gtk_widget_show (spinbuttonBottom);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonBottom, 3, 4, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBottom), TRUE);
+
+  spinbuttonRight_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
+  spinbuttonRight = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRight_adj), 1, 0);
+  gtk_widget_show (spinbuttonRight);
+  gtk_table_attach (GTK_TABLE (table1), spinbuttonRight, 3, 4, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRight), TRUE);
+
+  scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 110, 1, 10, 10)));
+  gtk_widget_show (scale);
+  gtk_box_pack_start (GTK_BOX (vbox1), scale, FALSE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, FALSE, TRUE, 0);
+  gtk_widget_set_size_request (drawingarea1, 100, 100);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox1, &quot;hbuttonbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, buttonCancel, &quot;buttonCancel&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, buttonApply, &quot;buttonApply&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, buttonOk, &quot;buttonOk&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox2, &quot;hbuttonbox2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, buttonAutocrop, &quot;buttonAutocrop&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, &quot;buttonReset&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, alignment1, &quot;alignment1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, image1, &quot;image1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label5, &quot;label5&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonLeft, &quot;spinbuttonLeft&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTop, &quot;spinbuttonTop&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBottom, &quot;spinbuttonBottom&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRight, &quot;spinbuttonRight&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, scale, &quot;scale&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+
+  return dialog1;
+}
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,171 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#if 0
+#include &quot;Q_crop.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_cropWindow::Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyCrop( width, height,in,canvas,ui.horizontalSlider);
+        myCrop-&gt;left=param-&gt;left;
+        myCrop-&gt;right=param-&gt;right;
+        myCrop-&gt;top=param-&gt;top;
+        myCrop-&gt;bottom=param-&gt;bottom;
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+        connect( ui.pushButtonAutoCrop,SIGNAL(clicked(bool)),this,SLOT(autoCrop(bool)));
+        connect( ui.pushButtonReset,SIGNAL(clicked(bool)),this,SLOT(reset(bool)));
+#define SPINNER(x) connect( ui.spinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Left);
+          SPINNER(Right);
+          SPINNER(Top);
+          SPINNER(Bottom);
+
+  }
+  void Ui_cropWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_cropWindow::gather(CROP_PARAMS *param)
+  {
+    
+        myCrop-&gt;download();
+        param-&gt;left=myCrop-&gt;left;
+        param-&gt;right=myCrop-&gt;right;
+        param-&gt;top=myCrop-&gt;top;
+        param-&gt;bottom=myCrop-&gt;bottom;
+  }
+Ui_cropWindow::~Ui_cropWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_cropWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;download();
+  myCrop-&gt;process();
+  myCrop-&gt;display();
+  lock--;
+}
+
+void Ui_cropWindow::autoCrop( bool f )
+{
+  lock++;
+  myCrop-&gt;autocrop();
+  lock--;
+}
+void Ui_cropWindow::reset( bool f )
+{
+         myCrop-&gt;left=0;
+         myCrop-&gt;right=0;
+         myCrop-&gt;bottom=0;
+         myCrop-&gt;top=0;
+         lock++;
+         myCrop-&gt;upload();
+         myCrop-&gt;process();
+         myCrop-&gt;display();
+         lock--;
+}
+
+//************************
+uint8_t flyCrop::upload(void)
+{
+      Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
+        
+        w-&gt;spinBoxLeft-&gt;setValue(left);
+        w-&gt;spinBoxRight-&gt;setValue(right);
+        w-&gt;spinBoxTop-&gt;setValue(top);
+        w-&gt;spinBoxBottom-&gt;setValue(bottom);
+        
+        return 1;
+}
+uint8_t flyCrop::download(void)
+{
+        int reject=0;
+Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
+#define SPIN_GET(x,y) x=w-&gt;spinBox##y-&gt;value();
+                        SPIN_GET(left,Left);
+                        SPIN_GET(right,Right);
+                        SPIN_GET(top,Top);
+                        SPIN_GET(bottom,Bottom);
+                        
+                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
+                        
+                        left&amp;=0xffffe;
+                        right&amp;=0xffffe;
+                        top&amp;=0xffffe;
+                        bottom&amp;=0xffffe;
+                        
+                        if((top+bottom)&gt;_h)
+                                {
+                                        top=bottom=0;
+                                        reject=1;
+                                }
+                        if((left+right)&gt;_w)
+                                {
+                                        left=right=0;
+                                        reject=1;
+                                }
+                        if(reject)
+                                upload();
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_cropWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/Q_crop.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,37 @@
+#ifndef Q_crop_h
+#define Q_crop_h
+
+#include &quot;ui_crop.h&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyCrop.h&quot;
+#if 0
+class Ui_cropWindow : public QDialog
+{
+	Q_OBJECT
+
+protected: 
+	int lock;
+
+public:
+	flyCrop *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in);
+	~Ui_cropWindow();
+	Ui_cropDialog ui;
+
+public slots:
+	void gather(CROP_PARAMS *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+	void autoCrop(bool f);
+	void reset(bool f);
+};
+
+#endif	// Q_crop_h
+#endif
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/crop.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Crop/qt4/crop.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,145 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;cropDialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;cropDialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;400&lt;/width&gt;
+    &lt;height&gt;300&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Dialog&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonReset&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Reset&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Left:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Top:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Bottom:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxBottom&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Right:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxRight&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxLeft&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxTop&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonAutoCrop&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;AutCrop&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;cropDialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;cropDialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,85 @@
+/***************************************************************************
+                          ADM_guiContrast.cpp  -  description
+                             -------------------
+    begin                : Mon Sep 23 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;config.h&quot;
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+#include &quot;ADM_default.h&quot;
+
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyEq2.h&quot;
+
+/************* COMMON PART *********************/
+uint8_t  flyEq2::update(void)
+{
+    download();
+    process();
+    copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+
+uint8_t flyEq2::process(void)
+
+{
+	Eq2Settings mySettings;
+
+#if 0
+	printf(&quot;Contrast   :%f\n&quot;,param.contrast);
+	printf(&quot;brightness :%f\n&quot;,param.brightness);
+	printf(&quot;saturation :%f\n&quot;,param.saturation);
+	
+	printf(&quot;gamma_weight :%f\n&quot;,param.gamma_weight);
+	printf(&quot;gamma :%f\n&quot;,param.gamma);
+	
+	
+	
+	printf(&quot;rgamma :%f\n&quot;,param.rgamma);
+	printf(&quot;bgamma :%f\n&quot;,param.bgamma);
+	printf(&quot;ggamma :%f\n&quot;,param.ggamma);
+	printf(&quot;******************\n&quot;);
+#endif	
+	
+	        update_lut(&amp;mySettings,&amp;param);
+	        
+typedef void lutMeType(oneSetting *par, unsigned char *dst, unsigned char *src, unsigned int w, unsigned int h);
+
+			lutMeType *lutMe=apply_lut;
+			
+
+#ifdef ADM_CPU_X86
+	        if(CpuCaps::hasMMX())
+	        {
+	        		lutMe=affine_1d_MMX;
+	        }
+#endif	
+	        lutMe(&amp;(mySettings.param[0]),YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),_w,_h);
+	        lutMe(&amp;(mySettings.param[2]),UPLANE(_yuvBufferOut),UPLANE(_yuvBuffer),_w&gt;&gt;1,_h&gt;&gt;1);
+	        lutMe(&amp;(mySettings.param[1]),VPLANE(_yuvBufferOut),VPLANE(_yuvBuffer),_w&gt;&gt;1,_h&gt;&gt;1);       
+
+	        	
+	        	#if 1
+	        _yuvBuffer-&gt;copyLeftSideTo(_yuvBufferOut);
+#endif
+		return 1;
+}
+
+/************* COMMON PART *********************/

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/DIA_flyEq2.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,35 @@
+
+/***************************************************************************
+                        flyDialog for Eq2-Gtk
+                        (C) Mean 2007
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef FLY_EQ2_H
+#define FLY_EQ2_H
+#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
+class flyEq2 : public ADM_flyDialog
+{
+  
+  public:
+   Eq2_Param  param;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    update(void);
+   			  flyEq2 (uint32_t width,uint32_t height,AVDMGenericVideoStream *in, void *canvas, void *slider) : 
+                                    	ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO)
+                    {
+                      
+                    };
+};
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/gtk/DIA_eq2.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/gtk/DIA_eq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,442 @@
+/***************************************************************************
+                           Fly-Ui for hue &amp; sat
+
+    copyright            : (C) 2004/5/7 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+    
+    
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;ADM_toolkitGtk.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+
+#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyEq2.h&quot;
+
+
+static GtkWidget*create_dialog1 (void);
+static float getAdj(GtkWidget *widget);
+static void setAdj(GtkWidget *widget,float val);
+
+static GtkWidget *dialog=NULL;
+
+static void             update ( void);
+static gboolean         draw (void );
+static void             eq2_changed( void);
+static void 			frame_changed( void );
+
+static int lock=0;
+static flyEq2 *myCrop=NULL;
+
+/**
+ * 		\fn DIA_getEQ2Param
+ * 		\brief flyDialogGtk handling the mplayer EQ2 user Interface dialog.
+ */
+uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
+{
+uint8_t r=0;
+uint32_t w,h;
+        // Allocate space for green-ised video
+        w=in-&gt;getInfo()-&gt;width;
+        h=in-&gt;getInfo()-&gt;height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_widget_show(dialog);	
+        
+        myCrop=new flyEq2( w, h,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Eq2_Param));
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        myCrop-&gt;update();
+        
+        int ret=0;
+        int response;
+        //-----------------------
+        
+#define HCONECT(x)  gtk_signal_connect(GTK_OBJECT(WID(hscale##x)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(eq2_changed),   NULL);
+
+        HCONECT(Brightness);
+        HCONECT(Saturation);
+        HCONECT(Contrast);
+
+        HCONECT(Gamma);        
+        HCONECT(GammaWeight);
+        HCONECT(GammaR);
+        HCONECT(GammaG);
+        HCONECT(GammaB);
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;, GTK_SIGNAL_FUNC(draw),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        //-----------------------
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            memcpy(param,&amp;(myCrop-&gt;param),sizeof(Eq2_Param));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        myCrop=NULL;
+        return ret;
+
+}
+/**************************************/
+#undef SET
+#undef GET
+#define SET(x,y)        gtk_range_set_value (GTK_RANGE(WID(hscale##x)),(gdouble)param.y)
+#define GET(x,y)        param.y= (float)gtk_range_get_value (GTK_RANGE(WID(hscale##x)))
+
+
+uint8_t flyEq2::upload(void)
+{
+  lock++;
+  SET(Contrast,contrast);
+  SET(Brightness,brightness);
+  SET(Saturation,saturation);
+
+  SET(Gamma,gamma);        
+  SET(GammaWeight,gamma_weight);
+  SET(GammaR,rgamma);
+  SET(GammaG,ggamma);
+  SET(GammaB,bgamma);
+  
+  lock--;
+  return 1;
+}
+uint8_t flyEq2::download (void)
+{
+
+  GET(Contrast,contrast);
+  GET(Brightness,brightness);
+  GET(Saturation,saturation);
+
+  GET(Gamma,gamma);        
+  GET(GammaWeight,gamma_weight);
+  GET(GammaR,rgamma);
+  GET(GammaG,ggamma);
+  GET(GammaB,bgamma);
+
+ return 1;
+}
+
+/**********************/
+void frame_changed( void )
+{
+          myCrop-&gt;sliderChanged();
+}
+void eq2_changed( void)
+{
+    if(lock) return;
+    myCrop-&gt;update();
+}
+gboolean draw (void)
+{
+    myCrop-&gt;display();
+	return true;
+}
+//**
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *frame1;
+  GtkWidget *table2;
+  GtkWidget *label4;
+  GtkWidget *label5;
+  GtkWidget *hscaleBrightness;
+  GtkWidget *hscaleSaturation;
+  GtkWidget *hscaleContrast;
+  GtkWidget *label3;
+  GtkWidget *label1;
+  GtkWidget *frame2;
+  GtkWidget *table3;
+  GtkWidget *label6;
+  GtkWidget *hscaleGamma;
+  GtkWidget *hscaleGammaR;
+  GtkWidget *label8;
+  GtkWidget *hscaleGammaG;
+  GtkWidget *label9;
+  GtkWidget *label10;
+  GtkWidget *label7;
+  GtkWidget *hscaleGammaB;
+  GtkWidget *hscaleGammaWeight;
+  GtkWidget *label2;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_container_set_border_width (GTK_CONTAINER (dialog1), 6);
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;MPlayer eq2&quot;));
+  gtk_window_set_resizable (GTK_WINDOW (dialog1), FALSE);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
+
+  frame1 = gtk_frame_new (NULL);
+  gtk_widget_show (frame1);
+  gtk_box_pack_start (GTK_BOX (hbox1), frame1, TRUE, TRUE, 0);
+  gtk_frame_set_shadow_type (GTK_FRAME (frame1), GTK_SHADOW_NONE);
+
+  table2 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table2);
+  gtk_container_add (GTK_CONTAINER (frame1), table2);
+  gtk_container_set_border_width (GTK_CONTAINER (table2), 12);
+  gtk_table_set_row_spacings (GTK_TABLE (table2), 6);
+  gtk_table_set_col_spacings (GTK_TABLE (table2), 12);
+
+  label4 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;Brigh_tness:&quot;));
+  gtk_widget_show (label4);
+  gtk_table_attach (GTK_TABLE (table2), label4, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
+
+  label5 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Saturation:&quot;));
+  gtk_widget_show (label5);
+  gtk_table_attach (GTK_TABLE (table2), label5, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
+
+  hscaleBrightness = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -1, 1, 0.05, 1, 0)));
+  gtk_widget_show (hscaleBrightness);
+  gtk_table_attach (GTK_TABLE (table2), hscaleBrightness, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleBrightness, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleBrightness), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleBrightness), 2);
+
+  hscaleSaturation = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0, 3, 0.05, 1, 0)));
+  gtk_widget_show (hscaleSaturation);
+  gtk_table_attach (GTK_TABLE (table2), hscaleSaturation, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleSaturation, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleSaturation), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleSaturation), 2);
+
+  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, -2, 2, 0.05, 1, 0)));
+  gtk_widget_show (hscaleContrast);
+  gtk_table_attach (GTK_TABLE (table2), hscaleContrast, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleContrast, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleContrast), 2);
+
+  label3 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Contrast:&quot;));
+  gtk_widget_show (label3);
+  gtk_table_attach (GTK_TABLE (table2), label3, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
+
+  label1 = gtk_label_new (&quot;&quot;);
+  gtk_widget_show (label1);
+  gtk_frame_set_label_widget (GTK_FRAME (frame1), label1);
+  gtk_label_set_use_markup (GTK_LABEL (label1), TRUE);
+  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
+
+  frame2 = gtk_frame_new (NULL);
+  gtk_widget_show (frame2);
+  gtk_box_pack_start (GTK_BOX (hbox1), frame2, TRUE, TRUE, 0);
+  gtk_frame_set_shadow_type (GTK_FRAME (frame2), GTK_SHADOW_NONE);
+
+  table3 = gtk_table_new (5, 2, FALSE);
+  gtk_widget_show (table3);
+  gtk_container_add (GTK_CONTAINER (frame2), table3);
+  gtk_container_set_border_width (GTK_CONTAINER (table3), 12);
+  gtk_table_set_row_spacings (GTK_TABLE (table3), 6);
+  gtk_table_set_col_spacings (GTK_TABLE (table3), 12);
+
+  label6 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Initial:&quot;));
+  gtk_widget_show (label6);
+  gtk_table_attach (GTK_TABLE (table3), label6, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label6), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label6), 0, 0.5);
+
+  hscaleGamma = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
+  gtk_widget_show (hscaleGamma);
+  gtk_table_attach (GTK_TABLE (table3), hscaleGamma, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleGamma, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleGamma), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleGamma), 2);
+
+  hscaleGammaR = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
+  gtk_widget_show (hscaleGammaR);
+  gtk_table_attach (GTK_TABLE (table3), hscaleGammaR, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleGammaR, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaR), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleGammaR), 2);
+
+  label8 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Red:&quot;));
+  gtk_widget_show (label8);
+  gtk_table_attach (GTK_TABLE (table3), label8, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label8), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
+
+  hscaleGammaG = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
+  gtk_widget_show (hscaleGammaG);
+  gtk_table_attach (GTK_TABLE (table3), hscaleGammaG, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleGammaG, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaG), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleGammaG), 2);
+
+  label9 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Green:&quot;));
+  gtk_widget_show (label9);
+  gtk_table_attach (GTK_TABLE (table3), label9, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label9), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
+
+  label10 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Blue:&quot;));
+  gtk_widget_show (label10);
+  gtk_table_attach (GTK_TABLE (table3), label10, 0, 1, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label10), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label10), 0, 0.5);
+
+  label7 = gtk_label_new_with_mnemonic (QT_TR_NOOP(&quot;_Weight:&quot;));
+  gtk_widget_show (label7);
+  gtk_table_attach (GTK_TABLE (table3), label7, 0, 1, 4, 5,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label7), GTK_JUSTIFY_LEFT);
+  gtk_misc_set_alignment (GTK_MISC (label7), 0, 0.5);
+
+  hscaleGammaB = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.1, 3, 0.05, 1, 0)));
+  gtk_widget_show (hscaleGammaB);
+  gtk_table_attach (GTK_TABLE (table3), hscaleGammaB, 1, 2, 3, 4,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleGammaB, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaB), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleGammaB), 2);
+
+  hscaleGammaWeight = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0, 1, 0.05, 1, 0)));
+  gtk_widget_show (hscaleGammaWeight);
+  gtk_table_attach (GTK_TABLE (table3), hscaleGammaWeight, 1, 2, 4, 5,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  gtk_widget_set_size_request (hscaleGammaWeight, 144, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleGammaWeight), GTK_POS_RIGHT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleGammaWeight), 2);
+
+  label2 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Gamma&lt;/b&gt;&quot;));
+  gtk_widget_show (label2);
+  gtk_frame_set_label_widget (GTK_FRAME (frame2), label2);
+  gtk_label_set_use_markup (GTK_LABEL (label2), TRUE);
+  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 0)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label4), hscaleBrightness);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label5), hscaleSaturation);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label3), hscaleContrast);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label6), hscaleGamma);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label8), hscaleGammaR);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label9), hscaleGammaG);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label10), hscaleGammaB);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (label7), hscaleGammaWeight);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, frame1, &quot;frame1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, table2, &quot;table2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label5, &quot;label5&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleBrightness, &quot;hscaleBrightness&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleSaturation, &quot;hscaleSaturation&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, &quot;hscaleContrast&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, frame2, &quot;frame2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, table3, &quot;table3&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label6, &quot;label6&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleGamma, &quot;hscaleGamma&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaR, &quot;hscaleGammaR&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label8, &quot;label8&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaG, &quot;hscaleGammaG&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label9, &quot;label9&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label10, &quot;label10&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label7, &quot;label7&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaB, &quot;hscaleGammaB&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleGammaWeight, &quot;hscaleGammaWeight&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
+
+  return dialog1;
+}
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,137 @@
+/***************************************************************************
+                          Q_eq2.cpp  -  description
+
+                flyDialog for MPlayer EQ2 filter
+    copyright            : (C) 2002/2007 by mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;Q_eq2.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_eq2Window::Ui_eq2Window(Eq2_Param *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyEq2( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Eq2_Param));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        myCrop-&gt;update();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+        SPINNER(Red);
+        SPINNER(Blue);
+        SPINNER(Green);
+         
+        SPINNER(Contrast);
+        SPINNER(Brightness);
+        SPINNER(Saturation);
+
+        SPINNER(Initial);
+        SPINNER(Weight);
+  }
+  void Ui_eq2Window::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_eq2Window::gather(Eq2_Param *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(Eq2_Param));
+  }
+Ui_eq2Window::~Ui_eq2Window()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_eq2Window::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define sliderSet(x,y) w-&gt;horizontalSlider##x-&gt;setValue((int)(param.y*100));
+#define sliderGet(x,y) param.y=w-&gt;horizontalSlider##x-&gt;value()/100.;
+//************************
+uint8_t flyEq2::upload(void)
+{
+Ui_eq2Dialog *w=(Ui_eq2Dialog *)_cookie;
+
+
+        sliderSet(Contrast,contrast);
+        sliderSet(Brightness,brightness);
+        sliderSet(Saturation,saturation);
+
+        sliderSet(Red,rgamma);
+        sliderSet(Green,ggamma);
+        sliderSet(Blue,bgamma);
+
+        sliderSet(Initial,gamma);
+        sliderSet(Weight,gamma_weight);
+        
+       return 1;
+}
+uint8_t flyEq2::download(void)
+{
+	Ui_eq2Dialog *w=(Ui_eq2Dialog *)_cookie;
+
+        sliderGet(Contrast,contrast);
+        sliderGet(Brightness,brightness);
+        sliderGet(Saturation,saturation);
+
+        sliderGet(Red,rgamma);
+        sliderGet(Green,ggamma);
+        sliderGet(Blue,bgamma);
+
+        sliderGet(Initial,gamma);
+        sliderGet(Weight,gamma_weight);
+
+return 1;
+}
+/**
+      \fn     DIA_getEQ2Param
+      \brief  Handle MPlayer EQ2 flyDialog
+*/
+uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_eq2Window dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/Q_eq2.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,33 @@
+#ifndef Q_eq2_h
+#define Q_eq2_h
+
+#include &quot;ui_eq2.h&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyEq2.h&quot;
+
+class Ui_eq2Window : public QDialog
+{
+	Q_OBJECT
+
+protected:
+	int lock;
+
+public:
+	flyEq2 *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_eq2Window(Eq2_Param *param,AVDMGenericVideoStream *in);
+	~Ui_eq2Window();
+	Ui_eq2Dialog ui;
+
+public slots:
+	void gather(Eq2_Param *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+};
+#endif	// Q_eq2_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/eq2.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,306 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;eq2Dialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;eq2Dialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;651&lt;/width&gt;
+    &lt;height&gt;560&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Contrast&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;5&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;4&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeType&quot; &gt;
+      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;20&lt;/width&gt;
+       &lt;height&gt;40&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;&lt;b&gt;Gamma&lt;/b&gt;&lt;/string&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;textFormat&quot; &gt;
+      &lt;enum&gt;Qt::RichText&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+    &lt;layout class=&quot;QGridLayout&quot; &gt;
+     &lt;property name=&quot;leftMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;topMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;rightMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;bottomMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;horizontalSpacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;verticalSpacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;item row=&quot;4&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Saturation&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;2&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Brightness&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Contrast&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderContrast&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;-200&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;200&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;3&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBrightness&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;-100&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;100&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;5&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderSaturation&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;tickInterval&quot; &gt;
+        &lt;number&gt;1&lt;/number&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+    &lt;/layout&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
+    &lt;layout class=&quot;QGridLayout&quot; &gt;
+     &lt;property name=&quot;leftMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;topMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;rightMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;bottomMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;horizontalSpacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;verticalSpacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;item row=&quot;2&quot; column=&quot;1&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderGreen&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;3&quot; column=&quot;1&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderBlue&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;3&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_9&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Blue&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_6&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Red&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_5&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Initial&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;4&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_7&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Weight&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderRed&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;2&quot; column=&quot;0&quot; &gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_8&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Green&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderInitial&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item row=&quot;4&quot; column=&quot;1&quot; &gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderWeight&quot; &gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;300&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+    &lt;/layout&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;eq2Dialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;eq2Dialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Equalizer/gtk/DIA_equalizer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Equalizer/gtk/DIA_equalizer.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Equalizer/gtk/DIA_equalizer.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -93,7 +93,7 @@
 	imgsrc=new ADMImage(w,h);
         imgdisplay=new ADMImage(w,h);
 	
-        //if(curframe&lt;max) max=curframe;
+        max=max/2;
         
 	ADM_assert(in-&gt;getFrameNumberNoAlloc(max, &amp;l, imgsrc,&amp;f));
         memcpy(imgdisplay-&gt;data+w*h,imgsrc-&gt;data+w*h,(w*h)&gt;&gt;1);

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,80 @@
+/**/
+/***************************************************************************
+                          DIA_hue
+                             -------------------
+
+			   Ui for hue &amp; sat
+
+    begin                : 08 Apr 2005
+    copyright            : (C) 2004/7 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+
+#include &quot;config.h&quot;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+
+#include &quot;ADM_default.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyHue.h&quot;
+
+#include &quot;ADM_assert.h&quot;
+// FIXME
+#ifndef M_PI
+#define M_PI    3.14159265358979323846
+#endif
+
+/************* COMMON PART *********************/
+uint8_t  flyHue::update(void)
+{
+    download();
+    process();
+	copyYuvFinalToRgb();
+    display();
+    return 1;
+}        
+
+uint8_t  flyHue::process(void )
+{
+uint8_t *src,*dst;
+uint32_t stride;
+float hue,sat;
+    hue=param.hue*M_PI/180.;
+    sat=(100+param.saturation)/100.;
+    memcpy(YPLANE(_yuvBufferOut),YPLANE(_yuvBuffer),_w*_h); // copy luma
+    // Do it!
+    HueProcess_C(VPLANE(_yuvBufferOut), UPLANE(_yuvBufferOut),
+        VPLANE(_yuvBuffer), UPLANE(_yuvBuffer),
+        _w&gt;&gt;1,_w&gt;&gt;1,
+        _w&gt;&gt;1,_h&gt;&gt;1, 
+        hue, sat);
+    // Copy half source to display
+    dst=_yuvBufferOut-&gt;data+_w*_h;
+    src=_yuvBuffer-&gt;data+_w*_h;
+    stride=_w&gt;&gt;1;
+    for(uint32_t y=0;y&lt;_h;y++)   // We do both u &amp; v!
+    {
+        memcpy(dst,src,stride&gt;&gt;1);
+        dst+=stride;
+        src+=stride;
+    }
+    return 1;
+}
+//EOF

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/DIA_flyHue.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,16 @@
+#ifndef FLY_HUE_H
+#define FLY_HUE_H
+class flyHue : public ADM_flyDialog
+{
+  
+  public:
+   Hue_Param  param;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    update(void);
+   flyHue (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
+};
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/gtk/DIA_hue.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/gtk/DIA_hue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,235 @@
+/**/
+/***************************************************************************
+                          DIA_hue
+                             -------------------
+
+			   Ui for hue &amp; sat
+
+    begin                : 08 Apr 2005
+    copyright            : (C) 2004/7 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;ADM_toolkitGtk.h&quot;
+
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyHue.h&quot;
+
+
+static GtkWidget	*create_dialog1 (void);
+static void  		update ( void);
+static gboolean 	draw (void );
+static void 		upload(void);
+static void 		download(void);
+static void 		frame_changed( void );
+static void             hue_changed( void);
+
+static int lock=0;
+static GtkWidget *dialog=NULL;
+static flyHue *myCrop=NULL;
+
+/**
+      \fn DIA_getHue
+      \brief Handle Hue (fly)Dialog
+*/
+uint8_t DIA_getHue(Hue_Param *param, AVDMGenericVideoStream *in)
+{
+      uint32_t width,height;
+      uint8_t ret=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        
+        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Hue&quot;));
+
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
+            GTK_SIGNAL_FUNC(draw),
+            NULL);
+//
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(hscaleHue)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(hscaleSaturation)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(hue_changed),   NULL);
+        gtk_widget_show(dialog);
+          
+        myCrop=new flyHue( width, height,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Hue_Param));
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            memcpy(param,&amp;(myCrop-&gt;param),sizeof(Hue_Param));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+void hue_changed( void)
+{
+  if(lock) return;
+  
+   myCrop-&gt;update();
+  
+}
+void frame_changed( void )
+{
+  myCrop-&gt;sliderChanged();
+}
+gboolean draw (void)
+{
+    myCrop-&gt;display();
+}
+//
+void upload( void)
+{
+    myCrop-&gt;upload();
+}
+void download (void)
+{
+     myCrop-&gt;download();
+}
+/**************************************/
+uint8_t flyHue::upload(void)
+{
+    lock++;
+      gtk_range_set_value (GTK_RANGE(WID(hscaleHue)),(gdouble)param.hue);
+      gtk_range_set_value (GTK_RANGE(WID(hscaleSaturation)),(gdouble)param.saturation);
+    lock--;
+        return 1;
+}
+uint8_t flyHue::download (void)
+{
+    
+       GtkAdjustment *adj;	
+
+        adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleHue)));
+        param.hue=(float)GTK_ADJUSTMENT(adj)-&gt;value;
+        
+        adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleSaturation)));
+        param.saturation=(float)GTK_ADJUSTMENT(adj)-&gt;value;
+        return 1;
+}
+
+
+
+
+//******************
+GtkWidget   *create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *table1;
+  GtkWidget *label1;
+  GtkWidget *label2;
+  GtkWidget *hscaleHue;
+  GtkWidget *hscaleSaturation;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Hue/Saturation&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  table1 = gtk_table_new (2, 2, FALSE);
+  gtk_widget_show (table1);
+  gtk_box_pack_start (GTK_BOX (vbox1), table1, TRUE, TRUE, 0);
+
+  label1 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Hue:&lt;/b&gt;&quot;));
+  gtk_widget_show (label1);
+  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_use_markup (GTK_LABEL (label1), TRUE);
+  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
+
+  label2 = gtk_label_new (QT_TR_NOOP(&quot;&lt;b&gt;Saturation:&lt;/b&gt;&quot;));
+  gtk_widget_show (label2);
+  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_use_markup (GTK_LABEL (label2), TRUE);
+  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
+
+  hscaleHue = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -90, 90, 1, 1, 1)));
+  gtk_widget_show (hscaleHue);
+  gtk_table_attach (GTK_TABLE (table1), hscaleHue, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  hscaleSaturation = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -10, 10, 1, 1, 1)));
+  gtk_widget_show (hscaleSaturation);
+  gtk_table_attach (GTK_TABLE (table1), hscaleSaturation, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleHue, &quot;hscaleHue&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleSaturation, &quot;hscaleSaturation&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
+
+  return dialog1;
+}

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,116 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;Q_hue.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_hueWindow::Ui_hueWindow(Hue_Param *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyHue( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(Hue_Param));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+#define SPINNER(x) connect( ui.horizontalSlider##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Hue);
+          SPINNER(Saturation);
+
+  }
+  void Ui_hueWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_hueWindow::gather(Hue_Param *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(Hue_Param));
+  }
+Ui_hueWindow::~Ui_hueWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_hueWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define MYSPIN(x) w-&gt;horizontalSlider##x
+#define MYCHECK(x) w-&gt;checkBox##x
+//************************
+uint8_t flyHue::upload(void)
+{
+      Ui_hueDialog *w=(Ui_hueDialog *)_cookie;
+
+        MYSPIN(Saturation)-&gt;setValue((int)param.saturation);
+        MYSPIN(Hue)-&gt;setValue((int)param.hue);
+        return 1;
+}
+uint8_t flyHue::download(void)
+{
+       Ui_hueDialog *w=(Ui_hueDialog *)_cookie;
+         param.hue=MYSPIN(Hue)-&gt;value();
+         param.saturation=MYSPIN(Saturation)-&gt;value();
+return 1;
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+uint8_t DIA_getHue(Hue_Param *param,AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_hueWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/Q_hue.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,33 @@
+#ifndef Q_hue_h
+#define Q_hue_h
+
+#include &quot;ui_hue.h&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidHue.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyHue.h&quot;
+
+class Ui_hueWindow : public QDialog
+{
+	Q_OBJECT
+
+protected:
+	int lock;
+
+public:
+	flyHue *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_hueWindow(Hue_Param *param,AVDMGenericVideoStream *in);
+	~Ui_hueWindow();
+	Ui_hueDialog ui;
+
+public slots:
+	void gather(Hue_Param *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+};
+#endif	// Q_hue_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/hue.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/hue.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Hue/qt4/hue.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,179 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;hueDialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;hueDialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;505&lt;/width&gt;
+    &lt;height&gt;475&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Hue&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeType&quot; &gt;
+      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;20&lt;/width&gt;
+       &lt;height&gt;40&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;layout class=&quot;QVBoxLayout&quot; &gt;
+     &lt;property name=&quot;spacing&quot; &gt;
+      &lt;number&gt;6&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;leftMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;topMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;rightMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;bottomMargin&quot; &gt;
+      &lt;number&gt;0&lt;/number&gt;
+     &lt;/property&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Hue&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderHue&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;-90&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;90&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
+       &lt;property name=&quot;text&quot; &gt;
+        &lt;string&gt;Saturation&lt;/string&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+     &lt;item&gt;
+      &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSliderSaturation&quot; &gt;
+       &lt;property name=&quot;minimum&quot; &gt;
+        &lt;number&gt;-10&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;maximum&quot; &gt;
+        &lt;number&gt;10&lt;/number&gt;
+       &lt;/property&gt;
+       &lt;property name=&quot;orientation&quot; &gt;
+        &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+       &lt;/property&gt;
+      &lt;/widget&gt;
+     &lt;/item&gt;
+    &lt;/layout&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;hueDialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;hueDialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt	2008-05-25 17:48:15 UTC (rev 4065)
@@ -3,7 +3,8 @@
 SET(resizeCommon_SRCS ADM_vidMPLResize.cpp)
 SET(resizeCommonGtk_SRCS gtk/gtk_resize.cpp)
 SET(resizeCommonQT_SRCS qt4/Q_resize.cpp)
-SET(resizeCommonQT_UI resizing)
+SET(resizeCommonQT_Headers qt4/Q_resize.h)
+SET(resizeCommonQT_UI qt4/resizing)
 
 INCLUDE_DIRECTORIES(&quot;${CMAKE_CURRENT_SOURCE_DIR}/../../../&quot;)
 INCLUDE_DIRECTORIES(&quot;${CMAKE_CURRENT_SOURCE_DIR}/../&quot;)
@@ -16,7 +17,7 @@
 ENDIF (GTK_FOUND AND GTHREAD_FOUND)
 
 INCLUDE(vf_plugin_qt4)
-INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_mplayerResize_qt4 ${resizeCommonQT_SRCS} ${resizeCommonQT_UI} ${resizeCommon_SRCS})
+INIT_VIDEOFILTER_PLUGIN_QT4(ADM_vf_mplayerResize_qt4 ${resizeCommonQT_SRCS} ${resizeCommonQT_Headers} ${resizeCommonQT_UI} ${resizeCommon_SRCS})
 
 IF (QT4_FOUND)
 	TARGET_LINK_LIBRARIES(ADM_vf_mplayerResize_qt4 ADM_libswscale ADM_libavcodec ADM_libavutil ADM_UIQT4)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -21,7 +21,10 @@
                               {1.,1.066667,1.43} // PAL  1:1 4:3 16:9
                             };
 #define aprintf printf
-
+resizeWindow::~resizeWindow()
+  {
+    
+  }
 resizeWindow::resizeWindow(resParam *param)     : QDialog()
  {
      ui.setupUi(this);

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/Q_resize.h
===================================================================

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/resizing.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/resizing.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/MplayerResize/qt4/resizing.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -20,7 +20,8 @@
 	resParam *_param;
 
 public:
-	resizeWindow(resParam *param);
+	resizeWindow(resParam *param);
+	~resizeWindow();
 	Ui_resizeDialog ui;
 
 public slots:

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,402 @@
+/***************************************************************************
+                          ADM_vidSRT.cpp  -  description
+                             -------------------
+    begin                : Thu Dec 12 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+
+#ifdef USE_FREETYPE
+#include &quot;ADM_default.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+
+#include &quot;ADM_video/ADM_vidFont.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+
+#include &quot;ADM_osSupport/ADM_debugID.h&quot;
+#define MODULE_NAME MODULE_FILTER
+#include &quot;ADM_osSupport/ADM_debug.h&quot;
+
+#include &quot;prefs.h&quot;
+
+static FILTER_PARAM subParam={15,{&quot;_fontsize&quot;,&quot;_subname&quot;,&quot;_fontname&quot;,&quot;_charset&quot;,
+				&quot;_baseLine&quot;,&quot;_Y_percent&quot;,&quot;_U_percent&quot;,&quot;_V_percent&quot;,
+				&quot;_selfAdjustable&quot;,&quot;_delay&quot;,&quot;_useBackgroundColor&quot;,&quot;_bg_Y_percent&quot;,
+      				&quot;_bg_U_percent&quot;,&quot;_bg_V_percent&quot;,&quot;_blend&quot;}};
+
+SCRIPT_CREATE(subtitle_script,ADMVideoSubtitle,subParam);
+
+BUILD_CREATE(subtitle_create,ADMVideoSubtitle);
+
+//__________________________________________________________________
+
+//_______________________________________________________________
+
+//__________________________________________________________________
+
+char 								*ADMVideoSubtitle::printConf(void)
+ {
+	  	static char buf[50];
+ 	
+ 				sprintf((char *)buf,&quot;Subtitle &quot;);
+        return buf;
+	}
+
+//--------------------------------------------------------	
+ADMVideoSubtitle::ADMVideoSubtitle(AVDMGenericVideoStream *in,CONFcouple *couples)
+{
+
+  uint32_t frame;
+//  char c;
+
+  _uncompressed=NULL;
+  _font=NULL;
+
+
+  _in=in;
+  memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));
+
+	frame=3*_in-&gt;getInfo()-&gt;width*_in-&gt;getInfo()-&gt;height;
+
+	_subs=NULL;
+	_fd=NULL;
+ 	_line=0;
+	_oldframe=0;
+	_oldline=0;
+	_font = new ADMfont();	
+	if(couples)
+	{
+                int32_t b;
+			SUBCONF *_param;
+			_conf=NEW( SUBCONF);
+
+
+			_param=_conf; // keep macro happy
+
+			GET(_fontsize);
+			GET(_subname);
+			GET(_fontname);
+			GET(_charset);
+			GET(_baseLine);
+			GET(_Y_percent);
+			GET(_U_percent);
+			GET(_V_percent);
+			GET(_selfAdjustable);
+			GET(_delay);
+			GET(_useBackgroundColor);
+			GET(_bg_Y_percent);
+      			GET(_bg_U_percent);
+      			GET(_bg_V_percent);
+//                        GET(_blend);
+                        couples-&gt;getCouple(&quot;_blend&quot;,&amp;b);
+                        _param-&gt;_blend=(BlendMode)b;
+			if(_conf-&gt;_baseLine&gt;_info.height-_conf-&gt;_fontsize*SRT_MAX_LINE)
+                        {
+                                printf(&quot;Base exceeded : base :%lu height :%lu bottom:%lu\n&quot;,
+                                        _conf-&gt;_baseLine,_info.height,_info.height-_conf-&gt;_fontsize*SRT_MAX_LINE);
+                                _conf-&gt;_baseLine=_conf-&gt;_fontsize*SRT_MAX_LINE;
+                        }
+
+                    char *ft,*sub;
+                        ft=(char *)ADM_alloc(500);
+                        sub=(char *)ADM_alloc(500);
+                        strcpy(ft,(char *)_conf-&gt;_subname); 
+                        _conf-&gt;_subname=(ADM_filename *)ft;
+                        strcpy(sub,(char *)_conf-&gt;_fontname); 
+                        _conf-&gt;_fontname=(ADM_filename *)sub;
+
+                        sub=(char *)ADM_alloc(500);
+                        strcpy(sub,_conf-&gt;_charset);
+                        _conf-&gt;_charset=sub;
+                        loadSubtitle();
+                        loadFont();
+
+	}
+	else
+	{
+			_conf=NEW( SUBCONF);
+
+			_conf-&gt;_fontname=(ADM_filename *)ADM_alloc(500);
+			_conf-&gt;_subname=(ADM_filename *)ADM_alloc(500);
+			_conf-&gt;_charset=(char *)ADM_alloc(500);
+			_conf-&gt;_fontname[0]=0;
+			_conf-&gt;_subname[0]=0;
+			_conf-&gt;_charset[0]=0;
+			
+			
+			_conf-&gt;_baseLine=_info.height-24*SRT_MAX_LINE;
+			_conf-&gt;_Y_percent=255;
+			_conf-&gt;_U_percent=0;
+			_conf-&gt;_V_percent=0;
+                        _conf-&gt;_fontsize=24; 
+			_conf-&gt;_selfAdjustable=0;
+			_conf-&gt;_delay=0;
+			_conf-&gt;_useBackgroundColor=0;
+			
+			_conf-&gt;_bg_Y_percent=0;
+			_conf-&gt;_bg_U_percent=0;
+			_conf-&gt;_bg_V_percent=0;
+                        _conf-&gt;_blend=BLEND_SOLID;
+
+			prefs-&gt;get(FILTERS_SUBTITLE_FONTSIZE,&amp;(_conf-&gt;_fontsize));
+			prefs-&gt;get(FILTERS_SUBTITLE_YPERCENT,&amp;(_conf-&gt;_Y_percent));
+			prefs-&gt;get(FILTERS_SUBTITLE_UPERCENT,&amp;(_conf-&gt;_U_percent));
+			prefs-&gt;get(FILTERS_SUBTITLE_VPERCENT,&amp;(_conf-&gt;_V_percent));
+			prefs-&gt;get(FILTERS_SUBTITLE_SELFADJUSTABLE,&amp;(_conf-&gt;_selfAdjustable));			
+			prefs-&gt;get(FILTERS_SUBTITLE_USEBACKGROUNDCOLOR,&amp;(_conf-&gt;_useBackgroundColor));
+			
+			// _conf-&gt;_fontname, ... are used as memory for a dialog
+			// later. we can't used the length of the current string
+			{ char *tmp;
+			   prefs-&gt;get(FILTERS_SUBTITLE_FONTNAME,&amp;tmp);
+			   strcpy((char *)_conf-&gt;_fontname,tmp);
+			   ADM_dealloc(tmp);
+			   
+			   prefs-&gt;get(FILTERS_SUBTITLE_CHARSET,&amp;tmp);
+			   strcpy(_conf-&gt;_charset,tmp); 
+                           ADM_dealloc(tmp);
+			}
+			
+	}
+
+  
+  	_info.encoding=1;
+
+
+	_bitmap=0xffffffff;
+#define BITMAP_SIZE _info.width*_conf-&gt;_fontsize*SRT_MAX_LINE
+	_bitmapBuffer=new uint8_t[_info.width*_info.height];
+	_maskBuffer=new uint8_t[_info.width*_info.height];
+  _bgBitmapBuffer=new uint8_t[(_info.width*_info.height)&gt;&gt;1];
+	_bgMaskBuffer=new uint8_t[_info.width*_info.height];
+        _dirty=new uint8_t[_info.height];
+	ADM_assert(_bitmapBuffer);
+	ADM_assert(_maskBuffer);
+	ADM_assert(_bgBitmapBuffer);
+	ADM_assert(_bgMaskBuffer);
+        ADM_assert(_dirty);
+}
+uint8_t	ADMVideoSubtitle::loadSubtitle( void )
+{
+unsigned char c,d;
+			_fd=fopen((char *)_conf-&gt;_subname,&quot;rt&quot;);
+			if(!_fd)
+			{
+                          GUI_Error_HIG(QT_TR_NOOP(&quot;Could not open subtitle file&quot;), NULL);
+				return 0;
+			}
+			// Try to detect utf16 files			
+			c=fgetc(_fd);
+			// Skip utf identifier if any
+			if( (c&amp;0xef)==0xef)
+			{
+                          int count=4;
+                                while(count-- &amp;&amp; c&amp;0x80) c=fgetc(_fd);
+			}
+			switch(c)
+			{
+			case '{' :
+						loadSubTitle();
+						break;
+			case '1' :
+						loadSRT();
+						break;
+			default:
+                          GUI_Error_HIG(QT_TR_NOOP(&quot;Cannot identify subtitle format&quot;), NULL);
+			}
+
+  // Apply delay to subtitles
+  
+  aprintf(&quot;[debug] DELAY %d\n&quot;, _conf-&gt;_delay);
+  if(_conf-&gt;_delay)
+  {
+  	int32_t newStartTime;
+	int32_t newEndTime;
+	for(uint32_t i=0;i&lt;_line;i++) 
+	{
+		aprintf(&quot;[debug] BEFORE DELAY (%d) %d %d\n&quot;,i, _subs[i].startTime,_subs[i].endTime);
+		newStartTime=_subs[i].startTime;
+		newStartTime+=_conf-&gt;_delay;
+		_subs[i].startTime=(newStartTime);
+		newEndTime=_subs[i].endTime;
+		newEndTime+=_conf-&gt;_delay;
+		_subs[i].endTime=(newEndTime);
+		// put them at infinit display time
+		// should get rid of them
+		if(newEndTime&lt;0 || newStartTime&lt;0)
+		{
+			_subs[i].startTime=_subs[i].endTime=0;
+		}
+		aprintf(&quot;[debug] AFTER DELAY (%d) %d %d\n&quot;,i, _subs[i].startTime,_subs[i].endTime);
+  	}
+  }
+
+
+	fclose(_fd);
+	_fd=NULL;
+	_bitmap=0xffffffff;
+	if(_line)	// that way we will have the first sub
+		_oldline=_line-1;
+	return 1;
+}
+uint8_t	ADMVideoSubtitle::getCoupledConf( CONFcouple **couples)
+{
+SUBCONF *_param;
+
+			_param=_conf; // keep macro happy
+			ADM_assert(_param);
+			*couples=new CONFcouple(15);
+
+			CSET(_fontsize);
+			CSET(_subname);
+			CSET(_fontname);
+			CSET(_charset);
+			CSET(_baseLine);
+			CSET(_Y_percent);
+			CSET(_U_percent);
+			CSET(_V_percent);
+			CSET(_selfAdjustable);
+			CSET(_delay);
+			CSET(_useBackgroundColor);
+			CSET(_bg_Y_percent);
+			CSET(_bg_U_percent);
+			CSET(_bg_V_percent);
+                        (*couples)-&gt;setCouple(&quot;_blend&quot;,(uint32_t)_param-&gt;_blend);
+
+		return 1;
+
+}
+//__________________________________________________________________
+
+ADMVideoSubtitle::~ADMVideoSubtitle()
+{
+
+		if(_bitmapBuffer)
+			{
+				delete [] _bitmapBuffer;
+				_bitmapBuffer=0;
+			}
+		if(_maskBuffer)
+			{
+				delete [] _maskBuffer;
+				_maskBuffer=0;
+			}
+
+ 		if(_bgBitmapBuffer) 
+			{
+				delete [] _bgBitmapBuffer;
+				_bgBitmapBuffer=0;
+			}
+ 
+		if(_bgMaskBuffer) 
+			{
+				delete [] _bgMaskBuffer;
+				_bgMaskBuffer=0;
+			}
+                if(_dirty)
+                {
+                                delete [] _dirty;
+                                _dirty=0;
+                }
+
+		if(_fd)
+		{
+				fclose(_fd);
+				_fd=NULL;
+		}
+		if(_subs)
+		{
+				for(uint32_t i=0;i&lt;_line;i++)
+				{
+					if(_subs[i].nbLine)
+					{
+					for(uint32_t k=0;k&lt;_subs[i].nbLine;k++)
+					{					
+						if(_subs[i].string[k])
+						{
+							delete [] _subs[i].string[k];
+							_subs[i].string[k]=NULL;
+						}
+					}					
+					
+					delete _subs[i].string;
+					_subs[i].string=NULL;
+					delete _subs[i].lineSize;
+					_subs[i].lineSize=NULL;
+					}
+				}
+				delete [] _subs;
+				_subs=NULL;
+		}
+	if(_conf)
+	{
+			ADM_dealloc(_conf-&gt;_subname);
+			ADM_dealloc(_conf-&gt;_fontname);
+			ADM_dealloc(_conf-&gt;_charset);
+
+		 	DELETE(_conf);
+	}
+	if(_font)
+	{
+		delete _font;
+		_font=NULL;
+	}
+}
+
+uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param);
+    
+uint8_t ADMVideoSubtitle::configure(AVDMGenericVideoStream *instream)
+{
+  
+  UNUSED_ARG(instream);
+//char c;
+uint8_t ret=0;
+int charset=0;
+uint32_t l,f;
+
+                        
+          if(DIA_srt(	instream,_conf))
+          {
+            printf(&quot;\n Font : %s&quot;, _conf-&gt;_fontname);
+            printf(&quot;\n Sub  : %s&quot;, _conf-&gt;_subname);
+            printf(&quot;\n Font size : %ld&quot;,_conf-&gt;_fontsize);
+            printf(&quot;\n Charset : %d&quot;,charset);
+            printf(&quot;\n Y : %ld&quot;,_conf-&gt;_Y_percent);
+            printf(&quot;\n U : %ld&quot;,_conf-&gt;_U_percent);
+            printf(&quot;\n V : %ld&quot;,_conf-&gt;_V_percent);
+
+
+            loadSubtitle();
+            loadFont();
+                        
+            prefs-&gt;set(FILTERS_SUBTITLE_FONTNAME,
+                    (ADM_filename *)_conf-&gt;_fontname);
+            prefs-&gt;set(FILTERS_SUBTITLE_CHARSET,
+                    _conf-&gt;_charset);
+            prefs-&gt;set(FILTERS_SUBTITLE_FONTSIZE,_conf-&gt;_fontsize);
+            prefs-&gt;set(FILTERS_SUBTITLE_YPERCENT,_conf-&gt;_Y_percent);
+            prefs-&gt;set(FILTERS_SUBTITLE_UPERCENT,_conf-&gt;_U_percent);
+            prefs-&gt;set(FILTERS_SUBTITLE_VPERCENT,_conf-&gt;_V_percent);
+            prefs-&gt;set(FILTERS_SUBTITLE_SELFADJUSTABLE,
+                        _conf-&gt;_selfAdjustable);
+            prefs-&gt;set(FILTERS_SUBTITLE_USEBACKGROUNDCOLOR,
+                        _conf-&gt;_useBackgroundColor);
+            ret=1;
+        }
+        return ret;
+
+}
+#endif
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRT.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRT.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,128 @@
+/***************************************************************************
+                          ADM_vidSRT.h  -  description
+                             -------------------
+    begin                : Thu Dec 12 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+    
+    Lots of bugfixes / enhancement by Daniel Lima
+    
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifdef USE_FREETYPE
+
+#define SRT_MAX_LINE 3
+#define SRT_MAX_LINE_LENGTH 512
+
+#define ADM_GLYPH_T uint16_t 
+// UTF16 -&gt; Ascii
+
+#define ADM_ASC(x) x
+
+typedef struct subLine
+{
+  
+	uint32_t 		startTime;
+	uint32_t 		endTime;
+	uint32_t		nbLine;
+	uint32_t		*lineSize;
+	ADM_GLYPH_T		**string;
+	
+}subLine;
+
+typedef enum 
+{
+        BLEND_SOLID=1,
+        BLEND_DOTTED,
+        BLEND_DIMMER
+}BlendMode;
+
+typedef struct SUBCONF
+{
+		uint32_t _fontsize;
+		uint32_t _baseLine;
+
+  /** YUV font color components */
+		int32_t    _Y_percent;
+		int32_t    _U_percent;
+		int32_t    _V_percent;
+		ADM_filename	*_fontname;
+		ADM_filename	*_subname;
+		char 		*_charset;
+		uint32_t	_selfAdjustable;   /** Automatic line breaks */
+		int32_t		_delay;            
+		/** Wait x miliseconds before show subtitles. If negative, it will to show subtitles x */
+		/* miliseconds before. */
+
+
+		uint32_t	_useBackgroundColor;
+
+  /** YUV background color components */
+		int32_t   _bg_Y_percent;
+		int32_t   _bg_U_percent;
+		int32_t   _bg_V_percent;
+                BlendMode _blend;
+
+
+	}SUBCONF;
+
+  class  ADMVideoSubtitle:public AVDMGenericVideoStream
+ {
+
+ protected:
+
+	    	SUBCONF					*_conf;		
+       virtual char 					*printConf(void) ;
+        FILE						*_fd;
+        uint8_t						loadSubTitle( void );
+	uint8_t  					loadSRT( void )        ;
+        uint32_t					_line;
+        subLine						*_subs;
+        uint32_t					_oldframe;
+        uint32_t					_oldline;
+        uint32_t					_bitmap;
+        uint32_t					search(uint32_t time);
+        void 						displayString(subLine *string);
+	void 						displayString_autoadj(char *string);
+        void 						displayChar(uint32_t w,uint32_t h,char c);
+  	uint32_t					displayLine(ADM_GLYPH_T *string,uint32_t line, uint32_t len);
+  
+	uint8_t 					lowPass(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h);
+	uint8_t 					decimate(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h);
+
+
+        uint8_t						*_bitmapBuffer;
+	uint8_t						*_maskBuffer;
+	uint8_t						*_bgBitmapBuffer;
+	uint8_t						*_bgMaskBuffer;
+        uint8_t                                         *_dirty;
+	uint8_t						blend(uint8_t *target,uint32_t baseLine);
+	ADMfont						*_font;
+	uint8_t						loadSubtitle(void);
+	uint8_t						loadFont(void);
+	uint8_t 					subParse( subLine *in, char *string );
+        uint8_t                                         doChroma(void);
+        uint8_t                                         clearBuffers(void);
+        void                                            doAutoSplit(subLine *string);
+        uint8_t                                         isDirty(int line);
+
+ public:
+ 		
+  						ADMVideoSubtitle(  AVDMGenericVideoStream *in,CONFcouple *setup);
+  						~ADMVideoSubtitle();
+		      virtual uint8_t 		getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+       								ADMImage *data,uint32_t *flags);
+
+			virtual uint8_t	getCoupledConf( CONFcouple **couples)		;
+			virtual uint8_t 	configure( AVDMGenericVideoStream *instream);
+							
+ }     ;
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTRender.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTRender.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,783 @@
+/***************************************************************************
+                          ADM_vidSRT.cpp  -  description
+                             -------------------
+    begin                : Thu Dec 12 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+
+#ifdef USE_FREETYPE
+#include &lt;math.h&gt;
+
+#include &quot;ADM_default.h&quot;
+
+
+#include &quot;ADM_videoFilter.h&quot;
+
+#include &quot;ADM_video/ADM_vidFont.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+
+#include &quot;ADM_osSupport/ADM_debugID.h&quot;
+#define MODULE_NAME MODULE_FILTER
+#include &quot;ADM_osSupport/ADM_debug.h&quot;
+
+#define SUB_OUT 0xf0000000
+#define ALPHA
+#define LUMA_LEVEL 10
+
+#define SAFE_STRCPY(dest,destLen,src,srcLen) \
+memcpy(dest,src,srcLen&lt;destLen?srcLen:destLen-1); \
+dest[srcLen&lt;destLen?srcLen:destLen-1]='\0'; \
+
+
+//                     1
+//		Get in range in 121 + coeff matrix
+//                     1
+//
+// If the value is too far away we ignore it
+// else we blend
+//__________________________________________________________________
+uint8_t ADMVideoSubtitle::getFrameNumberNoAlloc(uint32_t frame,
+						uint32_t *len,
+   						ADMImage *data,
+   						uint32_t *flags)
+{
+
+double f;
+uint32_t time,srch;
+uint32_t absFrame=frame+_info.orgFrame;
+
+	//		printf(&quot;\n Stabilize : %lu\n&quot;,frame);
+          _uncompressed=data;
+	if(frame&gt;=_info.nb_frames) 
+	{
+		printf(&quot;Filter : out of bound!\n&quot;);
+		return 0;
+	}
+	if(!_in-&gt;getFrameNumberNoAlloc(frame, len,data,flags)) return 0;
+
+	// if no subtitle return...
+	if(!_subs) return 1;
+
+	// compute time stamp
+	      f=absFrame*1000000./_info.fps1000;
+	      time=(uint32_t) floor(f);
+	      // Do we have it already ?
+
+	      if(time&lt;=_subs[_oldline].endTime &amp;&amp; time &gt;=_subs[_oldline].startTime)
+	      {
+	      		aprintf(&quot;Sub: cached %lu %lu %lu\n&quot;,time,_subs[_oldline].startTime,_subs[_oldline].endTime);
+			blend(YPLANE(data),_conf-&gt;_baseLine); // re-use it
+			return 1;	
+
+	      }
+	      srch=search(time);
+	      // we got the right one
+     
+	      if(srch!=SUB_OUT) // we got something...
+			{
+					_oldline=srch;
+					aprintf(&quot;Sub: Using line %d\n&quot;,srch);
+					//printf(&quot;\n %s \n&quot;,_subs[_oldline].string);
+					displayString(&amp;(_subs[_oldline]));
+					blend(YPLANE(data),_conf-&gt;_baseLine);
+			}
+
+		return 1;
+
+}
+//_________________________________________________________________
+uint32_t	ADMVideoSubtitle::search(uint32_t time)
+{
+	if(time&lt;_subs[0].startTime)
+		return SUB_OUT;
+
+	  for(uint32_t i=0;i&lt;_line;i++)
+	  {
+				if((time&lt;=_subs[i].endTime)  &amp;&amp;
+					(time&gt;=_subs[i].startTime)
+				)
+				return i;
+
+		}
+		return SUB_OUT;
+}
+//
+//	Display up to 3 lines of text centered on screen
+//  Each line is separated by a |
+// It is the basic version that tries to use only 2 lines
+// in most cases, 3 when needed
+//______________________________________
+void ADMVideoSubtitle::displayString(subLine *string)
+{
+ 
+	uint32_t base=0;	
+	uint32_t nbLine=0;
+	uint32_t i=0;
+	uint32_t overflow=0;
+
+      aprintf(&quot;Sub: Rendering string %s\n&quot;,string);
+// bbase is the final position in line
+// in the image
+
+	clearBuffers();
+	nbLine=string-&gt;nbLine;
+	if(nbLine&gt;SRT_MAX_LINE )
+	{
+		nbLine=SRT_MAX_LINE;
+		printf(&quot;Too much lines\n&quot;);
+	}
+	switch(nbLine)
+	{
+		case 0:
+			base=2*_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line		
+			break;
+		case 1:
+			base=_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line		
+			break;
+		default:
+                        base=0;
+                        break;
+	}	
+		
+	aprintf(&quot;Sub: %d lines to render\n&quot;,nbLine);
+	// scan and display each line
+	for(i=0;i&lt;nbLine;i++)
+	{
+		
+			if(string-&gt;lineSize[i]!=displayLine(string-&gt;string[i],base,string-&gt;lineSize[i]))
+                                overflow=1;
+			base+=_conf-&gt;_fontsize;
+		
+	}
+        if(overflow &amp;&amp; _conf-&gt;_selfAdjustable) 
+        {
+                printf(&quot;Do autosplit\n&quot;);
+                doAutoSplit(string);
+        }
+    	doChroma();
+	// Compute the dirty state
+        // If a line is not set as dirty, it means it has no pixel in it
+        // In fact we do top/bottom and add a tiny bit to it
+        memset(_dirty,1,_info.height);
+
+        // First to top
+
+        int top=0,bottom=_info.height-1,limit;
+        while(top&lt;_info.height &amp;&amp; !isDirty(top)) top++;
+        if(top&gt;_conf-&gt;_fontsize&gt;&gt;1) top-=_conf-&gt;_fontsize&gt;&gt;1;
+        memset(&amp;(_dirty[0]),0,top); // Clear top
+        
+        // Then bottom
+        limit=(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
+        if(limit&gt;=_info.height) limit=_info.height-1;
+
+
+        bottom=limit;
+        while(bottom&gt;top &amp;&amp; !isDirty(bottom)) bottom--;
+        if(bottom+(_conf-&gt;_fontsize&gt;&gt;1)&lt;limit) bottom+=_conf-&gt;_fontsize&gt;&gt;1;
+        ADM_assert(bottom&lt;=limit);
+        memset(&amp;(_dirty[bottom]),0,limit-bottom+1);
+        //printf(&quot;Top:%d bottom :%d limit:%d\n&quot;,top,bottom,limit);
+	
+}
+uint8_t ADMVideoSubtitle::isDirty(int line)
+{
+        uint8_t *base=_maskBuffer+_info.width*line;
+        for(int x=0;x&lt;_info.width;x++)
+        {
+                if(base[x]) return 1;
+        }
+        return 0;
+}
+/*
+        We merge the whole lines into one then split it
+        to avoid truncated subs
+*/
+void ADMVideoSubtitle::doAutoSplit(subLine *string)
+{
+        uint32_t base=0;    
+        uint32_t nbLine=0;
+        uint32_t i=0;
+        int      total=0,start,end,pivot;
+
+        aprintf(&quot;Sub: Autospliting \n&quot;);
+        nbLine=string-&gt;nbLine;
+
+        // Merge all strings into one
+
+        for(int i=0;i&lt;nbLine;i++) 
+                total+=1+string-&gt;lineSize[i];
+
+        ADM_GLYPH_T allwords[total];
+        int         offset[total];
+        int         sentence[total];
+        int         nbWords=0;
+        //
+        start=0;
+        for(int i=0;i&lt;nbLine;i++) 
+        {
+                memcpy(&amp;(allwords[start]),string-&gt;string[i],string-&gt;lineSize[i]*sizeof(ADM_GLYPH_T));
+                start+=string-&gt;lineSize[i];
+                allwords[start]=' ';
+                start++;
+        }
+        // Remove the last ' '
+        start--;
+        end=start;
+        // Here we go, we have now one line made of all merged sub
+        // We will put as much as possible into one displayed line
+        // then switch to the next one
+        //
+        printf(&quot;The new stuff is :&lt;&quot;);
+        for(i=0;i&lt;end;i++)
+                printf(&quot;%c&quot;,allwords[i]);
+        printf(&quot;&gt;\n&quot;);
+        
+        // Split into words
+        pivot=0;
+        int car;
+        offset[0]=0;
+        nbWords=1;
+        while(pivot&lt;end)
+        {
+                car=ADM_ASC(allwords[pivot]);
+                if(car==' ' || car=='.' || car ==',')
+                        {
+                                offset[nbWords++]=pivot;
+                        }
+                pivot++;
+        }
+        printf(&quot;Found %d words\n&quot;,nbWords); 
+        // Now  split
+        int nbSentence=0,len;
+        pivot=0;
+        sentence[0]=0;
+        // Try to display as much as possible in one line
+        // We build sentence here
+        while(pivot&lt;nbWords)
+        {
+                for(i=pivot+1;i&lt;nbWords;i++)
+                {
+                        len=offset[i]-offset[pivot];
+                        if(len!=displayLine(&amp;(allwords[offset[pivot]]),0,len)) break;
+                }
+                sentence[nbSentence]=offset[pivot];
+                nbSentence++;
+                if(i&gt;1 &amp;&amp; i!=nbWords) i--;
+                pivot=i;
+        }
+        printf(&quot;0: %d,off:%d\n&quot;,sentence[0],offset[0]);
+        // Take the last word
+        sentence[nbSentence]=end;
+
+        if(nbSentence&gt;SRT_MAX_LINE) nbSentence=SRT_MAX_LINE;
+        // now display
+        printf(&quot;Nb sentence:%d\n&quot;,nbSentence);
+        for(int j=0;j&lt;nbSentence;j++)
+        {
+                printf(&quot;Sentence %d:&quot;,j);
+                for(int k=sentence[j];k&lt;sentence[j+1];k++)
+                        printf(&quot;%c&quot;,allwords[k]);
+                printf(&quot;\n&quot;);
+        }
+        // now display
+        
+        switch(nbSentence)
+        {
+                case 0:
+                        base=2*_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line            
+                        break;
+                case 1:
+                        base=_conf-&gt;_fontsize;; // 1 or 2 lines we dont use the upper line              
+                        break;
+                default:
+                        base=0;
+                        break;
+        }
+        // scan and display each line
+        clearBuffers();
+        printf(&quot;Display\n&quot;);
+        for(i=0;i&lt;nbSentence;i++)
+        {
+                        len=sentence[i+1]-sentence[i];
+                        displayLine(&amp;(allwords[sentence[i]]),base,len);
+                        //displayLine(allwords,base,10);
+                        base+=_conf-&gt;_fontsize;
+        }
+        printf(&quot;/Display\n&quot;);
+        
+}
+/*
+        Once we have the subtitle built, we do the u&amp; v planes
+        and some smoothing to avoid over sharpening on the chroma plane
+
+*/
+uint8_t ADMVideoSubtitle::doChroma(void)
+{
+// now blur bitmap into mask..
+        memset(_maskBuffer,0,SRT_MAX_LINE*_conf-&gt;_fontsize*_info.width);
+
+        uint32_t off;
+        uint8_t *src,*dst;
+
+        off=0;
+
+        src=_bitmapBuffer;
+        dst=_maskBuffer;
+
+
+        // We shrink it down for u &amp; v by 2x2
+        // mask buffer-&gt;bitmap buffer
+
+        uint8_t tmp[_info.width*_info.height];
+
+        decimate(src,tmp,_info.width,_info.height);
+        lowPass(src,dst,_info.width,_info.height);
+        lowPass(tmp,src,_info.width&gt;&gt;1,_info.height&gt;&gt;1);
+
+        if (_conf-&gt;_useBackgroundColor) 
+        {
+                decimate(_bgMaskBuffer,_bgBitmapBuffer,_info.width,_info.height);
+                //lowPass(tmp,_bgBitmapBuffer,_info.width&gt;&gt;1,_info.height&gt;&gt;1);
+        }
+  
+}
+/*
+        Clear the buffers in case we do a new sub or
+                redo one in case it overflows
+*/
+uint8_t ADMVideoSubtitle::clearBuffers(void)
+{
+        memset(_bitmapBuffer,0,_info.height*_info.width);
+        memset(_maskBuffer,0,_info.height*_info.width);
+        memset(_bgBitmapBuffer,0,(_info.height*_info.width)&gt;&gt;1);
+        memset(_bgMaskBuffer,0,_info.height*_info.width);
+        return 1;
+}
+// Display a full line centered on screen. It returns the
+// number of displayed chars.
+//____________________________________________________________
+
+// It also returns the suggested len for this line string (just when display fail)
+//
+uint32_t ADMVideoSubtitle::displayLine(ADM_GLYPH_T *string,uint32_t line, uint32_t len)
+{
+  // n first chars in string that can &quot;fit&quot; in this line
+ 
+
+	//uint32_t pixstart;
+	uint8_t *target;
+	int car;
+
+
+	aprintf(&quot;Sub DisplayString  line %lu len %lu\n&quot;,line,len);
+
+	if(!len)
+	{
+		printf(&quot;\n null string\n&quot;);
+      		return 0;
+	}
+
+
+  
+	uint32_t w=0,next;
+	int ww;
+
+	// we dummy do it one time to get the actual width of the string
+	// and hence perfectly center it
+	target=_maskBuffer+_info.width*line;
+	for(uint32_t i=0;i&lt;len;i++)
+	{
+			if(ADM_ASC(*(string+i))==' ')
+			{
+					w+=_conf-&gt;_fontsize&gt;&gt;2;
+			}
+			else
+			{
+				ww=0;
+				car=string[i];
+				if(i) next=string[i-1];
+					else next=0;
+				// Change ' to &quot;
+				//if(ADM_ASC(car)==0x27)
+				//	car=0x22;
+	        		if(!_font-&gt;fontDraw((char *)(target+1+w),car,next , _info.width,_conf-&gt;_fontsize,&amp;ww))
+				{
+					printf(&quot;Font error\n&quot;);
+              return 0;
+				}
+				if((ww&lt;0)||(ww&gt;64))
+				{
+					printf(&quot;Warning w out of bound (%d)\n&quot;,ww);
+					ww=0;
+				}
+				if(w+ww&gt;_info.width)
+				{
+					printf(&quot;Line too long!\n&quot;);
+					len=i;
+					goto _abt;
+					break;
+				}
+				w=w+ww;
+			}
+      
+	}
+_abt:
+	//Now we can render it at its final position
+	if(w&lt;_info.width)
+	{
+		target=_bitmapBuffer+_info.width*line+((_info.width-w)&gt;&gt;1);
+	}
+	else
+	{
+		target=_bitmapBuffer+_info.width*line+1;
+	}
+
+  //printf(&quot;[debug] line %s\n&quot;,string);
+
+	ww=0;
+	w=0;
+	for(uint32_t i=0;i&lt;len;i++)
+	{
+			if(*(string+i)==' ')
+			{
+					w+=_conf-&gt;_fontsize&gt;&gt;2;
+
+			}
+			else
+			{
+				ww=0;
+				car=string[i];
+				if(i) next=string[i-1];
+					else next=0;
+	        		if(!_font-&gt;fontDraw((char *)(target+1+w),car,next , _info.width,_conf-&gt;_fontsize,&amp;ww))
+				{
+					printf(&quot;Font error\n&quot;);
+              return 0;
+				}
+				if((ww&lt;0)||(ww&gt;64))
+				{
+					printf(&quot;Warning w out of bound (%d)\n&quot;,ww);
+					ww=0;
+				}
+				w=w+ww;
+			}
+      
+	}
+
+  {
+    if (_conf-&gt;_useBackgroundColor) {
+      //Create background info
+      
+      int32_t delta=_info.width*line+((_info.width-w)&gt;&gt;1);
+      uint8_t *bitmapTarget=_bitmapBuffer+delta;
+      uint8_t *maskTarget=_maskBuffer+delta;
+      //uint8_t *bgBitmapTarget=_bgBitmapBuffer+delta;
+      uint8_t *bgMaskTarget=_bgMaskBuffer+delta;
+      
+      delta=3*_info.width;
+      bitmapTarget+=delta;
+      maskTarget+=delta;
+      //bgBitmapTarget+=delta;
+      bgMaskTarget+=delta;
+      
+      for (uint32_t i=0;i&lt;_conf-&gt;_fontsize;i++) {
+	//memset(bgTarget,1,w);
+	for (uint32_t j=0;j&lt;w;j++) {
+	  if (*(bitmapTarget+j)==0) {
+	    *(bgMaskTarget+j)=1;   //at this position, we will apply a different color
+	    //*(bgBitmapTarget+j)=1;
+	    *(maskTarget+j)=0;
+	    *(bitmapTarget+j)=0;
+	  }
+	}
+	bgMaskTarget+=_info.width;
+	//bgBitmapTarget+=_info.width;
+	maskTarget+=_info.width;
+	bitmapTarget+=_info.width;
+      }
+
+    }
+  }
+	
+
+ 
+  return len;
+}
+//--------------------------------------------------------------------
+//
+//	Blend bitmap buffer into final screen
+//      We scan the SRT_MAX_LINE last line
+//--------------------------------------------------------------------
+uint8_t ADMVideoSubtitle::blend(uint8_t *target,uint32_t baseLine)
+{
+
+	uint8_t  *mask; //*oldtarget=target,*
+  uint8_t  *bgMask;
+	int8_t *chromatarget;
+	uint32_t hei,start;
+	uint32_t y;
+	uint32_t val;
+	int32_t ssigned;
+	double alpha,alpha2;
+#define SHADOW_UP 	8
+#define SHADOW_DOWN 	16
+
+	hei=(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
+	if(hei&gt;=_info.height-1) hei=_info.height-1;
+	hei*=_info.width;  // max height of our subtitle
+	
+
+	aprintf(&quot;Sub:Rendering : %d %d %d (yuv)\n&quot;,_conf-&gt;_Y_percent,_conf-&gt;_U_percent,_conf-&gt;_V_percent);
+	
+	// keep a little margin for renderin
+	// to render f y or g
+	if((baseLine) &gt; _conf-&gt;_fontsize)
+		baseLine-=_conf-&gt;_fontsize&gt;&gt;1;
+	
+		
+	//__________________________
+		
+		// Shadow ..
+		uint8_t *shadow=target;
+		uint32_t shadow_pos;
+		
+		shadow_pos=_conf-&gt;_fontsize/10;
+		start=_info.width*baseLine;  // base line in final image
+		// mask out left and right
+		mask=_maskBuffer; 
+				
+ 		shadow+=start+(1+_info.width)*shadow_pos;
+  		for( y=hei;y&gt;0;y--)
+		{
+     		 if(*mask) 
+		 {
+				if(*mask&gt;LUMA_LEVEL)
+				{
+					val=*shadow;
+					val=(val*SHADOW_UP)/SHADOW_DOWN;
+					*shadow=(uint8_t )val;
+				}				
+     		 } 	  
+      
+		shadow++;
+		mask++;
+		}
+	
+	// /Shadow
+	//__________________________
+	start=_info.width*baseLine;  // base line in final image
+
+	chromatarget=(int8_t *)(target+(_info.width*_info.height));
+
+	// mask out left and right
+
+	mask=_maskBuffer;
+  	bgMask=_bgMaskBuffer;
+ 	target+=start;
+        // clip 
+        if(hei+start&gt;_info.width*_info.height)
+        {
+                hei=_info.width*_info.height-start;
+        }
+// Luma
+        int bottom=baseLine+(SRT_MAX_LINE+1)*_conf-&gt;_fontsize;
+        if(bottom&gt;_info.height) bottom=_info.height;
+        for( y=baseLine;y&lt;bottom;y++)
+        {
+            if(!_dirty[y-baseLine])
+            {
+                target+=_info.width;
+                mask+=_info.width;
+                bgMask+=_info.width;
+                 continue;
+            }
+            for(int x=0;x&lt;_info.width;x++)
+            {
+                if(*mask) {
+                                if(*mask&gt;LUMA_LEVEL || _conf-&gt;_useBackgroundColor)
+                                {
+                                        val=*mask*_conf-&gt;_Y_percent+128;
+                                        val&gt;&gt;=8;
+                                        *target=(uint8_t )val;
+                                }
+                                else 
+                                        { *target=0; }
+                        } else 
+                        if(*bgMask)
+                        {
+                                if(_conf-&gt;_useBackgroundColor) 
+                                {
+                                        *target=(uint8_t )_conf-&gt;_bg_Y_percent;
+                                }
+                        }
+                        else
+                                {
+                                        switch(_conf-&gt;_blend)
+                                        {
+                                                case BLEND_SOLID: break;
+                                                case BLEND_DIMMER: *target=(*target*3)&gt;&gt;2;break;
+                                                case BLEND_DOTTED: 
+                                                {
+                                                        int odd;
+                                                                odd= y%_info.width;
+                                                                odd=odd&amp;1;
+                                                                odd+=(1&amp;(y/_info.width));
+                                                                odd&amp;=1;
+                                                                if(odd) *target=0; 
+                                                }
+                                        }
+                                }
+                        
+                target++;
+                mask++;
+                bgMask++;
+              }
+        }
+	
+
+// do u &amp; v
+	int8_t *ctarget;
+
+	baseLine&amp;=0xffffe;
+	start=(_info.width*baseLine)&gt;&gt;2;
+	hei&gt;&gt;=2;
+
+	mask=_bitmapBuffer;
+  	bgMask=_bgBitmapBuffer;
+	ctarget=chromatarget+start;
+	target=(uint8_t *)ctarget;
+
+	ssigned=_conf-&gt;_U_percent;
+	ssigned+=128;
+
+  uint8_t bg_val=(uint8_t) _conf-&gt;_bg_U_percent+128;
+
+//#define MAXVAL(x) {val=*mask*(x)+127;val&gt;&gt;=8;*ctarget=(uint8_t)(val&amp;0xff);}
+
+#define BLEND_LEVEL 	3
+#define BLEND_PERCENT 	20
+
+#define MAXVAL(x)  *target=(uint8_t )ssigned
+#define DOIT if(*mask) \
+		{ \
+			alpha=*mask; \
+			if(alpha&gt;BLEND_LEVEL) \
+				*target=(uint8_t)ssigned; \
+			else			\
+			{			\
+				alpha2=(100-BLEND_PERCENT)*(*target-128); \
+				alpha=BLEND_PERCENT*(ssigned-128); \
+				alpha=(alpha2+alpha)/100; \
+				*target=(uint8_t)(alpha+128) ;\
+			} \
+                } \
+             else if (_conf-&gt;_useBackgroundColor &amp;&amp; *bgMask) {*target=(uint8_t)bg_val;}
+	     
+#define RENDER	     \
+	\
+	for( y=hei;y&gt;0;y--) \
+	{ \
+		DOIT; \
+		ctarget++; \
+		target++; \
+		mask++; \
+	bgMask++; \
+	} \
+	
+	RENDER;
+
+	mask=_bitmapBuffer;
+  	bgMask=_bgBitmapBuffer;
+	ctarget=chromatarget+start+((_info.width*_info.height)&gt;&gt;2);;
+	target=(uint8_t *)ctarget;
+	ssigned=_conf-&gt;_V_percent;
+	ssigned+=128;
+
+  	bg_val=(uint8_t) _conf-&gt;_bg_V_percent+128;
+
+	RENDER;
+
+
+	return 1;
+}
+//
+//	Apply a low pass to alias it
+//					1
+// The softening is a 1 4 1  convolution filter
+//					1
+uint8_t ADMVideoSubtitle::lowPass(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h)
+{
+	uint8_t *prevline, *nextline,*curline,*target;
+	uint32_t val;
+
+	memcpy(dst,src,w*h);
+
+	src++;dst++;
+
+			for(uint32_t line=h-1;line&gt;0;line--)
+			{
+				curline=src+line*w;
+				nextline=curline+w;
+				prevline=curline-w;
+				target=dst+line*w;
+				for(uint32_t col=w-1;col&gt;1;col--)
+				{
+#define LEVEL 8*90
+					// 1 4 1
+					val= (*(curline)*4+*prevline+*nextline+*(curline-1)+*(curline+1));
+					if(val&gt; 0 )
+					if(val&lt;LEVEL)
+						val=1;  // just enough to trigger masking
+					else
+						val&gt;&gt;=3;
+					*target=val;
+					target++;
+					curline++;
+					prevline++;
+					nextline++;
+				}
+
+			}
+	return 1;
+}
+//
+//	Decimate 2x2 (luma-&gt;chroma)
+//					1
+//					1
+uint8_t ADMVideoSubtitle::decimate(uint8_t *src, uint8_t *dst, uint32_t w, uint32_t h)
+{
+	uint8_t	*curline, *nextline;
+	uint8_t *target=dst;
+
+			for(uint32_t line=0;line&lt;h&gt;&gt;1;line++)
+			{
+				curline=src+line*w*2;
+				nextline=curline+w;
+				target=dst+line*(w&gt;&gt;1);
+				for(uint32_t col=0;col&lt;w&gt;&gt;1;col++)
+				{
+					// 1 4 1
+					*target= (*(curline)+*(curline+1)+*nextline+*(nextline+1))&gt;&gt;2;
+					target++;
+					curline+=2;
+					nextline+=2;
+				}
+
+			}
+	return 1;
+}
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTload.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/ADM_vidSRTload.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,490 @@
+/***************************************************************************
+                          ADM_vidload.cpp  -  description
+                             -------------------
+
+	Load the subtitles either in srt or sub format
+
+	The structure is
+		uint32_t 		startTime in ms from beginning
+		uint32_t 		endTime  in ms from beginning
+	
+	All text are stored as utf16 after loading
+
+
+    begin                : Thu Aug 09 2003
+    copyright            : (C) 2003 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+
+#ifdef USE_FREETYPE
+#include &lt;math.h&gt;
+#include &lt;iconv.h&gt;
+#include &lt;errno.h&gt;
+
+//#define __STDC_ISO_10646__
+
+#include &quot;ADM_default.h&quot;
+
+#include &quot;ADM_videoFilter.h&quot;
+
+#include &quot;ADM_video/ADM_vidFont.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+
+#include &quot;ADM_osSupport/ADM_debugID.h&quot;
+#define MODULE_NAME MODULE_FILTER
+#include &quot;ADM_osSupport/ADM_debug.h&quot;
+
+#define ADM_RAW 1024
+
+static iconv_t myConv=(iconv_t)-1;;
+static int ADM_SubAtoi(uint16_t *in);
+
+static uint8_t	ADM_utfInit( char *charset );
+static uint8_t ADM_utfConv(ADM_GLYPH_T *out, char *in,uint32_t nbIn, uint32_t *nbOut);
+static uint8_t ADM_utfEnd( void);
+
+
+
+
+uint8_t	ADMVideoSubtitle::loadFont (void)
+{
+ 
+  if (!_font-&gt;initFreeType ((char *)_conf-&gt;_fontname))
+    {
+      printf (&quot;\n Free type init failed for font %s!&quot;, _conf-&gt;_fontname);
+    }
+  else
+    {
+      _font-&gt;fontSetSize (_conf-&gt;_fontsize);
+    }
+   
+  return 1;
+}
+
+//
+//      Load subtitles in .sub format i.e. {xx}{yy} |   |
+//
+// {3610}{3656}Pripraven&#65533;uv&#65533;a ich|v naom dome s primeranou ctou.
+//__________________________________________________________________
+uint8_t  ADMVideoSubtitle::loadSubTitle (void)
+{
+
+  char string[500];
+  uint32_t current_line = 0;
+  // first cound how many line
+  _line = 0;
+   // init iconv...  
+  if(! ADM_utfInit(_conf-&gt;_charset))
+  {
+  	printf(&quot;Problem initializing iconv, aborting\n&quot;);
+	return 0;
+  
+  }
+  while (fgets (string, 200, _fd))
+    {
+      _line++;
+    }
+  printf (&quot;\n subs : %ld lines\n&quot;, _line);
+  // rewind
+  fseek (_fd, 0, SEEK_SET);
+  //
+  _subs = new subLine[_line];
+  if (!_subs)
+    return 0;
+  memset (_subs, 0, sizeof (subLine) * _line);
+
+
+ 
+//	
+  for (uint32_t i = 0; i &lt; _line; i++)
+    {
+      fgets (string, ADM_RAW, _fd);
+      //printf(&quot;\n in : %s &quot;,string);
+      if (string[0] != '{')
+	continue;
+      subParse ((subLine *) &amp; (_subs[current_line]), string);
+      current_line++;
+    }
+	
+  // the effective number of line we have
+  _line = current_line;
+  return 1;
+  
+ ADM_utfEnd( );
+}
+
+//___________________________________________________________________
+//      In case of sub file, take one line and convert it to unicode
+//	we also extract the start/end and split it to N lines
+//	Does not work if input is UTF16. UTF8 is ok.
+//___________________________________________________________________
+uint8_t	ADMVideoSubtitle::subParse (subLine * in, char *string)
+{
+
+
+  static ADM_GLYPH_T 	final[ADM_RAW];	// convert to unicode
+  uint32_t   	startindex, endindex,textindex;
+  uint32_t 	j;
+  float 	f;
+ 
+  uint32_t 	finallen=0;
+  uint32_t	alpha;
+ 
+  j = 1;
+  
+  
+  ADM_utfConv(final,string,strlen(string),&amp;finallen);
+  
+  // ignore { }
+  while (ADM_ASC(final[j]) != '}' &amp;&amp; j &lt; finallen)
+    j++;
+ 
+  startindex =1;
+  j += 2;			// skip }{
+  endindex =j;
+  while (ADM_ASC(final[j]) != '}' &amp;&amp; j &lt; finallen)
+    j++;
+  // The text starts here
+  textindex = j + 1;
+
+  if (j &gt;= finallen - 1)
+    {
+      printf (&quot;***ERR: Suspicious line !!!\n&quot;);
+      return 0;
+
+    }
+
+  // convert frame -&gt; time in ms
+  // skip utf marker if present
+  alpha= ADM_SubAtoi (&amp;final[1]);
+  f=(float)alpha;
+  aprintf(&quot;%s start:%d&quot;,string,alpha);
+  f = f * 1000000. / _info.fps1000;
+  in-&gt;startTime = (uint32_t) floor (f);
+
+  alpha = ADM_SubAtoi (&amp;final[endindex]);
+  f=(float)alpha;
+  aprintf(&quot; end:%d\n&quot;,alpha);
+  f = f * 1000000. / _info.fps1000;
+  
+  in-&gt;endTime = (uint32_t) floor (f);
+
+  uint32_t lllines=0;
+  finallen-=textindex;
+  if(finallen==0)
+  	{
+		printf(&quot;Empty line\n&quot;);
+		in-&gt;nbLine=0;
+		return 1;
+	}
+  // Count the number of | found
+  for(j=0;j&lt;finallen;j++)
+  {
+  	if(ADM_ASC(final[j+textindex])=='|') lllines++;
+  }
+
+  aprintf(&quot;%lu --&gt;%lu\n&quot;,in-&gt;startTime,in-&gt;endTime);
+  in-&gt;nbLine=lllines+1;
+  in-&gt;string=new ADM_GLYPH_T *[in-&gt;nbLine];
+  in-&gt;lineSize=new uint32_t[in-&gt;nbLine];
+  
+  for(uint32_t i=0;i&lt;in-&gt;nbLine;i++)
+  {
+  	in-&gt;string[i]=new ADM_GLYPH_T[finallen]; 	// yes, we overshot
+	in-&gt;lineSize[i]=0;
+  }
+  
+  uint32_t curline=0, curindex=0;
+  for(uint32_t i=0;i&lt;finallen;i++)
+  {
+  	if(ADM_ASC(final[i+textindex])=='|')
+	{
+		in-&gt;lineSize[curline]=curindex;
+		curindex=0;
+		curline++;		
+	}
+	else
+	{
+		in-&gt;string[curline][curindex++]=final[i+textindex];
+	}
+  
+  }  
+  if(curindex)
+  	in-&gt;lineSize[curline]=curindex;
+  return 1;
+}
+
+//
+//      Load subtitles in .srt format i.e. {xx}{yy} |   |
+//__________________________________________________________________
+uint8_t
+ADMVideoSubtitle::loadSRT (void)
+{
+
+
+  static ADM_GLYPH_T 	final[ADM_RAW];	// convert to unicode
+  ADM_GLYPH_T  		temp[SRT_MAX_LINE][ADM_RAW];
+  uint32_t		tempSize[SRT_MAX_LINE];
+  char			string[ADM_RAW];
+  
+  
+  uint32_t line;  
+  uint32_t len;
+  // Init iconv
+   uint32_t 	finallen=0;
+  subLine	*current;
+  
+  if(! ADM_utfInit(_conf-&gt;_charset))
+  {
+  	printf(&quot;Problem initializing iconv, aborting\n&quot;);
+	return 0;
+  
+  } 
+  
+  // first cound how many line
+  line = 0;
+  _line = 0;
+  while (fgets (string, 300, _fd))
+    line++;
+  printf (&quot;\n subs : %ld lines\n&quot;, line);
+  // rewind
+  fseek (_fd, 0, SEEK_SET);
+  //
+  _subs = new subLine[line];
+
+  if (!_subs)
+    return 0;
+  
+  memset (_subs, 0, sizeof (subLine) * line);
+  
+  // read and allocate
+  
+  uint32_t j;
+  int state = 0;
+  int stored=0;
+  
+  for (uint32_t i = 0; i &lt; line; i++)
+    {
+	current=&amp;_subs[_line];
+	fgets (string, ADM_RAW, _fd);
+	ADM_utfConv(final,string,strlen(string),&amp;finallen);
+	// Purge cr/lf	
+	switch (state)
+	{
+	case 0:		// waiting for number	 
+                  if(!_line &amp;&amp; (final[0]&amp;0xfefe)==0xfefe)
+                  {
+                      j=ADM_SubAtoi (final+1);
+                  }
+                  else
+		      j = ADM_SubAtoi (final);
+		if (j == _line + 1)
+		{
+			stored=0;
+			state = 1;
+		}
+		break;
+	case 1:		// waiting for time
+		{
+			uint32_t sh, sm, ss, ms;
+			uint32_t dh, dm, ds, md;
+
+			ADM_GLYPH_T *cur=&amp;final[0];
+				
+	  		sh=ADM_SubAtoi(cur);
+			cur+=3;
+			sm=ADM_SubAtoi(cur);
+			cur+=3;
+			ss=ADM_SubAtoi(cur);
+			cur+=3;
+			ms=ADM_SubAtoi(cur);
+			cur+=3;
+			
+			cur+=5;
+			
+			dh=ADM_SubAtoi(cur);
+			cur+=3;
+			dm=ADM_SubAtoi(cur);
+			cur+=3;
+			ds=ADM_SubAtoi(cur);
+			cur+=3;
+			md=ADM_SubAtoi(cur);
+			
+			_subs[_line].startTime = ms + 1000 * (ss + sm * 60 + sh * 3600);
+			_subs[_line].endTime = md + 1000 * (ds + dm * 60 + dh * 3600);
+			state = 2;
+			
+			aprintf(&quot;%d %d %d %d / %d %d %d %d&gt;%s&lt;\n&quot;,sh,sm,ss,ms,dh,dm,ds,md,string);
+			
+		}
+
+		break;
+	case 2:		
+	   // looking for text
+	   // We append each line to text with a | to separate the lines	 	  
+	  {
+	  	if (finallen &lt; 2)
+	    	{
+	   		// Finished
+	      		_line++;
+	      		state = 0;
+			current-&gt;nbLine=stored;
+			current-&gt;lineSize=new uint32_t[stored];
+			current-&gt;string=new ADM_GLYPH_T *[stored];
+			for(uint32_t i=0;i&lt;stored;i++)
+			{
+				current-&gt;lineSize[i]=tempSize[i];
+				current-&gt;string[i]=new ADM_GLYPH_T[tempSize[i]];
+				memcpy(current-&gt;string[i],temp[i],sizeof(ADM_GLYPH_T)*tempSize[i]);
+			}
+	      		break;
+	    	}
+	  	else
+	    	{
+			if(stored&gt;=SRT_MAX_LINE)
+			{
+				printf(&quot;sub:Too much lines, ignoring..\n&quot;);
+				continue;
+			}
+	      		// We add it
+			memcpy(temp[stored],final,finallen*sizeof(ADM_GLYPH_T));
+			tempSize[stored]=finallen;
+			stored++;
+	    	}
+	  }
+	  break;
+
+	}
+
+    }
+  ADM_utfEnd( );
+  aprintf(&quot;&gt;&gt; Sub: %d subs stored and loaded\n&quot;,_line); 	
+  return 1;
+  
+}
+// Sort of atoi for utf16
+// Very basic
+int ADM_SubAtoi(uint16_t *in)
+{
+	int result=0;
+	int d;
+	do
+	{
+		d=ADM_ASC(*in);		
+		in++;
+		if(d&gt;='0' &amp;&amp; d&lt;='9')
+		{
+			result*=10;
+			result+=d-'0';
+		}
+		else
+			return result;
+	}while(1);
+	
+
+}
+//	Init iconv, so that we can go utf16
+//
+uint8_t	ADM_utfInit( char *charset )
+{
+	myConv=iconv_open(&quot;UTF-16&quot;,charset); //&quot;WINDOWS-1251&quot;);
+	if((long int)myConv==-1)
+	{
+		printf(&quot;\n Error initializing iconv...\n&quot;);
+		return  0;
+	}
+	return 1;
+}
+//
+//	Convert the incoming string to utf16
+//	While doing it, remove the utf16 makers from input/output
+//	(fffe)
+//
+uint8_t ADM_utfConv(ADM_GLYPH_T *out, char *in,uint32_t nbIn, uint32_t *nbOut)
+{
+size_t sin,sout,sz;
+char *cout,*cin;
+uint32_t done=0;
+
+	memset(out,0,ADM_RAW*sizeof(ADM_GLYPH_T));
+	sin=strlen(in);
+	sout=ADM_RAW;
+	cin=in;
+	cout=(char *)(out);
+	
+	if((uint8_t)in[0]==0xff &amp;&amp; (uint8_t)in[1]==0xfe)
+	{
+		 cin+=2;
+		 sin-=2;
+	}
+	if(!sin) 
+	{
+		*nbOut=0;
+		return 1;
+	}
+#ifdef  ICONV_NEED_CONST 
+  	sz=iconv(myConv,(const char **)&amp;cin,&amp;sin,&amp;cout,&amp;sout);
+#else
+	sz=iconv(myConv,&amp;cin,&amp;sin,&amp;cout,&amp;sout);
+#endif	
+	if(sz==-1)
+	{
+  		printf(&quot;Iconv error:%s\n:%s:\n&quot;,strerror(errno),in);
+		//out[0]=' ';
+  	}
+	// Get the amound of utf16...
+	done=(ADM_RAW-sout)&gt;&gt;1;
+
+#if defined(__WIN32) || defined(ADM_BSD_FAMILY)
+	// For Win32 and BSD we swap le and be
+
+       ADM_GLYPH_T glyph;
+       for(uint32_t w=0;w&lt;done;w++)
+       {
+               glyph=out[w];
+               out[w]=((glyph&amp;0xff)&lt;&lt;8)+(glyph&gt;&gt;8);
+       }
+#endif
+	
+	if(done)
+	{
+		if(0xfeff==out[0])
+		{
+			//aprintf(&quot;Removing utf tag\n&quot;);
+			done--;
+			memmove(&amp;out[0],&amp;out[1],done*sizeof(ADM_GLYPH_T));
+			
+		}
+	}
+
+	while(done &amp;&amp;( ADM_ASC(out[done-1])==0x0a || ADM_ASC(out[done-1]==0x0d))) done--;
+	*nbOut=done;
+	return 1;
+	
+}
+// Close iconv
+//
+
+uint8_t ADM_utfEnd( void)
+{
+  // Purge iconv
+  if((long int)myConv!=-1)
+	{
+		iconv_close(myConv);
+		myConv=(iconv_t)-1;
+	}
+}
+
+
+#endif

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/DIA_srt.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/DIA_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,157 @@
+//
+// C++ Implementation: ADM_vidForcedPP
+//
+// Description: 
+//
+//	Force postprocessing assuming constant quant &amp; image type
+//	Uselefull on some badly authored DVD for example
+//
+// Author: mean &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>&gt;, (C) 2004
+//
+// Copyright: See COPYING file that comes with this distribution
+//
+//
+#include &quot;config.h&quot;
+
+#ifdef USE_FREETYPE
+#include &quot;ADM_default.h&quot;
+#include &quot;ADM_userInterfaces/ADM_render/GUI_render.h&quot;
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+
+
+
+#include &quot;DIA_factory.h&quot;
+#include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
+//#include &quot;ADM_video/ADM_vidFont.h&quot;
+class ADMfont;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
+/*****************************************************************/
+extern int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b);
+extern int DIA_srtPos(AVDMGenericVideoStream *source,uint32_t *size,uint32_t *position);
+static void colorCallBack(void *cookie);
+static void sizePositionCallback(void *cookie);
+/*****************************************************************/
+typedef struct unicd
+{
+	char *display,*name;
+}unicd;
+
+  static unicd  names[]=
+{
+	{(char *)&quot;Ascii&quot;	,(char *)&quot;ISO-8859-1&quot;},
+	{(char *)&quot;Cyrillic&quot;	,(char *)&quot;WINDOWS-1251&quot;}, // ru
+	{(char *)&quot;Czech&quot;	,(char *)&quot;ISO-8859-2&quot;},	// cz
+	{(char *)&quot;German&quot;	,(char *)&quot;ISO-8859-9&quot;}		// german ?
+	,{(char *)&quot;Slovene&quot;	,(char *)&quot;CP1250&quot;}		// UTF8
+        
+        ,{(char *)&quot;UTF16&quot;	,(char *)&quot;UTF16&quot;}		// UTF8
+	,{(char *)&quot;UTF8&quot;	,(char *)&quot;UTF8&quot;}		// UTF8
+	,{(char *)&quot;Chinese Traditionnal(Big5)&quot;	,(char *)&quot;CP950&quot;}		// UTF8
+	,{(char *)&quot;Chinese Simplified (GB2312)&quot;	,(char *)&quot;CP936&quot;}		// UTF8
+};
+typedef struct 
+{
+  AVDMGenericVideoStream *source;
+  uint32_t               *size;
+  uint32_t               *position;
+}sizePosition;
+
+/**
+      \fn    DIA_srt
+      \brief Dialog to handle srt, generic part
+*/
+uint8_t DIA_srt(AVDMGenericVideoStream *source, SUBCONF *param)
+{
+#define item(x) QT_TR_NOOP(names[x].display)
+#define Mitem(x) {x,item(x)}
+diaMenuEntry encoding[]={
+  Mitem(0),
+  Mitem(1),
+  Mitem(2),
+  Mitem(3),
+  Mitem(4),
+  Mitem(5),
+  Mitem(6),
+  Mitem(7),
+};       
+
+#define PX(x) &amp;(param-&gt;x)
+  diaElemFile subtitle(0,(char **)PX(_subname),QT_TR_NOOP(&quot;_Subtitle file:&quot;), NULL, QT_TR_NOOP(&quot;Select Subtitle file&quot;));
+  diaElemFile font(0,(char **)PX(_fontname),QT_TR_NOOP(&quot;_Font (TTF):&quot;), NULL, QT_TR_NOOP(&quot;Select TTF file&quot;));
+  int colors[3]={param-&gt;_Y_percent,param-&gt;_U_percent,param-&gt;_V_percent};
+  
+  uint32_t fontSize=param-&gt;_fontsize;
+  uint32_t baseLine=param-&gt;_baseLine;
+  
+  sizePosition sizePos={source,&amp;fontSize,&amp;baseLine};
+  
+  uint32_t myEncoding=0;
+      // convert internal to display
+      if(param-&gt;_charset)
+      for(int i=0;i&lt;sizeof(names)/sizeof(unicd);i++)
+      {
+          if(!strcmp(param-&gt;_charset,names[i].name)) myEncoding=i;
+      }
+      diaElemMenu      encodingM(&amp;myEncoding,QT_TR_NOOP(&quot;_Encoding:&quot;),8,encoding);
+    //  diaElemUInteger  fontSize(PX(_fontsize),QT_TR_NOOP(&quot;Font Si_Ze:&quot;),8,120);
+      diaElemButton    color(QT_TR_NOOP(&quot;S_elect C_olor&quot;), colorCallBack,&amp;(colors[0]));
+      diaElemButton    setBase(QT_TR_NOOP(&quot;Set Size and _Position&quot;), sizePositionCallback,&amp;sizePos);
+      diaElemToggle    autoSplit(PX(_selfAdjustable),QT_TR_NOOP(&quot;_Auto split&quot;));
+      diaElemInteger   delay(PX(_delay),QT_TR_NOOP(&quot;_Delay (ms):&quot;),-100000,100000);
+         
+      diaElem *tabs[]={&amp;subtitle,&amp;font,&amp;encodingM,&amp;color,&amp;setBase,&amp;autoSplit,&amp;delay};
+      if( diaFactoryRun(QT_TR_NOOP(&quot;Subtitler&quot;),7,tabs))
+	{
+          if(param-&gt;_charset) ADM_dealloc(param-&gt;_charset);
+          param-&gt;_charset=ADM_strdup(names[myEncoding].name);
+            param-&gt;_Y_percent=colors[0];
+            param-&gt;_U_percent=colors[1];
+            param-&gt;_V_percent=colors[2];
+            param-&gt;_fontsize=fontSize;
+            param-&gt;_baseLine=baseLine;
+          return 1;
+        }
+         return 0;
+}
+/**
+      \fn colorCallBack
+      \brief Callback used to select a color
+*/
+void colorCallBack(void *cookie)
+{
+  
+      int32_t *colors=(int32_t *)cookie;
+        
+        uint8_t r,g,b;
+        uint8_t y;
+        int8_t u,v;
+  
+        y=colors[0];
+        u=colors[1];
+        v=colors[2];
+
+        COL_YuvToRgb(   y,  u,  v, &amp;b,&amp;g,&amp;r);
+        if(DIA_colorSel(&amp;r,&amp;g,&amp;b))
+        {
+                COL_RgbToYuv(b,  g,  r, &amp;y, &amp;u,&amp;v);
+                colors[0]=y;
+                if(abs(u)&lt;2) u=0;
+                if(abs(v)&lt;2) v=0;
+                colors[1]=u;
+                colors[2]=v;
+        }
+}
+/**
+      \fn sizePositionCallback
+      \brief Callback used to set size and position
+*/
+void sizePositionCallback(void *cookie)
+{
+    sizePosition *sz=(sizePosition *)cookie;
+    printf(&quot;Size and position invoked\n&quot;);
+    DIA_srtPos(sz-&gt;source,sz-&gt;size,sz-&gt;position);
+}
+#endif
+// EOF

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/gtk/DIA_srt.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/gtk/DIA_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,275 @@
+/***************************************************************************
+                          ADM_guiSRT.cpp  -  description
+                             -------------------
+    begin                : Wed Dec 18 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;config.h&quot;
+
+#ifdef USE_FREETYPE
+#include &quot;ADM_toolkitGtk.h&quot;
+
+
+#include &quot;DIA_fileSel.h&quot;
+
+#include &quot;ADM_editor/ADM_edit.hxx&quot;
+#include &quot;ADM_videoFilter.h&quot;
+
+//#include &quot;ADM_video/ADM_vidFont.h&quot;
+class ADMfont;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+
+
+#include &quot;ADM_colorspace.h&quot;
+
+#include &quot;ADM_osSupport/ADM_debugID.h&quot;
+#define MODULE_NAME MODULE_FILTER
+#include &quot;ADM_osSupport/ADM_debug.h&quot;
+
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flySrtPos.h&quot;
+
+
+static void read( void );
+static void upload ( void );
+static gboolean slider_update( void );
+static gboolean gui_update( void);
+static gboolean gui_draw( void );
+static GtkWidget *create_dialog1 (void);
+
+static GtkWidget *dialog=NULL;
+static flySrtPos *myCrop=NULL;
+static int lock=0;
+
+/**
+      \fn DIA_srtPos
+      \brief Dialog that handles subtitle size and position
+*/
+int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
+{
+  uint8_t ret=0;
+  
+        uint32_t width,height;
+
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Subtitle Size and Position&quot;));
+        gtk_widget_show(dialog);
+	
+        myCrop=new flySrtPos( width, height,in,WID(drawingarea1),WID(hscale1));
+        myCrop-&gt;param.fontSize=*size;
+        myCrop-&gt;param.position=*position;
+
+        gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
+
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
+        
+        gtk_signal_connect (GTK_OBJECT(WID( spinbutton1)), &quot;value_changed&quot;,
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+        
+         gtk_signal_connect (GTK_OBJECT(WID( hscale1)), &quot;value_changed&quot;,
+                    GTK_SIGNAL_FUNC (slider_update),
+                    NULL);
+
+          gtk_signal_connect (GTK_OBJECT(WID( vscale1)), &quot;value_changed&quot;,
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+       
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            *size=myCrop-&gt;param.fontSize;
+            *position=myCrop-&gt;param.position;
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+/**********************************/
+void read( void )
+{
+	myCrop-&gt;download();
+}
+gboolean slider_update( void )
+{
+        myCrop-&gt;sliderChanged();
+        return true;
+}
+gboolean gui_update( void)
+{
+  if(lock) return true;
+      myCrop-&gt;update();
+  return true;
+}
+gboolean gui_draw( void )
+{
+	myCrop-&gt;display();
+	return true;
+}
+
+/******************************/
+#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
+				printf(#x&quot;:%d\n&quot;, y);}
+
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x&quot;:%d\n&quot;, y);}
+
+
+uint8_t    flySrtPos::upload(void)
+{
+        SPIN_SET(spinbutton1,param.fontSize);
+        
+        int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max&lt;0) max=0;
+        if(param.position&gt;=max)
+        {
+          param.position=max;
+        }
+        
+        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
+        GTK_ADJUSTMENT(adj)-&gt;value=param.position;
+        return 1;
+}
+uint8_t    flySrtPos::download(void)
+{
+        SPIN_GET(spinbutton1,param.fontSize);
+        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
+        param.position=(uint32_t)GTK_ADJUSTMENT(adj)-&gt;value;
+        
+        int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max&lt;0) max=0;
+        if(param.position&gt;=max)
+        {
+          param.position=max;
+          upload(); 
+        }
+        
+        return 1;
+}
+
+/*
+	Almost straigh out of glade2
+
+*/
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *label1;
+  GtkObject *spinbutton1_adj;
+  GtkWidget *spinbutton1;
+  GtkWidget *hscale1;
+  GtkWidget *hbox2;
+  GtkWidget *drawingarea1;
+  GtkWidget *vscale1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), QT_TR_NOOP(&quot;Subtitle Size and Position&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
+
+  label1 = gtk_label_new (QT_TR_NOOP(&quot;Font Size:&quot;));
+  gtk_widget_show (label1);
+  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
+
+  spinbutton1_adj = gtk_adjustment_new (1, 6, 99, 1, 10, 10);
+  spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 2);
+  gtk_widget_show (spinbutton1);
+  gtk_box_pack_start (GTK_BOX (hbox1), spinbutton1, FALSE, FALSE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton1), TRUE);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
+
+  hbox2 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox2);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox2, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (hbox2), drawingarea1, TRUE, TRUE, 0);
+
+  vscale1 = gtk_vscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 100, 1, 1, 1, 1)));
+  gtk_widget_show (vscale1);
+  gtk_box_pack_start (GTK_BOX (hbox2), vscale1, FALSE, FALSE, 0);
+  gtk_scale_set_digits (GTK_SCALE (vscale1), 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton1, &quot;spinbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hbox2, &quot;hbox2&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, vscale1, &quot;vscale1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
+
+  return dialog1;
+}
+
+//-------------------------------
+#endif //FREETYPE

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.cpp (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.cpp	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,139 @@
+/***************************************************************************
+                          Q_SRT.cpp  -  description
+                             -------------------
+
+    Handle the QT specific part of the fontsize &amp; position dialog box
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+#include &quot;Q_srt.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+  Ui_srtWindow::Ui_srtWindow(SRT_POS_PARAM *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flySrtPos( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(SRT_POS_PARAM));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+        ui.verticalSlider-&gt;setMaximum(height-1);
+        
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+        connect( ui.verticalSlider,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int)));
+        connect( ui.spinBox,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int)));  
+        
+          
+
+  }
+  void Ui_srtWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_srtWindow::gather(SRT_POS_PARAM *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(SRT_POS_PARAM));
+  }
+Ui_srtWindow::~Ui_srtWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_srtWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define MYSPIN(x) w-&gt;x
+#define MYCHECK(x) w-&gt;checkBox##x
+//************************
+uint8_t flySrtPos::upload(void)
+{
+      Ui_srtDialog *w=(Ui_srtDialog *)_cookie;
+
+        MYSPIN(spinBox)-&gt;setValue(param.fontSize);
+        int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max&lt;0) max=0;
+        if(param.position&gt;=max)
+        {
+          param.position=max;
+        }
+        QSlider  *slide=w-&gt;verticalSlider;
+        slide-&gt;setValue(param.position);
+        return 1;
+}
+uint8_t flySrtPos::download(void)
+{
+       Ui_srtDialog *w=(Ui_srtDialog *)_cookie;
+         param.fontSize=MYSPIN(spinBox)-&gt;value();
+         int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max&lt;0) max=0;
+        
+        QSlider  *slide=w-&gt;verticalSlider;
+        param.position=slide-&gt;value();
+        
+        if(param.position&gt;=max)
+        {
+          param.position=max;
+          upload();
+        }
+         
+return 1;
+}
+
+/**
+      \fn     DIA_srtPos
+      \brief  Handle srt fontsize/position dialog
+*/
+int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
+{
+        uint8_t ret=0;
+        SRT_POS_PARAM param;
+        param.fontSize=*size;
+        param.position=*position;
+        Ui_srtWindow dialog(&amp;param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(&amp;param);
+            *size=param.fontSize;
+            *position=param.position;
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.h (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.h	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/Q_srt.h	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,36 @@
+#ifndef Q_srt_h
+#define Q_srt_h
+
+#include &quot;ui_srt.h&quot;
+#include &quot;ADM_image.h&quot;
+
+class ADMfont;
+
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;ADM_UIs/ADM_QT4/include/DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flySrtPos.h&quot;
+
+class Ui_srtWindow : public QDialog
+{
+	Q_OBJECT
+
+protected:
+	int lock;
+
+public:
+	flySrtPos *myCrop;
+	ADM_QCanvas *canvas;
+	Ui_srtWindow(SRT_POS_PARAM *param, AVDMGenericVideoStream *in);
+	~Ui_srtWindow();
+	Ui_srtDialog ui;
+
+public slots:
+	void gather(SRT_POS_PARAM *param);
+
+private slots:
+	void sliderUpdate(int foo);
+	void valueChanged(int foo);
+};
+#endif	// Q_srt_h

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/srt.ui (from rev 4064, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/Srt/qt4/srt.ui	2008-05-25 17:48:15 UTC (rev 4065)
@@ -0,0 +1,143 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;srtDialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;srtDialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;608&lt;/width&gt;
+    &lt;height&gt;423&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Subtitle Font Size and Position&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;leftMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;topMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;rightMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;bottomMargin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;horizontalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;verticalSpacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;4&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeType&quot; &gt;
+      &lt;enum&gt;QSizePolicy::Ignored&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;20&lt;/width&gt;
+       &lt;height&gt;40&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+   &lt;item rowspan=&quot;2&quot; row=&quot;1&quot; column=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;verticalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;invertedAppearance&quot; &gt;
+      &lt;bool&gt;true&lt;/bool&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;invertedControls&quot; &gt;
+      &lt;bool&gt;false&lt;/bool&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBox&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Font Size :&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
+    &lt;spacer&gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;sizeHint&quot; &gt;
+      &lt;size&gt;
+       &lt;width&gt;40&lt;/width&gt;
+       &lt;height&gt;20&lt;/height&gt;
+      &lt;/size&gt;
+     &lt;/property&gt;
+    &lt;/spacer&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;srtDialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;srtDialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake	2008-05-25 11:57:17 UTC (rev 4064)
+++ branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin_qt4.cmake	2008-05-25 17:48:15 UTC (rev 4065)
@@ -1,4 +1,4 @@
-MACRO(INIT_VIDEOFILTER_PLUGIN_QT4  lib  _srcsQt _srcQt_ui )
+MACRO(INIT_VIDEOFILTER_PLUGIN_QT4  lib  _srcsQt _headersQt _srcQt_ui  )
 	INCLUDE(admCheckQt4)
 
 	checkQt4()
@@ -8,11 +8,13 @@
 		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}/qt4)
 		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/ ../../../ADM_UIs/ADM_QT4/include/)
 
-		QT4_WRAP_UI(qt4_ui qt4/${_srcQt_ui}.ui)
-		QT4_WRAP_CPP(qt4_cpp qt4/${_srcQt_ui}.h)
+		QT4_WRAP_UI(qt4_ui ${_srcQt_ui}.ui)
+		QT4_WRAP_CPP(qt4_cpp ${_headersQt})
+		#${_srcQt_ui}.h)
 
 		ADD_LIBRARY(${lib} SHARED ${ARGN} ${_srcsQt} ${qt4_cpp} ${qt4_ui})
 		ADD_TARGET_CFLAGS(${lib} &quot;-DADM_UI_TYPE_BUILD=4&quot;)
+	        ADD_TARGET_CFLAGS(${lib} &quot;-I${CMAKE_BINARY_DIR}/config/qt4 &quot;)
 
 		TARGET_LINK_LIBRARIES( ${lib} ADM_UIQT4  ADM_render_qt4)
 		TARGET_LINK_LIBRARIES(${lib} ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001321.html">[Avidemux-svn-commit] r4064 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_UIs/ADM_GTK/src ADM_UIs/ADM_QT4/include	ADM_UIs/ADM_QT4/src ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
	<LI>Next message: <A HREF="001323.html">[Avidemux-svn-commit] r4066 - in	branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters:	AvisynthResize/qt4 MplayerResize/qt4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1322">[ date ]</a>
              <a href="thread.html#1322">[ thread ]</a>
              <a href="subject.html#1322">[ subject ]</a>
              <a href="author.html#1322">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
