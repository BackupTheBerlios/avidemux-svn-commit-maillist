<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4001 - in branches/avidemux_2.5_branch_gruntster: . avidemux avidemux/ADM_codecs avidemux/ADM_colorspace avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_editor avidemux/ADM_encoder avidemux/ADM_filter avidemux/ADM_libraries/ADM_libmpeg2enc avidemux/ADM_libraries/ADM_utilities avidemux/ADM_outputs/oplug_dummy avidemux/ADM_outputs/oplug_flv avidemux/ADM_outputs/oplug_mp4 avidemux/ADM_outputs/oplug_mpegFF avidemux/ADM_plugin avidemux/ADM_userInterfaces/ADM_GTK avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2 avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr avidemux/ADM_userInterfaces/ADM_NONE avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2 avidemux/ADM_userInterfaces/ADM_QT4 avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_vi! deoFilter avidemux/plugins avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/VerticalFlip cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4001%20-%20in%0A%20branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%20avidemux/ADM_codecs%0A%20avidemux/ADM_colorspace%20avidemux/ADM_coreImage/include%0A%20avidemux/ADM_coreImage/src%20avidemux/ADM_editor%20avidemux/ADM_encoder%0A%20avidemux/ADM_filter%20avidemux/ADM_libraries/ADM_libmpeg2enc%0A%20avidemux/ADM_libraries/ADM_utilities%20avidemux/ADM_outputs/oplug_dummy%0A%20avidemux/ADM_outputs/oplug_flv%20avidemux/ADM_outputs/oplug_mp4%0A%20avidemux/ADM_outputs/oplug_mpegFF%20avidemux/ADM_plugin%0A%20avidemux/ADM_userInterfaces/ADM_GTK%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_NONE%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2%0A%20avidemux/ADM_userInterfaces/ADM_QT4%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_vi%21%20deoFilter%0A%20avidemux/plugins%20avidemux/plugins/ADM_videoFilters%0A%20avidemux/plugins/ADM_videoFilters/VerticalFlip%20cmake&In-Reply-To=%3C200805010832.m418WCbI007433%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001260.html">
   <LINK REL="Next"  HREF="001262.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4001 - in branches/avidemux_2.5_branch_gruntster: . avidemux avidemux/ADM_codecs avidemux/ADM_colorspace avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_editor avidemux/ADM_encoder avidemux/ADM_filter avidemux/ADM_libraries/ADM_libmpeg2enc avidemux/ADM_libraries/ADM_utilities avidemux/ADM_outputs/oplug_dummy avidemux/ADM_outputs/oplug_flv avidemux/ADM_outputs/oplug_mp4 avidemux/ADM_outputs/oplug_mpegFF avidemux/ADM_plugin avidemux/ADM_userInterfaces/ADM_GTK avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2 avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr avidemux/ADM_userInterfaces/ADM_NONE avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2 avidemux/ADM_userInterfaces/ADM_QT4 avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_vi! deoFilter avidemux/plugins avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/VerticalFlip cmake</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4001%20-%20in%0A%20branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%20avidemux/ADM_codecs%0A%20avidemux/ADM_colorspace%20avidemux/ADM_coreImage/include%0A%20avidemux/ADM_coreImage/src%20avidemux/ADM_editor%20avidemux/ADM_encoder%0A%20avidemux/ADM_filter%20avidemux/ADM_libraries/ADM_libmpeg2enc%0A%20avidemux/ADM_libraries/ADM_utilities%20avidemux/ADM_outputs/oplug_dummy%0A%20avidemux/ADM_outputs/oplug_flv%20avidemux/ADM_outputs/oplug_mp4%0A%20avidemux/ADM_outputs/oplug_mpegFF%20avidemux/ADM_plugin%0A%20avidemux/ADM_userInterfaces/ADM_GTK%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%20avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_NONE%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2%0A%20avidemux/ADM_userInterfaces/ADM_QT4%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui%0A%20avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr%0A%20avidemux/ADM_userInterfaces/ADM_commonUI%20avidemux/ADM_vi%21%20deoFilter%0A%20avidemux/plugins%20avidemux/plugins/ADM_videoFilters%0A%20avidemux/plugins/ADM_videoFilters/VerticalFlip%20cmake&In-Reply-To=%3C200805010832.m418WCbI007433%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4001 - in branches/avidemux_2.5_branch_gruntster: . avidemux avidemux/ADM_codecs avidemux/ADM_colorspace avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src avidemux/ADM_editor avidemux/ADM_encoder avidemux/ADM_filter avidemux/ADM_libraries/ADM_libmpeg2enc avidemux/ADM_libraries/ADM_utilities avidemux/ADM_outputs/oplug_dummy avidemux/ADM_outputs/oplug_flv avidemux/ADM_outputs/oplug_mp4 avidemux/ADM_outputs/oplug_mpegFF avidemux/ADM_plugin avidemux/ADM_userInterfaces/ADM_GTK avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2 avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr avidemux/ADM_userInterfaces/ADM_NONE avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2 avidemux/ADM_userInterfaces/ADM_QT4 avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_vi! deoFilter avidemux/plugins avidemux/plugins/ADM_videoFilters avidemux/plugins/ADM_videoFilters/VerticalFlip cmake">mean at mail.berlios.de
       </A><BR>
    <I>Thu May  1 10:32:12 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001260.html">[Avidemux-svn-commit] r4000 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreImage/src plugins/ADM_videoEncoder/ADM_vidEnc_x264
</A></li>
        <LI>Next message: <A HREF="001262.html">[Avidemux-svn-commit] r4002 -	branches/avidemux_2.5_branch_gruntster/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1261">[ date ]</a>
              <a href="thread.html#1261">[ thread ]</a>
              <a href="subject.html#1261">[ subject ]</a>
              <a href="author.html#1261">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-05-01 10:32:05 +0200 (Thu, 01 May 2008)
New Revision: 4001

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_colorspace.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_rgb.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_colorspace.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/rgb2yuv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/yuv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.h
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake
Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/colorspace.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h
Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_png.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageUtils.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ui_support.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ui_support.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_ocr.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEraser.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidASS.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidLogo.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobSubRender.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/CMakeLists.txt
Log:
[Merge]


Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -4,6 +4,7 @@
 MESSAGE(&quot;&quot;)
 
 CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
+cmake_policy(VERSION 2.4)
 SET(CMAKE_MODULE_PATH &quot;${CMAKE_SOURCE_DIR}/cmake&quot; &quot;${CMAKE_MODULE_PATH}&quot;)
 
 PROJECT(Avidemux)
@@ -188,4 +189,4 @@
 # Config Summary
 ########################################
 INCLUDE(admConfigSummary)
-MESSAGE(&quot;&quot;)
\ No newline at end of file
+MESSAGE(&quot;&quot;)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_codecs.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -31,7 +31,7 @@
 #undef BIG_ENDIAN
 #endif
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 
 #ifdef USE_XX_XVID
 #include &quot;xvid.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,7 +21,7 @@
 
 #ifndef __FFMPEG_ENC__
 #define   __FFMPEG_ENC__
-#include &quot;ADM_colorspace/ADM_colorspace.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 typedef enum
 {
   FF_MSMP4V3 = 1,

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_png.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_png.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_png.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -24,7 +24,7 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_codecs/ADM_png.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -20,7 +20,7 @@
 #include &lt;string.h&gt;
 
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_codecs/ADM_rgb16.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_rgb16.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,7 +17,7 @@
 #ifndef ADM_RGB16_H
 #define ADM_RGB16_H
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 
 class decoderRGB16 : decoders
 {

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,152 +0,0 @@
-/***************************************************************************
-    copyright            : (C) 2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-    
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;colorspace.h&quot;
-
-
-extern &quot;C&quot; {
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavutil/avutil.h&quot;
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
-}
-
-#include &quot;ADM_rgb.h&quot; 
-#include &quot;ADM_colorspace.h&quot;
-
-#ifdef ADM_CPU_X86
-		#define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
-#define FLAGS()		ADD(MMX,MMX);				ADD(3DNOW,3DNOW);		ADD(MMXEXT,MMX2);
-#else
-#ifdef ADM_CPU_ALTIVEC
-#define FLAGS() flags|=SWS_CPU_CAPS_ALTIVEC;
-#else
-#define FLAGS()
-#endif
-#endif
-
-#define CONTEXT (SwsContext *)context
-
-/**
-    \fn ADMColor2LAVColor
-    \brief Convert ADM colorspace type swscale/lavcodec colorspace name
-
-*/
-static PixelFormat ADMColor2LAVColor(ADM_colorspace fromColor)
-{
-  switch(fromColor)
-  {
-    case ADM_COLOR_YV12: return PIX_FMT_YUV420P;
-    case ADM_COLOR_YUV422P: return PIX_FMT_YUV422P;
-    default : ADM_assert(0); 
-  }
-  return PIX_FMT_YUV420P;
-}
-/**
-      \fn getStrideAndPointers
-      \brief Fill in strides etc.. needed by libswscale
-*/
-uint8_t ADMColorspace::getStrideAndPointers(uint8_t  *from,ADM_colorspace fromColor,uint8_t **srcData,int *srcStride)
-{
-  switch(fromColor)
-  {
-    case  ADM_COLOR_YV12:
-            srcData[0]=from;
-            srcData[1]=from+width*height;
-            srcData[2]=from+((5*width*height)&gt;&gt;2);
-            srcStride[0]=width;
-            srcStride[1]=width&gt;&gt;1;
-            srcStride[2]=width&gt;&gt;1;
-            break;
-    case  ADM_COLOR_YUV422P:
-            srcData[0]=from;
-            srcData[1]=from+width*height;
-            srcData[2]=from+((3*width*height)&gt;&gt;1);
-            srcStride[0]=width;
-            srcStride[1]=width&gt;&gt;1;
-            srcStride[2]=width&gt;&gt;1;
-            break;
-
-    default:
-        ADM_assert(0);
-  }
-  return 1;
-}
-/**
-    \fn  convert
-    \brief Do the color conversion
-  @param from Source image
-  @param to Target image
-*/
-
-uint8_t ADMColorspace::convert(uint8_t  *from, uint8_t *to)
-{
-  uint8_t *srcData[3];
-  uint8_t *dstData[3];
-  int srcStride[3];
-  int dstStride[3];
-  
-  getStrideAndPointers(from,fromColor,srcData,srcStride);
-  getStrideAndPointers(to,toColor,dstData,dstStride);
-  sws_scale(CONTEXT,srcData,srcStride,0,height,dstData,dstStride);
-  return 1;
-  
-}
-
-/**
-    \fn  ADMColorspace
-    \brief Constructor
-  @param w width
-  @param h height
-  @param from colorspace to convert from
-  @param to colorspace to concert to
-*/
-
-ADMColorspace::ADMColorspace(uint32_t w, uint32_t h, ADM_colorspace from,ADM_colorspace to)
-{
-  int flags=SWS_BICUBLIN;
-  FLAGS();
-  
-    width=w;
-    height=h;
-    fromColor=from;
-    toColor=to;
-    PixelFormat lavFrom=ADMColor2LAVColor(fromColor);
-    PixelFormat lavTo=ADMColor2LAVColor(toColor);
-    
-    context=(void *)sws_getContext(
-                      width,height,
-                      lavFrom ,
-                      width,height,
-                      lavTo,
-                      flags, NULL, NULL,NULL);
-
-}
-/**
-    \fn  ~ADMColorspace
-    \brief Destructor
-*/
-ADMColorspace::~ADMColorspace()
-{
-  if(context)
-  {
-     sws_freeContext(CONTEXT);
-     context=NULL;
-  }
-}
- 
-//EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,34 +0,0 @@
-/***************************************************************************
-                       
-    copyright            : (C) 2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
- #ifndef ADM_COLORSPACE_H
- #define ADM_COLORSPACE_H
-#include &quot;ADM_rgb.h&quot; // To have colors
-class ADMColorspace
-{
-  protected:
-    void  *context;
-    uint32_t width,height;
-    ADM_colorspace fromColor,toColor;
-    uint8_t getStrideAndPointers(uint8_t  *from,ADM_colorspace fromColor,uint8_t **srcData,int *srcStride);
-  public :
-    
-    ADMColorspace(uint32_t w, uint32_t h, ADM_colorspace from,ADM_colorspace to);
-    uint8_t convert(uint8_t  *from, uint8_t *to);
-    ~ADMColorspace();
-};
- 
-#endif
-//EOF
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,596 +0,0 @@
-/***************************************************************************
-                         ADM_Rgb : wrapper for yv12-&gt;RGB display
-                            using mplayer postproc
-
-
-    begin                : Thu Apr 16 2003
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-    
- 16 08 2007 : Removed the manual RGB&lt;-&gt;BGR, newer swscale can output directly in the correct mode   
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;colorspace.h&quot;
-
-extern &quot;C&quot; {
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavutil/avutil.h&quot;
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
-}
-
-	
-#include &quot;ADM_rgb.h&quot; 
-
-#define CLEANUP() \
-    if(_context) \
-    {\
-        if(ww==w &amp;&amp; hh==h)\
-           return 1; \
-        clean();  \
-    }
-
-#ifdef ADM_CPU_X86
-		#define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
-#define FLAGS()		ADD(MMX,MMX);				ADD(3DNOW,3DNOW);		ADD(MMXEXT,MMX2);
-#else
-#ifdef ADM_CPU_ALTIVEC
-#define FLAGS() flags|=SWS_CPU_CAPS_ALTIVEC;
-#else
-#define FLAGS()
-#endif
-#endif
-
-#define TARGET_COLORSPACE       PIX_FMT_RGB32 
-#define ALTERNATE_COLORSPACE    PIX_FMT_BGR32
-
- //***********************************************
- ColBase::ColBase(uint32_t ww, uint32_t hh)
- {
-      _context=NULL;
-      w=0xfffff;
-      h=0xfffff;
-      //reset(ww,hh);   
- }
- ColBase::~ColBase()
- {
-    clean();   
- }
- //***********************************************
- uint8_t ColBase::clean(void)
- {
-        if(_context)
-		{
-			sws_freeContext((SwsContext *)_context);
-		}
-		_context=NULL; 
-		return 1;  
- }
- //***********************************************
- uint8_t ColYuvRgb::reset(uint32_t ww, uint32_t hh)
- {
- int flags=0;
-	
-    CLEANUP();
-    FLAGS();
-    PixelFormat fmt=TARGET_COLORSPACE;
-    if(_inverted) fmt=ALTERNATE_COLORSPACE;
-    if(!ww || !hh) return 0;
-
-	if (_context)
-		sws_freeContext((SwsContext *)_context);
-
-	 _context=(void *)sws_getContext(
-                      ww,hh,
-                      PIX_FMT_YUV420P ,
-                      ww,hh,
-                      fmt,
-                      flags, NULL, NULL,NULL);
-
-    if(!_context) ADM_assert(0);
-    w=ww;
-    h=hh;
-    return 1;
-}
-/**
-      \fn invertRGB
-      \brief Do RGBA-&gt;BGRA swap
-      howmuch is in pixel, i.e. you have to multiply it by 4 to get the nb of bytes!
-*/
-static void ADM_RGBA2BGRA(uint8_t *ptr, uint32_t howmuch)
-{
-#ifdef ADM_CPU_X86
-    __asm__(
-                        &quot;1: mov            (%0),%%eax \n&quot;
-                        &quot;bswap          %%eax \n&quot;
-                        &quot;rorl           $8,%%eax \n&quot;
-                        &quot;mov            %%eax,(%0) \n&quot;
-                        &quot;add            $4,%0 \n&quot;
-                        &quot;dec            %1 \n&quot;
-                        &quot;jne            1b\n&quot;
-                :  :&quot;r&quot; (ptr),&quot;r&quot; (howmuch)
-                : &quot;%eax&quot;
-                
-      
-                );
-#else
-uint8_t r,g,b,a;
-                  for(int xx=0;xx&lt;howmuch;xx++)
-                  {
-                      r=ptr[0];
-                      g=ptr[1];
-                      b=ptr[2];
-                      a=ptr[3];
-                      ptr[0]=b;
-                      ptr[1]=g;
-                      ptr[2]=r;
-                      ptr[3]=a;
-                      ptr+=4;
-                  }
-#endif
-}
-/**
-      \fn scale
-      \brief Do the actual colorconversion
-
-*/
- uint8_t ColYuvRgb::scale(uint8_t *src, uint8_t *target)
- {
-    uint8_t *srd[3];
-	uint8_t *dst[3];
-	int ssrc[3];
-	int ddst[3];
-
-	ADM_assert(_context);
-	
-			uint32_t page;
-
-			page=w*h;
-			srd[0]=src;
-			srd[1]=src+page;
-			srd[2]=src+((page*5)&gt;&gt;2);
-
-			ssrc[0]=w;
-			ssrc[1]=ssrc[2]=w&gt;&gt;1;
-
-			
-			dst[0]=target;
-			dst[1]=NULL;
-			dst[2]=NULL;
-			ddst[0]=w*4;
-			ddst[1]=ddst[2]=0;
-
-			sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
-#if 0
-        if(_inverted)
-        {
-                uint8_t r,g,b,a;
-                uint8_t *ptr=target;
-                int pel=h*w;
-                ADM_RGBA2BGRA(ptr,pel);
-        }
-#endif
-#if  defined( ADM_BIG_ENDIAN)
-	if (!_inverted)
-	{
-        uint8_t r,g,b,a;
-        uint8_t *ptr=target;
-        int pel=h*w;
-        for(int yy=0;yy&lt;pel;yy++)
-        {
-              r=ptr[0];
-              g=ptr[1];
-              b=ptr[2];
-              a=ptr[3];
-              ptr[0]=a;
-              ptr[1]=b;
-              ptr[2]=g;
-              ptr[3]=r;
-              ptr+=4;
-        }
-	}
-#endif
-     
-        return 1;
- }
-
-/**
-      \fn scale
-      \brief Change colorspace but and put result in the target image , which is bigger
-        Normally not used !
-*/
- uint8_t ColYuvRgb::scale(uint8_t *src, uint8_t *target,uint32_t startx,uint32_t starty, uint32_t tw,uint32_t th,uint32_t totalW,uint32_t totalH)
- {
-    uint8_t *srd[3];
-    uint8_t *dst[3];
-    int ssrc[3];
-    int ddst[3];
-
-    ADM_assert(_context);
-    
-    uint32_t page;
-
-    page=tw*th;
-    srd[0]=src;
-    srd[1]=src+page;
-    srd[2]=src+((page*5)&gt;&gt;2);
-
-    ssrc[0]=tw;
-    ssrc[1]=ssrc[2]=tw&gt;&gt;1;
-
-    
-    dst[0]=target+(startx*4)+starty*totalW*4;
-    dst[1]=NULL;
-    dst[2]=NULL;
-    ddst[0]=totalW*4;
-    ddst[1]=ddst[2]=0;
-
-    sws_scale((SwsContext *)_context,srd,ssrc,0,th,dst,ddst);
-#if 0
-    if(_inverted)
-    {
-            uint8_t r,g,b,a;
-            uint8_t *ptr=NULL;
-            int pel=th;
-            for(int yy=0;yy&lt;th;yy++)
-            {
-              ptr=target+(startx*4)+(starty+yy)*totalW*4;;
-              ADM_RGBA2BGRA(ptr,tw);
-            }
-     }
-#endif
-
-#if defined(ADM_BIG_ENDIAN)
-     uint8_t r, g, b, a;
-     uint8_t *ptr = target;
-     int pel = h * w;
-
-     for (int yy = 0; yy &lt; th; yy++)
-     {
-          ptr = target + (startx * 4) + (starty + yy) * totalW * 4;
-          ADM_RGBA2BGRA(ptr, tw);
-     }
-#endif
-
-     return 1;
- }
-
- 
- 
-//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-uint8_t ColYv12Rgb24::reset(uint32_t ww, uint32_t hh)
- {
- int flags=0;
-	CLEANUP();
-    FLAGS();
-   if(!ww || !hh) return 0;
-
-	if (_context)
-		sws_freeContext((SwsContext *)_context);
-
-	 _context=(void *)sws_getContext(
-				    		ww,hh,
-						PIX_FMT_YUV420P ,
-		 				ww,hh,
-	   					PIX_FMT_RGB24,
-	    					flags, NULL, NULL,NULL);
-
-    if(!_context) ADM_assert(0);
-    w=ww;
-    h=hh;
-    return 1;
-}
-  uint8_t ColYv12Rgb24::scale(uint8_t *src, uint8_t *target)
- {
-    uint8_t *srd[3];
-	uint8_t *dst[3];
-	int ssrc[3];
-	int ddst[3];
-
-	ADM_assert(_context);
-	
-			uint32_t page;
-
-			page=w*h;
-			srd[0]=src;
-			srd[1]=src+page;
-			srd[2]=src+((page*5)&gt;&gt;2);
-
-			ssrc[0]=w;
-			ssrc[1]=ssrc[2]=w&gt;&gt;1;
-
-			
-			dst[0]=target;
-			dst[1]=NULL;
-			dst[2]=NULL;
-			ddst[0]=w*3;
-			ddst[1]=ddst[2]=0;
-			
-			sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
-     
-        return 1;
- }
-//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
- uint8_t ColRgbToYV12::reset(uint32_t ww, uint32_t hh)
- {
- int flags=0;
- int c;	
-    clean();
-    FLAGS();
-    flags|=SWS_BILINEAR;
-    switch(_colorspace)
-    {
-                case ADM_COLOR_RGB24:c=PIX_FMT_RGB24;break;
-                case ADM_COLOR_RGB32A:c=TARGET_COLORSPACE;break;
-                case ADM_COLOR_RGB16:c=PIX_FMT_RGB565;break;
-                default: ADM_assert(0);
-    }
-
-	if (_context)
-		sws_freeContext((SwsContext *)_context);
-
-         _context=(void *)sws_getContext(
-				    		ww,hh,
-						c ,
-		 				ww,hh,
-	   					PIX_FMT_YUV420P,
-	    					flags, NULL, NULL,NULL);
-
-    if(!_context) ADM_assert(0);
-    w=ww;
-    h=hh;
-    return 1;
-}
-uint8_t ColRgbToYV12::setBmpMode(void)
-{
-        _bmpMode=1;
-        return 1;
-}
-
-//***********************************************
- uint8_t ColRgbToYV12::scale(uint8_t *src, uint8_t *target)
- {
-    uint8_t *srd[3];
-        uint8_t *dst[3];
-        int ssrc[3];
-        int ddst[3];
-        int mul=0;
-
-        ADM_assert(_context);
-
-        uint32_t page;
-
-        page=w*h;
-        srd[0]=src;
-        srd[1]=0;
-        srd[2]=0;
-
-        switch(_colorspace)
-        {
-                case ADM_COLOR_RGB16:  mul=2;
-                        break;
-                case ADM_COLOR_RGB24:  mul=3;
-                        break;
-                case ADM_COLOR_RGB32A:  mul=4;
-                        break;
-        }
-        ssrc[0]=mul*w;
-        ssrc[1]=0;
-        ssrc[2]=0;
-
-        dst[0]=target;
-        dst[1]=target+page;
-        dst[2]=target+((page*5)&gt;&gt;2);
-        ddst[0]=w;
-        ddst[1]=ddst[2]=w&gt;&gt;1;
-        if(_bmpMode)
-        {
-                ssrc[0]=-mul*w;
-                srd[0]=src+mul*w*(h-1);
-                dst[2]=target+page;
-                dst[1]=target+((page*5)&gt;&gt;2);
-        }
-
-
-        sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
-     
-        return 1;
- }
- uint8_t ColRgbToYV12::changeColorSpace(ADM_colorspace col)
- {
-int z;
-    
-    z=(int)col;
-    _backward=!!(z &amp; ADM_COLOR_BACKWARD);
-    z&amp;=~ADM_COLOR_BACKWARD;
-    _colorspace= (ADM_colorspace) z;
-       
- }
- //*************************
-static inline void SwapMe(uint8_t *tgt,uint8_t *src,int nb);
-void SwapMe(uint8_t *tgt,uint8_t *src,int nb)
-{
-    uint8_t r,g,b;
-   nb=nb;
-   while(nb--)
-   {
-       r=*src++;
-       g=*src++;
-       b=*src++;
-       *tgt++=r;
-       *tgt++=g;
-       *tgt++=b;
-       
-   }
-   return;
-    
-}
-//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
- uint8_t  COL_yv12rgbBMP(uint32_t ww, uint32_t hh, uint8_t* in, uint8_t *out)
-{
-     ColYv12Rgb24 rgb(ww,hh);
-     
-        rgb.reset(ww,hh);
-        rgb.scale(in,out);
-        // Now time to swap it
-        uint8_t swap[ww*3];
-        
-        uint8_t *up=out;
-        uint8_t *down=out+(hh-1)*ww*3;
-        
-        for(int y=0;y&lt;hh&gt;&gt;1;y++)
-        {
-            SwapMe(swap,up,ww); 
-            SwapMe(up,down,ww);
-            memcpy( down,swap,ww*3);
-            down-=3*ww;
-            up+=3*ww;
-        }
-        
-        return 1;
-     
-}
-//***************************************************
-//***************************************************
-//***************************************************
-//***************************************************
-//***************************************************
-//***************************************************
-
-COL_Generic2YV12::COL_Generic2YV12(uint32_t ww, uint32_t hh,ADM_colorspace col)
-{
-int flags=0;
-int c=0; 
-
-        FLAGS();
-        flags|=SWS_BILINEAR;
-        _context=NULL;
-        w=ww;
-        h=hh;
-        _colorspace=(ADM_colorspace)(col &amp; ADM_COLOR_MASK);
-        _backward= !!(col &amp; ADM_COLOR_BACKWARD);
-      
- 
-    switch(_colorspace)
-    {
-     
-                case ADM_COLOR_BGR24:c=PIX_FMT_BGR24;break;
-                case ADM_COLOR_RGB24:c=PIX_FMT_RGB24;break;
-                case ADM_COLOR_RGB555:c=PIX_FMT_RGB555;break;
-                case ADM_COLOR_BGR555:c=PIX_FMT_BGR555;break;
-                case ADM_COLOR_BGR32A:c=PIX_FMT_BGR32;break;
-                case ADM_COLOR_RGB32A:c=TARGET_COLORSPACE;break;
-                case ADM_COLOR_RGB16:c=PIX_FMT_RGB565;break;
-                case ADM_COLOR_YUV411:c=PIX_FMT_YUV411P;break;
-				case ADM_COLOR_YUV422:c=PIX_FMT_YUV422P;break;
-				case ADM_COLOR_YUV444:c=PIX_FMT_YUV444P;break;
-                default: ADM_assert(0);
-    }
-         _context=(void *)sws_getContext(
-                                                ww,hh,
-                                                c ,
-                                                ww,hh,
-                                                PIX_FMT_YUV420P,
-                                                flags, NULL, NULL,NULL);
-
-    if(!_context) ADM_assert(0);
-}
-
-uint8_t COL_Generic2YV12::clean(void)
-{
-        if(_context)
-                {
-                        sws_freeContext((SwsContext *)_context);
-                }
-                _context=NULL; 
-                return 1;  
-}
-
-uint8_t COL_Generic2YV12::transform(uint8_t **planes, uint32_t *strides,uint8_t *target)
-{
-	uint8_t *srd[3];
-	uint8_t *dst[3];
-	int ssrc[3];
-	int ddst[3];
-	int mul = 0;
-	uint32_t page = w * h;
-
-	ADM_assert(_context);
-
-	if(_colorspace &amp; ADM_COLOR_IS_YUV)
-	{
-		srd[0] = planes[0];
-		srd[1] = planes[2];
-		srd[2] = planes[1];
-		ssrc[0] = strides[0];
-		ssrc[1] = strides[2];
-		ssrc[2] = strides[1];
-
-		dst[0] = target;
-		dst[2] = target + page;
-		dst[1] = target + ((page * 5) &gt;&gt; 2);
-		ddst[0] = w;
-		ddst[1] = ddst[2] = w &gt;&gt; 1;
-
-		sws_scale((SwsContext *)_context, srd, ssrc, 0, h, dst, ddst);
-
-		return 1;
-	}
-
-	// Else RGB colorspace
-	switch (_colorspace &amp; 0x7FFF)
-	{
-		case ADM_COLOR_RGB16:
-		case ADM_COLOR_RGB555:
-		case ADM_COLOR_BGR555:
-			mul = 2;
-			break;
-		case ADM_COLOR_BGR24:
-		case ADM_COLOR_RGB24:
-			mul = 3;
-			break;
-		case ADM_COLOR_BGR32A:
-		case ADM_COLOR_RGB32A:
-			mul = 4;
-			break;
-		default:
-			ADM_assert(0);
-	}
-
-	srd[0] = planes[0];
-	srd[1] = srd[2] = 0;
-	ssrc[0] = mul * w;
-	ssrc[1] = ssrc[2] = 0;
-
-	if(strides &amp;&amp; strides[0] &gt; ssrc[0])
-		ssrc[0] = strides[0];
-
-	dst[0] = target;
-	dst[2] = target + page;
-	dst[1] = target + ((page * 5) &gt;&gt; 2);
-	ddst[0] = w;
-	ddst[1] = ddst[2] = w &gt;&gt; 1;
-
-	if(_backward)
-	{
-		ssrc[0] = -mul * w;
-		srd[0] = planes[0] + mul * w * (h - 1);
-	}
-
-	sws_scale((SwsContext *)_context, srd, ssrc, 0, h, dst, ddst);
-
-	return 1;
-}
-//EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,118 +0,0 @@
-/***************************************************************************
-                         ADM_Rgb : wrapper for yv12-&gt;RGB display
-                            using mplayer postproc
-
-
-    begin                : Thu Apr 16 2003
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
- #ifndef COLYUVRGB_H
- #define COLYUVRGB_H
-
-#define ADM_COLOR_IS_YUV 0x1000
- typedef enum 
- {
-    ADM_COLOR_RGB24,
-    ADM_COLOR_BGR24,
-    ADM_COLOR_BGR32A,
-    ADM_COLOR_RGB32A,
-    ADM_COLOR_RGB16,
-    ADM_COLOR_RGB555,
-    ADM_COLOR_BGR555,
-    ADM_COLOR_YV12 = ADM_COLOR_IS_YUV,	// YUV420
-    ADM_COLOR_YUV422,
-    ADM_COLOR_YUV422P,
-	ADM_COLOR_YUV411,
-	ADM_COLOR_YUV444
- } ADM_colorspace;
-#define ADM_COLOR_BACKWARD 0x8000
-#define ADM_COLOR_MASK     0x7FFF
- /* Convert YV12 to RGB32, the reset must be called at least once before using scale */
- class ColBase
- {
-  protected:
-    void        *_context;
-    uint32_t    w,h;  
-    uint8_t     clean(void);
-     
-  public:
-                ColBase(uint32_t w, uint32_t h);
-                ~ColBase();
-     virtual   uint8_t reset(uint32_t neww, uint32_t newh) {return 0;};
-     virtual   uint8_t scale(uint8_t *src, uint8_t *target){return 0;};  
- };
- //************ YV12 to RB32********************************
- class ColYuvRgb : public ColBase
- {
-  protected:
-              uint32_t _inverted;
-  public:
-                ColYuvRgb(uint32_t w, uint32_t h,uint32_t inv=0): ColBase(w,h) {_inverted=inv;};
-                ~ColYuvRgb(){clean();};
-      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
-      virtual  uint8_t scale(uint8_t *src, uint8_t *target);
-      virtual  uint8_t scale(uint8_t *src, uint8_t *target,uint32_t startx,uint32_t starty, uint32_t w,uint32_t h,uint32_t totalW,uint32_t totalH);    
- };
- //********************************************
-
-  /* Convert RGB24/32 to YV12, the reset must be called at least once before using scale */
-  class ColRgbToYV12  : public ColBase
-  {
-  protected:
-                int             _bmpMode;
-                ADM_colorspace  _colorspace;
-                uint32_t        _backward;
-  public:
-                ColRgbToYV12(uint32_t w, uint32_t h,ADM_colorspace col) : ColBase(w,h) 
-                    {
-                            _colorspace=col;
-                            _bmpMode=0;
-                    };
-                ~ColRgbToYV12(){clean();};
-      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
-      virtual  uint8_t scale(uint8_t *src, uint8_t *target);  
-               uint8_t changeColorSpace(ADM_colorspace col);   
-               uint8_t setBmpMode(void);
-      
-  };
-//********************************************
-/* Convert RGB24 to YV12, the reset must be called at least once before using scale */
-  class ColYv12Rgb24  : public ColBase
-  {
-  protected:
-    
-  public:
-                ColYv12Rgb24(uint32_t w, uint32_t h) : ColBase(w,h) {};
-                ~ColYv12Rgb24(){clean();};
-      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
-      virtual  uint8_t scale(uint8_t *src, uint8_t *target);     
-      
-  };
-//*************************************
-class COL_Generic2YV12 
-{
-protected:
-                void        *_context;
-                uint32_t    w,h;  
-                uint8_t     clean(void);
-                ADM_colorspace _colorspace;
-                uint32_t       _backward;
-    
-public:
-        
-                COL_Generic2YV12(uint32_t w, uint32_t h,ADM_colorspace) ;
-                ~COL_Generic2YV12(){clean();};
-                uint8_t transform(uint8_t **planes, uint32_t *strides,uint8_t *target);
-                
-};
- #endif

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,3 +0,0 @@
-SET(ADM_colorspace_SRCS ADM_rgb.cpp  rgb2yuv.cpp  yuv.cpp ADM_colorspace.cpp)
-
-ADD_ADM_LIB_ALL_TARGETS(ADM_colorspace ${ADM_colorspace_SRCS})

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/colorspace.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/colorspace.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/colorspace.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,40 +0,0 @@
-/***************************************************************************
-                          colorspace.h  -  description
-                           -------------------
-  Select here the colorspace used by application
-
-
-
-    begin                : Fri Feb 22 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#define COLORSPACE_YV12
-//#define  COLORSPACE_YUY2
-
-#if !defined(COLORSPACE_YV12) &amp;&amp; !defined(COLORSPACE_YUY2)
-#error Define at least one colorspace !
-#endif
-uint8_t  COL_yv12rgbBMP(uint32_t ww, uint32_t hh, uint8_t* in, uint8_t *out);
-uint8_t  COL_yv12rgb(uint32_t w, uint32_t h,uint8_t * ptr, uint8_t * out );
-
-uint8_t COL_422_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h);
-uint8_t COL_411_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h);
-
-uint8_t COL_RgbToYuv(uint8_t R,uint8_t G,uint8_t B, uint8_t *y,int8_t *u,int8_t  *v);
-uint8_t COL_YuvToRgb( uint8_t y,int8_t u,int8_t v,uint8_t *r,uint8_t *g,uint8_t *b);
-
-uint8_t COL_RawRGB32toYV12(uint8_t *data1,uint8_t *data2, uint8_t *oy,uint8_t *oy2, 
-				uint8_t *u, uint8_t *v,uint32_t lineSize,uint32_t height,uint32_t stride);
-
-uint8_t COL_RGB24_to_YV12(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv);
-uint8_t COL_RGB24_to_YV12_revert(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv);

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,278 +0,0 @@
-
-/***************************************************************************
-                          yv.cpp  -  description
-                             -------------------
-
-	Convert a RGB triplet to its YUV conterpart
-
-    begin                : Wed Aug 12 2003
-    copyright            : (C) 2003 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &lt;math.h&gt;
-
-#include &quot;config.h&quot;
-#include &quot;ADM_default.h&quot;
-
-
-extern &quot;C&quot; {
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
-#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
-}
-
-#include &quot;colorspace.h&quot;
-
-/**
-	This is unoptimized because seldom called
-*/
-uint8_t COL_RgbToYuv(uint8_t R,uint8_t G,uint8_t B, uint8_t *y,int8_t *u,int8_t *v)
-{
-
-	float rr=R,bb=B,gg=G;
-	float yy,uu,vv;
-
-	yy=0.299*rr+ 		0.587*gg+ 	0.114*bb;
-	uu=-0.169*rr+ 	-0.331*gg+  	0.5*bb;
-	vv=0.5*rr+ 		-0.419*gg+ 	-0.081*bb;
-
-
-	if(uu&gt;127) uu=127;
-	if(uu&lt;-127) uu=-127;
-	*u=(int8_t)floor(uu);
-
-	if(vv&gt;127) vv=127;
-	if(vv&lt;-127) vv=-127;
-	*v=(int8_t)floor(vv);
-
-	if(yy&gt;255) yy=255;
-	if(yy&lt;0) yy=0;
-	*y=(uint8_t)floor(yy);
-
-	return 1;
-
-}
-static inline uint8_t PixelClip(int16_t in)
-{
-    if (in &gt; 255)
-	in = 255;
-   if(in&lt;0)
-   	in=0;
-    return (uint8_t) in;
-};
-
-			   	   
-static inline unsigned char ScaledPixelClip(long  i)
-{
-    return PixelClip(((i +32768) &gt;&gt; 16)); //  + 32768
-};
-
-//0.299	0.587	0.114
-const long int cyb = 6416; //int(0.114*219*65536/255+0.5);
-const long int cyg = 33038; //int(0.587*219*65536/255+0.5);
-const long int cyr = 16828; //int(0.299*219*65536/255+0.5);
-
-uint8_t COL_RawRGB32toYV12(uint8_t *data1,uint8_t *data2, uint8_t *oy,uint8_t *oy2, 
-				uint8_t *u, uint8_t *v,uint32_t lineSize,uint32_t height,uint32_t stride)
-{
-
-
-long int y1,y2;
-long int y3,y4;
-long int scaled_y,b_y;
-long int scaled_y2,b_y2;
-long int r_y,r_y2;  
-
-uint8_t *org1,*org2;
-/*
-0 2 1
-2 6 0
-1 5 3
-3 7 1
-*/
-#define B0 2
-#define R0 0
-#define M0 1
-
-#define M1 (M0+4)
-#define B1 (B0+4)
-#define R1 (R0+4)
-#define LEFT 0x108000
-
-//	printf(&quot;w %d h %d stride %d\n&quot;,lineSize,height,stride);
-	org1=data1;
-	org2=data2;
-	
-	long int alpha,beta,gamma;
-	
-    for(uint32_t yy=0;yy&lt;(height&gt;&gt;1);yy++)
-    {
-    	data1=org1;
-	data2=org2;
-      for (uint32_t x=0;x&lt;(lineSize&gt;&gt;1);x++)
-      {
-      
-#define MK1(source,out,row ) \
-       alpha=source[B##row]; \
-       alpha*=cyb; \
-       beta=source[M##row]; \
-       beta*=cyg; \
-       gamma=source[R##row]; \
-       gamma*=cyr;        \
-       out=(gamma+alpha+beta+LEFT)&gt;&gt;16; 
-      
-        
-       //y1 = (cyb*(long int)data1[B0] + cyg*(long int)data1[M0] + cyr*(long int)data1[R0] +LEFT) &gt;&gt; 16;
-        MK1(data1,y1,0);
-        oy[0] = y1;
-        //y2 = (cyb*(long int)data1[B1] + cyg*(long int)data1[M1] + cyr*(long int)data1[R1] +LEFT) &gt;&gt; 16;
-	MK1(data1,y2,1);
-        oy[1] = y2;
-	
-	//y3 = (cyb*(long int)data2[B0] + cyg*(long int)data2[M0] + cyr*(long int)data2[R0] +LEFT) &gt;&gt; 16;
-	MK1(data2,y3,0);
-        oy2[0] = y3;
-	
-        //y4 = (cyb*(long int)data2[B1] + cyg*(long int)data2[M1] + cyr*(long int)data2[R1] +LEFT) &gt;&gt; 16;
-	MK1(data2,y4,1);
-        oy2[1] = y4;
-
-
-        scaled_y = (y1+y2 - 32) * 38155;
-	scaled_y2 = (y3+y4 - 32) * 38155;
-	
-        b_y = ((data1[B0]+data1[B1]) &lt;&lt; 15) - scaled_y;
-	b_y2 = ((data2[B0]+data2[B1]) &lt;&lt; 15) - scaled_y2;
-	
-	b_y=(b_y+b_y2)/2;
-	
-        u[0] = ScaledPixelClip((b_y &gt;&gt; 10)*int(1/2.018*1024+0.5) + 0x800000);  // u * int(1/2.018*1024+0.5)
-        
-	r_y = ((data1[R0]+data1[R1]) &lt;&lt; 15) - scaled_y;
-	r_y2 = ((data2[R0]+data2[R1]) &lt;&lt; 15) - scaled_y2;
-	r_y=(r_y+r_y2)/2;
-	
-        v[0] = ScaledPixelClip((r_y &gt;&gt; 10)* int(1/1.596*1024+0.5) + 0x800000);  // v* int(1/1.596*1024+0.5)
-	
-	//u[0]=128;
-	//v[0]=128;
-        
-	oy+=2;
-	oy2+=2;
-	u++;
-	v++;
-	data1+=8;
-	data2+=8;
-      }
-     	org2+=2*stride;
-      	org1+=2*stride;
-	oy+=lineSize;
-	oy2+=lineSize;	
-     }
-      
-  return 1;
-}
-uint8_t COL_YuvToRgb( uint8_t y,int8_t u,int8_t v,uint8_t *r,uint8_t *g,uint8_t *b)
-{
-
-	float rr,bb,gg;
-	float yy=y,uu=u,vv=v;
-
-	rr=	yy+			 	1.402*vv;
-	gg= yy+ 	-0.344*uu+  	-0.714*vv;
-	bb=	yy+ 	1.772*uu 	 		;
-
-	#define CLIP(x) if(x&gt;255) x=255; else if (x&lt;0) x=0;x=x+0.49;
-	#define CVT(x,y) CLIP(x);*y=(uint8_t)floor(x);
-
-	CVT(rr,r);
-	CVT(gg,g);
-	CVT(bb,b);
-
-	return 1;
-
-}
-/**
- * 		\fn COL_RGB24_to_YV12
- *		\brief Convert RGB to YV12 using swscale
- */
-uint8_t COL_RGB24_to_YV12_revert(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv)
-{
-	int flags = SWS_SPLINE;
-	struct SwsContext *context=NULL;
-	
-	#ifdef ADM_CPU_X86
-		#define ADD(x, y) if (CpuCaps::has##x()) flags |= SWS_CPU_CAPS_##y;
-
-		ADD(MMX,MMX);
-		ADD(3DNOW,3DNOW);
-		ADD(MMXEXT,MMX2);
-	#endif
-
-	#ifdef ADM_CPU_ALTIVEC
-	    flags |= SWS_CPU_CAPS_ALTIVEC;
-	#endif
-	    context = sws_getContext(w, h,
-	    									  PIX_FMT_RGB24,
-	    									  w, h,
-	    									  PIX_FMT_YUV420P,
-	    									  flags, NULL, NULL,NULL);
-	    ADM_assert(context);
-	
-	    uint8_t *src[3]={rgb+w*h*3-w*3,NULL,NULL};
-	    int srcStride[3]={-w*3,0,0};
-	    int dstStride[3]={w,w&gt;&gt;1,w&gt;&gt;1};
-	    uint8_t *dst[3]={yuv,yuv+w*h,yuv+((w*h*5)&gt;&gt;2)};
-//	    int sws_scale(struct SwsContext *context, uint8_t* src[], int srcStride[], int srcSliceY,
-//	                  int srcSliceH, uint8_t* dst[], int dstStride[]);	    
-	    sws_scale(context, src, srcStride, 0, h, dst, dstStride);
-	    
-		sws_freeContext(context);
-}
-/**
- * 		\fn COL_RGB24_to_YV12
- *		\brief Convert RGB to YV12 using swscale
- */
-uint8_t COL_RGB24_to_YV12(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv)
-{
-	int flags = SWS_SPLINE;
-	struct SwsContext *context=NULL;
-	
-	#ifdef ADM_CPU_X86
-		#define ADD(x, y) if (CpuCaps::has##x()) flags |= SWS_CPU_CAPS_##y;
-
-		ADD(MMX,MMX);
-		ADD(3DNOW,3DNOW);
-		ADD(MMXEXT,MMX2);
-	#endif
-
-	#ifdef ADM_CPU_ALTIVEC
-	    flags |= SWS_CPU_CAPS_ALTIVEC;
-	#endif
-	    context = sws_getContext(w, h,
-	    									  PIX_FMT_RGB24,
-	    									  w, h,
-	    									  PIX_FMT_YUV420P,
-	    									  flags, NULL, NULL,NULL);
-	    ADM_assert(context);
-	
-	    uint8_t *src[3]={rgb,NULL,NULL};
-	    int srcStride[3]={w*3,0,0};
-	    int dstStride[3]={w,w&gt;&gt;1,w&gt;&gt;1};
-	    uint8_t *dst[3]={yuv,yuv+((w*h*5)&gt;&gt;2),yuv+w*h};
-//	    int sws_scale(struct SwsContext *context, uint8_t* src[], int srcStride[], int srcSliceY,
-//	                  int srcSliceH, uint8_t* dst[], int dstStride[]);	    
-	    sws_scale(context, src, srcStride, 0, h, dst, dstStride);
-	    
-		sws_freeContext(context);
-}
-//EOF

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,113 +0,0 @@
-
-/***************************************************************************
-                          yv.cpp  -  description
-                             -------------------
-
-Convert yv422/yuv411 to YV12
-
-Not optimised for speed at all, should take the one from ffmpeg
-
-    begin                : Wed Apr 19 2003
-    copyright            : (C) 2003 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-
-#include &quot;ADM_default.h&quot;
-#include &quot;colorspace.h&quot;
-
-uint8_t COL_422_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h)
-{
-
-
-			uint8_t *xsrc;
-			uint8_t *dst_y,*dst_u,*dst_v;
-
-
-			xsrc= in[0];
-			dst_y=out;
-			// copy y as is
-            		for(uint32_t y=h;y&gt;0;y--)
-			{
-				memcpy(dst_y,xsrc,w);
-				dst_y+=w;
-				xsrc+=stride[0];
-			}
-			// u
-			xsrc= in[1];
-			dst_u=out+(w*h);
-			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-			{
-				memcpy(dst_u,xsrc,w&gt;&gt;1);
-				dst_u+=w&gt;&gt;1;
-				xsrc+=stride[1]*2;
-			}
-			// v
-			xsrc= in[2];
-			dst_v=out+(w*h)+((w*h)&gt;&gt;2);;
-			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-			{
-				memcpy(dst_v,xsrc,w&gt;&gt;1);
-				dst_v+=w&gt;&gt;1;
-				xsrc+=stride[2]*2;
-			}
-			return 1;
-}
-uint8_t COL_411_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h)
-{
-
-
-			uint8_t *xsrc;
-			uint8_t *dst_y,*dst_u,*dst_v;
-
-
-			xsrc= in[0];
-			dst_y=out;
-			// copy y as is
-            		for(uint32_t y=h;y&gt;0;y--)
-			{
-				memcpy(dst_y,xsrc,w);
-				dst_y+=w;
-				xsrc+=stride[0];
-			}
-			// u
-			xsrc= in[1];
-			dst_u=out+(w*h);
-			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-			{
-				//memcpy(dst_u,xsrc,w&gt;&gt;1);
-				for(uint32_t x=0;x&lt;w&gt;&gt;2;x++)
-					{
-						*(dst_u+x+x+1)=*(dst_u+x+x)=*(xsrc+x);
-					}
-				dst_u+=w&gt;&gt;1;
-				xsrc+=stride[1]*2;
-			}
-			// v
-			xsrc= in[2];
-			dst_v=out+(w*h)+((w*h)&gt;&gt;2);;
-			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-			{
-				for(uint32_t x=0;x&lt;w&gt;&gt;2;x++)
-					{
-						*(dst_v+x+x+1)=*(dst_v+x+x)=*(xsrc+x);
-					}
-				dst_v+=w&gt;&gt;1;
-				xsrc+=stride[2]*2;
-			}
-			return 1;
-}
-
-

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_colorspace.h (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_colorspace.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,131 @@
+/***************************************************************************
+                       
+    copyright            : (C) 2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #ifndef ADM_COLORSPACE_H
+ #define ADM_COLORSPACE_H
+#include &quot;ADM_rgb.h&quot; // To have colors
+
+// Some handy simple colorspace code
+
+uint8_t  COL_yv12rgbBMP(uint32_t ww, uint32_t hh, uint8_t* in, uint8_t *out);
+uint8_t  COL_yv12rgb(uint32_t w, uint32_t h,uint8_t * ptr, uint8_t * out );
+
+uint8_t COL_422_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h);
+uint8_t COL_411_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h);
+
+uint8_t COL_RgbToYuv(uint8_t R,uint8_t G,uint8_t B, uint8_t *y,int8_t *u,int8_t  *v);
+uint8_t COL_YuvToRgb( uint8_t y,int8_t u,int8_t v,uint8_t *r,uint8_t *g,uint8_t *b);
+
+uint8_t COL_RawRGB32toYV12(uint8_t *data1,uint8_t *data2, uint8_t *oy,uint8_t *oy2, 
+				uint8_t *u, uint8_t *v,uint32_t lineSize,uint32_t height,uint32_t stride);
+
+uint8_t COL_RGB24_to_YV12(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv);
+uint8_t COL_RGB24_to_YV12_revert(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv);
+
+// Generic colorspace conversion class
+
+class ADMColorspace
+{
+  protected:
+    void  *context;
+    uint32_t width,height;
+    ADM_colorspace fromColor,toColor;
+    uint8_t getStrideAndPointers(uint8_t  *from,ADM_colorspace fromColor,uint8_t **srcData,int *srcStride);
+  public :
+    
+    ADMColorspace(uint32_t w, uint32_t h, ADM_colorspace from,ADM_colorspace to);
+    uint8_t convert(uint8_t  *from, uint8_t *to);
+    ~ADMColorspace();
+};
+/* Convert YV12 to RGB32, the reset must be called at least once before using scale */
+ class ColBase
+ {
+  protected:
+    void        *_context;
+    uint32_t    w,h;  
+    uint8_t     clean(void);
+     
+  public:
+                ColBase(uint32_t w, uint32_t h);
+                ~ColBase();
+     virtual   uint8_t reset(uint32_t neww, uint32_t newh) {return 0;};
+     virtual   uint8_t scale(uint8_t *src, uint8_t *target){return 0;};  
+ };
+ //************ YV12 to RB32********************************
+ class ColYuvRgb : public ColBase
+ {
+  protected:
+              uint32_t _inverted;
+  public:
+                ColYuvRgb(uint32_t w, uint32_t h,uint32_t inv=0): ColBase(w,h) {_inverted=inv;};
+                ~ColYuvRgb(){clean();};
+      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
+      virtual  uint8_t scale(uint8_t *src, uint8_t *target);
+      virtual  uint8_t scale(uint8_t *src, uint8_t *target,uint32_t startx,uint32_t starty, uint32_t w,uint32_t h,uint32_t totalW,uint32_t totalH);    
+ };
+ //********************************************
+
+  /* Convert RGB24/32 to YV12, the reset must be called at least once before using scale */
+  class ColRgbToYV12  : public ColBase
+  {
+  protected:
+                int             _bmpMode;
+                ADM_colorspace  _colorspace;
+                uint32_t        _backward;
+  public:
+                ColRgbToYV12(uint32_t w, uint32_t h,ADM_colorspace col) : ColBase(w,h) 
+                    {
+                            _colorspace=col;
+                            _bmpMode=0;
+                    };
+                ~ColRgbToYV12(){clean();};
+      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
+      virtual  uint8_t scale(uint8_t *src, uint8_t *target);  
+               uint8_t changeColorSpace(ADM_colorspace col);   
+               uint8_t setBmpMode(void);
+      
+  };
+//********************************************
+/* Convert RGB24 to YV12, the reset must be called at least once before using scale */
+  class ColYv12Rgb24  : public ColBase
+  {
+  protected:
+    
+  public:
+                ColYv12Rgb24(uint32_t w, uint32_t h) : ColBase(w,h) {};
+                ~ColYv12Rgb24(){clean();};
+      virtual  uint8_t reset(uint32_t neww, uint32_t newh);
+      virtual  uint8_t scale(uint8_t *src, uint8_t *target);     
+      
+  };
+//*************************************
+class COL_Generic2YV12 
+{
+protected:
+                void        *_context;
+                uint32_t    w,h;  
+                uint8_t     clean(void);
+                ADM_colorspace _colorspace;
+                uint32_t       _backward;
+    
+public:
+        
+                COL_Generic2YV12(uint32_t w, uint32_t h,ADM_colorspace) ;
+                ~COL_Generic2YV12(){clean();};
+                uint8_t transform(uint8_t **planes, uint32_t *strides,uint8_t *target);
+                
+}; 
+#endif
+//EOF
+

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -23,7 +23,7 @@
 #ifndef ADM_IMAGE
 #define ADM_IMAGE
 #include &quot;ADM_assert.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_rgb.h&quot;
 
 typedef enum 
 {

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_rgb.h (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_rgb.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,41 @@
+/***************************************************************************
+                         ADM_Rgb : wrapper for yv12-&gt;RGB display
+                            using mplayer postproc
+
+
+    begin                : Thu Apr 16 2003
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #ifndef ADM_RGB_H
+ #define ADM_RGB_H
+
+#define ADM_COLOR_IS_YUV 0x1000
+ typedef enum 
+ {
+    ADM_COLOR_RGB24,
+    ADM_COLOR_BGR24,
+    ADM_COLOR_BGR32A,
+    ADM_COLOR_RGB32A,
+    ADM_COLOR_RGB16,
+    ADM_COLOR_RGB555,
+    ADM_COLOR_BGR555,
+    ADM_COLOR_YV12 = ADM_COLOR_IS_YUV,	// YUV420
+    ADM_COLOR_YUV422,
+    ADM_COLOR_YUV422P,
+	ADM_COLOR_YUV411,
+	ADM_COLOR_YUV444
+ } ADM_colorspace;
+#define ADM_COLOR_BACKWARD 0x8000
+#define ADM_COLOR_MASK     0x7FFF
+ 
+ #endif

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilterDynamic.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,43 @@
+/** *************************************************************************
+                          \fn ADM_videoFilterDynamic
+                          \brief Include for external dynamically loaded video filters
+	(C) 2008 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #ifndef VIDEO_FILTERS_DYNAMIC_H
+ #define VIDEO_FILTERS_DYNAMIC_H
+
+#include &quot;ADM_videoFilter.h&quot;
+#include &quot;ADM_videoFilter_internal.h&quot;
+
+typedef FilterDescriptor *(VF_getDescriptor)(void);
+
+#define VF_DEFINE_FILTER(myClass,name,displayname,version,createFunction,createFunctionFromScript,category,description) \
+	static FilterDescriptor descriptor_vf_id(\
+								0, \
+								name, \
+								displayname, \
+								description, \
+								category, \
+								createFunction, \
+								createFunctionFromScript, \
+								ADM_FILTER_API_VERSION); \
+    extern &quot;C&quot; { 	FilterDescriptor *ADM_VF_getDescriptor(void) {return &amp;descriptor_vf_id;}};							
+
+/* Hook, filters cannot include config.h as they are framework independant */
+#ifdef QT_TR_NOOP
+#undef QT_TR_NOOP
+#endif
+extern const char* translate(const char *__domainname, const char *__msgid);
+#define QT_TR_NOOP(String) translate (&quot;avidemux&quot;, String)
+
+
+#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_videoFilter_internal.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,7 +17,9 @@
  #ifndef __VIDEO_FILTERS__
  #define  __VIDEO_FILTERS__
 
-#include &quot;ADM_script/adm_scanner.h&quot; // To get MAXPARAM...
+//#include &quot;ADM_script/adm_scanner.h&quot; // To get MAXPARAM...
+#define MAXPARAM 40
+#warning fixme MAXPARAM defined twice
 
 typedef enum
 {
@@ -73,6 +75,11 @@
 			{
 				tag=0;
 			}
+			FilterDescriptor() :name(NULL),filterName(NULL),description(NULL),category(VF_MAX),create(NULL),create_from_script(NULL),
+						destroy(NULL),apiVersion(0),filterVersion(0)
+			{
+				
+			}
 };   
  	
    typedef struct

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_colorspace.cpp (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_colorspace.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_colorspace.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,152 @@
+/***************************************************************************
+    copyright            : (C) 2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+    
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+#include &quot;ADM_default.h&quot;
+#include &quot;ADM_colorspace.h&quot;
+
+
+extern &quot;C&quot; {
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavutil/avutil.h&quot;
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
+}
+
+#include &quot;ADM_rgb.h&quot; 
+#include &quot;ADM_colorspace.h&quot;
+
+#ifdef ADM_CPU_X86
+		#define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
+#define FLAGS()		ADD(MMX,MMX);				ADD(3DNOW,3DNOW);		ADD(MMXEXT,MMX2);
+#else
+#ifdef ADM_CPU_ALTIVEC
+#define FLAGS() flags|=SWS_CPU_CAPS_ALTIVEC;
+#else
+#define FLAGS()
+#endif
+#endif
+
+#define CONTEXT (SwsContext *)context
+
+/**
+    \fn ADMColor2LAVColor
+    \brief Convert ADM colorspace type swscale/lavcodec colorspace name
+
+*/
+static PixelFormat ADMColor2LAVColor(ADM_colorspace fromColor)
+{
+  switch(fromColor)
+  {
+    case ADM_COLOR_YV12: return PIX_FMT_YUV420P;
+    case ADM_COLOR_YUV422P: return PIX_FMT_YUV422P;
+    default : ADM_assert(0); 
+  }
+  return PIX_FMT_YUV420P;
+}
+/**
+      \fn getStrideAndPointers
+      \brief Fill in strides etc.. needed by libswscale
+*/
+uint8_t ADMColorspace::getStrideAndPointers(uint8_t  *from,ADM_colorspace fromColor,uint8_t **srcData,int *srcStride)
+{
+  switch(fromColor)
+  {
+    case  ADM_COLOR_YV12:
+            srcData[0]=from;
+            srcData[1]=from+width*height;
+            srcData[2]=from+((5*width*height)&gt;&gt;2);
+            srcStride[0]=width;
+            srcStride[1]=width&gt;&gt;1;
+            srcStride[2]=width&gt;&gt;1;
+            break;
+    case  ADM_COLOR_YUV422P:
+            srcData[0]=from;
+            srcData[1]=from+width*height;
+            srcData[2]=from+((3*width*height)&gt;&gt;1);
+            srcStride[0]=width;
+            srcStride[1]=width&gt;&gt;1;
+            srcStride[2]=width&gt;&gt;1;
+            break;
+
+    default:
+        ADM_assert(0);
+  }
+  return 1;
+}
+/**
+    \fn  convert
+    \brief Do the color conversion
+  @param from Source image
+  @param to Target image
+*/
+
+uint8_t ADMColorspace::convert(uint8_t  *from, uint8_t *to)
+{
+  uint8_t *srcData[3];
+  uint8_t *dstData[3];
+  int srcStride[3];
+  int dstStride[3];
+  
+  getStrideAndPointers(from,fromColor,srcData,srcStride);
+  getStrideAndPointers(to,toColor,dstData,dstStride);
+  sws_scale(CONTEXT,srcData,srcStride,0,height,dstData,dstStride);
+  return 1;
+  
+}
+
+/**
+    \fn  ADMColorspace
+    \brief Constructor
+  @param w width
+  @param h height
+  @param from colorspace to convert from
+  @param to colorspace to concert to
+*/
+
+ADMColorspace::ADMColorspace(uint32_t w, uint32_t h, ADM_colorspace from,ADM_colorspace to)
+{
+  int flags=SWS_BICUBLIN;
+  FLAGS();
+  
+    width=w;
+    height=h;
+    fromColor=from;
+    toColor=to;
+    PixelFormat lavFrom=ADMColor2LAVColor(fromColor);
+    PixelFormat lavTo=ADMColor2LAVColor(toColor);
+    
+    context=(void *)sws_getContext(
+                      width,height,
+                      lavFrom ,
+                      width,height,
+                      lavTo,
+                      flags, NULL, NULL,NULL);
+
+}
+/**
+    \fn  ~ADMColorspace
+    \brief Destructor
+*/
+ADMColorspace::~ADMColorspace()
+{
+  if(context)
+  {
+     sws_freeContext(CONTEXT);
+     context=NULL;
+  }
+}
+ 
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageUtils.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageUtils.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageUtils.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -22,7 +22,7 @@
 #include &quot;ADM_bitstream.h&quot;
 
 #include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+
 #include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
 
 #include &quot;ADM_codecs/ADM_codec.h&quot;

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/ADM_rgb.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,596 @@
+/***************************************************************************
+                         ADM_Rgb : wrapper for yv12-&gt;RGB display
+                            using mplayer postproc
+
+
+    begin                : Thu Apr 16 2003
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+    
+ 16 08 2007 : Removed the manual RGB&lt;-&gt;BGR, newer swscale can output directly in the correct mode   
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+#include &quot;ADM_default.h&quot;
+#include &quot;ADM_colorspace.h&quot;
+
+extern &quot;C&quot; {
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavutil/avutil.h&quot;
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
+}
+
+	
+#include &quot;ADM_rgb.h&quot; 
+
+#define CLEANUP() \
+    if(_context) \
+    {\
+        if(ww==w &amp;&amp; hh==h)\
+           return 1; \
+        clean();  \
+    }
+
+#ifdef ADM_CPU_X86
+		#define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
+#define FLAGS()		ADD(MMX,MMX);				ADD(3DNOW,3DNOW);		ADD(MMXEXT,MMX2);
+#else
+#ifdef ADM_CPU_ALTIVEC
+#define FLAGS() flags|=SWS_CPU_CAPS_ALTIVEC;
+#else
+#define FLAGS()
+#endif
+#endif
+
+#define TARGET_COLORSPACE       PIX_FMT_RGB32 
+#define ALTERNATE_COLORSPACE    PIX_FMT_BGR32
+
+ //***********************************************
+ ColBase::ColBase(uint32_t ww, uint32_t hh)
+ {
+      _context=NULL;
+      w=0xfffff;
+      h=0xfffff;
+      //reset(ww,hh);   
+ }
+ ColBase::~ColBase()
+ {
+    clean();   
+ }
+ //***********************************************
+ uint8_t ColBase::clean(void)
+ {
+        if(_context)
+		{
+			sws_freeContext((SwsContext *)_context);
+		}
+		_context=NULL; 
+		return 1;  
+ }
+ //***********************************************
+ uint8_t ColYuvRgb::reset(uint32_t ww, uint32_t hh)
+ {
+ int flags=0;
+	
+    CLEANUP();
+    FLAGS();
+    PixelFormat fmt=TARGET_COLORSPACE;
+    if(_inverted) fmt=ALTERNATE_COLORSPACE;
+    if(!ww || !hh) return 0;
+
+	if (_context)
+		sws_freeContext((SwsContext *)_context);
+
+	 _context=(void *)sws_getContext(
+                      ww,hh,
+                      PIX_FMT_YUV420P ,
+                      ww,hh,
+                      fmt,
+                      flags, NULL, NULL,NULL);
+
+    if(!_context) ADM_assert(0);
+    w=ww;
+    h=hh;
+    return 1;
+}
+/**
+      \fn invertRGB
+      \brief Do RGBA-&gt;BGRA swap
+      howmuch is in pixel, i.e. you have to multiply it by 4 to get the nb of bytes!
+*/
+static void ADM_RGBA2BGRA(uint8_t *ptr, uint32_t howmuch)
+{
+#ifdef ADM_CPU_X86
+    __asm__(
+                        &quot;1: mov            (%0),%%eax \n&quot;
+                        &quot;bswap          %%eax \n&quot;
+                        &quot;rorl           $8,%%eax \n&quot;
+                        &quot;mov            %%eax,(%0) \n&quot;
+                        &quot;add            $4,%0 \n&quot;
+                        &quot;dec            %1 \n&quot;
+                        &quot;jne            1b\n&quot;
+                :  :&quot;r&quot; (ptr),&quot;r&quot; (howmuch)
+                : &quot;%eax&quot;
+                
+      
+                );
+#else
+uint8_t r,g,b,a;
+                  for(int xx=0;xx&lt;howmuch;xx++)
+                  {
+                      r=ptr[0];
+                      g=ptr[1];
+                      b=ptr[2];
+                      a=ptr[3];
+                      ptr[0]=b;
+                      ptr[1]=g;
+                      ptr[2]=r;
+                      ptr[3]=a;
+                      ptr+=4;
+                  }
+#endif
+}
+/**
+      \fn scale
+      \brief Do the actual colorconversion
+
+*/
+ uint8_t ColYuvRgb::scale(uint8_t *src, uint8_t *target)
+ {
+    uint8_t *srd[3];
+	uint8_t *dst[3];
+	int ssrc[3];
+	int ddst[3];
+
+	ADM_assert(_context);
+	
+			uint32_t page;
+
+			page=w*h;
+			srd[0]=src;
+			srd[1]=src+page;
+			srd[2]=src+((page*5)&gt;&gt;2);
+
+			ssrc[0]=w;
+			ssrc[1]=ssrc[2]=w&gt;&gt;1;
+
+			
+			dst[0]=target;
+			dst[1]=NULL;
+			dst[2]=NULL;
+			ddst[0]=w*4;
+			ddst[1]=ddst[2]=0;
+
+			sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
+#if 0
+        if(_inverted)
+        {
+                uint8_t r,g,b,a;
+                uint8_t *ptr=target;
+                int pel=h*w;
+                ADM_RGBA2BGRA(ptr,pel);
+        }
+#endif
+#if  defined( ADM_BIG_ENDIAN)
+	if (!_inverted)
+	{
+        uint8_t r,g,b,a;
+        uint8_t *ptr=target;
+        int pel=h*w;
+        for(int yy=0;yy&lt;pel;yy++)
+        {
+              r=ptr[0];
+              g=ptr[1];
+              b=ptr[2];
+              a=ptr[3];
+              ptr[0]=a;
+              ptr[1]=b;
+              ptr[2]=g;
+              ptr[3]=r;
+              ptr+=4;
+        }
+	}
+#endif
+     
+        return 1;
+ }
+
+/**
+      \fn scale
+      \brief Change colorspace but and put result in the target image , which is bigger
+        Normally not used !
+*/
+ uint8_t ColYuvRgb::scale(uint8_t *src, uint8_t *target,uint32_t startx,uint32_t starty, uint32_t tw,uint32_t th,uint32_t totalW,uint32_t totalH)
+ {
+    uint8_t *srd[3];
+    uint8_t *dst[3];
+    int ssrc[3];
+    int ddst[3];
+
+    ADM_assert(_context);
+    
+    uint32_t page;
+
+    page=tw*th;
+    srd[0]=src;
+    srd[1]=src+page;
+    srd[2]=src+((page*5)&gt;&gt;2);
+
+    ssrc[0]=tw;
+    ssrc[1]=ssrc[2]=tw&gt;&gt;1;
+
+    
+    dst[0]=target+(startx*4)+starty*totalW*4;
+    dst[1]=NULL;
+    dst[2]=NULL;
+    ddst[0]=totalW*4;
+    ddst[1]=ddst[2]=0;
+
+    sws_scale((SwsContext *)_context,srd,ssrc,0,th,dst,ddst);
+#if 0
+    if(_inverted)
+    {
+            uint8_t r,g,b,a;
+            uint8_t *ptr=NULL;
+            int pel=th;
+            for(int yy=0;yy&lt;th;yy++)
+            {
+              ptr=target+(startx*4)+(starty+yy)*totalW*4;;
+              ADM_RGBA2BGRA(ptr,tw);
+            }
+     }
+#endif
+
+#if defined(ADM_BIG_ENDIAN)
+     uint8_t r, g, b, a;
+     uint8_t *ptr = target;
+     int pel = h * w;
+
+     for (int yy = 0; yy &lt; th; yy++)
+     {
+          ptr = target + (startx * 4) + (starty + yy) * totalW * 4;
+          ADM_RGBA2BGRA(ptr, tw);
+     }
+#endif
+
+     return 1;
+ }
+
+ 
+ 
+//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+uint8_t ColYv12Rgb24::reset(uint32_t ww, uint32_t hh)
+ {
+ int flags=0;
+	CLEANUP();
+    FLAGS();
+   if(!ww || !hh) return 0;
+
+	if (_context)
+		sws_freeContext((SwsContext *)_context);
+
+	 _context=(void *)sws_getContext(
+				    		ww,hh,
+						PIX_FMT_YUV420P ,
+		 				ww,hh,
+	   					PIX_FMT_RGB24,
+	    					flags, NULL, NULL,NULL);
+
+    if(!_context) ADM_assert(0);
+    w=ww;
+    h=hh;
+    return 1;
+}
+  uint8_t ColYv12Rgb24::scale(uint8_t *src, uint8_t *target)
+ {
+    uint8_t *srd[3];
+	uint8_t *dst[3];
+	int ssrc[3];
+	int ddst[3];
+
+	ADM_assert(_context);
+	
+			uint32_t page;
+
+			page=w*h;
+			srd[0]=src;
+			srd[1]=src+page;
+			srd[2]=src+((page*5)&gt;&gt;2);
+
+			ssrc[0]=w;
+			ssrc[1]=ssrc[2]=w&gt;&gt;1;
+
+			
+			dst[0]=target;
+			dst[1]=NULL;
+			dst[2]=NULL;
+			ddst[0]=w*3;
+			ddst[1]=ddst[2]=0;
+			
+			sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
+     
+        return 1;
+ }
+//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+ uint8_t ColRgbToYV12::reset(uint32_t ww, uint32_t hh)
+ {
+ int flags=0;
+ int c;	
+    clean();
+    FLAGS();
+    flags|=SWS_BILINEAR;
+    switch(_colorspace)
+    {
+                case ADM_COLOR_RGB24:c=PIX_FMT_RGB24;break;
+                case ADM_COLOR_RGB32A:c=TARGET_COLORSPACE;break;
+                case ADM_COLOR_RGB16:c=PIX_FMT_RGB565;break;
+                default: ADM_assert(0);
+    }
+
+	if (_context)
+		sws_freeContext((SwsContext *)_context);
+
+         _context=(void *)sws_getContext(
+				    		ww,hh,
+						c ,
+		 				ww,hh,
+	   					PIX_FMT_YUV420P,
+	    					flags, NULL, NULL,NULL);
+
+    if(!_context) ADM_assert(0);
+    w=ww;
+    h=hh;
+    return 1;
+}
+uint8_t ColRgbToYV12::setBmpMode(void)
+{
+        _bmpMode=1;
+        return 1;
+}
+
+//***********************************************
+ uint8_t ColRgbToYV12::scale(uint8_t *src, uint8_t *target)
+ {
+    uint8_t *srd[3];
+        uint8_t *dst[3];
+        int ssrc[3];
+        int ddst[3];
+        int mul=0;
+
+        ADM_assert(_context);
+
+        uint32_t page;
+
+        page=w*h;
+        srd[0]=src;
+        srd[1]=0;
+        srd[2]=0;
+
+        switch(_colorspace)
+        {
+                case ADM_COLOR_RGB16:  mul=2;
+                        break;
+                case ADM_COLOR_RGB24:  mul=3;
+                        break;
+                case ADM_COLOR_RGB32A:  mul=4;
+                        break;
+        }
+        ssrc[0]=mul*w;
+        ssrc[1]=0;
+        ssrc[2]=0;
+
+        dst[0]=target;
+        dst[1]=target+page;
+        dst[2]=target+((page*5)&gt;&gt;2);
+        ddst[0]=w;
+        ddst[1]=ddst[2]=w&gt;&gt;1;
+        if(_bmpMode)
+        {
+                ssrc[0]=-mul*w;
+                srd[0]=src+mul*w*(h-1);
+                dst[2]=target+page;
+                dst[1]=target+((page*5)&gt;&gt;2);
+        }
+
+
+        sws_scale((SwsContext *)_context,srd,ssrc,0,h,dst,ddst);
+     
+        return 1;
+ }
+ uint8_t ColRgbToYV12::changeColorSpace(ADM_colorspace col)
+ {
+int z;
+    
+    z=(int)col;
+    _backward=!!(z &amp; ADM_COLOR_BACKWARD);
+    z&amp;=~ADM_COLOR_BACKWARD;
+    _colorspace= (ADM_colorspace) z;
+       
+ }
+ //*************************
+static inline void SwapMe(uint8_t *tgt,uint8_t *src,int nb);
+void SwapMe(uint8_t *tgt,uint8_t *src,int nb)
+{
+    uint8_t r,g,b;
+   nb=nb;
+   while(nb--)
+   {
+       r=*src++;
+       g=*src++;
+       b=*src++;
+       *tgt++=r;
+       *tgt++=g;
+       *tgt++=b;
+       
+   }
+   return;
+    
+}
+//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+ uint8_t  COL_yv12rgbBMP(uint32_t ww, uint32_t hh, uint8_t* in, uint8_t *out)
+{
+     ColYv12Rgb24 rgb(ww,hh);
+     
+        rgb.reset(ww,hh);
+        rgb.scale(in,out);
+        // Now time to swap it
+        uint8_t swap[ww*3];
+        
+        uint8_t *up=out;
+        uint8_t *down=out+(hh-1)*ww*3;
+        
+        for(int y=0;y&lt;hh&gt;&gt;1;y++)
+        {
+            SwapMe(swap,up,ww); 
+            SwapMe(up,down,ww);
+            memcpy( down,swap,ww*3);
+            down-=3*ww;
+            up+=3*ww;
+        }
+        
+        return 1;
+     
+}
+//***************************************************
+//***************************************************
+//***************************************************
+//***************************************************
+//***************************************************
+//***************************************************
+
+COL_Generic2YV12::COL_Generic2YV12(uint32_t ww, uint32_t hh,ADM_colorspace col)
+{
+int flags=0;
+int c=0; 
+
+        FLAGS();
+        flags|=SWS_BILINEAR;
+        _context=NULL;
+        w=ww;
+        h=hh;
+        _colorspace=(ADM_colorspace)(col &amp; ADM_COLOR_MASK);
+        _backward= !!(col &amp; ADM_COLOR_BACKWARD);
+      
+ 
+    switch(_colorspace)
+    {
+     
+                case ADM_COLOR_BGR24:c=PIX_FMT_BGR24;break;
+                case ADM_COLOR_RGB24:c=PIX_FMT_RGB24;break;
+                case ADM_COLOR_RGB555:c=PIX_FMT_RGB555;break;
+                case ADM_COLOR_BGR555:c=PIX_FMT_BGR555;break;
+                case ADM_COLOR_BGR32A:c=PIX_FMT_BGR32;break;
+                case ADM_COLOR_RGB32A:c=TARGET_COLORSPACE;break;
+                case ADM_COLOR_RGB16:c=PIX_FMT_RGB565;break;
+                case ADM_COLOR_YUV411:c=PIX_FMT_YUV411P;break;
+				case ADM_COLOR_YUV422:c=PIX_FMT_YUV422P;break;
+				case ADM_COLOR_YUV444:c=PIX_FMT_YUV444P;break;
+                default: ADM_assert(0);
+    }
+         _context=(void *)sws_getContext(
+                                                ww,hh,
+                                                c ,
+                                                ww,hh,
+                                                PIX_FMT_YUV420P,
+                                                flags, NULL, NULL,NULL);
+
+    if(!_context) ADM_assert(0);
+}
+
+uint8_t COL_Generic2YV12::clean(void)
+{
+        if(_context)
+                {
+                        sws_freeContext((SwsContext *)_context);
+                }
+                _context=NULL; 
+                return 1;  
+}
+
+uint8_t COL_Generic2YV12::transform(uint8_t **planes, uint32_t *strides,uint8_t *target)
+{
+	uint8_t *srd[3];
+	uint8_t *dst[3];
+	int ssrc[3];
+	int ddst[3];
+	int mul = 0;
+	uint32_t page = w * h;
+
+	ADM_assert(_context);
+
+	if(_colorspace &amp; ADM_COLOR_IS_YUV)
+	{
+		srd[0] = planes[0];
+		srd[1] = planes[2];
+		srd[2] = planes[1];
+		ssrc[0] = strides[0];
+		ssrc[1] = strides[2];
+		ssrc[2] = strides[1];
+
+		dst[0] = target;
+		dst[2] = target + page;
+		dst[1] = target + ((page * 5) &gt;&gt; 2);
+		ddst[0] = w;
+		ddst[1] = ddst[2] = w &gt;&gt; 1;
+
+		sws_scale((SwsContext *)_context, srd, ssrc, 0, h, dst, ddst);
+
+		return 1;
+	}
+
+	// Else RGB colorspace
+	switch (_colorspace &amp; 0x7FFF)
+	{
+		case ADM_COLOR_RGB16:
+		case ADM_COLOR_RGB555:
+		case ADM_COLOR_BGR555:
+			mul = 2;
+			break;
+		case ADM_COLOR_BGR24:
+		case ADM_COLOR_RGB24:
+			mul = 3;
+			break;
+		case ADM_COLOR_BGR32A:
+		case ADM_COLOR_RGB32A:
+			mul = 4;
+			break;
+		default:
+			ADM_assert(0);
+	}
+
+	srd[0] = planes[0];
+	srd[1] = srd[2] = 0;
+	ssrc[0] = mul * w;
+	ssrc[1] = ssrc[2] = 0;
+
+	if(strides &amp;&amp; strides[0] &gt; ssrc[0])
+		ssrc[0] = strides[0];
+
+	dst[0] = target;
+	dst[2] = target + page;
+	dst[1] = target + ((page * 5) &gt;&gt; 2);
+	ddst[0] = w;
+	ddst[1] = ddst[2] = w &gt;&gt; 1;
+
+	if(_backward)
+	{
+		ssrc[0] = -mul * w;
+		srd[0] = planes[0] + mul * w * (h - 1);
+	}
+
+	sws_scale((SwsContext *)_context, srd, ssrc, 0, h, dst, ddst);
+
+	return 1;
+}
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,10 +1,15 @@
 SET(ADM_coreImage_SRCS 
-	ADM_confCouple.cpp
-	ADM_videoFilter.cpp
-	ADM_videoFilterCache.cpp
-	ADM_image.cpp
-	ADM_imageUtils.cpp
-	ADM_imageResizer.cpp
+	ADM_confCouple.cpp  
+        ADM_videoFilter.cpp  
+        ADM_videoFilterCache.cpp
+        ADM_image.cpp  
+        ADM_imageUtils.cpp
+        ADM_imageResizer.cpp
+        yuv.cpp
+        rgb2yuv.cpp
+        ADM_colorspace.cpp
+        ADM_rgb.cpp
+        
 )
 
 ADD_LIBRARY(ADM_coreImage SHARED ${ADM_coreImage_SRCS})

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/rgb2yuv.cpp (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/rgb2yuv.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/rgb2yuv.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,278 @@
+
+/***************************************************************************
+                          yv.cpp  -  description
+                             -------------------
+
+	Convert a RGB triplet to its YUV conterpart
+
+    begin                : Wed Aug 12 2003
+    copyright            : (C) 2003 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;math.h&gt;
+
+
+#include &quot;ADM_default.h&quot;
+
+
+extern &quot;C&quot; {
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_lavcodec/avcodec.h&quot;
+#include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/swscale.h&quot;
+}
+
+#include &quot;ADM_colorspace.h&quot;
+
+/**
+	This is unoptimized because seldom called
+*/
+uint8_t COL_RgbToYuv(uint8_t R,uint8_t G,uint8_t B, uint8_t *y,int8_t *u,int8_t *v)
+{
+
+	float rr=R,bb=B,gg=G;
+	float yy,uu,vv;
+
+	yy=0.299*rr+ 		0.587*gg+ 	0.114*bb;
+	uu=-0.169*rr+ 	-0.331*gg+  	0.5*bb;
+	vv=0.5*rr+ 		-0.419*gg+ 	-0.081*bb;
+
+
+	if(uu&gt;127) uu=127;
+	if(uu&lt;-127) uu=-127;
+	*u=(int8_t)floor(uu);
+
+	if(vv&gt;127) vv=127;
+	if(vv&lt;-127) vv=-127;
+	*v=(int8_t)floor(vv);
+
+	if(yy&gt;255) yy=255;
+	if(yy&lt;0) yy=0;
+	*y=(uint8_t)floor(yy);
+
+	return 1;
+
+}
+static inline uint8_t PixelClip(int16_t in)
+{
+    if (in &gt; 255)
+	in = 255;
+   if(in&lt;0)
+   	in=0;
+    return (uint8_t) in;
+};
+
+			   	   
+static inline unsigned char ScaledPixelClip(long  i)
+{
+    return PixelClip(((i +32768) &gt;&gt; 16)); //  + 32768
+};
+
+//0.299	0.587	0.114
+const long int cyb = 6416; //int(0.114*219*65536/255+0.5);
+const long int cyg = 33038; //int(0.587*219*65536/255+0.5);
+const long int cyr = 16828; //int(0.299*219*65536/255+0.5);
+
+uint8_t COL_RawRGB32toYV12(uint8_t *data1,uint8_t *data2, uint8_t *oy,uint8_t *oy2, 
+				uint8_t *u, uint8_t *v,uint32_t lineSize,uint32_t height,uint32_t stride)
+{
+
+
+long int y1,y2;
+long int y3,y4;
+long int scaled_y,b_y;
+long int scaled_y2,b_y2;
+long int r_y,r_y2;  
+
+uint8_t *org1,*org2;
+/*
+0 2 1
+2 6 0
+1 5 3
+3 7 1
+*/
+#define B0 2
+#define R0 0
+#define M0 1
+
+#define M1 (M0+4)
+#define B1 (B0+4)
+#define R1 (R0+4)
+#define LEFT 0x108000
+
+//	printf(&quot;w %d h %d stride %d\n&quot;,lineSize,height,stride);
+	org1=data1;
+	org2=data2;
+	
+	long int alpha,beta,gamma;
+	
+    for(uint32_t yy=0;yy&lt;(height&gt;&gt;1);yy++)
+    {
+    	data1=org1;
+	data2=org2;
+      for (uint32_t x=0;x&lt;(lineSize&gt;&gt;1);x++)
+      {
+      
+#define MK1(source,out,row ) \
+       alpha=source[B##row]; \
+       alpha*=cyb; \
+       beta=source[M##row]; \
+       beta*=cyg; \
+       gamma=source[R##row]; \
+       gamma*=cyr;        \
+       out=(gamma+alpha+beta+LEFT)&gt;&gt;16; 
+      
+        
+       //y1 = (cyb*(long int)data1[B0] + cyg*(long int)data1[M0] + cyr*(long int)data1[R0] +LEFT) &gt;&gt; 16;
+        MK1(data1,y1,0);
+        oy[0] = y1;
+        //y2 = (cyb*(long int)data1[B1] + cyg*(long int)data1[M1] + cyr*(long int)data1[R1] +LEFT) &gt;&gt; 16;
+	MK1(data1,y2,1);
+        oy[1] = y2;
+	
+	//y3 = (cyb*(long int)data2[B0] + cyg*(long int)data2[M0] + cyr*(long int)data2[R0] +LEFT) &gt;&gt; 16;
+	MK1(data2,y3,0);
+        oy2[0] = y3;
+	
+        //y4 = (cyb*(long int)data2[B1] + cyg*(long int)data2[M1] + cyr*(long int)data2[R1] +LEFT) &gt;&gt; 16;
+	MK1(data2,y4,1);
+        oy2[1] = y4;
+
+
+        scaled_y = (y1+y2 - 32) * 38155;
+	scaled_y2 = (y3+y4 - 32) * 38155;
+	
+        b_y = ((data1[B0]+data1[B1]) &lt;&lt; 15) - scaled_y;
+	b_y2 = ((data2[B0]+data2[B1]) &lt;&lt; 15) - scaled_y2;
+	
+	b_y=(b_y+b_y2)/2;
+	
+        u[0] = ScaledPixelClip((b_y &gt;&gt; 10)*int(1/2.018*1024+0.5) + 0x800000);  // u * int(1/2.018*1024+0.5)
+        
+	r_y = ((data1[R0]+data1[R1]) &lt;&lt; 15) - scaled_y;
+	r_y2 = ((data2[R0]+data2[R1]) &lt;&lt; 15) - scaled_y2;
+	r_y=(r_y+r_y2)/2;
+	
+        v[0] = ScaledPixelClip((r_y &gt;&gt; 10)* int(1/1.596*1024+0.5) + 0x800000);  // v* int(1/1.596*1024+0.5)
+	
+	//u[0]=128;
+	//v[0]=128;
+        
+	oy+=2;
+	oy2+=2;
+	u++;
+	v++;
+	data1+=8;
+	data2+=8;
+      }
+     	org2+=2*stride;
+      	org1+=2*stride;
+	oy+=lineSize;
+	oy2+=lineSize;	
+     }
+      
+  return 1;
+}
+uint8_t COL_YuvToRgb( uint8_t y,int8_t u,int8_t v,uint8_t *r,uint8_t *g,uint8_t *b)
+{
+
+	float rr,bb,gg;
+	float yy=y,uu=u,vv=v;
+
+	rr=	yy+			 	1.402*vv;
+	gg= yy+ 	-0.344*uu+  	-0.714*vv;
+	bb=	yy+ 	1.772*uu 	 		;
+
+	#define CLIP(x) if(x&gt;255) x=255; else if (x&lt;0) x=0;x=x+0.49;
+	#define CVT(x,y) CLIP(x);*y=(uint8_t)floor(x);
+
+	CVT(rr,r);
+	CVT(gg,g);
+	CVT(bb,b);
+
+	return 1;
+
+}
+/**
+ * 		\fn COL_RGB24_to_YV12
+ *		\brief Convert RGB to YV12 using swscale
+ */
+uint8_t COL_RGB24_to_YV12_revert(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv)
+{
+	int flags = SWS_SPLINE;
+	struct SwsContext *context=NULL;
+	
+	#ifdef ADM_CPU_X86
+		#define ADD(x, y) if (CpuCaps::has##x()) flags |= SWS_CPU_CAPS_##y;
+
+		ADD(MMX,MMX);
+		ADD(3DNOW,3DNOW);
+		ADD(MMXEXT,MMX2);
+	#endif
+
+	#ifdef ADM_CPU_ALTIVEC
+	    flags |= SWS_CPU_CAPS_ALTIVEC;
+	#endif
+	    context = sws_getContext(w, h,
+	    									  PIX_FMT_RGB24,
+	    									  w, h,
+	    									  PIX_FMT_YUV420P,
+	    									  flags, NULL, NULL,NULL);
+	    ADM_assert(context);
+	
+	    uint8_t *src[3]={rgb+w*h*3-w*3,NULL,NULL};
+	    int srcStride[3]={-w*3,0,0};
+	    int dstStride[3]={w,w&gt;&gt;1,w&gt;&gt;1};
+	    uint8_t *dst[3]={yuv,yuv+w*h,yuv+((w*h*5)&gt;&gt;2)};
+//	    int sws_scale(struct SwsContext *context, uint8_t* src[], int srcStride[], int srcSliceY,
+//	                  int srcSliceH, uint8_t* dst[], int dstStride[]);	    
+	    sws_scale(context, src, srcStride, 0, h, dst, dstStride);
+	    
+		sws_freeContext(context);
+}
+/**
+ * 		\fn COL_RGB24_to_YV12
+ *		\brief Convert RGB to YV12 using swscale
+ */
+uint8_t COL_RGB24_to_YV12(uint32_t w,uint32_t h,uint8_t *rgb, uint8_t *yuv)
+{
+	int flags = SWS_SPLINE;
+	struct SwsContext *context=NULL;
+	
+	#ifdef ADM_CPU_X86
+		#define ADD(x, y) if (CpuCaps::has##x()) flags |= SWS_CPU_CAPS_##y;
+
+		ADD(MMX,MMX);
+		ADD(3DNOW,3DNOW);
+		ADD(MMXEXT,MMX2);
+	#endif
+
+	#ifdef ADM_CPU_ALTIVEC
+	    flags |= SWS_CPU_CAPS_ALTIVEC;
+	#endif
+	    context = sws_getContext(w, h,
+	    									  PIX_FMT_RGB24,
+	    									  w, h,
+	    									  PIX_FMT_YUV420P,
+	    									  flags, NULL, NULL,NULL);
+	    ADM_assert(context);
+	
+	    uint8_t *src[3]={rgb,NULL,NULL};
+	    int srcStride[3]={w*3,0,0};
+	    int dstStride[3]={w,w&gt;&gt;1,w&gt;&gt;1};
+	    uint8_t *dst[3]={yuv,yuv+((w*h*5)&gt;&gt;2),yuv+w*h};
+//	    int sws_scale(struct SwsContext *context, uint8_t* src[], int srcStride[], int srcSliceY,
+//	                  int srcSliceH, uint8_t* dst[], int dstStride[]);	    
+	    sws_scale(context, src, srcStride, 0, h, dst, dstStride);
+	    
+		sws_freeContext(context);
+}
+//EOF

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/yuv.cpp (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_colorspace/yuv.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/yuv.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,113 @@
+
+/***************************************************************************
+                          yv.cpp  -  description
+                             -------------------
+
+Convert yv422/yuv411 to YV12
+
+Not optimised for speed at all, should take the one from ffmpeg
+
+    begin                : Wed Apr 19 2003
+    copyright            : (C) 2003 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;string.h&gt;
+
+#include &quot;ADM_default.h&quot;
+#include &quot;colorspace.h&quot;
+
+uint8_t COL_422_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h)
+{
+
+
+			uint8_t *xsrc;
+			uint8_t *dst_y,*dst_u,*dst_v;
+
+
+			xsrc= in[0];
+			dst_y=out;
+			// copy y as is
+            		for(uint32_t y=h;y&gt;0;y--)
+			{
+				memcpy(dst_y,xsrc,w);
+				dst_y+=w;
+				xsrc+=stride[0];
+			}
+			// u
+			xsrc= in[1];
+			dst_u=out+(w*h);
+			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
+			{
+				memcpy(dst_u,xsrc,w&gt;&gt;1);
+				dst_u+=w&gt;&gt;1;
+				xsrc+=stride[1]*2;
+			}
+			// v
+			xsrc= in[2];
+			dst_v=out+(w*h)+((w*h)&gt;&gt;2);;
+			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
+			{
+				memcpy(dst_v,xsrc,w&gt;&gt;1);
+				dst_v+=w&gt;&gt;1;
+				xsrc+=stride[2]*2;
+			}
+			return 1;
+}
+uint8_t COL_411_YV12( uint8_t *in[3], uint32_t stride[3],  uint8_t *out,uint32_t w, uint32_t h)
+{
+
+
+			uint8_t *xsrc;
+			uint8_t *dst_y,*dst_u,*dst_v;
+
+
+			xsrc= in[0];
+			dst_y=out;
+			// copy y as is
+            		for(uint32_t y=h;y&gt;0;y--)
+			{
+				memcpy(dst_y,xsrc,w);
+				dst_y+=w;
+				xsrc+=stride[0];
+			}
+			// u
+			xsrc= in[1];
+			dst_u=out+(w*h);
+			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
+			{
+				//memcpy(dst_u,xsrc,w&gt;&gt;1);
+				for(uint32_t x=0;x&lt;w&gt;&gt;2;x++)
+					{
+						*(dst_u+x+x+1)=*(dst_u+x+x)=*(xsrc+x);
+					}
+				dst_u+=w&gt;&gt;1;
+				xsrc+=stride[1]*2;
+			}
+			// v
+			xsrc= in[2];
+			dst_v=out+(w*h)+((w*h)&gt;&gt;2);;
+			for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
+			{
+				for(uint32_t x=0;x&lt;w&gt;&gt;2;x++)
+					{
+						*(dst_v+x+x+1)=*(dst_v+x+x)=*(xsrc+x);
+					}
+				dst_v+=w&gt;&gt;1;
+				xsrc+=stride[2]*2;
+			}
+			return 1;
+}
+
+

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.hxx	2008-05-01 08:32:05 UTC (rev 4001)
@@ -34,6 +34,7 @@
  #include &quot;ADM_image.h&quot;
  #include &quot;../ADM_editor/ADM_edCache.h&quot;
  #include &quot;ADM_pp.h&quot;
+ #include &quot;ADM_colorspace.h&quot;
  
 #define MAX_SEG  	100 // Should be enougth
 #define MAX_VIDEO   100
@@ -80,7 +81,7 @@
 {
   	vidHeader 							*_aviheader;
   	decoders							*decoder;
-        COL_Generic2YV12                                                *color;
+    COL_Generic2YV12                    *color;
 
 	uint32_t  							_audio_size;
 	uint64_t							_audio_duration; //! IN SAMPLE

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/adm_encConfig.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -38,7 +38,7 @@
 extern int AllVideoCodecCount;
 extern uint8_t DIA_videoCodec(int *codecIndex);
 extern void UI_setVideoCodec(int i);
-extern void getMainWindowHandles(int *handle, int *nativeHandle);
+extern void getMainWindowHandles(long int *handle, long int *nativeHandle);
 
 // Some static stuff
 void setVideoEncoderSettings(COMPRESSION_MODE mode, uint32_t param, uint32_t extraConf, uint8_t *extraData);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/ADM_vidDummyFilter.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/ADM_vidDummyFilter.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -16,13 +16,13 @@
  ***************************************************************************/
 
 #include &quot;config.h&quot;
+#if 0 // OBSOLETE
 
 #include &quot;ADM_default.h&quot;
 
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidFlipV.h&quot;
 
-
 //#define REDUCED
 //adm_fast_memcpy myAdmMemcpy=memcpy;
 #undef memcpy
@@ -137,5 +137,5 @@
 	return 1;
 }
 
+#endif
 
-

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -23,12 +23,14 @@
 #include &quot;ADM_assert.h&quot;
 #include &quot;config.h&quot;
 #include &quot;fourcc.h&quot;
+#include &quot;DIA_fileSel.h&quot;
+#include &quot;ADM_dynamicLoading.h&quot;
 
-
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_video/ADM_videoNull.h&quot;
 #include &quot;ADM_videoFilter_internal.h&quot;
+#include &quot;ADM_videoFilterDynamic.h&quot;
 #include &quot;ADM_video/ADM_vidPartial.h&quot;
 #include &quot;ADM_userInterfaces/ADM_commonUI/GUI_render.h&quot;
 
@@ -37,9 +39,21 @@
 #include &quot;ADM_osSupport/ADM_debug.h&quot;
 #include &quot;ADM_osSupport/ADM_quota.h&quot;
 //
+class ADM_vf_pluginLoader : public ADM_LibWrapper
+{
+	public:
+		VF_getDescriptor		*getDesc;
+		ADM_vf_pluginLoader(const char *file) : ADM_LibWrapper()
+		{
+				getDesc=NULL;
+				if(loadLibrary(file))
+					getDesc=(VF_getDescriptor *)getSymbol(&quot;ADM_VF_getDescriptor&quot;);
+		};
+};
 // exported vars
 std::vector &lt;FilterDescriptor *&gt; allfilters;
 std::vector &lt;FilterDescriptor *&gt; filterCategories[VF_MAX];
+std::vector &lt;ADM_vf_pluginLoader *&gt; pluginLoaderQueue;
 
 uint32_t nb_active_filter=0;
 FILTER  videofilters[VF_MAX_FILTER];
@@ -78,7 +92,7 @@
 		  	delete videofilters[i].filter;
 			if(videofilters[i].conf) delete videofilters[i].conf;
              videofilters[i].conf=NULL;
-             videofilters[i].filter=NULL;  		
+             videofilters[i].filter=NULL;
 	}
    nb_active_filter=0;
 }
@@ -89,7 +103,7 @@
 	for(uint32_t i=0;i&lt;allfilters.size();i++)
 	{
 		name=allfilters[i]-&gt;filterName;
-		
+
 		{
 			if(name)
 				printf(&quot;\t%s\n&quot;,name);
@@ -111,15 +125,86 @@
 				if(strlen(name))
 				{
 					if(!strcasecmp(name,inname))
-						return allfilters[ i]-&gt;tag; 
+						return allfilters[ i]-&gt;tag;
 				}
 			}
 		}
 	}
 	return filter;
 }
+/**
+ * 	\fn tryLoadingFilterPlugin
+ *  \brief try to load the plugin given as argument..
+ */
 
+#define Fail(x) {printf(#x&quot;\n&quot;);goto er;}
+static bool tryLoadingFilterPlugin(const char *file)
+{
+	ADM_vf_pluginLoader *dll=new ADM_vf_pluginLoader(file);
+
+	FilterDescriptor *desc=NULL;
+	FilterDescriptor *myDesc=NULL;
+	if(!dll-&gt;getDesc) Fail(nogetdesc);
+
+	desc=dll-&gt;getDesc();
+	if(!desc) Fail(GetDescriptor);
+	// Check the API version
+	if(desc-&gt;apiVersion!=ADM_FILTER_API_VERSION) Fail(WrongAPI);
+	// Duplicate it, just in case...
+	myDesc=new FilterDescriptor();
+	memcpy(myDesc,desc,sizeof(*myDesc));
+	// push it !
+	myDesc-&gt;tag=tagCount++;
+	ADM_assert(myDesc-&gt;category&lt;VF_MAX);
+
+    allfilters.push_back (myDesc);
+    filterCategories[myDesc-&gt;category].push_back(myDesc);
+    pluginLoaderQueue.push_back(dll); // Needed for cleanup. FIXME TODO Delete it.
+    aprintf(&quot;[Filters] Registered filter %s as  %s\n&quot;,file,desc-&gt;name);
+    return true;
+	// Tag it
+	// Fail!
+er:
+	delete dll;
+	return false;
+
+}
 /**
+ * 	\fn ADM_vf_loadPlugins
+ *  \brief load all audio plugins
+ */
+uint8_t ADM_vf_loadPlugins(const char *path)
+{
+#define MAX_EXTERNAL_FILTER 50
+
+#ifdef __WIN32
+#define SHARED_LIB_EXT &quot;dll&quot;
+#elif defined(__APPLE__)
+#define SHARED_LIB_EXT &quot;dylib&quot;
+#else
+#define SHARED_LIB_EXT &quot;so&quot;
+#endif
+
+	char *files[MAX_EXTERNAL_FILTER];
+	uint32_t nbFile;
+
+	memset(files,0,sizeof(char *)*MAX_EXTERNAL_FILTER);
+	printf(&quot;[ADM_vf_plugin] Scanning directory %s\n&quot;,path);
+
+	if(!buildDirectoryContent(&amp;nbFile, path, files, MAX_EXTERNAL_FILTER, SHARED_LIB_EXT))
+	{
+		printf(&quot;[ADM_vf_plugin] Cannot parse plugin\n&quot;);
+		return 0;
+	}
+
+	for(int i=0;i&lt;nbFile;i++)
+		tryLoadingFilterPlugin(files[i]);
+
+	printf(&quot;[ADM_vf_plugin] Scanning done\n&quot;);
+
+	return 1;
+}
+/**
  * 	\fn registerFilterEx
  *  \brief Register a video filter
  */
@@ -134,12 +219,12 @@
 												category,
 												create,
 												create_from_script);
-	
+
 		ADM_assert(desc-&gt;category&lt;VF_MAX);
-	
+
         allfilters.push_back (desc);
         filterCategories[desc-&gt;category].push_back(desc);
-        
+
         aprintf(&quot;[Filters] Registered filter %s\n&quot;,desc-&gt;name);
 
 
@@ -249,7 +334,7 @@
                     AVDMGenericVideoStream *old;
                             old= videofilters[i].filter;
                             tag=videofilters[i].tag;
-  
+
                             videofilters[i].filter=filterCreateFromTag(tag,
                                                 videofilters[i].conf,
                                                 videofilters[i-1].filter);
@@ -268,7 +353,7 @@
 	 AVDMGenericVideoStream *filter;
 
 			ADM_assert(tag!=VF_INVALID);
-                       
+
                         {
                           for(unsigned int i=0;i&lt;allfilters.size();i++)
                                   {
@@ -280,7 +365,7 @@
                                   }
                         }
 			ADM_assert(0);
-			return NULL;                      
+			return NULL;
 }
 /*
 
@@ -297,7 +382,7 @@
         }
     }
     ADM_assert(0);
-    return NULL;                      
+    return NULL;
 }
 
 const char  *filterGetNameFromTag(VF_FILTERS tag)
@@ -308,14 +393,14 @@
 }
 /*____________________________________
 	Save and load current set of filters
-	
+
 	We save/load the tag that identifies the filter
 	and a raw hex dump of its config
 		+ comment and name in clear text
-	____________________________________ 
+	____________________________________
 */
 
-/*---------------------------------------*/	 
+/*---------------------------------------*/
 
 
 //______________________________________________________
@@ -347,7 +432,7 @@
 						}
 					}
 					if(found==-1)
-					{	
+					{
 						printf(&quot;Param : %s not found or incorrect\n&quot;,param-&gt;param[i]);
 						 return NULL;
 					}
@@ -401,7 +486,7 @@
 				}
 			}
 			if(found==-1)
-			{	
+			{
 				printf(&quot;Param : %s not found or incorrect\n&quot;,param-&gt;param[i]);
 				 return NULL;
 			}
@@ -421,7 +506,7 @@
 		}
 		return couple;
 	}
-	
+
 }
 uint8_t 	filterAddScript(VF_FILTERS tag,uint32_t n,Arg *args)
 {
@@ -438,7 +523,7 @@
 			if(nb_active_filter&lt;1)
 			{
   		 		nb_active_filter=1;
-  		 		videofilters[0].filter=  new AVDMVideoStreamNull(video_body,0,info.nb_frames);	
+  		 		videofilters[0].filter=  new AVDMVideoStreamNull(video_body,0,info.nb_frames);
 			}
 			AVDMGenericVideoStream *filter=NULL;
 			CONFcouple *setup=NULL;
@@ -450,7 +535,7 @@
 			filter=allfilters[i]-&gt;create_from_script(videofilters[nb_active_filter-1].filter,n-1,&amp;(args[1]));
 			if(!filter) return 0;
 			videofilters[nb_active_filter].filter=filter;
-			videofilters[nb_active_filter].tag=tag;						
+			videofilters[nb_active_filter].tag=tag;
 			filter-&gt;getCoupledConf(&amp;setup);
 			videofilters[nb_active_filter].conf=setup;
 			nb_active_filter++;
@@ -470,9 +555,9 @@
                         for(unsigned int j=0;j&lt;allfilters.size();j++)
                                 {
                                         if(tag==allfilters[j]-&gt;tag)
-                                        {       
+                                        {
                                                 qfprintf(f,&quot;\&quot;%s\&quot;&quot;,allfilters[j]-&gt;filterName);
-                                                break;  
+                                                break;
                                         }
                                 }
                         // get args
@@ -491,9 +576,9 @@
                                 }
                                 delete couple;
                         }
-                        qfprintf(f,&quot;);\n&quot;);                      
-                
+                        qfprintf(f,&quot;);\n&quot;);
+
                 }
-                
-}               	
+
+}
 // EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_filter/filter_declaration.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -52,7 +52,6 @@
 	REGISTERX(VF_TRANSFORM, &quot;resize&quot;,QT_TR_NOOP(&quot;Resize&quot;),QT_TR_NOOP(&quot;Picture resizer ported from Avisynth.&quot;), VF_RESIZE,1,res_create,resize_script);
   	REGISTERX(VF_TRANSFORM, &quot;addblack&quot;,QT_TR_NOOP(&quot;Add black borders&quot;),QT_TR_NOOP(&quot;Add pure black border(s). Enlarges the picture.&quot;),VF_ADDBORDER,1,addBorder_create,addBorder_script);
 	REGISTERX(VF_TRANSFORM, &quot;blacken&quot;,QT_TR_NOOP(&quot;Blacken borders&quot;),QT_TR_NOOP(&quot;Fill borders with pure black. Doesn't alter size.&quot;),VF_BLACKEN,1,bsmear_create,bsmear_script);
-  	REGISTERX(VF_TRANSFORM, &quot;vflip&quot;,QT_TR_NOOP(&quot;Vertical flip&quot;),QT_TR_NOOP(&quot;Vertically flip the picture.&quot;),VF_FLIP,1,flipv_create,flipv_script);
 	REGISTERX(VF_TRANSFORM, &quot;rotate&quot;,QT_TR_NOOP(&quot;Rotate&quot;),QT_TR_NOOP(&quot;Rotate the picture by 90, 180 or 270 degrees.&quot;),VF_ROTATE,1,rotate_create,rotate_script);
     REGISTERX(VF_TRANSFORM, &quot;resamplefps&quot;,QT_TR_NOOP(&quot;Resample fps&quot;),QT_TR_NOOP(&quot;Change framerate while keeping duration.&quot;),VF_RESAMPLE_FPS,1,resamplefps_create,resamplefps_script);                
     REGISTERX(VF_TRANSFORM, &quot;reverse&quot;,QT_TR_NOOP(&quot;Reverse&quot;),QT_TR_NOOP(&quot;Play video backward.&quot;),VF_REVERSE,1,reverse_create,reverse_script);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -34,7 +34,7 @@
 #include &quot;prototype.h&quot;
 
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
 //#include &quot;ADM_codecs/ADM_divxEncode.h&quot;
 #include &quot;ADM_mpeg2enc.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/ADM_imageLoader.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -16,7 +16,7 @@
 #include &quot;ADM_default.h&quot;
 
 #include &quot;ADM_lavcodec.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;ADM_image.h&quot;
 
 #include &quot;ADM_codecs/ADM_codec.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -28,7 +28,7 @@
 };
 
 #include &quot;ADM_editor/ADM_Video.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter_internal.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -27,7 +27,7 @@
 };
 
 #include &quot;ADM_editor/ADM_Video.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter_internal.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -29,7 +29,7 @@
 #include &quot;avi_vars.h&quot;
 #include &quot;prototype.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter_internal.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -34,7 +34,7 @@
 #include &quot;avi_vars.h&quot;
 #include &quot;prototype.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter_internal.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_plugin/ADM_vidEnc_plugin.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -87,8 +87,8 @@
 typedef struct
 {
 	int structSize;
-	int parent;
-	int parentNative;
+	long int parent;
+	long int parentNative;
 } vidEncConfigParameters;
 
 int vidEncGetEncoders(int uiType, int **encoderIds);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -22,8 +22,8 @@
 
 
 #include &quot;../ADM_toolkit_gtk/toolkit_gtk.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -19,7 +19,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;ADM_assert.h&quot;
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidChromaShift_param.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -22,7 +22,6 @@
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyContrast.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -25,8 +25,8 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyCrop.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -25,8 +25,8 @@
 
 #include &quot;avi_vars.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_video/ADM_vidEqualizer.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,10 +21,6 @@
 #include &quot;../ADM_toolkit_gtk/toolkit_gtk.h&quot;
 
 
-
-
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidHue.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -27,7 +27,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_video/ADM_vidMPdelogo.h&quot;
 
 extern &quot;C&quot; {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -29,9 +29,9 @@
 class ADMfont;
 #include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
 
+#include &quot;ADM_colorspace.h&quot;
+
 #include &quot;ADM_osSupport/ADM_debugID.h&quot;
 #define MODULE_NAME MODULE_FILTER
 #include &quot;ADM_osSupport/ADM_debug.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -35,7 +35,7 @@
 #include &quot;../ADM_commonUI/GUI_render.h&quot;
 #include &quot;../ADM_commonUI/GUI_accelRender.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_libraries/ADM_ffmpeg/ADM_libswscale/ADM_mp.h&quot;
 
 void GUI_gtk_grow_off(int onff);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -36,8 +36,8 @@
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_fileSel.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
 
+
 #include &quot;ADM_videoFilter/ADM_vobsubinfo.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidVobSub.h&quot;
 #include &quot;ADM_ocr/ADM_leftturn.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ui_support.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ui_support.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ui_support.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -52,15 +52,15 @@
 	delete [] pluginDir;
 }
 
-void getMainWindowHandles(int *handle, int *nativeHandle)
+void getMainWindowHandles(long int *handle,long int *nativeHandle)
 {
-	*handle = (int)guiRootWindow;
+	*handle = (long int)guiRootWindow;
 
 #ifdef __WIN32
-	*nativeHandle = (int)guiRootWindow-&gt;window;
+	*nativeHandle = (long int)guiRootWindow-&gt;window;
 #elif defined(__APPLE__)
-	*nativeHandle = (int)getMainNSWindow();
+	*nativeHandle = (long int)getMainNSWindow();
 #else
-	*nativeHandle = (int)guiRootWindow-&gt;window;
+	*nativeHandle = (long int)guiRootWindow-&gt;window;
 #endif
 }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_flyDialog.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_flyDialog.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,7 +21,7 @@
 
 
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -13,7 +13,7 @@
 #include &quot;ADM_misc.h&quot;
 
 #include &quot;GUI_ui.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 
 static ADM_OUT_FORMAT format=ADM_AVI;
 static int audioCodec=0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ui_support.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ui_support.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ui_support.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -41,7 +41,7 @@
 	delete [] pluginDir;
 }
 
-void getMainWindowHandles(int *handle, int *nativeHandle)
+void getMainWindowHandles(long int *handle, long int *nativeHandle)
 {
 	*handle = 0;
 	*nativeHandle = 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -30,7 +30,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidASharp_param.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -29,7 +29,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidChromaShift_param.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -29,8 +29,8 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -29,7 +29,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 #include &quot;DIA_flyCrop.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_eq2.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,7 +21,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;ADM_videoFilter/ADM_vidEq2.h&quot;
 
 #include &quot;DIA_flyDialog.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -28,7 +28,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidHue.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -26,7 +26,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -24,8 +24,8 @@
 #include &quot;DIA_fileSel.h&quot;
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_videoFilter/ADM_vobsubinfo.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidVobSub.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -41,7 +41,7 @@
 #include &lt;QX11Info&gt;
 #endif
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;GUI_render.h&quot;
 #include &quot;GUI_accelRender.h&quot;
 #include &quot;prefs.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_ocr.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_ocr.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_ocr.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -26,8 +26,8 @@
 #include &quot;DIA_fileSel.h&quot;
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_videoFilter/ADM_vobsubinfo.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidVobSub.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -75,13 +75,13 @@
 	delete [] pluginDir;
 }
 
-void getMainWindowHandles(int *handle, int *nativeHandle)
+void getMainWindowHandles(long int *handle, long int *nativeHandle)
 {
-	*handle = (int)QuiMainWindows;
+	*handle = (long int)QuiMainWindows;
 
 #if defined(__APPLE__)
-	*nativeHandle = (int)HIViewGetWindow(HIViewRef(QuiMainWindows-&gt;winId()));
+	*nativeHandle = (long int)HIViewGetWindow(HIViewRef(QuiMainWindows-&gt;winId()));
 #else
-	*nativeHandle = (int)QuiMainWindows-&gt;winId();
+	*nativeHandle = (long int)QuiMainWindows-&gt;winId();
 #endif
 }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,7 +21,6 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -19,7 +19,6 @@
 #include &lt;stdio.h&gt;
 #include &lt;math.h&gt;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,7 +17,7 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -21,7 +21,7 @@
 
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 #include &quot;ADM_assert.h&quot;
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyCrop.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -14,7 +14,7 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;GUI_render.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_flyDialog.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -24,6 +24,7 @@
  ***************************************************************************/
 #ifndef ADM_FLY_DIALOG_H
 #define ADM_FLY_DIALOG_H
+#include &quot;ADM_colorspace.h&quot;
 enum ResizeMethod {
     RESIZE_NONE = 0,	// No automatic resize
 	RESIZE_AUTO = 1,	// Resize image when convenient (YUV: after filter, RGB: before applying filter)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEq2.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -19,8 +19,8 @@
 #include &lt;stdio.h&gt;
 #include &lt;math.h&gt;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidContrast.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEraser.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEraser.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyEraser.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,8 +17,8 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidEraser.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -28,7 +28,7 @@
 #include &lt;stdio.h&gt;
 
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidHue.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,8 +17,8 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidParticle.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -20,7 +20,7 @@
 
 #include &lt;math.h&gt;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+//#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 #include &quot;ADM_image.h&quot;
 
 #include &quot;ADM_videoFilter.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -17,8 +17,8 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidSwissArmyKnife.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -20,8 +20,8 @@
 #include &lt;stdio.h&gt;
 #include &lt;math.h&gt;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
+
 #include &quot;ADM_image.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidThreshold.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -26,7 +26,7 @@
 //#include &quot;ADM_video/ADM_vidFont.h&quot;
 class ADMfont;
 #include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+//#include &quot;ADM_colorspace/colorspace.h&quot;
 /*****************************************************************/
 extern int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b);
 extern int DIA_srtPos(AVDMGenericVideoStream *source,uint32_t *size,uint32_t *position);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -26,7 +26,7 @@
 #include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h&quot;
 #include &quot;ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_codecs/ADM_ffmp43.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -32,7 +32,7 @@
 #endif
 
 #include &quot;prefs.h&quot;
-#include &quot;../../ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 
 
 extern uint8_t BitBlit(uint8_t *dst, uint32_t pitchDest,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -33,8 +33,8 @@
 #include &quot;SDL_syswm.h&quot;
 }
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
+
 #include &quot;GUI_render.h&quot;
 
 #include &quot;GUI_accelRender.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -36,7 +36,7 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+
 #include &quot;GUI_render.h&quot;
 
 #include &quot;GUI_accelRender.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -26,7 +26,7 @@
 
 #include &quot;DIA_fileSel.h&quot;
 
-#include &quot;ADM_colorspace/colorspace.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 
 
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidASS.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -16,7 +16,7 @@
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_video/ADM_vidCommonFilter.h&quot;
 #include &quot;ADM_vidASS.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;DIA_factory.h&quot;
 
 #ifdef USE_FREETYPE

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -34,8 +34,7 @@
 
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_video/ADM_vidCommonFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_vidDvbSub.h&quot;
 static FILTER_PARAM assParam={7,

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,111 +0,0 @@
-/***************************************************************************
-                          ADM_vidFlipV.cpp  -  description
-                             -------------------
-    begin                : Wed Nov 6 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_vidFlipV.h&quot;
-
-
-static FILTER_PARAM flipParam={0,{&quot;&quot;}};
-
-
-SCRIPT_CREATE(flipv_script,ADMVideoFlipV,flipParam);
-BUILD_CREATE(flipv_create,ADMVideoFlipV);
- 
-
-char *ADMVideoFlipV::printConf( void )
-{
- 	static char buf[50];
- 	
- 	sprintf((char *)buf,&quot; V-Flip&quot;);
-        return buf;
-}
-
-ADMVideoFlipV::ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup)
-{
-    UNUSED_ARG(setup);
- 	_in=in;		
-   	memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info)); 	
-  	_info.encoding=1;	
-	_uncompressed=new ADMImage(_in-&gt;getInfo()-&gt;width,_in-&gt;getInfo()-&gt;height);
-	ADM_assert(_uncompressed);    	  	
-}
-ADMVideoFlipV::~ADMVideoFlipV()
-{
- 	delete  _uncompressed;	
-	_uncompressed=NULL;
-  
-}
-uint8_t ADMVideoFlipV::getFrameNumberNoAlloc(uint32_t frame,
-				uint32_t *len,
-   				ADMImage *data,
-				uint32_t *flags)
-{
-
-	if(frame&gt;= _info.nb_frames) return 0;
-	// read uncompressed frame
-	if(!_in-&gt;getFrameNumberNoAlloc(frame, len,_uncompressed,flags)) return 0;
-
-         uint8_t *in,*out;
-         uint32_t stride=_info.width;
-         uint32_t h=_info.height;
-         uint32_t page,qpage;
-        
-
-	  
-         page=stride*h;
-         qpage=page&gt;&gt;2;
-         
-         in=YPLANE(_uncompressed);
-         out=YPLANE(data)+(h-1)*stride;
-         // flip y
-         for(uint32_t y=h;y&gt;0;y--)
-         {
-		 memcpy(out,in,stride);
-		 in+=stride;
-		 out-=stride;
-	}
-	// Flip U &amp; V			         
-        stride&gt;&gt;=1;
-	in=UPLANE(_uncompressed);	
-        out=UPLANE(data)+qpage-stride;
-         // flip u
-         for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-         {
-		 memcpy(out,in,stride);
-		 in+=stride;
-		 out-=stride;
-	}
-	in=VPLANE(_uncompressed);
-        out=VPLANE(data)+qpage-stride;
-       
-      
-         // flip u
-         for(uint32_t y=h&gt;&gt;1;y&gt;0;y--)
-         {
-		 memcpy(out,in,stride);
-		 in+=stride;
-		 out-=stride;
-	}   
-	data-&gt;copyInfo(_uncompressed);
-	return 1;
-}
-
-
-
-

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,37 +0,0 @@
-/***************************************************************************
-                          ADM_vidFlipV.h  -  description
-                             -------------------
-    begin                : Wed Nov 6 2002
-    copyright            : (C) 2002 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef FLIP__
-#define FLIP__
-
- class  ADMVideoFlipV:public AVDMGenericVideoStream
- {
-
- protected:
-    		AVDMGenericVideoStream 	*_in;    	
-           virtual char 									*printConf(void);
-          
- public:
- 		
-  					ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup);
-  					virtual ~ADMVideoFlipV();
-		          virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-          																	ADMImage *data,uint32_t *flags);
-					virtual uint8_t configure( AVDMGenericVideoStream *instream) { UNUSED_ARG(instream); return 1;};          																	
-
-
- }     ;
-#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidLogo.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidLogo.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidLogo.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -23,7 +23,7 @@
 
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_video/ADM_vidCommonFilter.h&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;DIA_factory.h&quot;
 
 static FILTER_PARAM logoParam={4,

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobSubRender.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobSubRender.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobSubRender.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -55,7 +55,7 @@
 
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_fileSel.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_vobsubinfo.h&quot;
 #include &quot;ADM_vidVobSub.h&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidVobsub.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -24,7 +24,7 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_fileSel.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+#include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_vobsubinfo.h&quot;
 #define VOBSUB &quot;/capture/sub/phone.sub&quot;
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,7 +1,7 @@
 SET(ADM_videoFilter_SRCS 
 	ADM_lavpp_deint.cpp      ADM_vidDecTelecide.cpp      ADM_vidFields.cpp           ADM_vidMcDeint.cpp
 	ADM_vidPulldown.cpp       ADM_vidSwapSmart.cpp
-	ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidFlipV.cpp            ADM_vidMosaic.cpp
+	ADM_vidAddBorder.cpp     ADM_vidDeintASM.cpp         ADM_vidMosaic.cpp
 	ADM_vidResampleFPS.cpp    ADM_vidUVSwap.cpp
 	ADM_vidASS.cpp           ADM_vidDeinterlace.cpp      ADM_vidFlux.cpp             ADM_vidMPLD3D.cpp
 	ADM_vidReverse.cpp        ADM_vidVlad.cpp
@@ -54,4 +54,4 @@
 
 IF (ADM_CPU_X86)
 	ADD_SOURCE_CFLAGS(ADM_vidDecDec.cpp &quot;-DUSE_SSE&quot;)
-ENDIF (ADM_CPU_X86)
\ No newline at end of file
+ENDIF (ADM_CPU_X86)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -161,8 +161,7 @@
 	ADM_video
 	ADM_audiodevice
 	ADM_ocr
-	ADM_colorspace)
-
+)
 FOREACH(_current ${ADM_SUBDIR})
 	ADD_SUBDIRECTORY(${_current})
 	ADD_ADMLIB_ALL_TARGETS(${_current})
@@ -234,8 +233,7 @@
 	ADM_lvemux
 	ADM_utilities
 	ADM_xvidratectl
-	ADM_colorspace)
-
+)
 ADD_LIB_ALL_TARGETS(
 	ADM_smjs
 	ADM_libavutil

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -47,7 +47,7 @@
 #include &quot;ADM_encoder/adm_encConfig.h&quot;
 #include &quot;ADM_userInterfaces/ADM_commonUI/GUI_render.h&quot;
 #include &quot;ADM_userInterfaces/ADM_commonUI/GUI_ui.h&quot;
-#include &quot;ADM_colorspace/colorspace.h&quot;
+
 #include &quot;ADM_audiodevice/audio_out.h&quot;
 
 #include &quot;ADM_userInterfaces/ADM_commonUI/DIA_busy.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -72,6 +72,7 @@
 extern void ADM_memStatEnd( void );
 extern void getUIDescription(char*);
 extern uint8_t ADM_ad_loadPlugins(const char *path);
+extern uint8_t ADM_vf_loadPlugins(const char *path);
 extern void loadPlugins(void);
 extern void InitFactory(void);
 extern void InitCoreToolkit(void);
@@ -238,18 +239,28 @@
 	// Load system wide audio decoder plugin
 #ifdef __APPLE__
 	char *adPlugins = ADM_getInstallRelativePath(&quot;../Resources/lib&quot;,&quot;ADM_plugins&quot;,&quot;audioDecoder&quot;);
+	char *vfPlugins = ADM_getInstallRelativePath(&quot;../Resources/lib&quot;,&quot;ADM_plugins&quot;,&quot;videoFilter&quot;);
 #else
 	char *adPlugins = ADM_getInstallRelativePath(&quot;lib&quot;,&quot;ADM_plugins&quot;,&quot;audioDecoder&quot;);
+	char *vfPlugins = ADM_getInstallRelativePath(&quot;lib&quot;,&quot;ADM_plugins&quot;,&quot;videoFilter&quot;);
 #endif
 
 	ADM_ad_loadPlugins(adPlugins);
 	delete [] adPlugins;
 
+	ADM_vf_loadPlugins(vfPlugins);
+	delete [] vfPlugins;
+
 	// load local audio decoder plugins
 	adPlugins=ADM_getHomeRelativePath(&quot;plugins&quot;,&quot;audioDecoder&quot;);
 	ADM_ad_loadPlugins(adPlugins);
 	delete [] adPlugins;
 
+	// load local video filter plugins
+	vfPlugins=ADM_getHomeRelativePath(&quot;plugins&quot;,&quot;videoFilter&quot;);
+	ADM_vf_loadPlugins(vfPlugins);
+	delete [] vfPlugins;
+	// load encoder plugins...
 	loadPlugins();
 	//***************Plugins *********************
 

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1 @@
+ADD_SUBDIRECTORY(VerticalFlip)

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.cpp	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.cpp	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,137 @@
+/***************************************************************************
+                          ADM_vidFlipV.cpp  -  description
+                             -------------------
+    begin                : Wed Nov 6 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_default.h&quot;
+#include &quot;ADM_videoFilterDynamic.h&quot;
+//********** Class Definition ************
+ class ADMVideoFlipV : public AVDMGenericVideoStream 
+ {
+
+protected:
+	AVDMGenericVideoStream *_in;
+	virtual char *printConf(void);
+
+public:
+
+	ADMVideoFlipV(AVDMGenericVideoStream *in, CONFcouple *setup);
+	virtual ~ADMVideoFlipV();
+	virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+			ADMImage *data, uint32_t *flags);
+	virtual uint8_t configure(AVDMGenericVideoStream *instream) 
+	{
+		UNUSED_ARG(instream);
+		return 1;
+	};
+};
+
+//********** Register chunk ************
+static FILTER_PARAM flipParam={0,{&quot;&quot;}};
+
+
+SCRIPT_CREATE(flipv_script,ADMVideoFlipV,flipParam);
+BUILD_CREATE(flipv_create,ADMVideoFlipV);
+
+VF_DEFINE_FILTER(ADMVideoFlipV,
+				&quot;flipV&quot;,
+				QT_TR_NOOP(&quot;Vertical flip&quot;),
+				1,
+				flipv_create,
+				flipv_script,
+				VF_TRANSFORM,
+				QT_TR_NOOP(&quot;Vertically flip the picture.&quot;));
+//************************************
+char *ADMVideoFlipV::printConf( void )
+{
+ 	static char buf[50];
+ 	
+ 	sprintf((char *)buf,&quot; V-Flip&quot;);
+        return buf;
+}
+
+ADMVideoFlipV::ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup)
+{
+    UNUSED_ARG(setup);
+ 	_in=in;		
+   	memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info)); 	
+  	_info.encoding=1;	
+	_uncompressed=new ADMImage(_in-&gt;getInfo()-&gt;width,_in-&gt;getInfo()-&gt;height);
+	ADM_assert(_uncompressed);    	  	
+}
+ADMVideoFlipV::~ADMVideoFlipV()
+{
+ 	delete  _uncompressed;	
+	_uncompressed=NULL;
+  
+}
+uint8_t ADMVideoFlipV::getFrameNumberNoAlloc(uint32_t frame,
+				uint32_t *len,
+   				ADMImage *data,
+				uint32_t *flags)
+{
+
+	if (frame&gt;= _info.nb_frames)
+		return 0;
+	// read uncompressed frame
+	if (!_in-&gt;getFrameNumberNoAlloc(frame, len, _uncompressed, flags))
+		return 0;
+
+	uint8_t *in, *out;
+	uint32_t stride=_info.width;
+	uint32_t h=_info.height;
+	uint32_t page, qpage;
+
+	page=stride*h;
+	qpage=page&gt;&gt;2;
+
+	in=YPLANE(_uncompressed);
+	out=YPLANE(data)+(h-1)*stride;
+	// flip y
+	for (uint32_t y=h; y&gt;0; y--) 
+	{
+		memcpy(out,in,stride);
+		in+=stride;
+		out-=stride;
+	}
+	// Flip U &amp; V			         
+	stride&gt;&gt;=1;
+	in=UPLANE(_uncompressed);
+	out=UPLANE(data)+qpage-stride;
+	// flip u
+	for (uint32_t y=h&gt;&gt;1; y&gt;0; y--) 
+	{
+		memcpy(out,in,stride);
+		in+=stride;
+		out-=stride;
+	}
+	in=VPLANE(_uncompressed);
+	out=VPLANE(data)+qpage-stride;
+
+	// flip u
+	for (uint32_t y=h&gt;&gt;1; y&gt;0; y--)
+	{
+		memcpy(out,in,stride);
+		in+=stride;
+		out-=stride;
+	}
+	data-&gt;copyInfo(_uncompressed);
+	return 1;
+}
+//EOF
+
+
+
+

Copied: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.h (from rev 4000, branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidFlipV.h	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/ADM_vidFlipV.h	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,37 @@
+/***************************************************************************
+                          ADM_vidFlipV.h  -  description
+                             -------------------
+    begin                : Wed Nov 6 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef FLIP__
+#define FLIP__
+
+ class  ADMVideoFlipV:public AVDMGenericVideoStream
+ {
+
+ protected:
+    		AVDMGenericVideoStream 	*_in;    	
+           virtual char 									*printConf(void);
+          
+ public:
+ 		
+  					ADMVideoFlipV(  AVDMGenericVideoStream *in,CONFcouple *setup);
+  					virtual ~ADMVideoFlipV();
+		          virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+          																	ADMImage *data,uint32_t *flags);
+					virtual uint8_t configure( AVDMGenericVideoStream *instream) { UNUSED_ARG(instream); return 1;};          																	
+
+
+ }     ;
+#endif

Added: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_videoFilters/VerticalFlip/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,9 @@
+INCLUDE(vf_plugin)
+
+
+SET(ADM_vf_vflip_SRCS ADM_vidFlipV.cpp)
+
+ADD_LIBRARY(ADM_vf_vflip SHARED ${ADM_vf_vflip_SRCS})
+
+INIT_VIDEOFILTER_PLUGIN(ADM_vf_vflip)
+INSTALL_VIDEOFILTER(ADM_vf_vflip)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/CMakeLists.txt	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/CMakeLists.txt	2008-05-01 08:32:05 UTC (rev 4001)
@@ -1,2 +1,3 @@
 ADD_SUBDIRECTORY(ADM_audiodecoder)
-ADD_SUBDIRECTORY(ADM_videoEncoder)
\ No newline at end of file
+ADD_SUBDIRECTORY(ADM_videoEncoder)
+ADD_SUBDIRECTORY(ADM_videoFilters)

Added: branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake	2008-05-01 00:23:29 UTC (rev 4000)
+++ branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake	2008-05-01 08:32:05 UTC (rev 4001)
@@ -0,0 +1,10 @@
+MACRO(INIT_VIDEOFILTER_PLUGIN _lib)
+	INCLUDE_DIRECTORIES(&quot;${CMAKE_BINARY_DIR}/config&quot;)
+	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_core/include&quot;)
+	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_coreUI/include&quot;)
+	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_coreImage/include&quot;)
+ENDMACRO(INIT_VIDEOFILTER_PLUGIN)
+
+MACRO(INSTALL_VIDEOFILTER _lib)
+	INSTALL(TARGETS ${_lib} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoFilter/&quot;)
+ENDMACRO(INSTALL_VIDEOFILTER)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001260.html">[Avidemux-svn-commit] r4000 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreImage/src plugins/ADM_videoEncoder/ADM_vidEnc_x264
</A></li>
	<LI>Next message: <A HREF="001262.html">[Avidemux-svn-commit] r4002 -	branches/avidemux_2.5_branch_gruntster/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1261">[ date ]</a>
              <a href="thread.html#1261">[ thread ]</a>
              <a href="subject.html#1261">[ subject ]</a>
              <a href="author.html#1261">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
