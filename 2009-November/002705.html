<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5494 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_editor	avidemux/common/ADM_script avidemux/common/ADM_videoEncoder/include	avidemux/common/ADM_videoFilter2/include	avidemux/common/ADM_videoFilter2/src avidemux/qt4	avidemux/qt4/ADM_UIs/src avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_filters	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_coreImage/src avidemux_plugins/ADM_videoFilters6
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5494%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common%20avidemux/common/ADM_editor%0A%09avidemux/common/ADM_script%20avidemux/common/ADM_videoEncoder/include%0A%09avidemux/common/ADM_videoFilter2/include%0A%09avidemux/common/ADM_videoFilter2/src%20avidemux/qt4%0A%09avidemux/qt4/ADM_UIs/src%20avidemux/qt4/ADM_userInterfaces/ADM_dialog%0A%09avidemux/qt4/ADM_userInterfaces/ADM_filters%0A%09avidemux/qt4/ADM_userInterfaces/ADM_gui%0A%09avidemux_core/ADM_coreImage/src%20avidemux_plugins/ADM_videoFilters6&In-Reply-To=%3C200911141523.nAEFNbPe012653%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002704.html">
   <LINK REL="Next"  HREF="002706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5494 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_editor	avidemux/common/ADM_script avidemux/common/ADM_videoEncoder/include	avidemux/common/ADM_videoFilter2/include	avidemux/common/ADM_videoFilter2/src avidemux/qt4	avidemux/qt4/ADM_UIs/src avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_filters	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_coreImage/src avidemux_plugins/ADM_videoFilters6</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5494%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common%20avidemux/common/ADM_editor%0A%09avidemux/common/ADM_script%20avidemux/common/ADM_videoEncoder/include%0A%09avidemux/common/ADM_videoFilter2/include%0A%09avidemux/common/ADM_videoFilter2/src%20avidemux/qt4%0A%09avidemux/qt4/ADM_UIs/src%20avidemux/qt4/ADM_userInterfaces/ADM_dialog%0A%09avidemux/qt4/ADM_userInterfaces/ADM_filters%0A%09avidemux/qt4/ADM_userInterfaces/ADM_gui%0A%09avidemux_core/ADM_coreImage/src%20avidemux_plugins/ADM_videoFilters6&In-Reply-To=%3C200911141523.nAEFNbPe012653%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5494 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_editor	avidemux/common/ADM_script avidemux/common/ADM_videoEncoder/include	avidemux/common/ADM_videoFilter2/include	avidemux/common/ADM_videoFilter2/src avidemux/qt4	avidemux/qt4/ADM_UIs/src avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_filters	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_coreImage/src avidemux_plugins/ADM_videoFilters6">mean at mail.berlios.de
       </A><BR>
    <I>Sat Nov 14 16:23:37 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002704.html">[Avidemux-svn-commit] r5493 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska
</A></li>
        <LI>Next message: <A HREF="002706.html">[Avidemux-svn-commit] r5495 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_videoFilter2/src	avidemux_plugins/ADM_videoFilters6	avidemux_plugins/ADM_videoFilters6/verticalFlip
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2705">[ date ]</a>
              <a href="thread.html#2705">[ thread ]</a>
              <a href="subject.html#2705">[ subject ]</a>
              <a href="author.html#2705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2009-11-14 16:23:35 +0100 (Sat, 14 Nov 2009)
New Revision: 5494

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterBridge.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilters.h
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edIdentify.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterApi.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterChain.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_flyDialogQt4.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/T_index_pg.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_mainfilter.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_seekablePreview.h
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt
Log:
[VideoFilter] Begin to remove part of old video filter api

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edIdentify.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edIdentify.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edIdentify.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -20,7 +20,7 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;fourcc.h&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 
 #include &quot;ADM_coreDemuxerMpeg/include/dmx_identify.h&quot;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -25,8 +25,8 @@
 #include &quot;audioEncoderApi.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter_internal.h&quot;
 #include &quot;ADM_videoEncoderApi.h&quot;
 #include &quot;ADM_paramList.h&quot;
 #include &quot;prefs.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -29,7 +29,7 @@
 
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 #include &quot;prefs.h&quot;
 
 #include &quot;ADM_debugID.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -37,8 +37,8 @@
 
 
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter_internal.h&quot;
 #include &quot;ADM_render/GUI_render.h&quot;
 
 #include &quot;ADM_debugID.h&quot;
@@ -49,8 +49,8 @@
 #include &quot;ADM_preview.h&quot;
 #define MAX(a,b) ( (a)&gt;(b) ? (a) : (b) )
 
-extern FILTER  videofilters[VF_MAX_FILTER];
-extern uint32_t nb_active_filter;
+//extern FILTER  videofilters[VF_MAX_FILTER];
+//extern uint32_t nb_active_filter;
 extern void    UI_setCurrentTime(uint64_t curTime);
 
 static void previewBlit(ADMImage *from,ADMImage *to,uint32_t startx,uint32_t starty);
@@ -187,15 +187,17 @@
             ADM_assert(!original);
             switch(previewMode)
             {
+#if 0
               case  ADM_PREVIEW_SEPARATE:
                   DIA_previewInit(preview-&gt;getInfo()-&gt;width,preview-&gt;getInfo()-&gt;height);
-                  
+#endif                  
                   /* no break here, not a mistake */
               case  ADM_PREVIEW_NONE:
               
                   rdrWindowWUnzoomed=rdrPhysicalW;
                   rdrWindowHUnzoomed=rdrPhysicalH;
                   break;
+#if 0
               case  ADM_PREVIEW_OUTPUT:
                   rdrWindowWUnzoomed=preview-&gt;getInfo()-&gt;width;
                   rdrWindowHUnzoomed=preview-&gt;getInfo()-&gt;height;
@@ -215,6 +217,7 @@
                   original=new ADMImage(rdrWindowWUnzoomed,rdrWindowHUnzoomed);
                   break;
               }
+#endif
               default: ADM_assert(0);
             }
         if(zoom!=ZOOM_1_1)
@@ -255,6 +258,7 @@
 void admPreview::stop( void )
 {
   renderLock();
+#if 0
       if(previewMode==ADM_PREVIEW_SEPARATE)
                 DIA_previewEnd();
       if(  previewMode==ADM_PREVIEW_SIDE || previewMode==ADM_PREVIEW_TOP)
@@ -263,6 +267,7 @@
         delete original;
         original=NULL; 
       }
+#endif
       renderResize(rdrWindowWUnzoomed,rdrWindowHUnzoomed,rdrWindowWUnzoomed,rdrWindowHUnzoomed);
       if(previewImage)
       {
@@ -582,6 +587,7 @@
                 renderUpdateImage(resized-&gt;data,zoom);
             }
             break;
+#if 0
       case ADM_PREVIEW_SEPARATE:
             if(zoom==ZOOM_1_1 || renderHasAccelZoom()  )
             {
@@ -606,6 +612,7 @@
               renderUpdateImage(resized-&gt;data,zoom);
             }
               break;
+#endif
       default: ADM_assert(0);
     }
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -18,7 +18,7 @@
 #include &quot;ADM_commonUI/GUI_ui.h&quot;
 #include &quot;avi_vars.h&quot;
 #include &quot;gui_action.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
+
 #include &quot;ADM_editor/ADM_outputfmt.h&quot;
 #include &quot;ADM_script/ADM_container.h&quot;
 #include &quot;ADM_audioFilter/include/ADM_audioFilterInterface.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -19,14 +19,14 @@
 #include &quot;ADM_commonUI/GUI_ui.h&quot;
 #include &quot;avi_vars.h&quot;
 #include &quot;gui_action.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+
+
 #include &quot;ADM_editor/ADM_outputfmt.h&quot;
 #include &quot;ADM_commonUI/GUI_ui.h&quot;
 #include &quot;ADM_script/ADM_container.h&quot;
 #include &quot;ADM_videoEncoderApi.h&quot;
 
-extern VF_FILTERS filterGetTagFromName(const char *inname);
+//extern VF_FILTERS filterGetTagFromName(const char *inname);
 extern uint8_t A_ListAllBlackFrames( char *file );
 extern uint8_t loadVideoCodecConfString( const char *name);
 extern uint8_t ADM_saveRaw (const char *name);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -34,7 +34,7 @@
 #include &quot;adm_scanner.h&quot; 
 #include &quot;avi_vars.h&quot;
 #include &quot;gui_action.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_editor/ADM_outputfmt.h&quot;
 
 #include &quot;ADM_script/ADM_container.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -35,7 +35,7 @@
 #include &quot;avi_vars.h&quot;
 #include &quot;gui_action.hxx&quot;
 
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 #include &quot;ADM_editor/ADM_outputfmt.h&quot;
 
 #include &quot;ADM_script/ADM_container.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -6,7 +6,7 @@
 #define ADMSCANNER
 
 #define ADM_MAX_VAR 50
-#include &quot;ADM_videoFilter_iface.h&quot;
+//#include &quot;ADM_videoFilter_iface.h&quot;
 
 typedef enum
 {
@@ -17,7 +17,7 @@
 	ASC_EXEC_FAILED
 }ASC_ERROR;
 
-int PushParam(APM_TYPE, char *value);
+//int PushParam(APM_TYPE, char *value);
 int Call(char *string);
 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -19,6 +19,7 @@
 #define ADM_VIDEO_ENCODER_API_H
 class ADM_coreVideoEncoder;
 class ADM_coreVideoFilter;
+class CONFcouple;
 // Spawn a new encoder using the index from the menu = the index in the vector
 ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index);
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterApi.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterApi.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterApi.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -13,13 +13,18 @@
  ***************************************************************************/
 #ifndef ADM_VIDEO_FILTER_API_H
 #define ADM_VIDEO_FILTER_API_H
+#include &lt;vector&gt;
+#include &quot;ADM_filterCategory.h&quot;
+class ADM_coreVideoFilter;
+class CONFcouple;
+uint8_t     ADM_vf_loadPlugins(const char *path);
 
-uint8_t ADM_vf_loadPlugins(const char *path);
+uint32_t    ADM_vf_getNbFilters(void);
+uint32_t    ADM_vf_getNbFiltersInCategory(VF_CATEGORY cat);
 
-uint32_t ADM_vf_getNbFilters(void);
-uint32_t ADM_vf_getNbFiltersInCategory(VF_CATEGORY cat);
+bool        ADM_vf_getFilterInfo(VF_CATEGORY cat,int filter, const char **name,const char **desc, uint32_t *major,uint32_t *minor,uint32_t *patch);
+const char *ADM_vf_getDisplayNameFromTag(uint32_t tag);
 
-bool     ADM_vf_getFilterInfo(VF_CATEGORY cat,int filter, const char **name,const char **desc, uint32_t *major,uint32_t *minor,uint32_t *patch);
+ADM_coreVideoFilter *ADM_vf_createFromTag(uint32_t tag,ADM_coreVideoFilter *last,CONFcouple *couples);
 
-
 #endif //ADM_VIDEO_FILTER_API_H

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterBridge.h (from rev 5493, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilterBridge.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -0,0 +1,47 @@
+/***************************************************************************
+                          \fn ADM_videoFilterBridge.h
+                          \brief Base class for Video Filters
+                           (c) Mean 2009
+
+
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_VIDEO_FILTER_BRIDGE_H
+#define ADM_VIDEO_FILTER_BRIDGE_H
+
+#include &quot;ADM_coreVideoFilter.h&quot;
+/**
+    \class ADM_videoFilterBridge
+    \brief Class that transform Editor API to coreVideoFilter API
+
+*/
+class ADM_videoFilterBridge : public ADM_coreVideoFilter
+{
+protected:
+        uint64_t            startTime,endTime;
+        FilterInfo          bridgeInfo;
+        bool                firstImage;
+        uint32_t            lastSentImage;
+        virtual bool        nextFrame(ADMImage *image);    /// Return the next image
+public:
+                            ADM_videoFilterBridge(uint64_t startTime, uint64_t endTime);
+                            ~ADM_videoFilterBridge();
+       virtual bool         getFrame(uint32_t frame,ADMImage *image);
+       
+	   virtual FilterInfo  *getInfo(void);                                      /// Return picture parameters after this filter
+	   virtual bool         getCoupledConf(CONFcouple **couples) {*couples=NULL;return true;} ; /// Return the current filter configuration
+
+        bool                rewind(void);
+
+};
+
+#endif

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilters.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilters.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/include/ADM_videoFilters.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -0,0 +1,38 @@
+/**
+        \file  ADM_videoFilters.h
+        \brief Handle current filter list
+
+
+*/
+
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ ***************************************************************************/
+#ifndef ADM_VIDEO_FILTERS_H
+#define ADM_VIDEO_FILTERS_H
+
+class ADM_coreVideoFilter;
+/**
+    \struct ADM_VideoFilterElment
+*/
+typedef struct
+{
+    uint32_t            tag; // Temporary filter tag
+    ADM_coreVideoFilter *instance;
+}ADM_VideoFilterElement;
+
+extern std::vector&lt;ADM_VideoFilterElement&gt; ADM_VideoFilters;
+
+// Get list
+uint32_t                ADM_vf_getSize(void);
+ADM_coreVideoFilter     *ADM_vf_getInstance(int index);
+uint32_t                ADM_vf_getTag(int index);
+
+bool                    ADM_vf_addFilterFromTag(uint32_t tag);
+bool                    ADM_vf_removeFilterAtIndex(int index);
+#endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterChain.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterChain.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterChain.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -19,6 +19,10 @@
 #include &quot;ADM_coreVideoFilter.h&quot;
 #include &quot;ADM_filterChain.h&quot;
 #include &quot;ADM_videoFilterBridge.h&quot;
+
+
+
+
 /**
     \fn createVideoFilterChain
     \brief Create a filter chain

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -125,7 +125,7 @@
     
     }else   
     {
-        plugin-&gt;tag=lastTag++;
+        plugin-&gt;tag=ADM_videoFilterPluginsList[info-&gt;category].size();
         ADM_videoFilterPluginsList[info-&gt;category].push_back(plugin);
     }
 
@@ -206,6 +206,42 @@
 
 	return 1;
 }
-
-
+/**
+    \fn ADM_vf_getPluginFromTag
+    \brief 
+*/
+static ADM_vf_plugin *ADM_vf_getPluginFromTag(uint32_t tag)
+{
+    for(int cat=0;cat&lt;VF_MAX;cat++)
+    {
+        int nb=ADM_videoFilterPluginsList[cat].size();
+        for(int i=0;i&lt;nb;i++)
+        {
+            if(ADM_videoFilterPluginsList[cat][i]-&gt;tag==tag)
+            {
+                return ADM_videoFilterPluginsList[cat][i];
+            }
+        }
+    }
+    ADM_error(&quot;Cannot get video filter from tag %&quot;LU&quot;\n&quot;,tag);
+    ADM_assert(0);
+}
+/**
+    \fn ADM_VideoFilters
+    \brief
+*/
+const char *ADM_vf_getDisplayNameFromTag(uint32_t tag)
+{
+    ADM_vf_plugin *plugin=ADM_vf_getPluginFromTag(tag);
+    return plugin-&gt;info.displayName;
+}
+/**
+    \fn ADM_vf_createFromTag
+    \brief Create a new filter from its tag
+*/
+ADM_coreVideoFilter *ADM_vf_createFromTag(uint32_t tag,ADM_coreVideoFilter *last,CONFcouple *couples)
+{
+     ADM_vf_plugin *plugin=ADM_vf_getPluginFromTag(tag);
+     return plugin-&gt;create(last,couples);
+}
 //EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_videoFilterBridge.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -1,47 +0,0 @@
-/***************************************************************************
-                          \fn ADM_videoFilterBridge.h
-                          \brief Base class for Video Filters
-                           (c) Mean 2009
-
-
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_VIDEO_FILTER_BRIDGE_H
-#define ADM_VIDEO_FILTER_BRIDGE_H
-
-#include &quot;ADM_coreVideoFilter.h&quot;
-/**
-    \class ADM_videoFilterBridge
-    \brief Class that transform Editor API to coreVideoFilter API
-
-*/
-class ADM_videoFilterBridge : public ADM_coreVideoFilter
-{
-protected:
-        uint64_t            startTime,endTime;
-        FilterInfo          bridgeInfo;
-        bool                firstImage;
-        uint32_t            lastSentImage;
-        virtual bool        nextFrame(ADMImage *image);    /// Return the next image
-public:
-                            ADM_videoFilterBridge(uint64_t startTime, uint64_t endTime);
-                            ~ADM_videoFilterBridge();
-       virtual bool         getFrame(uint32_t frame,ADMImage *image);
-       
-	   virtual FilterInfo  *getInfo(void);                                      /// Return picture parameters after this filter
-	   virtual bool         getCoupledConf(CONFcouple **couples) {*couples=NULL;return true;} ; /// Return the current filter configuration
-
-        bool                rewind(void);
-
-};
-
-#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -2,5 +2,6 @@
 	ADM_videoFilterBridge.cpp
         ADM_filterChain.cpp
         ADM_pluginLoad.cpp
+        ADM_videoFilters.cpp
 )
 ADD_LIBRARY(ADM_internalVideoFilter6 STATIC ${ADM_internalVideoFilter_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -33,8 +33,8 @@
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_render/GUI_render.h&quot;
 #include &quot;DIA_working.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter_internal.h&quot;
 #include &quot;ADM_commonUI/DIA_busy.h&quot;
 #include &quot;ADM_commonUI/GUI_ui.h&quot;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -21,8 +21,8 @@
 #include &quot;avi_vars.h&quot;
 #include &quot;audio_out.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter_internal.h&quot;
 #include &quot;gtkgui.h&quot;
 #include &quot;ADM_render/GUI_render.h&quot;
 #include &quot;avidemutils.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -24,8 +24,8 @@
 #include &quot;DIA_enter.h&quot;
 #include &quot;ADM_coreAudio.h&quot;
 
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_videoFilter_internal.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter_internal.h&quot;
 #include &quot;ADM_encoderConf.h&quot;
 
 #include &quot;ADM_encoderConf.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -7,7 +7,8 @@
 SET(${ADM_LIB}_T
 	T_bitrate.cpp  T_button.cpp  T_dialogFactory.cpp  T_filesel.cpp  T_menu.cpp
 	T_slider.cpp  T_threadCount.cpp  T_toggle.cpp  T_notch.cpp
-    T_flyDialogQt4.cpp T_QCanvas.cpp
+        #T_flyDialogQt4.cpp 
+        #T_QCanvas.cpp
 )
 
 SET(${ADM_LIB}_SRCS

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_flyDialogQt4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_flyDialogQt4.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_flyDialogQt4.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -20,7 +20,7 @@
 
 #include &quot;ADM_default.h&quot;
 
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;DIA_flyDialogQt4.h&quot;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/DIA_none.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/DIA_none.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -15,12 +15,8 @@
  ***************************************************************************/
 #include &quot;config.h&quot;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 
-
-
-
-
 #include &quot;ADM_encoderConf.h&quot;
 //#include &quot;ADM_audioEncoder/include/audioencoder_enum.h&quot;
 
@@ -43,9 +39,10 @@
 int32_t UI_readJog(void) {return 0;}
 struct THRESHOLD_PARAM;
 struct ADMVideoThreshold;
-uint8_t DIA_threshold(AVDMGenericVideoStream *in,
+/*uint8_t DIA_threshold(AVDMGenericVideoStream *in,
                       ADMVideoThreshold * thresholdp,
                       THRESHOLD_PARAM * param) { return 255; }
+
 struct SWISSARMYKNIFE_PARAM;
 struct ADMVideoSwissArmyKnife;
 struct MenuMapping;
@@ -68,5 +65,6 @@
                       PARTICLE_PARAM * param,
                       const MenuMapping * menu_mapping,
                       uint32_t menu_mapping_count) { return 255; }
+*/
 
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/T_index_pg.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/T_index_pg.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/T_index_pg.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -21,7 +21,7 @@
 
 #include &quot;T_index_pg.h&quot;
 #include &quot;ADM_default.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 //#include &quot;ADM_encoderConf.h&quot;
 //#include &quot;ADM_encoder/adm_encoder.h&quot;
 #include &quot;DIA_idx_pg.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -1,11 +1,14 @@
 SET(ADM_LIB ADM_filtersQt4)
 
-QT4_WRAP_UI(${ADM_LIB}_header  mainfilter.ui seekablePreview.ui)
-QT4_WRAP_CPP(${ADM_LIB}_source  Q_mainfilter.h Q_seekablePreview.h)
+QT4_WRAP_UI(${ADM_LIB}_header  mainfilter.ui )# seekablePreview.ui)
+QT4_WRAP_CPP(${ADM_LIB}_source  Q_mainfilter.h )# Q_seekablePreview.h)
 QT4_ADD_RESOURCES(${ADM_LIB}_resource  filter.qrc)
 
 SET(${ADM_LIB}_SRCS
-	filter_none.cpp  Q_mainfilter.cpp Q_seekablePreview.cpp ${${ADM_LIB}_header}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource})
+	filter_none.cpp  
+        Q_mainfilter.cpp 
+        #Q_seekablePreview.cpp 
+        ${${ADM_LIB}_header}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource})
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_mainfilter.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_mainfilter.cpp	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_mainfilter.cpp	2009-11-14 15:23:35 UTC (rev 5494)
@@ -36,6 +36,7 @@
 #include &quot;ADM_coreVideoFilter.h&quot;
 #include &quot;ADM_filterCategory.h&quot;
 #include &quot;ADM_videoFilterApi.h&quot;
+#include &quot;ADM_videoFilters.h&quot;
 
 #include &quot;prefs.h&quot;
 
@@ -49,7 +50,7 @@
 #define ALL_FILTER_BASE       1000
 #define ACTIVE_FILTER_BASE    3000
 /******************************************************/
-uint32_t nb_active_filter=1;
+#define nb_active_filter ADM_vf_getSize()
 
 /*******************************************************/
 
@@ -118,8 +119,7 @@
 */
 void filtermainWindow::setSelected( int sel)
 {
-  if(!sel) return;
-  activeList-&gt;setCurrentRow(sel-1);
+  activeList-&gt;setCurrentRow(sel);
 }
 
 /**
@@ -128,45 +128,34 @@
 */
 void filtermainWindow::add( bool b)
 {
-#if 0
   /* Now that we have the tab, get the selection */
    QListWidgetItem *item=availableList-&gt;currentItem();
    VF_FILTERS tag;
    if(item)
    {
      int itag=item-&gt;type();
-     if(itag&gt;=ALL_FILTER_BASE &amp;&amp; itag &lt; EXTERNAL_FILTER_BASE)
+
+     if(itag&lt;ALL_FILTER_BASE || itag &gt;= ALL_FILTER_BASE+(VF_MAX*100))
      {
-    	 // Extract family &amp; index
-    	 itag-=ALL_FILTER_BASE;
-    	 int index=itag%100;
-    	 int family=(itag-index)/100;
-    	 ADM_assert(family&lt;VF_MAX);
-    	 ADM_assert(index&lt;filterCategories[family].size());
-         tag=filterCategories[family][index]-&gt;tag;
-     }else
-     {
-        ADM_assert(0); 
+            ADM_assert(0); 
      }
-      printf(&quot;Tag : %d\n&quot;,itag);
-      
-      // Create our filter...
-      
-       CONFcouple *coup;
-        videofilters[nb_active_filter].filter = filterCreateFromTag (tag, NULL, videofilters[nb_active_filter - 1].filter);
-        if(!videofilters[nb_active_filter].filter-&gt;    configure (videofilters[nb_active_filter - 1].filter))
+     // Extract family &amp; index
+     itag-=ALL_FILTER_BASE;
+     int index=itag%100;
+     int family=(itag-index)/100;
+     ADM_assert(family&lt;VF_MAX);
+     ADM_assert(index&lt;ADM_vf_getNbFiltersInCategory((VF_CATEGORY)family));
+     tag=index; //filterCategories[family][index]-&gt;tag;
+     ADM_info(&quot;Tag : %d-&gt;family=%d, index=%d\n&quot;,itag,family,tag);
+
+     if(true==ADM_vf_addFilterFromTag(tag))
         {
-            delete videofilters[nb_active_filter].filter;
-            return;
+            buildActiveFilterList();
+            setSelected(nb_active_filter-1);
         }
-        videofilters[nb_active_filter].filter-&gt;getCoupledConf (&amp;coup);
-        videofilters[nb_active_filter].tag = tag;
-        videofilters[nb_active_filter].conf = coup;
-        nb_active_filter++;
-		buildActiveFilterList();
-        setSelected(nb_active_filter - 1);
+     
    }
-#endif
+
 }
 /**
         \fn     remove( bool b)
@@ -174,53 +163,25 @@
 */
 void filtermainWindow::remove( bool b)
 {
-#if 0
    /* Get selection if any */
   /* Now that we have the tab, get the selection */
    QListWidgetItem *item=activeList-&gt;currentItem();
    if(!item)
    {
-      printf(&quot;No selection\n&quot;);
+      ADM_warning(&quot;No selection\n&quot;);
       return;
    }
-    
+     
      int itag=item-&gt;type();
-     ADM_assert(itag&gt;ACTIVE_FILTER_BASE);
+     ADM_assert(itag&gt;=ACTIVE_FILTER_BASE);
      itag-=ACTIVE_FILTER_BASE;
-     /* Filter 0 is the decoder ...*/
-      printf(&quot;Rank : %d\n&quot;,itag); 
-     ADM_assert(itag);
-     /**/
-      if (videofilters[itag].conf)
-            {
-                    delete videofilters[itag].conf;
-                    videofilters[itag].conf = NULL;
-            }
-        // recreate derivated filters
-
-        for (uint32_t i = itag ; i &lt; nb_active_filter-1; i++)
-        {
-                    delete videofilters[i ].filter;
-                    videofilters[i ].filter = filterCreateFromTag(videofilters[i+1].tag,
-                                                    videofilters[i+1].conf,
-                                                    videofilters[i - 1].filter);
-                    videofilters[i ].conf = videofilters[i+1].conf;
-                    videofilters[i ].tag = videofilters[i+1].tag;
-        }
-        
-        /* Delete last filter which is now at last filter -1 */
-            delete videofilters[nb_active_filter - 1].filter;
-            videofilters[nb_active_filter - 1].filter = NULL;
-            nb_active_filter--;
-            buildActiveFilterList ();
-            if(nb_active_filter&gt;1)
-            {
-              if(itag&lt;nb_active_filter-1)
-                  setSelected(itag);
-              else
-                  setSelected(nb_active_filter-1);
-            }
-#endif  
+     ADM_info(&quot;Deleting item %d\n&quot;,itag);
+     ADM_vf_removeFilterAtIndex(itag);
+     buildActiveFilterList ();
+     if(nb_active_filter)
+     {
+          setSelected(nb_active_filter-1);
+     }
 }
 #if 1
 #define MAKE_BUTTON(button,call) \
@@ -472,12 +433,17 @@
 */
 void filtermainWindow::buildActiveFilterList(void)
 {
-#if 0
-	activeList-&gt;clear();
 
-	for (uint32_t i = 1; i &lt; nb_active_filter; i++)
+	activeList-&gt;clear();
+    int nb=ADM_vf_getSize();
+	for (uint32_t i = 0; i &lt; nb; i++)
 	{
-		const char *name = filterGetNameFromTag(videofilters[i].tag);
+            uint32_t                instanceTag=ADM_vf_getTag(i);
+            ADM_coreVideoFilter     *instance=ADM_vf_getInstance(i);
+            const char *name= ADM_vf_getDisplayNameFromTag(instanceTag);
+            const char *conf=instance-&gt;getConfiguration();
+#if 0            
+		const char *name = instance-&gt;;
 		const char *conf = videofilters[i].filter-&gt;printConf ();
 		int namelen = strlen (name);
 
@@ -490,12 +456,12 @@
 			while (*conf == ' ' || *conf == ':')
 				++conf;
 		}
-
+#endif
 		QString str = QString(&quot;&lt;b&gt;&quot;) + name + QString(&quot;&lt;/b&gt;&lt;br&gt;\n&lt;small&gt;&quot;) + conf + QString(&quot;&lt;/small&gt;&quot;);
 		QListWidgetItem *item=new QListWidgetItem(str,activeList,ACTIVE_FILTER_BASE+i);
 		activeList-&gt;addItem(item);
 	}
-#endif
+
 }
   /**
   */

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_seekablePreview.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_seekablePreview.h	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_filters/Q_seekablePreview.h	2009-11-14 15:23:35 UTC (rev 5494)
@@ -18,7 +18,7 @@
 #include &quot;ui_seekablePreview.h&quot;
 
 #include &quot;ADM_assert.h&quot;
-#include &quot;ADM_videoFilter.h&quot;
+//#include &quot;ADM_videoFilter.h&quot;
 #include &quot;DIA_flyDialog.h&quot;
 #include &quot;../ADM_dialog/DIA_flyPreview.h&quot;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -6,7 +6,7 @@
 
 SET(${ADM_LIB}_SRCS
 	Q_gui2.cpp  
-        T_preview.cpp  
+        #T_preview.cpp  
         #stubs.cpp
         file_qt4.cpp  gui_none.cpp  ADM_qslider.cpp
 	${${ADM_LIB}_header}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource})

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -80,6 +80,7 @@
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_dialogQt4)
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_guiQt4)
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_filtersQt4)
+TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_internalVideoFilter6)
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_UIQT4)
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_guiQt4)
 TARGET_LINK_LIBRARIES(avidemux3_qt4 ADM_UI_QT4)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -1,6 +1,6 @@
 SET(ADM_coreImage_SRCS 
-        ADM_videoFilter.cpp  
-        ADM_videoFilterCache.cpp
+#        ADM_videoFilter.cpp  
+        #ADM_videoFilterCache.cpp
         ADM_image.cpp  
         ADM_imageUtils.cpp
         ADM_imageResizer.cpp
@@ -10,12 +10,12 @@
         ADM_rgb.cpp
         ADM_pp.cpp
         ADM_print.cpp
-        ADM_vidFieldUtil.cpp
-        ADM_vidFields.cpp
-        ADM_vidFieldASM.cpp
-        ADM_vidFieldBlend.cpp
-        ADM_interlaceUtil.cpp
-        DIA_flyDialog.cpp
+        #ADM_vidFieldUtil.cpp
+        #ADM_vidFields.cpp
+        #ADM_vidFieldASM.cpp
+        #ADM_vidFieldBlend.cpp
+#        ADM_interlaceUtil.cpp
+#        DIA_flyDialog.cpp
         ADM_imageSave.cpp
 )
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt	2009-11-14 08:25:12 UTC (rev 5493)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt	2009-11-14 15:23:35 UTC (rev 5494)
@@ -1 +1,2 @@
 ADD_SUBDIRECTORY(dummy)
+ADD_SUBDIRECTORY(verticalFlip)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002704.html">[Avidemux-svn-commit] r5493 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska
</A></li>
	<LI>Next message: <A HREF="002706.html">[Avidemux-svn-commit] r5495 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_videoFilter2/src	avidemux_plugins/ADM_videoFilters6	avidemux_plugins/ADM_videoFilters6/verticalFlip
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2705">[ date ]</a>
              <a href="thread.html#2705">[ thread ]</a>
              <a href="subject.html#2705">[ subject ]</a>
              <a href="author.html#2705">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
