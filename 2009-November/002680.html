<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5469 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_script	avidemux_core/ADM_coreImage/src avidemux_core/ADM_coreUtils/include	avidemux_core/ADM_coreUtils/src	avidemux_plugins/ADM_audioEncoders/lame
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5469%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common/ADM_editor%20avidemux/common/ADM_script%0A%09avidemux_core/ADM_coreImage/src%20avidemux_core/ADM_coreUtils/include%0A%09avidemux_core/ADM_coreUtils/src%0A%09avidemux_plugins/ADM_audioEncoders/lame&In-Reply-To=%3C200911121805.nACI5fip008537%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002679.html">
   <LINK REL="Next"  HREF="002681.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5469 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_script	avidemux_core/ADM_coreImage/src avidemux_core/ADM_coreUtils/include	avidemux_core/ADM_coreUtils/src	avidemux_plugins/ADM_audioEncoders/lame</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5469%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common/ADM_editor%20avidemux/common/ADM_script%0A%09avidemux_core/ADM_coreImage/src%20avidemux_core/ADM_coreUtils/include%0A%09avidemux_core/ADM_coreUtils/src%0A%09avidemux_plugins/ADM_audioEncoders/lame&In-Reply-To=%3C200911121805.nACI5fip008537%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5469 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_script	avidemux_core/ADM_coreImage/src avidemux_core/ADM_coreUtils/include	avidemux_core/ADM_coreUtils/src	avidemux_plugins/ADM_audioEncoders/lame">mean at mail.berlios.de
       </A><BR>
    <I>Thu Nov 12 19:05:41 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002679.html">[Avidemux-svn-commit] r5468 - in branches/avidemux_2.6_branch_mean:	avidemux_core/ADM_coreAudioEncoder/include	avidemux_plugins/ADM_audioEncoders/faac	avidemux_plugins/ADM_audioEncoders/vorbis cmake
</A></li>
        <LI>Next message: <A HREF="002681.html">[Avidemux-svn-commit] r5470 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2680">[ date ]</a>
              <a href="thread.html#2680">[ thread ]</a>
              <a href="subject.html#2680">[ subject ]</a>
              <a href="author.html#2680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2009-11-12 19:05:39 +0100 (Thu, 12 Nov 2009)
New Revision: 5469

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_vidFields.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_videoFilter.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_paramList.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.conf
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder_desc.cpp
Log:
[Couples] Cleanup, add explicit names to couples handling, add a full bool type

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -191,12 +191,12 @@
    else
     {
         qfprintf(fd,&quot;app.audio.codec(\&quot;%s\&quot;,%d&quot;, audioCodecGetName(),bitrate); 
-        uint32_t n=couples-&gt;getNumber();
+        uint32_t n=couples-&gt;getSize();
         
         for(int i=0;i&lt;n;i++)
         {
             char *name,*value;
-            couples-&gt;getEntry(i,&amp;name,&amp;value);
+            couples-&gt;getInternalName(i,&amp;name,&amp;value);
             qfprintf(fd,&quot;,\&quot;%s=%s\&quot;&quot;,name,value);
         }
         qfprintf(fd,&quot;);\n&quot;);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -409,7 +409,7 @@
                         }
                     value++;
                 }
-                c-&gt;setCouple(name,value);
+                c-&gt;setInternalName(name,value);
                 //printf(&quot;%s -&gt; [%s,%s]\n&quot;,param,name,value);
                 ADM_dezalloc(dupe);
             }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_vidFields.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_vidFields.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_vidFields.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -39,8 +39,8 @@
 	if(couples)
 	{
 			_param=NEW(DEINT_PARAM);
-			GET(motion_trigger);
-			GET(blend_trigger);
+//			GET(motion_trigger);
+			//GET(blend_trigger);
 	}
 	else
 	{
@@ -57,8 +57,8 @@
 			*couples=new CONFcouple(2);
 
 #define CSET(x)  (*couples)-&gt;setCouple((char *)#x,(_param-&gt;x))
-	CSET(motion_trigger);
-	CSET(blend_trigger);
+//	CSET(motion_trigger);
+//	CSET(blend_trigger);
 			return 1;
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_videoFilter.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_videoFilter.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_videoFilter.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -151,6 +151,7 @@
 //______________________________________________________
 CONFcouple *filterBuildCouple(FILTER_PARAM *param,uint32_t nb,Arg *args)
 {
+#if 0
 int found,l;
 int trans[MAXPARAM];
 	if(param-&gt;nb&gt;VARIABLE_PARAMS)
@@ -248,5 +249,6 @@
 		}
 		return couple;
 	}
-
+#endif
+    return NULL;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h	2009-11-12 18:05:39 UTC (rev 5469)
@@ -1,11 +1,7 @@
-/***************************************************************************
-                          CONFcouple.cpp  -  description
-                             -------------------
-	Used to set a pair name/value
-	--&gt; filters
-
-    begin                : Sun Apr 14 2002
-    copyright            : (C) 2002 by mean
+/** *************************************************************************
+    \file ADM_confCouple.h
+    \brief Handle Key/value pair
+    copyright            : (C) 2002/2009 by mean
     email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
  ***************************************************************************/
 
@@ -27,28 +23,34 @@
 			char 		**name;
 			char 		**value;
 			uint8_t	cur;
+            
 
-
 	public:
 			int32_t lookupName(const char *myname);
+
 			CONFcouple(uint32_t nb);
 			~CONFcouple();
-			uint8_t setCouple(const char *name,uint32_t value);
-			uint8_t setCouple(const char *name,int32_t value);
-			uint8_t setCouple(const char *name,const char *value);
-			uint8_t setCouple(const char *name,const ADM_filename *value);
-			uint8_t setCouple(const char *name,double value);
-			uint8_t setCouple(const char *name,float value);
 
-			uint8_t getCouple(const char *name,int32_t *value);
-			uint8_t getCouple(const char *name,uint32_t *value);
-			uint8_t getCouple(const char *name,char **value);
-			uint8_t getCouple(const char *name,ADM_filename **value);
-			uint8_t getCouple(const char *name,double *value);
-			uint8_t getCouple(const char *name,float *value);
-			uint32_t getNumber(void) { return nb;};
-			uint8_t getEntry(uint32_t n, char **nm, char **val)
-				 { assert(n&lt;nb); *nm=name[n];*val=value[n];return 1;};
+			bool writeAsUint32(const char *name,uint32_t value);
+			bool writeAsInt32(const char *name,int32_t value);
+			bool writeAsString(const char *name,const char *value);
+			bool writeAsFloat(const char *name,float value);
+            bool writeAsBool(const char *name,bool value);
+			
+
+
+            bool readAsUint32(const char *name,uint32_t *value);    
+			bool readAsInt32(const char *name,int32_t *value);
+			bool readAsString(const char *name,char **value);
+			bool readAsFloat(const char *name,float *value);
+            bool readAsBool(const char *name,bool *value);
+
+            bool exist(const char *name);
+
+			uint32_t getSize(void) { return nb;};
+
+            bool     setInternalName(const char *name, const char *key);
+			bool     getInternalName(uint32_t n, char **nm, char **val);
 			void dump(void );
 
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_paramList.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_paramList.h	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_paramList.h	2009-11-12 18:05:39 UTC (rev 5469)
@@ -27,7 +27,7 @@
         ADM_param_uint32_t=1,
         ADM_param_int32_t=2,
         ADM_param_float=3,
-       // ADM_param_bool=4,
+        ADM_param_bool=4,
         ADM_param_string=5
 }ADM_paramType;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -1,8 +1,8 @@
-/***************************************************************************
-                          ADM_genvideo.cpp  -  description
-                             -------------------
-    begin                : Sun Apr 14 2002
-    copyright            : (C) 2002 by mean
+/** *************************************************************************
+        \file ADM_confCouple.cpp
+        \brief Handle storage of data into key/value pairs
+
+    copyright            : (C) 2002/2009 by mean
     email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
  ***************************************************************************/
 
@@ -16,12 +16,10 @@
  ***************************************************************************/
 
 #include &quot;ADM_default.h&quot;
+#include &quot;ADM_confCouple.h&quot;
 
-//#include &quot;fourcc.h&quot;
+static char tmpstring[1024]; // should be enougth
 
-#include &quot;ADM_confCouple.h&quot;
-//#include &quot;ADM_videoFilter.h&quot;
-static char tmpstring[1024]; // should be enougth
 CONFcouple::CONFcouple(uint32_t nub)
 {
 	nb=nub;
@@ -49,28 +47,26 @@
 
 
 };
-
-uint8_t CONFcouple::setCouple(const char *myname,uint32_t val)
+/**
+    \fn exist
+*/
+bool CONFcouple::exist(const char *name)
 {
-	ADM_assert(cur&lt;nb);
-
-	name[cur]=ADM_strdup(myname);
-	sprintf(tmpstring,&quot;%&quot;LU,val);
-	value[cur]=ADM_strdup(tmpstring);
-	cur++;
-	return 1;
+    int i=lookupName(name);
+    if(i==-1) return false;
+    return true;
 }
-uint8_t CONFcouple::setCouple(const char *myname,float val)
+bool CONFcouple::writeAsUint32(const char *myname,uint32_t val)
 {
 	ADM_assert(cur&lt;nb);
 
 	name[cur]=ADM_strdup(myname);
-	sprintf(tmpstring,&quot;%f&quot;,val);
+	sprintf(tmpstring,&quot;%&quot;LU,val);
 	value[cur]=ADM_strdup(tmpstring);
 	cur++;
 	return 1;
 }
-uint8_t CONFcouple::setCouple(const char *myname,double val)
+bool CONFcouple::writeAsFloat(const char *myname,float val)
 {
 	ADM_assert(cur&lt;nb);
 
@@ -80,7 +76,7 @@
 	cur++;
 	return 1;
 }
-uint8_t CONFcouple::setCouple(const char *myname,int32_t val)
+bool CONFcouple::writeAsInt32(const char *myname,int32_t val)
 {
 	ADM_assert(cur&lt;nb);
 
@@ -90,7 +86,8 @@
 	cur++;
 	return 1;
 }
-uint8_t CONFcouple::setCouple(const char *myname,const char *val)
+#warning TODO: ESCAPE!
+bool CONFcouple::writeAsString(const char *myname,const char *val)
 {
 	ADM_assert(cur&lt;nb);
 
@@ -99,26 +96,31 @@
 	cur++;
 	return 1;
 }
-uint8_t CONFcouple::setCouple(const char *myname,const ADM_filename *val)
+bool CONFcouple::writeAsBool(const char *myname,bool v)
 {
 	ADM_assert(cur&lt;nb);
 
 	name[cur]=ADM_strdup(myname);
-	value[cur]=ADM_strdup((char *)val);
+    if(v==true) value[cur]=ADM_strdup(&quot;True&quot;);
+        else value[cur]=ADM_strdup(&quot;False&quot;);
+	
 	cur++;
 	return 1;
 }
 
-uint8_t CONFcouple::getCouple(const char *myname,uint32_t *val)
+// ******************************************
+bool CONFcouple::readAsBool(const char *myname,bool *v)
 {
 	int32_t index=lookupName(myname);
 
 	ADM_assert(index!=-1);
 	ADM_assert(index&lt;(int)nb);
-	*val=(int)atoi(value[index]);
+    char *test=value[index];
+    if(!strcasecmp(test,&quot;true&quot;)) *v=true;
+        else *v=false;
 	return 1;
 }
-uint8_t CONFcouple::getCouple(const char *myname,int32_t *val)
+bool CONFcouple::readAsUint32(const char *myname,uint32_t *val)
 {
 	int32_t index=lookupName(myname);
 
@@ -127,26 +129,26 @@
 	*val=(int)atoi(value[index]);
 	return 1;
 }
-uint8_t CONFcouple::getCouple(const char *myname,char **val)
+bool CONFcouple::readAsInt32(const char *myname,int32_t *val)
 {
 	int32_t index=lookupName(myname);
 
 	ADM_assert(index!=-1);
 	ADM_assert(index&lt;(int)nb);
-	*val=ADM_strdup(value[index]);
+	*val=(int)atoi(value[index]);
 	return 1;
 }
-uint8_t CONFcouple::getCouple(const char *myname,ADM_filename **val)
+bool CONFcouple::readAsString(const char *myname,char **val)
 {
 	int32_t index=lookupName(myname);
-
+#warning TODO : unescape
 	ADM_assert(index!=-1);
 	ADM_assert(index&lt;(int)nb);
-	*val=(ADM_filename *)ADM_strdup(value[index]);
+	*val=ADM_strdup(value[index]);
 	return 1;
 }
 
-uint8_t CONFcouple::getCouple(const char *myname,float *val)
+bool CONFcouple::readAsFloat(const char *myname,float *val)
 {
 	int32_t index=lookupName(myname);
 
@@ -155,16 +157,10 @@
 	sscanf(value[index],&quot;%f&quot;,val);;
 	return 1;
 }
-uint8_t CONFcouple::getCouple(const char *myname,double *val)
-{
-	int32_t index=lookupName(myname);
-
-	ADM_assert(index!=-1);
-	ADM_assert(index&lt;(int)nb);
-	sscanf(value[index],&quot;%lf&quot;,val);;
-	return 1;
-}
-
+/**
+    \fn lookupName
+    \brief Return index of name in the couples, -1 if not fount
+*/
 int32_t CONFcouple::lookupName(const char *myname)
 {
 	for(uint32_t i=0;i&lt;nb;i++)
@@ -184,3 +180,19 @@
 	}
 }
 
+ bool     CONFcouple::setInternalName(const char *nm, const char *val)
+{
+   ADM_assert(cur&lt;nb);
+
+	name[cur]=ADM_strdup(nm);
+	value[cur]=ADM_strdup(val);
+	cur++;
+	return 1;
+}
+bool  CONFcouple::getInternalName(uint32_t n, char **nm, char **val)
+{ 
+    assert(n&lt;nb); 
+    *nm=name[n];
+    *val=value[n];
+    return true;
+};
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -21,7 +21,7 @@
 */
 bool ADM_paramValidate(CONFcouple *couples, const ADM_paramList *params)
 {
-    int n=couples-&gt;getNumber();
+    int n=couples-&gt;getSize();
     int found=0;
     int p=0;
     const ADM_paramList *l=params;
@@ -39,8 +39,7 @@
     for(int i=0;i&lt;p;i++)
     {
         const char *name=params[i].paramName;
-        int index=couples-&gt;lookupName(name);
-        if(index==-1)
+        if(false==couples-&gt;exist(name))
         {
             ADM_warning(&quot;Cannot find param with name %s in configuration\n&quot;,name);
             return false;
@@ -56,7 +55,7 @@
 {
     uint8_t *address=(uint8_t *)s;
     if(false==ADM_paramValidate(couples,params)) return false;
-    int n=couples-&gt;getNumber();
+    int n=couples-&gt;getSize();
     for(int i=0;i&lt;n;i++)
     {
         const char *name=params[i].paramName;
@@ -64,13 +63,13 @@
         ADM_assert(index!=-1);
         switch(params[i].type)
         {
-#define SWAL(entry,type,var) case  entry: {type   var;\
-                        couples-&gt;getCouple(name,&amp;var); \
+#define SWAL(entry,type,var,access) case  entry: {type   var;\
+                        couples-&gt;readAs##access(name,&amp;var); \
                         *(type *)(address+params[i].offset)=var;}break;
-           SWAL(ADM_param_uint32_t,uint32_t,u32)
-           SWAL(ADM_param_int32_t, int32_t, i32)
-           SWAL(ADM_param_float,   float ,  f)
-     //      SWAL(ADM_param_bool,    bool ,   b)
+           SWAL(ADM_param_uint32_t,uint32_t,u32,Uint32)
+           SWAL(ADM_param_int32_t, int32_t, i32,Int32)
+           SWAL(ADM_param_float,   float ,  f,Float)
+           SWAL(ADM_param_bool,    bool ,   b,Bool)
            case ADM_param_string: ADM_error(&quot;not implemented string for paramList\n&quot;);ADM_assert(0);
         }
     }
@@ -100,14 +99,14 @@
         switch(params[i].type)
         {
 #undef SWAL
-#define SWAL(entry,type,var) case  entry: \
+#define SWAL(entry,type,var,access) case  entry: \
                                     {type var; \
                                     var=*(type *)(address+params[i].offset);\
-                                    c-&gt;setCouple(name,var);}break;
-           SWAL(ADM_param_uint32_t,uint32_t,u32)
-           SWAL(ADM_param_int32_t, int32_t, i32)
-           SWAL(ADM_param_float,   float ,  f)
-    //       SWAL(ADM_param_bool,    bool ,   b)
+                                    c-&gt;writeAs##access(name,var);}break;
+           SWAL(ADM_param_uint32_t,uint32_t,u32,Uint32)
+           SWAL(ADM_param_int32_t, int32_t, i32,Int32)
+           SWAL(ADM_param_float,   float ,  f,Float)
+           SWAL(ADM_param_bool,    bool ,   b,Bool)
            case ADM_param_string: ADM_error(&quot;not implemented string for paramList\n&quot;);ADM_assert(0);
         }
     }

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -288,7 +288,8 @@
   diaElemMenu bitrate (&amp;lameBitrate, QT_TR_NOOP (&quot;_Bitrate:&quot;), SZT (bitrateM),
 		       bitrateM);
   diaElemUInteger quality (PX (quality), QT_TR_NOOP (&quot;_Quality:&quot;), 0, 9);
-  diaElemToggle reservoir (PX (disableBitReservoir),
+  uint32_t reservoir32=lameConf.disableBitReservoir;
+  diaElemToggle reservoir (&amp;reservoir32,
 			   QT_TR_NOOP (&quot;_Disable reservoir:&quot;));
 
   diaElem *elems[] = { &amp;Mode, &amp;bitrate,&amp;quality, &amp;reservoir };
@@ -296,6 +297,7 @@
   if (diaFactoryRun (QT_TR_NOOP (&quot;LAME Configuration&quot;), 4, elems))
     {
       lameConf.preset=(ADM_LAME_PRESET)ppreset;
+      lameConf.disableBitReservoir=reservoir32;
       return 1;
     }
   return 0;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.conf
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.conf	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.conf	2009-11-12 18:05:39 UTC (rev 5469)
@@ -1,3 +1,3 @@
 uint32_t:preset
 uint32_t:quality
-uint32_t:disableBitReservoir
+bool:disableBitReservoir

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.h	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder.h	2009-11-12 18:05:39 UTC (rev 5469)
@@ -4,7 +4,7 @@
 typedef struct {
    uint32_t preset;
    uint32_t quality;
-   uint32_t disableBitReservoir;
+   bool disableBitReservoir;
 }lame_encoder;
 #endif //lame_encoder
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder_desc.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder_desc.cpp	2009-11-12 15:40:44 UTC (rev 5468)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/lame_encoder_desc.cpp	2009-11-12 18:05:39 UTC (rev 5469)
@@ -2,6 +2,6 @@
 const ADM_paramList lame_encoder_param[]={
  {&quot;preset&quot;,offsetof( lame_encoder,preset),&quot;uint32_t&quot;,ADM_param_uint32_t},
  {&quot;quality&quot;,offsetof( lame_encoder,quality),&quot;uint32_t&quot;,ADM_param_uint32_t},
- {&quot;disableBitReservoir&quot;,offsetof( lame_encoder,disableBitReservoir),&quot;uint32_t&quot;,ADM_param_uint32_t},
+ {&quot;disableBitReservoir&quot;,offsetof( lame_encoder,disableBitReservoir),&quot;bool&quot;,ADM_param_bool},
 {NULL,0,NULL}
 };


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002679.html">[Avidemux-svn-commit] r5468 - in branches/avidemux_2.6_branch_mean:	avidemux_core/ADM_coreAudioEncoder/include	avidemux_plugins/ADM_audioEncoders/faac	avidemux_plugins/ADM_audioEncoders/vorbis cmake
</A></li>
	<LI>Next message: <A HREF="002681.html">[Avidemux-svn-commit] r5470 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2680">[ date ]</a>
              <a href="thread.html#2680">[ thread ]</a>
              <a href="subject.html#2680">[ subject ]</a>
              <a href="author.html#2680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
